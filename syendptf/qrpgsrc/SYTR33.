      *****************************************************************
      *** PROGRAM FOR Å ARBEIDE MED/SPØRRE PÅ OPPDRAG I TRANSP.MODUL***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *****************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Freetxt har eget felt for notis lest
10XXX * 02 CB  PTF10 Kall til SYIS10A manglet en parm
10XXX * 03 YBC PTF10 MISTER KUBIKK ETTER UTVIDELSE AV OPPDRAGSNR
10XXX * 04 JOV PTF10 kan IKKE sette *D* i fraktbrevsnr i DOKUF "Livsfarlig"(barcode)
10XXX * 05 JOV PTF10 FEILSATT END I "FIXSND" - DISP BLE SATT TIL BLANK UANSET OM EN SØKTE PÅ ANNET
10007 * 06 YBC PTF10 EKSTRA PARAMETER FOR KALL PÅ SYTR40CB
10007 * 07 jov PTF10 slett av fraktbrevref/dup nor TR-MOD oppdrag slettes (V10-opd 5->7-feil)
10007 * 08 jov PTF10 GULFARGE(sted til/dato)ved ulest notis til transp(G)(som i innland)
10007 *              Viser nå igjen oppdrag fra andre moduler(ved søk på annet enn DISP..)
10007 * 09 jov PTF10 Test mot max antall leste psoter (hvis parameter satt på firma)
10007 * 10 jov PTF10 Opt M Mottatt-->F=Frigi E-sending, NY M=Merkelapp
10007 * 11 sh  PTF10 tatt bort merkelig linje
      * 12 sh  PTF10 logikk rundt HEKNT
      * 13 JOV PTF10 Fjern fra tur: HOVEDTRANSPs forventede bet. på oppdrnivå (4/5) fjernes i KOSBU
      * 14 JOV PTF10 logikk rundt HEKNT - SKAL VÆRE TRANSPNr , ikke KUNDEnr
10XXX * 15 JOV PTF10 Protecte ekstra filer (F2/ind 37 er ON/OFF protect)
10XXX * 16 JOV PTF10 GODSLISTE FRA BOKS = KONTROLLER OM CARFOSKAN FERDIG/GODKJ.BELØP BLANLKET
10XXX * 17 JOV PTF10 Sjekk/summer CS-verdier også ved Sett På Tur (via boks)
10XXX * 18 SH  PTF10 nye parametre sytt01
10XXX * 19 SH  PTF10 nottakblokk tilgjengelig ogå ved avsluttet oppdrag
10XXX * 20 SH  HENTEHÅNDTERING
10XXX * 21 SH  PTF10 opsjon q/53
10XXX * 22 SH  PTF10 Fjernet fax ting
10XXX * 23 JOV PTF10 hentesystem ramberg
10XXX * 24 JOV PTF10 G = SETT GEOLOCATION = BREDDE/LENGDEGRAD - HENT/LEVER
10XXX * 25 SH  PTF10 opsjon I/54
10XXX * 26 JOV PTF10 loggfør slettemerking i T&T
10XXX * 27 JOV PTF10 132x27 - Ingen merking i DDS (se sytr33fm.80) - i innland kutte mode3=ordremodu
10XXX * 28 JOV PTF10 Søk på kolli/id (godsmerke fra DOKUFM)(indikator 79-frigjort (e.krav/ rød vekt)
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 29 JOV PTF11 firøk IFB + 401+17 stripper bort 401
      * 30 SH  PTF11 option 60/J  sende epost av fraktbrev/merkelapp
      * 31 JOV PTF11 Dersom henLev=Urørt - sjekk TEI = På Term
      * 32 JOV PTF11 Dersom henLev=Urørt - sjekk TE2 = På Term (BURDE OGSÅ TESTE TEKST/RETNING TE2..
      * 33 JOV PTF11 Endret prog for å skrive labels på ett oppdrag
      * 34 SH  PTF11 ny parameter arc045
      * 35 JOV PTF11 Ved M=markelapp på en med VF-DUP - print på dupen..
      * 36 JOV PTF11 Ved M=markelapp - printerstying fra avdeinghen det bestilles på (ikke DUPAVD)
      * 37 SH  PTF11 Oppdraggivers ref  BRINGTMS-prosjekt.
      * 38 JOV PTF11 Personlig barcodeprinter benytte sI PRTMLAPP (hvis oppgitt)
      * 39 sh  PTF11 summering turer
      * 40 JOV PTF11 BUG v søk på kolli-ID
      * 41 SH  PTF11 BRINGTMS
      * 42 JOV PTF11 Firmaparameter for V = Vis T&T-stat / vis ulest G / P .. i 3 lang "ULEST"
      * 43 SH  PTF11 vise E ved epost
      * 44 SH  PTF11 option 3S = kopier og slett
      * 45 SH  PTF11 cursor ved F2
      * 46 JOV PTF11 Ikke blank WSTT VED DIV TYPER NY-SØK
      * 47 SH  PTF11 Kan ikke legge mønsteroppdrag på Ventetorg
      * 48 JOV PTF11 Vis ADR-poeng i subfila
      * 49 JOV PTF11 PREBOOKKODE
      * 50 SH  PTF11 viser herfa/herfr
      * 51 SH  PTF11 SPØRRING TILBAKE TIL SYFM21A
      * 52 SH  PTF11 3S FUNKSJON IKKE TILLATT PÅ ALLE OPPDRAG
      * 53 SH  PTF11 søking flytt posisjoner
      * 54 JOV PTF11 Vis express (i samme infoflet som prebooking)
      * 55 JOV PTF11 Ved slett av oppdrag settes *D i 34-35 av FRISOK (i fall unik-test v edi mm)
      * 56 SH  PTF11 Ved T i transportør søk i transportørfil
      * 57 SH  PTF11 korekt senders ref kjøpers ref
      * 58 SH  PTF11 ny parameter arc045
      * 59 SH  PTF11 UFAKT = X tester om ufakturert
      * 60 SH  PTF11 rettet epost funksjon
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      * 61 JOV PTF12 Ekstra filter - KUN frankatur
      * 62 JOV PTF12 Sperre for kopi av DUP
      * 63 SH  PTF12 til eposter via cl-program
      * 64 JOV PTF12 F5 i søk/utvalgsbildet = balnke gamle valg
      *              vis også mottakers hvis senders er blank (evt begge)
      *              Opt HD = Hoved/DUP
      * 65 SH  PTF12 ny parametyer print lapp
      * 66 JOV PTF12 Filter på prebookingkode
12101 * 67 JOV PTF12 Åpne for opsjon R =Rekkefølge(pos.rekkefølge) ved annet enn innland
12101 * 68 SH  PTF12 mottagerref fra dato
12101 * 69 JOV PTF12 Opt U = merke *URGENT*
12101 * 70 SH  PTF12 tillate søk på inaktive avdelinger ikke endring
12101 * 71 JOV PTF12 Opt 61 = send generell SMS
12101 * 72 SH  PTF12 utvidet LO:UP tabellen
      * 73 jov PTF12 TT-STATUS BLE IKKE REFRESHET VED UPDATE AV SUBFIL / OFTE FEIL FARGE ETTER OPSJ.
      * 74 jov PTF12 ekstra parameter i prog for posisjonsnummerering A = Auto
      * 75 jov PTF12 ny T&Tstatus
      * 76 sh  PTF12 ikke søk fra oppdragsnummer hvis frisøk er utfyylt
********************************************************************
      *
N44  Ftell      IF   E           K DISK
N43  Farklogh4  IF   E           K DISK
     FUSRDFT    IF   E           K DISK
     FFIRMARC   IF a E           K DISK
     FBOKSF     UF a E           K DISK
N23  FMINEAVD   IF   E           K DISK
     FAVSLUTF   IF   E           K DISK
     FAVSLUTL2  IF   E           K DISK
     F                                     RENAME(AVSLUTFR:AVSLUT2)
     FHEADF     UF   E           K DISK
     FTURER     UF   E           K DISK
     FTURER2    IF   E           K DISK    INFDS(TU02DS)
     F                                     USROPN
     F                                     RENAME(TURERR:TURERR2)
     FTURER14   IF   E           K DISK
     F                                     RENAME(TURERR:TURERR14)
     FTRAN      IF   E           K DISK
     FSTSTUR    IF   E           K DISK
     FSTSOPD    IF   E           K DISK
     FSTSCLI    IF   E           K DISK
     FKODTAG    IF   E           K DISK
     FKOSBU9    UF   E           K DISK
     FUNITL01   IF   E           K DISK    INFDS(UN01DS)
     F                                     USROPN
     FFAK4      UF   E           K DISK
     FDOKUF     UF   E           K DISK
     FDOKUFM    IF   E           K DISK
     FHEADDUM   IF   E           K DISK
     F                                     RENAME(HEADFR:HEADDU)
     FFERDL01   IF   E           K DISK
     FSAML1     UF   E           K DISK
     FHESTED    IF   E           K DISK
s01  F*REETXT   IF   E           K DISK
N01  FFREETXT3  IF   E           K DISK
S22  F*AXLOG03  IF   E           K DISK
S22  F*AXQLOG   IF   E           K DISK
     FHEAD2     IF   E           K DISK    INFDS(HE02DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD2R)
     FHEAD3     IF   E           K DISK    INFDS(HE03DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD3R)
     FHEAD4     IF   E           K DISK    INFDS(HE04DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD4R)
     FHEAD5     IF   E           K DISK    INFDS(HE05DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD5R)
     FHEAD6     IF   E           K DISK    INFDS(HE06DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD6R)
     FHEAD7     IF   E           K DISK    INFDS(HE07DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD7R)
     FHEAD8     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD8R)
     FHEAD10    IF   E           K DISK    INFDS(HE10DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD10R)
     FHEAD29    IF   E           K DISK    INFDS(HE29DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD29R)
     FHEAD14    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD14R)
     FHEAD11    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD11R)
     FHEAD15    IF   E           K DISK    INFDS(HE15DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD15R)
     FHEAD16    IF   E           K DISK    INFDS(HE16DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD16R)
     FHEAD17    IF   E           K DISK    INFDS(HE17DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD17R)
N37  FHEAD35    IF   E           K DISK    INFDS(HE35DS)
N37  F                                     USROPN
N37  F                                     RENAME(HEADFR:HEAD35R)
N37  FHEAD47    IF   E           K DISK    INFDS(HE47DS)
N37  F                                     USROPN
N37  F                                     RENAME(HEADFR:HEAD47R)
     FHEAD18    IF   E           K DISK    INFDS(HE18DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD18R)
     FHEAD33    IF   E           K DISK    INFDS(HE33DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD33R)
     FHEAD40    IF   E           K DISK    INFDS(HE40DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD40R)
     FHEAD12    IF   E           K DISK    INFDS(HE12DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD12R)
     FHEAD39    IF   E           K DISK    INFDS(HE39DS)
     F                                     USROPN
     F                                     RENAME(HEADFR:HEAD39R)
     FFAIN      IF   E           K DISK
     FFAI2      IF   E           K DISK
     F                                     RENAME(FAINR:FAI2R)
     FKODTA     IF   E           K DISK
     FDISP      UF   E           K DISK
     FDISPL04   IF   E           K DISK
     F                                     RENAME(DISPR:DISPR04)
     FDISPL08   IF   E           K DISK    INFDS(DI08DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR08)
     FDISPL09   IF   E           K DISK    INFDS(DI09DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR09)
     FDISPL10   IF   E           K DISK    INFDS(DI10DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR10)
     FDISPL11   IF   E           K DISK    INFDS(DI11DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR11)
     FDISPL12   IF   E           K DISK    INFDS(DI12DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR12)
     FDISPL13   IF   E           K DISK    INFDS(DI13DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR13)
     FDISPL14   IF   E           K DISK    INFDS(DI14DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR14)
     FDISPL15   IF   E           K DISK    INFDS(DI15DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR15)
     FDISPL16   IF   E           K DISK    INFDS(DI16DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR16)
     FDISPL17   IF   E           K DISK    INFDS(DI17DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR17)
     FDISPL18   IF   E           K DISK    INFDS(DI18DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR18)
     FDISPL19   IF   E           K DISK    INFDS(DI19DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR19)
     FDISPL20   IF   E           K DISK    INFDS(DI20DS)
     F                                     USROPN
     F                                     RENAME(DISPR:DISPR20)
S55  F*RISOK    IF   E           K DISK    INFDS(FRISDS)
N55  FFRISOK    UF   E           K DISK    INFDS(FRISDS)
     F                                     USROPN
     FFRISOL01  IF   E           K DISK    INFDS(FR01DS)
     F                                     USROPN
     F                                     RENAME(FRISOKR:FRISR01)
     FFRISOL02  IF   E           K DISK    INFDS(FR02DS)
     F                                     USROPN
     F                                     RENAME(FRISOKR:FRISR02)
N28  FDOKUFM1   IF   E           K DISK    INFDS(DFM1DS)
n28  F                                     USROPN
N28  F                                     RENAME(DOKUFMR:DOKUFMR1)
     FFIRM      IF   E           K DISK
     FHUBOL01   IF   E           K DISK
     FKUFAST    IF   E           K DISK
S26  F*TRACKL02  IF   E           K DISK
N26  FTRACKL02  IF A E           K DISK
N09  FSYPARL1   IF   E           K DISK
N38  FSYPARL2   IF   E           K DISK    RENAME(SYPARFR:SYPARFR2)
N17  FCARGOF3   IF   E           K DISK
N17  FCARGOO    IF   E           K DISK
     FSYTR33FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFI2:ZRECNO)
     F                                     INFDS(FBAREA)
     F
S28  D*RX              S              1    DIM(35)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D* Datastruktur for Å HENTE USER
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D* Datastruktur for hver fil med UC - er den åpnet ?
     D TU02DS          DS
     D  TU02OP                 9      9
     D UN01DS          DS
     D  UN01OP                 9      9
     D HE02DS          DS
     D  HE02OP                 9      9
     D HE03DS          DS
     D  HE03OP                 9      9
     D HE04DS          DS
     D  HE04OP                 9      9
     D HE05DS          DS
     D  HE05OP                 9      9
     D HE10DS          DS
     D  HE10OP                 9      9
     D HE29DS          DS
     D  HE29OP                 9      9
     D HE15DS          DS
     D  HE15OP                 9      9
     D HE16DS          DS
     D  HE16OP                 9      9
     D HE06DS          DS
     D  HE06OP                 9      9
     D HE07DS          DS
     D  HE07OP                 9      9
     D HE17DS          DS
     D  HE17OP                 9      9
n37  D HE35DS          DS
n37  D  HE35OP                 9      9
n37  D HE47DS          DS
n37  D  HE47OP                 9      9
     D HE18DS          DS
     D  HE18OP                 9      9
     D HE33DS          DS
     D  HE33OP                 9      9
     D HE40DS          DS
     D  HE40OP                 9      9
     D HE12DS          DS
     D  HE12OP                 9      9
     D HE39DS          DS
     D  HE39OP                 9      9
     D DI08DS          DS
     D  DI08OP                 9      9
     D DI09DS          DS
     D  DI09OP                 9      9
     D DI10DS          DS
     D  DI10OP                 9      9
     D DI11DS          DS
     D  DI11OP                 9      9
     D DI12DS          DS
     D  DI12OP                 9      9
     D DI13DS          DS
     D  DI13OP                 9      9
     D DI14DS          DS
     D  DI14OP                 9      9
     D DI15DS          DS
     D  DI15OP                 9      9
     D DI16DS          DS
     D  DI16OP                 9      9
     D DI17DS          DS
     D  DI17OP                 9      9
     D DI18DS          DS
     D  DI18OP                 9      9
     D DI19DS          DS
     D  DI19OP                 9      9
     D DI20DS          DS
     D  DI20OP                 9      9
     D FRISDS          DS
     D  FRISOP                 9      9
     D FR01DS          DS
     D  FR01OP                 9      9
     D FR02DS          DS
     D  FR02OP                 9      9
N28  D DFM1DS          DS
N28  D  DFM1OP                 9      9
     D* "Tvungen søkevei" i DS for raskt å sjekke om alle er blanke.
     D                 DS
     D  TS                     1     20
     D  WXSTEF                 1      1
     D  WXSTET                 2      2
     D  WXSONF                 3      3
     D  WXSONT                 4      4
     D  WXOPDT                 5      5
     D  WXHAWN                 6      6
     D  WXAGNR                 7      7
     D  WXRFA                  8      8
     D  WXPRO                  9      9
     D  WXSG                  10     10
     D  WXKNSF                11     11
     D  WXKNKF                12     12
     D  WXGN                  13     13
     D  WXFN                  14     14
     D  WXFRI                 15     15
     D  WXNRAG                16     16
     D* WSNR 1 LANG I DEN ENE MODEN
     D                 DS
     D  WSNR01                 1      1
     D  WSNR                   1      2
s27  D*                DS
s27  D* FSSOK                  1     35
s27  D* FSSNDN                 3     17
s27  D* FSSNDX                17     17
     D* LINJER I TURPOSISJONEN
     D                 DS
     D  LI20A                  1     17
     D  LI20B                 18     34
     D  LI20C                 35     51
     D  LI20D                 52     68
     D  L20                    1     68
     D                                     DIM(4)
     D                 DS
     D  LI20At                 1      8  0
     D  LI20Bt                 9     16  0
     D  LI20Ct                17     24  0
     D  LI20Dt                25     32  0
     D  L2T                    1     32  0
     D                                     DIM(4)
     D                 DS
     D  LI20AB                 1     10
     D  LI20BB                11     20
     D  LI20CB                21     30
     D  LI20DB                31     40
     D  L2B                    1     40
     D                                     DIM(4)
     D                 DS
     D  LI21AV                 1      7  0
     D  LI21BV                 8     14  0
     D  LI21CV                15     21  0
     D  LI21DV                22     28  0
     D  L2V                    1     28  0
     D                                     DIM(4)
     D                 DS
     D  LI21AA                 1      3  0
     D  LI21BA                 4      6  0
     D  LI21CA                 7      9  0
     D  LI21DA                10     12  0
     D  L2A                    1     12  0
     D                                     DIM(4)
N27  D                 DS
N27  D  LI21AM                 1      6  3
N27  D  LI21BM                 7     12  3
N27  D  LI21CM                13     18  3
N27  D  LI21DM                19     24  3
N27  D  L2M                    1     24  3
     D                                     DIM(4)
     D                 DS
     D  LI22A                  1     17
     D  LI22B                 18     34
     D  LI22C                 35     51
     D  LI22D                 52     68
     D  L22                    1     68
     D                                     DIM(4)
     D* Sikre at FA-key er ok selv om fain er lest
     D                 DS
     D  FIAVD                  1      4  0
     D  FAAVD                  1      4  0
     D                 DS
     D  FIOPD                  1      7  0
     D  FAOPD                  1      7  0
     D                 DS
     D  WSFRI2                 1     35
     D  WSFRIX                 1     15
     D* Forkorting av div. felt for skjermvisning
     D                 DS
     D  HELB                   1      5
     D  DUPASG                 1      3
     D                 DS
     D  HEVKT                  1      9  0
     D  HEVKTW                 5      9  0
S27  D* HEVKTW5                5      9  0
     D                 DS
     D  HEVS1                  1     25
s27  D* HEVS10                 1     15
n27  D  HEVS15                 1     15
S27  D*                DS
S27  D* HENT                   1      7  0
S27  D* HENT4                  4      7  0
S27  D* HENT3                  5      7  0
     D                 DS
     D  HESDF                  1      5
     D  HESDF4                 1      4
     D                 DS
     D  W2SDF                  1      5
     D  W2SDF4                 1      4
     D                 DS
     D  W2SDT                  1      5
     D  W2SDT4                 1      4
      *
     D                 DS
     D  HXSNDN                 1     20
     D  WXSND1                 1     10
     D  WXSNDN                11     20
     D                 DS
     D  WSSNDN                 1     20
     D  WSSNDN17              17     17
     D  WSSNDN18              18     20
NRFA D                 DS
NRFA D  WSRFA35                1     35
s37  D* WSRFA                  1     15
n37  D  WSRFA                  1     35
n37  D  WSRFA15                1     15
N37  D                 DS
N37  D  WSRFK35                1     35
n37  D  WSRFK                  1     35
n37  D  WSRFK15                1     15
     D                 DS
     D  HENAS                  1     30
s27  D* HENAS2                 1     15
n27  D  HENAS2                 1     20
     D                 DS
     D  HENAK                  1     30
s27  D* HENAK2                 1     15
n27  D  HENAK2                 1     20
     D  HENAKA                 1      1
     D  HENAKB                 3      5
     D  HENAKC                 7     13
     D  HENAKD                 4     15
     D  HENAKE                 8     15
     D                 DS
     D  HEPOS1                 1      7
     D  HEPO1A                 1      3
     D  HEPO1B                 4      7
     D                 DS
     D  SFDSFE                 1      4
     D  TRSTAF                 2      2
     D  TRSTAE                 4      4
     D                 DS
     D  SFDS01                 1     52
     D  DS1AVS                 1     18
     D  DS1MOT                20     37
     D  DS1AMG                 1      7
     D  DS1MMG                 9     20
     D  DS1GMG                22     37
     D  DS1PNR                39     42
     D  DS1STE                44     52
     D                 DS
     D  SFDS02                 1     52
     D  DS2AVS                 1     18
     D  DS2PNR                20     23
     D  DS2STE                25     34
     D  DS2MOT                36     52
     D                 DS
     D  SFDS03                 1     52
     D  DS3AVD                 1      4
     D  DS3OPD                 6     12
     D  DS3PRO                14     21
     D  DS3SND                23     32
     D  DS3SG                 34     36
     D  DS3DIS                38     38
     D  DS3AVS                40     44
     D  DS3MOT                46     50
     D  DS3ST                 52     52
     D                 DS
     D  STSDS                  1      4
     D  SOSTAT                 3      3
     D                 DS
     D  DFBREF                 1     17
s07  D* DFBRAV                 8     11
s07  D* DFBROP                13     17
N07  D  DFBRAV                 6      9
N07  D  DFBROP                11     17
     D                 DS
     D  P1DS                   1    256
     D  P1FLAG                 1      1
     D  P1BNR                  2      8  0
     D  P1AVD                  9     12  0
     D  P1TUNR                13     20  0
     D  P1OAVD                21     24  0
     D  P1OPD                 25     31  0
     D  P1BL                  32     44  2
     D                 DS
     D  TMPBLA                 1      7
     D  TB                     1      7
     D                                     DIM(7)
     D                 DS
     D  YÅÅ                    1      4  0
     D  YMM                    5      6  0
     D  YDD                    7      8  0
     D  YDT                    1      8  0
     D                 DS
     D  timedate               1     14  0
     D  BOTIME                 1      6  0
     D  BODD                   7      8  0
     D  BOMM                   9     10  0
     D  BOÅÅ                  11     14  0
     D                 DS
     D  BODATE                 1      8  0
     D  BOÅÅF                  1      4  0
     D  BOMMF                  5      6  0
     D  BODDF                  7      8  0
N26  D                 DS
N26  D  XULTID                 1     14  0
N26  D  XULTM                  1      6  0
N26  D  XULDD                  7      8  0
N26  D  XULMM                  9     10  0
N26  D  XULÅÅ                 11     14  0
N26  D                 DS
N26  D  ULÅÅ                   1      4  0
N26  D  ULMM                   5      6  0
N26  D  ULDD                   7      8  0
N26  D  ULDT                   1      8  0
N13  D                 DS
N13  D  BUTXT                  1     35
N13  D  BUTX_20                1     20
N13  D  BUTX_7                29     35
N64  D                 DS
N64  D  DUP                    1   1100  0
N64  D                                     DIM(100)
N64  D                 DS
N64  D  AvdOpd                 1     11  0
N64  D   DsAvd                 1      4  0
N64  D   DsOpd                 5     11  0
     D                UDS
     D  UDSFIR                 1      2
     D  UDSAVD                15     18  0
     D  UDSSG                 19     21
     D* definere numeriske verdier i alfafelt
     D NUM             C                   CONST('0123456789 ')
     D StsOK           C                   CONST('Ferdig skyting-OK')
     D StsOpen         C                   CONST('Åpen skyting.....')
     D StsMank         C                   CONST('Ferd.skyt.m/manko')
     D StsGodk         C                   CONST('Ferd. godkj manko')
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
n72  D                                     UVWXYZÆØÅÜÄÖ')
s72  D*                                    UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
n72  D                                     uvwxyzæøåüäö')
s72  D*                                    uvwxyzæøå')
     D HenMot          s             12    VARYING
     C*
     C                   EXSR      INIT
      *
      * Hvis "arbeide med" hopp over valgbilde - vis udisponerte
      *
     C   61              GOTO      START
     C*
      *
      * Vis valgbilde for utvalg til subfil
      *
     C     BG2           TAG
     C   66              Z-ADD     3             LINNBR
     C   66              Z-ADD     20            POSNBR
     C                   EXFMT     BILDE02
     C                   EXSR      SETOFIN
     C*
N15  C     *in02         IFEQ      '1'
N15  C     *IN37         IFEQ      '1'
n45  C                   Z-ADD     8             LINNBR
n45  C                   Z-ADD     51            POSNBR
N15  C                   MOVE      '0'           *IN37
N15  C                   ELSE
N45  C                   Z-ADD     6             LINNBR
N45  C                   Z-ADD     2             POSNBR
N15  C                   MOVE      '1'           *IN37
N15  C                   END
N15  C                   GOTO      BG2
N15  C                   END
N64   *
N64   * F5 = blank gamle utvalg
N64  C     *in05         ifeq      '1'
N64  c                   exsr      MOVB2
N64  C                   MOVE      *zeros        WSAVD
N64  C                   MOVE      *blanks       WSDIST
N64  C                   GOTO      BG2
N64  c                   endif
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * Avbryt hele prog. fra søkebilde
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKF04
     C                   GOTO      BG2
     C                   END
      *
      * F11 HENTE-OPPDRAG
      *
     C   11              DO
     C                   MOVE      WSAVDU        AVDHEN            4 0
     C                   CALL      'SYTR34'
     C                   GOTO      BG2
     C                   END
      *--------------------------------------
      * F13 = VIS E-OPPDRAG PR KUNDE
      *--------------------------------------
     C     *IN13         IFEQ      '1'
     C                   EXSR      ESEND
     c     UFRSOK        cabeq     *blanks       BG2
     C                   GOTO      START
     C                   ENDIF
      *
      * F22 Hurtigbooking / notisblokk
      *
     C   22              DO
     C                   MOVE      'N'           HUPLUK            1
     C                   MOVE      *BLANKS       HUDATA          218
     C                   CALL      'SYHU10'
     C                   PARM                    HUPLUK
     C                   PARM                    HUDATA
     C                   GOTO      BG2
     C                   END
      *
      * TEST DEPARTMENT IF CHANGED
      *
     C     WSAVD         IFNE      *ZEROS
     C     WSAVD         ANDNE     WSAVDO
     C                   EXSR      BYAVD
     C   30              MOVE      'SPA0001'     MSGNR
     C   30              GOTO      BG2
     C                   END
      *
      * Enter (el. F2) tastet for å søke (el F8/F9= direkte)
      *
     C                   EXSR      TESTB2
     C   30              GOTO      BG2
     C*
     C                   MOVE      WSDIST        W2STA1
      *
      * start med refresh
      *
     C     START         TAG
N03  c                   move      *zeros        LestRec           9 0
N69  C                   move      'N'           URGFins           1
     C                   MOVE      '1'           *IN93
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   WRITE     SUBCTL
     C                   ELSE
     C                   WRITE     SUBCT2
     C                   END
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *BLANKS       WSNR
     c                   setoff                                       30
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C                   EXSR      LESREC
      *
     C     START2        TAG
      *
     C     *IN94         IFEQ      '0'
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
S27  c*                  z-add     8             antrun            2 0
N27  c                   z-add     9             antrun            2 0
     c                   else
S27  c*                  z-add     13            antrun
N27  c                   z-add     16            antrun
     c                   end
     C                   DO        antrun
     C                   ADD       1             ZRECNO
      *
      * Kompletter subfil med data fra andre register enn DISP/HEADF
      *
     C                   EXSR      SETSUB
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   WRITE     SUBFIL
     C                   ELSE
     C                   WRITE     SUBFI2
     C                   END
      *
      * Flere poster?
      *
     C                   EXSR      LESREC
     C  N94              END
     C                   END
      *
      * Sist leste post (hvis ikke EOF) er 1. post for neste skjermside
      * (det leses "en for langt" for at en skal kunne vise '+' i bunn)
      * Bevar alle subfildata i arbeidsvariable slik at de kan hentes
      * tilbake uten disk-read ved roll videre (forenkler + sparer tid)
      *
     C     *IN94         IFEQ      '0'
     C                   EXSR      MOVSUX
     C                   END
     C*
     C                   MOVE      ZRECNO        XRECNO            5 0
      * INNLAND = 67 ELLER 68 ON
     C* Oppdater "skytestatus" i boksene ved enhver refresh
     C     *IN67         IFEQ      '1'
     C     *IN68         OREQ      '1'
     C                   exsr      UPDBOKS2
     c                   end
     C     START3        TAG
     C                   SETOFF                                       1203
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C  N96              Z-ADD     6             LINNBR
     C                   ELSE
     C  N96              Z-ADD     5             LINNBR
     C                   END
     C     W2NR          IFEQ      *BLANKS
     C  N96              Z-ADD     2             POSNBR
     C                   END
     C                   MOVEA     '11'          *IN(91)
N69   *
N69   * VARSEL hvis URGENT/PRIORITERT gods finnes i lista
N69  c                   if        *in30= *off and URGFins='J'
N69  C                   eval      *in30= *on
N69  C                   MOVE      'JOV1766'     MSGNR
N69  C                   END
      *
      * VARSEL hvis user har uoppgjorte notater i blokka si
      * (SETLL gir EQ-indikator ON hvis eksakt treff)
      *
     c     *in(30)       ifeq      '0'
     C     ZUSER         SETLL     HUBOL01                                30
     C     *IN30         IFEQ      '1'
     C                   MOVE      'JOV0278'     MSGNR
     C                   END
     C                   END
      *
      *
     C     ZRECNO        IFEQ      0
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   EXFMT     NYVARE
     c                   else
     c                   exfmt     nyva02
     c                   end
     C                   ELSE
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   WRITE     BUNN
     C                   ELSE
     C                   WRITE     BIABCD
     C                   END
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   EXFMT     SUBCTL
     C                   ELSE
     C                   EXFMT     SUBCT2
     C                   END
     C                   END
      *
      * START ETTER AT SKJERMBILDET ER LEST
      *
N64  C                   move      'N'           VisHovDup         1
     C                   SETOFF                                       9830
     C                   SETOFF                                       9096
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      *--------------------------------------
      * "MO" i topp - BYTTE MODUS - SWITCHE mellom Innland/full
      *--------------------------------------
S67  C*    innland       IFEQ      'J'
      * R=rekkefølge på søkt turnr
     c     W2NR          Ifeq      'R '
     c     W2NR          oreq      ' R'
N74  c     W2NR          oreq      'RA'
     c     WSPRO         IFNE      *ZEROS
     c                   MOVE      WSPRO         AaPRO             8
N74   * Auto J = atomatisk men BLI i bildet
N74   * Auto A = atomatisk IKKE bilde (og IKKE open av displayfile)
N74  C                   move      ' '           Rauto             1
N74  c     W2NR          Ifeq      'RA'
N74  C                   move      'J'           Rauto             1
N74  C                   endif
     C                   call      'SYTR33R'
     C                   Parm                    AApro
N74  C                   Parm                    Rauto
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      Start
     c                   end
     c                   end
N67  C     innland       IFEQ      'J'
     C     W2NR          Ifeq      'MO'
     C     W2NR          oreq      'M0'
      * Fra innland til FULL modus.
     C     *IN67         IFEQ      *ON
     C     *IN68         OREQ      *ON
     C                   MOVE      *IN67         GMIN67            1
     C                   MOVE      *IN68         GMIN68            1
     C                   MOVEA     '00'          *IN(67)
     C                   else
      * Fra FULL modus til innland med samme modus som før.
     C                   MOVE      GMIN67        *IN67
     C                   MOVE      GMIN68        *IN68
     C                   END
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START
     C                   END
     C                   END
      * M1,M2,M3 = REN innland UTGÅENDE/INNGÅENDE/Oppdr.modus
     C     innland       IFEQ      'J'
     C     W2NR          andeq     'M1'
     C                   MOVEA     '10'          *IN(67)
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START
     C                   END
     C     innland       IFEQ      'J'
     C     W2NR          andeq     'M2'
     C                   MOVEA     '01'          *IN(67)
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START
     C                   END
S27  C*    innland       IFEQ      'J'
S27  C*    W2NR          andeq     'M3'
S27  C*                  MOVEA     '11'          *IN(67)
S27  C*                  MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
S27  C*                  MOVE      *BLANKS       W2NR
S27  C*                  GOTO      START
S27  C*                  END
      * MG = MODE GATEADRESSE(NÆRDISTRIBUSJON)(UTEN ENDR AV INN/UT-MOD)MODE)
     C     innland       IFEQ      'J'
     C     W2NR          andeq     'MG'
     C     VISGATE       IFEQ      ' '
     C                   MOVE      'J'           VISGATE           1
     C                   ELSE
     C                   MOVE      ' '           VISGATE
     C                   END
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START
     C                   END
      *
      *--------------------------------------
      * F2 BYTTE MODUS, NÅR FULLMODUS - SWITCHE IND 69, ELLERS SOM F5
      *--------------------------------------
      * Indikator 67,68,69....
      * N67 N68 = Full-modus... 69 ON=med avs/mott.navn 69 OFF=Produkt/pris
      *  67 N68 = Innland UTGÅENDE  trafikkdispon.modus
      * N67  68 = Innland INNGÅENDE trafikkdispon.modus
      *  67  68 = Innland - "ORDRE-Behandlingsmodus"    = UTGÅR i V111
      *
     C   02              DO
     c     *IN67         IFEQ      *OFF
     c     *IN68         andeq     *OFF
     C     *IN69         IFEQ      *OFF
     C                   MOVE      *ON           *IN69
     C                   ELSE
     C                   MOVE      *OFF          *IN69
     C                   END
     C                   ELSE
      *
      * VED REN INNLAND ER F2 BYTT MELLOM INNGÅENDE/UTGÅENDE/"ORDRE"-VISNING
      * Fra Utgående -> Inngående
     C     *IN67         IFEQ      *on
     C     *IN68         ANDEQ     *off
     C                   MOVE      *off          *IN67
     C                   MOVE      *On           *IN68
     C                   else
S27  C* Fra Inngående -> Ordre
S27  C*    *IN67         IFEQ      *OFF
S27  C*    *IN68         ANDEQ     *ON
S27  C*                  MOVE      *ON           *IN67
S27  C*                  MOVE      *ON           *IN68
S27  C*                  ELSE
      * Tilbake til utgående
     C                   MOVE      *ON           *IN67
     C                   MOVE      *OFF          *IN68
     C                   END
S27  C*                  END
     C                   end
     C                   MOVE      WSAVD         XAVD
     C                   GOTO      START
     C                   END
      *
      *--------------------------------------
      * F3=AVSLUTT PROGRAM
      *--------------------------------------
      *
     C   03              GOTO      SLUTT
      *
      *--------------------------------------
      * F04 er Søk i top-linja -
      * Om avd er byttet gå videre (så utfæres F17 lenger ned...)
      *--------------------------------------
     C   04              DO
     C                   EXSR      SØKTOP
     C     WSAVDU        IFeq      UDSAVD
     C                   GOTO      START3
     c                   end
     C                   END
      *--------------------------------------
      * F05 er refresh bildet
      *--------------------------------------
      *
     C   05              DO
     C                   MOVE      WSAVD         XAVD
     C                   GOTO      START
     C                   END
      *
      *--------------------------------------
      * F6 = LAGE NYTT OPPDRAG
      * F9 = ARBEIDE MED KOPIERINGSMAL
      *--------------------------------------
      * 1 I TOPPLINJEN BETYR OGSÅ LAGE NY
      *
     C     *IN06         IFNE      '1'
     C     W2NR          ANDEQ     '1 '
     C                   MOVE      '1'           *IN06
     C                   MOVE      *BLANKS       W2NR
     C                   END
     C
     C     *IN06         IFEQ      '1'
     C     *IN09         OREQ      '1'
     C     UUSPØR        IFEQ      'A'
     C                   MOVE      *ZEROS        UUOPD
     C                   MOVE      WSAVDU        UUAVD
     C                   EXSR      CHGOPD
     C                   GOTO      START
     C                   END
     C                   END
      *
      *--------------------------------------
      *  07 = SPØRRRING OPPDRAG GENERELT
      *--------------------------------------
     C   07              DO
     C                   MOVE      'S'           UTYPE2            1
     C                   MOVE      *ZEROS        NULAVD            4 0
     C                   MOVE      *ZEROS        NULOPD            7 0
     C                   MOVE      *BLANKS       NULSG             3
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE2
     C                   PARM                    NULAVD
     C                   PARM                    NULOPD
     C                   PARM                    NULSG
     C                   GOTO      START3
     C                   END
      *--------------------------------------
      *  08 = GÅ TIL SØKING
      *--------------------------------------
      *
     C   08              GOTO      BG2
      *
      * avdeling endret
      *
     C     WSAVDU        IFNE      UDSAVD
     C                   EXSR      TESTB0
     C   30              GOTO      START3
      *  ENDRET AVD=UTFØR F17 (FANGES OPP LITT  LENGER NED
     C                   MOVE      '1'           *IN17
     C                   END
      *--------------------------------------
      *  10 = se på turer i arbeid
      *--------------------------------------
      *
     C   10              DO
     C                   CALL      'SYTR88U'
     C                   GOTO      START3
     C                   END
      *
      *
      *--------------------------------------
      * F11 HENTE-OPPDRAG  (ELLER HO PÅ TOP-OPT)
      *--------------------------------------
      *
     C     *IN11         IFEQ      '1'
     C     W2NR          oreq      'HO'
     C                   MOVE      WSAVDU        AVDHEN            4 0
     C                   CALL      'SYTR34'
     C                   MOVE      *BLANKS       W2NR
     C                   GOTO      START3
     C                   END
      * Sjekke / manelt godkjenne utgående skytemanko
     C     W2NR          Ifeq      'MA'
     C                   CALL      'STSTUR'
     C                   MOVE      *BLANKS       W2NR
     C                   exsr      updboks2
     C                   GOTO      START3
     C                   END
      *
      *--------------------------------------
      * F12 = AVLUTT PROGRAM
      *--------------------------------------
      *
     C   12              GOTO      SLUTT
      *
      *--------------------------------------
      * F13 = VIS E-OPPDRAG PR KUNDE
      *--------------------------------------
     C     *IN13         IFEQ      '1'
     C                   EXSR      ESEND
     c     UFRSOK        cabeq     *blanks       Start3
     C                   GOTO      START
     C                   ENDIF
      *--------------------------------------
      * F16 = VIS UDISPONERTE -SORTERT SIST REGISTRERTE FØRST
      * UDISOP ULIK ' ' Når udisp. skal vises(også etter utfylt bilde2)
      *--------------------------------------
      *                 vis de sortert på synkende oppdragsnr)
      *
     C     *IN16         IFEQ      '1'
     C                   MOVE      'J'           UDISOP            1
     C                   MOVE      '0'           *IN31
     C                   MOVE      '1'           *IN49
     C                   MOVE      '1'           *IN32                           *SKJERMBILD
     C                   EXSR      MOVB2
     C                   GOTO      START
     C                   ENDIF
      *
      *--------------------------------------
      * F17 - VIS UDISPONERTE -SORTERT ELDSTE DATO FØRST (eller fra/tilsted innland)
      *--------------------------------------
      *
     C     *IN17         IFEQ      '1'
     C                   MOVE      ' '           UDISOP            1
     C                   MOVE      '1'           *IN31
     C                   MOVE      '0'           *IN49                           *SORTERING
     C                   MOVE      '0'           *IN32                           *SKJERMBILD
     C                   EXSR      MOVB2
     C                   GOTO      START
     C                   ENDIF
      *
      *--------------------------------------
      * F18 - VIS UDISPONERTE - alle avs SORTERT ELDSTE DATO FØRST (eller fra/tilsted innland)
      *--------------------------------------
     C     *IN18         IFEQ      '1'
N23  C     *IN19         OREQ      '1'
     C                   MOVE      ' '           UDISOP            1
     C                   MOVE      '1'           *IN31
     C                   MOVE      '0'           *IN49                           *SORTERING
     C                   MOVE      '0'           *IN32                           *SKJERMBILD
     C                   EXSR      MOVB2
     C                   MOVE      '1'           *IN(40)                        *alle  avd
     C                   MOVE      *zeros        WSAVD
     C                   MOVE      *zeros        XAVD
N23  C     innland       IFEQ      'J'
N23  c   18              move      'J'           AlleUTG           1
N23  c   19              move      'J'           AlleINNG          1
N23  C                   endif
     C                   GOTO      START
     C                   ENDIF
      *
      *--------------------------------------
      * F20 PLUKK EDI-OPPDRAG
      *--------------------------------------
      *
     C   20              DO
     C     Innland       IFEQ      'J'
     C                   MOVE      'U'           UUR
     C                   end
     C                   CALL      'SYOP21R'
     C                   PARM                    UUR
     C                   GOTO      START3
     C                   END
      *
      *--------------------------------------
      * F22 Hurtigbooking / notisblokk
      *--------------------------------------
      *
     C   22              DO
     C                   MOVE      'N'           HUPLUK
     C                   MOVE      *BLANKS       HUDATA          218
     C                   CALL      'SYHU10'
     C                   PARM                    HUPLUK
     C                   PARM                    HUDATA
     C                   GOTO      START3
     C                   END
      *
      *--------------------------------------
      * F23 flere opsjoner
      *--------------------------------------
      *
     C   23              DO
     C                   EXSR      OPSJON
     C                   GOTO      START3
     C                   END
      *
      *--------------------------------------
      * F24 flere funksjonstaster
      *--------------------------------------
      *
     C   24              DO
     C                   EXSR      CMDFT
     C                   GOTO      START3
     C                   END
      *
      *--------------------------------------
      *** ROLL (25) RULL VIDERE
      *--------------------------------------
      *"""""""""""""""""""""""""""""""""""""""""""""
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   EXSR      MOVXSU
     C                   GOTO      START2
     C                   END
      *
     C     W2SNDN        IFNE      *BLANKS
S27  C*    W2SND2        ORNE      *BLANKS
     C     HE39OP        IFNE      '1'
     C                   OPEN      HEAD39
     C                   END
     C                   END
      *
      * søkebegrep tastet i topplinjen
      *
      *
      * plukk tur til boks A -> D ELLER SET OPPDRAG PÅ TUR
      *
     C     W2NR          IFEQ      'A '
     C     W2NR          oreq      'B '
     C     W2NR          oreq      'C '
     C     W2NR          oreq      'D '
     C                   SELECT
     C     W2SNDN        WHENNE    *BLANKS
     C                   Z-ADD     21            POSNBR
     C                   MOVEL     W2SNDN        W2SNDN20
     C                   EXSR      HENTOPD
     C   30              GOTO      START3
S27  C*    W2SND2        WHENNE    *BLANKS
S27  C*                  Z-ADD     45            POSNBR
S27  C*                  MOVEL     W2SND2        W2SNDN20
S27  C*                  EXSR      HENTOPD
S27  C*  30              GOTO      START3
     C     W2AVD         WHENNE    0
     C                   Z-ADD     5             POSNBR
     C     W2OPD         WHENNE    0
     C                   Z-ADD     10            POSNBR
     C                   ENDSL
     C                   EXSR      PLUTUR
     c     refresh       ifeq      'J'
     c                   goto      start
     c                   else
     C                   EXSR      UPDBOKS2
     c                   goto      start3
     c                   end
     C                   END
      *
      * Fjern tur fra boks A -> D
      *
     C     W2NR          IFEQ      'A0'
     C     W2NR          oreq      'B0'
     C     W2NR          oreq      'C0'
     C     W2NR          oreq      'D0'
     C                   EXSR      PLUTUR0
     c                   goto      start3
     C                   END
      *
      * FJERN OPPDRAG FRA TUR
      *
     C     W2NR          IFEQ      'X '
     C                   SELECT
     C     W2SNDN        WHENNE    *BLANKS
     C                   Z-ADD     21            POSNBR
     C                   MOVEL     W2SNDN        W2SNDN20
     C                   EXSR      HENTOPD
     C   30              GOTO      START3
S27  C*    W2SND2        WHENNE    *BLANKS
S27  C*                  Z-ADD     45            POSNBR
S27  C*                  MOVEL     W2SND2        W2SNDN20
S27  C*                  EXSR      HENTOPD
S27  C*  30              GOTO      START3
     C     W2AVD         WHENNE    0
     C                   Z-ADD     5             POSNBR
     C     W2OPD         WHENNE    0
     C                   Z-ADD     10            POSNBR
     C                   ENDSL
     C     W2AVD         IFEQ      0
     C                   MOVE      WSAVDU        W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  HEADF                              33
     C  N33L2T(1)        IFEQ      DITUR
     C     L2T(2)        OREQ      DITUR
     C     L2T(3)        OREQ      DITUR
     C     L2T(4)        OREQ      DITUR
     C                   EXSR      TAAVTUR
     C     *IN30         IFEQ      '0'
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   END
     C                   END
     C                   GOTO      START3
     C                   END
      *
      *
      * Inn på turheader til tur i boks A -> D
      *
     C     W2NR          IFEQ      'A2'
     C     W2NR          oreq      'B2'
     C     W2NR          oreq      'C2'
     C     W2NR          oreq      'D2'
     C                   EXSR      PLUTUR2
     c     refresh       ifeq      'J'
     c                   goto      start
     c                   else
     c                   goto      start3
     c                   end
     C                   END
      *
      * SAMTAKSERE
     C     W2NR          IFEQ      'AS'
     C     W2NR          oreq      'BS'
     C     W2NR          oreq      'CS'
     C     W2NR          oreq      'DS'
     C                   EXSR      SAMTUR
     C                   goto      start3
     C                   END
      *
      *
      * Print LASTE-LISTE  A -> D
      *
     C     W2NR          IFEQ      'AL'
     C     W2NR          oreq      'BL'
     C     W2NR          oreq      'CL'
     C     W2NR          oreq      'DL'
     C                   EXSR      LASTELI
     c                   goto      start3
     C                   END
      *
      *
      * Print GODSLISTE   A -> D (+ AVSLUTT TUREN).
      *
     C     W2NR          IFEQ      'AG'
     C     W2NR          oreq      'BG'
     C     W2NR          oreq      'CG'
     C     W2NR          oreq      'DG'
     C     W2NR          oreq      'AN'
     C     W2NR          oreq      'BN'
     C     W2NR          oreq      'CN'
     C     W2NR          oreq      'DN'
     C                   EXSR      GODSLI
     c                   goto      start3
     C                   END
      *
      *
      * vis kun tur i en boks A -> D
      *
     C     W2NR          IFeq      'AT'
     C     W2NR          oreq      'BT'
     C     W2NR          oreq      'CT'
     C     W2NR          oreq      'DT'
     C                   EXSR      VISTUR
     c   30              goto      start3
     c                   move      '  '          w2nr
     c                   move      '  '          wSnr
     C                   EXSR      SETOFIN
     C                   MOVEA     '1'           *IN(40)
     C                   MOVEA     '1'           *IN(49)
     C                   MOVEA     '0'           *IN(32)
     c                   goto      START
     C                   END
      *
      *
      *ANNEN ENDRING
      *
     C     W2NR          IFNE      *BLANKS                                      1<-B
     C     W2TUR         ORNE      0
     C     W2OPD         ORNE      0
     C     W2STA1        ORNE      WSDIST
     C     W2SDF         ORNE      *BLANKS
     C     W2SDFD        ORNE      0
     C     W2SDT         ORNE      *BLANKS
N27  C     W2RFA         ORNE      *BLANKS
N27  C     W2TT          ORNE      *BLANKS
     C     W2OT          ORNE      *BLANKS
     C     W2SNDN        ORNE      *BLANKS
S27  C*    W2SND2        ORNE      *BLANKS
      *
      * KALLER EVENTUELT SØK HVIS W2NR  = BLANK
      *
     C     W2NR          IFEQ      *BLANKS                                       2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
      *
      * ELLERS BEHANDLER ETTER TASTET OPSJON
      *
     C                   ELSE                                                    2
     C     W2SNDN        IFNE      *BLANKS
S27  C*    W2SND2        ORNE      *BLANKS
S27  C*    W2SNDN        IFEQ      *BLANKS
S27  C*                  MOVEL     W2SND2        W2SNDN20
S27  C*                  ELSE
     C                   MOVEL     W2SNDN        W2SNDN20         20
S27  C*                  END
     C                   EXSR      HENTOPD
     C   30              GOTO      START3
     C                   END
      *
     C     W2AVD         IFEQ      0
     C                   MOVE      WSAVDU        W2AVD
     C                   END
     C     W2OPD         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0039'     MSGNR
     C                   ELSE                                                     3
     C                   MOVE      'J'           TOPPLI            1
     C                   EXSR      NYOPT
     C   98              MOVE      'N'           TOPPLI
     C   98              MOVE      '1'           *IN30
     C   98              GOTO      START3
     C                   EXSR      HHENT
     C                   MOVE      'N'           TOPPLI
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
n44  c     refresh       ifeq      'J'
n44  c                   goto      start
n44  c                   else
     C                   GOTO      START3
n44  C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
      *
      * VED BLANKS OPSJON ENDRE AVDELING
      *
     C     W2AVD         IFNE      0                                             2<-B
     C                   MOVE      W2AVD         WSAVD
     C                   MOVE      W2AVD         XAVD
     C                   MOVE      *ZEROS        W2AVD
      *  Innland - kun avd fylt ut..= Udisponerte
     C     *IN67         IFEQ      *ON
     C     *IN68         OREQ      *ON
     C                   MOVE      'U'           WSDIST
     C                   MOVE      *zeros        WSPRO
      *
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '00'          *IN(62)
     C                   MOVEA     '00000'       *IN(27)
     C                   MOVE      '0'           *IN34
     c                   exsr      TESTB2
     c                   end
     C                   GOTO      START
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
      *_____________________________________________
      * Enter er tastet (eller F23) - sjekk options.
      *"""""""""""""""""""""""""""""""""""""""""""""
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
      *
      * Sjekk om riktig option er tastet????
      *
     C                   EXSR      HHENT
     c     refresh       ifeq      'J'
     c                   goto      start
     c                   else
     c     refresh       ifeq      'T'
     C                   EXSR      SETOFIN
     C                   MOVEA     '1'           *IN(40)
     C                   MOVEA     '1'           *IN(49)
     c                   goto      START
     c                   else
     c                   goto      start3
     c                   end
     c                   end
      *
      *
      *_____________________________________________
      * UTFØR DE ULIKE OPTIONS
      *"""""""""""""""""""""""""""""""""""""""""""""
      *
     C*
     C                   END
      *
      * AVSLUTT PROGRAM
      *
     C     SLUTT         TAG
      *
     c     innland       ifeq      'J'
     C                   EXSR      boksend
     c                   end
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     HENTOPD       BEGSR
      ***********************************************
     C     W2SNDN20      CHAIN     HEAD39                             30
     C     *IN30         IFEQ      '1'
     C                   MOVE      'YBC1798'     MSGNR
     C                   Z-ADD     5             LINNBR
     C     W2SNDN        IFNE      *BLANKS
     C                   Z-ADD     21            POSNBR
     C                   ELSE
     C                   Z-ADD     45            POSNBR
     C                   END
     C                   else
     C                   MOVE      HEAVD         W2AVD
     C                   MOVE      HEOPD         W2OPD
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     ESEND         BEGSR
      ***********************************************
      * VIS E-SENDINGER - PLUKK ETT EDIMOTTAK
     C                   MOVE      'J'           W2ETER            1
     C                   MOVE      *zeros        UZTERM
     C                   CALL      'SYTR33E'
     C                   PARM                    UZTERM            4 0
     C                   PARM                    UFRKOD            3
     C                   PARM                    UFRSOK           35
     c     UFRSOK        cabeq     *blanks       UTESND
     C                   MOVE      '0'           *IN31
     C                   MOVE      '0'           *IN49
     C                   MOVE      '0'           *IN32
     C                   EXSR      MOVB2
     C                   MOVE      '1'           *IN40                           på tvers av avd
     C                   MOVE      *zeros        WSAVD
     C                   MOVE      *zeros        XAVD
     C                   MOVE      '1'           *IN62
     C                   MOVE      'E'           WSDIST
     C                   MOVE      'E'           W2STA1
     C                   MOVE      'E'           YDIST
     C                   MOVEL     UFRKOD        WSFRI1
     C                   MOVEL     UFRSOK        WSFRI2
     c                   eval      YFRI2 =%trim(WSFRI2)+'9999999999999999999999'
     C     DI19OP        IFNE      '1'
     C                   OPEN      DISPL19
     C                   END
      *
     C     UTESND        ENDSR
      *
      ***********************************************
s22  C*    DSPFAX        BEGSR
      ***********************************************
s22  C*    KKKHEA        CHAIN     FAXLOG03                           33
s22  C* N33              DO
s22  C*                  MOVE      'J'           FINS
s22  C*                  CALL      'FAXDSP'
s22  C*                  PARM                    LODOCN
s22  C*                  PARM                    LOMAPP
s22  C*                  PARM                    FINS              1
s22  C*                  END
      *
s22  C*                  ENDSR
      *
      ***********************************************
     C     WRKTT         BEGSR
      ***********************************************
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
      *
     C     MODOK         IFNE      'J'
     C                   MOVEL     'TRACK&TR'    UMODUL           15
     C                   MOVE      'ACE    '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTTT
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      *
     C                   Z-ADD     1             TTFLAG            1 0
N18  C                   Z-ADD     0             TTTUR             8 0
     C                   CALL      'SYTT01CL'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
N18  C                   PARM                    TTTUR
     C                   PARM                    TTFLAG
      *
     C     UTTT          ENDSR
      *
      ***********************************************
     C     WRKTTT        BEGSR
      ***********************************************
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
      *
     C     MODOK         IFNE      'J'
     C                   MOVEL     'TRACK&TR'    UMODUL           15
     C                   MOVE      'ACE    '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTTTT
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
      *
     C                   Z-ADD     1             TTFLAG            1 0
     C                   CALL      'SYTT02CL'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    TTFLAG
      *
     C     UTTTT         ENDSR
      *
      ***********************************************
     C     BUDSR         BEGSR
      ***********************************************
     C                   MOVE      'O'           P1FLAG
     C                   MOVE      *ZEROS        P1BNR
     C                   MOVE      *ZEROS        P1AVD
     C                   MOVE      *ZEROS        P1TUNR
     C                   MOVE      HEAVD         P1OAVD
     C                   MOVE      HEOPD         P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
     C                   ENDSR
      ***********************************************
     C     DOKUME        BEGSR
      ***********************************************
     C                   CALL      'SYOPDO'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   ENDSR
      ***********************************************
     C     arkivs        BEGSR
      ***********************************************
     C                   CALL      'ARC003'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    URUNDE           10
     C                   endsr
n21   ***********************************************
n21  C     prisfo        BEGSR
n21   ***********************************************
     c                   move      'E'           ukode
n21  C                   CALL      'ARC045'
n21  C                   PARM                    HEAVD
n21  C                   PARM                    HEOPD
     c                   parm                    kunul             8 0
n21  C                   PARM                    UKODE             1
n58  C                   PARM                    EMNE             80
n21  C                   endsr
n30   ***********************************************
n30  C     sendepf       BEGSR
n30   ***********************************************
      * sende fraktbrev og merkelapp fra ordre på epost
n30  C                   CALL      'SYGE72'
n30  C                   PARM                    HEAVD
n30  C                   PARM                    HEOPD
n30  C                   endsr
n71   ***********************************************
n71  C     sendSMS       BEGSR
n71   ***********************************************
n71   * sende SMS
n71  C                   MOVE      HEAVD         PAVD2             4
n71  C                   MOVE      HEOPD         POPD2             7
n71  C                   CALL      'SYOPSMS'
n71  C                   PARM                    PAVD2
n71  C                   PARM                    POPD2
n71  C                   endsr
n25   ***********************************************
n25  C     fraktbre      BEGSR
n25   ***********************************************
n25  C                   MOVE      HEAVD         PAVD2             4
n25  C                   MOVE      HEOPD         POPD2             7
n25  C                   MOVE      *ZEROS        PTUR2             8
n25  C                   CALL      'SYFA12CLD'
n25  C                   PARM                    PAVD2
n25  C                   PARM                    POPD2
n25  C                   PARM                    PTUR2
n25  C                   endsr
      ***********************************************
     C     PRTSKILL      BEGSR
      ***********************************************
     C                   MOVE      '  '          SCATYP            2
     C                   MOVEL     HEAVD         SCASTR11         11
     C                   MOVE      HEOPD         SCASTR11         11
     C                   MOVEL     SCASTR11      SCASTR           20
     C                   CALL      'ARCA000CL'
     C                   PARM                    SCATYP
     C                   PARM                    SCASTR
     C                   ENDSR
      ***********************************************
     C     WRKSAD        BEGSR
      ***********************************************
     C                   MOVE      HEAVD         SADAVD            4
     C                   MOVE      HEOPD         SADTDN            7
     C     KKKHEA        CHAIN(N)  HEADF                              33
     C     HELKA         IFNE      FILAND
     C                   CALL      'SAD61CLD'
     C                   PARM                    SADAVD
     C                   PARM                    SADTDN
     C                   CALL      'SAD61P01'
     C                   PARM                    UPRT1            10
     C                   PARM                    UPRT2            10
     C                   PARM                    UPRT3            10
     C                   ELSE
     C                   CALL      'SAD52CLD'
     C                   PARM                    SADAVD
     C                   PARM                    SADTDN
     C                   PARM      HESG          SESG              3
     C                   CALL      'SAD52P01'
     C                   PARM                    UPRT1            10
     C                   PARM                    UPRT2            10
     C                   PARM                    UPRT3            10
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     WRKMRK        BEGSR
      ***********************************************
     C                   MOVE      HEAVD         PAVD2             4
     C                   MOVE      HEOPD         POPD2             7
     C                   CALL      'SYFA94R'
     C                   PARM                    PAVD2
     C                   PARM                    POPD2
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB0        BEGSR
     C***********************************************
     C     KODAKA        CHAIN     KODTA                              96
     C     *IN96         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   ELSE
     C                   MOVE      WSAVDU        UDSAVD
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETOFIN       BEGSR
     C***********************************************
      *
      * SLÅR AV SØKEINDIKATORER
      *
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '00'          *IN(62)
     C                   MOVEA     '00000'       *IN(27)
     C                   MOVE      '0'           *IN34
N28  C                   MOVE      '0'           *IN79
N37  C                   MOVE      '0'           *IN77
     c                   move      *blank        w2sta1
     C                   ENDSR
     C***********************************************
     C     SØKF04        BEGSR
     C***********************************************
      *
      * avdeling
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     26
     C                   CALL      'SYFA14B'
     C                   PARM                    WSavd
     C                   Z-ADD     20            POSNBR
     C                   Z-ADD     5             LINNBR
     C                   GOTO      UTSØK
     C                   END
      *
N23   * søk etter hentestaus i filterbildet
N23  C     LINNBR        IFEQ      9
N23  C     POSNBR        ANDGE     78
N23  C                   CALL      'SYTR33HV'
N23  C                   PARM                    WSHSTAT
N23  C                   GOTO      UTSØK
N23  C                   END
      *
      * SØK ETTER TURNR
      *
s53  C*    LINNBR        IFEQ      15
n53  C     LINNBR        IFEQ      16
     C                   MOVE      'O'           USPØR             1
     C                   MOVE      0             UFLAGG
     C                   MOVE      *ZEROS        ZRUND             8 0
     C                   MOVE      *ZEROS        ZOPD              7 0
     C                   CALL      'SYTR88'
     C                   PARM                    WSPRO
     C                   PARM                    ZRUND
     C                   PARM                    WSAVD
     C                   PARM                    ZOPD
     C                   PARM                    USPØR
     C                   PARM                    UFLAGG
     C                   MOVE      0             UFLAGG
     C                   GOTO      UTSØK
     C                   END
      *
      * SØK ETTER agentnummer
      *
     C     LINNBR        IFEQ      11
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSNRAG
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      UTSØK
     C                   END
      *
      *
      * SØK ETTER KUNDENR OPPDRAGSGIVER
      *
     C     LINNBR        IFEQ      13
N56  C     WXTRAN        IFEQ      'T'
N56  C                   CALL      'SYTR04A'
N56  C                   PARM                    WSAGNR
N56  C                   ELSE
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSAGNR
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      UTSØK
N56  C                   END
     C                   END
      *
      * signatur
      *
s53  C*    LINNBR        IFEQ      16
n53  C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     22
     C                   move      'P'           sgpluk            1
     C                   CALL      'SYFA60'
     C                   PARM                    sgpluk
     C                   PARM                    WSSG
     C                   Z-ADD     36            POSNBR
     C                   GOTO      UTSØK
     C                   END
      *
      *
      * SØK ETTER KUNDENR SELGER
      *
s53  C*    LINNBR        IFEQ      17
n53  C     LINNBR        IFEQ      18
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNSF
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      UTSØK
     C                   END
      *
      * SØK ETTER KUNDENR KJØPER
      *
s53  C*    LINNBR        IFEQ      18
n53  C     LINNBR        IFEQ      19
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNKF
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      UTSØK
     C                   END
      *
      * FRIE SØKEVEIER
      *
S53  C*    LINNBR        IFEQ      21
S53  C     LINNBR        IFEQ      22
     C                   CALL      'SYFA65A'
     C                   PARM                    WSFRI1
     C                   Z-ADD     24            POSNBR
     C                   GOTO      UTSØK
     C                   END
      *
      * SØK STED
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        IFLT      9
     C                   MOVE      WSSTEF        USØKSD            5
     C                   MOVE      *BLANKS       USØKTX           30
     C                   MOVEL     WSSTEF        USØKTX
     C                   MOVE      *BLANKS       USØKLK            2
     C                   CALL      'SYFI10F'
     C                   PARM                    USØKSD
     C                   PARM                    USØKTX
     C                   PARM                    USØKLK
     C                   MOVE      USØKSD        WSSTEF
     C                   MOVEL     USØKLK        WSSONF
     C                   Z-ADD     10            POSNBR
     C                   GOTO      UTSØK
     C                   ELSE
     C                   MOVE      WSSTET        USØKSD
     C                   MOVE      *BLANKS       USØKTX
     C                   MOVEL     WSSTET        USØKTX
     C                   MOVE      *BLANKS       USØKLK
     C                   CALL      'SYFI10F'
     C                   PARM                    USØKSD
     C                   PARM                    USØKTX
     C                   PARM                    USØKLK
     C                   MOVE      USØKSD        WSSTET
     C                   MOVEL     USØKLK        WSSONT
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      UTSØK
     C                   END
     C                   END
     C*
     C     UTSØK         ENDSR
      *
     C***********************************************
     C     SØKTOP        BEGSR
     C***********************************************
      * SØK I TOP-LINJA.
      *
      * avdeling
     C     LINNBR        IFEQ      2
     C                   CALL      'SYFA14B'
     C                   PARM                    WSavdU
     C                   GOTO      UTSTOP
     C                   END
      *
      * INNLAND = 67 ELLER 68 ON
     C     *IN67         IFEQ      '1'
     C     *IN68         OREQ      '1'
      * SØK ETTER TOPOPT-
     C     LINNBR        IFEQ      05
     C     POSNBR        ANDGE     02
     C     POSNBR        ANDLE     03
     C                   MOVE      'N'           UUPDAT            5
     C                   MOVEL     'INLTOPOPT'   XKFTYP           10
     C                   MOVEL     W2NR          XKFKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    XKFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XKFKOD
     C     XKFKOD        IFNE      *BLANK
     C                   MOVEL     XKFKOD        W2NR
     C                   END
     C                   GOTO      UTSTOP
     C                   END
     C                   ELSE
      * FULL.MODUS. INNLAND/UTLAND
      *..
      *..
     C                   END
     C*
     C     UTSTOP        ENDSR
      *
      *
      ***********************************************
     C     CHGOPD        BEGSR
      ***********************************************
      *
     C                   MOVE      '0'           UUFUNK
     C   06              MOVE      '6'           UUFUNK
     C   09              MOVE      '9'           UUFUNK
     C   06              MOVE      *BLANKS       UURETU
     C   09              MOVE      *BLANKS       UURETU
     C                   MOVE      *BLANKS       GMSTA2            1
      *
      *
      * Opsjon utført  Subfil skal oppdateres - Gmsta2=J
      * ikke ved 3S
     C     UURETU        IFEQ      '2'                                           B2
     C     UURETU        OREQ      '6'                                           B2
N44  C     WSNR          ifne      '3S'
N44  C     WSNR          andne     'O '
N44  C     WSNR          andne     ' O'
     C                   MOVE      'J'           GMSTA2
      *
      * Endre mønsteroppdrag/kopieringsmal - sett "hjelpeflagg"
      *
     C     DISTA1        IFEQ      'M'                                            b3
     C                   MOVE      '2'           UURETU                           6=IKKE LOV
     C                   MOVE      '9'           UUFUNK
     C                   END                                                      e3
N44  C                   END                                                      e3
     C                   END                                                     E2
      *
      * KALL VEDLIKEHOLDSPROG. FOR NYREG/VEDLIKEH/
      *
     C     UURETU        IFEQ      '3'
     C     UUFUNK        OREQ      '6'
     C     UUFUNK        OREQ      '9'
     C                   MOVE      'J'           XTSTA             1
     C                   ELSE
     C                   MOVE      'N'           XTSTA             1
     C                   END
      *
      * ved innland
      *
     C     Innland       IFEQ      'J'
     C                   MOVE      UUSPØR        UISPØR            1
     C     UUFUNK        IFEQ      '6'
     C     UUAVDC        ORNE      0
     C                   MOVE      'U'           UUSPØR
     C  N67
     CAN 68              MOVE      'I'           UUSPØR
     C                   ELSE
     C                   MOVE      'U'           UUSPØR
     C     KODAKT        CHAIN     KODTA                              33
     C     *IN33         IFEQ      '0'
     C     KOAIE         ANDEQ     '2'
     C                   MOVE      'I'           UUSPØR
     C                   END
     C                   END
     C                   END
      *
      * innland slutt
      *
     C                   CALL      'SYTR10'
     C                   PARM                    UUAVD             4 0
     C                   PARM                    UUAVDC            4 0
     C                   PARM                    UUOPD             7 0
     C                   PARM                    UUSPØR            1
     C                   PARM                    UURETU            1
     C                   PARM                    UUFUNK            1
     C     Innland       IFEQ      'J'
     C                   MOVE      UISPØR        UUSPØR
     C                   END
      *
      *
     C     XTSTA         IFEQ      'J'
     C     WSAVDU        ANDNE     UUAVD
     C                   MOVE      UUAVD         WSAVDU
     C                   END
      *
      * GMSTA2=J = Opt 2/6 utført - oppdater subfil
      *
     C     GMSTA2        IFEQ      'J'                                           B2
      *
      * HENT EVT. ENDREDE VERDIER OG OPPDATER SUBFILE
      * uuretu=2=opt2=endre oppdrag, Uuretu=6=opt6=rett til fakt VIA SYTR10.
     C     KKKHEA        CHAIN(N)  HEADF                              33
     C     KKKHEA        CHAIN(N)  DISP                               33
     C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END                                                     E2
     C                   ENDSR
      *
     C***********************************************
     C     SEOPD         BEGSR
     C***********************************************
      *
      * spørring på oppdrag med option 5
      *
     C*
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   CALL      'SYFM21A'
     C                   PARM                    FIFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      9                                      12
     c     uflagg        ifeq      0
     c                   exsr      utfakt
     c                   end
     C*
     C                   ENDSR
      *
     C***********************************************
     C     SEWEB         BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Se SYSPED oppdrag på WEB (eSped) '
     C                   EVAL      WebType = 'ESPEO'
     C                   move      HEAVD         HEAVDA            4
     C                   move      HEOPD         HEOPDA            7
     C                   EVAL      WebSok  = '&heavd='+HEAVDA+
     C                             '&heopd='+HEOPDA
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C                   ENDSR
      ***********************************************
     C     SNDEPW        BEGSR
      ***********************************************
     C                   MOVE      HEAVD         UAVD2             4
     C                   MOVE      HEOPD         UOPD2             7
     C                   CALL      'SYTR33CW'
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
      *
     C                   ENDSR
      *
      ***********************************************
     C     UTFAKT        BEGSR
      ***********************************************
     C                   CALL      'SYFM21B'
     C                   PARM                    FIFIRM
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      9                                      12
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVB2         BEGSR
      ***********************************************
      *
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '0000000'     *IN(50)
     C                   MOVEA     '000'         *IN(62)
     C                   MOVEA     '0000'        *IN(27)
     C                   MOVE      '0'           *IN34
     C                   MOVE      '0'           *IN(40)                        *spesif. avd
     C                   MOVE      WSAVDU        WSAVD
     C                   MOVE      WSAVDU        XAVD
     C                   MOVE      'U'           WSDIST
     C                   MOVE      'U'           W2STA1
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *BLANKS       WSOPDT
     C                   MOVE      *ZEROS        WSDATO
     C                   MOVE      *ZEROS        WSDATT
     C                   MOVE      *ZEROS        LLDATO
     C                   MOVE      *ZEROS        TOMDATO           8 0
     C                   MOVE      *BLANKS       WSSTEF
     C                   MOVE      *BLANKS       WSSTET
     C                   MOVE      *BLANKS       WSSONF
     C                   MOVE      *BLANKS       WSSONT
     C                   MOVE      *BLANKS       WSAGNR
     C                   MOVE      *BLANKS       WSNRAG
     C                   MOVE      *BLANKS       WSRFA
N37  C                   MOVE      *BLANKS       WSRFK
     C                   MOVE      *ZEROS        WSPRO
     C                   MOVE      *BLANKS       WSSG
     C                   MOVE      *ZEROS        WSKNSF
     C                   MOVE      *ZEROS        WSKNKF
     C                   MOVE      *BLANKS       WSGN
     C                   MOVE      *ZEROS        WSFN
     C                   MOVE      *BLANKS       WSHAWN
     C                   MOVE      *BLANKS       WSFRI1
     C                   MOVE      *BLANKS       WSFRI2
     C                   MOVE      *Zeros        WSVKTU
     C                   MOVE      *Zeros        WSVKTO
     C                   MOVE      *BLANKS       WSHNAV
     C                   MOVE      *BLANKS       WSLNAV
N61  C                   MOVE      *BLANKS       WSKFR
N23  c                   move      ' '           AlleUTG           1
N23  c                   move      ' '           AlleINNG          1
N64  C                   MOVE      *BLANKS       UFAKT
N64  C                   MOVE      *BLANKS       WSMIAV
N64  C                   MOVE      *BLANKS       WSHSTAT
N64  C                   MOVE      *BLANKS       WXSTEF
N64  C                   MOVE      *BLANKS       WXSTET
N64  C                   MOVE      *BLANKS       WXSONF
N64  C                   MOVE      *BLANKS       WXSONT
N64  C                   MOVE      *BLANKS       WXOPDT
N64  C                   MOVE      *BLANKS       WXNRAG
N64  C                   MOVE      *BLANKS       WXHAWN
N64  C                   MOVE      *BLANKS       WXAGNR
N64  C                   MOVE      *BLANKS       WXRFA
N64  C                   MOVE      *BLANKS       WXRFK
N64  C                   MOVE      *BLANKS       WXPRO
N64  C                   MOVE      *BLANKS       WXSG
N64  C                   MOVE      *BLANKS       WXKNSF
N64  C                   MOVE      *BLANKS       WXSEVA
N64  C                   MOVE      *BLANKS       WXKNKF
N64  C                   MOVE      *BLANKS       WXKJVA
N64  C                   MOVE      *BLANKS       WXGN
N64  C                   MOVE      *BLANKS       WSUTEN
N64  C                   MOVE      *BLANKS       WXFN
N64  C                   MOVE      *BLANKS       WSMERK
N66  C                   MOVE      *BLANKS       WSPBST
     C*
     C                   ENDSR
      *
      ***********************************************
     C     MOVSUX        BEGSR
      ***********************************************
      * Post er lest, men skal først senere skrives til subfil.
      * Flytter de nødvendige subfilbegrep + nødvendige andre begrep
      * for subrutina SETSUB (som henter HEADTR +setter en del
      * indikatore m.m. umiddelbart før write av subfil)
      *
      * Felt i subfila som er hentet opp FØR SETSUB
      *
     C                   MOVE      HEAVD         XXAVD
     C                   MOVE      HEOPD         XXOPD
     C                   MOVE      HENAS         XXNAS
     C                   MOVE      HEadS1        XXADS1
     C                   MOVE      HENAK         XXNAK
     C                   MOVE      HEadK1        XXADK1
     C                   MOVE      DITUAV        XXTUAV
     C                   MOVE      DITUR         XXTUR
     C                   MOVE      HESG          XXSG
     C                   MOVE      DUPASG        XXPASG
     C                   MOVE      DISTA1        XXSTA1
     C                   MOVE      HESDF         XXSDF
     C                   MOVE      HESDT         XXSDT
s27  C*                  MOVE      HENT4         XXNT4
s27  C*                  MOVE      HEVS10        XXVS10
N27  C                   MOVE      HENT          XXNT
V27  C                   MOVE      HEVS1         XXVS1
     C                   MOVE      HEM3          XXM3
     C                   MOVE      HELM          XXLM
N39  C                   MOVE      HELMLA        XXLMLA
N39  C                   MOVE      HEPOEN        XXPOEN
     C                   MOVE      HEOT          XXOT
     C                   MOVE      HEFR          XXFR
     C                   MOVE      HEST          XXST
     C                   MOVE      WXTUR         XXTURX
     C                   MOVE      WXHAWB        XXHAWX
     C                   MOVE      TRSDFD        XXSDFD
N27  C                   MOVE      TRSDFK        XXSDFK
     C                   MOVE      TRSTAF        XXSTAF
     C                   MOVE      TRSDTD        XXSDTD
N27  C                   MOVE      TRSDTK        XXSDTK
     C                   MOVE      TRSTAE        XXSTAE
     C                   MOVE      HEVKTW        XXVKTW
     C                   MOVE      ETTE          XXETTE
     C                   MOVE      IMCO          XXIMCO
N27  C                   MOVE      FAREKL        XXFAREKL
N27  C                   MOVE      HERFA         XXRFA
N50  C                   MOVE      HERFK         XXRFK
N27  C                   MOVE      HENLEV        XXHENLEV
      *
      * Felt som ikke inngår i subfila, men benyttes i SETSUB
      *
     C                   MOVE      HESDFF        XXSDFF
     C                   MOVE      HESDVT        XXSDVT
     C                   ENDSR
      *
      ***********************************************
     C     MOVXSU        BEGSR
      ***********************************************
      * Felt i subfila som er hentet opp FØR SETSUB
      *
     C                   MOVE      XXAVD         HEAVD
     C                   MOVE      XXOPD         HEOPD
     C                   MOVE      XXNAS         HENAS
     C                   MOVE      XXads1        HEads1
     C                   MOVE      XXNAK         HENAK
     C                   MOVE      XXadk1        HEadk1
     C                   MOVE      XXTUAV        DITUAV
     C                   MOVE      XXTUR         DITUR
     C                   MOVE      XXSG          HESG
     C                   MOVE      XXPASG        DUPASG
     C                   MOVE      XXSTA1        DISTA1
     C                   MOVE      XXSDF         HESDF
     C                   MOVE      XXSDT         HESDT
s27  C*                  MOVE      XXNT4         HENT4
s27  C*                  MOVE      XXVS10        HEVS10
n27  C                   MOVE      XXNT          HENT
n27  C                   MOVE      XXVS1         HEVS1
     C                   MOVE      XXM3          HEM3
     C                   MOVE      XXLM          HELM
N39  C                   MOVE      XXLMLA        HELMLA
N39  C                   MOVE      XXPOEN        HEPOEN
     C                   MOVE      XXOT          HEOT
     C                   MOVE      XXFR          HEFR
     C                   MOVE      XXST          HEST
     C                   MOVE      XXTURX        WXTUR
     C                   MOVE      XXHAWX        WXHAWB
     C                   MOVE      XXSDFD        TRSDFD
N27  C                   MOVE      XXSDFK        TRSDFK
     C                   MOVE      XXSTAF        TRSTAF
     C                   MOVE      XXSDTD        TRSDTD
N27  C                   MOVE      XXSDTK        TRSDTK
     C                   MOVE      XXSTAE        TRSTAE
     C                   MOVE      XXVKTW        HEVKTW
     C                   MOVE      XXETTE        ETTE
     C                   MOVE      XXIMCO        IMCO
N27  C                   MOVE      XXFAREKL      FAREKL
N27  C                   MOVE      XXRFA         HERFA
N50  C                   MOVE      XXRFK         HERFK
N27  C                   MOVE      XXHENLEV      HENLEV
      *
      * Felt som ikke inngår i subfila, men benyttes i SETSUB
      *
     C                   MOVE      XXSDFF        HESDFF
     C                   MOVE      XXSDVT        HESDVT
     C*
     C                   ENDSR
      *
      ***********************************************
     C     TESTB2        BEGSR
      ***********************************************
N64   * maipuler Frisok/IFB / evt KolliID derom AI 401 / 00 er oppfitt
N29   * sendinsgsnr oppgitt i fri søkevei ifb med 20 lang (skannet) (N46 - flutte i toppen)
N29  C                   IF        WSFRI1='IFB' and %subst(WSFRI2:1:3)='401'
N29  C                             and  %subst(WSFRI2:20:1)<>' '
N29  C                             and  %subst(WSFRI2:21:1)= ' '
N29  C                   eval      WSFRI2=%subst(WSFRI2:4:17)
N29  C                   ENDIF
      * kolli-IDs
N64  C                   IF        %subst(WSMERK:1:2)='00'
N64  C                             and  %subst(WSMERK:20:1)<>' '
N64  C                             and  %subst(WSMERK:21:1)= ' '
N64  C                   eval      WSMERK=%subst(WSMERK:3:18)
N64  C                   ENDIF
N64   * SØK PÅ IFB MED EKSAKT 17 LANG eller via WSMERK = godsmerke/kolli eksakt 18 lang
N64   *        TRUMFER ALT = FINN OPPDRAG VIS HOVED /DUP (SE OPT HO)
N64   * Fraktbrev...
N64  C                   IF        WSFRI1='IFB' and
N64  C                             %subst(WSFRI2:17:1)<> ' ' and
N64  C                             %subst(WSFRI2:18:1)=  ' '
N64  C     FR01OP        IFNE      '1'
N64  C                   OPEN      FRISOL01
N64  C                   END
N64  C     FbKey         KLIST
N64  C                   KFLD                    WSFRI1
N64  C                   KFLD                    WSFRI2
N64  C     FbKey         CHAIN     FRISOL01
N64  C                   IF        %found(FRISOL01)
N64  C                   move      FSAVD         HEAVD
N64  C                   move      FSOPD         HEOPD
N64  C                   exsr      HovDupArr
N64  C                   move      'J'           VisHovDup
N64  C                   move      *off          *in30
N64  C                   goto      SLTB2
N64  C                   ENDIF
N64  C                   ENDIF
N64   * KolliId.....
N64  C                   IF        %subst(WSMERK:18:1)<> ' ' and
N64  C                             %subst(WSMERK:19:1)=  ' '
N64  C     DFM1OP        IFNE      '1'
N64  C                   OPEN      DOKUFM1
N64  C                   END
N64  C     WSMERK        CHAIN     DOKUFM1
N64  C                   IF        %found(DOKUFM1)
N64  C                   move      FMAVD         HEAVD
N64  C                   move      FMOPD         HEOPD
N64  C                   exsr      HovDupArr
N64  C                   move      'J'           VisHovDup
N64  C                   move      *off          *in30
N64  C                   goto      SLTB2
N64  C                   ENDIF
N64  C                   ENDIF
      *
      * FIXER DATOBEGREP
      *
     C     WSDATO        IFEQ      *ZEROS
     C                   MOVE      *ZEROS        LLDATO
     C                   ELSE
     C                   MOVE      WSDATO        DATO0
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    DATO0
     C     DATO0         IFGT      501231
     C     DATO0         ADD       19000000      LLDATO
     C                   ELSE
     C     DATO0         ADD       20000000      LLDATO
     C                   END
     C                   END
      * T.O.M dato
     C     WSDATT        IFEQ      *ZEROS
     C                   MOVE      *ZEROS        TOMDATO
     C                   ELSE
     C                   MOVE      WSDATT        DATO0
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    DATO0
     C     DATO0         IFGT      501231
     C     DATO0         ADD       19000000      TOMDATO
     C                   ELSE
     C     DATO0         ADD       20000000      TOMDATO
     C                   END
     C                   END
s64   * flyttet i toppen av SR
s64   * sendinsgsnr oppgitt i fri søkevei ifb med 20 lang (skannet)
s64  C*                  IF        WSFRI1='IFB' and %subst(WSFRI2:1:3)='401'
s64  C*                            and  %subst(WSFRI2:20:1)<>' '
s64  C*                            and  %subst(WSFRI2:21:1)= ' '
s64  C*                  eval      WSFRI2=%subst(WSFRI2:4:17)
s64  C*                  ENDIF
     C*
     C*_________________________________________________________
     C* Setter maksverdier for lesing av sted/sone kun delvis utfylt
     C*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   EXSR      MAX
     C*
     C*_________________________________________________________
     C*   Sett indikator/hent første avdeling hvis søk i alle avd.
     C*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      WSAVD         XAVD
     C     XAVD          IFEQ      *ZEROS
     C                   MOVE      '1'           *IN40
     C     KODTAK        SETLL     KODTA
     C                   READ      KODTA                                  94
     C  N94              MOVE      KOAAVD        XAVD
     C                   ELSE
     C                   MOVE      '0'           *IN40
     C                   END
      *
      *_________________________________________________________
      *   Sett indikator for hvilken fil som skal leses
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
     C     TS            IFNE      *BLANKS
      *
      * T V U N G E N   S Ø K E V E I
      *
      * Når Tvungen søkevei er valgt - finn første X
      * (men tillegssjekk på utfylt begrep må også gjøres)
      *
     C     WXSTEF        COMP      ' '                                2828
     C   28WSSTEF        COMP      *BLANKS                                30
     C   28              GOTO      SLTB2A
     C     WXSTET        COMP      ' '                                5252
     C   52WSSTET        COMP      *BLANKS                                30
     C   52              GOTO      SLTB2A
     C     WXSONF        COMP      ' '                                2929
     C   29WSSONF        COMP      *BLANKS                                30
     C   29              GOTO      SLTB2A
     C     WXSONT        COMP      ' '                                5353
     C   53WSSONT        COMP      *BLANKS                                30
     C   53              GOTO      SLTB2A
     C     WXOPDT        COMP      ' '                                2727
     C   27WSOPDT        COMP      *BLANKS                                30
     C   27              GOTO      SLTB2A
     C     WXHAWN        COMP      ' '                                5151
     C   51WSHAWN        COMP      *BLANKS                                30
     C   51              GOTO      SLTB2A
     C     WXAGNR        COMP      ' '                                5050
     C   50WSAGNR        COMP      *ZEROS                                 30
     C   50              GOTO      SLTB2A
     C     WXNRAG        COMP      ' '                                6464
     C   64WSNRAG        COMP      *ZEROS                                 30
     C   64              GOTO      SLTB2A
     C     WXRFA         COMP      ' '                                4848
     C   48WSRFA         COMP      *BLANKS                                30
     C   48              GOTO      SLTB2A
N37  C     WXRFK         COMP      ' '                                7777
N37  C   77WSRFK         COMP      *BLANKS                                30
N37  C   77              GOTO      SLTB2A
     C     WXPRO         COMP      ' '                                4949
     C   49WSPRO         COMP      *ZEROS                                 30
     C   49
     CANN30              MOVE      '0'           *IN32                           *SKJERMBILD
     C   49              GOTO      SLTB2A
     C     WXSG          COMP      ' '                                4343
     C   43WSSG          COMP      *BLANKS                                30
     C   43              GOTO      SLTB2A
     C     WXKNSF        COMP      ' '                                4545
     C   45WSKNSF        COMP      *ZEROS                                 30
     C   45              GOTO      SLTB2A
     C     WXKNKF        COMP      ' '                                4646
     C   46WSKNKF        COMP      *ZEROS                                 30
     C   46              GOTO      SLTB2A
     C     WXGN          COMP      ' '                                4444
     C   44WSGN          COMP      *BLANKS                                30
     C   44              GOTO      SLTB2A
     C     WXFN          COMP      ' '                                4141
     C   41WSFN          COMP      *ZEROS                                 30
     C   41              GOTO      SLTB2A
     C     WXFRI         COMP      ' '                                6363
     C   63WSFRI1        COMP      *BLANKS                                30
     C   63              GOTO      SLTB2A
     C                   ELSE
      *
      * I K K E    T V U N G E N   S Ø K E V E I
      *
      *
      * Tvungen søkevei er ikke valgt - sett etter først utfylte
      * (OBS UNNTAK: UTFYLT FAKTURANR VELGES ALLTID SOM SØKEVEI.)
      * (SENDINGSNR VED INNLAND..)
     C     *IN66         IFEQ      '1'
     C     WSSNDN        COMP      *BLANKS                            6565
     c                   exsr      fixsndnr
     C   65              GOTO      SLTB2
     C                   END
     C     WSFN          COMP      *ZEROS                             4141
     C   41              MOVE      ' '           WSDIST
     C   41              GOTO      SLTB2
n76   * ikke oppdrag ved fri søkevei
n76  C     WSFRI1        ifeq      *BLANKS
     C     WSOPD         COMP      *ZEROS                             4242
n76  c                   end
     C   42              MOVE      ' '           WSDIST
     C   42              GOTO      SLTB2
     C     WSPRO         IFNE      0
     C                   MOVE      ' '           WSDIST
     C                   END
     C     WSDIST        IFEQ      'U'
     C     UDISOP        IFEQ      'J'
      *
      * Udisponerte oppdragssortert (siste nr først)
      *
     C                   MOVE      *OFF          *IN31
     C                   MOVE      *ON           *IN49
     C                   MOVE      '1'           *IN32                           *SKJERMBILD
     C                   ELSE
     C* Udisponerte Datosortert     (default for udisponerte)
     C                   MOVE      *ON           *IN31
     C                   MOVE      *OFF          *IN49
     C                   MOVE      '0'           *IN32                           *SKJERMBILD
     C                   ENDIF
     C                   GOTO      SLTB2
     C                   ENDIF
      *
      * Kan omdisponeres (på tur men st.=' '/'A')(null og O likeverdig)
      *
     C     WSDIST        COMP      '0'                                    54
     C   54              GOTO      SLTB2
     C     WSDIST        COMP      'O'                                    54
     C   54              GOTO      SLTB2
     C     WSDIST        COMP      'D'                                    55
     C   55              GOTO      SLTB2
     C     WSDIST        COMP      'M'                                    56
     C   56              GOTO      SLTB2
     C     WSDIST        COMP      'E'                                    62
     C   62              GOTO      SLTB2
     C     WSSTEF        COMP      *BLANKS                            2828
     C   28              GOTO      SLTB2
     C     WSSTET        COMP      *BLANKS                            5252
     C   52              GOTO      SLTB2
     C     WSSONF        COMP      *BLANKS                            2929
     C   29              GOTO      SLTB2
     C     WSSONT        COMP      *BLANKS                            5353
     C   53              GOTO      SLTB2
     C     WSOPDT        COMP      *BLANKS                            2727
     C   27              GOTO      SLTB2
     C     WSHAWN        COMP      *BLANKS                            5151
     C   51              GOTO      SLTB2
     C     WSAGNR        COMP      *ZEROS                             5050
     C   50              GOTO      SLTB2
     C     WSNRAG        COMP      *ZEROS                             6464
     C   64              GOTO      SLTB2
     C     WSRFA         COMP      *BLANKS                            4848
     C   48              GOTO      SLTB2
N37  C     WSRFK         COMP      *BLANKS                            7777
N37  C   77              GOTO      SLTB2
     C     WSPRO         IFNE      *ZEROS
     C                   MOVE      '1'           *IN49                           *SORTERING
     C                   MOVE      '0'           *IN32                           *SKJERMBILD
     C                   GOTO      SLTB2
     C                   END
     C     WSSG          COMP      *BLANKS                            4343
     C   43              GOTO      SLTB2
     C     WSKNSF        COMP      *ZEROS                             4545
     C   45              GOTO      SLTB2
     C     WSKNKF        COMP      *ZEROS                             4646
     C   46              GOTO      SLTB2
     C     WSGN          COMP      *BLANKS                            4444
     C   44              GOTO      SLTB2
     C     WSFRI1        COMP      *BLANKS                            6363
     C   63              GOTO      SLTB2
N28  C     WSMERK        COMP      *BLANKS                            7979
n28  C   79              GOTO      SLTB2
     C                   END
      *
      * Absolutt ingen valg er gjort - vis datosortert uavh. av status
      *
     C                   SETON                                        34
      *
      * Hvis Felt knyttet til tvungen søkevei ikke er utfylt - feil
      *
     C     SLTB2A        TAG
     C   30              MOVE      'JOV0210'     MSGNR
     C     SLTB2         TAG
     C  N30              MOVE      WSDIST        W2STA1
      *
      * Sjekk om ny fil skal åpnes (kun nødvendig når fra valgbilde)
      *
     C     *IN30         IFNE      '1'                                          *IKKE V/FEIL
     C     *IN31         ANDNE     '1'                                          *ÅPNE/DATO
     C     *IN41         ANDNE     '1'                                          *FAIN/FAI2
     C     *IN42         ANDNE     '1'                                          *HEADDUM
     C     *IN49         ANDNE     '1'                                          *TURNR
     C                   EXSR      OPNFIL
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     HHENT         BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C                   MOVEA     '0'           *IN(98)
     c                   move      'N'           lest1             1
     c                   move      'N'           refresh           1
      *
      * behandler også topplinjetasting
      *
     C     TOPPLI        IFEQ      'J'
     C                   MOVE      '1'           *IN98
     C                   GOTO      STRTOP
     C                   END
      *
     C     *IN98         DOWEQ     '0'
      *
      * leser fra valgte subfil
      *
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   READC     SUBFIL                                 98
     C                   ELSE
     C                   READC     SUBFI2                                 98
     C                   END
      *
     c     *in98         ifeq      '0'
     C     STRTOP        TAG
     c                   move      'J'           LEST1
S11  c*                  move      wsnr          wsnrxx            2 0
      * Sikre at ferske verdier er inne....
     C     KKKHEA        CHAIN     HEADDUM                            33
     C     KKKHEA        CHAIN(N)  DISP                               33
      *
N08
N08   * BEHØVER IKKE VÆRE TRANSPORTDISPONERING VED FØLGENDE OPSJONER
N08  C     HEUR          ifne      'H'
N08  C     WSNR          IFNE      '3 '
N08  C     WSNR          ANDNE     ' 3'
N44  C     WSNR          ANDNE     '3S'
N44  C     WSNR          ANDNE     'O '
N44  C     WSNR          ANDNE     ' O'
N08  C     WSNR          ANDNE     '50'
N08  C     WSNR          ANDNE     '51'
N08  C     WSNR          ANDNE     '52'
N08  C     WSNR          ANDNE     ' P'
N08  C     WSNR          ANDNE     'P '
N21  C     WSNR          ANDNE     '53'
N21  C     WSNR          ANDNE     ' Q'
N21  C     WSNR          ANDNE     'Q '
N25  C     WSNR          ANDNE     '54'
N25  C     WSNR          ANDNE     ' I'
N25  C     WSNR          ANDNE     'I '
N30  C     WSNR          ANDNE     '60'
N30  C     WSNR          ANDNE     ' J'
N71  C     WSNR          ANDNE     '61'
N30  C     WSNR          ANDNE     'J '
N71  C     WSNR          ANDNE     '61'
N71  C     WSNR          ANDNE     'Y '
N71  C     WSNR          ANDNE     ' Y'
N08  C     WSNR          ANDNE     ' 5'
N08  C     WSNR          ANDNE     '5 '
N08  C     WSNR          ANDNE     ' W'
N08  C     WSNR          ANDNE     'W '
N08  C     WSNR          ANDNE     '55'
N08  C     WSNR          ANDNE     '56'
N08  c                   exsr      setws
N08  C                   MOVE      'JOV1246'     MSGNR
N08  C                   MOVE      '1'           *IN30
N08  C                   MOVE      '1'           *IN98
N08  C                   GOTO      SLHEN2
N08  C                   END
N08  C                   endif
      *
      *  KUN OPT. 3/5 TILLATT PÅ  SLETTET/AVSLUTTET OPPDRAG
      *  TEST ENDRET IKKE LOV MED OPSJON 2,6 PG 21 VED AVSLUTTEDE OPPDRAG
      *
     C     WSNR          IFNE      *BLANKS
     c     WSNR          IFEQ      '2 '
     c     WSNR          OREQ      ' 2'
     c     WSNR          OREQ      '6 '
     c     WSNR          OREQ      ' 6'
     c     WSNR          OREQ      '21'
     C*    KKKHEA        CHAIN     HEADDUM                            33
N70   * kan ikke endre på inaktiv avdeling
N70  C
N70  C     KODTAKI       CHAIN     KODTA                              33
N70  C     *in33         ifeq      '0'
N70  C                   MOVE      'SHU1845'     MSGNR
N70  C                   MOVE      '1'           *IN30
N70  C                   MOVE      '1'           *IN98
N70  C                   GOTO      SLHEN2
N70  C                   END
      *
      * SLETTET..
      *
      *
     C     HEST          IFEQ      'S'
     c                   exsr      setws
     C                   MOVE      'JOV1248'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLHEN2
     C                   ELSE
      *
      * AVSLUTTET..
      *
     C     KKKHEA        CHAIN     AVSLUTF                            33
     C   33HEPRO         IFNE      *ZEROS
     C     HEPRO         CHAIN     AVSLUTL2                           33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      *BLANKS       WSNR
     c                   exsr      setws
     C                   MOVE      'SHU0579'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLHEN2
     C                   ENDIF                                                   E2
     C                   END
     C                   END
     C                   END
      *
      * OPTIONS TILLATT KUN VED A = ARBEIDE MED
      *
     C     UUSPØR        IFEQ      'A'
     C
      *
      * WSNR  = A B C D = sett direkte på tur i boksene
      * her kommer kun funksjoner ved innland
      *
     c     innland       ifeq      'J'
     c     WSNR          IFEQ      'A '
     c     WSNR          OREQ      'B '
     c     WSNR          OREQ      'C '
     c     WSNR          OREQ      'D '
      *
N17   * om minst ett kolli via CS - og ennå ikke summert - sjekk/summer NÅ..
N17  c     KKKHEA        chain     CARGOF3                            33
N17  c     *in33         ifeq      *off
N17  c     KKKHEA        chain     CARGOO                             33
N17  c     *in33         ifeq      *on
N17  C                   call      'CARGOSCR4'
N17  C                   PARM                    HEAVD
N17  C                   PARM                    HEOPD
N17  C                   PARM                    KOTERM
N17  C     KKKHEA        CHAIN     HEADDUM                            33
N17  c                   endif
N17  c                   endif
      * BELØP for avregning ikke kvittert godkjent
      *
     C     HXBLGK        COMP      *BLANKS                                84
      * internt oppdrag - OK hvis priset / vært innom (pall ulik blank)
     C     *in84         ifeq      *ON
     C     TROPD0        andne     *zeros
     C     TRFRAB        IFNE      *zeros
     C     HEPK1         ANDNE     ' '
     C     HEFBV         ANDNE     *zeros
     c                   else
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1358'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     c                   end
     c                   end
     C     *IN84         IFEQ      *ON
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1205'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      * UTLEV-FORBEHOLD - AKSEPTERES KUN NÅR VIA AGENT
     C     HEKF          IFNE      *BLANKS
     C     HEKFT1        ANDEQ     *BLANKS
     C     HEKNA         ANDEQ     *ZEROS
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1213'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      * Kan ikke sette på tur mm når status X
     C     HEST          IFEQ      'X'
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1437'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * ikke på tur fra før
      *
     c     ditur         ifeq      0
     c                   exsr      SETTETUR
     c                   exsr      setws
     C   30              GOTO      SLHEN2
      *
      * på tur fra før
      *
     c                   else
     c                   exsr      byttetur
     c                   exsr      setws
     C   30              GOTO      slhen2
     c                   END
     c                   END
      *
      * fjern fra tur hvis i en av boksene
      *
     c     WSNR          IFEQ      'X '
     c     ditur         andne     *zeros
     C     l2t(1)        ifeq      ditur
     C     l2t(2)        oreq      ditur
     C     l2t(3)        oreq      ditur
     C     l2t(4)        oreq      ditur
      * Kan ikke sette på tur mm når status X
     C     HEST          IFEQ      'X'
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1437'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
     c                   exsr      taavtur
     c                   exsr      setws
     c  N30              move      'T'           refresh
     c                   else
      * kan ikke fjerne andre turer en du selv har i en av boksene
     c                   move      *on           *in30
     C                   MOVE      'JOV1280'     MSGNR
     c                   END
     c   30              move      'N'           refresh
     c   30              goto      slhen2
     c                   END
      *
     c                   END
      *
      * sett på tur direkte ved å taste turnummer eller bilnummer
      * WSNR = T
      *
     C     WSNR          IFEQ      'T '
     C     WSNR          oreq      ' T'
      *
      *feil hvis allerede på tur
      *
     C     DITUR         ifne      0
     C                   SETON                                            30
     C                   MOVE      'SHU0673'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     c                   end
      *
      * feil   ikke tastet tur eller bilnummer i heading
      *
     C     WXTUR         ifeq      0
     C     WXHAWB        ANDeq     *BLANKS
     C                   SETON                                            30
     C                   MOVE      'SHU0673'     MSGNR
     c                   exsr      setws
     C                   GOTO      SLHEN2
     c                   end
      *
      * turnummer tastet
      *
     C     WXTUR         ifne      0
     C                   EXSR      SETTUR
     c   30              exsr      setws
     C   30              GOTO      SLHEN2
     C                   move      *blanks       WSNR
     c                   move      'J'           refresh
     c                   else
      *
      * sett på tur direkte ved å taste bilnummer
      *
     C     WXHAWB        ifne      *BLANKS
     C                   EXSR      SETTU2
     c   30              exsr      setws
     C   30              GOTO      SLHEN2
     C                   move      *blanks       WSNR
     c                   move      'J'           refresh
     C                   END
     C                   END
     C                   END
      * "sett på Vent" F.eks manko der en satser på at varenr dukker opp
      * WSNR = V
      *
     C     WSNR          IFEQ      'V '
     C     WSNR          oreq      ' V'
     C     DITUR         IFNE      *ZEROS
     C     l2t(1)        ifeq      ditur
     C     l2t(2)        oreq      ditur
     C     l2t(3)        oreq      ditur
     C     l2t(4)        oreq      ditur
     c                   exsr      taavtur
     c  N30              move      'T'           refresh
     c                   else
      * kan ikke fjerne andre turer en du selv har i en av boksene
     c                   move      *on           *in30
     C                   MOVE      'JOV1280'     MSGNR
     c                   END
     c   30              exsr      setws
     c   30              move      'N'           refresh
     c   30              goto      slhen2
     c                   end
N47  c     DISTA1        ifne      'M'
     C     KKKHEA        CHAIN     DISP                               33
     C     *in33         IFEQ      '0'
     C     DISTA1        ifeq      'V'
     c                   MOVE      ' '           dista1
     c                   else
     c                   MOVE      'V'           dista1
     c                   end
     c                   update    dispr
     C                   EXSR      SETSUB
     c                   exsr      setws
     C     refresh       IFNE      'T'
     c                   move      'J'           refresh
     c                   end
     c                   end
      * kan ikke sette V på mønsteroppdrag
N47  c                   else
N47  c                   move      *on           *in30
N47  C                   MOVE      'SHU1576'     MSGNR
N47  c                   exsr      setws
N47  c                   move      'N'           refresh
N47  c                   goto      slhen2
N47  c                   end
     c                   end
      *
      * fjern VIA-2/agent-godskriving
      *
     C     WSNR          IFEQ      'Z '
     C                   EXSR      FjernVia2
     C                   EXSR      SETSUB
     c                   exsr      setws
     c   30              goto      slhen2
     C                   END
      *
      * sletting av ordre
      *
     C     WSNR          IFEQ      '4 '
     C     WSNR          OREQ      ' 4'
     C                   EXSR      SETSUB
     C                   EXSR      SLETTO
     c                   exsr      setws
     c   30              goto      slhen2
     C                   END
      *
      *
      * WSNR=2 endring
      * WSNR=3 KOPIERING
      * WSNR=6/12  DIREKTE FAKTURA
      *
     C     WSNR          IFEQ      '2 '
     C     WSNR          OREQ      ' 2'
     C     WSNR          OREQ      '02'
     C     WSNR          OREQ      '3 '
     C     WSNR          OREQ      ' 3'
     C     WSNR          OREQ      '03'
     C     WSNR          OREQ      '6 '
     C     WSNR          OREQ      ' 6'
     C     WSNR          OREQ      '06'
     C     WSNR          OREQ      '12'
     C     WSNR          ifeq      '12'
     C                   move      ' 6'          WSNR
     C                   end
     C                   MOVE      HEOPD         UUOPD             7 0
     C                   MOVE      HEAVD         UUAVD             4 0
     C                   MOVEL     WSNR          UURETU
     c     wsnr01        ifeq      ' '
     c     wsnr01        oreq      '0'
     c                   move      wsnr          uuretu
     c                   end
     C     WSNR          IFEQ      '3 '
     C     WSNR          OREQ      ' 3'
     C     WSNR          OREQ      '03'
     C                   MOVE      WSAVDU        UUAVD
     C                   MOVE      HEAVD         UUAVDC
     C                   EXSR      SETSUB
     c                   exsr      setws
N62  C     KKKHEA        CHAIN(N)  HEADF                              33
N62   * IKKE LOV Å KOPIERE DUP-OPPDRAG
N62  C                   IF        TRSLAG <> 'HO'
N62  C                   seton                                        30
N62  C                   MOVE      'JOV1716'     msgnr
N62  C                   GOTO      SLHEN2
N62  C                   ENDIF
     C                   ELSE
     C                   MOVE      *ZEROS        UUAVDC
     C                   END
     C                   EXSR      CHGOPD
     C                   END
n44   *
n44   * kopier og slett
n44   *
n44  C     WSNR          IFEQ      '3S'
n44  C     WSNR          OREQ      'O '
n44  C     WSNR          OREQ      ' O'
n44  C                   MOVE      HEAVD         UUAVD             4 0
n44  C                   MOVE      HEOPD         UUOPD             7 0
n44  C     KKKHEA        CHAIN(N)  HEADF                              33
n44  C     hest          ifne      ' '
n44  C     hest          andne     'U'
n44  C     hepro         orne      0
N44  C     TRSLAG        ORNE      'HO'
N55  C     TROPD1        ORNE      0
N55  C     TROPD2        ORNE      0
n44  C                   seton                                        30
n44  C                   MOVE      'SHU1536'     msgnr
N44  C                   EXSR      SETSUB
n44  c                   exsr      setws
N44  C                   EXSR      SETSUB
n44  C                   GOTO      SLHEN2
n44  c                   end
n44  c     wsavdu        ifne      uuavd
n44  C                   MOVE      WSAVDU        wstila
n44  c                   end
n44  c                   setoff                                       33
n44  c     nytest        tag
n44  c                   exfmt     BEKREFT
n44  c                   setoff                                       33
n44  C                   MOVE      WSTILA        tilavd
n44  c     *in12         ifne      '1'
n44  c     wstila        chain     tell                               33
n44  c  n33wstila        comp      0                                      33
n44  c  n33wstila        comp      uuavd                                  33
n44  c     *in33         ifeq      '1'
n44  c                   goto      nytest
n44  c                   end
n44  c                   call      'SYGE81'
n44  c                   parm                    uuavd             4 0
n44  c                   parm                    uuopd             7 0
n44  c                   parm                    tilavd            4 0
n44  c                   parm                    tilopd            7 0
n44  c                   move      'J'           refresh           1
N41  C                   MOVE      tilavd        UUAVD             4 0
N41  C                   MOVE      tilopd        UUOPD             7 0
n41  c                   move      '2'           uuretu
n44  C                   EXSR      CHGOPD
N44  c                   else
N44  C                   EXSR      SETSUB
n44  c                   exsr      setws
n44  c                   end
n44  c                   end
      *
      * END USPØR = A
      *
     C                   END                                                     UUSPØR=A
      *
      *
      * OPTIONS TILLATT BÅDE I UPDATE/SPØRRE-MODUS
      *
      *
      * 5= SE PÅ
      *
     C     WSNR          IFEQ      '5 '
     C     WSNR          OREQ      ' 5'
     C     WSNR          OREQ      '05'
     C                   MOVE      HEOPD         UOPD              7 0
S41  C                   MOVE      HEAVD         UAVD              4 0
N23  C                   EXSR      SETSUB
     C                   exsr      setws
     C                   MOVE      'S'           UURETU
     C                   EXSR      SEOPD
     C                   END
      * W= SE PÅ via WEB / eSped
      *
     C     WSNR          IFEQ      'W '
     C     WSNR          OREQ      ' W'
     C     WSNR          OREQ      '55'
     C                   EXSR      SEWEB
N23  C                   EXSR      SETSUB
     C                   exsr      setws
     C                   END
      *
      * 56 = SENDE E-POST BRUKER SOM LAGET WEB-OPPDRAG
     C                   IF        WSNR = '56'
     C                   EXSR      SNDEPW
N23  C                   EXSR      SETSUB
     C                   EXSR      SETWS
     C                   END
      *
      * 6= DIREKTE TIL FAKTURA
      *
     C     WSNR          IFEQ      '6 '
     C     WSNR          orEQ      ' 6'
     C     WSNR          orEQ      '06'
     C     WSNR          orEQ      '12'
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C                   EXSR      UTFAKT
     C                   EXSR      SETSUB
     C                   exsr      setws
     C                   END
      *
      *
      * Frie søkeveier (gammen 07 ISO flyttet til 17 )
      *
     C     WSNR          IFEQ      '7 '
     C     WSNR          OREQ      ' 7'
     C     WSNR          OREQ      '07'
     C                   MOVE      *BLANKS       WSNR
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C     KKKHEA        CHAIN(N)  HEADF                              33
     c                   move      TRKNFA        OTIKU1
     C     HEKNSF        IFNE      *zeros
     C     HEKNSF        andne     TRKNFA
     C                   MOVE      HEKNSF        OTIKU2
     C                   END
     C     HEKNKF        IFNE      *zeros
     C     HEKNKF        andne     TRKNFA
     C                   MOVE      HEKNKF        OTIKU2
     C                   END
     C                   CALL      'SYFA64'
     C                   PARM      HEAVD         tuavd
     C                   PARM      HEOPD         tuopd
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
     C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END
      * KALLER RUTINER FOR REGISTRERING AV AVVIKSRAPPORTER
      * (ISO - KVALITETSSIKRING)
      *
     C     WSNR          IFEQ      '17'
     C                   MOVE      *BLANKS       WSNR
     C                   MOVE      HEAVD         TUAVD             4 0
     C                   MOVE      HEOPD         TUOPD             7 0
N02  C     *LIKE         DEFINE    TUPRO         UUTUPRO
     C                   CALL      'SYIS10A'
     C                   PARM                    FIFIRM
     C                   PARM                    TUAVD
     C                   PARM                    TUOPD
N02  C                   PARM      0             UUTUPRO
     C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END
      *
      * wsnr=8 gå til fritekst-bildet
      *
     C     WSNR          IFEQ      '8 '
     C     WSNR          OREQ      ' 8'
     C     WSNR          OREQ      '08'
     C                   EXSR      VISFRE
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END
      *
      * wsnr=9 gå til print arbeidsordre
      *
     C     WSNR          IFEQ      '9 '
     C     WSNR          OREQ      ' 9'
     C     WSNR          OREQ      '09'
     C                   MOVE      HEAVD         YYTAVD            4
     C                   MOVE      *ZEROS        YYTPRO            8
S06  C*                  MOVE      HEOPD         YYTPRO
N06  C                   MOVE      HEOPD         YYTOPD            7
     C                   MOVE      'S'           YYTY              1
     C                   CALL      'SYTR40CB'
     C                   PARM      YYTAVD        YYTAVD
     C                   PARM      YYTPRO        YYTPRO
N06  C                   PARM      YYTOPD        YYTOPD
     C                   PARM      YYTY          YYTY
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      * wsnr=E PRINT etterkravsdokument
      *
     C     WSNR          IFEQ      'E '
     C     WSNR          OREQ      ' E'
     C                   CALL      'SYEK40'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      * wsnr=M Sett disp status E/V til U på alle i en EDI send
s10   * Logg Mottatt terminal.
S10  C*    WSNR          IFEQ      'M '
S10  C*    WSNR          OREQ      ' M'
N10   *F=Frigi E-sending/Logg Mottatt terminal.
N10  C     WSNR          IFEQ      'F '
N10  C     WSNR          OREQ      ' F'
     C                   move      *Zeros        EDISNDNR          7 0
     C                   CALL      'SYTR33M'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    EDISNDNR
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
N10   *M=Merkelapp basert på oppdrag (fr.br 1)
N10  C     WSNR          IFEQ      'M '
N10  C     WSNR          OREQ      ' M'
N10  C                   EXSR      PrtMlapp
N23  C                   EXSR      SETSUB
N10  c                   exsr      setws
N10  c     *in30         ifeq      '1'
N10  C                   MOVE      '1'           *IN98
N10  C                   GOTO      SLHEN2
N10  C                   endif
N10  C                   END
N69   *U = merke URGENT
N69  C     WSNR          IFEQ      'U '
N69  C     WSNR          OREQ      ' U'
N69  C                   CALL      'SYTRURG'
N69  C                   PARM                    HEAVD
N69  C                   PARM                    HEOPD
N69  C                   PARM                    UrgInd            1
N69  C                   EXSR      SETSUB
N69  c                   exsr      setws
N69  C                   GOTO      SLHEN2
N69  C                   END
      *
      * wsnr = 21 - se/arb. med rekvisisjoner
      *
     C     WSNR          IFEQ      '21'
     C                   EXSR      BUDSR
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * WSNR = 29 - VIS EDI-LOG
      *
     C                   IF        WSNR = '29'
     C                   EXSR      VISEDI
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * wsnr = 50 - se dokumenter
      *
     C     WSNR          IFEQ      '50'
     C                   EXSR      DOKUME
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * wsnr = 51 eller 'P'
      *
     C     WSNR          IFEQ      '51'
     C     WSNR          OREQ      'P '
     C     WSNR          OREQ      ' P'
     C     ARKIV         IFNE      'J'
     c                   move      *on           *in30
     C                   MOVE      'SHU0886'     MSGNR
     C                   GOTO      SLHEN2
     C                   END
     C                   EXSR      ARKIVS
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      *  prisforespørsel
      *
N21  C     WSNR          IFEQ      '53'
n21  C     WSNR          OREQ      'Q '
n21  C     WSNR          OREQ      ' Q'
n21  C                   EXSR      PRISFO
n21  c                   exsr      setsub
n21  c                   exsr      setws
n21  C                   GOTO      SLHEN2
n21  C                   END
      *
      *  print av fraktbrev
      *
N25  C     WSNR          IFEQ      '54'
n25  C     WSNR          OREQ      'I '
n25  C     WSNR          OREQ      ' I'
n25  C                   EXSR      FRAKTBRE
n25  c                   exsr      setsub
n25  c                   exsr      setws
n25  C                   GOTO      SLHEN2
n25  C                   END
      * wsnr 60   sende fraktbrev og merkelapp fra ordre på epost
N30  C     WSNR          IFEQ      '60'
n30  C     WSNR          OREQ      'J '
n30  C     WSNR          OREQ      ' J'
n30  C                   EXSR      sendepf
n30  c                   exsr      setsub
n30  c                   exsr      setws
n30  C                   GOTO      SLHEN2
n30  C                   END
n71   * wsnr 61   sende generell SMS
n71  C     WSNR          IFEQ      '61'
n71  C     WSNR          OREQ      'Y '
n71  C     WSNR          OREQ      ' Y'
n71  C                   EXSR      sendsms
n71  c                   exsr      setsub
n71  c                   exsr      setws
n71  C                   GOTO      SLHEN2
n71  C                   END
      *
      * wsnr = 52 eller 'S' = print skan skilleark
      *
     C     WSNR          IFEQ      '52'
     C     WSNR          OREQ      'S '
     C     WSNR          OREQ      ' S'
     C     ARKIV         IFNE      'J'
     c                   move      *on           *in30
     C                   MOVE      'SHU0886'     MSGNR
     C                   GOTO      SLHEN2
     C                   END
     C                   EXSR      PRTSKILL
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C*                  GOTO      START3
     C                   GOTO      SLHEN2
     C                   END
      *
      *
      *  wsnr=13 gå til SAD
      *
     C     WSNR          IFEQ      '13'
     C                   EXSR      WRKSAD
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * wsnr=14   MERKE LEVERT/LØPENR
      *
     C     WSNR          IFEQ      '14'
     C                   EXSR      WRKMRK
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
s22   * wsnr = 15  VIS FAX
s22   *
s22  C*    WSNR          IFEQ      '15'
s22  C*                  EXSR      DSPFAX
s22  c*                  exsr      setws
s22  C*                  GOTO      SLHEN2
s22  C*                  END
      *
n43   * wsnr = 15  VIS EPOST
n43   *
n43  C     WSNR          IFEQ      '15'
s60  C*    QEPOST        ANDEQ     'E'
n60  C     QEPOST        IFEQ      'E'
n43  C                   EXSR      DSPEPO
n60  c                   end
n43  c                   exsr      setws
n43  C                   GOTO      SLHEN2
n43  C                   END
      *
      * wsnr=24   sette godsnr på hel tur
      *
     C     WSNR          IFEQ      '24'
     C                   CALL      'SYFA18T'
     C                   PARM                    HEPRO
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * wsnr = 25 TRACK&TRACE
      *
     C     WSNR          IFEQ      '25'
     C     WSNR          OREQ      'L '
     C     WSNR          OREQ      ' L'
     C                   EXSR      WRKTT
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
      *
      * wsnur = 26 TRACK & TRACE TIDSFØLGING
      *
     C     WSNR          IFEQ      '26'
     C                   EXSR      WRKTTT
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END
     C*
      *
      * wsnr = 33 "kopier"/send intern EDI til firma på samme i-server.
      *
     C     WSNR          IFEQ      '33'
     C                   EXSR      INTEDI
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   END
      *
      * Vis kolliidenter
     C     WSNR          IFEQ      'K '
     C     WSNR          OREQ      ' K'
     C                   CALL      'SYTR33K'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
N23  C                   EXSR      SETSUB
     c                   exsr      setws
     C                   GOTO      SLHEN2
     C                   END
N20
N20   * H = div ved HENTE-HÅNDTERING
N20  C     WSNR          IFEQ      'H '
N20  C     WSNR          OREQ      ' H'
N20  C                   CALL      'SYTR33H'
N20  C                   PARM                    HEAVD
N20  C                   PARM                    HEOPD
N23  C                   EXSR      SETSUB
N20  c                   exsr      setws
N20  C                   GOTO      SLHEN2
N20  C                   END
N24   * G = SETT GEOLOCATION = BREDDE/LENGDEGRAD - HENT/LEVER
N24  C     WSNR          IFEQ      'G '
N24  C     WSNR          OREQ      ' G'
N24  C                   CALL      'SYTR33G'
N24  C                   PARM                    HEAVD
N24  C                   PARM                    HEOPD
N24  C                   EXSR      SETSUB
N24  c                   exsr      setws
N24  C                   GOTO      SLHEN2
N24  C                   END
N64   * HD = hoved-oppdrag i top + DUPer under
N64  C     WSNR          IFEQ      'HD'
N64  C                   exsr      HovDupArr
N64  C                   move      'J'           VisHovDup
N64  C                   GOTO      START
N64  C                   END
      *
      *
      * ALLE NYE OPTIONS MÅ INN OVER DETTE PKT!!!!
     C* wsnr ikke behandlet (blankes i setws) - Dvs ukjent option
     C     WSNR          IFNE      '  '
     C     TOPPLI        andne     'J'
     C                   move      'N'           LEST1
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLHENT
     C                   END
      *
     C                   END
     c                   end
      *                                                           ..
     C     SLHENT        TAG
      *
      * feil hvis ingen poster lest
      *
     C   98lest1         ifeq      'N'
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C     slhen2        ENDSR
      *
      ***********************************************
     C     OPNFIL        BEGSR
      ***********************************************
      * Filer som sjelden ?? brukes åpnes kun ved behov (men forblir
      * åpne resten av sesjonen etter 1. gangs bruk.)
      *
     C   43HE02OP        IFNE      '1'
     C                   OPEN      HEAD2
     C                   END
     C   44
     CANN40HE03OP        IFNE      '1'
     C                   OPEN      HEAD3
     C                   END
     C   45HE04OP        IFNE      '1'
     C                   OPEN      HEAD4
     C                   END
     C   45HE15OP        IFNE      '1'
     C                   OPEN      HEAD15
     C                   END
     C   64
     CANN40HE10OP        IFNE      '1'
     C                   OPEN      HEAD10
     C                   END
     C   64
     CAN 40HE29OP        IFNE      '1'
     C                   OPEN      HEAD29
     C                   END
     C   46HE05OP        IFNE      '1'
     C                   OPEN      HEAD5
     C                   END
     C   46HE16OP        IFNE      '1'
     C                   OPEN      HEAD16
     C                   END
     C   27
     CANN40HE06OP        IFNE      '1'
     C                   OPEN      HEAD6
     C                   END
     C   48
     CANN40HE07OP        IFNE      '1'
     C                   OPEN      HEAD7
     C                   END
N47  C   77
N47  CANN40HE47OP        IFNE      '1'
N47  C                   OPEN      HEAD47
N47  C                   END
      * OPPDRAGSGIVER
     C   50HE33OP        IFNE      '1'
     C     WXTRAN        andne     'T'
     C                   OPEN      HEAD33
     C                   END
      * TRANSPORTØR
     C   50HE40OP        IFNE      '1'
     C     WXTRAN        andeq     'T'
     C                   OPEN      HEAD40
     C                   end
     C   51HE12OP        IFNE      '1'
     C                   OPEN      HEAD12
     C                   END
     C   48
     CAN 40HE17OP        IFNE      '1'
     C                   OPEN      HEAD17
     C                   END
N37  C   77
N37  CAN 40HE35OP        IFNE      '1'
N37  C                   OPEN      HEAD35
N37  C                   END
     C   44
     CAN 40HE18OP        IFNE      '1'
     C                   OPEN      HEAD18
     C                   END
     C   65HE39OP        IFNE      '1'
     C                   OPEN      HEAD39
     C                   END
     C   54DI08OP        IFNE      '1'
     C                   OPEN      DISPL08
     C                   END
     C   28
     CAN 40DI09OP        IFNE      '1'
     C                   OPEN      DISPL09
     C                   END
     C   29
     CAN 40DI10OP        IFNE      '1'
     C                   OPEN      DISPL10
     C                   END
     C   27
     CAN 40DI11OP        IFNE      '1'
     C                   OPEN      DISPL11
     C                   END
     C   34DI12OP        IFNE      '1'
     C                   OPEN      DISPL12
     C                   END
     C   28
     CANN40DI13OP        IFNE      '1'
     C                   OPEN      DISPL13
     C                   END
     C   29
     CANN40DI14OP        IFNE      '1'
     C                   OPEN      DISPL14
     C                   END
     C   52DI15OP        IFNE      '1'
     C                   OPEN      DISPL15
     C                   END
     C   53DI16OP        IFNE      '1'
     C                   OPEN      DISPL16
     C                   END
     C   62
     CAN 40DI19OP        IFNE      '1'
     C                   OPEN      DISPL19
     C                   END
     C   52
     CAN 40DI20OP        IFNE      '1'
     C                   OPEN      DISPL20
     C                   END
     C   63
     CAN 40FR01OP        IFNE      '1'
     C                   OPEN      FRISOL01
     C                   END
     C   63
     CANN40FR02OP        IFNE      '1'
     C                   OPEN      FRISOL02
     C                   END
N28  C   79DFM1OP        IFNE      '1'
N28  C                   OPEN      DOKUFM1
N28  C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETKEY        BEGSR
      ***********************************************
      * *OBS!! en burde kanskje ha en egen fil på AVD/DISPSTATUS/DATO
      * for å benytte ved kun 0/A/B/C/D utfylt i dispstatus
      * **************
      * *IN40 ON=Søk på tvers av avdeling / OFF=Kun en avdeling
      * DISPL04 (Status/turnr(0)/avd/dato) brukes både ved
      * udiponerte datosortert (31)/ slettede(55) / mønsteroppdrag(56)
      * edifakt (booking) som er ubehandlet(62)
      * Sett key avhengig av bruken:
      *
     C   31              MOVE      ' '           YDIST
     C   55              MOVE      'D'           YDIST
     C   56              MOVE      'M'           YDIST
     C   62              MOVE      'E'           YDIST
      *                                                    FIL:
      *                                              (* = Avd. i keyen)
     c     *in31         ifeq      '1'
      *standard utland
     C  N67
     CANN68DSP04K        SETLL     DISPL04                                      *Udisp datosort.
      *til sted utgående
     C   67
     CANN68DSP17K        SETLL     DISPL17                                      *Udisp datosort.
      *fra sted inngående
     C  N67
     CAN 68DSP18K        SETLL     DISPL18                                      *Udisp datosort.
      *standard utland
      *både fra og til sted
     C   67
     CAN 68DSP04K        SETLL     DISPL04                                      *Udisp datosort.
      *
     C                   end
      *                                                                         *Udisp datosort.
     C   65WSSNDN        SETLL     HEAD39                                       *sendnr uavheng av
     C   41
     CANN40FAI2K         SETLL     FAI2                                         *Faktnr en avd.
     C   41
     CAN 40WSFN          SETLL     FAIN                                          Faktnr alle avd
     C   34DSP12K        SETLL     DISPL12                                      *Dato alle stat.
     C   27
     CANN40HEAD6K        SETLL     HEAD6                                        *Opdty/dato
     C   27
     CAN 40DSP11K        SETLL     DISPL11                                       Opdty/dato
     C   28
     CANN40DSP13K        SETLL     DISPL13                                      *Sted fra/dato
     C   28
     CAN 40DSP09K        SETLL     DISPL09                                       Sted fra/dato
     C   29
     CANN40DSP14K        SETLL     DISPL14                                      *Sone fra/dato
     C   29
     CAN 40DSP10K        SETLL     DISPL10                                       Sone fra/dato
     C   42HEADFK        SETGT     HEADDUM                                      *Oppdr.nr
     C   43HEAD2K        SETLL     HEAD2                                        *Sign./dato
     C   44
     CANN40HEAD3K        SETLL     HEAD3                                        *Godsnr
     C   44
     CAN 40WSGN          SETLL     HEAD18                                       *Godsnr
     C   45WXSEVA        IFNE      'X'
     C     HEAD4K        SETLL     HEAD4                                        *Selg. f.mot
     C                   ELSE
     C     HEAD4K        SETLL     HEAD15                                       *Selg. f.mot
     C                   END
     C   46WXKJVA        IFNE      'X'
     C     HEAD5K        SETLL     HEAD5                                        *Kjøp. f.mot
     C                   ELSE
     C     HEAD5K        SETLL     HEAD16                                       *Selg. f.mot
     C                   END
     C   48
     CANN40HEAD7K        SETLL     HEAD7                                        *Søkeref
N37  C   77
N37  CANN40HEA47K        SETLL     HEAD47                                       *Søkeref
     C   48
NRFA C*N 40WSRFA         SETLL     HEAD17                                       *Søkeref
NFRA CAN 40WSRFA35       SETLL     HEAD17                                       *Søkeref
N37  C   77
n68  CAN 40HEA35k        SETLL     HEAD35                                       *Søkeref
s68  C*N 40WSRFK35       SETLL     HEAD35                                       *Søkeref
     C     wspro         ifne      *zeros                                       Turnr er gitt
     C   49
     C*NN40HEAD8K        SETGT     HEAD8                                        *Turnr (når en avd)
     CANN40HEAD8K        SETLL     HEAD8                                        *Turnr (når en avd)
     C   49
     C*N 40HEA14K        SETGT     HEAD14                                       *Turnr (når alle avd
     CAN 40HEA14K        SETll     HEAD14                                       *Turnr (når alle avd
     C                   else                                                   Turnr=0 =siste først
     C   49
     CanN40HEAD8K        SETGT     HEAD8                                        *Turnr (når en avd)
     C   49
     Can 40HEA14K        SETGT     HEAD14                                       *Turnr (når alle avd
     C                   end
      * OPPDRAGSGIVER
     C   50WXTRAN        IFNE      'T'
     c     lldato        ifeq      0
     C     HEA33KSG      SETgt     HEAD33                                       *Oppd.giver/dato
     C                   ELSE
     C     HEA33K        SETLL     HEAD33                                       *Oppd.giver/dato
     c                   end
     c                   end
      * TRANSPORTØR
     C   50WXTRAN        IFEQ      'T'
     c     lldato        ifeq      0
     C     HEA33KSG      SETgt     HEAD40                                       *Oppd.giver/dato
     C                   ELSE
     C     HEA33K        SETLL     HEAD40                                       *Oppd.giver/dato
     c                   end
     c                   end
     C   64                                                                     *Oppd.giver/dato
     CANN40HEA10K        SETLL     HEAD10                                       *Oppd.giver/dato
     C   64                                                                     *Oppd.giver/dato
     CAN 40HEA29K        SETLL     HEAD29                                       *Oppd.giver/dato
     C   51HEA12K        SETLL     HEAD12                                       *Bilnr/dato
     C   52
     CANN40DSP15K        SETLL     DISPL15                                      *Sted til/dato EN AV
     C   52
     CAN 40DSP20K        SETLL     DISPL20                                      *Sted til/dato ALLE
     C   53DSP16K        SETLL     DISPL16                                      *Sone til/dato
      *
      *Displ08 = På tur men kan ennå omdisponeres (helt til status=B)
      *
     C   54DSP08K        SETLL     DISPL08                                      *på tur ' '/'A'
     C   55DSP04K        SETLL     DISPL04                                      *Slettede
     C   56DSP04K        SETLL     DISPL04                                      *Mønster/kopi-mal
     C*  62DSP04K        SETLL     DISPL04                                      *EDI ubehandl.
     C   62
     CANN40DSP04K        SETLL     DISPL04                                      *EDI ubehandl.
     C   62
     CAN 40DSP19K        SETLL     DISPL19                                      *EDI ubehandl.
     C   63
     CANN40FRIS2K        SETLL     FRISOL02                                     *Fri søkevei
     C   63
     CAN 40FRIS1K        SETLL     FRISOL01                                     *Fri søkevei
N28  C   79WSMERK        SETLL     DOKUFM1                                      KolliID/Merke
     C*
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
      ***********************************************
N64   *
N64   * Opt HO = Vis HovOppd/DUP kun
N64   *          Denne regelen er så spesiell at den tas i front av alle andre
N64  c                   if        VisHovDup='J'
N64   * Finn ett og ett oppdrag i dup-struktur (merk med 9999 9999999 de leste)
N64  c     1             do        100           Nr
N64  c     Dup(Nr)       cabeq     *zeros        UtDupArr
N64  c     Dup(Nr)       cabeq     99999999999   NxDupArr
N64  c                   move      Dup(Nr)       AvdOpd
N64  c                   move      99999999999   Dup(Nr)
N64  C                   MOVE      DsAvd         HEAVD
N64  C                   MOVE      DsOpd         HEOPD
N64  C     KKKHEA        CHAIN(N)  HEADF                              33
N64  C     KKKHEA        CHAIN(N)  DISP                               33
N64  c                   goto      SLULES
N64   *
N64  C     NxDupArr      tag
N64  c                   enddo
N64   *
N64  C     UtDupArr      tag
N64  c                   seton                                        94        ferdig lest
N64  c                   goto      SLULES
N64  c                   endif
      *
      * OBS !!!- Hvis nye DISP-filer innføres må en utvide rekken av
      *   tester som utføres for å hente DISP-record / HEADF-record.
      *   (Hent DISP hvis *INxx='0' og *INyy='0'... (ikke dispfil lest)
      *    Hent HEADFhvis *INxx='1' el.*INyy='1'... (dispfil lest))
      *  (Søk etter "HENTREC" - (HENTREC1=DISP  HENTREC2=HEADF))
      *   Eliminasjonstester mot felt fra DISP bør med fordel ligge
      *   mellom HENTREC1 og HENTREC2.
      *   Eliminasjonstester mot felt fra HEADF MÅ ligge etter HENTREC2
      *
      * "Hjelpeindikator" for sammesatte  vilkår...
     C                   move      'N'           UdInnUtg          1            UdispInnlandUtgå.
     C                   move      'N'           UdInnInn          1            UdispInnlandInng.
      *
      * Tag for hopp dersom post eksluderes, men ennå ikke EOF.
      *
     C     STLF          TAG
      *
N03  C     MAXLES        ifne      *zeros
N03  C     LestRec       andgt     Maxles
N03  c                   move      *on           *in94
N03  c                   move      *on           *in30
N03  C                   MOVE      'JOV1524'     MSGNR
N03  c                   goto      SluLes
N03  C                   endif
      *
      *__________________________________________________________
      * Les en record fra aktuell fil
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
      * *IN40 OFF = En gitt avdeling, *IN40 ON = Alle avd.
      *
     c     *in31         ifeq      '1'
      *standard utland
     C  N67
     CANN68DSP04E        reade     DISPL04                                94    *Udisp datosort.
      *  til sted  INNLAND utgående  (Inneholder IKKE avd - les neste dersom feil avd)
     C     *IN67         IFEQ      '1'
     C     *IN68         ANDEQ     '0'
     C                   move      'J'           UdInnUtg
     C     DSP19E        reade     DISPL17                                94    til sted
     C     *IN94         IFEQ      '0'
     C     *IN40         ANDEQ     '0'                                          = KUN EN AVD
     C     DIAVD         ANDNE     WSAVD
     C                   GOTO      STLF
     C                   END
     C                   END
      * fra sted  INNLAND inngående (Inneholder IKKE avd - les neste dersom feil avd)
     C     *IN67         IFEQ      '0'
     C     *IN68         ANDEQ     '1'
     C                   move      'J'           UdInnInn
     C     DSP19E        reade     DISPL18                                94    fra sted
     C     *IN94         IFEQ      '0'
     C     *IN40         ANDEQ     '0'                                          = KUN EN AVD
     C     DIAVD         ANDNE     WSAVD
     C                   GOTO      STLF
     C                   END
     C                   END
      *standard utland
      *både fra og til sted
     C   67
     CAN 68DSP04E        reade     DISPL04                                94    *Udisp datosort.
      *
     C                   end
      *                                                                         *Udisp datosort.
     C   65              READ      HEAD39                                 94
     C   41
     CANN40FAI2K         READE     FAI2                                   94
     C   41
     CAN 40WSFN          READE     FAIN                                   94
     C   34DSP12E        READE     DISPL12                                94
     C   27
     CANN40HEAD6E        READE     HEAD6                                  94
     C   27
     CAN 40DSP11E        READE     DISPL11                                94
     C   28
     CANN40              READ      DISPL13                                94
     C   28
     CAN 40              READ      DISPL09                                94
     C   29
     CANN40              READ      DISPL14                                94
     C   29
     CAN 40              READ      DISPL10                                94
     C   42
     CANN40XAVD          READPE    HEADDUM                                94
     C   43HEAD2E        READE     HEAD2                                  94
     C   44
     CANN40              READ      HEAD3                                  94
     C   44
     CAN 40              READ      HEAD18                                 94
     C   45WXSEVA        IFNE      'X'
     C     HEAD4E        READE     HEAD4                                  94
     C                   ELSE
     C     HEAD4E        READE     HEAD15                                 94
     C                   END
     C   46WXKJVA        IFNE      'X'
     C     HEAD5E        READE     HEAD5                                  94
     C                   ELSE
     C     HEAD5E        READE     HEAD16                                 94
     C                   END
     C   48
     CANN40              READ      HEAD7                                  94
n77  C   77
n77  CANN40              READ      HEAD47                                 94
     C   48
     CAN 40              READ      HEAD17                                 94
N17  C   77
N17  CAN 40              READ      HEAD35                                 94
     C     wspro         ifne      *zeros                                       Turnr er gitt
     C   49
     CANN40HEAD8K        READE     HEAD8                                  94
     C   49
     CAN 40HEA14K        READE     HEAD14                                 94
     C                   else                                                   Turnr=0 =siste først
     C   49
     CanN40HEAD8K        READPE    HEAD8                                  94
     C   49
     Can 40HEA14K        READPE    HEAD14                                 94
     C                   end
      * OPPDRAGGIVER
     c     *in(50)       ifeq      '1'
     C     WXTRAN        ANDNE     'T'
     C     LLDATO        IFNE      0
     C     HEA33E        READE     HEAD33                                 94
     C                   ELSE
     C     HEA33E        READPE    HEAD33                                 94
     C                   END
     c  n94
     cann40xavd          ifne      heavd
     c                   goto      stlf
     c                   end
     c                   end
      * TRANSPORTØR
     c     *in(50)       ifeq      '1'
     C     WXTRAN        ANDEQ     'T'
     C     LLDATO        IFNE      0
     C     HEA33E        READE     HEAD40                                 94
     C                   ELSE
     C     HEA33E        READPE    HEAD40                                 94
     C                   END
     c  n94
     cann40xavd          ifne      heavd
     c                   goto      stlf
     c                   end
     c                   end
     C   64
     CANN40HEA10E        READE     HEAD10                                 94
     C   64
     CAN 40HEA29E        READE     HEAD29                                 94
     C   51HEA12E        READE     HEAD12                                 94
     C   52
     CANN40XAVD          READE     DISPL15                                94
     C   52
     CAN 40              READ      DISPL20                                94
     C   53              READ      DISPL16                                94
     C   54DSP08E        READE     DISPL08                                94
     C   55DSP04E        READE     DISPL04                                94
     C   56DSP04E        READE     DISPL04                                94
     C   62
     CANN40DSP04E        READE     DISPL04                                94
     C   62
     CAN 40DSP19E        READE     DISPL19                                94
     C   63
     CANN40FRIS2E        READE     FRISOL02                               94
     C   63
     CAN 40WSFRI1        READE     FRISOL01                               94
N28  C   79              READ      DOKUFM1                                94
      *
      ***************************************************************
      *  POST er nå lest (hvis 94 off)
      ***************************************************************
      *
N03  c                   add       1             LestRec
      *
      *__________________________________________________________
      * Sett indikator for om det er lest via DISP
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   move      'N'           DispLest          1
     C     *IN31         IFEQ      '1'                                          B1
     C     *IN28         oreq      '1'
     C     *IN29         oreq      '1'
     C     *IN34         oreq      '1'
     C     *IN52         oreq      '1'
     C     *IN53         oreq      '1'
     C     *IN54         oreq      '1'
     C     *IN55         oreq      '1'
     C     *IN56         oreq      '1'
     C     *IN62         oreq      '1'
     C                   move      'J'           DispLest
     C                   end
     C     *IN31         IFEQ      '1'
     C     *IN40         andeq     '1'
     C                   move      'J'           DispLest
     C                   end
      *
      *
      *
      *
      *
      ***************************************************************
      *  DIVERSE TILLEGSTESTER FØGER SÅ
      ***************************************************************
      *
      *__________________________________________________________
      * Godsnr, men bare de uten eksp.nr/nytt løpenr
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN44         IFEQ      '1'
     C     *IN94         ANDEQ     '0'
     C     WSUTEN        ANDNE     ' '
     C     HEGNN         IFNE      *BLANKS
     C     HETLL         ORNE      *BLANKS
     C                   GOTO      STLF
     C                   END
     C                   END
      *__________________________________________________________
      * Alle som ikke er READE(på hele key)-sjekk om lest for langt
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *Sted fra er key .. for langt.?
      *
     C     *IN28         IFEQ      '1'
     C     DISTEF        IFGT      YSTEF2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
     C                   END
      *
      *Sone fra er key .. for langt.?
      *
     C     *IN29         IFEQ      '1'
     C     DISONF        ANDGT     YSONF2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
      *
      *Sted til er key .. for langt.?
      *
     C     *IN52         IFEQ      '1'
     C     DISTET        IFGT      YSTET2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
     C                   END
      *
      *Sone til er key .. for langt.?
      *
     C     *IN53         IFEQ      '1'
     C     DISONT        ANDGT     YSONT2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
      * SENDINGSNR - LEST FOR LANGT ??
     C     *IN65         IFEQ      '1'
     C     HXSNDN        ANDGT     YXSND2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
      *
      *Fri søkevei er key .. for langt.?
      *
     C     *IN63         IFEQ      '1'
     C     FSSOK         ANDGT     YFRI2
     C                   MOVE      '1'           *IN(94)
     C                   ENDIF
      *
N28  C     *IN79         IFEQ      '1'
N28  C     FMMRK1        ANDGT     YMRK2
N28  C                   MOVE      '1'           *IN(94)
N29  C                   ENDIF
      *
      *
      *__________________________________________________________
      * *IN40=OFF - Kun en avd. - Sted fra/sone fra mangler avd i key
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *__________________________________________________________
      * *IN40=På tvers av avd. - hente neste avdeling?
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      * Men IKKE ved de søkeveier har egen logisk fil uten avd. i key
      * (tillater heller ikke alle avd. ved søk på oppdragsnr)
      *
     C     *IN94         IFEQ      '1'
     C     *IN40         ANDEQ     '1'
     C*                                           Men ikke ved søk på:
     C     *IN50         ANDNE     '1'                                          Frisøkevei
     C     *IN41         ANDNE     '1'                                          Fakt.nr
     C     *IN42         ANDNE     '1'                                          Oppd.nr
     C     *IN27         ANDNE     '1'                                          Oppdr.type
     C     *IN28         ANDNE     '1'                                          Sted fra
     C     *IN29         ANDNE     '1'                                          Sone fra
     C     *IN49         ANDNE     '1'                                          Sone fra
     C     *IN65         ANDNE     '1'                                          SEND-NR
     C     *IN62         ANDNE     '1'                                          E-disp
     C     *IN63         ANDNE     '1'                                          Frisøkevei
N28  C     *IN79         ANDNE     '1'                                          kolliID
     C     UdInnUtg      ANDNE     'J'                                          UdispInnlandUtgå.
     C     UdInnInn      ANDNE     'J'                                          UdispInnlandInng.
     C                   MOVE      '0'           *IN94
     C                   READ      KODTA                                  94
      *
      *   *IN94 ON = det fantes ikke flere avdelinger
      *
     C     *IN94         IFEQ      '0'
     C                   MOVE      KOAAVD        XAVD
     C                   EXSR      SETKEY
     C                   GOTO      STLF
     C                   ENDIF
     C                   ENDIF
      *
      *__________________________________________________________
      * End of file?/for langt? hopp ut.
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN94         IFEQ      '1'
     C                   GOTO      SLULES
     C                   ENDIF
      *
      *__________________________________________________________
      * HENTREC1   Dersom DISP-record ikke er lest - hent den NÅ
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      * Alle transp.disp.oppdrag SKAL ha DISP-record - Ikke: les neste
      *
     C     *IN34         IFEQ      '0'                                          B1
     C     *IN28         ANDEQ     '0'
     C     *IN29         ANDEQ     '0'
     C     *IN31         ANDEQ     '0'
     C     *IN52         ANDEQ     '0'
     C     *IN53         ANDEQ     '0'
     C     *IN54         ANDEQ     '0'
     C     *IN55         ANDEQ     '0'
     C     *IN56         ANDEQ     '0'
     C     *IN62         ANDEQ     '0'
      *
      * FAKT/FAIN er lest - hent DISP (DS sørger for at key er OK)
      *
     C     *IN41         IFEQ      '1'                                           B2
     C     HEADFF        CHAIN(N)  DISP                               33
N08  C     innland       ifeq      'J'
     C   33              GOTO      STLF
N08  c                   endif
N08  c   33              eval      DupaSg='M:'+HEUR
     C                   ELSE                                                    X2
      *
      * Record fra headF er lest, hent  DISP-record via KKKHEA
      * Oppdragstype (27 ON) er fra HEADF når kun en avd (40 OFF)
      *
     C     *IN27         IFEQ      '1'                                            B3
     C     *IN40         IFEQ      '0'                                             B4
     C     KKKHEA        CHAIN(N)  DISP                               33
N08  C     innland       ifeq      'J'
     C   33              GOTO      STLF
N08  c                   endif
N08  c   33              eval      DupaSg='M:'+HEUR
     C                   ENDIF                                                     E4
     C                   ELSE                                                     X3
      *
      * FRISOK er lest
      *
     C     *IN63         IFEQ      '1'                                             B4
N28  C     *IN79         oreq      '1'                                             B4
N28  C     *IN79         ifeq      '1'                                             B4
N28  c                   move      FMAVD         FSAVD
s40  c*                  move      FMAVD         FSOPD
N40  c                   move      FMOPD         FSOPD
N28  c                   endif
     C     FRIOPK        CHAIN(N)  DISP                               33
N08  C     innland       ifeq      'J'
     C   33              GOTO      STLF
N08  c                   endif
N08  c   33              eval      DupaSg='M:'+HEUR
     C                   ELSE                                                      X4
      *
      * headf-søk (annen enn opd.type) hent DISP
      *
     C     KKKHEA        CHAIN(N)  DISP                               33
N08  C     innland       ifeq      'J'
     C   33              GOTO      STLF
N08  c                   endif
N08  c   33              eval      DupaSg='M:'+HEUR
     C                   ENDIF                                                     E4
     C                   ENDIF                                                    E3
     C                   ENDIF                                                   E2
     C                   ENDIF                                                  E1
      *
      *
      *
      *__________________________________________________________
      * Når en er kommet hit er post vellykket lest etter valgt nøkkel
      * Sjekk videre alle utfylte tillegsvalg (begrensninger)
      * (en trenger ikke sjekke det begrept som er nøkkel - det er alt
      *  gjort lenger oppe - Avd inngår alltid i key når avd. fylt ut)
      *
      * Matcher ikke "tillegsbegrensningene" les neste post etter nøkk.
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
      * De følgende tester krever IKKE at HEADF er lest
      * Evt nye tester som bare går på DISP-fila legges inn her......
      * (av ytelseshensyn ventes lengst mulig med å lese HEADF/HEADTR
      *  - om mange poster"faller ut"pga. f.eks. stedsavgrensning kan
      *    mange CHAIN-operasjoner spares.)
      *
      *__________________________________________________________
      * Disp-status  tastet - uten å være sorteringsbegrep ??
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      * Ved ' ' i WSDIST vises alle - også slettede
      *
     C     *IN31         IFNE      '1'                                          *Udispon.
     C     *IN54         ANDNE     '1'                                          *Kan omdisp.
     C     *IN55         ANDNE     '1'                                          *Slettede
     C     *IN56         ANDNE     '1'                                          *Mønster/mal
     C     *IN62         ANDNE     '1'                                          *Mønster/mal
     C     WSDIST        ANDNE     ' '                                          B1
      *
      *'0'/'O'= Udisponert eller på tur som ennå IKKE er underveis
      *(også de som er ferdigmeldt (A) kan være aktuelt å omdisponere)
      *
     C     WSDIST        IFEQ      '0'                                           B2
     C     WSDIST        OREQ      'O'                                           B2
     C     DISTA1        IFNE      ' '                                            B3
     C     DISTA1        ANDNE     'A'
     C                   GOTO      STLF
     C                   END                                                      E3
     C                   ELSE                                                    X2
     C     WSDIST        IFEQ      'U'                                            B3
      *
      *'U'= Udisponert heller ikke satt på tur
      *
     C     DISTA1        IFNE      ' '                                             B4
     C     DITUR         ORNE      *ZEROS
     C                   GOTO      STLF
     C                   END                                                       E4
     C                   ELSE                                                     X3
      *
      * A,B,C,D - Må være lik status i register
      *
     C     WSDIST        IFNE      DISTA1                                          B4
     C                   GOTO      STLF
     C                   END                                                       E4
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
      *
      *__________________________________________________________
      * Frasted  tastet - uten å være sorteringsbegrep ??
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
     C     *IN28         IFNE      '1'
     C     WSSTEF        ANDNE     *BLANKS
     C     DISTEF        IFLT      WSSTEF
     C     DISTEF        ORGT      YSTEF2
     C                   GOTO      STLF
     C                   ENDIF
     C                   END
      *
      *
      *__________________________________________________________
      * Tilsted  tastet - uten å være sorteringsbegrep ??
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
     C     *IN52         IFNE      '1'
     C     WSSTET        ANDNE     *BLANKS
     C     DISTET        IFLT      WSSTET
     C     DISTET        ORGT      YSTET2
     C                   GOTO      STLF
     C                   ENDIF
     C                   END
      *
      *
      *__________________________________________________________
      * Frasone  tastet - uten å være sorteringsbegrep ??
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
      *
     C     *IN29         IFNE      '1'
     C     WSSONF        ANDNE     *BLANKS
     C     DISONF        IFLT      YSONF
     C     DISONF        ORGT      YSONF2
     C                   GOTO      STLF
     C                   ENDIF
     C                   END
      *
      *
      *
      *__________________________________________________________
      * Tilsone  tastet - uten å være sorteringsbegrep ??
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      *
      *
      *
     C     *IN53         IFNE      '1'
     C     WSSONT        ANDNE     *BLANKS
     C     DISONT        IFLT      YSONT
     C     DISONT        ORGT      YSONT2
     C                   GOTO      STLF
     C                   END
     C                   END
     C*
     C*
     C*__________________________________________________________
     C* Fri søkevei tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C*
     C*
     C     *IN63         IFNE      '1'
     C     WSFRI1        ANDNE     *BLANKS
      * Åpne fila om den ikke er benyttet før
     C     FRISOP        IFNE      '1'
     C                   OPEN      FRISOK
     C                   END
     C     FRIKEY        SETLL     FRISOK
S55  C*    FRIKEE        READE     FRISOK                                 33
N55  C     FRIKEE        READE(N)  FRISOK                                 33
     C   33              GOTO      STLF
     C     FSSOK         IFGT      YFRI2
     C                   GOTO      STLF
     C                   END
     C                   END
N28
N28  C*__________________________________________________________
N28  C* Godsmerke/kolli-iD - uten å være sorteringsbegrep ??
N28  C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
N28  C*
N28  C*
N28  C     *IN79         IFNE      '1'
N28  C     WSMERK        ANDNE     *BLANKS
N28  C* Åpne fila om den ikke er benyttet før
N28  C     DFM1OP        IFNE      '1'
N28  C                   OPEN      DOKUFM1
N28  C                   END
N28  C     WSMERK        SETLL     DOKUFM1
N28  C                   READ      DOKUFM1                                33
N28  C   33              GOTO      STLF
N28  C     FMMRK1        IFGT      YMRK2
N28  C                   GOTO      STLF
N28  C                   END
N28  C                   END
     C*
     C*__________________________________________________________
     C* Oppdragstype TASTET ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C*
     C     *IN27         IFEQ      '0'
     C     WSOPDT        ANDNE     *BLANKS
     C     DIOT          ANDNE     WSOPDT
     C                   GOTO      STLF
     C                   END
     C*
     C*
     C*__________________________________________________________
     C* Dato er tastet ved søkeveier hvor dato ikke ingår i key
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C* Obs ved sted/sone må dato testes seperat selv om den er i key
     C* (dette fordi det er lov å søke etter bare del av 1. keybegrep)
     C* Faktnr / og søkerefnr. er vel lite aktuelt å kombinere med dato
     C* (men det gjør ingen skade heller siden reade gir rask EOF)
     C* Oppdragsnr (*IN42) kan en ikke tillate kombinert med dato -
     C* (Risikerer å starte kjempeles(READP) hvor alle ekskluderes)
     C     WSDATO        IFNE      *ZEROS
     C     *IN28         IFEQ      '1'                                          Sted fra
     C     *IN29         OREQ      '1'                                          Sone fra
     C     *IN52         OREQ      '1'                                          Sted til
     C     *IN53         OREQ      '1'                                          Sone til
     C     *IN49         OREQ      '1'                                          Turnr
     C     *IN44         OREQ      '1'                                          Godsnr
     C     *IN41         OREQ      '1'                                          Fakt.nr???
     C     *IN48         OREQ      '1'                                          Søkeref???
     C     *IN63         OREQ      '1'                                          FRI SØKEVEI
N01  C     *IN79         OREQ      '1'                                          godsmerke/kolli
     C     *IN67         OREQ      '1'
     C     *IN68         OREQ      '1'
     C     DIDATF        IFLT      LLDATO
     C                   GOTO      STLF
     C                   END
     C                   END
     C                   END
      *
      *
     C     WSDATT        IFNE      *ZEROS
     C     DispLest      andeq     'J'
     C     DIDATF        andgt     TOMDATO
     C                   GOTO      STLF
     C                   END
     C*
     C*
     C*__________________________________________________________
     C* HENTREC2 -Hvis record fra HEADF ennå ikke er lest - Gjør det NÅ
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN34         IFEQ      '1'                                          B1
     C     *IN27         OREQ      '1'                                          B1
     C     *IN28         OREQ      '1'
     C     *IN29         OREQ      '1'
     C     *IN31         OREQ      '1'
     C     *IN41         OREQ      '1'
     C     *IN52         OREQ      '1'
     C     *IN53         OREQ      '1'
     C     *IN54         OREQ      '1'
     C     *IN55         OREQ      '1'
     C     *IN56         OREQ      '1'
     C     *IN62         OREQ      '1'
     C     *IN63         OREQ      '1'
N28  C     *IN79         OREQ      '1'
     C* ...kun DISP er lest ved oppdragstype og alle avd valgt
     C     *IN27         IFEQ      '1'                                           B2
     C     *IN40         IFEQ      '1'                                            B3
     C     DIKEY         CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '1'                                             B4
     C                   GOTO      STLF
     C                   ENDIF                                                     E4
     C                   ENDIF                                                    E3
     C                   ELSE                                                    X2
     C* ..kun DISP er lest (via annet enn oppdr.type)
     C     DIKEY         CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      '1'                                            B3
     C                   GOTO      STLF
     C                   ENDIF                                                    E3
     C                   ENDIF                                                   E2
     C                   ENDIF                                                  E1
     C**
     C**
     C**
     C**
     C* Tester mot begrep i HEADF må legges inn etter dette punkt
      *
      ** ufakturert
N59  C  N94ufakt         ifeq      'X'
N59  C     trslag        ifne      'HO'
N59  c                   goto      stlf
N59  C                   end
N59  c     hest          ifne      ' '
N59  c                   goto      stlf
N59  c                   else
N59  C     KKKHEA        CHAIN     FERDL01                            33
N59  C   33KKKHEA        CHAIN(N)  SAML1                              33
N59  C  N33              goto      stlf
N59  C                   END
N59  C                   END
      *
N23   * Alle avd??? må være rett i.h.t. TIL TILLEGSTESTER
N23  C     *in40         IFEQ      *ON
N23  C                   MOVE      'N'           FeilAvd           1
N23  C*    W2ETER        ifeq      'J'
N23  C*                  exsr      TstTerm
N23  C*                  END
N23  C                   if        AlleUtg='J' or AlleInng='J' or WSMIAV='J'
N23  C                   exsr      TstAvd
N23  C                   END
N23  C     FeilAvd       cabeq     'J'           STLF
N23  C                   END
     C**
     C     WSDATT        IFNE      *ZEROS
     C     DispLest      andeq     'N'
     C     HEDTOP        andgt     TOMDATO
     C                   GOTO      STLF
     C                   END
      * Navn i Hente / leverings adresse..
     C     WSHNAV        Ifne      *blanks
     C     WSLNAV        orne      *blanks
     c                   exsr      TstHenLev
     c     HLExclude     cabeq     'Y'           STLF
     c                   end
      **  TEST MOT VEKT OVER / UNDER  (FRA OG MED/TIL OG MED)
     C     WSVKTO        IFNE      *ZEROS
     C     HEVKT         ANDLT     WSVKTO
     C                   GOTO      STLF
     C                   END
     C     WSVKTU        IFNE      *ZEROS
     C     HEVKT         ANDGT     WSVKTU
     C                   GOTO      STLF
     C                   END
N61  C     WSKFR         IFNE      *blanks
N61  C     HEFR          ANDNE     WSKFR
N61  C                   GOTO      STLF
N61  C                   END
      * prebooking.filter
N66  C     WSPBST        IFNE      *blanks
N66  C                   select
N66   * J = alle med en kode / hopp ut ved blank
N66  C     WSPBST        wheneq    'J'
N66  C     HESTN7        ifeq      *blanks
N66  C                   goto      STLF
N66  C                   endif
N66   * N = Ikke vis de med en kode / hopp ut ved ulik blank
N66  C     WSPBST        wheneq    'N'
N66  C     HESTN7        ifne      *blanks
N66  C                   goto      STLF
N66  C                   endif
N66  C                   other
N66   * gitt kode (normalt P) = vis kun denne/ hopp ut ved ulik
N66  C     HESTN7        ifne      WSPBST
N66  C                   goto      STLF
N66  C                   endif
N66  C                   endsl
N66  C                   ENDIF
     C*__________________________________________________________
     C* Signatur tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN43         IFNE      '1'
     C     WSSG          ANDNE     *BLANKS
     C     WSSG          ANDNE     HESG
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Godsnr   tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN44         IFNE      '1'
     C     WSGN          ANDNE     *BLANKS
     C     WSGN          ANDNE     HEGN
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Selgers fakt.m. tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN45         IFNE      '1'
     C     WSKNSF        ANDNE     *ZEROS
     C     WSKNSF        ANDNE     HEKNSF
     C     WXSEVA        ANDNE     'X'
     C                   GOTO      STLF
     C                   END
     C*__________________________________________________________
     C* Selgers  tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN45         IFNE      '1'
     C     WSKNSF        ANDNE     *ZEROS
     C     WSKNSF        ANDNE     HEKNS
     C     WXSEVA        ANDEQ     'X'
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Kjøpers fakt.m. tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN46         IFNE      '1'
     C     WSKNKF        ANDNE     *ZEROS
     C     WSKNKF        ANDNE     HEKNKF
     C     WXKJVA        ANDNE     'X'
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Kjøpers tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN46         IFNE      '1'
     C     WSKNKF        ANDNE     *ZEROS
     C     WSKNKF        ANDNE     HEKNK
     C     WXKJVA        ANDEQ     'X'
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Søkeref  tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN48         IFNE      '1'
     C     WSRFA         ANDNE     *BLANKS
     C     WSRFA         ANDNE     HERFA
     C                   GOTO      STLF
     C                   END
N37  C*__________________________________________________________
N37  C* Søkeref  tastet - uten å være sorteringsbegrep ??
N37  C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
N37  C     *IN77         IFNE      '1'
N37  C     WSRFK         ANDNE     *BLANKS
N37  C     WSRFK         ANDNE     HERFK
N37  C                   GOTO      STLF
N37  C                   END
     C*
     C*__________________________________________________________
     C* Oppdragsgiver tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN50         IFNE      '1'
     C     WSAGNR        ANDNE     *ZEROS
     C     WSAGNR        ANDNE     TRKNFA
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Agentnummer er tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN64         IFNE      '1'
     C     WSNRAG        ANDNE     *ZEROS
     C     WSNRAG        ANDNE     HEKNA
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Bilnummer tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN51         IFNE      '1'
     C     WSHAWN        ANDNE     *BLANKS
     C     WSHAWN        ANDNE     HEHAWB
     C                   GOTO      STLF
     C                   END
     C*
     C*__________________________________________________________
     C* Turnr er tastet - uten å være sorteringsbegrep ??
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     *IN49         IFNE      '1'
     C     WSPRO         ANDNE     *ZEROS
     C     WSPRO         ANDNE     HEPRO
     C                   GOTO      STLF
     C                   END
     C*
N27  C*__________________________________________________________
N27  C* Filter på T&T-status generelt
N27  C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
N27  C                   select
N27  C     WSTT          wheneq    'U'
N27  C                   exsr      TTstatus
N27  C                   if        HENLEV<>'Urørt'
N27  C                   GOTO      STLF
N27  c                   endif
N27  C     WSTT          wheneq    'H'
N27  C                   exsr      TTstatus
N27  C                   if        HENLEV<>'Hentet'
N27  C                   GOTO      STLF
N27  c                   endif
N27  C     WSTT          wheneq    'L'
N27  C                   exsr      TTstatus
N27  C                   if        HENLEV<>'Levert'
N27  C                   GOTO      STLF
N27  c                   endif
N27  C     WSTT          wheneq    'V'                                          V= Vis/ingen seleksj
N27  C                   exsr      TTstatus
N27  C                   other
N27  C                   move      '11'          *in(57)                        = ikke vis
N27  C                   move      *blanks       HENLEV
N27  C                   endsl
N23  C*__________________________________________________________
N23  C* Filter på hentestatus..
N23  C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
N23  c                   call      'SYTR33HS'
N23  c                   parm                    HEAVD
N23  c                   parm                    HEOPD
N23  c                   parm      '  '          UHSTAT            2
N23  C     WSHSTAT       Ifne      *blanks
N23  C     WSHSTAT       andne     UHSTAT
N23  C                   GOTO      STLF
N23  C                   endif
     C*
     C*__________________________________________________________
     C* Kommet hit - post som oppfyller alle krav er lest
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C*
     C     SLULES        ENDSR
N23  C***********************************************
N23  C     TstAvd        BEGSR
N23  C***********************************************
N23   * Ved F18 Alle - vis kun utgående / Ved F19 Alle  inngående
N23   * Kun utgående -
N23  c     AlleUtg       ifeq      'J'
N23  C     KODAKH        CHAIN     KODTA                              33
N23  C  N33KOAIE         IFNE      '1'
N23  c                   move      'J'           FeilAvd           1
N23  c                   goto      UtTstAvd
N23  c                   endif
N23  c                   endif
N23
N23   * Kun inngående-
N23  c     AlleInng      ifeq      'J'
N23  C     KODAKH        CHAIN     KODTA                              33
N23  C  N33KOAIE         IFNE      '2'
N23  c                   move      'J'           FeilAvd           1
N23  c                   goto      UtTstAvd
N23  c                   endif
N23  c                   endif
N23
N23   * Kun mine avd - ikke vis dersom ikke i fil
N23  c     WSMIAV        ifeq      'J'
N23  C     KunMineK      CHAIN     MINEAVD                            33
N23  c   33              move      'J'           FeilAvd           1
N23  c   33              goto      UtTstAvd
N23  c                   endif
N23
N23  C     UtTstAvd      ENDSR
     C***********************************************
     C     TstHenLev     BEGSR
     C***********************************************
     c                   MOVE      'Y'           HLExclude         1
      * TEST Hentenavn utfylt - ikke match hopp ut (med Y i HLExclude )
     c     WSHnav        Ifne      *blanks
     c*                  MOVEL     WSHNAV        HenMot
     C     ' '           CHECKR(E) WSHNAV        NUX               2 0
     C                   EVAL      %len(HenMot)= NUX
     C     NUX           SUBST     WSHNAV:1      HenMot
     C     LC:UC         XLATE     HENAS         TSTSCAN30        30
     C     HenMot        SCAN      TSTSCAN30                              33
     c     *IN33         CaBEQ     *OFF          UtTstHL
     C                   end
      * TEST Lev.navn utfylt - ikke match hopp ut (med Y i HLExclude )
     c     WSLnav        Ifne      *blanks
     C     ' '           CHECKR(E) WSLNAV        NUX               2 0
     C                   EVAL      %len(HenMot)= NUX
     C     NUX           SUBST     WSLNAV:1      HenMot
     C     LC:UC         XLATE     HENAK         TSTSCAN30
     C     HenMot        SCAN      TSTSCAN30                              33
     c     *IN33         CaBEQ     *OFF          UtTstHL
     C                   end
      * Overlevde begge tester - skal IKKE ekskluderes
     c                   MOVE      'N'           HLExclude
     C     UtTstHL       ENDSR
     C***********************************************
     C     SETSUB        BEGSR
     C***********************************************
     C* Henter nødvendige tillegsrecords for data i SUBFILA
     C* Setter "indikatore" rev. immage - rød farge m.m. for subfil.
     C*
     c                   SETOFF                                       71
     C     KKKHEA        CHAIN     FERDL01                            33
     C  N33              MOVE      'K'           HEST
     C     *IN33         IFEQ      '1'
     C     KKKHEA        CHAIN(N)  SAML1                              33
     C  N33              MOVE      'C'           HEST
     C                   END
S27  C*                  Z-ADD     HEM3          WSM3SU
S27  C*                  Z-ADD     HEM3          WSM3S2
     C                   MOVE      *BLANKS       IMCO
N27  C                   MOVE      *BLANKS       FAREKL
     C                   MOVE      *BLANKS       ETTE
     C     TRFA21        IFNE      *BLANKS
     C                   MOVE      'A'           IMCO                            *ADR.gods
N27  C                   MOVEL     TRFA21        FAREKL
     C                   END
     C     TRFA11        IFNE      *BLANKS
     C                   MOVE      'I'           IMCO                            *IMCO gods
N27  C                   MOVEL     TRFA11        FAREKL
     C                   END
N48  c                   if        FAREKL=*blanks and HEPOEN<>0
N48  c                   move      *blanks       XXPOENA           5
N48  c                   eval      XXPOENA= %trimR(%editc(HEPOEN:'Z'))
N48  C                   MOVEL     'P:'          FAREKL
N48  C                   MOVE      XXPOENA       FAREKL
N48  c                   endif
     C     TRETTB        IFNE      *ZEROS
     C                   MOVE      'E'           ETTE
     C                   END
     C*
     C                   MOVEL     *BLANKS       HSFROM
     C                   MOVEL     *BLANKS       HSTO
S27  C*    HESDF         COMP      '99999'                                58
S27  C*    HESDT         COMP      '99999'                                57
     C     KKKHEA        CHAIN     HESTED                             33
     C     *in67         Ifeq      '0'
     C     *in68         andeq     '0'
     C  N33              DO
     C                   MOVEL     HSFROM        HESDF
     C                   MOVEL     HSTO          HESDT
S27   *
S27  C* N58HSVIA1        IFNE      *BLANKS
S27  C*    HESDFF        COMP      '99999'                                58
S27  C*                  END
S27  C* N57HSVIA2        IFNE      *BLANKS
S27  C*    HESDVT        COMP      '99999'                                57
S27  C*                  END
     C                   END
     C                   END
      *
      *
     C                   MOVE      DITUR         WXTUR
     C                   MOVE      HEHAWB        WXHAWB
     C     WXTUR         COMP      0                                  3535
     C     WXHAWB        COMP      *BLANKS                            3636
     C     TROPD0        COMP      *ZEROS                             5959
      * Søkeref
N64  c                   eval      SFRFA = HERFA                                senders ref
N64  c                   if        HERFK <> *blanks
N64  c                   if        HERFA =  *blanks
N64  c                   eval      SFRFA = HERFK                                mottakers ref
N64  c                   else
N64  c                   eval      SFRFA = %trim(HERFA)+' / '+HERFK             begge
N64  c                   endif
N64  c                   endif
s50  C*    *IN77         IFEQ      '1'                                          63 on = fri søkevei
s50  c*                  eval      SFRFA = HERFK
s50  c*                  endif
n50  c*    trkdff        ifeq      'K'
n50  c*                  eval      SFRFA = HERFK
n50  c*                  end
n50  c     HERFA         ifeq      *blanks
n50  c                   eval      SFRFA = HERFK
n50  c                   end
n57  c     *in48         ifeq      '1'
n57  c                   eval      SFRFA = HERFA
n57  c                   end
n57  c     *in77         ifeq      '1'
n57  c                   eval      SFRFA = HERFK
n57  c                   end
N27  C     *IN63         IFEQ      '1'                                          63 on = fri søkevei
N27  c                   eval      SFRFA = FSSOK
N27  c                   endif
N28  C     *IN79         IFEQ      '1'                                          69 on = merke/kllID
N28  c                   eval      SFRFA = FMMRK1
N28  c                   endif
N27  C     *IN44         IFEQ      '1'                                          44 on = godsnr
N27  c                   eval      SFRFA = HEGN +' '+HEPOS1
N27  c                   if        HEPOS2<>*zeros
N27  c                   eval      SFRFA = %trim(SFRFA)+'/'
N27  c                             +%trim(%editc(HEPOS2:'Z'))
N27  c                   endif
N27  c                   endif
      * 69 ON, MODUS 2, VIS ALTERNATIVER VERDIER I VISSE FELT
     C     *IN69         IFEQ      '1'
     C                   MOVEL     HEKDPL        KFKOD
     C     PRODKE        CHAIN     KUFAST                             33
     C  N33              MOVEL     KFTXT         HENAS
     C                   MOVE      *BLANKS       HENAK
     C                   Z-ADD     TRFRAB        TMPBL             7 0
     C                   MOVE      TMPBL         TMPBLA
     C     1             DO        6             NB                1 0
     C     TB(NB)        CABNE     '0'           UTTB
     C                   MOVE      ' '           TB(NB)
     C                   END
     C     UTTB          TAG
     C                   MOVE      TRFRAK        HENAKA
     C                   MOVE      TRFRAV        HENAKB
     C                   MOVEA     TB            HENAKC
N27  C                   ENDIF
S27  C*                  ELSE
S27   * flyttet til SFRFA
S27   * Normalmodus: Hvis søk på godsn/aref/frisok vis i avs. (mott.)
S27  C*    *IN48         IFEQ      '1'
S27  C*    WMRFA         ANDNE     'I'                                           *IKKE VIS
S27  C*    WMRFA         IFEQ      ' '
S27  C*    WMRFA         OREQ      'A'
S27  C*                  MOVEL     HERFA         HENAS
S27  C*                  ELSE
S27  C*                  MOVEL     HERFA         HENAK
S27  C*                  END
S27  C*                  END
S27   *
S27  C*    *IN44         IFEQ      '1'
S27  C*    WMGN          ANDNE     'I'                                           *IKKE VIS
S27  C*    WMGN          IFEQ      ' '
S27  C*    WMGN          OREQ      'A'
S27  C*                  MOVEL     HEGN          HENAS
S27   * Gn. i avsendrer / Posnr + navn i mottaker
S27   * Pos.nr er sjelden mer enn 3 langt, utnytt maximalt for navn
S27  C*    HEPO1B        IFEQ      *BLANKS
S27  C*                  MOVEL     HENAK         aa12             12
S27  C*                  MOVEL     AA12          HENAKD
S27  C*                  MOVEL     HEPO1A        HENAK
S27  C*                  ELSE
S27  C*                  MOVEL     HENAK         aa8               8
S27  C*                  MOVEL     aa8           HENAKE
S27  C*                  END
S27  C*                  ELSE
S27  C*                  MOVEL     HEGN          HENAK
S27  C*                  END
S27  C*                  END
S27   *
S27  C*    *IN63         IFEQ      '1'
S27  C*    WMFRI1        ANDNE     'I'                                           *IKKE VIS
S27  C*    WMFRI1        IFEQ      ' '
S27  C*    WMFRI1        OREQ      'A'
S27  C*    FSKODE        IFEQ      'IFB'
S27  C*    FSSNDX        ANDNE     ' '
S27  C*                  MOVEL     FSSNDN        HENAS
S27  C*                  ELSE
S27  C*                  MOVEL     FSSOK         HENAS
S27  c*                  END
S27  C*                  ELSE
S27  C*    FSKODE        IFEQ      'IFB'
S27  C*    FSSNDX        ANDNE     ' '
S27  C*                  MOVEL     FSSNDN        HENAK
S27  C*                  ELSE
S27  C*                  MOVEL     FSSOK         HENAK
S27  c*                  END
S27  C*                  END
S27  C*                  END
S27  C*                  END
s22   * HENT FAX-LOG
s22  C*    KKKHEA        CHAIN     FAXLOG03                           33
s22  C*                  MOVE      ' '           QFSU
s22  C* N33              DO
s22  C*    LOGKEY        CHAIN     FAXQLOG                            33
s22  C*    *in33         IFEQ      '1'
s22  C*    LOFAXN        IFEQ      'MAIL'
s22  C*                  MOVE      'E'           QFSU
s22  C*                  else
s22  C*                  MOVE      'I'           QFSU
s22  C*                  END
s22  C*                  END
s22  C*                  END
n22   *
n22   * se om epost  er sendt
n22   *
n43  C     KKKHEA        CHAIN     arklogh4                           33
n43  C  N33              MOVE      'E'           QEPOST
n43  C   33              MOVE      ' '           QEPOST
n22   *
n22   * se om tilbud er sendt
n22   *
n22  c                   move      ' '           qfsu
n22  c                   move      'PRT'         tikode
n22  c     fritil        chain     trackl02                           33
n22  c  n33              move      'B'           qfsu
n22  c     *in33         ifeq      '1'
n22  c                   move      'PRI'         tikode
n22  c     fritil        chain     trackl02                           33
n22  c  n33              move      'S'           qfsu
n22  c                   end
N08  c     HEUR          ifne      'H'
N08  c                   eval      DupaSg='M:'+HEUR
N08  c                   endif
      * COLOR RED PÅ ANTALLSFELTET DERSOM KVITTERT LEVERT.
     C     HESGM         COMP      *BLANKS                            8585
      * REV IMMAGE PÅ OPPD.NR DERSOM FRITEKST FINNES.
      *
      * VED IKKE LEST GODSLISTE-NOTIS SETT PÅ IND 81 I TILLEG (INNLAND)
      * 88 ON = Fritekst  finnes ,   81 ON = Ulest Godsliste-notis finnes
S42   *(frigi indikator 89 - bruk 33 på chain)
S42  C*                  SETOFF                                       888981
S01  C*    KKKHEA        SETLL     FREETXT
S01  C*    KKKHEA        READE     FREETXT                                89
S01  C* N89              SETON                                            88
S01  C*    *IN89         DOWEQ     '0'
S01  C*                  MOVE      FRTTXT        FRLEST            1
S01  C*    FRTKOD        IFEQ      'G'
S01  C*    FRLEST        ANDNE     '.'
S01  C*                  MOVE      *ON           *IN81
S01  C*                  GOTO      UT81
S01  C*                  END
S01  C*    KKKHEA        READE     FREETXT                                89
S01  C*                  END
S01  C*    UT81          TAG
S42  C*    KKKHEA        chain     FREETXT3                           89
S42  C* N89              SETON                                            88    *Freetxt finnes
S42  C* N89UlestKey      chain     FREETXT3                           89
S42  C* N89              SETON                                            81    *Ulest G finnes
N42  C                   SETOFF                                       8881      ptf 42 89 er frigitt
N42  C     KKKHEA        chain     FREETXT3                           33
N42  C  N33              SETON                                            88    *Freetxt finnes
N42  C                   move      *blanks       Ulest
N42  C                   move      'G'           xgTKOD
N42  C     UlestKey      chain     FREETXT3                           33
N42  C  N33              SETON                                            81    *Ulest G finnes
N42  C  N33              eval      Ulest=%trim(Ulest)+xgTKOD
N42  C                   move      'P'           xgTKOD
N42  C     UlestKey      chain     FREETXT3                           33
N42  C  N33              eval      Ulest=%trim(Ulest)+xgTKOD                    *Ulest G finnes
      *
N42   * I rødt felt INFTXT vis viktig status-info som BOOKING mm
N42  c                   move      *blanks       INFTXT
S49  c*                  if        HESTN1 = 'B'
N42  c*                  eval      INFTXT = 'BOOKING!'
N49  c                   if        HESTN7 = 'P'
N42  c                   eval      INFTXT = 'PreBooking'
N42  c                   endif
N49  c                   if        HESTN7 = 'P'
N42  c                   eval      INFTXT = 'PreBooking'
N42  c                   endif
N54  c                   if        HESTN1 = 'E' or HESTN2 = 'E' or HESTN3 = 'E'
N54  c                                          or HESTN4 = 'E' or HESTN5 = 'E'
N54  c                   eval      INFTXT = 'Ekspress!!'
N54  c                   endif
      *
      * ROSA(lilla?) AVSENDER hvis udisponert og avvist fra PDA
     C                   move      *off          *in71
     C     HEPRO         IFEQ      *zeros
N23  C*    TTPDAK        Chain     TRACKL02                           33
N23  C                   MOVE      'NEI'         TTACTI
N23  C     TT02KEY       Chain     TRACKL02                           33
     C  N33              move      *on           *in71
     C                   end
      *
      * Konverter fra/til dato til lokalt format
      *
     C                   MOVE      TRSDFD        WRSDFD
     C                   MOVE      TRSDTD        WRSDTD
     C     FIDTFM        IFNE      3
     C                   CALL      'DATFM4'
     C                   PARM                    FIDTFM
     C                   PARM                    WRSDFD
     C                   PARM                    WRSDTD
     C                   PARM                    DATO0
     C                   PARM                    DATO0
     C                   END
     C     TRSDFK        COMP      *ZEROS                             86
     C     *IN86         IFEQ      '1'
     C     TRSDFD        ANDEQ     TODAY
     C                   Z-ADD     TRSDFK        WRSDFD
     C                   END
     C     TRSDTK        COMP      *ZEROS                             87
     C     *IN87         IFEQ      '1'
     C     TRSDTD        ANDEQ     TODAY
     C                   Z-ADD     TRSDTK        WRSDTD
     C                   END
      * URGENT
N69  C                   MOVE      *blanks       URGTXT            7
N69  C                   MOVE      'URG'         TTACTI
N69  C     TT02KEY       Chain     TRACKL02
N69  C                   if        %found and %subst(TTTEXT:1:8)='*URGENT*'
N69  C                   eval      URGFins= 'J'
N69  C                   eval      URGTXT = '*PRIO* '
N69  C                   endif
      *
      * TRANSP-INNLAND:"IKKE GODKJENT BELØP"/VARME(TRFA11)/ FARLIG(.21)
     C     *IN67         IFEQ      *ON
     C     *IN68         OREQ      *ON
     C     HXBLGK        COMP      *BLANKS                                84
     C     *in84         ifeq      *ON
     C     TROPD0        andne     *zeros
     C     TRFRAB        IFNE      *zeros
     C     HEPK1         ANDNE     ' '
     C     HEFBV         ANDNE     *zeros
     c                   end
     c                   end
     C     TRFA11        COMP      *BLANKS                            8383
     C     TRFA21        COMP      *BLANKS                            8282
     C     HEFT1         COMP      *BLANKS                            8080
     C   80HEKFT1        COMP      *BLANKS                                80
S28  C*    TRETTB        COMP      *ZEROS                             79
N23   *
N23   * INNGÅEND/Hentehåndtering - ulike farger avhengig av hvor langt i prosessen
N23   * Farge-oppfølging kun dersom Hentemail er sendt ut
N23  C                   MOVEA     '00000'       *IN(72)
N23  C     KODAKH        CHAIN     KODTA                              33
N23  C                   IF        *IN33='0' and KOAIE='2'
N23   * hvis inngående  - farge etter hvor langt den er kommet (*IN84 = Rev img)
N23   * CMS = Hentemail sendt = vilkår for å sette farge
N23  c                   if        UHStat>='10' and UHStat<='90'
N23  c                   move      *on           *in84
N23  c                   select
N23  c     UHStat        wheneq    '10'
N23  c                   move      *on           *in80                      Rød=ikke klar
N23  c     UHStat        wheneq    '20'
N23  c                   move      *on           *in75                      Pink=Klar for hentin
N23  c     UHStat        wheneq    '30'
N23  c                   move      *on           *in72                      Gul =Tildelet transp
N23  c     UHStat        wheneq    '40'
N23  c                   move      *on           *in76                      Hvit=BekreftetTransp
N23  c     UHStat        wheneq    '50'
N23  c                   move      *on           *in74                      Turkis=Hentet h.Avs
N23  c     UHStat        wheneq    '60'
N23  c                   move      *on           *in73                      Blå=Ankommet TERM
N23  c     UHStat        wheneq    '99'
N23  c                   move      *off          *in84                      TEI+på TUR=ferdig/OK
N23  c                   endsl
N23  c                   endif
N23   *
N23  C                   ENDIF
     C                   END                                                    end 67or68=Innland
      * I TRANSP-INNLAND - SF.FELT I DS
      * UTGÅENDE
     C     *IN67         IFEQ      *ON
     C     *IN68         ANDEQ     *OFF
     C                   Move      *blanks       SFDS01
     C     VisGate       IFEQ      'J'
     C                   MOVEL     HENAS         DS1AMG
     C                   MOVEL     HENAK         DS1MMG
     C                   MOVEL     HEADK1        DS1GMG
     C                   else
     C                   MOVEL     HENAS         DS1AVS
N69  C                   if        URGTXT <> *blanks
N69  C                   eval      DS1AVS = URGTXT+DS1AVS
N69  C                   endif
     C                   MOVEL     HENAK         DS1MOT
      * VED DISP E/ V -SJEKK ANT KLL/SKUTT..
     C     WSDIST        IFEQ      'E'
     C     WSDIST        OREQ      'V'
     C                   EXSR      GETMAI
     C   71              move      Mantxt        DS1AVS
     C                   END
     C                   end
     C                   MOVEL     HESDT         DS1PNR
     C                   MOVEL     HSTO          DS1STE
      * HVIS PÅ TUR, OG SKUTT TIL BIL - vis skytestatus
     C     HEPRO         IFNE      *ZEROS
     C                   MOVE      '    '        BSTS              4
     C                   EXSR      TSTBSTS
     C     BSTS          IFNE      *BLANKS
     C                   MOVE      BSTS          DS1MOT
     C                   END
     C                   END
     C     TRSTAF        IFNE      ' '
     C     TRSTAE        ORNE      ' '
     C                   MOVE      SFDSFE        DS1STE
     C                   END
     C                   MOVE      SFDS01        SFDS
     C                   ELSE
      * INNGÅENDE
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *ON
     C                   MOVEL     HENAS         DS2AVS
N69  C                   if        URGTXT <> *blanks
N69  C                   eval      DS2AVS = URGTXT+DS2AVS
N69  C                   endif
     C                   MOVEL     HENAK         DS2MOT
     C                   MOVEL     HESDF         DS2PNR
     C                   MOVEL     HSFROM        DS2STE
     C     TRSTAF        IFNE      ' '
     C     TRSTAE        ORNE      ' '
     C                   MOVE      SFDSFE        DS2STE
     C                   END
     C                   MOVE      SFDS02        SFDS
     C                   ELSE
      * "ORDRE-MODUS"
     C     *IN67         IFEQ      *ON
     C     *IN68         ANDEQ     *ON
     C                   MOVE      WXSNDN        DS3SND
     c     WXSNDN        IFEQ      *BLANKS
     C                   MOVE      WXSND1        DS3SND
     C                   END
     C                   MOVEL     HEPRO         DS3PRO
     c     HEPRO         IFEQ      *ZEROS
     C                   MOVE      *BLANKS       DS3PRO
     C                   END
     C                   MOVEL     HEAVD         DS3AVD
     C                   MOVEL     HEOPD         DS3OPD
     C                   MOVEL     HESG          DS3SG
     C                   MOVEL     DISTA1        DS3DIS
     C                   MOVEL     HENAS         DS3AVS
     C                   MOVEL     HENAK         DS3MOT
     C                   MOVEL     HEST          DS3ST
     C                   MOVE      SFDS03        SFDS
     C                   END
     C                   END
     C                   END
N73  C     WSTT          IFEQ      'V'                                          V= Vis
N73  C                   exsr      TTstatus
N73  c                   ENDIF
      *
     C                   ENDSR
N27  C***********************************************
N27  C     TTstatus      BEGSR
N27  C***********************************************
N27   * *IN(57) = '11' = ikke vis feltet
N27   *           '10' = Rød   Urørt
N27   *           '01' = Gul   Hentet
N27   *           '00' = Grønn Levert
N27  C                   Movea     '00'          *IN(57)
N27  C                   eval      HENLEV='Levert'
N27   * sjekk om den er levert / evt hentet
N27   * LEVERT ??
N27  C                   MOVE      'POD'         TTACTI
N27  c     TT02key       Chain     TRACKl02                           33
N27  C                   if        *in33=*on and TRSLAG='FF'
N27  C   33              MOVE      'TEI'         TTACTI
N27  c   33TT02key       Chain     TRACKl02                           33
N27  c                   endif
N27  C     *in33         ifeq      *ON
N27  C                   MOVE      'TE2'         TTACTI
N27  c     TT02key       setll     TRACKl02
N27  c     TT02key       reade     TRACKl02                               33
N27  c     *in33         doweq     '0'
N27  c                   if        %subst(TTTEXT:1:9)='Signed by'
N27  c                   leave
N27  c                   endif
N27  c     TT02key       reade     TRACKl02                               33
N27  c                   enddo
N27  c                   endif
N27   * er ikke levert...
N27   * HENTET ??
N27  C     *in33         ifeq      *ON
N27  C                   Movea     '01'          *IN(57)
N27  C                   eval      HENLEV='Hentet'
N27  C                   MOVE      'COL'         TTACTI
N27  c     TT02key       Chain     TRACKl02                           33
N27  C   33              MOVE      'TEU'         TTACTI
N27  c   33TT02key       Chain     TRACKl02                           33
N27   * heller ikke hentet
N27  C   33              Movea     '10'          *IN(57)
N27  C   33              eval      HENLEV='Urørt'
N31   * På term ?
N31  c     *in33         ifeq      '1'
N31  C                   MOVE      'TEI'         TTACTI
N31  c     TT02key       Chain     TRACKl02                           33
N31  C   33              MOVE      'TE2'         TTACTI
N31  c   33TT02key       Chain     TRACKl02                           33
N31  C  N33              eval      HENLEV='På Term'
N31  C  N33              Movea     '01'          *IN(57)
N31  c                   endif
N27  c                   endif
N75
N75   * Hvis ennå ikke ankommet teminal (TEI) sjekk om påbegynt skyting..
N75  C                   if        HENLEV='Urørt' or
N75  C                             HENLEV='Hentet'
N75  C                   move      HEAVD         FMAVD
N75  C                   move      HEOPD         FMOPD
N75  c     DokKey        setll     DOKUFM
N75  c     DokKey        reade     DOKUFM
N75  c                   dow       not %eof
N75  c                   if        FMITER = 'X'
N75  C                   Movea     '01'          *IN(57)
N75  C                   eval      HENLEV='På Te(D)'
N75  c                   leave
N75  c                   endif
N75  c     DokKey        reade     DOKUFM
N75  c                   enddo
N75  c                   endif
N75
N27   *
N27  c                   ENDSR
     C*
     C***********************************************
     C     GETMAI        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        ANTTOT            3 0
     C                   MOVE      *ZEROS        ANTMAN            3 0
N75  C                   move      HEAVD         FMAVD
N75  C                   move      HEOPD         FMOPD
     C     DokKey        setll     DOKUFM
     C     DokKey        Reade     DOKUFM                                 33
     C     *IN33         DOWEQ     *OFF
     C                   ADD       1             ANTTOT
     C     FMITER        IFEQ      ' '
     C                   ADD       1             ANTMAN
     C                   END
     C     DokKey        Reade     DOKUFM                                 33
     C                   END
     c     Antman        comp      *zeros                             71
     C                   Move      *blanks       ManTxt           11
     C                   eval      Mantxt =' Ma:' +
     C                             %trim(%editc(ANTMAN:'Z'))+'/'+
     C                             %trim(%editc(ANTTOT:'Z'))
     C                   ENDSR
     C*
     C***********************************************
     C     TSTBSTS       BEGSR
     C***********************************************
      * Er skyting på gang på turen??
     C     BSTS          IFEQ      '*TUR'
     C                   MOVE      '    '        BSTS              4
     C     STSTKEY       CHAIN     STSTUR                             33
     C     *IN33         CABEQ     '1'           UTBSTS
     C     STSTAT        IFNE      ' '
     C                   MOVE      '*TUR'        BSTS
     C                   GOTO      UTBSTS
     C                   END
     C                   END
      *
     C                   MOVE      '    '        BSTS              4
      * sjekk om helt/delvis skutt ut til bil
      * Sjekk på oppdragsnivå..
     C     STSKEY        CHAIN     STSOPD                             33
     C     *IN33         IFEQ      '0'
     C     SOSTAT        IFNE      ' '
     C                   MOVE      stsds         BSTS
     C                   ELSE
      * OPPDRAG finnes i skytefil men er ÅPENT - enkeltkolli skutt??
     C     STSKEY        SETLL     STSCLI
     C     STSKEY        READE     STSCLI                                 33
     C     *IN33         DOWEQ     '0'
     C     SCSTAT        IFNE      ' '
     C                   MOVE      ' (D)'        BSTS
     C                   goto      UTBSTS
     C                   END
     C     STSKEY        READE     STSCLI                                 33
     C                   END
     C                   END
     C                   END
     C*
     C     UTBSTS        ENDSR
     C*
     C***********************************************
     C     CMDT2         BEGSR
     C***********************************************
     C                   MOVE      'DIV0020'     MSGN2K
     C                   MOVE      'DIV0032'     MSGN2L
     C                   MOVE      'JOV0279'     MSGN2M
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUSPØR            1
     C     bokske        KLIST
     C                   KFLD                    bojob
     C                   KFLD                    bon
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2OPD
     C     TURERK        KLIST
     C                   KFLD                    WXTUR
     C     TURKEY        KLIST
     C                   KFLD                    TUAVD
     C                   KFLD                    TUPRO
     C     TURE2K        KLIST
     C                   KFLD                    YBILN
     C                   KFLD                    YDT
     C     KOSB9K        KLIST
     C                   KFLD                    YYST              1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADFK        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOPD
     C     KKKHEA        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     KKKHE0        KLIST
     C                   KFLD                    YYAVD0
     C                   KFLD                    YYOPD0
N01  C     UlestKey      KLIST
N01  C                   KFLD                    HEAVD
N01  C                   KFLD                    HEOPD
N01  C                   KFLD                    xgTKOD            1
N01  C                   KFLD                    xgTLES            1
N01  C                   move      'G'           xgTKOD
     C     DOKUF0K       KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    YYAVD0
     C                   KFLD                    YYOPD0
     C                   move      'F'           DFRI
     C     HEADFF        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     HEAD2K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSSG
     C                   KFLD                    LLDATO
     C     HEAD2E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSSG
     C     HEAD3K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSGN
     C     HEAD4K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKNSF
     C                   KFLD                    LLDATO
     C     DSP19K        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C                   KFLD                    LLDATO
     C     DSP19E        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C     DOKKEY        KLIST
     C                   KFLD                    FMRI
S75  C*                  KFLD                    HEAVD
S75  C*                  KFLD                    HEOPD
N75  C                   KFLD                    FMAVD
N75  C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C                   MOVE      'F'           FMRI
     C                   Z-ADD     1             FMFBNR
     C                   MOVE      *ZEROS        FMLINR
     C     HEAD4E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKNSF
     C     HEAD5K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKNKF
     C                   KFLD                    LLDATO
     C     HEAD5E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSKNKF
     C     HEAD6K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOPDT
     C                   KFLD                    LLDATO
     C     HEAD6E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSOPDT
     C     HEAD7K        KLIST
     C                   KFLD                    XAVD
     C*                  KFLD                    WSRFA
     C                   KFLD                    WSRFA35
N47  C     HEA47K        KLIST
N47  C                   KFLD                    XAVD
N47  C                   KFLD                    WSRFK35
N68  C                   KFLD                    LLDATO
N68  C     HEA35K        KLIST
N68  C                   KFLD                    WSRFK35
N68  C                   KFLD                    LLDATO
     C     HEAD8K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSPRO
     C     HEA14K        KLIST
     C                   KFLD                    WSPRO
     C     HEA33K        KLIST
     C                   KFLD                    WSAGNR
     C                   KFLD                    LLDATO
     C     HEA33KSG      KLIST
     C                   KFLD                    WSAGNR
     C                   KFLD                    GTDATO
     C     HEA33E        KLIST
     C                   KFLD                    WSAGNR
     C     HEA10K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSNRAG
     C                   KFLD                    LLDATO
     C     HEA10E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSNRAG
     C     HEA29K        KLIST
     C                   KFLD                    WSNRAG
     C                   KFLD                    LLDATO
     C     HEA29E        KLIST
     C                   KFLD                    WSNRAG
     C     HEA12K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSHAWN
     C                   KFLD                    LLDATO
     C     HEA12E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSHAWN
     C     FAI2K         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSFN
     C     KODTAK        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    WSAVD
N70  C     KODTAKI       KLIST
N70  C                   KFLD                    XKAUNII
N70  C                   KFLD                    WSAVD
N70  C                   move      'I'           XKAUNII           1
     C     KODAKA        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    WSAVDU
N23  C     KODAKH        KLIST
N23  C                   KFLD                    XKAUNI
N23  C                   KFLD                    HEAVD
N23  C     KunMineK      KLIST
N23  C                   KFLD                    ZUSER
N23  C                   KFLD                    HEAVD
     C     KODAKT        KLIST
     C                   KFLD                    XKAUNI
     C                   KFLD                    UUAVD
     C     DSP09K        KLIST
     C                   KFLD                    YSTEF
     C                   KFLD                    LLDATO
     C     DSP13K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    YSTEF
     C                   KFLD                    LLDATO
     C     DSP10K        KLIST
     C                   KFLD                    YSONF
     C                   KFLD                    LLDATO
     C     DSP14K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    YSONF
     C                   KFLD                    LLDATO
     C     DSP15K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    YSTET
     C                   KFLD                    LLDATO
     C     DSP20K        KLIST
     C                   KFLD                    YSTET
     C                   KFLD                    LLDATO
     C     DSP16K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    YSONT
     C                   KFLD                    LLDATO
     C     DSP11K        KLIST
     C                   KFLD                    WSOPDT
     C                   KFLD                    LLDATO
     C     DIKEY         KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C     DSP12K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    LLDATO
     C     DSP11E        KLIST
     C                   KFLD                    WSOPDT
     C     DSP12E        KLIST
     C                   KFLD                    XAVD
     C     DSP08K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    LLDATO
     C     DSP08E        KLIST
     C                   KFLD                    XAVD
     C     DSP04K        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C                   KFLD                    XAVD
     C                   KFLD                    LLDATO
     C     DSP17K        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C                   KFLD                    YSTET
     C                   KFLD                    LLDATO
     C     DSP18K        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C                   KFLD                    YSTEF
     C                   KFLD                    LLDATO
     C     DSP04E        KLIST
     C                   KFLD                    YDIST
     C                   KFLD                    YPRO
     C                   KFLD                    XAVD
     C     FRIS1K        KLIST
     C                   KFLD                    WSFRI1
     C                   KFLD                    WSFRI2
     C                   KFLD                    lldato
     C     FRIS2K        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSFRI1
     C                   KFLD                    WSFRI2
     C                   KFLD                    lldato
     C     FRIS2E        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    WSFRI1
     C     FRIKEY        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C                   KFLD                    WSFRI1
     C                   KFLD                    WSFRI2
     C     FRIKEE        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C                   KFLD                    WSFRI1
n22  C     FRITIL        KLIST
n22  C                   KFLD                    HEAVD
n22  C                   KFLD                    HEOPD
n22  C                   KFLD                    xxFBNR            3 0
n22  C                   KFLD                    TIKODE            3
     C     FRIOPK        KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
      * T&T NEI - ordre avvist fra PDA.
N23  C*    TTPDAK        KLIST
N23  C     TT02KEY       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    TTFBNR
     C                   KFLD                    TTACTI
N23  C*                  MOVE      'NEI'         TTACTI
      *
s22  C*    LOGKEY        KLIST
s22  C*                  KFLD                    LOJONR
s22  C*                  KFLD                    FASTKO            2
s22  C*                  MOVE      '00'          FASTKO
     C     PRODKE        KLIST
     C                   KFLD                    YKFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'PRODTYPE'    YKFTYP
     C     *LIKE         DEFINE    KFTYP         YKFTYP
     C     STSKEY        KLIST
     C                   KFLD                    SOTYPE
     C                   KFLD                    HEPRO
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     STSTkey       KLIST
     C                   KFLD                    SOTYPE
     C                   KFLD                    Xpro

     C     TRAKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TUKNT2
N03  C     SYPARKEY      KLIST
N03  C                   KFLD                    SYKUNR
N03  C                   KFLD                    SYPAID
      * SYKUNR/SYPAID settes ved bruk i prorammmet (blir ikke 'ødelagt'  av logikken under)
N38  C     SYPARKEY2     KLIST
N38  C                   KFLD                    ZUSER
N38  C                   KFLD                    SYPAID
N38  C                   move      'PPLAS'       SYPAID
N38  C     SYPARKEY2     CHAIN     SYPARL2                            33
N38  c  N33              MOVEL     SYVRDA        PersLaser        10
N38  C                   move      'PPLAB'       SYPAID
N38  C     SYPARKEY2     CHAIN     SYPARL2                            33
N38  c  N33              MOVEL     SYVRDA        PersLabPrt       10
      *
     C                   MOVE      *ZEROS        XAVD              4 0
     C                   MOVE      *ZEROS        DATO0             6 0
     C                   Z-ADD     0             YPRO              8 0
     C                   MOVEL     *BLANK        YDIST             1
     C                   MOVE      'A'           XKAUNI            1
     C                   MOVE      *ZEROS        HEAVD
      *
     C                   Z-ADD     3             SOANTK            1 0
      *
     C                   MOVE      'DIV1060'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV1062'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV4085'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C                   MOVE      *BLANKS       SOTXT4            8
     C                   MOVE      *BLANKS       SOTXT5            8
     C                   MOVE      *BLANKS       SOTXT6            8
     C                   MOVE      *BLANKS       SOTXT7            8
     C                   MOVE      *BLANKS       SOTXT8            8
     C                   MOVE      *ZEROS        SOKNR4            8 0
     C                   MOVE      *ZEROS        SOKNR5            8 0
     C                   MOVE      *ZEROS        SOKNR6            8 0
     C                   MOVE      *ZEROS        SOKNR7            8 0
     C                   MOVE      *ZEROS        SOKNR8            8 0
     C                   MOVE      *ZEROS        LLDATO            8 0
     C                   Z-ADD     999999999     GTDATO            8 0
     C                   MOVE      *ZEROS        TOMDATO           8 0
     C                   MOVE      *BLANKS       YSONF
     C                   MOVE      *BLANKS       YSONF2
     C                   MOVE      *BLANKS       YSONT
     C                   MOVE      *BLANKS       YSONT2
     C                   MOVE      *BLANKS       YSTEF
     C                   MOVE      *BLANKS       YSTEF2
     C                   MOVE      *BLANKS       YSTET
     C                   MOVE      *BLANKS       YSTET2
     C                   MOVE      *BLANKS       WSFRI2
     C* Definere hjelpevariabler for å bevare subfilvariable
     C     *LIKE         DEFINE    HEAVD         XXAVD
     C     *LIKE         DEFINE    HEOPD         XXOPD
     C     *LIKE         DEFINE    HENAS         XXNAS
     C     *LIKE         DEFINE    HENAK         XXNAK
     C     *LIKE         DEFINE    HEADS1        XXADS1
     C     *LIKE         DEFINE    HEADK1        XXADK1
     C     *LIKE         DEFINE    DITUAV        XXTUAV
     C     *LIKE         DEFINE    DITUR         XXTUR
     C     *LIKE         DEFINE    HESG          XXSG
     C     *LIKE         DEFINE    DUPASG        XXPASG
     C     *LIKE         DEFINE    DISTA1        XXSTA1
     C     *LIKE         DEFINE    HESDF         XXSDF
     C     *LIKE         DEFINE    HESDT         XXSDT
s27  C*    *LIKE         DEFINE    HENT4         XXNT4
s27  C*    *LIKE         DEFINE    HEVS10        XXVS10
n27  C     *LIKE         DEFINE    HENT          XXNT
n27  C     *LIKE         DEFINE    HEVS1         XXVS1
     C     *LIKE         DEFINE    HEM3          XXM3
     C     *LIKE         DEFINE    HELM          XXLM
N39  C     *LIKE         DEFINE    HELMLA        XXLMLA
N39  C     *LIKE         DEFINE    HEPOEN        XXPOEN
     C     *LIKE         DEFINE    HEOT          XXOT
     C     *LIKE         DEFINE    HEFR          XXFR
     C     *LIKE         DEFINE    HEST          XXST
     C     *LIKE         DEFINE    HESDFF        XXSDFF
     C     *LIKE         DEFINE    HESDVT        XXSDVT
     C     *LIKE         DEFINE    WXHAWB        XXHAWX
     C     *LIKE         DEFINE    WXTUR         XXTURX
     C     *LIKE         DEFINE    TRSDFD        XXSDFD
N27  C     *LIKE         DEFINE    TRSDFK        XXSDFK
     C     *LIKE         DEFINE    TRSTAF        XXSTAF
     C     *LIKE         DEFINE    TRSDTD        XXSDTD
N27  C     *LIKE         DEFINE    TRSDTK        XXSDTK
     C     *LIKE         DEFINE    TRSTAE        XXSTAE
     C     *LIKE         DEFINE    HEVKTW        XXVKTW
     C     *LIKE         DEFINE    ETTE          XXETTE
     C     *LIKE         DEFINE    IMCO          XXIMCO
N27  C     *LIKE         DEFINE    FAREKL        XXFAREKL
N27  C     *LIKE         DEFINE    HERFA         XXRFA
N50  C     *LIKE         DEFINE    HERFK         XXRFK
N27  C     *LIKE         DEFINE    HENLEV        XXHENLEV
      *
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          YÅÅ
     C                   ELSE
     C     UYEAR         ADD       2000          YÅÅ
     C                   END
     C                   MOVE      UMONTH        YMM               2 0
     C                   MOVE      UDAY          YDD               2 0
     C                   MOVE      YDT           TODAY             8 0
     C*
     C                   MOVE      'H'           UUR               1
     C*
     C                   EXSR      CMDT2
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   60
     C                   READ      FIRMARC                                60
     C  N60              MOVE      'J'           ARKIV             1
      * maxrecords i leseloop (pga filetr i les..)
N03  C                   Move      *zeros        MAXLES
N03  C                   Move      *zeros        SYKUNR
N03  C                   move      'MXOFI'       SYPAID
N03  C     SyParKey      CHAIN     SYPARL1                            33
N03  c  N33              z-add     SYVRDN        MAXLES            9 0
N42   * V=Vis T&T-staus
N42  C                   move      'VISTT'       SYPAID
N42  C     SyParKey      CHAIN     SYPARL1                            33
N42  c  N33              if        SYVRDA = 'J' or  SYVRDA = 'V'
N42  c                   MOVE      'V'           WSTT
N42  c                   endif
N15   * Default = protect ekstra filer
N15  C                   MOVE      '1'           *IN37
      *
      * TESTER HVA SLAGS INNGANG SOM ER VALGT
      *
     c                   move      *off          *in66
     C     UUSPØR        ifeq      'I'
     c                   move      'A'           UUSPØR
     c                   move      'J'           innland           1
     c                   move      *on           *in66
     c                   open      displ17
     c                   open      displ18
     c                   end
      *
     C     UUSPØR        COMP      'J'                                    60
      *
      * Inngang er "Arbeide med" -default: alle Udisponerte datosortert
      *
     C     UUSPØR        COMP      'A'                                    61
     C   61              MOVE      'U'           WSDIST
     C   61              SETON                                        31
     C                   MOVE      WSDIST        W2STA1
     C*
     C                   MOVE      UDSAVD        WSAVD
     C                   MOVE      UDSAVD        WSAVDU
     C                   MOVE      UDSAVD        XAVD
     C                   Z-ADD     0             WSOPD
      *
     C                   EXSR      OPSJON
     C                   EXSR      CMDFT
      *
     C                   MOVEA     '00'          *IN(67)
     C     KODAKA        CHAIN     KODTA                              33
     c     innland       ifeq      'J'
     C     zuser         CHAIN     usrdft                             33
      * Default-verdier for subfil-visning (kan switches med F2 el M1/M2/M3)
      * 1=UTgående, 2=Inngående, 3="ordre-behandl.modus"
     C                   MOVEA     '10'          *IN(67)
     C     KOAIE         IFEQ      '2'
     C                   MOVEA     '01'          *IN(67)
     c                   end
     C                   END
      *
     c                   move      *zeros        bodate
     c                   move      *zeros        timedate
     c                   move      *zeros        l2a
     c                   move      *zeros        l2v
N27  c                   move      *zeros        l2m
     c                   move      *zeros        l2t
     c                   move      *blanks       l2b
      *
      * skjekker i boksfil for arbeidsstasjon
      *
     c     innland       ifeq      'J'
     c                   exsr      boksinit
     c                   end
     c                   Move      ' ( )'        stsds
     c*
     C                   ENDSR
     C*
     C*
     C*************************************************
     C     boksinit      BEGSR
     C*************************************************
     c                   move      zuser         bouser
     c                   move      zjob          bojob
     c     1             do        4             bon
     c     bokske        chain     boksf                              33
      *
      * skriver record hvis ikke arbeidstasjon har boks tildelt i boksfil
      *
     c     *in33         ifeq      '1'
     c                   move      zuser         bouser
     c                   move      *zeros        botur
     c                   move      ' '           bostat
     c                   move      *zeros        botime
     c                   move      *zeros        bodate
     c                   write     boksr
     c                   else
     c     botur         chain     turer14                            33
      *
      * ikke ta fram tur hvis den er under arbeid
      *
     c  N33tust          ifne      'P'
     c     turkey        chain     turer                              33
      *
      * låser turrecord
      *
     c  N33              move      'P'           tust
     c  N33              update    turerr
      *
      * oppdaterer boksrecord
      *
     c                   move      bon           tl
     c                   move      botur         xpro
     C                   TIME                    timedate
     c                   MOVE      BOÅÅ          BOÅÅF
     c                   MOVE      BOMM          BOMMF
     c                   MOVE      BODD          BODDF
     c                   MOVE      'P'           BOSTAT
     c                   move      zuser         bouser
     c                   update    boksr
     c                   exsr      fixboks
      *
      * fjerner turen fra boks hvis andre jobber med den
      *
     c                   else
     c                   move      *zeros        botime
     c                   move      *zeros        bodate
     c                   move      *zeros        botur
     c                   move      ' '           bostat
     c                   move      zuser         bouser
     c                   update    boksr
     c                   end
     c                   endif
     c                   enddo
     c                   endsr
     c
     C*************************************************
     C     FjernVia2     BEGSR
     C*************************************************
     C*
     C                   MOVE      '0'           xxflag            1
     C                   MOVE      'VF'          xxvia             2
     C                   CALL      'SYTR33B'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    XXVIA
     C                   PARM                    XXFLAG
      *
     C     xxflag        IFEQ      '1'
     C                   MOVE      'JOV1207'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   else
     C     KKKHEA        CHAIN     headdum                            33
     C     KKKHEA        CHAIN(N)  DISP                               33
     C                   EXSR      SETSUB
     C                   END
      *
     C                   ENDSR
      *
     C*************************************************
     C     BYAVD         BEGSR
     C*************************************************
     C*
     C*
     C* NEW DEPARTMENT SELECTED
     C*
     C     KODTAK        CHAIN     KODTA                              30
N70  C   30KODTAKI       CHAIN     KODTA                              30
     C   30              GOTO      UTBY
     C                   MOVE      WSAVD         WSAVDO            4 0
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '0'           *IN(62)
     C*
     C     UTBY          ENDSR
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   MOVE      HEOPD         UOPD              7 0
     C                   MOVE      HEAVD         UAVD              4 0
     C     UUSPØR        IFEQ      'A'
     C                   Z-ADD     0             UFLAGG
     C                   ELSE
     C                   Z-ADD     1             UFLAGG
     C                   END
     C                   CALL      'SYFA31CL'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C*
      ***********************************************
     C     VISEDI        BEGSR
      ***********************************************
     C                   MOVE      '4'           WIN03             1
     C                   MOVE      HEAVD         UAVD
     C                   MOVE      HEOPD         UOPD
     C                   CALL      'SAD003'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    WIN03
     C                   MOVE      *BLANKS       WSNR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MAX           BEGSR
     C***********************************************
N08   * HELE RUTINEN SLETTET(SE UNDR) OG FORENKLET
N28
     C                   MOVE      WSSTEF        YSTEF             5
     C                   MOVE      WSSTEF        YSTEF2            5
N28  C                   eval      YSTEF2 =%trim(WSSTEF)+'999999999999999999999'
     C                   MOVE      WSSTET        YSTET             5
     C                   MOVE      WSSTET        YSTET2            5
N28  C                   eval      YSTET2 =%trim(WSSTET)+'999999999999999999999'
     C                   MOVE      WSSONF        YSONF             5
     C                   MOVE      WSSONF        YSONF2            5
N28  C                   eval      YSONF2 =%trim(WSSONF)+'999999999999999999999'
     C                   MOVE      WSSONT        YSONT             5
     C                   MOVE      WSSONT        YSONT2            5
N28  C                   eval      YSONT2 =%trim(WSSONT)+'999999999999999999999'
     C                   MOVE      WSFRI2        YFRI2            35
N28  C                   eval      YFRI2  =%trim(WSFRI2)+'999999999999999999999'
     C                   MOVE      WSSNDN        YXSND2           20
N28  C                   eval      YXSND2 =%trim(WSSNDN)+'999999999999999999999'
N28  C                   MOVE      *blanks       YMRK2            35
N28  C                   eval      YMRK2=%trim(WSMERK)+'99999999999999999999999'
S28   **
S28   ** resten kan fjernes samt SR REPLAC
S28  C*
S28  C*                  MOVE      '9'           ERSTAT            1
S28  C*
S28  C*    YSTEF2        IFEQ      *BLANKS
S28  C*                  MOVE      '99999'       YSTEF2
S28  C*                  ELSE
S28  C*                  Z-ADD     5             NMT
S28  C*                  MOVEL     YSTEF2        REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YSTEF2
S28  C*                  END
S28  C*
S28  C*    YSTET2        IFEQ      *BLANKS
S28  C*                  MOVE      '99999'       YSTET2
S28  C*                  ELSE
S28  C*                  Z-ADD     5             NMT
S28  C*                  MOVEL     YSTET2        REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YSTET2
S28  C*                  END
S28  C*
S28  C*    YSONF2        IFEQ      *BLANKS
S28  C*                  MOVE      '99999'       YSONF2
S28  C*                  ELSE
S28  C*                  Z-ADD     5             NMT
S28  C*                  MOVEL     YSONF2        REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YSONF2
S28  C*                  END
S28  C*
S28  C*    YSONT2        IFEQ      *BLANKS
S28  C*                  MOVE      '99999'       YSONT2
S28  C*                  ELSE
S28  C*                  Z-ADD     5             NMT
S28  C*                  MOVEL     YSONT2        REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YSONT2
S28  C*                  END
S28   *
S28   * FRI SØKEVEI
S28   *
S28  C*    YFRI2         IFEQ      *BLANKS
S28  C*                  MOVEL     '999999999999'YFRI2
S28  C*                  CAT       '999999999':0 YFRI2
S28  C*                  CAT       '999999999':0 YFRI2
S28  C*                  CAT       '99999':0     YFRI2
S28  C*                  ELSE
S28  C*                  Z-ADD     35            NMT
S28  C*                  MOVEL     YFRI2         REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YFRI2
S28  C*                  END
S28   *  SEND NR
S28  C*    YXSND2        IFEQ      *BLANKS
S28  C*                  MOVEL     '9999999999'  YFRI2
S28  C*                  CAT       '9999999999':0YFRI2
S28  C*                  ELSE
S28  C*                  Z-ADD     20            NMT
S28  C*                  MOVEL     YXSND2        REPLA
S28  C*                  EXSR      REPLAC
S28  C*                  MOVEL     REPLA         YXSND2
S28  C*                  END
     C*
     C                   ENDSR
      *
      ***********************************************
     C     SLETTO        BEGSR
      ***********************************************
      *
      * SLETTING AV ORDRE
      * ordrestatus må være blank
      * og den må ikke være satt på tur
      *
     C     KKKHEA        CHAIN     HEADF                              33
     C     HEST          COMP      ' '                                7070
     C  N70HEPRO         COMP      *ZEROS                             7070
     C   70              MOVE      'DIV4092'     MSGNR
     C   70              SETON                                        30
     C   70
     CANN33              EXCEPT    DUMMY
     c   30              goto      slutx
      *
      * IKKE TILATT Å SLETTE NÅR DUP-OPPDRAG LIGGER UNDER.....
      *
     C  N70TROPD1        IFNE      *ZEROS
     C     TROPD2        ORNE      *ZEROS
     C                   MOVE      'JOV0171'     MSGNR
     C                   SETON                                        3070
     C                   END
     C   70              GOTO      SLUTX
      *
      * SJEKK MOT FAKTURALINJER
      *
     C                   CALL      'SYFA93B'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    SLETTE            1
     C     SLETTE        IFEQ      'N'
     C  N33              EXCEPT    DUMMY
     C                   MOVE      'SHU0671'     MSGNR
     c                   seton                                        30
     C                   GOTO      SLUTX
     C                   END
      *
      * sletting kan utføres
      *
N26  C     FIURBL        IFEQ      'J'
N26  C                   setoff                                       30
N26  C     DelWnd        tag
N26  C                   exfmt     DELWIND
N26  c     *in12         cabeq     '1'           SLUTX
N26  c     WSDREA        ifeq      *blanks
N26  C                   MOVE      'JOV1610'     MSGNR2
N26  C                   seton                                        30
N26  C                   goto      DelWnd
N26  c                   endif
N26  C                   EXSR      TTSRDEL
N26  C                   END
      *
     C                   MOVE      'S'           HEST
     C                   MOVE      *BLANKS       HENAS
     C                   MOVEL     '*SLETTET*'   HENAS
     C                   MOVE      *BLANKS       SFDS
     C                   MOVEL     '*SLETTET*'   SFDS
     C                   MOVE      'J'           HEPK3
     C     innland       IFEQ      'J'
     C                   MOVEL     '*D*'         HXSNDN
     C                   END
     C                   UPDATE    HEADFR
     C     KKKHEA        CHAIN     DISP                               33
     C  N33              MOVE      'D'           DISTA1
     C  N33              UPDATE    DISPR
      *
      * Slett REKVISISJONER
      *
     C     HEOPD         IFNE      *ZEROS
     C     KOSB9K        CHAIN     KOSBU9                             33
     C     *IN33         DOWNE     '1'
     C                   MOVE      'S'           BUST
     C     BUBLST        IFEQ      'T'
     C                   MOVE      'E'           BUBLST
     C                   END
     C                   UPDATE    KOSBUR
     C     KOSB9K        READE     KOSBU9                                 33
     C                   END
     C                   END
      *
      * Slett fakturalinjer
      *
     C     KKKHEA        SETLL     FAK4
     C     KKKHEA        READE     FAK4                                   33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    FAKTR
     C     KKKHEA        READE     FAK4                                   33
     C                   END
N55   *
N55   * Slettemerk frisok med å sette *D i pos 34/35 (f.eks IFB benyttes ofte for UNIK-test)
N55   *
N55   * Åpne fila om den ikke er benyttet før
N55  C     FRISOP        IFNE      '1'
N55  C                   OPEN      FRISOK
N55  C                   END
N55  C     KKKHEA        SETLL     FRISOK
N55  C     KKKHEA        READE     FRISOK                                 33
N55  C     *IN33         DOWEQ     '0'
N55  C                   move      '*D'          FSSOK
N55  C                   UPDATE    FRISOKR
N55  C     KKKHEA        READE     FRISOK                                 33
N55  C                   END
      *
      * Fjern evt post i samlefakt-kø.
      *
     C     KKKHEA        CHAIN     SAML1                              33
     C  N33              DELETE    SAMLR
      *
      * Slettemerk kolli ID ( 0 i fbnr = på alle fraktbrev...)
     C                   MOVE      *ZEROS        XXFBNR            3 0
     C                   Call      'SYFI10Z'
     C                   Parm                    HEAVD
     C                   Parm                    HEOPD
     C                   Parm                    XXFBNR
      * FJERN EVT. OPPADGÅENDE XREF (TIL OVERORDNET)
      * (DET FINNES INGEN UNDER - DET ER TESTET LENGER OPPE)
      *
     C     KKKHEA        CHAIN     HEADF                              33
     C     *IN33         IFEQ      '0'                                          B1
     C                   MOVE      HEAVD         YYAVD             4 0           *DETTE
     C                   MOVE      HEOPD         YYOPD             7 0
     C                   MOVE      TRAVD0        YYAVD0            4 0           *OVER SEG
     C                   MOVE      TROPD0        YYOPD0            7 0
     C                   MOVE      *ZEROS        TRAVD0
     C                   MOVE      *ZEROS        TROPD0
     C                   UPDATE    HEADFR
      *
      * ER EN SLAVE AV ET ANNET OPPDRAG - SLETTE XREFEN I OVERORDNET.
      *
     C     YYOPD0        IFNE      *ZEROS                                        B2
     C     KKKHE0        CHAIN     HEADF                              33
     C     *IN33         IFEQ      '0'                                            B3
     C                   Move      'J'           XDupFb            1
     C     TROPD1        IFEQ      YYOPD
     C     TRAVD1        ANDEQ     YYAVD                                           B4
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      ' '           TRSTAF
     C                   Move      'N'           XDupFb
     C                   END                                                       E4
     C     TROPD2        IFEQ      YYOPD
     C     TRAVD2        ANDEQ     YYAVD                                           B4
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      ' '           TRSTAE
     C                   Move      'N'           XDupFb
     C                   END                                                       E4
     C                   UPDATE    HEADFR
      * Om det IKKE var DUP fra oppdrag må det være fra fbrev.
     C     XDupFb        IFEQ      'J'
     C                   MOVE      YYAVD         YYAVDA            4
     C                   MOVE      YYOPD         YYOPDA            7
     C     DOKUF0K       SETLL     DOKUF
     C     DOKUF0K       READE     DOKUF                                  33
     C     *in33         DOWEQ     '0'
     C     YYAVDA        IFEQ      DFBRAV
     C     YYOPDA        ANDEQ     DFBROP
     C                   MOVE      *BLANKS       DFBREF
     C                   UPDATE    DOKUFR
     C                   goto      UtFrDup
     C                   ELSE
     C                   UPDATE    DOKUFR
     C                   END
     C     DOKUF0K       READE     DOKUF                                  33
     C                   END
     C     UtFrDup       Tag
     C                   END
     C                   END                                                      E3
     C                   END                                                     E2
     C                   MOVE      YYAVD         HEAVD                           *DETTE
     C                   MOVE      YYOPD         HEOPD
     C* SLETT      EVT FRAKTBREV (GJENBRUK AV SENDINGSNR I INNLANDSYSTEM..)
     C                   MOVE      HEAVD         YYAVD0
     C                   MOVE      HEOPD         YYOPD0
     C     DOKUF0K       CHAIN     DOKUF                              33
     C     *IN33         ifeq      *OFF
s04  c*                  Movel     '*D*'         DF1004
s04  C*                  update    dokufr
N04  C                   delete    dokufr
     C                   END                                                    E1
     C                   END                                                    E1
     C                   SETOFF                                       33
     C     SLUTX         ENDSR
S28  C***********************************************
S28  C*    REPLAC        BEGSR
S28  C***********************************************
S28  C*    NMT           IFEQ      0
S28  C*                  Z-ADD     15            NMT
S28  C*                  END
S28   * Var ERSTAT må settes til ønsket erstatningsverdi. Eks. 9
S28   * Var REPLA må være venstrejustert og returneres med alle
S28   * blanke satt lik erstatningverdi
S28   *
S28   *
S28   * 2. Erstatter blanke med erstatningstegn
S28   *
S28  C*                  MOVEA     REPLA         RX
S28  C*    NMT           DOWGT     1
S28  C*    RX(NMT)       IFEQ      ' '
S28  C*                  MOVEA     ERSTAT        RX(NMT)
S28  C*                  SUB       1             NMT               3 0
S28  C*                  ELSE
S28  C*                  LEAVE
S28  C*                  ENDIF
S28  C*                  ENDDO
S28  C*                  MOVEA     RX            REPLA            35
S28   *
S28  C*                  ENDSR
     C***********************************************
     C     OPSJON        BEGSR
     C***********************************************
     C     *IN60         IFEQ      '1'
     C                   MOVE      'YBC0079'     MSGC1V
     C                   ELSE
     C     *IN61         IFEQ      '1'
     C                   SELECT
     C     XMSGCT        WHENEQ    0
     C                   ADD       1             XMSGCT            1 0
s41  C*                  MOVE      'YBC0077'     MSGC1V
n41  C                   MOVE      'SHU1530'     MSGC1V
     C     XMSGCT        WHENEQ    1
     C                   ADD       1             XMSGCT            1 0
s41  C*                  MOVE      'YBC0628'     MSGC1V
n41  C                   MOVE      'SHU1531'     MSGC1V
     C     XMSGCT        WHENEQ    2
     C                   ADD       1             XMSGCT            1 0
s41  C*                  MOVE      'YBC0629'     MSGC1V
n41  C                   MOVE      'SHU1532'     MSGC1V
n41  C     XMSGCT        WHENEQ    3
n41  C                   Z-add     0             XMSGCT            1 0
n41  C*                  MOVE      'SHU1537'     MSGC1V
N64  C                   MOVE      'JOV1758'     MSGC1V
s41  C*    XMSGCT        WHENEQ    3
s41  C*                  ADD       1             XMSGCT            1 0
s41  C*                  MOVE      'JOV1193'     MSGC1V
s41  C*    XMSGCT        WHENEQ    4
s41  C*                  Z-ADD     0             XMSGCT
s41  C*                  ADD       1             XMSGCT            1 0
s41  C*                  MOVE      'JOV1387'     MSGC1V
s41  C*    XMSGCT        WHENEQ    5
s41  C*                  Z-ADD     0             XMSGCT
s41  C*                  MOVE      'SHU1457'     MSGC1V
     C                   ENDSL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CMDFT         BEGSR
     C***********************************************
      * 61 ON = ARBEIDE MED,  61 OFF = SPØRRING
      *                       60 ON  = SPØRRING
      * F7 / 18 dokumenter - snydd rekkefølge uten merking
     C                   SELECT
     C     XMSGB         WHENEQ    0
     C                   ADD       1             XMSGB             1 0
     C                   MOVE      'DIV0020'     MSGB1V                          F3
     C                   MOVE      'DIV0021'     MSGB2V                          F5
     C   61              MOVE      'DIV0022'     MSGB3V                          F6
     C   60              MOVE      'DIV0024'     MSGB3V                          F12
     C     XMSGB         WHENEQ    1
     C                   ADD       1             XMSGB
     C                   MOVE      'DIV0033'     MSGB1V                          F7
     C                   MOVE      'DIV0023'     MSGB2V                          F8
     C   61              MOVE      'JOV0215'     MSGB3V                          F9
     C  N61              MOVE      'DIV0000'     MSGB3V                          INGEN
     C     XMSGB         WHENEQ    2
     C                   ADD       1             XMSGB
     C                   MOVE      'SHU0677'     MSGB1V                          F10
     C                   MOVE      'JOV1158'     MSGB2V                          F11
     C                   MOVE      'DIV0000'     MSGB3V                          INGEN
     C     XMSGB         WHENEQ    3
     C                   ADD       1             XMSGB
     C                   MOVE      'JOV0182'     MSGB1V                          F16
     C                   MOVE      'JOV0183'     MSGB2V                          F17
     C                   MOVE      'JOV1427'     MSGB3V                          F18
     C     XMSGB         WHENEQ    4
     C                   Z-ADD     0             XMSGB
     C                   MOVE      'BBA0128'     MSGB1V                          F20
     C                   MOVE      'JOV0279'     MSGB2V                          F22
     C                   MOVE      'YBC0033'     MSGB3V                          F23
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYSØK         BEGSR
      ***********************************************
     C                   MOVE      WSAVD         XAVD3             4 0
     C                   MOVE      WSAVDU        XAVD4             4 0
     C                   MOVE      *IN66         XIN66             1
     C                   MOVE      *IN61         XIN61             1
N46  C                   MOVE      WSTT          XTT               1
     C                   CLEAR                   BILDE02
     C                   MOVE      XAVD3         WSAVD
     C                   MOVE      XAVD4         WSAVDU
     C                   MOVE      XIN66         *IN66
     C                   MOVE      XIN61         *IN61
N46  C                   MOVE      XTT           WSTT
     C     W2AVD         IFEQ      0
     C     WSAVD         IFEQ      0
     C                   MOVE      WSAVDU        WSAVD
     C                   END
     C                   ELSE
     C                   MOVE      W2AVD         WSAVD
     C                   END
     C     W2TUR         IFNE      0                                            1<-B
     C                   MOVE      W2TUR         WSPRO
     C                   END                                                    1<-E
     C     W2OPD         IFNE      0                                            1<-B
     C                   MOVE      W2OPD         WSOPD
     C                   END                                                    1<-E
     C     W2STA1        IFNE      WSDIST                                       1<-B
     C                   MOVE      W2STA1        WSDIST
     C                   END                                                    1<-E
     C     W2SDF         IFNE      *BLANKS                                      1<-B
     C                   MOVE      W2SDF         WSSTEF
     C                   END                                                    1<-E
     C     W2SDFD        IFNE      0                                            1<-B
     C                   MOVE      W2SDFD        WSDATO
     C                   END                                                    1<-E
     C     W2SDT         IFNE      *BLANKS                                      1<-B
     C                   MOVE      W2SDT         WSSTET
     C                   END                                                    1<-E
N27  C     W2RFA         IFNE      *BLANKS                                      1<-B
n27  C                   MOVEL     W2RFA         WSRFA
n27  C                   END                                                    1<-E
n27  C     W2TT          IFNE      *BLANKS                                      1<-B
n46  C     W2TT          IFEQ      '0'                                          0 = blanke
n46  c                   move      ' '           W2TT
n46  C                   END                                                    1<-E
n27  C                   MOVEL     W2TT          WSTT
n27  C                   END                                                    1<-E
     C     W2OT          IFNE      *BLANKS                                      1<-B
     C                   MOVE      W2OT          WSOPDT
     C                   END                                                    1<-E
     C     W2SNDN        IFNE      *BLANKS                                      1<-B
     C                   MOVE      W2SNDN        WSSNDN
     c                   exsr      fixsndnr
     C                   END                                                    1<-E
S27  C*    W2SND2        IFNE      *BLANKS                                      1<-B
S27  C*                  MOVE      W2SND2        WSSNDN
S27  C*                  exsr      fixsndnr
S27  C*                  END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2TUR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   MOVE      *BLANKS       W2SDF
     C                   MOVE      *ZEROS        W2SDFD
     C                   MOVE      *BLANKS       W2SDT
N27  C                   MOVE      *BLANKS       W2RFA
N27  C                   MOVE      *BLANKS       W2TT
     C                   MOVE      *BLANKS       W2OT
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
      *
     C                   MOVEA     '00000000'    *IN(41)
     C                   MOVEA     '00000000'    *IN(49)
     C                   MOVEA     '00'          *IN(62)
     C                   MOVEA     '00000'       *IN(27)
     C                   MOVE      '0'           *IN34
     C                   EXSR      TESTB2
      *
     C                   ENDSR
      *
     C***********************************************
     C     FixSndnr      BEGSR
     C***********************************************
     c     WSSNDN17      ifne      *blanks
     c     WSSNDN18      andeq     *blanks
     c                   movel     WSSNDN        Tmp17            17
     c                   eval      WSSNDN = '401'+Tmp17
S05  c*                  end
     C* SØK PÅ SENDNR er altid på tvers av avd / disp-status
     C                   Move      *zeros        WSAVD
     C                   Move      ' '           WSDIST
N05  c                   end
     C                   ENDSR
      *
     C***********************************************
     C     NYOPT         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      WSAVDU        W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  HEADF                              98
      *
      * BEHØVER IKKE VÆRE TRANSPORTDISPONERING VED FØLGENDE OPSJONER
      *
     C  N98W2NR          IFNE      '3 '
     C     W2NR          ANDNE     ' 3'
     C     W2NR          ANDNE     '50'
     C     W2NR          ANDNE     '51'
     C     W2NR          ANDNE     '52'
     C     W2NR          ANDNE     ' P'
     C     W2NR          ANDNE     'P '
N21  C     W2NR          ANDNE     '53'
n21  C     W2NR          ANDNE     ' Q'
n21  C     W2NR          ANDNE     'Q '
N25  C     W2NR          ANDNE     '54'
n25  C     W2NR          ANDNE     ' I'
n25  C     W2NR          ANDNE     'I '
N30  C     W2NR          ANDNE     '60'
n30  C     W2NR          ANDNE     ' J'
n30  C     W2NR          ANDNE     'J '
N71  C     W2NR          ANDNE     '61'
n30  C     W2NR          ANDNE     ' Y'
n30  C     W2NR          ANDNE     'Y '
     C     W2NR          ANDNE     ' 5'
     C     W2NR          ANDNE     '5 '
     C     W2NR          ANDNE     ' W'
     C     W2NR          ANDNE     'W '
     C     W2NR          ANDNE     '55'
     C     W2NR          ANDNE     '56'
     C     HEUR          COMP      'H'                                9898
     C                   END
     C   98              MOVE      'SPO0001'     MSGNR
     C   98              MOVE      'JOV1246'     MSGNR
     C   98              Z-ADD     5             LINNBR
     C   98              Z-ADD     10            POSNBR
      *
      *
      * TILLATT I ALLE MODUS (OGSÅ VED SPØRRING)
      *
     C  N98W2NR          IFEQ      '5 '
     C     W2NR          OREQ      ' 5'
     C     W2NR          OREQ      '7 '
     C     W2NR          OREQ      ' 7'
     C     W2NR          OREQ      '8 '
     C     W2NR          OREQ      ' 8'
     C     W2NR          OREQ      '9 '
     C     W2NR          OREQ      ' 9'
     C     W2NR          OREQ      '17'
     C     W2NR          OREQ      'K '
     C     W2NR          OREQ      ' K'
N20  C     W2NR          OREQ      'H '
N20  C     W2NR          OREQ      ' H'
N24  C     W2NR          OREQ      'G '
N24  C     W2NR          OREQ      ' G'
     C     W2NR          OREQ      '21'
     C     W2NR          OREQ      '50'
     C     W2NR          OREQ      'P '
     C     W2NR          OREQ      ' P'
     C     W2NR          OREQ      '51'
n21  C     W2NR          OREQ      'Q '
n21  C     W2NR          OREQ      ' Q'
n21  C     W2NR          OREQ      '53'
n25  C     W2NR          OREQ      'I '
n25  C     W2NR          OREQ      ' I'
n25  C     W2NR          OREQ      '54'
n30  C     W2NR          OREQ      'J '
n30  C     W2NR          OREQ      ' J'
n30  C     W2NR          OREQ      '60'
n30  C     W2NR          OREQ      'Y '
n30  C     W2NR          OREQ      ' Y'
n71  C     W2NR          OREQ      '61'
     C     W2NR          OREQ      'S '
     C     W2NR          OREQ      ' S'
     C     W2NR          OREQ      '52'
     C     W2NR          OREQ      ' W'
     C     W2NR          OREQ      'W '
     C     W2NR          OREQ      '55'
     C     W2NR          OREQ      '56'
N64  C     W2NR          OREQ      'HD'
     C                   MOVE      W2NR          WSNR
     C                   MOVE      W2AVD         HEAVD
     C                   MOVE      W2OPD         HEOPD
     C                   MOVE      '1'           *IN90
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   ELSE
      *
      * TILLATT KUN VED "ARBEIDE MED"
      *
     C     UUSPØR        IFEQ      'A'
     C     HEST          IFEQ      'S'
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      'JOV1248'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   END
     C  N98W2NR          IFEQ      '2 '
     C     W2NR          OREQ      ' 2'
     C     W2NR          OREQ      '3 '
     C     W2NR          OREQ      ' 3'
     C     W2NR          OREQ      '4 '
     C     W2NR          OREQ      ' 4'
     C     W2NR          OREQ      '6 '
     C     W2NR          OREQ      ' 6'
     C     W2NR          OREQ      '12'
     C     W2NR          OREQ      '13'
     C     W2NR          OREQ      '14'
     C     W2NR          OREQ      '24'
s22  C*    W2NR          OREQ      '15'
     C     W2NR          OREQ      '25'
     C     W2NR          OREQ      '26'
     C     W2NR          OREQ      'L '
     C     W2NR          OREQ      ' L'
N64  C     W2NR          OREQ      'HD'
N69  C     W2NR          OREQ      'U '
N69  C     W2NR          OREQ      ' U'
     C                   MOVE      W2NR          WSNR
     C                   MOVE      W2AVD         HEAVD
     C                   MOVE      W2OPD         HEOPD
     C                   MOVE      '1'           *IN90
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   ELSE
      * ukjent opsjon
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   END
     C                   ELSE
      * ikke "arbeide med-modus"
     C                   MOVE      'JOV1247'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   END
     C                   END
      *
     C   98              MOVE      '1'           *IN30
     C                   MOVE      *ZEROS        W2TUR
     C                   MOVE      *BLANKS       W2SDF
     C                   MOVE      *ZEROS        W2SDFD
     C                   MOVE      *BLANKS       W2SDT
N27  C                   MOVE      *BLANKS       W2RFA
N27  C                   MOVE      *BLANKS       W2TT
     C                   MOVE      *BLANKS       W2OT
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C*
     C                   ENDSR
      *
     C***********************************************
     C     SETTUR        BEGSR
     C***********************************************
      *
      * sette på tur ved å taste turnummer
      * feilindikator 97 settes på
      *
     C     TURERK        CHAIN     TURER14                            97
     C   97              MOVE      'SPT0002'     MSGNR
      *
      * turstatus må være ' ' hvi ikke i en av boksene
      *
     C     *in(97)       ifeq      '0'
     C     l2t(1)        andne     tupro
     C     l2t(2)        andne     tupro
     C     l2t(3)        andne     tupro
     C     l2t(4)        andne     tupro
     C     TUST          COMP      ' '                                9797
     C   97              MOVE      'YBC0098'     MSGNR
     C                   END
     C   97              MOVE      '1'           *IN30
     C   97              GOTO      SLSETT
     C
     C                   exsr      TstPrOpd
     C   30              GOTO      SLSETT
      *
      * OPPDATER PÅ HEADF
      *
s12  C*    TRAKEY        CHAIN     TRAN                               97
     C     KKKHEA        CHAIN     HEADF                              97
     C                   MOVE      TUPRO         HEPRO
     C                   move      *blanks       HEPOS1                         fjern evt gammel
     C                   move      *zeros        HEPOS2                         fjern evt gammel
     C                   MOVEL     TUBILN        HEHAWB
s14  C*                  MOVE      VMTRKU        HEKNT
N14  C                   MOVE      TUKNT2        HEKNT
     C                   MOVEL     TUBILN        WXHAWB
     C                   MOVE      TURUND        TRRUND
     C                   MOVE      TUTRMA        HETRM
     C     TUCON1        IFNE      *BLANKS
     C                   MOVE      1             HETRC
     C                   MOVEL     TUCON1        HETRCN
     C                   END
     C     HESG          IFEQ      'DUP'
     C                   MOVE      UDSSG         HESG
     C                   END
     C     HEPK1         ifeq      'P'
     c                   move      'J'           HEPK1
     C                   MOVE      HEAVD         YYAVD0            4 0
     C                   MOVE      HEOPD         YYOPD0            7 0
     C     DOKUF0K       CHAIN     DOKUF                              33
     c     *in33         ifeq      '0'
     c                   move      ' '           DFST
     C                   UPDATE    DOKUFR
     c                   end
     c                   end
     C                   UPDATE    HEADFR
      *
      * OPPDATER PÅ TURER
      *
     C     TURkey        CHAIN     TURER                              97
     C                   MOVE      HEOT          TUOPDT
     C                   ADD       HENT          TUTS
     C                   ADD       HEVKT         TUTVKT
     C                   ADD       HEM3          TUTM3
     C                   ADD       HELM          TUTLM
N39  C                   ADD       HELMLA        TUTLM2
N39  C                   ADD       HEPOEN        TUPOEN
     C                   ADD       1             TUAO
     C                   UPDATE    TURERR
      *
      * OPPDATER PÅ DISP
      *
     C     KKKHEA        CHAIN     DISP                               97
     C  N97              MOVE      ' '           DISTA1
     C  N97              MOVE      HEPRO         DITUR
     C  N97              MOVE      TURUND        DIRUND
     C  N97              MOVE      TUAVD         DITUAV
     C  N97              UPDATE    DISPR
      *
      * GÅR IGJENNOM EVT. REKVISISJONER PÅ DETTE OPPDRAG OG LEGGER INN
      * TURNUMMER (FOR EVT Å KUNNE INNGÅ I TRANSPORTØRAVREGNING )
      *
     C     HEOPD         IFNE      *ZEROS
     C                   MOVE      ' '           YYST
     C     KOSB9K        CHAIN     KOSBU9                             97
     C     *IN97         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC
     C     BUBILN        IFEQ      *BLANKS
     C                   MOVE      TUBILN        BUBILN
     C                   MOVE      TUBILK        BUBILK
     C                   MOVE      TUDT          BUFEDT
     C                   END
     C                   UPDATE    KOSBUR
     C     KOSB9K        READE     KOSBU9                                 97
     C  N97              END
      *
      * OPPDATER TUR OGSÅ PÅ EVT. DUMMY/DUPREKV. PÅ OPPDRAGET
      * EVT. DUMMYREKVISISJONER (DUP)PÅ DETTE OPPDRAG-LEGGER INN TURNR
      * (FOR Å FÅ "TOTALBILDE" VED SPØRRING PÅ REKV - STATUS "*")
      *
     C                   MOVE      'D'           YYST
     C     KOSB9K        CHAIN     KOSBU9                             97
     C     *IN97         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC
     C                   UPDATE    KOSBUR
     C     KOSB9K        READE     KOSBU9                                 97
     C  N97              END
     C                   END
      *
     C                   MOVE      '0'           *IN97
      *
     C     SLSETT        ENDSR
      *
      ***********************************************
     C     SETWS         BEGSR
      ***********************************************
      * oppdaterer aktuell subfil
      *
     c     toppli        ifne      'J'
     C                   MOVE      '  '          WSNR
     C     WXTUR         COMP      0                                  3535
     C     WXHAWB        COMP      *BLANKS                            3636
     C     *IN67         IFEQ      *OFF
     C     *IN68         ANDEQ     *OFF
     C                   UPDATE    SUBFIL
     C                   ELSE
     C                   UPDATE    SUBFI2
     C                   END
     C                   END
     c                   endsr
     C***********************************************
     C     SETTU2        BEGSR
     C***********************************************
      *
      * sette på tur ved å taste bilnummer
      * feilindikator 97 settes på
      *
     C     UN01OP        IFNE      '1'
     C                   OPEN      UNITL01
     C                   END
     C                   MOVEL     WXHAWB        YBILN            10
      *
      * FINNES TUR PÅ UNIT-FIL ?
      *
     C     YBILN         SETGT     UNITL01
     C     YBILN         READPE    UNITL01                                97
     C  N97              MOVE      UNSPRO        TUPRO
     C   97              DO
     C     TU02OP        IFNE      '1'
     C                   OPEN      TURER2
     C                   END
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          YÅÅ
     C                   ELSE
     C     UYEAR         ADD       2000          YÅÅ
     C                   END
     C                   MOVE      UMONTH        YMM               2 0
     C                   MOVE      UDAY          YDD               2 0
      *
      * FINNES TUR PÅ TUR-FIL MED AVGANGSDATO=IDAG ELLER SENERE DAG ?
      *
     C     TURE2K        SETLL     TURER2                             97
     C     STST21        TAG
     C     YBILN         READE     TURER2                                 97
     C  N97TUST          IFNE      ' '
     C                   GOTO      STST21
     C                   END
     C     *IN97         IFEQ      '1'
      *
      * FINNES TUR PÅ TUR-FIL MED AVGANGSDATO=000000 ?
      *
     C                   MOVE      *ZEROS        YDT
     C     TURE2K        SETLL     TURER2                             97
     C     STST22        TAG
     C     TURE2K        READE     TURER2                                 97
     C  N97TUST          IFNE      ' '
     C                   GOTO      STST22
     C                   END
     C                   END
     C                   END
      *
      * HVIS TUR FINNES, SETTE OPPDRAG PÅ TUR
      *
     C  N97              MOVE      TUPRO         WXTUR
     C  N97              EXSR      SETTUR
     C   97              MOVE      DITUR         WXTUR
     C   97              SETON                                        30
     C   97              MOVE      'YBC0097'     MSGNR
      *
     C                   ENDSR
     C***********************************************
     C     PLUTUR        BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'A '
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'B '
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'C '
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'D '
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     W2OPD         IFNE      0
     C     W2AVD         IFEQ      0
     C                   MOVE      WSAVDU        W2AVD
     C                   END
     C     L2T(TL)       CABEQ     0             UTPLU
      *
N17   * om minst ett kolli via CS - og ennå ikke summert - sjekk/summer NÅ..
N17  c     WRK2K         chain     CARGOF3                            33
N17  c     *in33         ifeq      *off
N17  c     WRK2K         chain     CARGOO                             33
N17  c     *in33         ifeq      *on
N17  C                   call      'CARGOSCR4'
N17  C                   PARM                    W2AVD
N17  C                   PARM                    W2OPD
N17  C                   PARM                    KOTERM
N17  c                   endif
N17  c                   endif
N17   *
     C     WRK2K         CHAIN(N)  HEADF                              30
     C  N30HEUR          COMP      'H'                                3030
     C     *IN30         IFEQ      '1'
     C                   MOVE      'SPO0001'     MSGNR
     C                   GOTO      UTPLU
     C                   END
      * BELØP for avregning ikke kvittert godkjent
     C     HXBLGK        COMP      *BLANKS                                84
     C     *in84         ifeq      *ON
     C     TROPD0        andne     *zeros
     C     TRFRAB        IFNE      *zeros
     C     HEPK1         ANDNE     ' '
     C     HEFBV         ANDNE     *zeros
     c                   else
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1358'     MSGNR
     C                   GOTO      UTPLU
     c                   end
     c                   end
     C     *IN84         IFEQ      *ON
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1205'     MSGNR
     C                   GOTO      UTPLU
     C                   END
      * UTLEV-FORBEHOLD - AKSEPTERES KUN NÅR VIA AGENT
     C     HEKF          IFNE      *BLANKS
     C     HEKFT1        ANDEQ     *BLANKS
     C     HEKNA         ANDEQ     *ZEROS
     C                   MOVE      *ON           *IN30
     C                   MOVE      'JOV1213'     MSGNR
     C                   GOTO      UTPLU
     C                   END
      * ikke på tur fra før
     C     DITUR         IFEQ      0
     C                   EXSR      SETTETUR
      * på tur fra før
     C                   ELSE
     C                   EXSR      BYTTETUR
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2OPD
     C                   MOVE      *BLANKS       W2SNDN
S27  C*                  MOVE      *BLANKS       W2SND2
     C                   END
     C                   GOTO      UTPLU
     C                   END
      *
      *   velg turnumer til gitt boks.
     C     w2tur         IFNE      *ZEROS
     C                   move      w2tur         Xpro
     C                   else
      * plukk fra liste   (WSAVD=avd fra siste søk / WSAVDU ="Aktiv avd")
      * prio 1 -  avd til tursøk/oppretting styres via oppgitt avd
     C     W2AVD         IFne      0
     C                   MOVE      W2AVD         XAVD
     C                   MOVE      *zeros        W2AVD
     C                   else
      * prio 2 - avd til tursøk/oppretting styres via SIST BRUKTE SØKEAVD
     C                   MOVE      WSAVD         XAVD              4 0
      * prio 3 - Hvis søkeavd er blank så benyttes aktiv avd
     C     XAVD          IFEQ      *ZEROS
     C                   MOVE      WSAVDU        XAVD
     C                   END
     C                   end
     c                   move      XAVD          WSAVDU
     C                   MOVE      *ZEROS        XOPD              7 0
     C                   MOVE      *ZEROS        XPRO              8 0
     C                   MOVE      *ZEROS        XRUND             8 0
     C                   MOVE      'P'           USPØR             1
     C                   CALL      'SYTR88'
     C                   PARM                    XPRO
     C                   PARM                    XRUND
     C                   PARM                    XAVD
     C                   PARM                    XOPD
     C                   PARM                    USPØR
     C                   PARM                    UFLAGG
     C                   End
     c     Xpro          ifne      *zeros
     C     XPRO          IFNE      L2T(TL)
     c     xpro          lookup    l2t                                    33
     C     *IN33         IFEQ      '1'
     C                   MOVE      'SHU0670'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   move      *blanks       w2nr
     c                   goto      utplu
     c                   end
     c                   end
     C     XPRO          CHAIN     TURER14                            33
     C     *IN33         IFEQ      '1'
     C     TUST          OREQ      'D'
     C                   MOVE      'JOV1174'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   goto      utplu
     c                   end
     C     TUST          IFNE      ' '
     C                   MOVE      'JOV1451'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   end
      * vellykket - plukk til boks summer/sett status..
     c                   exsr      fixboks
     c                   exsr      updboks
     C                   END
     c                   move      *blanks       w2nr
     C     utplu         ENDSR
     C***********************************************
     C     PLUTUR0       BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'A0'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'B0'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'C0'
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'D0'
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     c     L2t(TL)       IFNE      *ZEROS
     c                   move      zuser         bouser
     c                   move      zjob          bojob
     c                   move      tl            bon
     c     bokske        chain     boksf                              33
     c     *in33         IFEQ      '0'
      * Blank status på turen (=ÅPNE for andre)
     c     botur         chain     turer14                            33
     c  N33turkey        chain     turer                              33
     c  N33              move      ' '           tust
     c  N33              update    turerr
      * Blank innhold i Boks-recorden
     c                   move      *zeros        botime
     c                   move      *zeros        bodate
     c                   move      *zeros        botur
     c                   move      ' '           bostat
     c                   update    boksr
      * Blank innhold i skjermboksen
     C                   MOVE      *blanks       L20(TL)
     C                   MOVE      *zeros        L2T(TL)
     C                   MOVE      *blanks       L2B(TL)
     C                   MOVE      *zeros        L2V(TL)
N27  C                   MOVE      *zeros        L2M(TL)
     C                   MOVE      *zeros        L2A(TL)
     C                   MOVE      *BLANKS       L22(TL)
     c                   end
     C                   END
     c                   move      *blanks       w2nr
     C                   ENDSR
      *
     C***********************************************
     C     PLUTUR2       BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'A2'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'B2'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'C2'
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'D2'
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     L2t(tl)       IFNE      *ZEROS
     c                   move      l2t(tl)       xpro
     C     XPRO          CHAIN     TURER14                            33
     C     *in33         IFEQ      '0'
     c                   move      'F'           USPØR
     c                   move      tuavd         zavd              4 0
     c                   move      *zeros        zavd0             4 0
     c                   move      *zeros        zopd
     c                   move      *zeros        zrund
     c                   move      0             uflagg
     C                   CALL      'SYTR88A'
     C                   PARM                    UDSFIR
     C                   PARM                    zavd
     C                   PARM                    xpro
     C                   PARM                    zrund
     C                   PARM                    zopd
     C                   PARM                    zavd0
     C                   PARM                    USPØR
     C                   PARM                    UFLAGG
     c                   move      *blanks       w2nr
     C     XPRO          CHAIN     TURER14                            33
     C     Tutvkt        IFNE      L2v(tl)
     C     Tuao          orne      L2a(tl)
N27  C     TutM3         orne      L2v(tl)
     c                   move      'J'           refresh
     C                   exsr      sumtur
     C                   end
     C                   end
     C                   else
      * feilmeld hvis tur i boks ikke finnes....
     C                   end
      *
     c                   move      *blanks       w2nr
     C                   ENDSR
      *
     C***********************************************
     C     SAMTUR        BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'AS'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'BS'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'CS'
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'DS'
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     L2t(tl)       IFNE      *ZEROS
     c                   move      l2t(tl)       xpro
     C     XPRO          CHAIN     TURER14                            33
     C     *in33         IFEQ      '0'
     C                   move      tupro         xapro             8
     C                   move      ' '           XATYPE            1
     C                   CALL      'SYTR88S'
     C                   PARM                    XAPRO
     C                   PARM                    XATYPE
     C                   else
      * feilmeld hvis tur i boks ikke finnes....
     C                   end
      * feilmeld hvis boks er tom
     C                   end
      *
     c                   move      *blanks       w2nr
     C                   ENDSR
      *
     C***********************************************
     C     LASTELI       BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'AL'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'BL'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'CL'
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'DL'
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     L2t(tl)       IFNE      *ZEROS
     c                   move      l2t(tl)       xpro
     C     XPRO          CHAIN     TURER14                            33
     C     *in33         IFEQ      '0'
     C                   move      tupro         xapro             8
     C                   CALL      'SYFA55LCL'
     C                   PARM                    XAPRO
     C                   else
      * feilmeld hvis tur i boks ikke finnes....
     C                   end
      * feilmeld hvis boks er tom
     C                   end
      *
     c                   move      *blanks       w2nr
     C                   ENDSR
     C***********************************************
     C     GODSLI        BEGSR
     C***********************************************
     c                   move      'N'           refresh
     C     w2nr          IFeq      'AG'
     C     w2nr          OReq      'AN'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     w2nr          IFeq      'BG'
     C     w2nr          OReq      'BN'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     w2nr          IFeq      'CG'
     C     w2nr          OReq      'CN'
     C                   Z-ADD     3             TL
     C                   ELSE
     C     w2nr          IFeq      'DG'
     C     w2nr          OReq      'DN'
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C     L2t(tl)       IFNE      *ZEROS
     c                   move      l2t(tl)       xpro
     C     XPRO          CHAIN     TURER14                            33
     C     *in33         IFEQ      '0'
     C* "Nattport" sett flagg i turrecord - ikke sjekk skyting..
     C     W2nr          IFEQ      'AN'
     C     W2nr          oreq      'BN'
     C     W2nr          oreq      'CN'
     C     W2nr          oreq      'DN'
     c     turkey        chain     turer                              33
     c  N33              move      '1'           tutst3
     c  N33              update    turerr
     C                   else
     c                   exsr      TstTurSts
     c     *IN30         CABEQ     '1'           UtGodsli
N16  c                   call      'SYTR33CS'
N16  c                   parm                    XPRO
N16  c                   parm                    XOK               1
N16  c     Xok           ifeq      'N'
N16  C                   MOVE      'JOV1415'     MSGNR
N16  C                   MOVE      '1'           *IN30
N16  c                   goto      UtGodsli
N16  C                   end
     C                   end
     C* Null ut boksen i skjermbildet
     C                   MOVE      '0'           w2nr
     C                   exsr      PLUTUR0
     C* Print godsliste (Setter automatisk status A)
     C                   move      tupro         xapro
     C                   CALL      'SYFA55ICL'
     C                   PARM                    XAPRO
     C                   else
      * feilmeld hvis tur i boks ikke finnes....
     C                   end
      * feilmeld hvis boks er tom
     C                   end
      *
     c     utgodsli      tag
     c                   move      *blanks       w2nr
     C                   ENDSR
     C***********************************************
     C     fixboks       BEGSR
     C***********************************************
     C     XPRO          CHAIN     TURER14                            33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     XPRO          L20(TL)
     C                   MOVEL     TUBILN        XBILN8            8
     C                   MOVE      XBILN8        L20(TL)
     C                   MOVE      XPRO          L2T(TL)
     C                   MOVE      TUBILN        L2B(TL)
     C                   EXSR      SUMTUR
     C                   END
     C                   ENDSR
     C***********************************************
     C     updboks       BEGSR
     C***********************************************
     c                   move      zjob          bojob
     c                   move      zuser         bouser
     c                   move      tl            bon
     c     bokske        chain     boksf                              33
     C                   TIME                    timedate
     c                   MOVE      BOÅÅ          BOÅÅF
     c                   MOVE      BOMM          BOMMF
     c                   MOVE      BODD          BODDF
     c                   move      'P'           bostat
     c     *in(33)       ifeq      '1'
     c                   move      xpro          botur
     c                   write     boksr
     c                   else
      *
      * byttet tur i boks frigjør gammel tur
      *
     c     botur         ifne      xpro
     c     botur         andne     *zeros
     c     botur         chain     turer14                            33
     c  N33turkey        chain     turer                              33
     c  N33              move      ' '           tust
     c  N33              update    turerr
     c                   end
      *
      * protekt ny tur i boks
      *
     c     xpro          chain     turer14                            33
     c  N33turkey        chain     turer                              33
     c  N33              move      'P'           tust
     c  N33              update    turerr
     c                   move      xpro          botur
     c                   move      zuser         bouser
     c                   update    boksr
     c                   end
     c                   endsr
      *
     C***********************************************
     C     updboks2      BEGSR
     C***********************************************
      * vis evt skytestatus i linje 22
     C     1             DO        4             TL
     C                   MOVE      *BLANKS       L22(TL)
     C     L2T(TL)       IFNE      *ZEROS
     C                   MOVE      L2T(TL)       XPRO
     C     STSTKEY       CHAIN     STSTUR                             33
     C     *IN33         IFEQ      '0'
     C                   select
     c     STSTAT        WHENEQ    'X'
     C                   MOVEL     StsOK         L22(TL)
     c     STSTAT        WHENEQ    ' '
     C                   MOVEL     StsOpen       L22(TL)
     C                   exsr      fixboks
     c     STSTAT        WHENEQ    'M'
     C                   MOVEL     StsMank       L22(TL)
     c     STSTAT        WHENEQ    'G'
     C                   MOVEL     Stsgodk       L22(TL)
     C                   ENDSL
     C                   END
     C                   END
     C                   END
     C                   ENDSR
     C***********************************************
     C     boksend       BEGSR
     C***********************************************
      *
      * frigjør turer ved avluting av program
      *
     c     1             do        4             tl
     c     l2t(tl)       ifne      0
     c     l2t(tl)       chain     turer14                            33
     c  n33turkey        chain     turer                              33
     c  N33              move      ' '           tust
     c  N33              update    turerr
     c     l2t(tl)       chain     turer14                            33
     c                   move      tl            bon
     c     bokske        chain     boksf                              33
     c  n33              move      ' '           bostat
     c  n33              update    boksr
     c                   end
     c                   end
     c                   endsr
      *
     C***********************************************
     C     TstTurSts     BEGSR
     C***********************************************
      * vis evt skytestatus i linje 22
     c                   MOVE      *OFF          *IN30
     C     STSTKEY       CHAIN     STSTUR                             33
     C     *IN33         IFEQ      '0'
     C                   select
     c     STSTAT        WHENEQ    'X'
     C                   MOVEL     StsOK         L22(TL)
     c     STSTAT        WHENEQ    ' '
     C                   MOVEL     StsOpen       L22(TL)
     C                   MOVE      'JOV1281'     MSGNR
     c                   MOVE      *ON           *IN30
     c     STSTAT        WHENEQ    'M'
     C                   MOVEL     StsMank       L22(TL)
     C                   MOVE      'JOV1282'     MSGNR
     c                   MOVE      *ON           *IN30
     c     STSTAT        WHENEQ    'G'
     C                   MOVEL     Stsgodk       L22(TL)
     C                   ENDSL
     C                   END
     C                   ENDSR
     C***********************************************
     C     Setvartl      BEGSR
     C***********************************************
     C     wsnr          IFeq      'A'
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     wsnr          IFeq      'B'
     C                   Z-ADD     2             TL
     C                   ELSE
     C     wsnr          IFLE      'C'
     C                   Z-ADD     3             TL
     C                   ELSE
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   ENDSR
     C***********************************************
     C     SUMTUR        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        TURVKT            7 0
     C                   MOVE      *ZEROS        TURANT            3 0
N27  C                   MOVE      *ZEROS        TURM3             6 3
     C                   SETOFF                                       33
     C     XPRO          SETLL     HEAD11
     C     *IN33         DOWEQ     '0'
     C     XPRO          READE     HEAD11                                 33
     C     *IN33         IFEQ      '0'
     C                   ADD       HEVKT         TURVKT
     C                   ADD       1             TURANT
N27  C                   ADD(H)    HEM3          TURM3
     C                   END
     C                   END
     C                   Z-ADD     TURVKT        L2V(TL)
     C                   Z-ADD     TURANT        L2A(TL)
N27  C                   Z-ADD     TURM3         L2M(TL)
     C                   ENDSR
      *
     C***********************************************
     C     SETTETUR      BEGSR
     C***********************************************
     C     W2NR          IFEQ      *BLANKS
     c                   exsr      setvartl
     C                   END
     C                   move      L2T(TL)       xpro
      * Kan ikke sette på en tur der skyting er avsluttet
     C                   MOVE      '*TUR'        BSTS              4
     C                   EXSR      TSTBSTS
     C     BSTS          IFEQ      '*TUR'
     C                   MOVE      'JOV1284'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTSette
     C                   END
     c     xpro          chain     turer14                            33
     c     *in(33)       ifeq      '0'
     C  N33              MOVE      TUPRO         WXTUR
     C  N33              EXSR      SETTUR
     C     *in30         cabeq     '1'           Utsette
     C                   ADD       HEVKT         L2V(TL)
     C                   ADD       1             L2A(TL)
N27  C                   ADD       HEM3          L2M(TL)
     c                   end
      *
     c     utsette       endsr
     C***********************************************
     C     byttetur      BEGSR
     C***********************************************
      * tester om turfra er i en av boksene
      *
     c     ditur         ifne      L2T(1)
     c     ditur         andne     L2T(2)
     c     ditur         andne     L2T(3)
     c     ditur         andne     L2T(4)
     C                   MOVE      'SHU0679'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   else
      *
      * tester om tilboksen inneholder en tur
      *
     C     W2NR          IFEQ      *BLANKS
     c                   exsr      setvartl
     C                   END
     c     l2T(tl)       ifeq      0
     C                   MOVE      'SHU0678'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   else
      *
      * sette på samme tur er unødvendig
      *
     c     ditur         ifeq      l2t(tl)
     C                   MOVE      'SHU0719'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   else
     c                   exsr      taavtur
     C     W2NR          IFEQ      *BLANKS
     c                   exsr      setvartl
     C                   END
     C                   move      L2T(TL)       xpro
     c     xpro          chain     turer14                            33
     c     *in(33)       ifeq      '0'
     C                   MOVE      TUPRO         WXTUR
     C                   EXSR      SETTUR
     C     *in30         cabeq     '1'           UtBytte
     C                   ADD       HEVKT         L2V(TL)
     C                   ADD       1             L2A(TL)
N27  C                   ADD       HEM3          L2M(TL)
     c                   end
     c                   end
     c                   end
     c                   end
      *
     c     UtBytte       endsr
      *
     C***********************************************
     C     TstPrOpd      BEGSR
     C***********************************************
      * kall med TUKNT2 ulik 0 - fra SETT PÅ TUR - LÅS.
      *    Hvis TIL en tur MED  transp av type  4/5 - sett  lag SNDBEL
      *    Hvis TIL en tur UTEN transp av type  4/5 - FJERN lag SNDBEL
      * kall med TUKNT2  lik 0 - fra FJERN FRA TUR (NY skapes så hvis DFTtran 4/5)
     C                   move      *zeros        Sbel             13 2
     C                   move      *zeros        VMINCR
     C                   MOVE      'N'           UMID              1            Låst (A)
     c     TUKNT2        ifeq      *zeros
     C                   MOVE      'S'           UMID              1            Slett
     C                   move      *zeros        TUPRO
     C     HEAVD         CHAIN     KODTAG                             33
     C  n33              Move      AGDFTR        TUKNT2
     c                   end
     C     TRAKEY        CHAIN     TRAN                               33
      * PÅ TUR UTEN 4/5 = SLETT
     c     VMINCR        ifne      4
     c     VMINCR        andne     5
     c                   MOVE      'S'           UMID              1            Slett
     c                   end
      *
     C                   call      'SYTR12AS'
     C                   parm                    HEAVD
     C                   parm                    HEOPD
     C                   PARM                    TUPRO
     C                   PARM                    VMTRAN
     C                   PARM                    VMTRKU
     C                   PARM                    VMTRLE
     C                   PARM                    VMINCR
     C                   PARM                    UMID                           MIDLERTIDIG
     C                   PARM                    SBEL                           retur beløp
     C                   PARM                    UBNR              7 0          Når EN er skapt
     C*
     C     VMINCR        IFEQ      4
     C     VMINCR        OREQ      5
     C     Sbel          IFEQ      0
     C     UMID          andeq     'N'                                          N=Endelig/lås
     C                   MOVE      'JOV1413'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
     c                   endsr
      *
     C***********************************************
     C     taavtur       BEGSR
     C***********************************************
      * tar oppdrag av en av turene i boksene
      *
     C     l2t(1)        ifeq      ditur
     C                   Z-ADD     1             TL                1 0
     C                   ELSE
     C     l2t(2)        ifeq      ditur
     C                   Z-ADD     2             TL
     C                   ELSE
     C     l2t(3)        ifeq      ditur
     C                   Z-ADD     3             TL
     C                   ELSE
     C                   Z-ADD     4             TL
     C                   END
     C                   END
     C                   END
     C                   move      L2T(TL)       xpro
      * Oppdraget er skutt på bil. kan ikke fjernes fra tur
     C                   MOVE      '    '        BSTS              4
     C                   EXSR      TSTBSTS
     C     BSTS          IFNE      *BLANKS
     C     BSTS          IFEQ      '*TUR'
     C                   MOVE      'JOV1284'     MSGNR
     C                   ELSE
     C                   MOVE      'JOV1279'     MSGNR
     C                   END
     C                   MOVE      '1'           *IN30
     C                   GOTO      UTSLET
     C                   END
     c     xpro          chain     turer14                            33
     c     *in(33)       ifeq      '0'
     C                   MOVE      *zeros        WXTUR
     C                   sub       HEVKT         L2V(TL)
     C                   sub       1             L2A(TL)
N27  C                   sub       HEM3          L2M(TL)
      *
     C     kkkhea        chain     headf                              33
     c     *in33         ifeq      '0'
     C                   Z-ADD     0             HEPRO
     C                   move      *blanks       HEPOS1                         fjern evt gammel
     C                   move      *zeros        HEPOS2                         fjern evt gammel
     C                   MOVE      *ZEROS        TRRUND
     C                   MOVE      *BLANKS       HEHAWB
N12  C                   MOVE      *zeros        HEKNT
     C                   MOVE      *ZEROS        HETRM
     C                   MOVE      0             HETRC
     C                   MOVE      *BLANKS       HETRCN
     C     HEPK1         ifeq      'P'
     c                   move      'J'           HEPK1
     C                   MOVE      HEAVD         YYAVD0            4 0
     C                   MOVE      HEOPD         YYOPD0            7 0
     C     DOKUF0K       CHAIN     DOKUF                              33
     c     *in33         ifeq      '0'
     c                   move      ' '           DFST
     C                   UPDATE    DOKUFR
     c                   end
     c                   end
     C                   UPDATE    HEADFR
     C     kkkhea        CHAIN     DISP                               33
     c     *in33         ifeq      '0'
     C                   move      *ZEROS        DITUR
     C                   move      *ZEROS        DIRUND
     C                   move      *ZEROS        DITUAV
     C                   move      ' '           DISTA1
     C                   update    dispr
     c                   end
      *
      * OPPDATER PÅ TURER
     C     TURkey        CHAIN     TURER                              97
     C                   sub       HENT          TUTS
     C                   sub       HEVKT         TUTVKT
     C                   sub       HEM3          TUTM3
     C                   sub       HELM          TUTLM
N39  C                   sub       HELMLA        TUTLM2
N39  C                   sub       HEPOEN        TUPOEN
     C                   sub       1             TUAO
     C  N97              UPDATE    TURERR
      *
     C     HEOPD         IFNE      *ZEROS
      * GÅR IGJENNOM EVT. REKVISISJONER PÅ DETTE OPPDRAG OG fjerner
      * TURNUMMER (FOR EVT Å KUNNE INNGÅ I TRANSPORTØRAVREGNING )
     C                   MOVE      ' '           YYST
     C     KOSB9K        CHAIN     KOSBU9                             33
     C     *IN33         DOWNE     '1'
     C                   MOVE      *zeros        BUTAVD
     C                   MOVE      *zeros        BUTUNR
N13   * dersom det er hovedtransp's avr-beløp (på oppdragsnivå)(tye 4/5) skal det SLETTES!!
N13  c     BUTX_7        Ifeq      '* OPD *'
N13  C                   delete    KOSBUR
N13  c                   else
N13   * andre åpne forventede kostnader blir liggende
     C                   UPDATE    KOSBUR
N13  c                   endif
     C     KOSB9K        READE     KOSBU9                                 33
     C  N33              END
      *
      * OPPDATER OGSÅ PÅ EVT. DUMMY/DUPREKV.
     C                   MOVE      'D'           YYST
     C     KOSB9K        CHAIN     KOSBU9                             33
     C     *IN33         DOWNE     '1'
     C                   MOVE      *zeros        BUTAVD
     C                   MOVE      *zeros        BUTUNR
     C                   UPDATE    KOSBUR
S13  C*!!  KOSB9K        READE     KOSBU9
     C     KOSB9K        READE     KOSBU9                                 33
     C  N33              END
     C                   END
      *
      * Fjern / reberegn evt post for pris per oppdrag
     C                   move      *zeros        TUKNT2
     C                   exsr      TstPrOpd
     C                   move      *off          *in30
      *
      * fjern post i saml-fakt-kø
     C     KKKHEA        CHAIN     SAML1                              33
     C  N33              DELETE    SAMLR
      *
     c                   end
     c                   end
     C*
     C     utslet        ENDSR
     C***********************************************
     C     vistur        BEGSR
     C***********************************************
     c                   move      wsavdu        wsavdq            4 0
     C                   MOVE      *IN66         XIN66             1
     C                   MOVE      *IN61         XIN61             1
N46  C                   MOVE      WSTT          XTT               1
     c                   clear                   bilde02
     C                   MOVE      XIN66         *IN66
     C                   MOVE      XIN61         *IN61
     c                   move      wsavdq        wsavdu            4 0
N46  C                   MOVE      XTT           WSTT
     c     w2nr          ifeq      'AT'
     C                   MOVE      L2T(1)        wspro
     c                   else
     c     w2nr          ifeq      'BT'
     C                   MOVE      L2T(2)        wspro
     c                   else
     c     w2nr          ifeq      'CT'
     C                   MOVE      L2T(3)        wspro
     c                   else
     C                   MOVE      L2T(4)        wspro
     c                   end
     c                   end
     c                   end
     c     wspro         ifeq      *zeros
     C                   MOVE      'SHU0678'     MSGNR
     C                   MOVE      '1'           *IN30
     c                   end
      *
      *
     c                   endsr
      ***********************************************
     C     INTEDI        BEGSR
      ***********************************************
      * TRACK&TRACE ER BETALBART PRODUKT - HAR DE LISSENS??
     C     IEDIOK        IFNE      'J'
     C                   MOVEL     'SNDINTED'    UMODUL           15
     C                   MOVE      'I      '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   GOTO      UTIEDI
     C                   END
     C                   MOVE      'J'           IEDIOK            1
     C                   END
      *
     C                   MOVE      HEAVD         IEAVD             4
     C                   MOVE      HEOPD         IEOPD             7
     C                   CALL      'IE011C'
     C                   PARM                    IEAVD
     C                   PARM                    IEOPD
      *
     C     UTIEDI        ENDSR
N64   ***********************************************
N64  C     HovDupArr     BEGSR
N64   ***********************************************
N64  C     HEAKY0        KLIST
N64  C                   KFLD                    TRAVD0
N64  C                   KFLD                    TROPD0
N64  C     DsHeaKey      KLIST
N64  C                   KFLD                    DsAVD
N64  C                   KFLD                    DsOPD
N64   * Finn ut om oppdraget er en del av en "DUP-struktur" - legg alle i ARRAY
N64  C* Hent opp ingangsoppdraget
N64  C     KKKHEA        CHAIN(N)  HEADF                              33
N64   * FINN TOPP-NIVÅET
N64  C     TROPD0        DOWNE     0
N64  C     HEAKY0        CHAIN(N)  HEADF                              33
N64  C                   ENDDO
N64  C* Legg inn topp-oppdraget som start i array
N64  c                   clear                   DUP
N64  c                   z-add     1             Nr                3 0
N64  c                   movel     heavd         Dup(Nr)
N64  c                   move      heopd         Dup(Nr)
N64  c     1             do        100           Cur               3 0
N64  c     Dup(Cur)      cabeq     *zeros        UtAdd
N64  c                   move      Dup(Cur)      AvdOpd
N64  C     DSHeaKey      CHAIN     HEADF                              33
N64  C  N33TrOpd1        IFNE      *ZEROS
N64  C                   add       1             Nr
N64  c                   movel     TrAvd1        Dup(Nr)
N64  c                   move      TrOpd1        Dup(Nr)
N64  C                   ENDIF
N64  C  N33TrOpd2        IFNE      *ZEROS
N64  C                   add       1             Nr
N64  c                   movel     TrAvd2        Dup(Nr)
N64  c                   move      TrOpd2        Dup(Nr)
N64  C                   ENDIF
N64  c                   enddo
N64  C     UtAdd         tag
N64  C                   ENDSR
N10   ***********************************************
N10  C     PrtMlapp      BEGSR
N10   ***********************************************
S33   *
S33   * ETT og bare ett fraktbrev MÅ finnes
S33  c*                  z-add     heavd         YYavd0
S33  c*                  z-add     heopd         YYopd0
S33  c*    DOKUF0K       chain(N)  DOKUF                              30
S33  c*    *in30         cabeq     '1'           UtPrtMl
S33  c*    DOKUF0K       reade(N)  DOKUF                                  33
S33  c*    *in33         ifeq      *off
S33  c*                  move      *on           *in30
S33  c*                  goto      UtPrtMl
S33  c*                  else
S33  C*                  CALL      'A13LABR'
S33  C*                  PARM      '*GR       '  XXUSER           10
S33  C*                  PARM                    DFAVD
S33  C*                  PARM                    DFOPD
S33  C*                  PARM                    DFFBNR
S33  C*                  PARM                    XXANKK            4 0
S33  c*                  endif
S33   *
S33  c*    UtPrtMl       tag
S33  c*    *in30         ifeq      *on
S33  c*                  move      'JOV1535'     MSGNR
S33  c*                  endif
N35  C     KKKHEA        CHAIN(N)  HEADF                              33
N33  C                   move      HEAVD         HEAVDA            4
N33  C                   move      HEOPD         HEOPDA            7
N36   * Hent printerstyring fra HO-avdeling
N36  C                   CALL      'GETPR3'
N36  C                   PARM                    HEAVDA
N36  C                   PARM      067           zzNR67            3 0
N36  C                   PARM                    zzPRT67          10
N36  C                   PARM                    zzPT67           10
N36  C                   PARM                    zzLAS             2 0
N36  C                   PARM      00            zzLPI             2 0
N38  c                   if        PersLabPrt <> *blanks
N38  c                   movel     PersLabPrt    zzPRT67
N38  c                   endif
N35  C                   IF        TROPD2 <> 0
N35  C                   move      TRAVD2        HEAVDA            4
N35  C                   move      TROPD2        HEOPDA            7
N35  C                   ENDIF
N64  c                   exfmt     BEKMLAP
N64  c                   if        *in12 = *off
N33  C                   CALL      'SYFA12CLL'
N33  C                   PARM                    HEAVDA
N33  C                   PARM                    HEOPDA
N33  C                   PARM      '000'         zzFbn             3
N33  C                   PARM      '00000000'    zzTur             8
N33  C                   PARM                    zzPRT67          10
N33  C                   PARM                    zzPT67           10
N33  C                   PARM      'J'           zzOrig            1
N65  C                   PARM                    zzclid           35
N64  c                   endif
N10  C                   ENDSR
      *
N26   *
N26  C***********************************************
N26  C     TTSRDEL       BEGSR
N26  C***********************************************
N26  C                   clear                   TRACKFR
N26   * OPPDRAG OPPRETTET (POST I FIL TRACKF)
N26  C                   MOVE      HEAVD         TTAVD
N26  C                   MOVE      HEOPD         TTOPD
N26  C                   TIME                    XULTID
N26  C                   MOVE      XULDD         ULDD
N26  C                   MOVE      XULMM         ULMM
N26  C                   MOVE      XULÅÅ         ULÅÅ
N26  C                   MOVE      'DEL'         TTACTI
N26  C                   MOVE      ULDT          TTDATE
N26  C                   MOVE      XULTM         TTTIME
N26  C                   MOVE      TTDATE        TTDATL
N26  C                   MOVE      TTTIME        TTTIML
N26  C                   MOVE      ZUSER         TTUSER
N26  c                   eval      TTTEXT='Deleted, ' + WSDREA
N26  c                   eval      TTTEXL='Slettet, ' + WSDREA
N26  C                   WRITE     TRACKFR
N26   *
N26  C                   ENDSR
n43   ***********************************************
n43  C     DSPEPO        BEGSR
n43   ***********************************************
n43  C                   MOVE      HEOPD         UOPD              7 0
n43  C                   MOVE      HEAVD         UAVD              4 0
s63  C*                  CALL      'ARC012'
n63  C                   CALL      'ARC012CLD'
n43  c                   PARM                    uavd
n43  C                   PARM                    uopd
n43   *
n43  C                   ENDSR
      *
      *
     OHEADFR    E            DUMMY
