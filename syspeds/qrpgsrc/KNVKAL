      * Konvertere kalender hentet fra "webkalenderen.no" --> til fil KALENDER
      * Forutsetning - printvenlig versjon http://webkalenderen.no/print.php?aar=2010
      * Fil/lagre som .txt - cfrpcf /xx/xxxx.txt -> QTEMP/KALIMP
      * sjekk at layout ikke er endret.
      *
      *
      *   *...+....1....+....2....+....3....+
      *   kalender_$aar
      *
      *               Oversiktskalender 2010
      *                     Januar 2010
      *   Uke Ma Ti On To Fr Lø Sø
      *   53               1  2  3
      *    1   4  5  6  7  8  9 10
      *    2  11 12 13 14 15 16 17
      *    3  18 19 20 21 22 23 24
      *    4  25 26 27 28 29 30 31
      *
      *    7 15 23 30
      *                     Februar 2010
      *   Uke Ma Ti On To Fr Lø Sø
      *    5   1  2  3  4  5  6  7
      *    6   8  9 10 11 12 13 14
      *    7  15 16 17 18 19 20 21
      *    8  22 23 24 25 26 27 28
      *------ i bunnen av hver år kommer helligdager OG merkedager listet opp ---
      *   *...+....1....+....2....+....3....+
      *    1. jan Nyttårsdag
      *   21. jan Ingrid Alexandra, 6 år
      *    6. feb Samenes dag
      *   14. feb St. Valentines dag
      *   14. feb Fastelavn
      *   14. feb Morsdag
      *   21. feb Kong Harald, 73 år
      *   28. mar Sommertid start
      *   28. mar Palmesøndag
      *    1. apr Skjærtorsdag
      *    2. apr Langfredag
      *
     FKALINP    IP   F  100        DISK
     FKALENDER  UF A E           K DISK
     D                 DS
     D  DSDATA                 1    100
     D    Tst1_3               1      3
     D    Tst3                 3      3
     D    Tst4                 4      4
     D    Tst19_24            19     24
     D    DSÅR                26     29
     D    DSUke                1      2
     D    DSDgHell             1      2
     D    DSMnHell             5      7
     D    DSMerk10             9     18
     D    DSMerknad            9     38
     D    DSma                 5      6
     D    DSti                 8      9
     D    DSon                11     12
     D    DSto                14     15
     D    DSfr                17     18
     D    DSlØ                20     21
     D    DSsØ                23     24
     D                 DS
     D  N2                     1      2
     D    N2a                  1      1
     D    N2b                  2      2
     D                 DS
     D  KADATE                 1      8  0
     D    KAÅR                 1      4  0
     D    KAMN                 5      6  0
     D    KADG                 7      8  0
     IKALINP    NS
     I                                  1  100  DATA
     C*
     C                   MOVE      DATA          DSDATA
      * Plukk opp årstall basert på tekst Januar 2010  i kolonne 19...
     c     Tst19_24      ifeq      'Januar'
     c                   clear                   KALENDERR
     c                   move      DSÅR          KAÅR
     c                   goto      Next
     c                   end
      * 'Uke'-linja markerer starten på en måned
     c     Tst1_3        Ifeq      'Uke'
     c                   add       1             KAMN
     c                   move      'Y'           Started           1
     c                   goto      Next
     c                   end
      * Blank-linje markerer slutten på en måned (eller tegn i pos 4=månefase uten blanlinje!!)
     c     Tst1_3        Ifeq      '   '
     c     Tst4          orne      ' '
     c                   move      'N'           Started
     c                   goto      Next
     c                   end
      *
     c     Started       Ifeq      'Y'
     c     Tst1_3        andne     '   '
     c                   exsr      EnUke
     c                   end
      * Helligdag ?
     c     Tst3          ifeq      '.'
     c                   exsr      Hellig
     c                   end
     c
      *
     C     Next          tag
      *
      *
      ****************************************
     c     EnUke         begsr
      ****************************************
      *
      *
     c                   move      DSUke         KAUKE
      *
     c     DSma          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSma          KADG
     c                   movel     'Ma'          KAUDG
     c                   eval      KAHELL = ' '
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSti          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSti          KADG
     c                   movel     'Ti'          KAUDG
     c                   eval      KAHELL = ' '
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSon          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSon          KADG
     c                   movel     'On'          KAUDG
     c                   eval      KAHELL = ' '
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSto          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSto          KADG
     c                   movel     'To'          KAUDG
     c                   eval      KAHELL = ' '
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSfr          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSfr          KADG
     c                   movel     'Fr'          KAUDG
     c                   eval      KAHELL = ' '
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSLØ          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSLØ          KADG
     c                   movel     'Lø'          KAUDG
     c                   eval      KAHELL = 'F'
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c     DSSØ          ifne      *blanks
     c                   add       1             KADGNR
     c                   move      DSSØ          KADG
     c                   movel     'Sø'          KAUDG
     c                   eval      KAHELL = 'X'
     c                   move      KAÅR          KAYEAR
     c                   move      KAMN          KAMONT
     c                   move      KADG          KADAY
     C                   WRITE     KALENDERR
     c                   end
     c                   endsr
      ****************************************
     c     Hellig        begsr
      ****************************************
      * Kun helligdager (+ jul/nyttårsaften) merkes som hellig
     c     DSmerk10      ifeq      'Nyttårsdag'
     c     DSmerk10      oreq      'Skjærtorsd'
     c     DSmerk10      oreq      'Langfredag'
     c     DSmerk10      oreq      '1. påskeda'
     c     DSmerk10      oreq      '2. påskeda'
     c     DSmerk10      oreq      'Off. høgti'
     c     DSmerk10      oreq      'Kr. Himmel'
     c     DSmerk10      oreq      'Grunnlovsd'
     c     DSmerk10      oreq      '1. pinseda'
     c     DSmerk10      oreq      '2. pinseda'
     c     DSmerk10      oreq      'Julaften  '
     c     DSmerk10      oreq      '1. juledag'
     c     DSmerk10      oreq      '2. juledag'
     c     DSmerk10      oreq      'Nyttårsaft'
     c                   move      DSDgHell      KADG
     c                   select
     c     DSMnHell      wheneq    'jan'
     c                   move      01            KAMN
     c     DSMnHell      wheneq    'feb'
     c                   move      02            KAMN
     c     DSMnHell      wheneq    'mar'
     c                   move      03            KAMN
     c     DSMnHell      wheneq    'apr'
     c                   move      04            KAMN
     c     DSMnHell      wheneq    'mai'
     c                   move      05            KAMN
     c     DSMnHell      wheneq    'jun'
     c                   move      06            KAMN
     c     DSMnHell      wheneq    'jul'
     c                   move      07            KAMN
     c     DSMnHell      wheneq    'aug'
     c                   move      08            KAMN
     c     DSMnHell      wheneq    'sep'
     c                   move      09            KAMN
     c     DSMnHell      wheneq    'okt'
     c                   move      10            KAMN
     c     DSMnHell      wheneq    'nov'
     c                   move      11            KAMN
     c     DSMnHell      wheneq    'des'
     c                   move      12            KAMN
     c                   endsl
     c     KADATE        chain     KALENDER                           33
     c     *in33         ifeq      *off
     c                   eval      KAHELL = 'X'
     c                   eval      KAMERKN = DSmerknad
     c                   update    KALENDERR
     c                   end
      *
     c                   endif
      *
     c                   endsr
