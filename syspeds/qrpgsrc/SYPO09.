      * OBS - for kompilering
      *       OVRDBF AVFRHCOP  AVFRH
      *       OVRDBF AVFRDL01C AVFRD
      *
      ***********************************************************
      *** PROGRAM FOR VEDLIKEHOLD AVTALER FRAKT               ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 07 09 11 13-24                ***
      *** LEDIGE INDIKATORER    29 32 35-39 41-64 95-96       ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 02 SH  PTF10 FEILMELDING DERSOM......
10XXX * 03 SH  PTF10 kopier fra avvikende database
10XXX * 04 SH  PTF10 kall med parameter 8 betyr leverandørpriser ind 55
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 05 JOV PTF11 ny param i kall på syfa09
10XXX * 06 SH  PTF11 endret call på oversyring cl sypo09cop
10XXX * 07 SH  PTF11 far til sted fylles automatisk
10XXX * 08 JOV PTF11 kan også kopiere på tvers av kunde/leverandør-avtaler
********************************************************************
      *
      *
N03  FAVFRHCOP  IF   E           K DISK
N03  F                                     RENAME(AVFRHR:AVFRHRC)
N03  F                                     USROPN
N03  FAVFRDL01C IF   E           K DISK
N03  F                                     RENAME(AVFRDR:AVFRDRC)
N03  F                                     USROPN
     FKODTA     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FKUFAST    IF   E           K DISK
     F                                     RENAME(KOFASTR:KUFASTR)
     FSONESL02  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FAVFRH     UF A E           K DISK
     FAVFRHL01  UF   E           K DISK
     F                                     RENAME(AVFRHR:AVFRHRL)
     FAVFRDL01  UF A E           K DISK
     FAVFRT     UF A E           K DISK
     FSYPO09FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     F                                     SFILE(SUBFIL:ZRECNO)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSGE01                 1      3
     D  WSGE02                 4      6
     D  WSGE03                 7      9
     D  WSGE04                10     12
     D  WSGE05                13     15
     D  WSGE06                16     18
     D  WSGE07                19     21
     D  WSGE08                22     24
     D  WSGE09                25     27
     D  WSGE10                28     30
     D  GE                     1     30
     D                                     DIM(10)
     D                 DS
     D  WSFDAT                 1      6  0
     D  WSAKDG                 1      2  0
     D  WSAKMN                 3      4  0
     D  WSAKAR                 5      6  0
     D                 DS
     D  WSTDAT                 1      6  0
     D  WSGJDG                 1      2  0
     D  WSGJMN                 3      4  0
     D  WSGJAR                 5      6  0
     D                 DS
     D  AFAKDT                 1      8  0
     D  AFAKAR                 1      4  0
     D  AFAKMN                 5      6  0
     D  AFAKDG                 7      8  0
     D                 DS
     D  AFGJDT                 1      8  0
     D  AFGJAR                 1      4  0
     D  AFGJMN                 5      6  0
     D  AFGJDG                 7      8  0
      *
     C                   EXSR      INIT
     C     UUUKUN        IFNE      *ZEROS
     C                   MOVE      UUUKUN        WSKUND
     C                   GOTO      DIRKUN
     C                   END
     C     UUAVNR        IFNE      *ZEROS
     C     UUAVNR        CHAIN(N)  AVFRHL01                           33
     C  N33              MOVE      AFKUND        WSKUND
     C  N33KUNKEY        CHAIN     CUNDL01                            33
     C  N33              DO
     C                   SETON                                        40
     C                   EXSR      MOVPRW
      *
     C                   EXSR      KDTFMT
      * 28 ON=VANLIG, 28 OFF=%-RAB. AVH. AV FRA/TIL BRT.TABELL.
     C     WSLKFR        COMP      '%%'                               2828
     C     WSBFRA        COMP      'T'                                    29
      * N28N29 - vanlig %% avt (P), N28 29 - %% for å pnr, men ellers T
     C                   EXFMT     VARELI
     C                   EXSR      KDTFMT
     C   03              GOTO      SLUTT
     C  N12              EXSR      TABELL
     C                   GOTO      START
     C                   END
     C                   GOTO      SLUTT
     C                   END
     C*
     C     STAR0B        TAG
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   EXFMT     BILDE01
      *
     C                   SETOFF                                       30
     C   03              GOTO      SLUTT
     C* TEST DEPARTMENT
     C     KODAVD        CHAIN     KODTA                              99
     C  N99KODVVV        CHAIN     KODTV                              99
     C  N99KODWWW        CHAIN     KODTW                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              GOTO      STAR0B
     C*
     C* BILDE02 INNTAST KUNDENUMMER
     C*
     C                   MOVE      *ZEROS        KPKUNR
     C*
     C     B02           TAG
     C                   Z-ADD     07            LINNBR
     C                   Z-ADD     24            POSNBR
     C                   EXFMT     BILDE02
     C                   SETOFF                                       309899
      *
      * F12 = Tilbake til forrige bilde
     C   12              GOTO      STAR0B
      * F02 = Kopier avtaler fra kunde (KPKUNR) til kunde (WSKUND)
     C   02              DO
     C                   EXSR      KPKAVT
     C   30              GOTO      B02
     C                   MOVE      *ZEROS        KPKUNR
     C                   MOVE      WSKUND        AFKUND
     C                   GOTO      START
     C                   END
      * F03 = Avslutt
     C   03              GOTO      SLUTT
      * F04 = Søk kunde
     C   04              DO
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDEQ     24
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKUND
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   ELSE
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDEQ     24
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    KPKUNR
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   GOTO      B02
     C                   END
     C                   END
     C                   END
     C     DIRKUN        TAG
     C     KUNKEY        CHAIN     CUNDL01                            99
     C   99              MOVE      'SPK0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      B02
     C                   MOVE      *ZEROS        KPKUNR
     C                   MOVE      WSKUND        AFKUND
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     AFKUND        SETLL     AVFRH
     C     START1        TAG
     C     AFKUND        READE(N)  AVFRH                                  94
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        14
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     AFKUND        READE(N)  AVFRH                                  94
     C  N94              DO
     C                   MOVE      AFPROD        W2PROD
     C                   MOVE      AFAVDE        W2AVDE
     C                   MOVE      AFLKFR        W2LKFR
     C                   MOVE      AFPNF1        W2PNF1
     C                   MOVE      AFLKTI        W2LKTI
     C                   MOVE      AFPNT1        W2PNT1
     C                   MOVE      AFFRAN        W2FRAN
     C                   MOVE      AFGEBY        W2GEBY
     C                   END
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   Z-ADD     07            LINNBR
     C                   Z-ADD     03            POSNBR
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C                   SETOFF                                       9830
     C   10
     CANN27              DO
N05  C                   move      'K'           Ukule             1
N05  C   45              move      'L'           Ukule             1
     C                   CALL      'SYFA09'
N05  C                   PARM                    Ukule
     C                   PARM                    WSKUND
     C                   GOTO      START
     C                   END
     C   10
     CAN 27              DO
     C                   CALL      'SYFA88'
     C                   PARM                    WSKUND
     C                   GOTO      START
     C                   END
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE NY
     C   06
     CANN27              DO
     C                   EXSR      MOVB2
     C                   SETOFF                                       40
     C                   GOTO      START5
     C                   END
     C*** OLJETILLEGG M.M.
     C   07              DO
     C                   CALL      'SYFA23B'
     C                   PARM                    WSKUND
     C                   GOTO      START3
     C                   END
     C*** SØK FRA
     C   08              GOTO      START6
     C*
     C   12              GOTO      B02
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94PRISK3        SETLL     AVFRH
     C  N94AFKUND        READE(N)  AVFRH                                  94
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENT
     C   98              GOTO      START3
     C                   END
     C*
     C*** SLETT VARE
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C                   EXFMT     VAREL3
     C  N12              DO
     C     DELKE2        CHAIN     AVFRHL01                           33
     C  N33              DELETE    AVFRHRL
     C                   MOVE      'F'           DELKOD
     C                   EXSR      DELTAB
     C                   MOVE      'H'           DELKOD
     C                   EXSR      DELTAB
     C                   MOVE      'V'           DELKOD
     C                   EXSR      DELTAB
     C                   EXSR      MOVB1
     C                   MOVE      '*DEL*'       AFPNF1
     C                   END
     C                   UPDATE    SUBFIL
     C                   GOTO      START3
     C                   END
     C     WSNR          IFEQ      '3'
     C     WSNR          OREQ      '9'
     C                   MOVE      ' '           WSNR
     C                   GOTO      START3
     C                   END
     C*
     C*** LAGE/ENDRE
     C     START5        TAG
     C  N30
     CANN04              Z-ADD     06            LINNBR
     C  N30
     CANN04              Z-ADD     23            POSNBR
     C                   EXSR      KDTFMT
     C     WSLKFR        COMP      '%%'                               2828
     C     WSBFRA        COMP      'T'                                    29
     C                   EXFMT     VARELI
     C                   EXSR      KDTFMT
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVEA     '00000000'    *IN(67)
     C                   MOVEA     '00'          *IN(65)
     C                   MOVE      '0'           *IN30
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START5
     C                   END
      *
     C   03
     COR 12              DO
     C   40              UPDATE    SUBFIL
     C                   SETOFF                                       40
     C                   EXSR      MOVB2
     C                   GOTO      START3
     C                   END
     C*
     C                   EXSR      TESTB1
     C   12
     COR 30              GOTO      START5
     C                   GOTO      START3
     C*
     C*** SØK FRA
     C     START6        TAG
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     08            POSNBR
     C                   EXFMT     VAREL2
     C   03              GOTO      SLUTT
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C     PRISK3        SETLL     AVFRH
     C                   GOTO      START1
     C*
     C     SLUTT         TAG
N03  C                   CLOSE     AVFRHCOP
N03  C                   CLOSE     AVFRDL01C
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     ENDRE         BEGSR
     C***********************************************
     C     STAR5B        TAG
     C  N30
     CANN04              Z-ADD     06            LINNBR
     C  N30
     CANN04              Z-ADD     23            POSNBR
     C                   EXSR      KDTFMT
     C     WSLKFR        COMP      '%%'                               2828
     C     WSBFRA        COMP      'T'                                    29
     C                   EXFMT     VARELI
     C                   EXSR      KDTFMT
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVEA     '00000000'    *IN(67)
     C                   MOVEA     '00'          *IN(65)
     C                   MOVE      '0'           *IN30
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STAR5B
     C                   END
     C*
     C   03
     COR 12              DO
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   GOTO      UTSRE
     C                   END
     C*
     C                   EXSR      TESTB1
     C   12
     COR 30              GOTO      STAR5B
     C     UTSRE         ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C  N40              DO
     C* TESTER MED NY
     C*
     C                   END
      *
     C     WSLKFR        IFNE      *BLANKS
     C                   MOVE      WSLKFR        KLKLK
     C     KODLKK        CHAIN     KODTLK                             90
     C     *IN90         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPL0001'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSLKFR        IFEQ      '%%'
     C     WSPNF1        IFEQ      *BLANKS
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV0780'     MSGNR
     C                   GOTO      SLTB1
     C                   ELSE
     C     WSPNF2        IFEQ      *BLANKS
     C                   MOVE      WSPNF1        WSPNF2
     C                   END
     C                   END
     C                   END
N07  C     WSPNF1        IFNE      *BLANKS
N07  C     WSPNF2        ANDEQ     *BLANKS
N07  C                   MOVE      WSPNF1        WSPNF2
N07  C                   END
N07  C     WSPNT1        IFNE      *BLANKS
N07  C     WSPNT2        ANDEQ     *BLANKS
N07  C                   MOVE      WSPNT1        WSPNT2
N07  C                   END
      *
     C     WSLKTI        IFNE      *BLANKS
     C                   MOVE      WSLKTI        KLKLK
     C     KODLKK        CHAIN     KODTLK                             89
     C     *IN89         IFEQ      '1'
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPL0001'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSFRAN        IFNE      *BLANKS
     C     KODFRK        CHAIN     KODTFR                             88
     C     *IN88         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPF0006'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSGEBY        IFNE      *BLANKS
     C     KODGEK        CHAIN     KODTGE                             87
     C     *IN87         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     52            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPG0002'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C                   MOVEL     WSBFRA        KFKOD3
     C     FAST3K        CHAIN     KOFAST                             86
     C     *IN86         IFEQ      '1'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0372'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     WSSFRA        IFNE      *BLANKS
     C     WSSFRA        SETLL     SONESL02
     C     WSSFRA        READE     SONESL02                               67
     C     *IN67         IFEQ      '1'
     C                   MOVE      'YBC0346'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C                   MOVEL     WSBFR1        KFKOD3
     C     FAST3K        CHAIN     KOFAST                             85
     C     *IN85         IFEQ      '1'
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0372'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     WSSFR1        IFNE      *BLANKS
     C     WSSFR1        SETLL     SONESL02
     C     WSSFR1        READE     SONESL02                               66
     C     *IN66         IFEQ      '1'
     C                   MOVE      'YBC0346'     MSGNR
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C                   MOVEL     WSBFR2        KFKOD3
     C     FAST3K        CHAIN     KOFAST                             84
     C     *IN84         IFEQ      '1'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0372'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     WSSFR2        IFNE      *BLANKS
     C     WSSFR2        SETLL     SONESL02
     C     WSSFR2        READE     SONESL02                               65
     C     *IN65         IFEQ      '1'
     C                   MOVE      'YBC0346'     MSGNR
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSBFRA        IFEQ      ' '
     C     WSPFRA        IFEQ      *ZEROS
     C     *IN28         OREQ      *OFF
     C                   MOVE      'P'           WSBFRA
     C                   END
     C                   END
      *
     C     WSBFRA        IFNE      ' '
     C     WSBFRA        ANDNE     'N'
     C     WSBFR1        IFNE      ' '
     C     WSBFR1        ANDNE     'N'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVEA     '111'         *IN(84)
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0370'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     WSBFR2        IFNE      ' '
     C     WSBFR2        ANDNE     'N'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVEA     '101'         *IN(84)
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0370'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSBFR1        IFNE      ' '
     C     WSBFR1        ANDNE     'N'
     C     WSBFR2        ANDNE     ' '
     C     WSBFR2        ANDNE     'N'
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVEA     '11'          *IN(84)
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0370'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     VALU1K        CHAIN     VALUL01                            83
     C     *IN83         IFEQ      '1'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPV0001'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C                   MOVEL     WSPROD        KFKOD1
     C     FAST1K        CHAIN     KUFAST                             82
     C     *IN82         IFEQ      '1'
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0360'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     WSAVDE        IFNE      *ZEROS
     C     KODTAK        CHAIN     KODTA                              81
     C     *IN81         IFEQ      '1'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPA0001'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSTYPE        IFEQ      'V'
     C     WSBFRA        ANDNE     'T'
     C     WSBFR1        ANDNE     'T'
     C     WSBFR2        ANDNE     'T'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVEA     '111'         *IN(84)
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0380'     MSGNR
     C                   GOTO      SLTB1
     C                   ELSE
     C                   MOVEL     WSTYPE        KFKOD2
     C     FAST2K        CHAIN     KOFAST                             80
     C     *IN80         IFEQ      '1'
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0371'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     1             DO        10            XN                3 0          1<-B
     C     GE(XN)        IFNE      *BLANKS                                       2<-B
     C                   MOVE      GE(XN)        KGEKOD
     C     KODG2K        CHAIN     KODTGE                             30
     C     *IN30         IFEQ      '1'                                            3<-B
     C     80            SUB       XN            XN
     C                   MOVE      '1'           *IN(XN)
     C                   Z-ADD     21            LINNBR
     C     80            SUB       XN            XN
     C                   MULT      4             XN
     C     XN            ADD       19            POSNBR
     C                   MOVE      'SPG0002'     MSGNR
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     WSFDAT        IFNE      0
     C                   MOVE      WSAKAR        UÅÅ               2 0
     C                   MOVE      WSAKMN        UMM               2 0
     C                   MOVE      WSAKDG        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN69
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WSTDAT        IFNE      0
     C                   MOVE      WSGJAR        UÅÅ               2 0
     C                   MOVE      WSGJMN        UMM               2 0
     C                   MOVE      WSGJDG        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     32            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   MOVE      '1'           *IN68
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C*
     C  N40PRISK         CHAIN     AVFRH                              33
     C   40AFAVNR        CHAIN     AVFRHL01                           33
     C  N33
     CANN40              MOVE      'DIV0000'     MSGNR
     C  N33
     CANN40              SETON                                        30
     C  N33
     CANN40              GOTO      SLTB1
      *
     C     *IN40         IFEQ      '1'
      * SLETTE GAMLE TABELLER
     C     WSBFRA        IFNE      AFBFRA
     C     WSBFRA        OREQ      'P'
     C     WSPFRA        ANDNE     0
     C     AFBFRA        IFEQ      'T'
     C     AFBFRA        OREQ      'P'
     C     AFPFRA        ANDEQ     0
     C                   MOVEA     '001'         *IN(88)
     C     STTB11        TAG
     C                   EXFMT     BEKREFT
     C   12              GOTO      SLTB1
     C  N23              GOTO      STTB11
     C                   MOVE      'H'           DELKOD
     C                   EXSR      DELTAB
     C                   END
     C                   END
      *
     C     WSBFR1        IFNE      AFBFR1
     C     WSBFR1        OREQ      'P'
     C     WSPFR1        ANDNE     0
     C     AFBFR1        IFEQ      'T'
     C     AFBFR1        OREQ      'P'
     C     AFPFR1        ANDEQ     0
     C                   MOVEA     '010'         *IN(88)
     C     STTB12        TAG
     C                   EXFMT     BEKREFT
     C   12              GOTO      SLTB1
     C  N23              GOTO      STTB12
     C                   MOVE      'F'           DELKOD
     C                   EXSR      DELTAB
     C                   END
     C                   END
      *
     C     WSBFR2        IFNE      AFBFR2
     C     WSBFR2        OREQ      'P'
     C     WSPFR2        ANDNE     0
     C     AFBFR2        IFEQ      'T'
     C     AFBFR2        OREQ      'P'
     C     AFPFR2        ANDEQ     0
     C                   MOVEA     '100'         *IN(88)
     C     STTB13        TAG
     C                   EXFMT     BEKREFT
     C   12              GOTO      SLTB1
     C  N23              GOTO      STTB13
     C                   MOVE      'V'           DELKOD
     C                   EXSR      DELTAB
     C                   END
     C                   END
      *
     C                   MOVE      '0'           *IN33
     C                   END
      *
     C                   EXSR      MOVWPR
     C  N33              UPDATE    AVFRHRL
     C   33              WRITE     AVFRHR
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C   40              MOVE      'N'           NY                1
     C  N40              MOVE      'J'           NY
     C                   SETOFF                                       40
     C*
     C                   EXSR      TABELL
     C*
     C                   EXSR      MOVB2
      *
     C     SLTB1         TAG
     C  N30              MOVEA     '000'         *IN(88)
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '2'
     C     WSNR          OREQ      '5'
     C     AFPNF1        COMP      '*DEL*'                                98
     C   98              GOTO      SLHENT
     C                   EXSR      MOVPRW
     C                   MOVE      ' '           WSNR
     C                   SETON                                        40
     C                   EXSR      ENDRE
     C                   END
     C                   MOVE      'N'           SNU               1
     C  N98WSNR          IFEQ      '9'
     C                   MOVE      '3'           WSNR
     C                   MOVE      'J'           SNU               1
     C                   END
     C  N98WSNR          IFEQ      '3'
     C     AFPNF1        COMP      '*DEL*'                                98
     C   98              GOTO      SLHENT
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   EXSR      KPKAV2
     C                   MOVE      '3'           WSNR
     C                   GOTO      SLHENT
     C                   END
     C  N98
     CANN27WSNR          IFEQ      '4'
     C     AFPNF1        COMP      '*DEL*'                                98
     C                   GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWPR        BEGSR
     C***********************************************
     C* HENTER NESTE AVTALETELLER VED NY
     C*
     C   33
     CANN40              DO
     C     'A'           CHAIN     AVFRT                              25
     C                   ADD       1             AVTELL
     C   25              MOVE      'A'           AVNOEK
     C   25              WRITE     AVFRTR
     C  N25              UPDATE    AVFRTR
     C                   MOVE      AVTELL        AFAVNR
     C                   END
     C                   MOVE      WSGRPR        AFGRPR
     C                   MOVE      WSMAXI        AFMAXI
     C                   MOVE      WSMINI        AFMINI
     C                   MOVE      WSFRAN        AFFRAN
     C                   MOVE      WSGEBY        AFGEBY
     C                   MOVE      WSFRTX        AFFRTX
     C     WSFDAT        IFEQ      0
     C                   MOVE      *ZEROS        AFAKDT
     C                   ELSE
     C                   MOVE      WSAKDG        AFAKDG
     C                   MOVE      WSAKMN        AFAKMN
     C     WSAKAR        IFGT      50
     C     WSAKAR        ADD       1900          AFAKAR
     C                   ELSE
     C     WSAKAR        ADD       2000          AFAKAR
     C                   END
     C                   END
     C     WSTDAT        IFEQ      0
     C                   MOVE      *ZEROS        AFGJDT
     C                   ELSE
     C                   MOVE      WSGJDG        AFGJDG
     C                   MOVE      WSGJMN        AFGJMN
     C     WSGJAR        IFGT      50
     C     WSGJAR        ADD       1900          AFGJAR
     C                   ELSE
     C     WSGJAR        ADD       2000          AFGJAR
     C                   END
     C                   END
     C                   MOVE      WSGE01        AFGE01
     C                   MOVE      WSGE02        AFGE02
     C                   MOVE      WSGE03        AFGE03
     C                   MOVE      WSGE04        AFGE04
     C                   MOVE      WSGE05        AFGE05
     C                   MOVE      WSGE06        AFGE06
     C                   MOVE      WSGE07        AFGE07
     C                   MOVE      WSGE08        AFGE08
     C                   MOVE      WSGE09        AFGE09
     C                   MOVE      WSGE10        AFGE10
     C                   MOVE      WSVALK        AFVALK
     C                   MOVE      WSSFR2        AFSFR2
     C                   MOVE      WSPFR2        AFPFR2
     C                   MOVE      WSBFR2        AFBFR2
     C                   MOVE      WSSFRA        AFSFRA
     C                   MOVE      WSPFRA        AFPFRA
     C                   MOVE      WSBFRA        AFBFRA
     C                   MOVE      WSSFR1        AFSFR1
     C                   MOVE      WSPFR1        AFPFR1
     C                   MOVE      WSBFR1        AFBFR1
     C                   MOVE      WSTYPE        AFTYPE
     C                   MOVE      WSMIMA        AFMIMA
     C                   MOVE      WSGREN        AFGREN
     C                   MOVE      WSOMRL        AFOMRL
     C                   MOVE      WSOMRM        AFOMRM
     C                   MOVE      WSOMR1        AFOMR1
     C                   MOVE      WSOMR2        AFOMR2
     C                   MOVE      WSPROD        AFPROD
     C                   MOVE      WSAVDE        AFAVDE
     C                   MOVE      WSLKFR        AFLKFR
     C                   MOVE      WSPNF1        AFPNF1
     C                   MOVE      WSPNF2        AFPNF2
     C                   MOVE      WSLKTI        AFLKTI
     C                   MOVE      WSPNT1        AFPNT1
     C                   MOVE      WSPNT2        AFPNT2
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVPRW        BEGSR
     C***********************************************
     C*
     C                   MOVE      AFGRPR        WSGRPR
     C                   MOVE      AFMAXI        WSMAXI
     C                   MOVE      AFMINI        WSMINI
     C                   MOVE      AFFRAN        WSFRAN
     C                   MOVE      AFGEBY        WSGEBY
     C                   MOVE      AFFRTX        WSFRTX
     C                   MOVE      AFAKDG        WSAKDG
     C                   MOVE      AFAKMN        WSAKMN
     C                   MOVE      AFAKAR        WSAKAR
     C                   MOVE      AFGJDG        WSGJDG
     C                   MOVE      AFGJMN        WSGJMN
     C                   MOVE      AFGJAR        WSGJAR
     C                   MOVE      AFGE01        WSGE01
     C                   MOVE      AFGE02        WSGE02
     C                   MOVE      AFGE03        WSGE03
     C                   MOVE      AFGE04        WSGE04
     C                   MOVE      AFGE05        WSGE05
     C                   MOVE      AFGE06        WSGE06
     C                   MOVE      AFGE07        WSGE07
     C                   MOVE      AFGE08        WSGE08
     C                   MOVE      AFGE09        WSGE09
     C                   MOVE      AFGE10        WSGE10
     C                   MOVE      AFVALK        WSVALK
     C                   MOVE      AFSFR2        WSSFR2
     C                   MOVE      AFPFR2        WSPFR2
     C                   MOVE      AFBFR2        WSBFR2
     C                   MOVE      AFSFRA        WSSFRA
     C                   MOVE      AFPFRA        WSPFRA
     C                   MOVE      AFBFRA        WSBFRA
     C                   MOVE      AFSFR1        WSSFR1
     C                   MOVE      AFPFR1        WSPFR1
     C                   MOVE      AFBFR1        WSBFR1
     C                   MOVE      AFTYPE        WSTYPE
     C                   MOVE      AFMIMA        WSMIMA
     C                   MOVE      AFGREN        WSGREN
     C                   MOVE      AFOMRL        WSOMRL
     C                   MOVE      AFOMRM        WSOMRM
     C                   MOVE      AFOMR1        WSOMR1
     C                   MOVE      AFOMR2        WSOMR2
     C                   MOVE      AFPROD        WSPROD
     C                   MOVE      AFAVDE        WSAVDE
     C                   MOVE      AFLKFR        WSLKFR
     C                   MOVE      AFPNF1        WSPNF1
     C                   MOVE      AFPNF2        WSPNF2
     C                   MOVE      AFLKTI        WSLKTI
     C                   MOVE      AFPNT1        WSPNT1
     C                   MOVE      AFPNT2        WSPNT2
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        AFGRPR
     C                   MOVE      *ZEROS        AFMAXI
     C                   MOVE      *ZEROS        AFMINI
     C                   MOVE      *BLANKS       AFFRAN
     C                   MOVE      *BLANKS       AFGEBY
     C                   MOVE      *BLANKS       AFFRTX
     C                   MOVE      *ZEROS        AFAKDT
     C                   MOVE      *ZEROS        AFGJDT
     C                   MOVE      *BLANKS       AFGE01
     C                   MOVE      *BLANKS       AFGE02
     C                   MOVE      *BLANKS       AFGE03
     C                   MOVE      *BLANKS       AFGE04
     C                   MOVE      *BLANKS       AFGE05
     C                   MOVE      *BLANKS       AFGE06
     C                   MOVE      *BLANKS       AFGE07
     C                   MOVE      *BLANKS       AFGE08
     C                   MOVE      *BLANKS       AFGE09
     C                   MOVE      *BLANKS       AFGE10
     C                   MOVE      *BLANKS       AFVALK
     C                   MOVE      *BLANKS       AFSFR2
     C                   MOVE      *ZEROS        AFPFR2
     C                   MOVE      *BLANKS       AFBFR2
     C                   MOVE      *BLANKS       AFSFRA
     C                   MOVE      *ZEROS        AFPFRA
     C                   MOVE      *BLANKS       AFBFRA
     C                   MOVE      *BLANKS       AFSFR1
     C                   MOVE      *ZEROS        AFPFR1
     C                   MOVE      *BLANKS       AFBFR1
     C                   MOVE      *BLANKS       AFTYPE
     C                   MOVE      *ZEROS        AFMIMA
     C                   MOVE      *ZEROS        AFOMRL
     C                   MOVE      *ZEROS        AFOMRM
     C                   MOVE      *ZEROS        AFOMR1
     C                   MOVE      *ZEROS        AFOMR2
     C                   MOVE      *BLANKS       AFPROD
     C                   MOVE      *ZEROS        AFAVDE
     C                   MOVE      *BLANKS       AFLKFR
     C                   MOVE      *BLANKS       AFPNF1
     C                   MOVE      *BLANKS       AFPNF2
     C                   MOVE      *BLANKS       AFLKTI
     C                   MOVE      *BLANKS       AFPNT1
     C                   MOVE      *BLANKS       AFPNT2
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSGRPR
     C                   MOVE      *ZEROS        WSMAXI
     C                   MOVE      *ZEROS        WSMINI
     C                   MOVE      *BLANKS       WSFRAN
     C                   MOVE      *BLANKS       WSGEBY
     C                   MOVE      *BLANKS       WSFRTX
     C                   MOVE      *ZEROS        WSFDAT
     C                   MOVE      *ZEROS        WSTDAT
     C                   MOVE      *BLANKS       WSGE01
     C                   MOVE      *BLANKS       WSGE02
     C                   MOVE      *BLANKS       WSGE03
     C                   MOVE      *BLANKS       WSGE04
     C                   MOVE      *BLANKS       WSGE05
     C                   MOVE      *BLANKS       WSGE06
     C                   MOVE      *BLANKS       WSGE07
     C                   MOVE      *BLANKS       WSGE08
     C                   MOVE      *BLANKS       WSGE09
     C                   MOVE      *BLANKS       WSGE10
     C                   MOVE      FICURR        WSVALK
     C                   MOVE      *BLANKS       WSSFR2
     C                   MOVE      *ZEROS        WSPFR2
     C                   MOVE      *BLANKS       WSBFR2
     C                   MOVE      *BLANKS       WSSFRA
     C                   MOVE      *ZEROS        WSPFRA
     C                   MOVE      *BLANKS       WSBFRA
     C                   MOVE      *BLANKS       WSSFR1
     C                   MOVE      *ZEROS        WSPFR1
     C                   MOVE      *BLANKS       WSBFR1
     C                   MOVE      *BLANKS       WSTYPE
     C                   MOVE      KOWMM         WSMIMA
     C                   Z-ADD     2500          WSGREN
     C                   MOVE      KOVLKG        WSOMRL
     C                   MOVE      KOVKKG        WSOMRM
     C                   MOVE      *BLANKS       WSPROD
     C                   MOVE      *ZEROS        WSAVDE
     C                   MOVE      *BLANKS       WSLKFR
     C                   MOVE      *BLANKS       WSPNF1
     C                   MOVE      *BLANKS       WSPNF2
     C                   MOVE      *BLANKS       WSLKTI
     C                   MOVE      *BLANKS       WSPNT1
     C                   MOVE      *BLANKS       WSPNT2
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     24
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKFR
     C                   PARM                    USPED
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     30
     C                   MOVE      *BLANKS       USØKPN           30
N02  C     *in28         ifeq      '1'
     C                   CALL      'SYFI10F'
     C                   PARM                    WSPNF1
     C                   PARM                    USØKPN
     C                   PARM                    WSLKFR
N02  C                   ELSE
N02  C                   CALL      'SYPO02X'
N02  C                   PARM                    WSPNF1
N02  C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     36
     C                   MOVE      *BLANKS       USØKPN           30
N02  C     *in28         ifeq      '1'
     C                   CALL      'SYFI10F'
     C                   PARM                    WSPNF2
     C                   PARM                    USØKPN
     C                   PARM                    WSLKFR
N02  C                   ELSE
N02  C                   CALL      'SYPO02X'
N02  C                   PARM                    WSPNF2
N02  C                   END
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     24
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKTI
     C                   PARM                    USPED
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     30
     C                   MOVE      *BLANKS       USØKPN           30
     C                   CALL      'SYFI10F'
     C                   PARM                    WSPNT1
     C                   PARM                    USØKPN
     C                   PARM                    WSLKTI
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     36
     C                   MOVE      *BLANKS       USØKPN           30
     C                   CALL      'SYFI10F'
     C                   PARM                    WSPNT2
     C                   PARM                    USØKPN
     C                   PARM                    WSLKTI
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     25
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFRAN
     C                   PARM                    USPED
     C                   Z-ADD     52            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     54
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGEBY
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDEQ     23
     C                   MOVEL     WSBFRA        KFKOD3            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP3
     C                   PARM                    UUPDKO
     C                   PARM                    KFKOD3
     C                   MOVEL     KFKOD3        WSBFRA
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     56
     C                   CALL      'SYPO02X'
     C                   PARM                    WSSFRA
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDEQ     23
     C                   MOVEL     WSBFR1        KFKOD3            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP3
     C                   PARM                    UUPDKO
     C                   PARM                    KFKOD3
     C                   MOVEL     KFKOD3        WSBFR1
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     56
     C                   CALL      'SYPO02X'
     C                   PARM                    WSSFR1
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDEQ     23
     C                   MOVEL     WSBFR2        KFKOD3            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP3
     C                   PARM                    UUPDKO
     C                   PARM                    KFKOD3
     C                   MOVEL     KFKOD3        WSBFR2
     C                   Z-ADD     28            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     56
     C                   CALL      'SYPO02X'
     C                   PARM                    WSSFR2
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     25
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVALK
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDEQ     23
     C                   MOVEL     WSPROD        KFKOD1            5
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP1
     C                   PARM                    UUPDKU
     C                   PARM                    KFKOD1
     C                   MOVEL     KFKOD1        WSPROD
     C                   Z-ADD     16            LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     26
     C                   CALL      'SYFA14B'
     C                   PARM                    WSAVDE
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDEQ     23
     C                   MOVEL     WSTYPE        KFKOD2            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP2
     C                   PARM                    UUPDKO
     C                   PARM                    KFKOD2
     C                   MOVEL     KFKOD2        WSTYPE
     C                   Z-ADD     18            LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C  N27LINNBR        IFEQ      21
      *
     C     POSNBR        IFGE      23
     C     POSNBR        ANDLE     25
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE01
     C                   Z-ADD     27            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      27
     C     POSNBR        ANDLE     29
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE02
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      31
     C     POSNBR        ANDLE     33
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE03
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      35
     C     POSNBR        ANDLE     37
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE04
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      39
     C     POSNBR        ANDLE     41
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE05
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      43
     C     POSNBR        ANDLE     45
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE06
     C                   Z-ADD     47            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      47
     C     POSNBR        ANDLE     49
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE07
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      51
     C     POSNBR        ANDLE     53
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE08
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      55
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE09
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     POSNBR        IFGE      59
     C     POSNBR        ANDLE     61
     C                   CALL      'SYFI10D'
     C                   PARM                    WSGE10
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C* B = BRUTTO
     C* C = CUSTOMER-RELATED
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UUAVNR            9 0
     C                   PARM                    UUUKUN            8 0
     C                   PARM                    UFLAGG            1 0
n04  c     uflagg        comp      8                                  474745
n04  c   47uflagg        comp      1                                  474746
N03YBC*                  OPEN      AVFRHCOP
N03YBC*                  OPEN      AVFRDL01C
      *
     C     FAST1K        KLIST
     C                   KFLD                    KFTYP1           10
     C                   KFLD                    KFKOD1            5
     C                   MOVEL     'PRODTYPE'    KFTYP1
     C     FAST2K        KLIST
     C                   KFLD                    KFTYP2           10
     C                   KFLD                    KFKOD2            5
     C                   MOVEL     'TABTYP'      KFTYP2
     C     FAST3K        KLIST
     C                   KFLD                    KFTYP3           10
     C                   KFLD                    KFKOD3            5
     C                   MOVEL     'BERKOD'      KFTYP3
     C     KODAVD        KLIST
     C                   KFLD                    AVUNIK
     C                   KFLD                    WSAVD
     C     KODTAK        KLIST
     C                   KFLD                    AVUNIK
     C                   KFLD                    WSAVDE
     C     KODVVV        KLIST
     C                   KFLD                    A1UNIK
     C                   KFLD                    WSAVD
     C     KODWWW        KLIST
     C                   KFLD                    A2UNIK
     C                   KFLD                    WSAVD
     C     KODLKK        KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    WSFRAN
     C     KODGEK        KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    WSGEBY
     C     KODG2K        KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    KGEKOD
     C     PRISK         KLIST
     C                   KFLD                    AFKUND
     C                   KFLD                    WSPROD
     C                   KFLD                    WSAVDE
     C                   KFLD                    WSLKFR
     C                   KFLD                    WSPNF1
     C                   KFLD                    WSFRAN
     C                   KFLD                    WSGEBY
     C                   KFLD                    WSLKTI
     C                   KFLD                    WSPNT1
     C     PRISKK        KLIST
     C                   KFLD                    AFKUND
     C                   KFLD                    AFPROD
     C                   KFLD                    AFAVDE
     C                   KFLD                    AFLKFR
     C                   KFLD                    AFPNF1
     C                   KFLD                    AFFRAN
     C                   KFLD                    AFGEBY
     C                   KFLD                    AFLKTI
     C                   KFLD                    AFPNT1
     C     PRISK3        KLIST
     C                   KFLD                    AFKUND
     C                   KFLD                    W2PROD
     C                   KFLD                    W2AVDE
     C                   KFLD                    W2LKFR
     C                   KFLD                    W2PNF1
     C                   KFLD                    W2FRAN            3
     C                   KFLD                    W2GEBY            3
     C                   KFLD                    W2LKTI            2
     C                   KFLD                    W2PNT1            5
     C*
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKUND
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSVALK
     C*
     C     DELKE2        KLIST
     C                   KFLD                    AFAVNR
     C*
     C     DELKEY        KLIST
     C                   KFLD                    AFAVNR
     C                   KFLD                    DELKOD            1
     C*
     C                   MOVE      'LK '         KLKUNI
     C                   MOVE      'GE'          KGEUNI
     C                   MOVE      'FR'          KFRUNI
     C                   MOVE      'A'           AVUNIK            1
     C                   MOVE      'V'           A1UNIK            1
     C                   MOVE      'W'           A2UNIK            1
     C                   MOVE      'J'           USPED             1
     C                   MOVE      'J'           USØK              1
     C                   MOVE      ' '           UUPDKO            1
     C                   MOVE      'N'           UUPDKU            1
     C                   MOVE      *BLANKS       GE
     C     UFLAGG        COMP      1                                      27
     C*
     C*
     C                   READ      FIRM                                   33
      *
n04  c     *in47         ifeq      '1'
N03  C                   MOVE      FILIBF        WSDABA
N03YBC                   MOVE      'N'           feil
N03YBC                   CALL      'SYPO09COP'
N03YBC                   PARM                    WSDABA
N03YBC                   PARM                    FEIL              1
n04  c                   end
N03YBC                   OPEN      AVFRHCOP
N03YBC                   OPEN      AVFRDL01C
     C                   MOVE      *ZEROS        WSFDAT
     C                   MOVE      *ZEROS        WSTDAT
     C                   ENDSR
      *
     C***********************************************
     C     TABELL        BEGSR
     C***********************************************
     C     AFTYPE        IFNE      'V'                                          1<-B
     C                   MOVE      'H'           DELKOD
     C     AFBFRA        IFEQ      'P'                                           2<-B
     C     AFPFRA        ANDEQ     *ZEROS
     C     AFBFRA        OREQ      'T'
     C     AFBFRA        IFEQ      'T'                                            3<-B
     C                   MOVE      'T'           NUMTYP
     C                   ELSE                                                     3
     C                   MOVE      'P'           NUMTYP
     C                   ENDIF                                                    3<-E
     C                   CALL      'SYPO10'
     C                   PARM                    AFAVNR
     C                   PARM                    DELKOD
     C                   PARM                    UFLAGG
     C                   PARM                    NUMTYP
     C                   PARM                    WSAVD
     C                   END                                                     2<-E
      *
     C                   MOVE      'F'           DELKOD
     C     AFBFR1        IFEQ      'P'                                           2<-B
     C     AFPFR1        ANDEQ     *ZEROS
     C     AFBFR1        OREQ      'T'
     C     AFBFR1        IFEQ      'T'                                            3<-B
     C                   MOVE      'T'           NUMTYP
     C                   ELSE                                                     3
     C                   MOVE      'P'           NUMTYP
     C                   ENDIF                                                    3<-E
     C                   CALL      'SYPO10'
     C                   PARM                    AFAVNR
     C                   PARM                    DELKOD
     C                   PARM                    UFLAGG
     C                   PARM                    NUMTYP            1
     C                   PARM                    WSAVD
     C                   END                                                     2<-E
      *
     C                   MOVE      'V'           DELKOD
     C     AFBFR2        IFEQ      'P'                                           2<-B
     C     AFPFR2        ANDEQ     *ZEROS
     C     AFBFR2        OREQ      'T'
     C     AFBFR2        IFEQ      'T'                                            3<-B
     C                   MOVE      'T'           NUMTYP
     C                   ELSE                                                     3
     C                   MOVE      'P'           NUMTYP
     C                   ENDIF                                                    3<-E
     C                   CALL      'SYPO10'
     C                   PARM                    AFAVNR
     C                   PARM                    DELKOD
     C                   PARM                    UFLAGG
     C                   PARM                    NUMTYP
     C                   PARM                    WSAVD
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     DELTAB        BEGSR
     C***********************************************
     C*
     C     DELKEY        SETLL     AVFRDL01
     C     STDEL         TAG
     C     DELKEY        READE     AVFRDL01                               33
     C  N33              DELETE    AVFRDR
     C  N33              GOTO      STDEL
      *
     C                   ENDSR
      *
     C***********************************************
     C     KPKAVT        BEGSR
     C***********************************************
N03  C                   SETOFF                                       97
N08  C     WSKOPKU       ifne      'J'
N08  C     WSKOPLE       andne     'J'
     C     KPKUNR        COMP      WSKUND                                 30
     C   30              MOVE      'SHU0419'     MSGNR
     C   30              SETON                                        98
     C   30              GOTO      SLKPKA
N08  C                   endif
     C     KUNKEY        CHAIN     CUNDL01                            99
     C   99              MOVE      'SPK0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLKPKA
      *
N03  C                   CLOSE     AVFRHCOP
N03  C                   CLOSE     AVFRDL01C
N03  C                   MOVE      'N'           feil
N06  c     WSDABA        ifeq      *blanks
N06  C                   MOVE      FILIBF        WSDABA
N06  C                   end
s08  C*    *IN45         ifeq      '0'
N08  C     *IN45         ifeq      '1'
N08  C     WSKOPKU       oreq      'J'
N03  C                   CALL      'SYPO09COP'
N03  C                   PARM                    WSDABA
N03  C                   PARM                    FEIL              1
N08  C                   END
S08  C*                  ELSE
N08  C     *IN47         ifeq      '1'
N08  C     WSKOPLE       oreq      'J'
N03  C                   CALL      'SYPO09COPB'
N03  C                   PARM                    WSDABA
N03  C                   PARM                    FEIL              1
N06  C                   END
N03  C                   OPEN      AVFRHCOP
N03  C                   OPEN      AVFRDL01C
N03  C     FEIL          IFEQ      'J'
N03  C                   MOVE      'SHU1419'     MSGNR
N03  C                   SETON                                        3097
N03  C                   GOTO      SLKPKA
N03  C                   END
S03  C*    KPKUNR        SETLL     AVFRH
S03  C*    KPKUNR        READE     AVFRH                                  98
N03  C     KPKUNR        SETLL     AVFRHCOP
N03  C     KPKUNR        READE     AVFRHCOP                               98
     C   98              MOVE      'SPK0033'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLKPKA
      *
      * SLETT GAMLE AVTALER TIL KUNDE (WSKUND)
     C     WSBEHO        IFNE      'J'
     C     WSKUND        SETLL     AVFRH
     C                   SETOFF                                       33
     C     STKKS         TAG
     C     WSKUND        READE     AVFRH                                  33
     C  N33              DO
     C     AFAVNR        SETLL     AVFRDL01
     C                   SETOFF                                       34
     C     STKKS2        TAG
     C     AFAVNR        READE     AVFRDL01                               34
     C  N34              DELETE    AVFRDR
     C  N34              GOTO      STKKS2
     C                   DELETE    AVFRHR
     C                   GOTO      STKKS
     C                   END
     C                   END
      *
      * KOPIER AVTALER FRA KUNDE (KPKUNR) TIL KUNDE (WSKUND)
s03  C*    KPKUNR        SETLL     AVFRH
N03  C     KPKUNR        SETLL     AVFRHCOP
     C                   SETOFF                                       33
     C     STKKK         TAG
s03  C*    KPKUNR        READE     AVFRH                                  33
N03  C     KPKUNR        READE     AVFRHCOP                               33
     C  N33              DO
S03  C*                  UPDATE    AVFRHR
      * Behold avtalenr som skal kopieres
     C                   MOVE      AFAVNR        XAVNR             9 0
      * Hent nytt avtalenr.
     C     'A'           CHAIN     AVFRT                              34
     C                   ADD       1             AVTELL
     C                   UPDATE    AVFRTR
     C                   MOVE      AVTELL        AFAVNR
      * Behold nytt avtalenr.
     C                   MOVE      AFAVNR        XAVNR2            9 0
      * Lag ny avtale med kundenr = WSKUND
     C                   MOVE      WSKUND        AFKUND
     C                   WRITE     AVFRHR
      * Lag nye detaljelinjer med avtalenr = XAVNR2
s03  C*    XAVNR         SETLL     AVFRDL01
N03  C     XAVNR         SETLL     AVFRDL01C
     C     STKKK2        TAG
S03  C*    XAVNR         READE     AVFRDL01                               34
N03  C     XAVNR         READE     AVFRDL01C                              34
     C  N34              DO
S03  C*                  UPDATE    AVFRDR
     C                   MOVE      XAVNR2        AFAVNR
     C                   WRITE     AVFRDR
     C                   GOTO      STKKK2
     C                   END
     C                   GOTO      STKKK
     C                   END
      *
     C     SLKPKA        ENDSR
      *
     C***********************************************
     C     KPKAV2        BEGSR
     C***********************************************
     C                   move      *blanks       cde1              1
      * KOPIERER EN ENKELTAVTALE
      *
      * Behold avtalenr som skal kopieres
     C                   MOVE      AFAVNR        XAVNR             9 0
      * Hent nytt avtalenr.
     C     'A'           CHAIN     AVFRT                              34
     C                   ADD       1             AVTELL
     C                   UPDATE    AVFRTR
     C                   MOVE      AVTELL        AFAVNR
      * Behold nytt avtalenr.
     C                   MOVE      AFAVNR        XAVNR2            9 0
     C     SNU           IFEQ      'J'
     c     afbfr2        ifeq      'T'
     c     afgeby        ifeq      'FR2'
     c                   move      'FR1'         afgeby
     c                   end
     c                   move      'T'           afbfr1
     c                   move      ' '           afbfr2
     C                   move      'F'           cde1              1
     c                   else
     c     afbfr1        ifeq      'T'
     c     afgeby        ifeq      'FR1'
     c                   move      'FR2'         afgeby
     c                   end
     c                   move      'T'           afbfr2
     c                   move      ' '           afbfr1
     C                   move      'V'           cde1              1
     c                   end
     c                   end
     C                   MOVE      AFLKTI        XXLKTI            2
     C                   MOVE      AFPNT1        XXPNT1            5
     C                   MOVE      AFPNT2        XXPNT2            5
     C                   MOVE      AFLKFR        AFLKTI
     C                   MOVE      AFPNF1        AFPNT1
     C                   MOVE      AFPNF2        AFPNT2
     C                   MOVE      XXLKTI        AFLKFR
     C                   MOVE      XXPNT1        AFPNF1
     C                   MOVE      XXPNT2        AFPNF2
     C                   END
     C                   WRITE     AVFRHR
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   WRITE     SUBCTL
      * Lag nye detaljelinjer med avtalenr = XAVNR2
     C     XAVNR         SETLL     AVFRDL01
     C     STK2          TAG
     C     XAVNR         READE(N)  AVFRDL01                               34
     C  N34              DO
     C                   MOVE      XAVNR2        AFAVNR
     c     cde1          ifne      *blanks
     c                   move      cde1          afcde1
     c                   end
     C                   WRITE     AVFRDR
     C                   GOTO      STK2
     C                   END
     C                   EXSR      MOVPRW
     C     ZRECNO        CHAIN     SUBFIL                             40
     C                   MOVE      ' '           WSNR
     C                   SETON                                        40
     C                   EXSR      ENDRE
     C                   ENDSR
      *
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSAKDG        UDT1              2 0
     C                   MOVE      WSAKMN        UDT2              2 0
     C                   MOVE      WSAKAR        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSAKDG
     C                   MOVE      UDT2          WSAKMN
     C                   MOVE      UDT3          WSAKAR
      *
     C                   MOVE      WSGJDG        UDT1
     C                   MOVE      WSGJMN        UDT2
     C                   MOVE      WSGJAR        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSGJDG
     C                   MOVE      UDT2          WSGJMN
     C                   MOVE      UDT3          WSGJAR
     C*
     C                   ENDSR
     C*
