********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 merknad til transportør fra DOK36
10XXX * 02 JOV PTF10 heur manglet ved eksport
10XXX * 03 JOV PTF10 HEPOS blanket for tidlig
10007 * 04 YBC PTF10 EKSTRA PARAMETER FOR KALL PÅ SYTR40CB
10007 * 05 sh  PTF10 cursor posr
10007 * 06 jov PTF10 også TURnr på G-notis / bedre T&T-loggtekst
10007 * 07 jov PTF10 også dup fra fraktbrev skal til INNGÅENDE avd ved Eksp-foppdrag
10007 * 08 jov PTF10 REminder om ikke Esedning ved henting/eksport er klargjort
10007 * 09 jov PTF10 Dro med VAL-kode og oljetill fra mor-oppdrag ved utkj.oppdrag  !!!!
10007 * 10 jov PTF10 Fra-sted fra avsender ved henting, MER INFO TIL NOTISBLOKK
10007 * 11 jov PTF10 'X' = lest i eget felt i stedt for . sist i tekst ved firtekst /Godsnr
10007 * 12 sh  PTF10 logikk rundt heknt
      * 13 JOV PTF10 R29-(melding til kunde KUN til fritekst R ), sikre FRTLES ' ' på Glinjer
      * 14 JOV PTF10 Bestillende oppdrag/frbr inn i fri søkevei FFR-Freight forwarders ref
      * 15 SH  PTF10 Hedtr skal alltid være udate
      * 16 SH  PTF10 nye parametre syge03
10XXX * 17 YBC PTF10 FEIL LENGDE PÅ QDA04
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 18 JOV PTF10 TTTEXL   i T&T
10XXX * 19 SH  PTF11 skriver dokufv record hvis finnes på hovedoppdrag
10XXX * 20 JOV PTF11 feil i REF-Felt-lengde
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 21 JOV PTF11 aVD.OPPSLAG VIA NOPNR
********************************************************************
N19  FDOKUFV    IF A E           K DISK
     FDISP      UF A E           K DISK
     FHEADF     UF A E           K DISK
     FZEADF     O    E           K DISK
     F                                     RENAME(HEADFR:ZEADFR)
     FZREETXT   O    E           K DISK
     F                                     RENAME(FREETXTR:ZREETX2R)
     FZTELL     UF   E           K DISK
     FHESTED    O  A E             DISK
     FMULTKODT  IF   E           K DISK
     FKUFAST    IF   E           K DISK
     FKODTD     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FSTED2D    IF   E           K DISK
     F                                     RENAME(STED2R:STEDDR)
     FTELL      UF   E           K DISK
     FFAKT      UF A E           K DISK
     FKOSTT     UF A E           K DISK
     FKOSBU     UF A E           K DISK
     FFREETXT2  IF A E           K DISK
     FTRACKF    O  A E           K DISK
     FTRACKL02  IF   E           K DISK
     F                                     RENAME(TRACKFR:TTR2)
     FTRACKT    O  A E           K DISK
     FKODTRI    IF   E           K DISK
N21  FNOPNR     IF   E           K DISK
     FDOKUF     UF   E           K DISK
     FTRAN      IF   E           K DISK
     FFRISOK    IF A E           K DISK
     FKODFRI    IF   E           K DISK
     FDOK29     IF   E           K DISK
N01  FDOK36     IF   E           K DISK
     FDOKUFM    UF A E           K DISK
     FSYTR11FM  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D*
     D AA              S              1    DIM(15)
     D AB              S              1    DIM(15)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      * CURSOR LOKASJON AV AKTIV VINDU
     D  WSCLOW               382    383B 0
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  UUSR                 254    263
     D                 DS
     D  US                     1     60
     D                                     DIM(6)
     D  KODUS1                 1     10
     D  KODUS2                11     20
     D  KODUS3                21     30
     D  KODUS4                31     40
     D  KODUS5                41     50
     D  KODUS6                51     60
     D                 DS
     D  DFBREF                 1     17
     D  DFBRTX                 1      5
     D  DFBRAV                 6      9
     D  DFBRST                10     10
     D  DFBROP                11     17
     D                 DS
     D  ØN151                  1     15  1
     D  ØA151H                 1     14
     D  ØA151X                 5     14
     D  ØA151D                15     15
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D  ØA152T                15     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)
     D                 DS
     D  DSTXT                  1     35
     D  DSTXTA                 1     12
     D  DSAVD                 14     17  0
     D  DSTXTB                18     18
     D  DSOPD                 19     25  0
     D  HESDF                 27     31
     D  DSTXTC                32     32
     D  HESDT                 33     37
     D                 DS
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  HEDTD2                 1      2  0
     D  HEDTM2                 3      4  0
     D  HEDTÅ2                 5      6  0
     D  HEDT2                  1      6  0
      * HJELPE-DS FOR Å HENTE INN ÅÅMMDD-DATO
     D                 DS
     D  XXDTÅ                  1      2  0
     D  XXDTM                  3      4  0
     D  XXDTD                  5      6  0
     D  XXDT                   1      6  0
      *
      * BEHOLDER NAVN PÅ DATOVARIABLE LIKT SOM I SYTR10 SELV
      * OM DETTE BLIR LITT UNATURLIGE NAVN....:
      *
      * DATO1 = WSSDFD(DDMMÅÅ) = UDATOA(ÅÅÅÅMMDD) = FORFRAKT FRA
      * DATO2 = WSSDTD(DDMMÅÅ) = UDATOB(ÅÅÅÅMMDD) = VIDEREFRAKT TIL
      * DATO3 = WSSFFD(DDMMÅÅ) = UDATOC(ÅÅÅÅMMDD) = FORFRAKT TIL
      * DATO4 = WSSVTD(DDMMÅÅ) = UDATOD(ÅÅÅÅMMDD) = VIDEREFRAKT FRA
      *
     D                 DS
     D  WSDTD1                 1      2  0
     D  WSDTM1                 3      4  0
     D  WSDTÅ1                 5      6  0
     D  WSSDFD                 1      6  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSSDTD                 1      6  0
     D                 DS
     D  WSDTD3                 1      2  0
     D  WSDTM3                 3      4  0
     D  WSDTÅ3                 5      6  0
     D  WSSFFD                 1      6  0
     D                 DS
     D  WSDTD4                 1      2  0
     D  WSDTM4                 3      4  0
     D  WSDTÅ4                 5      6  0
     D  WSSVTD                 1      6  0
     D                 DS
     D  UDT3A                  1      4  0
     D  UDT2A                  5      6  0
     D  UDT1A                  7      8  0
     D  UDATOA                 1      8  0
     D                 DS
     D  UDT3B                  1      4  0
     D  UDT2B                  5      6  0
     D  UDT1B                  7      8  0
     D  UDATOB                 1      8  0
     D                 DS
     D  UDT3C                  1      4  0
     D  UDT2C                  5      6  0
     D  UDT1C                  7      8  0
     D  UDATOC                 1      8  0
     D                 DS
     D  UDT3D                  1      4  0
     D  UDT2D                  5      6  0
     D  UDT1D                  7      8  0
     D  UDATOD                 1      8  0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  DFPROK                 1      5
     D  DFPROK1_3              1      3
     D  DFPROK4                4      4
     D* DEFINERING AV ALFA-VARIABLER SOM ER PÅ OVER 256 TEGN
     D MSGTXT          DS          1024
     D MSGTX2          DS          1024
     D CMD             DS          1024
     D*
     D* DEFINERING AV TEKSTKONSTANTER - FOR "DUPMELDING"
     D* OBS - når flere linjer: avslutt med - (strek) UTEN appostrof,
     D*       hver ny dellinje må BEGYNNE med appostrof
     D*       Siste dellinje må slutte med appostrof
     D                 DS
     D TXT1FF          C                   CONST('Internt innhentings-
     D                                     oppdrag er mottatt -
     D                                     fra megler')
     D TXT1VF          C                   CONST('Internt utkjørings-
     D                                     oppdrag er mottatt -
     D                                     fra megler')
     D TXT2            C                   CONST('Aksepteres -
     D                                     oppdraget ?')
     D CMD1            C                   CONST('SNDMSG MSG(')
     D CMD2            C                   CONST(') TOMSGQ(')
     D CMD3            C                   CONST(') MSGTYPE(*INQ)')
     D                 DS            11
     D NUM             C                   CONST('1234567890 ')
     D DSDUP           C                   CONST('     *DUP*')
     D                 DS
     D  QDATA                  1    109
     D  QDA01                  1      2
     D  QDA02                  3      6
     D  QDA03                  7     13
S17  D* QDA04                 14     14
N17  D  QDA04                 14     15
     D  QDA05                 16     16
     D  QDA06                 17     20
     D  QDA07                 21     24
     D  QDA08                 25     26
     D  QDA09                 27     28
     D  QDA10                 29     29
     D  QDA11                 30     30
     D  QDA12                 31     37
     D  QDA13                 38     38
     D  QDA14                 39    100
     D  QDA15                101    101
     D  QDA16                102    102
     D  QDA17                103    103
     D  QDA18                104    109
      * DS FOR DEFAULTTEKST INNH/UTKJØRING
     D CFT1            C                   CONST('INNHENTING')
     D CFT2            C                   CONST('->')
     D CVT1            C                   CONST('UTKJØRING ')
     D CVT2            C                   CONST('->')
      * INNH.
     D                 DS
     D  DSFFTX                 1     35
     D  DSFT1                  1     10
     D  DXPNS1                12     21
     D  DSFT2                 23     24
     D  DXPNS3                26     35
      * UTKJ.
     D                 DS
     D  DSVFTX                 1     35
     D  DSVT1                  1     10
     D  DXPNS4                12     21
     D  DSVT2                 23     24
     D  DXPNS2                26     35
     C*
     C                   EXSR      INIT
     C*
     C     UUVIS         IFEQ      'J'
     C                   OPEN      SYTR11FM                             99
     C   99              EVAL      UUVIS='N'
     C                   EXSR      DUPLIK
     C  N99              CLOSE     SYTR11FM
     C                   ELSE
     C                   EXSR      DUPLIK
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UUAVD             4 0
     C                   PARM                    UUOPD             7 0
     C                   PARM                    UUFBNR            3 0
     C                   PARM                    UUVIS             1
N15  C                   TIME                    XULTID
N15  C                   MOVE      XULDD         ULDD
N15  C                   MOVE      XULMM         ULMM
N15  C                   MOVE      XULÅÅ         ULÅÅ
     c                   move      'N'           ELTRON            1
     c     UUVIS         ifeq      'E'
     c                   move      'J'           ELTRON
     c                   move      'N'           UUVIS
     c                   end
     C                   MOVE      UUAVD         WSAVD             4 0
     C                   MOVE      UUOPD         WSOPD             7 0
     C                   MOVE      UUFBNR        WSFBNR            3 0
      *
     C* Appostrof inn i variabel via bitmanipulering
     C                   BITON     '123457'      APP               1
     C                   BITOFF    '06'          APP
     C                   MOVE      *ZEROS        ØN152
     C                   MOVE      *ZEROS        ØN151
     C     *LIKE         DEFINE    WSAVD         AVDZER
     C                   MOVE      *ZEROS        AVDZER
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      *ZEROS        WSSDFD
     C                   MOVE      *ZEROS        WSSDTD
     C                   MOVE      *ZEROS        WSSFFD
     C                   MOVE      *ZEROS        WSSVTD
      *
     C     HEADFK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     FFKEY         KLIST
     C                   KFLD                    WSAVD1
     C                   KFLD                    WSOPD1
     C     VFKEY         KLIST
     C                   KFLD                    WSAVD2
     C                   KFLD                    WSOPD2
     C     FFFAKK        KLIST
     C                   KFLD                    WSAVD1
     C                   KFLD                    WSOPD1
     C                   KFLD                    XXFALI            5 0
     C     VFFAKK        KLIST
     C                   KFLD                    WSAVD2
     C                   KFLD                    WSOPD2
     C                   KFLD                    XXFALI
     C     KODOTF        KLIST
     C                   KFLD                    XOTUNI
     C                   KFLD                    WSOTFF
     C     KODOTV        KLIST
     C                   KFLD                    XOTUNI
     C                   KFLD                    WSOTVT
     C     KODO2F        KLIST
     C                   KFLD                    XO2UNI
     C                   KFLD                    WSOTFF
     C     KODO2V        KLIST
     C                   KFLD                    XO2UNI
     C                   KFLD                    WSOTVT
     C                   MOVE      'OTY'         XOTUNI            3
     C                   MOVE      'O2Y'         XO2UNI            3
     C     KODFRF        KLIST
     C                   KFLD                    XFRUNI
     C                   KFLD                    WSFRFF
     C     KODFRV        KLIST
     C                   KFLD                    XFRUNI
     C                   KFLD                    WSFRVT
     C                   MOVE      'FR'          XFRUNI            2
     C     KODTAK        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    WSAVD
     C                   MOVE      'A'           XAUNI             1
     C     KODTA1        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    WSAVD1
     C                   MOVE      'A'           XAUNI             1
     C     KODTA2        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    WSAVD2
     C                   MOVE      'A'           XAUNI             1
     C     KUFASK        KLIST
     C                   KFLD                    YKFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'PRODTYPE'    YKFTYP
     C     *LIKE         DEFINE    KFTYP         YKFTYP
     C                   MOVE      'N'           UUPDAT            1
     C     WKSDF         KLIST
     C                   KFLD                    WSLANF
     C                   KFLD                    WSSDF
     C     WKSDT         KLIST
     C                   KFLD                    WSLANT
     C                   KFLD                    WSSDT
     C     FBRKEY        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    UUAVD
     C                   KFLD                    UUOPD
     C                   KFLD                    WSFBNR
     C                   Move      'F'           DFRI
     C     DOK29KEY      KLIST
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   KFLD                    WSFBNR
n19  C     DOKUFVKG      KLIST
n19  C                   KFLD                    FVRI
n19  C                   KFLD                    HEAVDG
n19  C                   KFLD                    HEOPDG
n19  C                   KFLD                    WSFBNR
n19  c                   KFLD                    FVLINR
n19  C                   MOVE      'F'           FVRI
n19  C                   Z-ADD     1             FVLINR
n19  C     DOKUFVKN      KLIST
n19  C                   KFLD                    FVRI
n19  C                   KFLD                    FVAVD
n19  C                   KFLD                    FVOPD
n19  C                   KFLD                    FVFBNR
n19  c                   KFLD                    FVLINR
     C     DOKFMKey      KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   KFLD                    XXFBNR            3 0
     C                   MOVE      'F'           FMRI
     C     TraKey        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    DFTRAN
     C     TEIKey        KLIST
     C                   KFLD                    UUAVD
     C                   KFLD                    UUOPD
     C                   KFLD                    TTFBNR
     C                   KFLD                    TTACTI
     C                   move      'TEI'         TTACTI
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      * FINN UT OM INNLAND BRUKES MED EN OG BARE EN TERMINAL..
     C                   MOVE      *ZEROS        XXTERM
     C     *LOVAL        SETLL     KODTRI
     C                   READ      KODTRI                                 33
     C  N33              MOVE      RITERM        XXTERM
     C     *IN33         DOWEQ     '0'
     C     RITERM        IFNE      XXTERM
     C                   MOVE      *ZEROS        XXTERM
     C                   GOTO      UTTERM
     C                   END
     C                   READ      KODTRI                                 33
     C                   END
     C     UTTERM        TAG
     C     KODRIK        KLIST
     C                   KFLD                    XXTERM            4 0
     C                   KFLD                    NUMPNR            4 0
      *
     C     HEADFK        CHAIN(N)  HEADF                              33
     C                   MOVE      HEUR          WFRAUR            1
     C     HEUR          IFEQ      'C'
S20  C*                  MOVE      HERFA         WFRARF           15
N20  C                   MOVEL     HERFA         WFRARF           35
     C                   ENDIF
     C     HEUR          IFEQ      'D'
s20  C*                  MOVE      HEGN          WFRARF
N20  C                   MOVEL     HEGN          WFRARF
     C                   ENDIF
     C                   MOVE      HEDTD         HEDTD2
     C                   MOVE      HEDTM         HEDTM2
     C                   MOVE      HEDTÅ         HEDTÅ2
      * NÅ ER DS "HEDT" ÅÅMMDD,  DS "HEDT2" = DDMMÅÅ
N06  C                   move      HEPRO         GMTURA            8
      *
      * Ved eksport - basert på fraktbrev - hent inngående avd.
     C                   SELECT
     C     HEUR          WHENEQ    'B'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'J'           EXPORT            1
     C     HEUR          WHENEQ    'H'
     C     HETRI         ANDNE     '  '
     C     HETRI         ANDNE     FILAND
     C                   MOVE      'J'           EXPORT
     C                   OTHER
     C                   MOVE      'N'           EXPORT
     C                   ENDSL
      * ANTALL (FOR PTINT AV MERKELAPPER
     C     WSFBNR        IFNE      *ZEROS
      *
      * SIKRE LANDKODE
      *
     C                   MOVE      FILAND        WSLANF
     C                   MOVE      FILAND        WSLANT
     C                   MOVE      FILAND        WSLAN2
     C                   MOVE      FILAND        WSLAN1
      *
     C     FBRKey        Chain(N)  DOKUF                              33
     c  N33              z-add     DFNT          HENT
      * Via Fr.brev - Terminal kan være angitt på transportør i max snr)
     C     TraKey        chain     TRAN                               33
     c     *in33         ifeq      *OFF
     c     VMRECM        andne     *zeros
     c                   z-add     VMRECM        XXTERM
     C                   END
     C                   END
      *
     C* HENT AVDELINGSVERDIER BESTILLENDE!!!  AVD
     C     KODTAK        CHAIN     KOAR                               33
     C* POSTNUMMERBASERT FRAKTANGIVELSE ???
     C     KOAPOS        COMP      'J'                                    43
     C* ANTAR at mottakende avd er postal (innland)
     C                   MOVE      *ON           *IN42
      *
      * FINN KUNDENR FOR "OPPDRAGSGIVER" I BESTILLENDE OPPDRAG
      * X PÅ KJØPERSIDE --> SELGER??
     C     HEKDFK        IFEQ      'X'
     C     HEKDFS        ANDNE     'X'
     C     HEKNS         IFNE      *ZEROS
     C                   MOVE      HEKNS         OPDGIV
     C                   ELSE
     C                   MOVE      HEKNSF        OPDGIV
     C                   END
     C                   END
      * X PÅ SELGERSIDE --> KJØPER??
     C     HEKDFS        IFEQ      'X'
     C     HEKDFK        ANDNE     'X'
     C     HEKNK         IFNE      *ZEROS
     C                   MOVE      HEKNK         OPDGIV
     C                   ELSE
     C                   MOVE      HEKNKF        OPDGIV
     C                   END
     C                   END
      *
     C* ANTAR AT UTFØRENDE DISTRIB.AVDELING ER EN INNLANDSAVD.
     C* OG ARBEIDER POSTNUMMER-BASERT
      *
      * VED EKSPORT ER DET SANSYNLIGVIS INNHENTING SOM SKAL UTFØRES....
      *            FF'S TILSTED - FORESLÅ POSTNR "BAK" OPPDRAGS FRASTED
      *            FF'S FRASTED - SANSYNLIGVIS POSTNR I HENTEADR
     C     TROPD1        IFEQ      *ZEROS
     C     HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      FILAND        WSLANF
     C                   MOVE      FILAND        WSLAN1
     C     HEUR          IFEQ      'B'
     C     *IN43         ANDEQ     '1'
     C                   MOVE      HESDF         WSSDFF
     C                   ELSE
     C     HESDF         CHAIN     STED2                              33
     C     *IN33         IFEQ      '0'
     C     ST2PNR        ANDNE     *ZEROS
     C                   MOVE      ST2PNR        TSTPNR
     C                   MOVEL     TSTPNR        WSSDFF
     C                   END
     C                   END
     C                   MOVEL     HEADS3        TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C   33              MOVEL     TSTPNR        WSSDF
     C                   MOVE      HEDT2         WSSDFD
     C                   MOVE      HEDT2         WSSFFD
     C*                    MOVE HEOT      WSOTFF
     C                   MOVE      HEFR          WSFRFF
     C     WSURF         IFEQ      *BLANKS
     C                   MOVE      'H'           WSURF
     C                   ENDIF
     C*                    MOVE HEKDPL    WSPKFF
     C                   MOVE      HENAK         WSLNAV
     C                   MOVE      HEADK1        WSLAD1
     C                   MOVE      HEADK2        WSLAD2
     C                   MOVE      HEADK3        WSLAD3
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     5             POSNBR
      * OPDGIV FREMDELES UDEFINERT - EKSPORT VELG AVSENDER
     C     OPDGIV        IFEQ      *ZEROS
     C     HEKNS         IFNE      *ZEROS
     C                   MOVE      HEKNS         OPDGIV
     C                   ELSE
     C                   MOVE      HEKNSF        OPDGIV
     C                   END
     C                   END
      *
     C                   END
     C                   END
      *
      *
      * VED IMPORT ER DET SANSYNLIGVIS UTKJØRING SOM SKAL UTFØRES....
      *            VF'S FRASTED - FORESLÅ POSTNR "BAK" OPPDRAGS TILSTED
      *            VF'S TILSTED - SANSYNLIGVIS POSTNR I LEV.ADR
     C     TROPD2        IFEQ      *ZEROS
     C     HEUR          IFEQ      'A'
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVE      FILAND        WSLAN2
     C                   MOVE      FILAND        WSLANT
     C     HEUR          IFEQ      'A'
     C     *IN43         ANDEQ     '1'
     C                   MOVE      HESDT         WSSDVT
     C                   ELSE
     C     HESDT         CHAIN     STED2                              33
     C     *IN33         IFEQ      '0'
     C     ST2PNR        ANDNE     *ZEROS
     C                   MOVE      ST2PNR        TSTPNR
     C                   MOVEL     TSTPNR        WSSDVT
     C                   END
     C                   END
     C                   MOVEL     HEADK3        TSTPNR            4
     C                   TESTN                   TSTPNR               33
     C   33              MOVEL     TSTPNR        WSSDT
     C                   MOVE      HEDT2         WSSVTD
     C                   MOVE      HEDT2         WSSDTD
     C*                    MOVE HEOT      WSOTVT
     C                   MOVE      HEFR          WSFRVT
     C     WSURE         IFEQ      *BLANKS
     C                   MOVE      'H'           WSURE
     C                   ENDIF
     C*                    MOVE HEKDPL    WSPKVT
     C* Innland benyttes - en terminal
     C     XXTERM        IFNE      *ZEROS
     C                   MOVE      'IN'          WSOTVT
     C                   MOVE      'S  '         WSFRVT
     C                   MOVE      ' '           WSMLVT
     C                   Z-add     HENT          WSNTKL
     C                   end
     C                   MOVE      HENAS         WSHNAV
     C                   MOVE      HEADS1        WSHAD1
     C                   MOVE      HEADS2        WSHAD2
     C                   MOVE      HEADS3        WSHAD3
     C                   Z-ADD     14            LINNBR
s05  C*                  Z-ADD     49            POSNBR
n05  C                   Z-ADD     46            POSNBR
      * OPDGIV FREMDELES UDEFINERT - IMPORT  VELG MOTTAKER
     C     OPDGIV        IFEQ      *ZEROS
     C     HEKNK         IFNE      *ZEROS
     C                   MOVE      HEKNK         OPDGIV
     C                   ELSE
     C                   MOVE      HEKNKF        OPDGIV
     C                   END
     C                   END
      *
     C                   END
     C                   END
      *
     C     OPDGIV        IFEQ      *ZEROS
     C                   MOVE      KOAKNR        OPDGIV            8 0
     C                   END
      * Dersom ønskelig (hardkodet) kan innlandsoppdrag få status E=Esending
      *  men ikke dersom morsending har T&T med TERMINAL INN (på fraktbr eller hele)

     C                   MOVE      'N'           Esending          1
N08   * DERSOM er åpne for esendinger er det IKKE vanlig ved eksport/henting (også også TRmod??)
XX   C*    HEUR          IFNE      'B'
XX   C*    HEUR          ANDNE     'D'
XX   C*    HEUR          ANDNE     'G'
XX   C*                  MOVE      'N'           Esending          1
XX   C*                  ENDIF
     C     Esending      IFEQ      'J'
     C     TEIkey        chain     TRACKL02                           33
     C   33              MOVE      UUFBNR        TTFBNR
     C   33TEIkey        chain     TRACKL02                           33
     C     *in33         ifeq      '0'
     C                   move      'N'           Esending
     c                   else
      * VERDIER FOR FRI SØKEVEI FOR Å BINDE SAMMEN  "ESENDINGER"
     C                   move      HEPRO         GMTURA            8
     C                   movel     HEHAWB        GMBILA            8
      * BESTILLEND AVDELINGS KUNDENR
     C                   MOVE      KOAKNR        GMOPDGIV          8
     c                   end
     C                   END
     C**                   WRITEWINDOWSZ
      *
     C                   ENDSR
      *
      *
      *
     C***********************************************
     C     DUPLIK        BEGSR
     C***********************************************
      *
     C                   MOVE      'N'           WZlagHO           1
     C                   MOVE      *BLANKS       XXNAS            30
     C     STDUP0        TAG
     C                   MOVE      'N'           DUPOPD            1
     C                   MOVE      XNYGML        YNYGML            2
     C     KEYTRG        KLIST
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   MOVE      WSAVD         HEAVDG            4 0
     C                   MOVE      WSOPD         HEOPDG            7 0
     C                   MOVE      HESG          HESGG             3
     C                   MOVE      TRAVD1        WSAVD1
     C                   MOVE      TROPD1        WSOPD1
     C                   MOVE      TRAVD2        WSAVD2
     C                   MOVE      TROPD2        WSOPD2
      * HENT INFO OM UTFØRT DUP HVIS PÅ FR.BR.NIVÅ
     C     WSFBNR        IFNE      *ZEROS
     C     FBRKey        Chain(N)  DOKUF                              33
     c  N33              z-add     DFNT          HENT
     C     *IN33         IFEQ      '0'
     C     DFBRTX        ANDEQ     'U.op:'
     C     DFBRAV        ANDGE     '0001'
     C     DFBRAV        ANDLE     '9999'
     C     DFBROP        ANDGE     '0000001'
     C     DFBROP        ANDLE     '9999999'
     C                   MOVE      DFBRAV        WSAVD2
     C                   MOVE      DFBROP        WSOPD2
     C                   END
     C                   END
      * 91 ON - FF ER TATT HÅND OM,  92 ON -VF ER TATT HÅND OM)
     C     WSAVD1        COMP      *ZEROS                             91
     C     WSAVD2        COMP      *ZEROS                             92
      *
      * Vis FRA/TIL... SAMT  pris på evt dupoppdrag
     C     *IN91         IFEQ      '1'
     C     FFKEY         CHAIN(N)  HEADF                              31
     C     *IN31         IFEQ      '0'
     C                   MOVE      HELKA         WSLANF
     C                   MOVE      HESDF         WSSDF
     C                   MOVE      TRSDFD        XXDT
     C                   MOVE      XXDTD         WSDTD1
     C                   MOVE      XXDTM         WSDTM1
     C                   MOVE      XXDTÅ         WSDTÅ1
     C                   MOVE      TRSDFK        WSSDFK
     C                   MOVE      HETRI         WSLAN1
     C                   MOVE      HESDT         WSSDFF
     C                   MOVE      TRSDTD        XXDT
     C                   MOVE      XXDTD         WSDTD3
     C                   MOVE      XXDTM         WSDTM3
     C                   MOVE      XXDTÅ         WSDTÅ3
     C                   MOVE      TRSDTK        WSSFFK
     C                   MOVE      HEOT          WSOTFF
     C                   MOVE      HEFR          WSFRFF
     C                   MOVE      HEUR          WSURF
     C                   MOVE      HEKDPL        WSPKFF
     C                   MOVE      HENAK         WSLNAV
     C                   MOVE      HEADK1        WSLAD1
     C                   MOVE      HEADK2        WSLAD2
     C                   MOVE      HEADK3        WSLAD3
     C                   MOVEL     HEHAWB        WSBNFF
     C                   MOVE      HEPRO         WSTUFF
     C                   MOVE      TRFRAK        WSFKFF
     C                   END
     C                   MOVE      *ZEROS        WSFFBL
     C     FFKEY         SETLL     FAKT
     C     FFKEY         READE(N)  FAKT                                   31
     C     *IN31         DOWEQ     '0'
      * Hent alle I-linjer fra oppdraget, untatt statistiske MOT-linjer
     C     FASK          IFEQ      'I'
     C     FAKDA         ANDNE     'I'
     C                   ADD       FABELN        WSFFBL
     C                   END
     C     FFKEY         READE(N)  FAKT                                   31
     C                   END
     C     WSURF         IFNE      'H'
     C                   MOVE      *ZEROS        WSFFBL
     C                   ENDIF
     C                   END
      * Vis FRA/TIL... SAMT  pris på evt dupoppdrag
     C     WSOPD2        IFNE      *ZEROS
     C     VFKEY         CHAIN(N)  HEADF                              31
     C     *IN31         IFEQ      '0'
     C                   MOVE      HELKA         WSLAN2
     C                   MOVE      HESDF         WSSDVT
     C                   MOVE      TRSDFD        XXDT
     C                   MOVE      XXDTD         WSDTD4
     C                   MOVE      XXDTM         WSDTM4
     C                   MOVE      XXDTÅ         WSDTÅ4
     C                   MOVE      TRSDFK        WSSVTK
     C                   MOVE      HETRI         WSLANT
     C                   MOVE      HESDT         WSSDT
     C                   MOVE      TRSDTD        XXDT
     C                   MOVE      XXDTD         WSDTD2
     C                   MOVE      XXDTM         WSDTM2
     C                   MOVE      XXDTÅ         WSDTÅ2
     C                   MOVE      TRSDTK        WSSDTK
     C                   MOVE      HEOT          WSOTVT
     C                   MOVE      HEFR          WSFRVT
     C                   MOVE      HEUR          WSURE
     C                   MOVE      HEKDPL        WSPKVT
     C                   MOVE      HENAS         WSHNAV
     C                   MOVE      HEADS1        WSHAD1
     C                   MOVE      HEADS2        WSHAD2
     C                   MOVE      HEADS3        WSHAD3
     C                   MOVEL     HEHAWB        WSBNVT
     C                   MOVE      HEPRO         WSTUVT
     C                   MOVE      TRFRAK        WSFKVT
     C                   END
     C                   MOVE      *ZEROS        WSVFBL
     C     VFKEY         SETLL     FAKT
     C     VFKEY         READE(N)  FAKT                                   31
     C     *IN31         DOWEQ     '0'
      * Hent alle I-linjer fra oppdraget, untatt statistiske MOT-linjer
     C     FASK          IFEQ      'I'
     C     FAKDA         ANDNE     'I'
     C                   ADD       FABELN        WSVFBL
     C                   END
     C     VFKEY         READE(N)  FAKT                                   31
     C                   END
     C     WSURE         IFNE      'H'
     C                   MOVE      *ZEROS        WSVFBL
     C                   ENDIF
     C                   END
      * Foreslå avd..
     c     *in92         Ifeq      *OFF
     c     XXTERM        ANDNE     *ZEROS
     c     WSLANT        ANDEQ     'NO'
     c     WSSDT         ANDNE     *BLANKS
     C                   exsr      getavd
     C                   END
      *
      * HENT OPP IGJEN BESTILLENDE OPPDRAG DERSOM DUP-INFO ER HENTET
     C     *IN91         IFEQ      '1'
     C     *IN92         OREQ      '1'
     C     KEYTRG        CHAIN(N)  HEADF                              31
      *
     C                   END
      * VIS NAVN...
     C                   MOVE      *BLANKS       XXPNS1
     C                   MOVE      *BLANKS       XXPNS2
     C                   MOVE      *BLANKS       XXPNS3
     C                   MOVE      *BLANKS       XXPNS4
     C     WSSDFF        IFNE      *BLANKS
     C     WSSDF         CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS1
     C     WSSDFF        CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS3
     C                   END
     C     WSSDVT        IFNE      *BLANKS
     C     WSSDVT        CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS4
     C     WSSDT         CHAIN     STED2                              35
     C  N35              MOVEL     ST2NVN        XXPNS2
     C                   END
      * LIGGER DET D-LINJER I NOTIS SOM SKAL OVERFØRES.....
     C     *IN91         IFEQ      '0'
     C     *IN92         OREQ      '0'
     C     KEYFTG        KLIST
     C                   KFLD                    HEAVDG
     C                   KFLD                    HEOPDG
     C                   KFLD                    FTKODG            1
     C                   MOVE      'D'           FTKODG
     C     KEYFTG        CHAIN     FREETXT2                           31
     C     *IN31         IFEQ      '0'
     C  N91              MOVE      'J'           WSFRD1
     C  N92              MOVE      'J'           WSFRD2
     C                   END
     C                   END
      *
      * Dup basert på fraktbrev - uten å vise bilde?
     C     *IN92         IFEQ      '0'
     C     WSFBNR        ANDNE     *ZEROS
     c                   exsr      getfbr
     C     UUVIS         CABNE     'J'           FbrDup
     c                   end
      *
     C     STDUP         TAG
     C                   IF        UUVIS = 'J'
     C                   EXSR      KDTFMT
     C     WSURF         IFEQ      ' '
     C                   MOVE      'H'           WSURF
     C                   ENDIF
     C     WSURE         IFEQ      ' '
     C                   MOVE      'H'           WSURE
     C                   ENDIF
     C                   EXFMT     BILDE03
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C   12              SETOFF                                       989192
     C   12              GOTO      UTDUPS
     C                   END
     C                   SETOFF                                       98
     C*
     C     *IN04         IFEQ      '1'
     C   91
     CAN 92              GOTO      STDUP
     C                   EXSR      SØKDUP
     C                   GOTO      STDUP
     C                   END
     C*
      * HVIS BEGGE ALT ER TATT HÅND OM - HOPP UT ETTER AT BILDE VIST.
     C   91
     CAN 92              GOTO      UTDUPS
      *
      * TEST DATO/KLOKKE-FELT
     C                   EXSR      TESTBI
     C   30              GOTO      STDUP
      *
     C*
     C* FORSØKER Å AVSLUTTE (MED STED GITT) UTEN Å PLASSERE PÅ AVD
     C*
     C  N91WSAVD1        IFEQ      *ZEROS
     C     WSSDF         IFNE      *BLANKS
     C     WSSDFF        ORNE      *BLANKS
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     5             POSNBR
     C                   MOVE      'JOV0801'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   ELSE
      * ELLER MED GITT AVDELING UTEN Å SETTE STED/DATO
     C     WSSDF         IFEQ      *BLANKS
     C     WSSDFF        OREQ      *BLANKS
     C     WSLANF        OREQ      *BLANKS
     C     WSLAN1        OREQ      *BLANKS
     C     WSSDFD        OREQ      *ZEROS
     C     WSSFFD        OREQ      *ZEROS
     C                   Z-ADD     5             LINNBR
     C                   SELECT
     C     WSLANF        WHENEQ    *BLANKS
     C                   Z-ADD     16            POSNBR
     C     WSSDF         WHENEQ    *BLANKS
     C                   Z-ADD     19            POSNBR
     C     WSSDFD        WHENEQ    *ZEROS
     C                   Z-ADD     26            POSNBR
     C     WSLAN1        WHENEQ    *BLANKS
     C                   Z-ADD     48            POSNBR
     C     WSSDFF        WHENEQ    *BLANKS
     C                   Z-ADD     51            POSNBR
     C     WSSFFD        WHENEQ    *ZEROS
     C                   Z-ADD     58            POSNBR
     C                   ENDSL
     C                   MOVE      'JOV0800'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
      *
     C  N92WSAVD2        IFEQ      *ZEROS
     C     WSSDVT        IFNE      *BLANKS
     C     WSSDT         ORNE      *BLANKS
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     49            POSNBR
     C                   MOVE      'JOV0801'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   ELSE
      * ELLER MED GITT AVDELING UTEN Å SETTE STED/DATO
     C     WSSDVT        IFEQ      *BLANKS
     C     WSSDT         OREQ      *BLANKS
     C     WSLAN2        OREQ      *BLANKS
     C     WSLANT        OREQ      *BLANKS
     C     WSSVTD        OREQ      *ZEROS
     C     WSSDTD        OREQ      *ZEROS
     C                   Z-ADD     12            LINNBR
     C                   SELECT
     C     WSLAN2        WHENEQ    *BLANKS
     C                   Z-ADD     16            POSNBR
     C     WSSDVT        WHENEQ    *BLANKS
     C                   Z-ADD     19            POSNBR
     C     WSSVTD        WHENEQ    *ZEROS
     C                   Z-ADD     26            POSNBR
     C     WSLANT        WHENEQ    *BLANKS
     C                   Z-ADD     48            POSNBR
     C     WSSDT         WHENEQ    *BLANKS
     C                   Z-ADD     51            POSNBR
     C     WSSDTD        WHENEQ    *ZEROS
     C                   Z-ADD     58            POSNBR
     C                   ENDSL
     C                   MOVE      'JOV0800'     MSGNR2
     C                   SETON                                        30
     C                   GOTO      STDUP
     C                   END
     C                   END
     C*
      * overføres til avd som skal via z-filer ???
     C                   MOVE      'N'           WZFIL             1
     C                   MOVE      'N'           WZSNUVF           1
      * FF
     C  N91WSAVD1        IFNE      0
     C     KODTA1        CHAIN     KOAR                               31
     C     *IN31         IFEQ      *OFF
     C                   MOVE      KOANVN        WAVD5             5
     C     WAVD5         IFEQ      '*DUP*'
     C                   MOVE      KOAKNR        WAVD1KN           8 0
     C                   MOVE      'J'           WZFIL             1
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * VF
     C  N92WSAVD2        IFNE      0
     C     KODTA2        CHAIN     KOAR                               31
     C     *IN31         IFEQ      *OFF
     C                   MOVE      KOANVN        WAVD5             5
     C     WAVD5         IFEQ      '*DUP*'
     C                   MOVE      KOAKNR        WAVD2KN           8 0
     C                   MOVE      'J'           WZFIL             1
     C     WAVD2KN       IFEQ      HEKNKF
     C                   MOVE      'J'           WZSNUVF
     C                   end
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Bestillende avdeling (hent kundenr for fraktyavtale mm)
     C     KODTAK        CHAIN     KOAR                               33
     C*
     C                   MOVE      'N'           DIN03             1
     C                   MOVE      'N'           DIN05             1
     C   03              MOVE      'J'           DIN03
     C   05              DO
     C                   MOVE      'J'           XIN05             1
     C                   SETON                                        03
     C                   SETOFF                                       05
     C                   MOVE      'J'           DIN03             1
     C                   END
      *
     C                   MOVEL     XXPNS1        DXPNS1           10
     C                   MOVEL     XXPNS2        DXPNS2           10
     C                   MOVEL     XXPNS3        DXPNS3           10
     C                   MOVEL     XXPNS4        DXPNS4           10
     C*
     C* OPPDATERER FORTRANSPORT DUPLIKATOPPDRAG
     C*
     C  N91WSAVD1        IFNE      *ZEROS
     C     WZFIL         IFEQ      'J'
     C                   Z-ADD     0             WSOPD
     C                   ELSE
     C     WSAVD1        CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   ENDIF
     C* DATA SOM SKAL BYTTES
     C                   MOVE      WSOTFF        HEOT
     C                   MOVE      WSFRFF        HEFR
     C                   MOVE      WSPKFF        HEKDPL
     C                   MOVE      WSLNAV        HENAK
     C                   MOVE      WSLAD1        HEADK1
     C                   MOVE      WSLAD2        HEADK2
     C                   MOVE      WSLAD3        HEADK3
     C                   MOVE      WSSDF         HESDF
     C                   MOVE      WSLANF        HELKA
     C                   MOVE      UDATOA        TRSDFD
     C                   MOVE      WSSDFK        TRSDFK
     C                   MOVE      WSSDFF        HESDT
     C                   MOVE      WSLAN1        HETRI
     C                   MOVE      UDATOC        TRSDTD
     C                   MOVE      WSSFFK        TRSDTK
     C                   MOVE      *BLANKS       HELKS
     C                   MOVE      *BLANKS       HELKK
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVE      *ZEROS        TRSFFD
     C                   MOVE      *ZEROS        TRSFFK
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVE      *ZEROS        TRSVTD
     C                   MOVE      *ZEROS        TRSVTK
     C                   MOVE      'N'           TRMVA
     C                   MOVE      *ZEROS        HEPRO
S03  C*                  MOVE      *BLANKS       HEPOS1
S03  C*                  MOVE      *ZEROS        HEPOS2
     C*
S15  C*                  MOVE      UDATOA        HEDTR
N15  C                   MOVE      ULDT          HEDTR
     C                   MOVE      UDATOA        HEDTOP
     C                   MOVE      WSOPD         HEOPD
     C                   MOVE      WSOPD         WSOPD1
     C                   MOVE      'H'           HEUR
     C                   Z-ADD     0             HENTF
     C                   MOVE      WSAVD1        HEAVD
     C                   MOVE      WSAVD1        WSAVD
     C                   MOVE      *ZEROS        HESTD
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      ' '           HEPK4
     C                   MOVE      ' '           HEPK8
     C                   MOVE      ' '           HEPK9
     C                   MOVE      FKO2FB        HEPK1
     C                   MOVE      FO2FPS        HEPK2
     C                   MOVE      FKO2KK        HEPK3
     C                   MOVE      FKO2FI        HEPK5
     C                   MOVE      FKO2TE        HEPK6
     C                   MOVE      'N'           HEPK7
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      *BLANKS       HEGNN
     C                   MOVE      *BLANKS       HEVALT
     C                   MOVE      *ZEROS        HEVALP
     C                   MOVE      FICURR        HEVALK
     C                   MOVE      FICURR        HEVALS
     C                   MOVE      ' '           HEST
     C                   MOVE      'DUP'         HESG
     C                   MOVEL     HESGG         HELB
     C                   MOVE      HEGN          XXGN             15
     C                   MOVE      HEPOS1        XXPOS1            7
     C                   MOVE      HEPOS2        XXPOS2            4
      * Fra fly import til fly export'
     C     WFRAUR        IFEQ      'C'
     C     WSURF         ANDEQ     'D'
     C                   MOVE      *BLANKS       HEGN
     C                   MOVE      *BLANKS       HERFA
     C                   ENDIF
      * Fra fly export til fly import'
     C     WFRAUR        IFEQ      'D'
     C     WSURF         ANDEQ     'C'
     C                   MOVE      *BLANKS       HEGN
     C                   MOVEL     WFRARF        HERFA
     C                   ENDIF
      * Fra fly export til transport'
     C     WFRAUR        IFEQ      'C'
     C     WFRAUR        OREQ      'D'
     C     WSURF         ANDEQ     'H'
     C                   MOVE      *BLANKS       HEGN
     C                   MOVEL     WFRARF        HERFA
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   MOVE      *BLANKS       HESAML
     C                   MOVE      *BLANKS       HEHAWB
N12  C                   MOVE      *ZEROS        HEKNT
     C*
     C*  BESTILLENDE AVD ER FAKTURAMOTTAKER...
     C*      PÅ SELGER/AVS.SIDE VED FF
     C                   MOVE      'S'           TRKDFF
     C                   MOVE      KOAKNR        HEKNSF
     C                   MOVE      *ZEROS        HEKNKF
     C                   MOVE      'X'           HEKDFK
     C                   MOVE      OPDGIV        TRKNFA
     C     OPDGIV        IFEQ      HEKNK
     C     OPDGIV        ANDNE     HEKNS
     C                   MOVE      'K'           TRKDAK
     C                   ELSE
     C                   MOVE      'S'           TRKDAK
     C                   END
     C*FLYTTET OPP LINJER FRA NEDE I RUTINEN
     C*
     C* OPPADSTIGENDE REFERANSE I EGNE DATAFELT
     C* AVD0/OPD0 - REF TIL MODEROPPDRAG (SOM GJERNE OGSÅ KAN VÆRE DUP)
     C                   MOVE      'FF'          TRSLAG
     C                   MOVE      HEAVDG        TRAVD0
     C                   MOVE      HEOPDG        TROPD0
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   EXSR      OPDHTD
     C                   EXSR      DUPMOF
     C     WZFIL         IFEQ      'J'
     C                   MOVEL     DSDUP         HEREFF
     C                   MOVEL     HEAVD         HEREFF
     C     FIFIRM        CHAIN     ZTELL                              31
     C  N31              Z-ADD     ZUNIK         HEUNIK
     C  N31              ADD       1             ZUNIK
     C  N31              UPDATE    ZTELLR
     C                   WRITE     ZEADFR
     C                   ELSE
     C                   WRITE     HEADFR
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
N19  C     HEUR          IFEQ      'H'
N19  C                   EXSR      DOKUFVSR
N19  C                   END
     C                   END
      * DUPLISER FRITEKST????
      *                  MOVE      *ZEROS        FRTLI
     C     KEYFTG        CHAIN     FREETXT2                           31
     C     *IN31         DOWEQ     '0'
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
N10  C                   MOVE      HEDTOP        FRTDT
     C     HEKNSF        IFNE      *ZEROS
     C                   MOVE      'S'           FRTKOD
     C                   ELSE
     C                   MOVE      'K'           FRTKOD
     C                   END
     C     WZFIL         IFEQ      'J'
     C                   MOVEL     HEUNIK        FRUNIK
     C                   MOVEL     HEREFF        FRREFF
     C                   WRITE     ZREETX2R
     C                   ELSE
     C                   WRITE     FREETXTR
     C                   End
     C     KEYFTG        READE     FREETXT2                               31
     C                   END
      * FRITEKST TIL OPPDRAG
     C     WSFRD1        IFEQ      'J'
     C                   EXSR      VISFRE
     C                   END
     C* VED POSTNR.BASERT - LEGG UT OGSÅ POST MED STEDSNAVN
     C   42              DO
     C                   CLEAR                   HESTEDR
     C                   MOVE      HEAVD         HSAVD
     C                   MOVE      HEOPD         HSOPD
     C                   MOVEL     XXPNS1        HSFROM
     C                   MOVEL     XXPNS3        HSTO
     C                   WRITE     HESTEDR
     C                   END
     C*
     C* WP/WS... KEY I POSTAL ...
     C   42              MOVE      WSLANT        GMLK              2
     C   42              MOVE      WSSDT         GMSD              5
     C   42              MOVE      WSLAN1        WSLANT
     C   42              MOVE      WSSDFF        WSSDT
     C     TRSLAG        IFEQ      'FF'
     C     WSURF         ANDEQ     'H'
     C                   EXSR      OPDDIS
     C                   ENDIF
     C   42              MOVE      GMLK          WSLANT
     C   42              MOVE      GMSD          WSSDT
     C* Send varsel til USER-profiles knyttet til avdelingen
     C                   EXSR      SNDMSG
     C                   MOVE      'J'           DUPOPD
     C* KALKULERE FRAKT
     C     WSFFBL        IFEQ      *ZEROS
     C                   EXSR      BERFRP
     C     WSFFBL        IFNE      *ZEROS
     C     FFKEY         CHAIN     HEADF                              33
     C     *IN33         IFEQ      *ZEROS
     C                   MOVE      FICURR        TRFRAV
     C                   MOVE      'M'           TRFRAK
     C                   Z-ADD     WSFFBL        TRFRAB
     C                   UPDATE    HEADFR
     C                   EXSR      ILINFR
     C                   END
     C                   END
     C                   END
      *
     C                   MOVE      'NY'          XNYGML            2
     C                   EXSR      FAKTUR
     C                   MOVE      YNYGML        XNYGML
     C* LEGG UT DUMMY REKVISISJON FOR Å LETTE SENERE SPØRRING
     C                   EXSR      DUMREK
     C                   END
     C*
     C* SLUTT DUPLIKATOPPDRAG FOR FORFRAKT
     C*
     C*
     C*
     C*
     C*
     C* OPPDATERER VIDERETRANSPORT DUPLIKATOPPDRAG
     C*
     c     FbrDup        TAG
      *
      * DERSOM Dup alt er ok OG en setter J i prt label, da må det
      * bekreftes med f23  (Original-printen ligger lenger ned..)
     C   92WSOPD2        IFNE      *ZEROS
     C     WSMLVT        IFEQ      'J'
     c     wsfbnr        ifne      *zeros
     c                   z-add     DFNT          HENT
     c                   end
     C     *in23         IFne      *ON
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   MOVE      'JOV1356'     MSGNR2
     C                   SETON                                        30
     C                   Z-add     HENT          WSNTKL
     C                   GOTO      STDUP
     C                   else
     C                   Z-add     HENT          WSNTKL
      * ny print av lapper kan tyde på ant. kll endret- oppdater på DUP
     C     VFkey         CHAIN     HEADF                              33
     C  N33              z-add     wsntkl        HENT
     c  N33              update    headfr
     C     KEYTRG        CHAIN(N)  HEADF                              98
     C                   MOVE      'N'           uukopi            1
     C                   MOVE      wsfbnr        gmFBNR
     C                   MOVE      *ZEROS        WSFBNR            3 0
      * VED KALL FRA SKJERMBILDE- MÅ TEKNIKK FOR Å SETTE ELTRON KLEKKES UT-..
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SN'
     C                   PARM                    FIFIRM
     C                   PARM      'HE'          WMLAYO            2
     C                   PARM                    WSAVD2
     C                   PARM                    WSOPD2
     C                   PARM                    WSFBNR
     C                   PARM                    uukopi
     C                   ELSE
     C                   CALL      'SYFA12SE'
     C                   PARM                    FIFIRM
     C                   PARM      'HE'          WMLAYO            2
     C                   PARM                    WSAVD2
     C                   PARM                    WSOPD2
     C                   PARM                    WSFBNR
     C                   PARM                    uukopi
     C                   END
     C                   Move      ' '           WSMLVT
     C                   MOVE      GMFBNR        WSFBNR
     C                   END
     C                   END
     C                   END
     C  N92WSAVD2        IFNE      *ZEROS
      * SIKRE AT ALLE HEADF/HEADTR OPPL ER OK HVIS OGSÅ FF.ER LAGT UT..
     C     DUPOPD        IFEQ      'J'
     C     KEYTRG        CHAIN(N)  HEADF                              98
     C                   END
     C     WZFIL         IFEQ      'J'
     C                   Z-ADD     0             WSOPD
     C                   ELSE
     C     WSAVD2        CHAIN     TELL                               33
     C   33AVDZER        CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   End
     C* DATA SOM SKAL BYTTES
     C                   MOVE      WSOTVT        HEOT
     C                   IF        UUVIS <> 'J'
     C     KODOTV        CHAIN     KOOTYR                             98
     C  N98KODO2V        CHAIN     KOOT2R                             98
     C                   MOVE      KO2FB         VKO2FB            1            HEPK1
     C                   MOVE      KO2FPS        VO2FPS            1            HEPK2
     C                   MOVE      KO2KK         VKO2KK            1            HEPK3
     C                   MOVE      KO2FI         VKO2FI            1            HEPK5
     C                   MOVE      KO2TE         VKO2TE            1            HEPK6
     C                   END
     C                   MOVE      WSFRVT        HEFR
     C                   MOVE      WSPKVT        HEKDPL
      * Når det er dup "SNU rolle" skal det være 2 "likeverdige", ikke Henteadr mm...
     C     WZSNUVF       IFNE      'J'
     C                   MOVE      WSHNAV        HENAS
     C                   MOVE      WSHAD1        HEADS1
     C                   MOVE      WSHAD2        HEADS2
     C                   MOVE      WSHAD3        HEADS3
     C                   MOVE      WSSDVT        HESDF
     C                   MOVE      WSLAN2        HELKA
     C                   MOVE      UDATOD        TRSDFD
     C                   MOVE      WSSVTK        TRSDFK
     C                   MOVE      WSSDT         HESDT
     C                   MOVE      WSLANT        HETRI
     C                   MOVE      UDATOB        TRSDTD
     C                   MOVE      WSSDTK        TRSDTK
     C                   MOVE      *BLANKS       HELKS
     C                   MOVE      *BLANKS       HELKK
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVE      *ZEROS        TRSVTD
     C                   MOVE      *ZEROS        TRSVTK
     C                   MOVE      *BLANKS       HESDFF
     C                   MOVE      *ZEROS        TRSFFD
     C                   MOVE      *ZEROS        TRSFFK
     C                   MOVE      'N'           TRMVA
     C                   end
     C                   MOVE      *ZEROS        HEPRO
S03  C*                  MOVE      *BLANKS       HEPOS1
S03  C*                  MOVE      *ZEROS        HEPOS2
     C*
S15  C*                  MOVE      UDATOD        HEDTR
N15  C                   MOVE      ULDT          HEDTR
     C                   MOVE      WSOPD         HEOPD
     C                   MOVE      WSOPD         WSOPD2
     C                   MOVE      'H'           HEUR
     C                   Z-ADD     0             HENTF
     C                   MOVE      WSAVD2        HEAVD
     C                   MOVE      WSAVD2        WSAVD
     C                   MOVE      *ZEROS        HESTD
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      ' '           HEPK4
     C                   MOVE      ' '           HEPK8
     C                   MOVE      ' '           HEPK9
     C                   MOVE      VKO2FB        HEPK1
     C                   MOVE      VO2FPS        HEPK2
     C                   MOVE      VKO2KK        HEPK3
     C                   MOVE      VKO2FI        HEPK5
     C                   MOVE      VKO2TE        HEPK6
     C                   MOVE      'N'           HEPK7
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      *BLANKS       HEGNN
N09  C                   MOVE      *BLANKS       HEVALT
N09  C                   MOVE      *ZEROS        HEVALP
N09  C                   MOVE      FICURR        HEVALK
N09  C                   MOVE      FICURR        HEVALS
     C                   MOVE      ' '           HEST
     C                   MOVE      'DUP'         HESG
     C                   MOVEL     HESGG         HELB
     C                   MOVE      HEGN          XXGN             15
     C                   MOVE      HEPOS1        XXPOS1            7
     C                   MOVE      HEPOS2        XXPOS2            4
      * Fra fly import til fly export'
     C     WFRAUR        IFEQ      'C'
     C     WSURE         ANDEQ     'D'
     C                   MOVE      *BLANKS       HEGN
     C                   MOVE      *BLANKS       HERFA
     C                   ENDIF
      * Fra fly export til fly import'
     C     WFRAUR        IFEQ      'D'
     C     WSURE         ANDEQ     'C'
     C                   MOVE      *BLANKS       HEGN
S20  C*                  MOVEL     WFRARF        HERFA
N20  C                   MOVEL     WFRARF        HERFK
     C                   ENDIF
      * Fra fly export til transport'
     C     WFRAUR        IFEQ      'C'
     C     WFRAUR        OREQ      'D'
     C     WSURE         ANDEQ     'H'
     C                   MOVE      *BLANKS       HEGN
s20  C*                  MOVEL     WFRARF        HERFA
N20  C                   MOVEL     WFRARF        HERFK
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       HEPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   MOVE      *BLANKS       HEHAWB
N12  C                   MOVE      *ZEROS        HEKNT
     C                   MOVE      *BLANKS       HESAML
     C*
      * Når kundenr kjøper samsvarer med kundenr mottaksavd, lag hovedoppdrag..
      * BYTTER ROLLER:Det skapte oppdraget blir hovedoppdr/ opprinnelig blir DUP
      * Linjer mot K=Kjøper blir til I=Intern beslastning...
     C     WZSNUVF       IFEQ      'J'
     C                   MOVE      'J'           WzLagHO
     C                   MOVE      'K'           TRKDFF
     C                   MOVE      OPDGIV        HEKNKF
     C                   MOVE      'K'           TRKDAK
     C                   MOVE      OPDGIV        TRKNFA
     C                   MOVE      *ZEROS        HEKNSF
     C                   MOVE      'X'           HEKDFS
     C                   MOVE      'HO'          TRSLAG
     C                   MOVE      *ZEROS        TRAVD0
     C                   MOVE      *ZEROS        TROPD0
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      HEAVDG        TRAVD1
     C                   MOVE      HEOPDG        TROPD1
N03   * Gosnr / posisjon må bli med over til hovedoppdrag ved DUP/SNU
N03   * i forhold til tollager-regnskap er vel dette corny
N03  C                   MOVE      XXGN          HEGN
N03  C                   MOVE      XXPOS1        HEPOS1
N03  C                   MOVE      XXPOS2        HEPOS2
     C                   else
     C*   BYTTER  FAKTURAMOTTAGER
     C*
     C*  BESTILLENDE AVD ER FAKTURAMOTTAKER...
     C*      PÅ KJØPer /MOT-SIDE VED VF
     C                   MOVE      'K'           TRKDFF
     C                   MOVE      KOAKNR        HEKNKF
     C                   MOVE      *ZEROS        HEKNSF
     C                   MOVE      'X'           HEKDFS
      * ved fraktbrevsdup, styrt av fraktbrevet
     C     DFBELA        ifeq      'S'
     C                   MOVE      'S'           TRKDFF
     C                   MOVE      KOAKNR        HEKNSF
     C                   MOVE      *ZEROS        HEKNKF
     C                   MOVE      'X'           HEKDFK
     C                   MOVE      ' '           HEKDFS
     c                   end
     C                   MOVE      OPDGIV        TRKNFA
     C     OPDGIV        IFEQ      HEKNS
     C     OPDGIV        ANDNE     HEKNK
     C                   MOVE      'S'           TRKDAK
     C                   ELSE
     C                   MOVE      'K'           TRKDAK
     C                   END
     C* FLYTTET LINJER NEDENFOR OPP HIT
     C* OPPADSTIGENDE REFERANSE I EGNE DATAFELT
     C* AVD0/OPD0 - REF TIL MODEROPPDRAG (SOM GJERNE OGSÅ KAN VÆRE DUP)
     C                   MOVE      'VF'          TRSLAG
     C                   MOVE      HEAVDG        TRAVD0
     C                   MOVE      HEOPDG        TROPD0
     C                   MOVE      *ZEROS        TRAVD2
     C                   MOVE      *ZEROS        TROPD2
     C                   MOVE      *ZEROS        TRAVD1
     C                   MOVE      *ZEROS        TROPD1
     C                   end
     C     XXTERM        IFNE      *ZEROS
     C     WSLANT        ANDEQ     'NO'
      * Ved DUP fra oppdrag tildeles sendnr (eller fra fraktbrev..)
     C     WSFBNR        IFEQ      *ZEROS
      * SENDINGSNR, for innland lagres FOR ENKLERE SPORING
     C     FRISOKKEY     KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    FSKODE
     C                   move      HEAVDG        FSAVD
     C                   move      HEOPDG        FSOPD
     C                   move      'IFB'         FSKODE
     C     FRISOKKEY     CHAIN     FRISOK                             33
     c     *IN33         IFEQ      '1'
     C                   CALL      'SYGE15'
     C                   PARM                    HXSNDNR
     c                   move      HXSNDNR       SNDNR17          17
     C                   EVAL      FSSOK   = SNDNR17
     c                   move      HEDTOP        FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C                   IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C                   WRITE     FRISOKR
     C                   ELSE
     c                   movel     FSSOK         SNDNR17          17
     c                   movel     '401'         HXSNDNR
     c                   move      SNDNR17       HXSNDNR          20
     c                   end
     c                   else
      * Ved DUP fra fraktbrev hentes sendnr derfra
     c                   movel     DF1004        SNDNR17          17
     c                   movel     '401'         HXSNDNR
     c                   move      SNDNR17       HXSNDNR
     C                   move      'IFB'         FSKODE
     C                   EVAL      FSSOK   = DF1004
     c                   move      HEDTOP        FSDTOP
     c                   end
      * LEGG OGSÅ UT PÅ TRANSPOPPDR
     C                   move      HEAVD         FSAVD
     C                   move      HEOPD         FSOPD
     C     FSKODE        CHAIN     KODFRI                             33
     C                   IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C                   WRITE     FRISOKR
     C                   MOVEL     HXSNDNR       HXSNDN
      *    Hvis via fraktbrev - dupliser alle frie søkeveier med kode R
      *    (i første omgang - kopierer alle rått... )
     C     WSFBNR        IFNE      0
N14   * Bestillende oppdrag som Freigt forwarders ref
N14  c                   move      UUAVD         tta
N14  c                   move      UUOPD         tto
N14  c                   move      UUFBNR        ttf
N14  C                   move      HEAVD         FSAVD
N14  C                   move      HEOPD         FSOPD
N14  C                   MOVE      *BLANKS       FSDOKK
N14  C                   move      'FFR'         FSKODE
N14  C                   EVAL      FSSOK   = TTA+'/'+TTO+'/'+TTF+'/'+HESGG
N14  C                   WRITE     FRISOKR
      *
     c     KEYTRG        setll     FRISOK
     c     KEYTRG        reade     FRISOK                                 33
     c     *in33         doweq     *OFF
     c     FSKODE        IFNE      'IFB'
     C                   move      HEAVD         FSAVD
     C                   move      HEOPD         FSOPD
     C                   WRITE     FRISOKR
     C                   end
     c     KEYTRG        reade     FRISOK                                 33
     C                   end
     C                   end
      * Slettemerk evt åpent fraktbrev (hvis det er DUP fra oppdr,nivå)
     C     WSFBNR        IFEQ      0
     C                   z-add     1             wsfbnr
     C     FBRKEY        CHAIN     DOKUF                              33
     c     *IN33         IFEQ      '0'
     c     DFST          IFEQ      ' '
     c                   move      'S'           DFST
     C                   end
     C                   update    dokufr
     c                   end
     C                   Move      *zeros        wsfbnr
N02  c                   else
N02   * bestilling av etterfrakt (VF) via fraktbrev skal alltid være i TRmodul
N02  C                   MOVE      'H'           WSURE
     C                   end
     C                   End
     C                   EXSR      OPDHTD
     C                   EXSR      DUPMOE
     C     WZFIL         IFEQ      'J'
     C                   MOVEL     DSDUP         HEREFF
     C                   MOVEL     HEAVD         HEREFF
     C     FIFIRM        CHAIN     ZTELL                              31
     C  N31              Z-ADD     ZUNIK         HEUNIK
     C  N31              ADD       1             ZUNIK
     C  N31              UPDATE    ZTELLR
     C                   WRITE     ZEADFR
     C                   ELSE
     C                   WRITE     HEADFR
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
N19  C     HEUR          IFEQ      'H'
N19  C                   EXSR      DOKUFVSR
N19  C                   END
     C                   end
      * DUPLISER FRITEKST????
     C     KEYFTG        CHAIN     FREETXT2                           31
     C     *IN31         DOWEQ     '0'
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
N10  C                   MOVE      HEDTOP        FRTDT
     C     HEKNSF        IFNE      *ZEROS
     C                   MOVE      'S'           FRTKOD
     C                   ELSE
     C                   MOVE      'K'           FRTKOD
     C                   END
     C     WZFIL         IFEQ      'J'
     C                   MOVEL     HEUNIK        FRUNIK
     C                   MOVEL     HEREFF        FRREFF
     C                   WRITE     ZREETX2R
     C                   ELSE
     C                   WRITE     FREETXTR
     C                   end
     C     KEYFTG        READE     FREETXT2                               31
     C                   END
      * DUPLISER GODSNR TIL FRAKTBREVNOTIS - KODE R
     C     XXGN          IFNE      *BLANKS
     C     XXNAS         ANDNE     *BLANKS
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
     C                   MOVE      HEDTOP        FRTDT
     C                   MOVE      'R'           FRTKOD
     C                   eval      FRTTXT = 'Godsnr: ' + XXGN +
     C                                      ' Pos: '+ XXPOS1 + '/'+
     C                                      XXPOS2 + ' Avs: ' +XXNAS
     C                   ADD       1             FRTLI
     C                   WRITE     FREETXTR
     C                   END
      * DUPLISER FRITEKST fra fraktbrevs notisblokk
     C     WSFBNR        IFNE      *ZEROS
     C     DOK29KEY      CHAIN     DOK29                              31
     C     *IN31         DOWEQ     '0'
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
     C                   MOVE      HEDTOP        FRTDT
     C                   MOVE      'R'           FRTKOD
     C                   eval      FRTTXT = D29TXT
     C                   ADD       1             FRTLI
     C                   WRITE     FREETXTR
     C     DOK29Key      READE     DOK29                                  31
     C                   END
     C                   END
      * DUPLISER GODSNR TIL GODSLISTENOTIS - KODE G
     C     XXGN          IFNE      *BLANKS
     C                   MOVE      HEAVD         FRTAVD
     C                   MOVE      HEOPD         FRTOPD
     C                   MOVE      HEDTOP        FRTDT
     C                   MOVE      'G'           FRTKOD
     C                   eval      FRTTXT = 'Godsnr: ' + XXGN +
s06  C*                                     'Pos: ' + XXPOS1 + '/'+
s06  C*                                     XXPOS2
N06  C                                      ' Pos: ' + XXPOS1 + '/'+
N06  C                                      XXPOS2 + ' Tur: ' +GMTURA
      * Hvis KUN godsnr så skal det ikke lyse gult!!!
S11  C*                  MOVE      '.'           FRTTXT
N11  C                   MOVE      'X'           FRTLES
     C                   ADD       1             FRTLI
     C                   WRITE     FREETXTR
N11  C                   MOVE      ' '           FRTLES
     C                   END
      * Via FRAKTBREV
s13  C     WSFBNR        IFNE      *ZEROS
S13   * Etter 03.08 med mer struktur på meld til kund/transp skal IKKE dok29 til R!!
S13  C*    DOK29KEY      CHAIN     DOK29                              31
S13  C*    *IN31         DOWEQ     '0'
s13  C*                  MOVE      HEAVD         FRTAVD
s13  C*                  MOVE      HEOPD         FRTOPD
S13  C*                  MOVE      HEDTOP        FRTDT
S13  C*                  MOVE      'G'           FRTKOD
s13  C*                  eval      FRTTXT = D29TXT
s13  C*                  ADD       1             FRTLI
S13  C*                  WRITE     FREETXTR
S13  C*    DOK29Key      READE     DOK29                                  31
s13  C*                  END
N01   * dok36 = merknad til transportør
N01  C     DOK29KEY      CHAIN     DOK36                              31
N01  C     *IN31         DOWEQ     '0'
N01  C                   MOVE      HEAVD         FRTAVD
N01  C                   MOVE      HEOPD         FRTOPD
N01  C                   MOVE      HEDTOP        FRTDT
N01  C                   MOVE      'G'           FRTKOD
N01  C                   eval      FRTTXT = D36TXT
N01  C                   ADD       1             FRTLI
N13  C                   MOVE      ' '           FRTLES
N01  C                   WRITE     FREETXTR
N01  C     DOK29Key      READE     DOK36                                  31
N01  C                   END
      * DUP VIA FRAKTBREV -DUPLISER FRITEKST G / R fra oppdragsnotisblokk
N10  c                   move      FRTLI         MaxFtLi           2 0
N10  C                   MOVE      'G'           FTKODG
N10  C     KEYFTG        CHAIN     FREETXT2                           31
N10  C     *IN31         DOWEQ     '0'
N10  C                   MOVE      HEAVD         FRTAVD
N10  C                   MOVE      HEOPD         FRTOPD
N10  C                   MOVE      HEDTOP        FRTDT
N10  C                   ADD       1             MAXFTLI
N10  C                   Z-ADD     MAXFTLI       FRTLI
N13  C                   MOVE      ' '           FRTLES
N10  C                   WRITE     FREETXTR
N10  C     KEYFTG        READE     FREETXT2                               31
N10  C                   END
N10  C                   MOVE      'R'           FTKODG
N10  C     KEYFTG        CHAIN     FREETXT2                           31
N10  C     *IN31         DOWEQ     '0'
N10  C                   MOVE      HEAVD         FRTAVD
N10  C                   MOVE      HEOPD         FRTOPD
N10  C                   MOVE      HEDTOP        FRTDT
N10  C                   ADD       1             MAXFTLI
N10  C                   Z-ADD     MAXFTLI       FRTLI
N13  C                   MOVE      ' '           FRTLES
N10  C                   WRITE     FREETXTR
N10  C     KEYFTG        READE     FREETXT2                               31
N10  C                   END
N10  C                   MOVE      'D'           FTKODG
N10   * DERSOM FRAKTBREV FRA EKSPORT-OPPDRAG, AVSENDER I G-LINJE
N10  C     EXPORT        IFEQ      'J'
N10  C                   MOVE      'G'           FRTKOD
N10  C                   EVAL      FRTTXT = 'End.mott: '+%trim(DFNAVM)+', '
N10  C                             +%trim(DFAD1M)+', '+%trim(DFAD3M)
N10  C                   MOVE      HEAVD         FRTAVD
N10  C                   MOVE      HEOPD         FRTOPD
N10  C                   MOVE      HEDTOP        FRTDT
N10  C                   ADD       1             MAXFTLI
N10  C                   Z-ADD     MAXFTLI       FRTLI
N10  C                   WRITE     FREETXTR
N10  C                   ENDIF
N10  C
     C                   END
      * FRITEKST TIL OPPDRAG
     C     WSFRD2        IFEQ      'J'
     C                   EXSR      VISFRE
     C                   END
     C* VED POSTNR.BASERT - LEGG UT OGSÅ POST MED STEDSNAVN
     C   42              DO
     C                   CLEAR                   HESTEDR
     C                   MOVE      HEAVD         HSAVD
     C                   MOVE      HEOPD         HSOPD
     C                   MOVEL     XXPNS4        HSFROM
     C                   MOVEL     XXPNS2        HSTO
     C                   WRITE     HESTEDR
     C                   END
     C   42              MOVE      WSLANF        GMLK
     C   42              MOVE      WSSDF         GMSD
     C   42              MOVE      WSLAN2        WSLANF
     C   42              MOVE      WSSDVT        WSSDF
     C     TRSLAG        IFEQ      'VF'
     C     WSURE         ANDEQ     'H'
     C                   EXSR      OPDDIS
     C                   ENDIF
     C   42              MOVE      GMLK          WSLANF
     C   42              MOVE      GMSD          WSSDF
     C* Send varsel til USER-profiles knyttet til avdelingen
     C                   EXSR      SNDMSG
     C* KALKULERE FRAKT
     C     WSVFBL        IFEQ      *ZEROS
     C     WZLagHO       andeq     'N'
     C                   EXSR      BERFRP
     C     WSVFBL        IFNE      *ZEROS
     C     VFKEY         CHAIN     HEADF                              33
     C     *IN33         IFEQ      *ZEROS
     C                   MOVE      FICURR        TRFRAV
     C                   MOVE      'M'           TRFRAK
     C                   Z-ADD     WSVFBL        TRFRAB
     C                   UPDATE    HEADFR
     C                   EXSR      ILINFR
     C                   END
     C                   END
     C                   END
      *
     C                   MOVE      'J'           DUPOPD
     C                   MOVE      'NY'          XNYGML
     C                   SETOFF                                       030516
     C     DIN03         IFEQ      'J'
     C                   SETON                                        03
     C                   END
     C     DIN05         IFEQ      'J'
     C                   SETON                                        05
     C                   END
     C                   EXSR      FAKTUR
     C                   MOVE      YNYGML        XNYGML
     C* LEGG UT DUMMY REKVISISJON FOR Å LETTE SENERE SPØRRING
     C                   EXSR      DUMREK

      *  Flytt over evt eksternt tildelte kolli-ID til DUP.
     C                   z-add     WSFBNR        XXFBNR
     C     WSFBNR        IFEQ      *zeros
     C                   z-add     1             XXFBNR
     C                   end
     C     DOKFMKey      Setll     DOKUFM
     C     DOKFMKey      READE     DOKUFM                                 33
     C     *in33         doweq     '0'
     C     FMST          IFEQ      'E'                                          Ekstern
     C     FMST          OREQ      'I'                                          Intern
n11  C     FMST          OREQ      'M'                                          Mankomerket
n11  C     FMST          OREQ      'O'                                          Ompakket/Original
     C                   delete    dokufmr
     C                   move      heavd         FMAVD
     C                   move      heopd         FMOPD
     C                   z-add     1             FMFBNR
     C                   write     dokufmr
     C                   end
     C     DOKFMKey      READE     DOKUFM                                 33
     C                   end
      *  Skriv merkelapp
     C     WSMLVT        IFEQ      'J'
     C                   MOVE      'N'           uukopi            1
     C                   MOVE      wsfbnr        gmFBNR            3 0
     C                   MOVE      *ZEROS        WSFBNR
     C     ELTRON        IFEQ      'N'
     C                   CALL      'SYFA12SN'
     C                   PARM                    FIFIRM
     C                   PARM      'HE'          WMLAYO            2
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    WSFBNR
     C                   PARM                    uukopi
     C                   ELSE
     C                   CALL      'SYFA12SE'
     C                   PARM                    FIFIRM
     C                   PARM      'HE'          WMLAYO            2
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    WSFBNR
     C                   PARM                    uukopi
     C                   END
     C                   Move      ' '           WSMLVT            1
     C                   MOVE      GMFBNR        WSFBNR
     C                   END
     C                   END
     C*
     C* SLUTT DUPLIKATOPPDRAG FOR VIDERETRANSPORT
     C*
     C*
     C* OPPDATERER KRYSSREFERANSE GAMMELT OPPDRAG
     C*
     C     DUPOPD        IFEQ      'J'
     C*
     C     WSFBNR        IFEQ      *ZEROS
     C     KEYTRG        CHAIN     HEADF                              98
     C  N98              MOVE      WSAVD1        TRAVD1
     C  N98              MOVE      WSOPD1        TROPD1
     C  N98              MOVE      WSAVD2        TRAVD2
     C  N98              MOVE      WSOPD2        TROPD2
     C  N98              UPDATE    HEADFR
     C                   ELSE
     C     KEYTRG        CHAIN(N)  HEADF                              98
     C     FBRKEY        CHAIN     DOKUF                              98
     C     *IN98         IFEQ      *OFF
     C                   MOVE      WSAVD2        XXAVD2            4
     C                   MOVE      WSOPD2        XXOPD2            7
     c                   eval      DFBREF = 'U.op:'+XXAVD2+'/'+XXOPD2
     C                   UPDATE    DOKUFR
     C                   END
     C                   END
     C                   END
     C                   SETOFF                                       030516
     C     DIN03         IFEQ      'J'
     C                   SETON                                        03
     C                   END
     C     XIN05         IFEQ      'J'
     C                   SETON                                        05
     C                   SETOFF                                       03
     C                   END
     C                   MOVE      HEAVDG        WSAVD
     C                   MOVE      HEOPDG        WSOPD
     C                   MOVE      HEAVDG        HEAVD
     C                   MOVE      HEOPDG        HEOPD
     C*
     C                   SETOFF                                       919298
     C     UTDUPS        TAG
     C     WSFBNR        IFEQ      *ZEROS
     C  N03
     CANN12              GOTO      STDUP0
     C                   END
     c     WzLagHo       ifeq      'J'
     c                   Exsr      LagKILin
     c                   end
     C                   ENDSR
      *
     C***********************************************
     C     LagKILin      BEGSR
     C***********************************************
      * "bestillende"oppdrag sender hovedoppdrag til annen avd OG denne er F.mot
      * Gjør om K-linjer til Ilinjer
     c     HEADFK        setll     fakt
     c     HEADFK        reade     fakt                                   33
     c     *in33         doweq     '0'
     c     FASK          IFEQ      'K'
     c     FAOPKO        andeq     ' '
     c                   move      'I'           FASK
     c                   move      'N'           FAKDM
     c                   move      TRAVD2        FAAVDR
     c                   end
     c                   update    FAKTR
     c     HEADFK        reade     fakt                                   33
     c                   end
     C                   ENDSR
     C***********************************************
     C     GetFbr        BEGSR
     C***********************************************
      *
     C                   MOVE      HEDTOP        UDATOD
     C                   MOVE      HEDTOP        UDATOB
     C     FBRKey        Chain(N)  DOKUF                              33
     c     *IN33         CABEQ     '1'           UtFbr
      * SENDER (VED DUPBESTILLING VIA FR.BR ER F.B-SENDER(SPEDITØR) AVSENDER
      *  (GÅR VIA SKJERMBILDEVARIABLENE WSHNAV...)
     C                   MOVEL     HENAS         XXNAS            30
     C                   MOVEL     DFNAVS        WSHNAV
     C                   MOVEL     DFAD1S        WSHAD1
     C                   MOVE      DFAD2S        WSHAD2
     C                   MOVE      *blanks       WSHAD3
     C                   MOVEL     DFPNLS        WSHAD3
     C                   MOVEL     DFAD3S        XXLAD25          25
     C                   MOVE      XXLAD25       WSHAD3
      * MOTTAKER
     C                   MOVEL     DFNAVL        HENAK
     C                   MOVEL     DFAD1L        HEADK1
     C                   MOVE      DFAD2L        HEADK2
     C                   MOVE      *blanks       HEADK3
     C                   MOVEL     DFPOUL        HEADK3
     C                   MOVEL     DFADUL        XXLAD25          25
     C                   MOVE      XXLAD25       HEADK3
     c                   z-add     DFNT          HENT
     c                   z-add     DFVKT         HEVKT
     c                   z-add     DFM3          HEM3
     c                   z-add     DFLM          HELM
     c                   z-add     DFVKTF        HEFBV
     c                   movel     DFGM          HEGM1
     c                   movel     DFGM2         HEGM2
     c                   movel     DFVS          HEVS1
     c                   movel     DFVS2         HEVS2
     c     DFPROK1_3     IFEQ      'DUP'
     c                   move      DFPROK4       WSPKVT
     c                   end
     c     HERFA         IFEQ      *BLANKS
     c                   moveL     '.'           HERFA
     c                   end
     c     DFKDME        IFEQ      'S'
     c                   move      'J'           WSMLVT
     c                   end
     c*
N10  c     Export        Ifeq      'J'
N10  C                   MOVEL     DFPNLS        WSSDVT                          blir til WSSDF
N10  C                   MOVEL     DFPOUL        WSSDT
N10  C     XXTERM        Ifne      *zeros
N10  C                   MOVEL     XXTERM        WSSDT
N10  c                   end
N10  c                   else
     C                   MOVEL     DFPNLS        WSSDVT
     C     XXTERM        Ifne      *zeros
     C                   MOVEL     XXTERM        WSSDVT
     c                   end
     C                   MOVEL     DFPOUL        WSSDT
N10  c                   endif
     C                   exsr      getavd
     c*
     C     Utfbr         ENDSR
      *
     C***********************************************
     C     GetAvd        BEGSR
     C***********************************************
N10  c     Export        Ifeq      'J'
N10  C                   MOVEL     WSSDF         TSTPNR            4
N10  c                   else
     C                   MOVEL     WSSDT         TSTPNR            4
N10  c                   end
     C                   TESTN                   TSTPNR               33
     C     *IN33         IFEQ      '1'
     C                   MOVE      TSTPNR        NUMPNR
      * OM DET FINNES I NOPNR SÅ BRUK DET
N21  C     KODRIK        CHAIN     NOPNR                              33
N21  C     *IN33         IFEQ      *OFF
N21  C     NOAVDU        ANDNE     *ZEROS
N21  C     NOAVDI        ANDNE     *ZEROS
N21  C                   MOVE      NOAVDU        RIAVDU
N21  C                   MOVE      NOAVDI        RIAVDI
N21  C                   goto      AvdOK
N21  C                   END
     C     KODRIK        SETGT     KODTRI
     C     XXTERM        READPE    KODTRI                                 33
     C  N33NUMPNR        IFGE      RIPNRF
     C     NUMPNR        ANDLE     RIPNRT
N21  c     Avdok         tag
     C                   MOVE      RIAVDU        WSAVD2
N07  C*    WSFBNR        IFNE      *ZEROS
N07  C*    EXPORT        ANDEQ     'J'
N07  C     EXPORT        IFEQ      'J'
     C                   MOVE      RIAVDI        WSAVD2
     C                   END
     C                   END
     C                   END
     C     WSPKVT        IFNE      ' '
     C                   Z-ADD     900           WSAVD2
     C                   END
     C                   ENDSR
     C***********************************************
     C     OPDDIS        BEGSR
     C***********************************************
     C*
     C*
     C* OPPDATERER DISPONERINGSFILE
     C*
     C     DISPKE        KLIST
     C                   KFLD                    DIAVD
     C                   KFLD                    DIOPD
     C*
     C                   MOVE      HEOPD         DIOPD
     C                   MOVE      HEAVD         DIAVD
     C     DISPKE        CHAIN     DISP                               34
     C                   MOVE      HEOT          DIOT
     C   34HEPRO         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        DIRUND
     C                   MOVE      *ZEROS        DITUR
     C                   MOVE      *ZEROS        DITUAV
     C                   END
     C                   MOVE      HESDF         DISTEF
     C                   MOVE      HESDT         DISTET
     C                   MOVE      TRSDFD        DIDATF
     C                   MOVE      TRSDTD        DIDATT
     C                   MOVE      TRSDFK        DITIMF
     C                   MOVE      TRSDTK        DITIMT
     C                   MOVE      *BLANKS       DISONF
     C                   MOVE      *BLANKS       DISONT
     C  N42DISTEF        CHAIN     STED2                              33
     C   42WKSDF         CHAIN     STED2D                             33
     C  N33              MOVEL     ST2LK         DISONF
     C  N33              MOVE      ST2SOL        DISONF
     C  N42DISTET        CHAIN     STED2                              33
     C   42WKSDT         CHAIN     STED2D                             33
     C  N33              MOVEL     ST2LK         DISONT
     C  N33              MOVE      ST2SOL        DISONT
     C   34              MOVE      ' '           DISTA1
     C   34Esending      IFEQ      'J'
     C                   MOVE      'E'           DISTA1
     c   34              exsr      SREDS
     C                   END
     C* Dersom EDI-mottatt oppdrag ferdigbehandles - sett disp til ' '
     C  N34DISTA1        IFEQ      'E'
     C                   MOVE      ' '           DISTA1
     C                   END
     C   34              WRITE     DISPR
     C  N34              UPDATE    DISPR
     C                   ENDSR
     C*
     C***********************************************
     C     SREDS         BEGSR
     C***********************************************
      * Turnr de kom inn på binder de samme  i en linje i vis ESendinger..
     C                   MOVE      HEAVD         FSAVD
     C                   MOVE      HEOPD         FSOPD
     C                   MOVE      'EDS'         FSKODE
     c                   move      GMOPDGIV      AAKNFA            8
     c                   move      HEDTOP        AADTOP            8
     c                   move      HEDTOP        AAGMPRO           8
     C                   EVAL      FSSOK=AAKNFA+' '+AADTOP+' '+GMTURA+' '+GMBILA
     C     FSKODE        CHAIN     KODFRI                             33
     C                   IF        *IN33
     C                   MOVE      *BLANKS       FSDOKK
     C                   ELSE
     C                   MOVE      KFSODK        FSDOKK
     C                   END
     C                   WRITE     FRISOKR
     C                   ENDSR
      *
     C***********************************************
     C     SØKDUP        BEGSR
     C***********************************************
     C     WSCLOW        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * SØK PÅ INNHENTINGSSIDA....
     C     *IN91         IFEQ      '0'
      * AVD
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     8
     C                   CALL      'SYFA14B'
     C                   PARM                    WSAVD1
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØDU
     C                   END
      * PROD.KODE
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDEQ     19
     C                   MOVEL     WSPKFF        KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    YKFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD
     C                   MOVEL     KFKOD         WSPKFF
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØDU
     C                   END
      *  OPPDR.TYPE
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     24
     C     POSNBR        ANDLE     25
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOTFF
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØDU
     C                   END
     C* FRANKATUR
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     25
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFRFF
     C                   PARM                    USPED
     C                   GOTO      SLSØDU
     C                   END
      * MODUL
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDEQ     29
     C                   MOVEL     'DELSYS'      UTYP
     C                   MOVEL     *BLANKS       RETURK
     C                   CALL      'SYFAKDA'
     C                   PARM                    UTYP             10
     C                   PARM                    VEDL              1
     C                   PARM                    RETURK            5
     C     RETURK        IFNE      *BLANKS
     C                   MOVEL     RETURK        WSURF
     C                   END
     C                   GOTO      SLSØDU
     C                   END
     C*
     C                   END
      *
      * SØK PÅ UTKJØRINGSSIDA  ...
     C     *IN92         IFEQ      '0'
      * AVD
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFA14B'
     C                   PARM                    WSAVD2
     C                   Z-ADD     65            POSNBR
     C                   GOTO      SLSØDU
     C                   END
      * PROD.KODE
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDEQ     63
     C                   MOVEL     WSPKVT        KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    YKFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD
     C                   MOVEL     KFKOD         WSPKVT
     C                   Z-ADD     68            POSNBR
     C                   GOTO      SLSØDU
     C                   END
      * OPPDR.TYPE
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     68
     C     POSNBR        ANDLE     69
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOTVT
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   GOTO      SLSØDU
     C                   END
      * FRANKATUR
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     67
     C     POSNBR        ANDLE     69
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFRVT
     C                   PARM                    USPED
     C                   GOTO      SLSØDU
     C                   END
      * MODUL
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDEQ     70
     C                   MOVEL     'DELSYS'      UTYP
     C                   MOVEL     *BLANKS       RETURK
     C                   CALL      'SYFAKDA'
     C                   PARM                    UTYP             10
     C                   PARM                    VEDL              1
     C                   PARM                    RETURK            5
     C     RETURK        IFNE      *BLANKS
     C                   MOVEL     RETURK        WSURE
     C                   END
     C                   GOTO      SLSØDU
     C                   END
      *
      *
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR2
     C                   SETON                                        30
     C*
     C     SLSØDU        ENDSR
     C*
     C***********************************************
     C     SNDMSG        BEGSR
     C***********************************************
     C* Skal noen av brukerne varsles om at oppdrag er overført ?
     C     HEAVD         CHAIN     KODTD                              33
     C     *IN33         IFNE      *ON
     C*Konverter numeriske felt til venstrestilt alfa
     C                   Z-ADD     HEAVD         ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AAAVD            10
     C                   Z-ADD     HEOPD         ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AAOPD            10
     C                   Z-ADD     TRSDFD        ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AASDFD           10
     C                   Z-ADD     TRSDFK        ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AASDFK           10
     C                   Z-ADD     TRSDTD        ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AASDTD           10
     C                   Z-ADD     TRSDTK        ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AASDTK           10
     C                   Z-ADD     HENT          ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AANT             10
     C                   Z-ADD     HEVKT         ØN151
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AAVKT            10
     C                   Z-ADD     HELM          ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AALM             10
     C                   Z-ADD     HEM3          ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           AAM3             10
     C*
     C*Komponer tekst av: tekstkonstanter(lange), tekst(små), VARIABLER
     C*OBS! KUN ALFA.variabler
     C     TRSLAG        IFEQ      'FF'
     C** :0 (:1 :2...) angir hvor mange blanke FORAN aktuelt felt
     C     TXT1FF        CAT(P)    HESG:1        MSGTXT
     C                   ELSE
     C     TXT1VF        CAT(P)    HESG:1        MSGTXT
     C                   END
     C                   CAT       '.   Av':0    MSGTXT
     C                   CAT       'd/opd:':0    MSGTXT
     C                   CAT       AAAVD:1       MSGTXT
     C                   CAT       '/':0         MSGTXT
     C                   CAT       AAOPD:0       MSGTXT
     C                   CAT       'Fra':5       MSGTXT
     C                   CAT       HSFROM:1      MSGTXT
     C                   CAT       '(':1         MSGTXT
     C                   CAT       AASDFD:0      MSGTXT
     C                   CAT       AASDFK:1      MSGTXT
     C                   CAT       ')':0         MSGTXT
     C                   CAT       'til':2       MSGTXT
     C                   CAT       HSTO:1        MSGTXT
     C                   CAT       '(':1         MSGTXT
     C                   CAT       AASDTD:0      MSGTXT
     C                   CAT       AASDTK:1      MSGTXT
     C                   CAT       ')':0         MSGTXT
     C                   CAT       'for':2       MSGTXT
     C                   CAT       HENAA:1       MSGTXT
     C                   CAT       '(':3         MSGTXT
     C                   CAT       AANT:0        MSGTXT
     C                   CAT       HEVS1:1       MSGTXT
     C                   CAT       'Vekt:':2     MSGTXT
     C                   CAT       AAVKT:1       MSGTXT
     C                   CAT       'LM:':2       MSGTXT
     C                   CAT       AALM:1        MSGTXT
     C                   CAT       'M3:':2       MSGTXT
     C                   CAT       AAM3:1        MSGTXT
     C                   CAT       ')':0         MSGTXT
     C                   CAT       TXT2:5        MSGTXT
     C* Loop så lenge det finnes usere å sende til
     C     1             DO        6             UNR               3 0
     C     US(UNR)       CABEQ     *BLANKS       UTUSR
     C     US(UNR)       IFEQ      '*PRINT'
      * SKRIV KJØREORDRE.....
     C                   MOVE      HEAVD         YYTAVD            4
     C                   MOVE      *ZEROS        YYTPRO            8
S04  C*                  MOVE      HEOPD         YYTPRO
N04  C                   MOVE      HEOPD         YYTOPD            7
     C                   MOVE      'S'           YYTY              1
     C                   CALL      'SYTR40CB'
     C                   PARM      YYTAVD        YYTAVD
     C                   PARM      YYTPRO        YYTPRO
N04  C                   PARM      YYTOPD        YYTOPD
     C                   PARM      YYTY          YYTY
     C                   ELSE
     C* Sett inn user (msgq) - i front av tekst Eks: 'PETTER - Innh...
     C     APP           CAT(P)    US(UNR):0     MSGTX2
     C                   CAT       '-':1         MSGTX2
     C                   CAT       MSGTXT:1      MSGTX2
     C                   CAT       APP:0         MSGTX2
     C* Komponer kommando av blanding av tekstkonstanter/variabler
     C     CMD1          CAT       MSGTX2:0      CMD
     C                   CAT       CMD2:0        CMD
     C                   CAT       US(UNR):0     CMD
     C                   CAT       CMD3:0        CMD
     C* Utfør kommandoen via QCMDEXEC
     C                   Z-ADD     1024          CMDLE            15 5
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    CMD
     C                   PARM                    CMDLE
     C                   END
     C                   END
     C                   END
     C     UTUSR         ENDSR
     C*
      *////////////////////////////////////////////////////////////
      *  Leftjustify num.fields                              SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
     C                   Z-ADD     0             ØX                2 0
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØN152         IFGT      0
     C     ØA152T        ANDEQ     '0'
     C                   Z-ADD     ØN152         ØN151
     C                   ENDIF
     C     ØN151         IFEQ      0
     C     ØA152D        IFEQ      '00'
     C                   MOVE      ØA152H        ØA12
     C                   ELSE
     C                   MOVEL     ØA152X        ØA12
     C                   MOVE      '.  '         ØA12
     C                   MOVE      ØA152D        ØA12
     C                   END
     C                   ELSE
     C     ØA151D        IFEQ      '0'
     C                   MOVE      ØA151H        ØA12
     C                   ELSE
     C                   MOVEL     ØA151X        ØA12
     C                   MOVE      '. '          ØA12
     C                   MOVE      ØA151D        ØA12
     C                   END
     C                   ENDIF
      * search from left and find first sign over 0
     C     1             DO        11            ØX
     C     Ø12(ØX)       IFNE      '0'
     C                   GOTO      SRNE1
     C                   END
     C                   END
     C     SRNE1         TAG
      * Leftjustify to a new field
     C     ØA152D        IFGT      '00'
     C     ØA152X        ANDEQ     *ZEROS
     C     ØA151D        ORGT      '0'
     C     ØA151X        ANDEQ     *ZEROS
     C                   SUB       1             ØX
     C                   ENDIF
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVEA     Ø12(ØX)       ØAN
     C                   Z-ADD     0             ØN151
     C                   Z-ADD     0             ØN152
      *
     C                   ENDSR
     C***********************************************
     C     DUMREK        BEGSR
     C***********************************************
     C* DUMMY REKVISISJON FOR Å LETTE SENERE SPØRRING
     C     'Å'           CHAIN     KOSTT                              34
     C   34              MOVE      'Å'           KTTYP
     C   34              Z-ADD     1000000       KTNR
     C   34              WRITE     KOSTTR
     C  N34              ADD       1             KTNR
     C  N34              UPDATE    KOSTTR
     C*
     C     KTNR          CHAIN     KOSBU                              34
     C   34              MOVE      'D'           BUST
     C     BUST          IFEQ      'D'
     C                   MOVE      KTNR          BUBNR
     C     UYEAR         IFGT      50
     C                   MOVE      '19'          BUPCC
     C                   ELSE
     C                   MOVE      '20'          BUPCC
     C                   END
     C                   MOVE      UYEAR         BUPÅR
     C                   MOVE      UMONTH        BUPMN
     C                   MOVE      *ZEROS        BUTNR
     C                   MOVE      *ZEROS        BULNR
     C                   MOVE      FICURR        BUVAL
     C                   MOVE      *ZEROS        BUBL
     C                   MOVE      'FRA'         BUVK
     C                   MOVE      HESGG         BUSG
     C                   MOVE      *ZEROS        BUTAVD
     C                   MOVE      *ZEROS        BUTUNR
     C                   MOVE      HEAVDG        BUOAVD
     C                   MOVE      HEOPDG        BUOPD
     C                   MOVE      'E'           BUBLST
     C                   MOVE      'E'           BUTYPE
     C                   MOVEL     '*DUPOPPD'    DSTXTA
     C                   MOVE      'RAG*'        DSTXTA
     C                   MOVE      '/'           DSTXTB
     C                   MOVE      '-'           DSTXTC
     C                   MOVE      HEAVD         DSAVD
     C                   MOVE      HEOPD         DSOPD
     C                   MOVE      DSTXT         BUTXT
     C                   MOVE      *BLANKS       BUBILK
     C                   MOVE      *BLANKS       BUBILN
     C                   MOVE      *ZEROS        BUFEDT
     C                   MOVE      'O'           BUFER
     C                   MOVE      *ZEROS        BUBNR2
     C                   MOVE      *ZEROS        BUBNR3
     C                   MOVE      *ZEROS        BULNR3
     C                   MOVE      *ZEROS        BUBLFD
     C                   END
     C   34              WRITE     KOSBUR
     C  N34              UPDATE    KOSBUR
     C                   ENDSR
      *
     C***********************************************
     C     OPDHTD        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        TRRUND
     C                   MOVE      *BLANKS       TRVERV
     C                   MOVE      *ZEROS        TRVERB
     C                   MOVE      *BLANKS       TRETTV
     C                   MOVE      *ZEROS        TRETTB
     C                   MOVE      *BLANKS       TRFRAK
     C                   MOVE      *BLANKS       TRFRAV
     C                   MOVE      *ZEROS        TRFRAB
     C                   MOVE      *ZEROS        HEKNA
     C                   MOVE      *BLANKS       TRTSTA
     C                   MOVE      'N'           TRMVA
     C     WSFFBL        IFNE      *ZEROS
     C     TRSLAG        ANDEQ     'FF'
     C     TRFRAK        IFEQ      ' '
     C                   MOVE      'A'           TRFRAK
     C                   END
     C                   MOVE      FICURR        TRFRAV
     C                   Z-ADD     WSFFBL        TRFRAB
     C                   EXSR      ILINFR
     C                   END
     C     WSVFBL        IFNE      *ZEROS
     C     TRSLAG        ANDEQ     'VF'
     C     TRFRAK        IFEQ      ' '
     C                   MOVE      'A'           TRFRAK
     C                   END
     C                   MOVE      FICURR        TRFRAV
     C                   Z-ADD     WSVFBL        TRFRAB
     C                   EXSR      ILINFR
     C                   END
     C                   ENDSR
     C***********************************************
     C     ILINFR        BEGSR
     C***********************************************
     C     TRSLAG        IFEQ      'FF'
     C     FFFAKK        CHAIN     FAKT                               31
     C                   ELSE
     C     VFFAKK        CHAIN     FAKT                               31
     C                   END
     C                   CLEAR                   FAKTR
     C                   MOVE      *ZEROS        FALI
     C                   MOVE      WSAVD         FAAVD
     C                   MOVE      WSOPD         FAOPD
     C                   Z-ADD     TRFRAB        FABELV
     C                   Z-ADD     TRFRAB        FABELN
     C                   MOVE      'FRA'         FAVK
     C                   MOVE      FICURR        FAVAL
     C                   MOVE      'I'           FASK
     C                   MOVE      TRMVA         FAKDM
     C                   MOVE      'M'           FAKDA
     C                   Z-ADD     TRAVD0        FAAVDR
     C                   EXSR      DECI
     C                   MOVE      KOAKNR        FAKUNR
     C  N31              UPDATE    FAKTR
     C   31              WRITE     FAKTR
     C                   ENDSR
      *
     C*
     C***********************************************
     C     FAKTUR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       UKODE             1
     C                   MOVE      *BLANKS       USECUR            6
     C                   MOVE      *ZEROS        UKFRA             7 0
     C                   MOVE      *BLANKS       WSMELD            1
     C                   MOVE      *BLANKS       WSMSG            70
     C                   MOVE      *ZEROS        XKUTL             4 2
     C                   MOVE      *ZEROS        XKUMIN            2 0
     C                   MOVE      *ZEROS        XSUTL             4 2
     C                   MOVE      *ZEROS        XSUMIN            2 0
     C                   MOVEL     FIFIRM        QDA01
     C                   MOVEL     WSAVD         QDA02
     C                   MOVEL     WSOPD         QDA03
     C                   MOVEL     XNYGML        QDA04
     C                   MOVEL     KO2UTL        QDA05
     C                   MOVEL     XKUTL         QDA06
     C                   MOVEL     XSUTL         QDA07
     C                   MOVEL     XKUMIN        QDA08
     C                   MOVEL     XSUMIN        QDA09
     C                   MOVEL     KO2MVK        QDA10
     C                   MOVEL     KO2MVS        QDA11
     C                   MOVEL     UKFRA         QDA12
     C                   MOVEL     KOVAVR        QDA13
     C                   MOVEL     WSMSG         QDA14
     C                   MOVEL     WSMELD        QDA15
     C                   MOVEL     '3'           QDA16
     C                   MOVEL     UKODE         QDA17
     C                   MOVEL     USECUR        QDA18
     C                   MOVEL     'SYFI10XQ'    QDTAQ            10
     C                   MOVEL     '*LIBL'       QLIB             10
     C                   Z-ADD     109           QRLEN             5 0
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QDTAQ
     C                   PARM                    QLIB
     C                   PARM                    QRLEN
     C                   PARM                    QDATA
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C*
     C* DATO 1
     C*
     C                   MOVE      WSDTD1        UDT1              2 0
     C                   MOVE      WSDTM1        UDT2              2 0
     C                   MOVE      WSDTÅ1        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C     WSSDFD        IFEQ      0
     C                   MOVE      *ZEROS        UDATOA
     C                   ELSE
     C                   MOVE      UDT1          UDT1A
     C                   MOVE      UDT2          UDT2A
     C     UDT3          IFGT      50
     C     UDT3          ADD       1900          UDT3A
     C                   ELSE
     C     UDT3          ADD       2000          UDT3A
     C                   END
     C                   END
     C                   MOVE      UDT1          WSDTD1
     C                   MOVE      UDT2          WSDTM1
     C                   MOVE      UDT3          WSDTÅ1
     C*
     C*
     C* DATO 2
     C*
     C                   MOVE      WSDTD2        UDT1              2 0
     C                   MOVE      WSDTM2        UDT2              2 0
     C                   MOVE      WSDTÅ2        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD2
     C                   MOVE      UDT2          WSDTM2
     C                   MOVE      UDT3          WSDTÅ2
     C     WSSDTD        IFEQ      0
     C                   MOVE      *ZEROS        UDATOB
     C                   ELSE
     C                   MOVE      UDT1          UDT1B
     C                   MOVE      UDT2          UDT2B
     C     UDT3          IFGT      50
     C     UDT3          ADD       1900          UDT3B
     C                   ELSE
     C     UDT3          ADD       2000          UDT3B
     C                   END
     C                   END
     C*
     C*
     C* DATO 3
     C*
     C                   MOVE      WSDTD3        UDT1              2 0
     C                   MOVE      WSDTM3        UDT2              2 0
     C                   MOVE      WSDTÅ3        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD3
     C                   MOVE      UDT2          WSDTM3
     C                   MOVE      UDT3          WSDTÅ3
     C     WSSFFD        IFEQ      0
     C                   MOVE      *ZEROS        UDATOC
     C                   ELSE
     C                   MOVE      UDT1          UDT1C
     C                   MOVE      UDT2          UDT2C
     C     UDT3          IFGT      50
     C     UDT3          ADD       1900          UDT3C
     C                   ELSE
     C     UDT3          ADD       2000          UDT3C
     C                   END
     C                   END
     C*
     C*
     C* DATO 4
     C*
     C                   MOVE      WSDTD4        UDT1              2 0
     C                   MOVE      WSDTM4        UDT2              2 0
     C                   MOVE      WSDTÅ4        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD4
     C                   MOVE      UDT2          WSDTM4
     C                   MOVE      UDT3          WSDTÅ4
     C     WSSVTD        IFEQ      0
     C                   MOVE      *ZEROS        UDATOD
     C                   ELSE
     C                   MOVE      UDT1          UDT1D
     C                   MOVE      UDT2          UDT2D
     C     UDT3          IFGT      50
     C     UDT3          ADD       1900          UDT3D
     C                   ELSE
     C     UDT3          ADD       2000          UDT3D
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
     C***********************************************
     C     DECI          BEGSR
     C***********************************************
     C* TEST FIRMS NUMBER OF DECIMALS
     C*
     C* NO DECIMALS
     C     FIDECI        IFEQ      0
     C                   Z-ADD(H)  FABELN        FABEL0           11 0
     C                   Z-ADD     FABEL0        FABELN
     C                   Z-ADD(H)  FABELU        FABEL0           11 0
     C                   Z-ADD     FABEL0        FABELU
     C                   ELSE
     C* 1 DECIMAL
     C     FIDECI        IFEQ      1
     C                   Z-ADD(H)  FABELN        FABEL1           12 1
     C                   Z-ADD     FABEL1        FABELN
     C                   Z-ADD(H)  FABELU        FABEL1           12 1
     C                   Z-ADD     FABEL1        FABELU
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTBI        BEGSR
     C***********************************************
     C*
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(60)
     C                   MOVEA     '00'          *IN(68)
      *
     C*
     C* INNHENTING...
     C*
     C  N91WSAVD1        IFNE      *ZEROS
     C* TESTER AT TASTET AVDELING HAR TELLER
     C     WSAVD1        CHAIN(N)  TELL                               98
     C   98AVDZER        CHAIN(N)  TELL                               98
     C   98              Z-ADD     7             LINNBR
     C   98              Z-ADD     5             POSNBR
     C   98              MOVE      'SPA0001'     MSGNR2
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C                   MOVEL     WSPKFF        KFKOD
     C     KUFASK        CHAIN     KUFAST                             98
     C   98              MOVE      'YBC0360'     MSGNR2
     C   98              Z-ADD     7             LINNBR
     C   98              Z-ADD     19            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C     KODOTF        CHAIN     KOOTYR                             98
     C  N98KODO2F        CHAIN     KOOT2R                             98
     C   98              MOVE      'SPO0007'     MSGNR2
     C   98              Z-ADD     7             LINNBR
     C   98              Z-ADD     24            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C     KODFRF        CHAIN     KOFRR                              98
     C   98              MOVE      'SPF0006'     MSGNR2
     C   98              Z-ADD     8             LINNBR
     C   98              Z-ADD     23            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C                   MOVE      KO2FB         FKO2FB            1
     C                   MOVE      KO2FPS        FO2FPS            1
     C                   MOVE      KO2KK         FKO2KK            1
     C                   MOVE      KO2FI         FKO2FI            1
     C                   MOVE      KO2TE         FKO2TE            1
     C                   END
      *
     C*
     C  N92WSAVD2        IFNE      *ZEROS
     C     WSAVD2        CHAIN(N)  TELL                               98
     C   98AVDZER        CHAIN(N)  TELL                               98
     C   98              MOVE      'SPA0001'     MSGNR2
     C   98              Z-ADD     14            LINNBR
     C   98              Z-ADD     49            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
      *
     C                   MOVEL     WSPKVT        KFKOD
     C     KUFASK        CHAIN     KUFAST                             98
     C   98              MOVE      'YBC0360'     MSGNR2
     C   98              Z-ADD     14            LINNBR
     C   98              Z-ADD     63            POSNBR
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C     KODOTV        CHAIN     KOOTYR                             98
     C  N98KODO2V        CHAIN     KOOT2R                             98
     C   98              Z-ADD     14            LINNBR
     C   98              Z-ADD     68            POSNBR
     C   98              MOVE      'SPO0007'     MSGNR2
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C     KODFRV        CHAIN     KOFRR                              98
     C   98              Z-ADD     15            LINNBR
     C   98              Z-ADD     67            POSNBR
     C   98              MOVE      'SPF0006'     MSGNR2
     C   98              SETON                                        30
     C   98              GOTO      UTTSBI
      *
     C                   MOVE      KO2FB         VKO2FB            1
     C                   MOVE      KO2FPS        VO2FPS            1
     C                   MOVE      KO2KK         VKO2KK            1
     C                   MOVE      KO2FI         VKO2FI            1
     C                   MOVE      KO2TE         VKO2TE            1
     C                   END
     C*
     C*** TEST DATO FORFRAKT FRA    IND 60
     C     WSSDFD        IFNE      *ZEROS
     C                   MOVE      WSSDFD        XMMÅÅ             4 0
     C                   MOVE      XMMÅÅ         UÅÅ               2 0
     C                   MOVEL     XMMÅÅ         UMM               2 0
     C                   MOVEL     WSSDFD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      60
     C     *IN60         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR2
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C* TESTER KLOKKESLETT
     C     WSSDFK        IFNE      *ZEROS
     C     WSSDFK        IFGT      2400
     C                   MOVE      'SPK0006'     MSGNR2
     C                   SETON                                        3061
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C*** TEST DATO FORFRA  TIL IND 62
     C     WSSFFD        IFNE      *ZEROS
     C                   MOVE      WSSFFD        XMMÅÅ             4 0
     C                   MOVE      XMMÅÅ         UÅÅ               2 0
     C                   MOVEL     XMMÅÅ         UMM               2 0
     C                   MOVEL     WSSFFD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      62
     C     *IN62         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR2
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     58            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C* TESTER KLOKKESLETT FORFRAKT TIL
     C     WSSFFK        IFNE      *ZEROS
     C     WSSFFK        IFGT      2400
     C                   MOVE      'SPK0006'     MSGNR2
     C                   SETON                                        3063
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     66            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C*
     C*** TEST DATO VIDEREFRAKT FRA IND 64
     C     WSSVTD        IFNE      *ZEROS
     C                   MOVE      WSSVTD        XMMÅÅ             4 0
     C                   MOVE      XMMÅÅ         UÅÅ               2 0
     C                   MOVEL     XMMÅÅ         UMM               2 0
     C                   MOVEL     WSSVTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      64
     C     *IN64         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR2
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C* TESTER KLOKKESLETT  VIDERFRAKT FRA
     C     WSSVTK        IFNE      *ZEROS
     C     WSSVTK        IFGT      2400
     C                   MOVE      'SPK0006'     MSGNR2
     C                   SETON                                        3065
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C*** TEST DATO VIDEREFRAKT TIL    IND 66
     C     WSSDTD        IFNE      *ZEROS
     C                   MOVE      WSSDTD        XMMÅÅ             4 0
     C                   MOVE      XMMÅÅ         UÅÅ               2 0
     C                   MOVEL     XMMÅÅ         UMM               2 0
     C                   MOVEL     WSSDTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      66
     C     *IN66         IFEQ      '1'
     C                   MOVE      'SPD0001'     MSGNR2
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     58            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C*
     C*
     C* TESTER KLOKKESLETT VIDEREFRAKT TIL
     C     WSSDTK        IFNE      *ZEROS
     C     WSSDTK        IFGT      2400
     C                   MOVE      'SPK0006'     MSGNR2
     C                   SETON                                        3067
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     66            POSNBR
     C                   GOTO      UTTSBI
     C                   END
     C                   END
      *
      * test modulkode
      *
     c  N91wsurf         iflt      'A'
     c     wsurf         orgt      'H'
     C     WSAVD1        IFGT      0
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     29            POSNBR
     c                   seton                                        6830
     C                   MOVE      'SHU1138'     MSGNR2
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     c  N92wsure         iflt      'A'
     c     wsure         orgt      'H'
     C     WSAVD2        IFGT      0
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     70            POSNBR
     c                   seton                                        6930
     C                   MOVE      'SHU1138'     MSGNR2
     C                   GOTO      UTTSBI
     C                   END
     C                   END
     C     UTTSBI        ENDSR
     C*
     C******************************************
     C     BERFRP        BEGSR
     C******************************************
     C* POSTNUMMERBASERT KALKULASJON
      * Finn frakt i kundersfraktavtale
     C                   MOVE      *BLANKS       UUVAL             3
     C                   MOVE      'FRA'         UGEB              3
     C                   MOVE      'FRA'         UGEBKO            3
     C                   MOVE      *ZEROS        UUBELØ           13 2
     C* LEGGER INN DUMMY "S" FOR PART (ULIK A=OPPDATER FR.BER.VEKT)
     C                   MOVE      'S'           USKA              1
     C                   CALL      'SYGE04'
     C                   PARM                    UGEBKO
     C                   PARM                    UGEB
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    KOAKNR
     C                   PARM                    UUVAL
     C                   PARM                    UUBELØ
     C                   PARM                    UAVNR             9 0
     C                   PARM                    UAVMSG           50
     C                   PARM                    USKA
     C                   MOVE      'A'           XKDA
      *
      *
     C     UUBELØ        IFEQ      0
     C                   MOVE      'B'           XKDA              1
     C                   MOVE      *BLANKS       UUVAL
     C                   MOVE      *ZEROS        URABAT
     C                   CALL      'SYGE03'
     C                   PARM                    UGEB
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    UUVAL
     C                   PARM                    UUBELØ
     C                   PARM                    USONE             5
     C                   PARM                    URABAT            5 2
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    N5                5 0
     C                   PARM                    KOAKNR
     C                   PARM                    UAVNR             9 0
N16  C                   PARM                    ATDUM             1
     C     URABAT        IFNE      *ZEROS
     C                   MOVE      'A'           XKDA
     C                   END
     C                   END
      *
      *
     C     TRSLAG        IFEQ      'FF'
     C                   Z-ADD     UUBELØ        WSFFBL
     C                   ELSE
     C                   Z-ADD     UUBELØ        WSVFBL
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
N06  c                   move      UUAVD         tta               4
N06  c                   move      UUOPD         tto               7
N06  c                   move      UUFBNR        ttf               3
     C                   CLEAR                   TRACKFR
     C                   CLEAR                   TRACKTR
      * OPPDRAG OPPRETTET (POST I FIL TRACKF)
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'STR'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
s06  C*                  MOVEL     'Order en'    XXTEXT           16
s06  C*                  MOVE      'tered   '    XXTEXT
s06  C*                  MOVEL     XXTEXT        TTTEXT
n06  C                   eval      TTTEXT = 'Order entered - DUP from '
n06  c                             +tta+'/'+tto+'/'+ttf
N18  C                   eval      TTTEXL = 'Ordre opprettet- DUP fra '
N18  c                             +tta+'/'+tto+'/'+ttf
     c
     C                   WRITE     TRACKFR
      *
      * ETD/ATD - ETA/ATA - TIDSOPPFØLGING. (EGEN FIL TRACKT)
      * (KUNNE TENKES Å VÆRE KUNDESTYRT... RESERVERT KODE I CUOTI???)
     C                   CLEAR                   TRACKTR
     C                   MOVE      HEAVD         TXAVD
     C                   MOVE      HEOPD         TXOPD
     C                   MOVE      TRSDFD        TXETDD
     C                   MOVE      TRSDFK        TXETDK
     C                   MOVE      TRSDTD        TXETAD
     C                   MOVE      TRSDTK        TXETAK
     C                   WRITE     TRACKTR
     C                   ENDSR
N19  C***********************************************
N19  C     DOKUFVSR      BEGSR
N19  C***********************************************
N19   * HENTER VERDIER FRA MOROPPDRAG
N19  C     DOKUFVKG      CHAIN     DOKUFV                             33
N19  C     *IN33         IFEQ      '0'
N19  C                   MOVE      HEAVD         FVAVD
N19  C                   MOVE      HEOPD         FVOPD
N19   * SER OM DENNE LINJE ER PÅ DUPP
N19  C     DOKUFVKN      CHAIN     DOKUFV                             33
N19  C   33              WRITE     DOKUFVR
N19  C                   END
N19  C                   ENDSR
     C***********************************************
     C     DUPMOF        BEGSR
     C***********************************************
     C                   MOVEL     WSURF         HEUR
     C     HEUR          IFNE      'H'
     C                   MOVEL     HELKA         HELKS
     C                   MOVEL     HETRI         HELKK
     C                   ENDIF
     C                   ENDSR
     C***********************************************
     C     DUPMOE        BEGSR
     C***********************************************
     C                   MOVEL     WSURE         HEUR
     C     HEUR          IFNE      'H'
     C                   MOVEL     HELKA         HELKS
     C                   MOVEL     HETRI         HELKK
     C                   ENDIF
     C                   ENDSR
