********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 DEFAUL VERDI FOR CONTAINERKODE = 0
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11016 * 02 YBC PTF11 OMBEREGNING
********************************************************************
      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE PRINTERSTYRING SAD-IMPORT  ***
      ************************************************************
     Fsysthlp   IF   E             DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FSTANDI    UF A E           K DISK
     FEDII      IF   E           K DISK
     FSYPTFF    IF   E           K DISK
     FSYFTAAFM  CF   E             WORKSTN
     D                 DS
     D  SI28                   1     28
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D  SIRABX                12     15
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  SIDTÅ                  1      4  0
     D  SIDTM                  5      6  0
     D  SIDTD                  7      8  0
     D  SIDT                   1      8  0
     D                 DS
     D  SILV2                  1      3
     D  SIUATK                 1      1
     C*
     C                   EXSR      INIT
     C*
     c     mode          ifeq      'E'
     c                   move      uavd          wsaavd
     c                   goto      startb
     c                   end
     c
     C     START         TAG
     C                   EXFMT     BILDE01
     c   01              do
     c                   movel     'syftaa'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START
     c                   end
     c     startb        tag
     C                   SETOFF                                       99
     C   03              GOTO      SLUTT
     C     KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
     C                   EXSR      HENT
     C*
     C     START2        TAG
     C                   EXFMT     BILDE02
     C                   MOVEA     '000000'      *IN(94)
     C                   SETOFF                                       30
     c   01              do
     c                   movel     'syftaa'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START2
     c                   end
     C*
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C                   EXSR      TESTB2
     C   30              GOTO      START2
     C*
     C     WSTOLK        IFEQ      'J'
     C     CUNDKE        CHAIN     CUNDL01                            33
     C  N33              MOVEL     SYRG          WSFORE
     C     START3        TAG
     C                   EXFMT     BILDE03
     C                   MOVEA     '000000'      *IN(94)
     C                   SETOFF                                       30
     c   01              do
     c                   movel     'syftaa'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START3
     c                   end
     C   03              GOTO      SLUTT
     C   12              GOTO      START2
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   END
     C*
     C     HELP1         TAG
     C                   EXFMT     BILDE04
     C   03              GOTO      SLUTT
     C   12              GOTO      START
     c   01              do
     c                   movel     'syftaa'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      HELP1
     c                   end
     C                   EXSR      OPDSTA
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     WSAAVD        CHAIN(N)  STANDI                             60
     C   60              EXSR      MOVEB
     C  N60              EXSR      MOVEW
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSDL          COMP      ' '                                    99
     C   99              MOVE      'SPD0004'     MSGNR
     C   99              SETON                                        30
     C*
     C     WSTDN         COMP      0                                    9595
     C   95
     CANN30              MOVE      'SPT0023'     MSGNR
     C   95              SETON                                        30
     C*
     C     WSTOLK        COMP      'N'                                9494
     C   94WSTOLK        COMP      'J'                                9494
     C   94
     CANN30              MOVE      'SPT0024'     MSGNR
     C   94              SETON                                        30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C     *IN45         IFEQ      '0'
     C     WSTD0A        COMP      0                                    9797
     C   97
     CANN30              MOVE      'SPD0005'     MSGNR
     C   97              SETON                                        30
     C                   ELSE
     C     WSFORE        COMP      *BLANKS                                97
     C  N97WSFORE        COMP      *ZEROS                                 97
     C   97
     CANN30              MOVE      'JOV1259'     MSGNR
     C   97              SETON                                        30
     C                   END
     C*
     C     WSTDB4        COMP      0                                    9696
     C   96
     CANN30              MOVE      'SPD0006'     MSGNR
     C   96              SETON                                        30
     C*
     C     WSNODT        CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN95
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
     C*
     C     WSNODA        CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN94
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
     C*
     C                   ENDSR
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   MOVE      SIDTD         WSDTD
     C                   MOVE      SIDTM         WSDTM
     C                   MOVE      SIDTÅ         WSDTÅ
     C                   MOVE      SIST          WSST
     C                   MOVE      SITDN         WSTDN
     C                   MOVE      SIDTY         WSDTY
     C                   MOVE      SIDP          WSDP
     C                   MOVE      SIKNS         WSKNS
     C                   MOVE      SINAS         WSNAS
     C                   MOVE      SIADS1        WSADS1
     C                   MOVE      SIADS2        WSADS2
     C                   MOVE      SIADS3        WSADS3
     C                   MOVE      SINTK         WSNTK
     C                   MOVE      SISKI         WSSKI
     C                   MOVE      SIKDDK        WSKDDK
     C                   MOVE      SIVKB         WSVKB
     C                   MOVE      SIKDC         WSKDC
     C                   MOVE      SIKNK         WSKNK
     C                   MOVE      SIRG          WSRG
     C                   MOVE      SINAK         WSNAK
     C                   MOVE      SIADK1        WSADK1
     C                   MOVE      SIADK2        WSADK2
     C                   MOVE      SIADK3        WSADK3
     C                   MOVE      SIVAL1        WSVAL1
     C                   MOVE      SIBEL1        WSBEL1
     C                   MOVE      SIVAL2        WSVAL2
     C                   MOVE      SIBEL2        WSBEL2
     C                   MOVE      SIFTG2        WSFTG2
     C                   MOVE      SILKA         WSLKA
     C                   MOVE      SITLF         WSTLF
     C                   MOVE      SINAD         WSNAD
     C                   MOVE      SILV          WSLV
     C                   MOVE      SILVT         WSLVT
     C                   MOVE      SITRID        WSTRID
     C                   MOVE      SILKT         WSLKT
     C                   MOVE      SIVAL3        WSVAL3
     C                   MOVE      SIBEL3        WSBEL3
     C                   MOVE      SIVKU         WSVKU
     C                   MOVE      SITST         WSTST
     C                   MOVE      SITRM         WSTRM
     C                   MOVE      SIKTA         WSKTA
     C                   MOVE      SIKTB         WSKTB
     C                   MOVE      SIKTC         WSKTC
     C                   MOVE      SIGN          WSGN
     C                   MOVE      SIFT1         WSFT1
     C                   MOVE      SIFT2         WSFT2
     C                   MOVE      SIFT3         WSFT3
     C                   MOVE      SIFT4         WSFT4
     C                   MOVE      SIDST         WSDST
     C                   MOVE      SIDTG         WSDTG
     C                   MOVE      SITLL         WSTLL
     C                   MOVE      SITLE         WSTLE
     C                   MOVE      SILS          WSLS
     C                   MOVE      SIKDLS        WSKDLS
     C                   MOVE      SIKDH         WSKDH
     C*                  MOVE      SIKDTR        WSKDTR
     C                   MOVE      SIEKST        WSEKST
     C     SIUATK        IFEQ      ' '
     C                   MOVE      'N'           WSUATK
     C                   ELSE
     C                   MOVE      SIUATK        WSUATK
     C                   END
     C*                  MOVE      SIAS          WSAS
     C                   MOVE      SIPOS         WSPOS
     C     SIRABX        IFEQ      *BLANKS
     C                   MOVE      *ZEROS        WSRAB
     C                   ELSE
     C                   Z-ADD     SIRAB         WSRAB
     C                   END
     C*
     C* PRINTERSTYRING OG TAD KOMMUNIKASJON
     C                   MOVE      SIDL          WSDL
     C                   MOVE      SITOLK        WSTOLK
     C                   MOVE      S3039D        WSTD0A
     C                   MOVE      S3039E        WSTDB4
N02  C                   MOVE      S3039EO1      WSTDB4O1
N02  C                   MOVE      S3039EO2      WSTDB4O2
     C                   MOVE      S0010         WSNODT
     C                   MOVE      S0004         WSNODA
     C                   MOVE      S0035         W0035
     C                   MOVE      SIA4          WSA4
     C                   MOVE      S0026         W0026
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEB         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       WSST
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *BLANKS       WSDTY
     C                   MOVE      *ZEROS        WSDP
     C                   MOVE      *ZEROS        WSKNS
     C                   MOVE      *BLANKS       WSNAS
     C                   MOVE      *BLANKS       WSADS1
     C                   MOVE      *BLANKS       WSADS2
     C                   MOVE      *BLANKS       WSADS3
     C                   MOVE      *BLANKS       WSNTK
     C                   MOVE      *BLANKS       WSSKI
     C                   MOVE      *BLANKS       WSKDDK
     C                   MOVE      *BLANKS       WSVKB
S01  C*                  MOVE      *BLANKS       WSKDC
N01  C                   MOVE      '0'           WSKDC
     C                   MOVE      *ZEROS        WSKNK
     C                   MOVE      *BLANKS       WSRG
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      *BLANKS       WSADK1
     C                   MOVE      *BLANKS       WSADK2
     C                   MOVE      *BLANKS       WSADK3
     C                   MOVE      *BLANKS       WSVAL1
     C                   MOVE      *ZEROS        WSBEL1
     C                   MOVE      *BLANKS       WSVAL2
     C                   MOVE      *ZEROS        WSBEL2
     C                   MOVE      *BLANKS       WSFTG2
     C                   MOVE      *BLANKS       WSLKA
     C                   MOVE      *BLANKS       WSTLF
     C                   MOVE      *BLANKS       WSNAD
     C                   MOVE      *BLANKS       WSLV
     C                   MOVE      *BLANKS       WSLVT
     C                   MOVE      *BLANKS       WSTRID
     C                   MOVE      *BLANKS       WSLKT
     C                   MOVE      *BLANKS       WSVAL3
     C                   MOVE      *ZEROS        WSBEL3
     C                   MOVE      *ZEROS        WSVKU
     C                   MOVE      *ZEROS        WSTST
     C                   MOVE      *ZEROS        WSTRM
     C                   MOVE      *ZEROS        WSKTA
     C                   MOVE      *ZEROS        WSKTB
     C                   MOVE      *BLANKS       WSKTC
     C                   MOVE      *BLANKS       WSGN
     C                   MOVE      *BLANKS       WSFT1
     C                   MOVE      *BLANKS       WSFT2
     C                   MOVE      *BLANKS       WSFT3
     C                   MOVE      *BLANKS       WSFT4
     C                   MOVE      *BLANKS       WSDST
     C                   MOVE      *BLANKS       WSDTG
     C                   MOVE      *BLANKS       WSTLL
     C                   MOVE      *BLANKS       WSTLE
     C                   MOVE      *BLANKS       WSLS
     C                   MOVE      *BLANKS       WSKDLS
     C                   MOVE      *ZEROS        WSKDH
     C*                  MOVE      *BLANKS       WSKDTR
     C*                  MOVE      *ZEROS        WSAS
     C                   MOVE      'N'           WSUATK
     C                   MOVE      *BLANKS       WSPOS
     C                   MOVE      *ZEROS        WSRAB
     C*
     C* PRINTERSTYRING OG TAD KOMMUNIKASJON
     C                   MOVE      *BLANKS       WSDL
     C                   MOVE      *BLANKS       WSTOLK
     C                   MOVE      *ZEROS        WSTD0A
     C                   MOVE      *ZEROS        WSTDB4
N02  C                   MOVE      *ZEROS        WSTDB4O1
N02  C                   MOVE      *ZEROS        WSTDB4O2
     C                   MOVE      *BLANKS       WSNODT
     C                   MOVE      *BLANKS       WSNODA
     C                   MOVE      *BLANKS       WSA4
     C                   MOVE      *BLANKS       W0026
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDSTA        BEGSR
     C***********************************************
     C     STANIK        CHAIN     STANDI                             60
     C                   EXSR      MOVEST
     C   60              WRITE     STANDIR
     C  N60              UPDATE    STANDIR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEST        BEGSR
     C***********************************************
     C                   MOVE      WSST          SIST
     C                   MOVE      WSAAVD        SIAVD
     C                   MOVE      WSTDN         SITDN
     C                   MOVE      WSDTY         SIDTY
     C                   MOVE      WSDP          SIDP
     C                   MOVE      WSKNS         SIKNS
     C                   MOVE      WSNAS         SINAS
     C                   MOVE      WSADS1        SIADS1
     C                   MOVE      WSADS2        SIADS2
     C                   MOVE      WSADS3        SIADS3
     C                   MOVE      WSNTK         SINTK
     C                   MOVE      WSSKI         SISKI
     C                   MOVE      WSKDDK        SIKDDK
     C                   MOVE      WSVKB         SIVKB
N01  C                   IF        WSKDC = ' '
N01  C                   MOVE      '0'           SIKDC
N01  C                   ELSE
     C                   MOVE      WSKDC         SIKDC
N01  C                   END
     C                   MOVE      WSKNK         SIKNK
     C                   MOVE      WSRG          SIRG
     C                   MOVE      WSNAK         SINAK
     C                   MOVE      WSADK1        SIADK1
     C                   MOVE      WSADK2        SIADK2
     C                   MOVE      WSADK3        SIADK3
     C                   MOVE      WSVAL1        SIVAL1
     C                   MOVE      WSBEL1        SIBEL1
     C                   MOVE      WSVAL2        SIVAL2
     C                   MOVE      WSBEL2        SIBEL2
     C                   MOVE      WSFTG2        SIFTG2
     C                   MOVE      WSLKA         SILKA
     C                   MOVE      WSTLF         SITLF
     C                   MOVE      WSNAD         SINAD
     C                   MOVE      WSLV          SILV
     C                   MOVE      WSLVT         SILVT
     C                   MOVE      WSTRID        SITRID
     C                   MOVE      WSLKT         SILKT
     C                   MOVE      WSVAL3        SIVAL3
     C                   MOVE      WSBEL3        SIBEL3
     C                   MOVE      WSVKU         SIVKU
     C                   MOVE      WSTST         SITST
     C                   MOVE      WSTRM         SITRM
     C                   MOVE      WSKTA         SIKTA
     C                   MOVE      WSKTB         SIKTB
     C                   MOVE      WSKTC         SIKTC
     C                   MOVE      WSGN          SIGN
     C                   MOVE      WSFT1         SIFT1
     C                   MOVE      WSFT2         SIFT2
     C                   MOVE      WSFT3         SIFT3
     C                   MOVE      WSFT4         SIFT4
     C                   MOVE      WSDST         SIDST
     C                   MOVE      WSDTG         SIDTG
     C                   MOVE      WSTLL         SITLL
     C                   MOVE      WSTLE         SITLE
     C                   MOVE      WSLS          SILS
     C                   MOVE      WSKDLS        SIKDLS
     C                   MOVE      WSKDH         SIKDH
     C*                  MOVE      WSKDTR        SIKDTR
     C*                  MOVE      WSAS          SIAS
     C                   MOVE      WSEKST        SIEKST
     C                   MOVE      UDAY          SIDTD
     C                   MOVE      UMONTH        SIDTM
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          SIDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          SIDTÅ
     C                   END
     C                   MOVE      WSUATK        SIUATK
     C                   MOVE      WSPOS         SIPOS
     C                   MOVE      WSRAB         SIRAB
     C                   MOVE      *ZEROS        SIBELC
     C*
     C* PRINTERSTYRING OG TAD KOMMUNIKASJON
     C                   MOVE      WSDL          SIDL
     C                   MOVE      WSTOLK        SITOLK
     C                   MOVE      WSTD0A        S3039D
     C                   MOVE      WSTDB4        S3039E
N02  C                   MOVE      WSTDB4O1      S3039EO1
N02  C                   MOVE      WSTDB4O2      S3039EO2
     C                   MOVE      WSNODT        S0010
     C                   MOVE      WSNODA        S0004
     C                   MOVE      W0035         S0035
     C                   MOVE      WSA4          SIA4
     C                   MOVE      W0026         S0026
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     c     *entry        plist
     c                   parm                    uavd              4 0
     C                   parm                    mode              1
     C     CUNDKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     STANIK        KLIST
     C                   KFLD                    WSAAVD
     C*
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      *ZEROS        SIRAB
     C                   MOVE      *ZEROS        SIBELC
     C                   MOVE      *ZEROS        SIDT
     C                   MOVE      *ZEROS        WSDT
     C     'TVI00004'    CHAIN     SYPTFF                             45
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C     PTFDT         COMP      WDT80                                4545
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HELPSR        BEGSR
     C***********************************************
     c
     c                   move      *blanks       pcocmd           70
     c     1             chain     systhlp                            33
     c     *in(33)       ifeq      '0'
      *
      * intern
     c                   movel     'http://'     pcocmd
     C     pcocmd        CAT       systip:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       systba:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       hlpna:0       pcocmd
     C     pcocmd        CAT       '.htm':0      pcocmd
      *
     c                   call      'SYGE34CL'
     c                   parm                    pcocmd
     c                   end
     C                   ENDSR
