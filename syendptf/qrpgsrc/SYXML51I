********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12239 * 01 YBC PTF12 Indonesia og Ecuador har egen tollsats
12243 * 02 YBC PTF12 Storbritania bruker tollsats fra første kolonne av 2
********************************************************************
      **************************************************************
      *** PROGRAM SKAL KONVERTER CW1-XML TIL SAD-IMPORT       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-99                      ***
      ***********************************************************
      *
     FXMLRCVF   IF   E           K DISK
     FEDIS      IF   E           K DISK
     FSADH      UF A E           K DISK
     FSADV      UF A E           K DISK
     FSTANDI    UF   E           K DISK
     FTRACKF    O  A E             DISK
     FFRISOL01  IF A E           K DISK
     FFRISOK    UF   E           K DISK    RENAME(FRISOKR:FRISOKR0)
     FFIRM      IF   E           K DISK
     FKODTLB    IF   E           K DISK
     FKODTSI    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTS8    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FTARI      IF   E           K DISK
     FEDIC      UF A E             DISK
     FEDIM      O  A E             DISK
      *
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     D REF1            S              3    DIM(10)
     D REF2            S             35    DIM(10)
     D XADRTYPE        S             35A
     D XOK             S              1A
     D                 DS
     D  SVAKD1                 1      2
     D  SVAKD2                 3      4
     D  SVAKD3                 5      6
     D  SVAKD4                 7      8
     D  SVAKD5                 9     10
     D  SVAKD6                11     12
     D  SVAKD7                13     14
     D  SVAKD8                15     16
     D  AVG1                   1     16    DIM(8)
     D                 DS
     D  SVASV1                 1      3
     D  SVASV2                 4      6
     D  SVASV3                 7      9
     D  SVASV4                10     12
     D  SVASV5                13     15
     D  SVASV6                16     18
     D  SVASV7                19     21
     D  SVASV8                22     24
     D  AVG2                   1     24    DIM(8)
     D                 DS
     D  SVASA1                 1      7  2
     D  SVASA2                 8     14  2
     D  SVASA3                15     21  2
     D  SVASA4                22     28  2
     D  SVASA5                29     35  2
     D  SVASA6                36     42  2
     D  SVASA7                43     49  2
     D  SVASA8                50     56  2
     D  AVG4                   1     56  2 DIM(8)
     D                 DS
     D  SVAGR1                 1     13  2
     D  SVAGR2                14     26  2
     D  SVAGR3                27     39  2
     D  SVAGR4                40     52  2
     D  SVAGR5                53     65  2
     D  SVAGR6                66     78  2
     D  SVAGR7                79     91  2
     D  SVAGR8                92    104  2
     D  AVG3                   1    104  2 DIM(8)
     D                 DS
     D  SVABL1                 1     13  2
     D  SVABL2                14     26  2
     D  SVABL3                27     39  2
     D  SVABL4                40     52  2
     D  SVABL5                53     65  2
     D  SVABL6                66     78  2
     D  SVABL7                79     91  2
     D  SVABL8                92    104  2
     D  AVG5                   1    104  2 DIM(8)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  CNT1                   1    224    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  DOK2                   1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  DOK1                   1     33    DIM(11)
     D                 DS
     D  VT1                    1    210    DIM(7)
     D  VT1ALL                 1    210
     D                 DS
     D  XTXT                   1     15
     D  XT                     1     15    DIM(15)
     D                 DS
     D  XTAL                   1     15  3
     D  XTALH                  1     12  0
     D  XTALD1                13     13
     D  XTALD2                14     14
     D  XTALD3                15     15
     D                 DS
     D  XAN08                  1      8
     D  XAN081                 1      7
     D  XAN082                 8      8
     D                 DS
     D  SIKTC                  1      1
     D  SIKTA                  2      6  0
     D  SIKTB                  7      8  0
     D  SIKT8                  1      8
     D  SIKT7                  2      8  0
     D                 DS
     D  SIFID                  1      8  0
     D  SIFIDA                 1      4
     D  SIFIDM                 5      6
     D  SIFIDD                 7      8
     D                 DS
     D  SIAVD                  1      4  0
     D  FSAVD                  1      4  0
     D  TTAVD                  1      4  0
     D  MAVD                   1      4  0
     D  SITDN                  5     11  0
     D  FSOPD                  5     11  0
     D  TTOPD                  5     11  0
     D  MTDN                   5     11  0
     D  SISG                  12     14
     D  X14S                   1     14
     D                 DS
     D  SIDT                   1      8  0
     D  FSDTOP                 1      8  0
     D                 DS
     D  SI27                   1     27
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D                 DS
     D  SITRT                  1      7  0
     D  SISLAA                 1      1  0
     D  SIDFVF                 2      2  0
     D                 DS
     D  KLBXXX                 1     35
     D  KLBHAD                 1      1
     D                 DS
     D  SYRG                   1     14
     D  SYFORE                 1      9
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     D                SDS
     D  ZUSER                254    263
      *
     C                   EXSR      INIT
      *
     C                   EXSR      SRX01
      *
     C                   EXSR      SRSNDCW1
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     SRX01         BEGSR
      ***********************************************
     C                   EVAL      X001_XRLEV1 = 1
     C                   EVAL      X001_XRLEV2 = 1
     C                   EVAL      X001_XRLEV3 = 0
      *
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'DataContext'                          2
      * <DataContext> -> Hent unik CW1-referanse
     C                   EXSR      SRX02A
     C                   WHEN      XRNV = 'CommercialInfo'                       2
      * <CommercialInfo> -> Fakturainfo og varelinje info
     C                   EXSR      SRX02B
     C                   WHEN      XRNV = 'MessageType'                          2
      * <MessageType> -> Sjekk om det er import eller eksport
     C                   WHEN      XRNV = 'OwnerRef'                             2
      * <OwnerRef> -> Andre referanse
     C     FRISOKK       CHAIN     FRISOK                             33
     C                   EVAL      FSSOK  = XRVERD
     C                   IF        *IN33                                          3<-B
     C                   EVAL      FSKODE = 'ORD'
     C                   MOVE      WDT           FSDTOP
     C                   WRITE     FRISOKR
     C                   ELSE                                                     3
     C                   UPDATE    FRISOKR0
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'OuterPacks'                           2
      * <OuterPacks> -> Total kolli
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SINTK
     C                   WHEN      XRNV = 'PortOfDestination'                    2
      * <PortOfDestination> -> Destinasjon
     C                   EXSR      SRX02C
     C                   WHEN      XRNV = 'ShipmentIncoTerm'                     2
      * <ShipmentIncoTerm> -> Lveringsvilkår
     C                   EXSR      SRX02D
     C                   WHEN      XRNV = 'TotalWeight'                          2
      * <TotalWeight> -> Total vekt
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SIVKB
     C                   WHEN      XRNV = 'TotalWeightUnit'                      2
      * <TotalWeightUnit> -> Vekt enhet
     C                   EXSR      SRX02E
     C                   WHEN      XRNV = 'TransportMode'                        2
      * <TransportMode> -> Transportmåte
     C                   EXSR      SRX02F
     C                   WHEN      XRNV = 'TransportNationality'                 2
      * <TransportNationality> -> Transportmiddels nasjonalitet
     C                   EXSR      SRX02G
     C                   WHEN      XRNV = 'VesselName'                           2
     C                             OR XRNV = 'VoyageFlightNo'
     C                   EVAL      SITRID = XRVERD
     C                   WHEN      XRNV = 'OrganizationAddressCollection'        2
      * <OrganizationAddressCollection> -> Avsender og mottaker
     C                   EXSR      SRX02H
     C                   EXSR      SROPDHOD
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X001_XRLEV2
     C     XMLKEY01      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX01         ENDSR
      *
      ***********************************************
     C     SRX02A        BEGSR
      ***********************************************
      * <DataContext> -> Hent unik CW1-referanse
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'DataSourceCollection'                 2
      * <DataSourceCollectionignment>
     C                   EXSR      SRX03A1
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02A        ENDSR
      *
      ***********************************************
     C     SRX03A1       BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * <DataSource>
     C                   WHEN      XRNV = 'DataSource'                           2
     C                   EXSR      SRX04A11
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03A1       ENDSR
      *
      ***********************************************
     C     SRX04A11      BEGSR
      ***********************************************
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Key'                                  2
      * <Key>
     C                   EVAL      FSSOK = XRVERD
     C     FRISOL01K     CHAIN     FRISOL01                           33
     C                   IF        *IN33                                          3<-B
     C                   EVAL      SIAVD = 500
     C     SIAVD         CHAIN     STANDI                             33
     C                   ADD       1             SITDN
     C                   UPDATE    STANDIR
     C                   SUB       1             SITDN
     C                   MOVE      WDT           SIDT
     C                   EVAL      SIST   = ' '
     C                   EVAL      SISG   = 'CW1'
     C                   EVAL      SIDFVF = 1
     C                   EVAL      SISLAA = 1
     C                   EVAL      FSKODE = '*CR'
     C                   EVAL      FSDTOP = SIDT
     C                   WRITE     FRISOKR
     C                   EVAL      FSKODE = '*CA'
     C                   EVAL      FSSOK  = X_S0004
     C                   WRITE     FRISOKR
     C                   EVAL      FSKODE = '*CM'
     C                   EVAL      FSSOK  = X_S0010
     C                   WRITE     FRISOKR
     C                   EVAL      FSSOK = XRVERD
     C                   END                                                      3<-E
     C                   EVAL      XOK = 'J'
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X004_XRLEV5
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XOK = 'N'
     C                   EVAL      *INLR = *ON
     C                   RETURN
     C                   END
      *
     C     SLX04A11      ENDSR
      *
      ***********************************************
     C     SRX02B        BEGSR
      ***********************************************
      * <CommercialInfo> -> Faktura og varelinje
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'CommercialChargeCollection'           2
      * <CommercialChargeCollection>
     C                   EXSR      SRX03B1
     C                   WHEN      XRNV = 'CommercialInvoiceCollection'          2
      * <CommercialInvoiceCollection>
     C                   EXSR      SRX03B2
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02B        ENDSR
      *
      ***********************************************
     C     SRX03B1       BEGSR
      ***********************************************
      * <CommercialChargeCollection>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03B1       ENDSR
      *
      ***********************************************
     C     SRX03B2       BEGSR
      ***********************************************
      * <CommercialInvoiceCollection>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * <CommercialInvoice>
     C                   WHEN      XRNV = 'CommercialInvoice'                    2
     C                   EXSR      SRX04B21
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03B2       ENDSR
      *
      ***********************************************
     C     SRX04B21      BEGSR
      ***********************************************
      * <CommercialInvoice>
      *
     C                   EVAL      X004_XRLEV1 = XRLEV1
     C                   EVAL      X004_XRLEV2 = XRLEV2
     C                   EVAL      X004_XRLEV3 = XRLEV3
     C                   EVAL      X004_XRLEV4 = XRLEV4
     C                   EVAL      X004_XRLEV5 = 1
     C                   EVAL      X004_XRLEV6 = 0
      *
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'InvoiceNumber'                        2
      * <InvoiceNumber>
     C                   EVAL      SIFIF = XRVERD
     C                   WHEN      XRNV = 'InvoiceAmount'                        2
      * <InvoiceAmount>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SIBEL3
     C                   WHEN      XRNV = 'InvoiceCurrency'                      2
      * <InvoiceCurrency>
     C                   EXSR      SRX05B211
     C                   WHEN      XRNV = 'InvoiceDate'                          2
      * <InvoiceDate>
     C                   EVAL      SIFIDA = %SUBST(XRVERD:1:4)
     C                   EVAL      SIFIDM = %SUBST(XRVERD:6:2)
     C                   EVAL      SIFIDD = %SUBST(XRVERD:9:2)
     C                   WHEN      XRNV = 'CommercialInvoiceLineCollection'      2
      * <CommercialInvoiceLineCollection>
     C                   EXSR      SRX05B212
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X004_XRLEV5
     C     XMLKEY04      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX04B21      ENDSR
      *
      ***********************************************
     C     SRX05B211     BEGSR
      ***********************************************
      * <InvoiceCurrency>
      *
     C                   EVAL      X005_XRLEV1 = XRLEV1
     C                   EVAL      X005_XRLEV2 = XRLEV2
     C                   EVAL      X005_XRLEV3 = XRLEV3
     C                   EVAL      X005_XRLEV4 = XRLEV4
     C                   EVAL      X005_XRLEV5 = XRLEV5
     C                   EVAL      X005_XRLEV6 = 1
     C                   EVAL      X005_XRLEV7 = 0
      *
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   EVAL      SIVAL3 = XRVERD
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X005_XRLEV6
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX05B211     ENDSR
      *
      ***********************************************
     C     SRX05B212     BEGSR
      ***********************************************
      * <CommercialInvoiceLineCollection>
      *
     C                   EVAL      X005_XRLEV1 = XRLEV1
     C                   EVAL      X005_XRLEV2 = XRLEV2
     C                   EVAL      X005_XRLEV3 = XRLEV3
     C                   EVAL      X005_XRLEV4 = XRLEV4
     C                   EVAL      X005_XRLEV5 = XRLEV5
     C                   EVAL      X005_XRLEV6 = 1
     C                   EVAL      X005_XRLEV7 = 0
      *
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'CommercialInvoiceLine'                2
      * <CommercialInvoiceLine>
     C                   EXSR      SRX06B2121
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X005_XRLEV6
     C     XMLKEY05      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX05B212     ENDSR
      *
      ***********************************************
     C     SRX06B2121    BEGSR
      ***********************************************
      * <CommercialInvoiceLine>
      *
     C                   EVAL      X006_XRLEV1 = XRLEV1
     C                   EVAL      X006_XRLEV2 = XRLEV2
     C                   EVAL      X006_XRLEV3 = XRLEV3
     C                   EVAL      X006_XRLEV4 = XRLEV4
     C                   EVAL      X006_XRLEV5 = XRLEV5
     C                   EVAL      X006_XRLEV6 = XRLEV6
     C                   EVAL      X006_XRLEV7 = 1
     C                   EVAL      X006_XRLEV8 = 0
      *
     C     XMLKEY06      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'LineNo'                               2
     C*                  IF        XSVLI > 0                                      3<-B
     C*                  EXSR      SROPDLIN
     C*                  END                                                      3<-E
      * <LineNo>
     C                   EVAL      XSVLI = XSVLI + 1
     C                   EVAL      SVLI = XSVLI
     C                   WHEN      XRNV = 'CountryOfOrigin'                      2
      * <CountryOfOrigin>
     C                   EXSR      SRX07B21211
     C                   WHEN      XRNV = 'CustomsQuantity'                      2
      * <CustomsQuantity>
     C                   IF        SVNT01 = 0
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVNTM
     C                   Z-ADD     XTAL          SVNT01
     C                   END
     C                   WHEN      XRNV = 'CustomsQuantityUnit'                  2
      * <CustomsQuantityUnit>
     C                   EVAL      SVEH01 = 'PK'
     C                   WHEN      XRNV = 'Description'                          2
      * <Description>
     C                   EVAL      SVVT01 = XRVERD
     C                   WHEN      XRNV = 'HarmonisedCode'                       2
      * <HarmonisedCode>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVVNT
     C                   WHEN      XRNV = 'InvoiceQuantity'                      2
      * <InvoiceQuantity>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   IF        XTAL > 0
     C                   Z-ADD     XTAL          SVNTM
     C                   Z-ADD     XTAL          SVNT01
     C                   END
     C                   WHEN      XRNV = 'InvoiceQuantityUnit'                  2
      * <InvoiceQuantityUnit>
     C                   EVAL      SVEH01 = 'PK'
     C                   WHEN      XRNV = 'LinePrice'                            2
      * <LinePrice>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVBELT
     C                   WHEN      XRNV = 'NetWeight'                            2
      * <NetWeight>
     C                   EVAL      XTXT = XRVERD
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVVKTN
     C                   WHEN      XRNV = 'NetWeightUnit'                        2
      * <NetWeightUnit>
     C                   EXSR      SRX07B21212
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X006_XRLEV7
     C     XMLKEY06      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        SVLI > 0                                     1<-B
     C                   EXSR      SROPDLIN
     C                   END                                                    1<-E
      *
     C     SLX06B2121    ENDSR
      *
      ***********************************************
     C     SRX07B21211   BEGSR
      ***********************************************
      * <CountryOfOrigin>
      *
     C                   EVAL      X007_XRLEV1 = XRLEV1
     C                   EVAL      X007_XRLEV2 = XRLEV2
     C                   EVAL      X007_XRLEV3 = XRLEV3
     C                   EVAL      X007_XRLEV4 = XRLEV4
     C                   EVAL      X007_XRLEV5 = XRLEV5
     C                   EVAL      X007_XRLEV6 = XRLEV6
     C                   EVAL      X007_XRLEV7 = XRLEV7
     C                   EVAL      X007_XRLEV8 = 1
     C                   EVAL      X007_XRLEV9 = 0
      *
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   EVAL      SVLK = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X007_XRLEV8
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX07B21211   ENDSR
      *
      ***********************************************
     C     SRX07B21212   BEGSR
      ***********************************************
      * <NetWeightUnit>
      *
     C                   EVAL      X007_XRLEV1 = XRLEV1
     C                   EVAL      X007_XRLEV2 = XRLEV2
     C                   EVAL      X007_XRLEV3 = XRLEV3
     C                   EVAL      X007_XRLEV4 = XRLEV4
     C                   EVAL      X007_XRLEV5 = XRLEV5
     C                   EVAL      X007_XRLEV6 = XRLEV6
     C                   EVAL      X007_XRLEV7 = XRLEV7
     C                   EVAL      X007_XRLEV8 = 1
     C                   EVAL      X007_XRLEV9 = 0
      *
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
      * <Code>
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD = 'KG'                                  3
     C                   WHEN      XRVERD = 'G'                                   3
     C                   EVAL      SVVKTN = SVVKTN * 1000
     C                   LEAVE
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X007_XRLEV8
     C     XMLKEY07      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX07B21212   ENDSR
      *
      ***********************************************
     C     SRX02C        BEGSR
      ***********************************************
      * <PortOfDestination>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SILKA = %SUBST(XRVERD:1:2)
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02C        ENDSR
      *
      ***********************************************
     C     SRX02D        BEGSR
      ***********************************************
      * <ShipmentIncoTerm>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SILV = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02D        ENDSR
      *
      ***********************************************
     C     SRX02E        BEGSR
      ***********************************************
      * <TotalWeightUnit>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD= 'KG'                                   3
     C                   WHEN      XRVERD= 'G'                                    3
     C                   EVAL      SIVKB = SIVKB * 1000
     C                   ENDSL                                                    3<-E
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02E        ENDSR
      *
      ***********************************************
     C     SRX02F        BEGSR
      ***********************************************
      * <TransportNationality>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   EVAL      SILKT = XRVERD
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02F        ENDSR
      *
      ***********************************************
     C     SRX02G        BEGSR
      ***********************************************
      * <TransportNationality>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Code'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD= 'ROA'                                  3
     C                   EVAL      SITRM = 30
     C                   WHEN      XRVERD= 'SEA'                                  3
     C                   EVAL      SITRM = 10
     C                   WHEN      XRVERD= 'AIR'                                  3
     C                   EVAL      SITRM = 40
     C                   WHEN      XRVERD= 'MAI'                                  3
     C                   EVAL      SITRM = 50
     C                   WHEN      XRVERD= 'RAI'                                  3
     C                   EVAL      SITRM = 20
     C                   ENDSL                                                    3<-E
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02G        ENDSR
      *
      ***********************************************
     C     SRX02H        BEGSR
      ***********************************************
      * <OrganizationAddressCollection>
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'OrganizationAddress'                  2
     C                   EXSR      SRX03H1
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX02H        ENDSR
      *
      ***********************************************
     C     SRX03H1       BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'AddressType'                          2
      * <AddressType>
     C                   EVAL      XADRTYPE = XRVERD
     C                   WHEN      XRNV = 'CompanyName'                          2
      * <CompanyName>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SINAK = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SINAS = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Address1'                             2
      * <Address1>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SIADK1 = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SIADS1 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Address2'                             2
      * <Address2>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   EVAL      SIADK2 = XRVERD
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   EVAL      SIADS2 = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'City'                                 2
      * <City>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   IF        SIADK3 = *BLANKS                                4<-B
     C                   EVAL      SIADK3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SIADK3 = %TRIM(SIADK3) + ' ' + %TRIM(XRVERD)
     C                   END                                                       4-E
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   IF        SIADS3 = *BLANKS                                4<-B
     C                   EVAL      SIADS3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SIADS3 = %TRIM(SIADS3) + ' ' + %TRIM(XRVERD)
     C                   END                                                       4-E
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'PostCode'                             2
      * <PostCode>
     C                   SELECT                                                   3<-B
     C                   WHEN      XADRTYPE = 'ImporterDocumentaryAddress'        3
     C                   IF        SIADK3 = *BLANKS                                4<-B
     C                   EVAL      SIADK3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SIADK3 = %TRIM(XRVERD) + ' ' + %TRIM(SIADK3)
     C                   END                                                       4-E
     C                   WHEN      XADRTYPE = 'SupplierDocumentaryAddress'        3
     C                   IF        SIADS3 = *BLANKS                                4<-B
     C                   EVAL      SIADS3 = XRVERD
     C                   ELSE                                                      4
     C                   EVAL      SIADS3 = %TRIM(XRVERD) + ' ' + %TRIM(SIADS3)
     C                   END                                                       4-E
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X003_XRLEV4
     C     XMLKEY03      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLX03H1       ENDSR
      *
      ***********************************************
     C     SRAVG         BEGSR
      ***********************************************
     C                   MOVE      SVBELT        XSVBELT          11 2
     C                   Z-ADD(H)  SVVKTN        XSVVKTN           9 0
     C                   MOVE      SVNTM         XSVNTM            7 0
      *
     C                   MOVE      AVG1(XN1)     X_AKD             2
     C                   MOVE      AVG2(XN1)     X_ASV             3
     C     KODTS8K       CHAIN     KODTS8                             33
     C   33X_AKD         CHAIN     KODTS8                             33
     C   33              GOTO      SLSRAVG
      *
     C                   IF        AVG3(XN1) = 0                                1<-B
     C                   IF        KS8STY = '%'                                  2<-B
     C     XSVBELT       MULT(H)   XTVFAK        XBEL9N            9 0
     C                   Z-ADD     XBEL9N        AVG3(XN1)
     C                   ELSE                                                    2
     C     KS8STY        IFEQ      'P'                                            3<-B
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C     KS8STY        OREQ      'G'
     C                   IF        KS8AVG <> 'FK'                                  4<-B
     C                   Z-ADD     XSVVKTN       AVG3(XN1)
     C     KS8STY        IFEQ      'G'                                              5<-B
     C                   MULT      1000          AVG3(XN1)
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     KS8STY        IFEQ      'D'                                             4<-B
     C                   EVAL(H)   AVG3(XN1) = XSVNTM / 12 + 0.5
     C                   ELSE                                                      4
     C     KS8STY        IFEQ      'T'                                              5<-B
     C                   EVAL(H)   AVG3(XN1) = XSVVKTN / 1000 + 0.5
     C                   ELSE                                                       5
     C     KS8STY        IFNE      'M'                                               6<-B
     C     KS8STY        ANDNE     'A'
      * KS8STY = '*' ELLER ' '
     C                   Z-ADD     XSVNTM        AVG3(XN1)
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   SELECT
     C     KS8STY        WHENEQ    ' '
     C     KS8STY        OREQ      'K'
     C     KS8STY        OREQ      'G'
     C     KS8STY        OREQ      'M'
     C     KS8STY        OREQ      'D'
     C     KS8STY        OREQ      'T'
     C     KS8STY        OREQ      'L'
     C                   EVAL      AVG5(XN1) = AVG3(XN1) * AVG4(XN1)
     C     KS8STY        WHENEQ    '%'
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      '*'
     C                   EVAL      AVG5(XN1) = AVG3(XN1) * AVG4(XN1) /100
     C     KS8STY        WHENEQ    'P'
     C                   EVAL      AVG5(XN1) = AVG3(XN1) * AVG4(XN1) /1000
     C                   ENDSL
     C     KS8ØRE        IFEQ      '*'
     C                   DIV(H)    100           AVG5(XN1)
     C                   END
      *
     C     SLSRAVG       ENDSR
      *
      ***********************************************
     C     KNVTAL        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTAL
     C     1             DO        15            XN                3 0          1<-B
     C                   IF        ((XT(XN) = *BLANKS) OR (XT(XN) = '.'))        2<-B
     C                   LEAVE
     C                   ENDIF                                                   2<-E
     C                   MULT      10            XTALH
     C                   MOVE      XT(XN)        XTALH
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XT(XN) = '.'                                 1<-B
     C                   ADD       1             XN
     C                   MOVE      XT(XN)        XTALD1
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                 2<-B
     C                   MOVE      XT(XN)        XTALD2
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                  3<-B
     C                   MOVE      XT(XN)        XTALD3
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     CIFSR         BEGSR
      ***********************************************
     C                   MOVE      SIBEL2        XBEL2            11 2
      *
     C     SIVAL3        CHAIN     KODTVAL2                           33
     C  N33              MOVE      KVAOMR        XOMRF             3 0
     C  N33              EVAL      SIVKU = KVAKRS
      *
     C                   MOVE      *ZEROS        XBEL8            11 2
      *
      *** OMREGN FAKTURASUM TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C                   IF        XOMRF <> 0
     C     SIBEL3        MULT      SIVKU         XWORK            16 5
      *   AVRUND CIFSUM
     C     XWORK         DIV(H)    XOMRF         XFAKNO            9 0          DEF. BILDE05
     C                   Z-ADD     XFAKNO        XBEL4             9 0
     C                   END
      *** OMREGN BEARBEDINGSKOSTNAD TIL NORSK KRONE
     C*    XOMRR         IFNE      0
     C*    SIBELR        MULT      XKRSR         XWORK            16 5
     C*    XWORK         DIV(H)    XOMRR         XFAKNO            9 0          DEF. BILDE05
     C*                  Z-ADD     XFAKNO        XBELS             9 0
     C*                  END
      *
     C                   MOVE      *ZEROS        XKOSTN           15 4
      *** EGET FELT FOR PROSENTRABATT I TILLEGG TIL ANDRE KOSTNAD
     C                   IF        SIRAB <> 0
     C     XBEL4         DIV       100           XWORK
     C     XWORK         MULT      SIRAB         XBELC            11 2
     C                   IF        SIDP = 49
     C                   MULT(H)   0.2           XBELC
     C                   END
     C                   SUB(H)    XBELC         XBEL4
     C                   ELSE
     C                   MOVE      *ZEROS        XBELC
     C                   END
      *
      *** OMREGN FRAKT TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C*                  IF        SIBEL1 <> 0
     C*    SIBEL1        MULT(H)   XKRS1         XKOSTN
     C*    XKOSTN        DIV(H)    XOMR1         XKOSTN
     C*                  Z-ADD     XKOSTN        XBEL8
     C*                  ADD(H)    XKOSTN        XBEL4
     C*                  IF        SIDP = 49
     C*                  MULT(H)   0.2           XKOSTN
     C*                  END
     C*                  ADD(H)    XKOSTN        XBELS             9 0
     C*                  END
     C                   MOVE      *ZEROS        XKOSTN
      *
      *** OMREGN ANDRE KOSTNAD TIL NORSK KRONE
      *** OG LEGG DETTE PÅ CIFSUM (XBEL4)
     C                   IF        XBEL2 <> 0
     C*    XBEL2         MULT(H)   XKRS2         XKOSTN
     C*    XKOSTN        DIV(H)    XOMR2         XKOSTN
     C*                  IF        SIDP = 49
     C*                  MULT(H)   0.2           XKOSTN
     C*                  END
     C*                  IF        ((SIFTG2 = '+') OR (SIFTG2 = 'P'))
     C*                  ADD(H)    XKOSTN        XBEL4
     C*                  ELSE
     C*                  SUB(H)    XKOSTN        XBEL4
     C*                  END
     C                   END
     C                   Z-ADD(H)  XKOSTN        XBEL9            11 2
      *
      *** SJEKK OM FORSIKRING SKAL BEREGNES
     C                   IF        KLBFOK = 'A'
     C     XBEL4         MULT      KLBPRM        XWORK
     C     XWORK         DIV(H)    1000          XBELA             7 0
     C                   IF        SIDP = 49
     C                   MULT(H)   0.2           XBELA
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        XBELA
     C                   END
     C                   ADD       XBELA         XBEL4
     C*                  ADD       XBELA         XBELS
      *
     C                   IF        SIBEL3 = 0
     C                   MOVE      *ZEROS        XTVFAK           17 9
     C                   ELSE
     C     XBEL4         DIV(H)    SIBEL3        XTVFAK
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TATEST        BEGSR
      ***********************************************
     C     SIDP          IFGE      60
     C     SIDP          ANDLE     69
     C                   MOVE      'F'           SVPVA
      *
     C                   ELSE
      *
     C                   MOVE      TAORDK        SVPVA
     C                   MOVE      TAORDB        SVAS
     C                   SELECT
     C                   WHEN      SVPRE = 'A'
     C                   MOVE      TAEØSB        SVAS
     C                   WHEN      ((SVPRE = 'B') OR (SVPRE = 'F'))
     C                   MOVE      TAEFB         SVAS
     C                   WHEN      ((SVPRE = 'C') OR (SVPRE = 'E'))
     C                   MOVE      TAEFTB        SVAS
     C                   WHEN      ((SVPRE = 'J') OR (SVPRE = 'N'))
     C                   EXSR      TATES2
     C                   ENDSL
      *
     C                   IF        SVAS = 0
     C                   IF        SVPRE<>'J' AND SVPRE<>'N' AND SVPRE<>' '
     C                   MOVE      'F'           SVPVA
     C                   END
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TATES2        BEGSR
      ***********************************************
      * HELE SUBRUTINE ER OMSKREVET
     C                   SELECT
S01  C*    SVLK          WHENEQ    'HR'                                         KROATIA
N01  C     SVLK          WHENEQ    'SZ'                                         SWAZILAND
     C                   MOVE      TATSJB        SVAS
     C     SVLK          WHENEQ    'TR'                                         TYRKIA
     C                   MOVE      TATYRB        SVAS
     C     SVLK          WHENEQ    'IL'                                         ISRAEL
     C                   MOVE      TAISRB        SVAS
     C     SVLK          WHENEQ    'SG'                                         SINGAPORE
     C                   MOVE      TAELLB        SVAS
     C     SVLK          WHENEQ    'CL'                                         CHILE
     C                   MOVE      TABULB        SVAS
     C     SVLK          WHENEQ    'MK'                                         MAKEDONIA
     C                   MOVE      TAPOLB        SVAS
     C     SVLK          WHENEQ    'KR'                                         SØR KOREA
     C                   MOVE      TAROMB        SVAS
     C     SVLK          WHENEQ    'JO'                                         JORDAN
     C                   MOVE      TAUNGB        SVAS
     C     SVLK          WHENEQ    'TN'                                         TUNISIA
     C                   MOVE      TASLOB        SVAS
     C     SVLK          WHENEQ    'GL'                                         GRØNLAND
     C                   MOVE      TAGRLB        SVAS
     C     SVLK          WHENEQ    'FO'                                         FÆRØYENE
     C                   MOVE      TAFÆRB        SVAS
     C     SVLK          WHENEQ    'IN'                                         INDIA
     C     SVLK          OREQ      'LK'                                         SRI LANKA
     C     SVLK          OREQ      'TH'                                         THAILAND
     C                   MOVE      TAISTB        SVAS
     C     SVLK          WHENEQ    'MA'                                         MAROKKO
     C                   MOVE      TAMARB        SVAS
     C     SVLK          WHENEQ    'MX'                                         MEXICO
     C                   MOVE      TAMEXB        SVAS
     C     SVLK          WHENEQ    'PS'                                         VESTBREDDEN OG GAZA
     C                   MOVE      TAVGAB        SVAS
     C     SVLK          WHENEQ    'LN'                                         LIBANON
     C                   MOVE      TAN01B        SVAS
     C     SVLK          WHENEQ    'EG'                                         EGYPT
     C                   MOVE      TAN03B        SVAS
     C     SVLK          WHENEQ    'CA'                                         CANADA
     C                   MOVE      TAN04B        SVAS
N01  C     SVLK          WHENEQ    'RS'                                         SERBIA
N01  C                   MOVE      TAN05B        SVAS
N01  C     SVLK          WHENEQ    'AL'                                         ALBANIA
N01  C                   MOVE      TAN06B        SVAS
N01  C     SVLK          WHENEQ    'UA'                                         UKRAINA
N01  C                   MOVE      TAN07B        SVAS
N01  C     SVLK          WHENEQ    'PE'                                         PERU
N01  C                   MOVE      TAN08B        SVAS
N01  C     SVLK          WHENEQ    'ME'                                         MONTENEGRO
N01  C                   MOVE      TAN09B        SVAS
N01  C     SVLK          WHENEQ    'HK'                                         HONG KONG
N01  C                   MOVE      TAN10B        SVAS
N01  C     SVLK          WHENEQ    'AE'                                         FORENEDE ARABISK EMI
N01  C     SVLK          OREQ      'BH'                                         BAHRAIN
N01  C     SVLK          OREQ      'SA'                                         SAUDI ARABIA
N01  C     SVLK          OREQ      'OM'                                         OMAN
N01  C     SVLK          OREQ      'QA'                                         RATAR
N01  C     SVLK          OREQ      'KW'                                         KUWAIT
N01  C                   MOVE      TAN13B        SVAS
N01  C     SVLK          WHENEQ    'PA'                                         PANAMA
N01  C                   MOVE      TAN14B        SVAS
N01  C     SVLK          WHENEQ    'CR'                                         COSTA RICA
N01  C                   MOVE      TAN15B        SVAS
N01  C     SVLK          WHENEQ    'CO'                                         COLOMBIA
N01  C                   MOVE      TAN16B        SVAS
N01  C     SVLK          WHENEQ    'GE'                                         GEORGIA
N01  C                   MOVE      TAN17B        SVAS
N01  C     SVLK          WHENEQ    'BA'                                         BOSNA HERCEGOVINA
N01  C                   MOVE      TAN18B        SVAS
N01  C     SVLK          WHENEQ    'PH'                                         FILIPPINENE
N01  C                   MOVE      TAN19B        SVAS
S02  C*    SVLK          WHENEQ    '??'                                         STORBRITANIA EØS
N02  C     SVLK          WHENEQ    'GB'                                         STORBRITANIA
N01  C                   MOVE      TAN20B        SVAS
S02  C*    SVLK          WHENEQ    '??'                                         STORBRITANIA EF
S02  C*                  MOVE      TAN21B        SVAS
N01  C     SVLK          WHENEQ    'ID'                                         INDONESIA
N01  C                   MOVE      TAN22B        SVAS
N01  C     SVLK          WHENEQ    'EC'                                         ECUARDOR
N01  C                   MOVE      TAN23B        SVAS
N01  C     SVLK          WHENEQ    'BW'                                         BOTSWANA
N01  C     SVLK          OREQ      'NA'                                         NAMIBIA
N01  C     SVLK          OREQ      'SZ'                                         SWAZILAND
N01  C                   MOVE      TAN11B        SVAS
     C     KS2MO         WHENEQ    'M'                                          MINST UTVIKLEDE LAND
     C                   MOVE      TAMULB        SVAS
     C     KS2MO         WHENEQ    'O'                                          ORDINÆRE UTV.LAND
     C                   MOVE      TAOULB        SVAS
     C     KS2MO         WHENEQ    'S'                                          SACU
     C                   MOVE      TAOULB        SVAS
N01  C     KS2MO         WHENEQ    'L'                                          LAVERE M.INNT.LAND
N01  C                   MOVE      TAN12B        SVAS
     C                   ENDSL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDLIN      BEGSR
      ***********************************************
     C                   EVAL      SVAVD = SIAVD
     C                   EVAL      SVTDN = SITDN
     C                   EVAL      SVLN  = SVLI
     C                   EVAL      SVMFR = '1'
     C                   EVAL      SVVF  = '1'
      *
     C                   IF        SVVNT <> 0                                   1<-B
     C     KODTS2KV      CHAIN     KODTS2                             33
     C  N33              EVAL      SVPRE  = KS2PRE
      *
     C                   SELECT                                                  2<-B
     C                   WHEN      ((SVVKTB = 0) AND (SVVKTN = 0))               2
     C                   EVAL      SVVKTB = 1
     C                   EVAL      SVVKTN = 1
     C                   WHEN      SVVKTB = 0                                    2
     C                   EVAL(H)   SVVKTB = SVVKTN * 1.1
     C                   WHEN      SVVKTN = 0                                    2
     C                   EVAL(H)   SVVKTN = SVVKTN * 0.9
     C                   ENDSL                                                   2<-E
      * TEST TOLL
     C                   MOVE      'N'           XTOLL             1
     C     1             DO        7             XN1                             2<-B
     C                   SELECT                                                   3<-B
     C                   WHEN      ((AVG1(XN1) = 'TL') AND (AVG4(XN1) = 0))       3
     C                   EVAL      SVPVA = 'F'
     C                   EVAL      SVAS  = 0
     C                   EVAL      XTOLL = 'J'
     C                   LEAVE
     C                   WHEN      AVG1(XN1) = 'TL' AND AVG4(XN1) <> 0 AND        3
     C                             AVG4(XN1) < 1000
     C                   EVAL      SVAS  = AVG4(XN1)
     C                   EVAL      XTOLL = 'J'
      *
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE(N) TARI                                   33
     C                   DOW       *IN33 = *OFF                                    4<-B
     C                   IF        TADATO <= WDT08                                  5<-B
     C                   IF        TAORDB = SVAS OR                                  6<-B
     C                             TAEØSB = SVAS OR
     C                             TAEFB  = SVAS OR
     C                             TAEFTB = SVAS OR
     C                             TATYRB = SVAS OR
     C                             TAISRB = SVAS OR
     C                             TAELLB = SVAS OR
     C                             TAPOLB = SVAS OR
     C                             TAROMB = SVAS OR
     C                             TAUNGB = SVAS OR
     C                             TAGRLB = SVAS OR
     C                             TAFÆRB = SVAS OR
     C                             TAISTB = SVAS OR
     C                             TAMARB = SVAS OR
     C                             TAMEXB = SVAS OR
     C                             TAVGAB = SVAS OR
     C                             TAN01B = SVAS OR
     C                             TAN03B = SVAS OR
     C                             TAN04B = SVAS OR
     C                             TAMULB = SVAS OR
     C                             TAOULB = SVAS
     C                   EVAL      SVPVA = TAORDK
     C                   LEAVE
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C     TARIK         READPE(N) TARI                                   33
     C  N33              ENDDO                                                     4<-E
      *
     C                   LEAVE
     C                   ENDSL                                                    3<-E
     C                   ENDDO                                                   2<-E
     C                   IF        XTOLL = 'N'                                   2<-B
     C                   EVAL      SVPVA = 'F'
     C                   EVAL      SVAS  = 0
     C                   END                                                     2<-E
      *
     C     1             DO        7             XN1               3 0           2<-B
     C                   IF        AVG1(XN1) <> *BLANKS                           3<-B
     C                   IF        AVG1(XN1) <> 'TL' OR AVG4(XN1) >= 1000          4<-B
     C                   EXSR      SRAVG
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
      *
      * UNDERSTELLSNR SKAL LIGGE PÅ HOVEDLINJE
     C     1             DO        7             XN1                             2<-B
     C                   IF        DOK1(XN1) = 'VI'                               3<-B
     C                   EVAL      SVEH01  = 'U.NR'
     C                   EVAL      SVNT01  = 1
     C                   EVAL      SVFT01  = DOK2(XN1)
     C     XN1           DO        6             XN2               3 0             4<-B
     C                   EVAL      DOK1(XN2) = DOK1(XN2+1)
     C                   EVAL      DOK2(XN2) = DOK2(XN2+1)
     C                   ENDDO                                                     4<-E
     C                   EVAL      DOK1(7) = *BLANKS
     C                   EVAL      DOK2(7) = *BLANKS
     C                   LEAVE
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
      *
     C                   WRITE     SADVR
     C                   END                                                    1<-E
      *
     C                   CLEAR                   SADVR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDHOD      BEGSR
      ***********************************************
      *
     C                   EXSR      CIFSR
      *
     C     KODTLBK       CHAIN     KODTLB                             33
     C  N33              MOVE      KLBKT         SILV2
     C  N33              IF        KLBHAD = 'A'                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      SIADS3 <> *BLANKS                             2
     C                   MOVEL     SIADS3        SILVT
     C                   WHEN      SIADS2 <> *BLANKS                             2
     C                   MOVEL     SIADS2        SILVT
     C                   OTHER                                                   2
     C                   MOVEL     SIADS1        SILVT
     C                   ENDSL                                                   2<-E
     C                   ELSE                                                   1
      * KLBHAD = 'M'
     C                   SELECT                                                  2<-B
     C                   WHEN      SIADK3 <> *BLANKS                             2
     C                   MOVEL     SIADK3        SILVT
     C                   WHEN      SIADK2 <> *BLANKS                             2
     C                   MOVEL     SIADK2        SILVT
     C                   OTHER                                                   2
     C                   MOVEL     SIADK1        SILVT
     C                   ENDSL                                                   2<-E
      *
     C                   END                                                    1<-E
      *
     C     KODTS2K       CHAIN     KODTS2                             33
     C  N33              IF        KS2PRE = 'A'  OR KS2PRE = 'B' OR
     C                             KS2PRE = 'C'
     C                   MOVE      'EU'          SIDTY
     C                   ELSE
     C                   MOVE      'IM'          SIDTY
     C                   END
      *
     C                   MOVE      *ZEROS        SIKDH
     C                   MOVE      *BLANKS       SIKDTR
     C                   MOVE      *ZEROS        SIAS
     C                   MOVE      *ZEROS        SIMP
     C                   MOVE      *BLANKS       SIDTØ
     C                   MOVE      *BLANKS       SI0035
     C                   MOVE      WDT           SIDT
     C                   MOVE      'I'           SISKI
      *
     C                   MOVE      'CW1'         SISG
     C     KODTSIK       CHAIN     KODTSI                             33
     C  N33              EVAL      SITARF = KSINAV
     C   33              EVAL      SITARF = 'CARGO WISE 1'
     C                   MOVE      'A'           SIUR
     C                   MOVE      ' '           SIST
     C                   Z-ADD     3             SIMP
     C                   MOVE      XBEL4         SIBEL4
     C                   MOVE      XBEL8         SIBEL8
     C                   MOVE      XBEL9         SIBEL9
     C                   MOVE      XBELA         SIBELA
     C                   MOVE      SIVAL2        SIVALB
     C                   MOVE      *ZEROS        SIBELS
     C                   MOVE      XBELC         SIBELC
      *
     C                   WRITE     SADHR
      *
     C                   EXSR      SROPDEDIM
      *
     C                   EXSR      SROPDTT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDEDIM     BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = X_S0004
     C                   EVAL      M0010 = X_S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'UNISHI'
     C                   EVAL      M0068 = S0020 + '-IMP'
     C                   MOVEL     '929'         M1001
     C                   EVAL      M1004 = S0020
     C                   EVAL      M1225 = 'SHI'
     C                   EVAL      M1N07 = 'IMP'
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'R'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDTT       BEGSR
      ***********************************************
      *
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   EVAL      TTUSER = ZUSER
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   EVAL      TTNAME = 'SYXML51'
     C                   EVAL      TTTEXT = 'SAD document import is entered by '
     C                             + 'CW1 shipment IMPORT'
     C                   EVAL      TTTEXL = 'SAD dokument import er laget av '
     C                             + 'CW1 shipment IMPORT'
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSNDCW1      BEGSR
      ***********************************************
     C                   IF        SIAVD <> 0
      * Send UniversalEvent til CW1 etter mottak av shipment
     C                   MOVE      SIAVD         UAVD              4
     C                   MOVE      SITDN         UTDN              7
     C                   MOVE      'IMP'         UIE               3
     C                   CALL      'SYXML52'
     C                   PARM                    USN
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    UIE
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    USN               9
      *
     C     FRISOKK       KLIST
     C                   KFLD                    FSAVD
     C                   KFLD                    FSOPD
     C                   KFLD                    F00_FSKODE
     C     *LIKE         DEFINE    FSKODE        F00_FSKODE
     C                   EVAL      F00_FSKODE = 'ORD'
     C     FRISOL01K     KLIST
     C                   KFLD                    F01_FSKODE
     C                   KFLD                    FSSOK
     C     *LIKE         DEFINE    FSKODE        F01_FSKODE
     C                   EVAL      F01_FSKODE = '*CR'
     C     KODTLBK       KLIST
     C                   KFLD                    KLBUNI
     C                   KFLD                    SILV
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    SISG
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SILKA
     C     KODTS2KV      KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    SVLK
     C     KODTS8K       KLIST
     C                   KFLD                    X_AKD
     C                   KFLD                    X_ASV
     C     KODTVAL2K3    KLIST
     C                   KFLD                    XSIVAL3
     C                   KFLD                    XDTVKU
     C     XMLKEY01      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X001_XRLEV1
     C                   KFLD                    X001_XRLEV2
     C                   KFLD                    X001_XRLEV3
     C     XMLKEY02      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY03      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY04      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X004_XRLEV1
     C                   KFLD                    X004_XRLEV2
     C                   KFLD                    X004_XRLEV3
     C                   KFLD                    X004_XRLEV4
     C                   KFLD                    X004_XRLEV5
     C                   KFLD                    X004_XRLEV6
     C     XMLKEY05      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X005_XRLEV1
     C                   KFLD                    X005_XRLEV2
     C                   KFLD                    X005_XRLEV3
     C                   KFLD                    X005_XRLEV4
     C                   KFLD                    X005_XRLEV5
     C                   KFLD                    X005_XRLEV6
     C                   KFLD                    X005_XRLEV7
     C     XMLKEY06      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X006_XRLEV1
     C                   KFLD                    X006_XRLEV2
     C                   KFLD                    X006_XRLEV3
     C                   KFLD                    X006_XRLEV4
     C                   KFLD                    X006_XRLEV5
     C                   KFLD                    X006_XRLEV6
     C                   KFLD                    X006_XRLEV7
     C                   KFLD                    X006_XRLEV8
     C     XMLKEY07      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X007_XRLEV1
     C                   KFLD                    X007_XRLEV2
     C                   KFLD                    X007_XRLEV3
     C                   KFLD                    X007_XRLEV4
     C                   KFLD                    X007_XRLEV5
     C                   KFLD                    X007_XRLEV6
     C                   KFLD                    X007_XRLEV7
     C                   KFLD                    X007_XRLEV8
     C                   KFLD                    X007_XRLEV9
     C     TARIK         KLIST
     C                   KFLD                    SVVNT
     C     TARIKM        KLIST
     C                   KFLD                    SVVNT
     C                   KFLD                    TATAR
     C                   KFLD                    XTADATO
     C                   MOVE      99999999      XTADATO
      *
     C     *LIKE         DEFINE    SIAVD         XAVD
     C     *LIKE         DEFINE    SITDN         XTDN
     C     *LIKE         DEFINE    SIBEL3        XSIBEL3
     C     *LIKE         DEFINE    SIFIF         XSIFIF
     C     *LIKE         DEFINE    SVLI          XSVLI
     C     *LIKE         DEFINE    SIVAL3        XSIVAL3
     C     *LIKE         DEFINE    XRLEV1        X001_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X001_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X001_XRLEV3
     C     *LIKE         DEFINE    XRLEV1        X002_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X002_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X002_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X002_XRLEV4
     C     *LIKE         DEFINE    XRLEV1        X003_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X003_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X003_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X003_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X003_XRLEV5
     C     *LIKE         DEFINE    XRLEV1        X004_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X004_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X004_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X004_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X004_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X004_XRLEV6
     C     *LIKE         DEFINE    XRLEV1        X005_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X005_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X005_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X005_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X005_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X005_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X005_XRLEV7
     C     *LIKE         DEFINE    XRLEV1        X006_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X006_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X006_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X006_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X006_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X006_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X006_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X006_XRLEV8
     C     *LIKE         DEFINE    XRLEV1        X007_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X007_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X007_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X007_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X007_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X007_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X007_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X007_XRLEV8
     C     *LIKE         DEFINE    XRLEV9        X007_XRLEV9
     C     *LIKE         DEFINE    TADATO        XTADATO
     C     *LIKE         DEFINE    S0004         X_S0004
     C     *LIKE         DEFINE    S0010         X_S0010
      *
     C                   MOVE      USN           XRSN
     C                   MOVE      'LB'          KLBUNI
     C                   MOVE      'SI'          KSIUNI
     C                   MOVE      'S2 '         KS2UNI
     C                   MOVE      *BLANKS       XMSGTXT         200
     C                   MOVE      *ZEROS        SITRT
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT08             8 0
     C                   MOVE      WDT           XDTVKU            8 0
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   CLEAR                   SADHR
     C                   CLEAR                   SADVR
     C                   EVAL      SIBELC = 0
     C                   EVAL      SIRAB  = 0
     C     XRSN          CHAIN     EDIS                               33
     C                   MOVE      S0004         X_S0004
     C                   MOVE      S0010         X_S0010
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for håndtering av feil                         SRERROR /
      *////////////////////////////////////////////////////////////
     C     SRERROR       BEGSR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XDT               8 0
     C                   MOVE      WTM           XTM               6 0
     C                   EVAL      XMSG = 'Feil ved SAD-import, '
     C                             + 'PROGRAM = SYXML51, '
     C                             + 'DATO = ' + %TRIM(%EDITW(XDT:'    .  .  '))
     C                             + ', '
     C                             + 'TID = ' + %TRIM(%EDITW(XTM:'  :  :  '))
     C                             + '. '
     C                             + %TRIM(XMSGTXT)
     C                   CALL      'EDIERRC'
     C                   PARM                    XMSG            256
      *
     C                   ENDSR
      *
