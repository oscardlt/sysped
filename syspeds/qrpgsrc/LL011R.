********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 OPPDATER REGISTRERINGSDATO
10XXX * 02 YBC PTF10 BLANDET INDIKATOR 52 OG 98
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 03 JOV PTF10 F15=DK SAD IMP  F15=DK SAD IMP
10XXX * 04 JOV PTF10 ved utfylt landkode vis det som siste del av navn
10XXX * 05 JOV Option K på en som allerede er Klar betyr å blanke Kstatus
11XXX * 06 YBC PTF11 M = SPLITT PLUKKLISTE
********************************************************************
     FLL011D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     FKODTP     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTELL      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTRAN      IF   E           K DISK
     FVADR      IF   E           K DISK
     FVADR3     IF   E           K DISK    RENAME(VADRR:VADRR3)
     FKUNKO2    IF   E           K DISK
     FKUFAST    IF   E           K DISK
     F                                     RENAME(KOFASTR:KUFASTR)
     FKOFAST    IF   E           K DISK
     FLLKUNF    IF   E           K DISK
     FLLHEAD    UF A E           K DISK
     FLLHEAD01  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADR1)
     FLLHEAD02  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADR2)
     FLLHEAD15  IF   E           K DISK    RENAME(LLHEADR:LLHEADR15)
     F                                     PREFIX(LH15_)
     FLLLINE    UF   E           K DISK
     FLLHETXT   IF   E           K DISK
     FLLAGJL01  IF   E           K DISK    PREFIX(AL1_)
     FLLAGJD02  IF   E           K DISK
     FLLSERL02  UF   E           K DISK
     FLLW013    O  A E             DISK    USROPN
     FLLTELL    UF A E             DISK
     FLLLSDF    IF   E           K DISK
     FLLVMLS    UF A E           K DISK
     FLLAUTF    IF   E           K DISK
     D EX              S              7  0 DIM(900)
     D UAN             S              7    DIM(90)
     D URC             S              5  0 DIM(90)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D UCMD            DS          1024
     D                 DS
     D XCMD10          C                   CONST('CLRPFM -
     D                                     FILE(QTEMP/LLW013)')
     D                 DS
     D  LHBNR                  1     17
     D  SLETT                  1      8
     D  OVERF                  1      8
     D                 DS
     D  LHBNA                  1     30
     D  XHBNA                  1     21
N04  D  XHBNALK               18     21
     D                 DS
     D  W2TDT                  1      8  0
     D  W2TDTÅ                 1      4  0
     D  W2TDTM                 5      6  0
     D  W2TDTD                 7      8  0
S01  D*                DS
S01  D* WTIME                  1     14  0
S01  D* WTM                    1      6  0
S01  D* WDD                    7      8  0
S01  D* WMM                    9     10  0
S01  D* WÅÅ                   11     14  0
S01  D*                DS
S01  D* XIDAG                  1      8  0
S01  D* XIDAGÅ                 1      4  0
S01  D* XIDAGM                 5      6  0
S01  D* XIDAGD                 7      8  0
     D                 DS
     D  WSTDT                  1      8  0
     D  WSTDTÅ                 1      4  0
     D  WSTDTM                 5      6  0
     D  WSTDTD                 7      8  0
     D                 DS
     D  VADRN3                 1     30
     D  VXPNR                  1      4
     D  VXBLAN                 5      5
     D  VXSTED                 6     30
     D  VXBLA2                 5      6
     D  VXSTD2                 7     30
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                UDS
     D  UFIRM                  1      2
     D  UDSAVD                15     18  0
     D  UDSSG                 19     21
      *
      *
     C                   EXSR      INIT
     C                   EXSR      HOVED
     C                   MOVE      '1'           *INLR
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    *IN03         WIN03
     C     *LIKE         DEFINE    *IN30         WIN30
     C     *LIKE         DEFINE    WSTDT         WWTDT
     C     *LIKE         DEFINE    WSBNR         WWBNR
     C     *LIKE         DEFINE    WSORDR        WWORDR
     C     *LIKE         DEFINE    WSPAK         WWPAK
     C     *LIKE         DEFINE    W2ALN         WWALN
     C     *LIKE         DEFINE    LHANT0        UANT0
     C     *LIKE         DEFINE    LHANTL        UANTL
     C     *LIKE         DEFINE    LHAEH1        UAEH1
     C     *LIKE         DEFINE    LHANT1        UANT1
     C     *LIKE         DEFINE    LHAEH2        UAEH2
     C     *LIKE         DEFINE    LHANT2        UANT2
     C     *LIKE         DEFINE    LHAEH3        UAEH3
     C     *LIKE         DEFINE    LHANT3        UANT3
     C     *LIKE         DEFINE    LHVEK         UVEK
     C     *LIKE         DEFINE    LHKUB         UKUB
     C     *LIKE         DEFINE    LHTLIN        UTLIN
     C     *LIKE         DEFINE    LHALN         XALNG
      *
     C     *ENTRY        PLIST
     C                   PARM                    UGRP              8 0
     C                   PARM                    UPNR              8 0
     C                   PARM                    UPDATE            1
     C                   PARM                    UALNIN            7 0
      *
     C     UPNR          CHAIN     LLAUTF                             33
     C                   IF        *IN33 = *OFF
     C     LLAUTFK       KLIST
     C                   KFLD                    UPNR
     C                   KFLD                    ZUSER
     C     LLAUTFK       CHAIN     LLAUTF                             33
     C   33              MOVE      '1'           *INLR
     C   33              RETURN
     C                   END
      *
     C                   MOVE      UGRP          LHGRP
     C                   MOVE      UPNR          LHPNR
     C                   MOVEL     '*JOB'        WSPRT
     C                   MOVE      'A'           WSMOD
     C                   MOVE      'J'           WSFBR
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
      *
     C     KUFASK        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C     PROKEY        KLIST
     C                   KFLD                    PROTYP
     C                   KFLD                    WSPRKD
     C                   MOVEL     'FRBREVPR'    PROTYP           10
     C                   MOVE      'O '          PROTYP
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    WSAVDP
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI            1
     C                   Z-ADD     UDSAVD        WSAVDP            4 0
     C     KODSFK        KLIST
     C                   KFLD                    KOSFUN
     C                   KFLD                    WSSG
     C                   MOVE      'SF'          KOSFUN
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    LHPNR
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     TRANK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSTN
     C     VADRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C                   KFLD                    KUVADR
     C     VADR3KEY      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C                   KFLD                    LH15_LHBNR
     C     LLHEAD15K     KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LH15_LHALN
     C     KUNKOK        KLIST
     C                   KFLD                    LHPNR
     C                   KFLD                    KUINTN
     C     LLVMLSK       KLIST
     C                   KFLD                    UPNR
     C                   KFLD                    WSBNR
     C     KEY1          KLIST
     C                   KFLD                    LHSTA
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C     VMAX          KLIST
     C                   KFLD                    LHMN
     C                   KFLD                    YYMAX
     C                   MOVE      999           YYMAX             3 0
      *
     C                   READ      FIRM                                   33
      *
     C     KUNKEY        CHAIN     CUNDL01                            33
     C   33              MOVE      *BLANKS       KNAVN
     C* Update tillatt ??
     C     UPDATE        COMP      'J'                                5050       *NONDISP
     C                   MOVE      *ZEROS        W2TDT
     C                   MOVE      'S'           UMODE             1
     C                   MOVE      UGRP          UGRP8             8
     C                   MOVE      UPNR          UPNR8             8
     C                   MOVE      'J'           UOPTXT            1
      *
S01  C*                  TIME                    WTIME
S01  C*                  MOVE      WÅÅ           XIDAGÅ
S01  C*                  MOVE      WMM           XIDAGM
S01  C*                  MOVE      WDD           XIDAGD
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      WDT           XIDAG             8 0
      *
     C     UALNIN        IFNE      0
     C     UALNIN        CHAIN     LLHEAD02                           33
     C                   EXSR      CHGLH
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C                   ENDSR
      *
      *
      *////////////////////////////////////////////////////////////
     C     HOVED         BEGSR
      *////////////////////////////////////////////////////////////
      *______________
      * Tømme Subfile
      *""""""""""""""
      *
     C     START         TAG
      * HUSK PÅ SIST BENYTTEDE FILTERVERDIER I WW-VARIABLE
     C                   MOVE      W2TDT         WWTDT
     C                   MOVE      W2BNR         WWBNR
     C                   MOVE      W2ORDR        WWORDR
     C                   MOVE      W2PAK         WWPAK
     C                   MOVE      W2ALN         WWALN
      *
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '000'         *IN(93)
     C                   Z-ADD     *ZERO         ZRECNO
     C     KEY1          SETLL     LLHEAD01
      *_____________
      * Fyll Subfile (med alle poster uavhengig av linjer pr side)
      *"""""""""""""
     C     KEY1          READE     LLHEAD01                               94
     C     *IN94         DOWEQ     '0'
      * FILTER...
     C                   EXSR      FILTER
     C     OMIT          CABEQ     'J'           NESTE
      * N61=FRITEKST FINNES - HIGHLIGHT KUNDES ORDRENR.
     C     LHMN          CHAIN     LLHETXT                            61
N04  c     LHBLK         ifne      '  '
N04  c                   eval      XHBNALK= '('+LHBLK+')'
N04  c                   endif
      *
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
      *
     C     NESTE         TAG
     C     KEY1          READE     LLHEAD01                               94
     C  N94              END
      *
     C     UT            TAG
      *
      *_______________
      * Ingen record fantes??
      *_______________
     C     ZRECNO        IFEQ      0
     C                   WRITE     BLANKREC
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     5             POSNBR
     C                   EXFMT     NOREC
     C                   MOVE      '0'           *IN30
     C                   ELSE
      *
      *_______________
      * Bevar sist brukt recno, vis subfila fra post begynnelsen
      *_______________
      *
     C     *LIKE         DEFINE    ZRECNO        XRECNO
     C                   MOVE      ZRECNO        XRECNO
     C                   Z-ADD     1             ZRECNO
      *
     C     STBILD        TAG
      *
     C                   MOVEA     '11'          *IN(91)
     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     BLANKREC
     C                   WRITE     BOTREC
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   EXFMT     SUBCTL
     C                   END
      *
     C     *IN12         CABEQ     '1'           UTHOV
     C     *IN03         CABEQ     '1'           UTHOV
      *
     C                   MOVEA     '00'          *IN(91)
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      UT
     C                   END
      *
     C     *IN04         IFEQ      '1'
     C                   CALL      'SYFA81B'
     C                   PARM      UPNR          UPNR2             8 0
     C                   PARM                    W2BNR
     C                   PARM                    UKN               8 0
     C     W2BNR         IFEQ      *BLANKS
     C                   GOTO      UT
     C                   ELSE
     C                   GOTO      START
     C                   END
     C                   END
      *_____________
      * F5=Frisk opp
      *"""""""""""""
     C     *IN05         CABEQ     '1'           START
      *_____________
      * F6=Lag ny
      *"""""""""""""
     C     *IN06         IFEQ      '1'
     C     UPNR          ANDNE     0
     C                   EXSR      CRTNEW
     C                   GOTO      START
     C                   END
      *
      *
     C     *IN08         IFEQ      '1'
     C                   EXFMT     FILTERD
     C   12              GOTO      UT
     C                   GOTO      START
     C                   END
      *
     C     *IN10         IFEQ      '1'
     C                   MOVE      *BLANKS       UORDR
     C                   MOVE      UGRP          UGRP8
     C                   MOVE      UPNR          UPNR8
     C                   CALL      'LL075R'
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   PARM                    UORDR            17
     C     UORDR         IFNE      *BLANKS
     C                   MOVE      *ZEROS        W2ALN
     C                   MOVE      *ZEROS        W2TDT
     C                   MOVE      *BLANKS       W2BNR
     C                   MOVE      UORDR         W2ORDR
     C                   MOVE      *BLANKS       W2PAK
     C                   MOVE      *BLANKS       W2FLN
     C                   MOVE      *ZEROS        W2BPNF
     C                   MOVE      *ZEROS        W2BPNT
     C                   MOVE      *BLANKS       W2BLK
     C                   MOVE      *BLANKS       W2BPUF
     C                   MOVE      *BLANKS       W2BPUT
     C                   MOVE      *ZEROS        W2TN
     C                   END
     C                   GOTO      START
     C                   END
N03   *_____________
N03   * F15=DK SAD IMP
N03   *"""""""""""""
N03  C     *IN15         IFEQ      '1'
N03  C                   MOVE      UPNR          UPNR8
N03  C                   CALL      'DKI503C'
N03  C                   PARM                    UPNR8
N03  C                   GOTO      START
N03  C                   END
N03   *_____________
N03   * F16=DK SAD EKSP
N03   *"""""""""""""
N03  C     *IN16         IFEQ      '1'
N03  C                   MOVE      UPNR          UPNR8
N03  C                   CALL      'DKE503C'
N03  C                   PARM                    UPNR8
N03  C                   GOTO      START
N03  C                   END
      *************
      *_____________
      * F23=FLERE OPSJONER
      *"""""""""""""
     C     *IN23         IFEQ      '1'
     C                   SELECT
     C     *IN51         WHENEQ    '0'
     C     *IN49         ANDEQ     '0'
     C                   MOVE      '1'           *IN51
     C     *IN51         WHENEQ    '1'
     C     *IN49         ANDEQ     '0'
     C                   MOVE      '1'           *IN49
     C                   OTHER
     C                   MOVE      '0'           *IN51
     C                   MOVE      '0'           *IN49
     C                   ENDSL
     C                   GOTO      UT
     C                   END
      *_____________
      * Options på topplinja
      *"""""""""""""
     C     TOPOPT        IFEQ      '1'
     C     UPNR          ANDNE     0
     C                   EXSR      CRTNEW
      * Søk utvalg til gammel verdi.. Vis subfila fra front igjen..
     C                   MOVE      WWTDT         W2TDT
     C                   MOVE      ' '           TOPOPT
     C                   GOTO      START
     C                   END
      *_________________
      * Nytt søk/utvalg
      *"""""""""""""""""
     C     W2TDT         IFNE      WWTDT
     C     W2BNR         ORNE      WWBNR
     C     W2ORDR        ORNE      WWORDR
     C     W2PAK         ORNE      WWPAK
     C     W2ALN         ORNE      WWALN
     C                   MOVE      *BLANKS       W2FLN
     C                   MOVE      *ZEROS        W2BPNF
     C                   MOVE      *ZEROS        W2BPNT
     C                   MOVE      *BLANKS       W2BLK
     C                   MOVE      *BLANKS       W2BPUF
     C                   MOVE      *BLANKS       W2BPUT
     C                   MOVE      *ZEROS        W2TN
     C                   GOTO      START
     C                   END
      *_______
      * Valg ?
      *"""""""
     C                   MOVE      '0'           *IN52
     C                   MOVE      '0'           *IN30
     C     ZRECNO        IFEQ      0
     C                   GOTO      UT
     C                   ELSE
     C     *IN52         DOWEQ     '0'
     C                   READC     SUBFIL                                 52
     C  N52              EXSR      OPTION
N06  C     X_SPLITT      CABEQ     'J'           START
     C  N30
     CANN52              END
     C                   END
      *
     C     *IN03         CABEQ     '1'           UTHOV
     C                   GOTO      STBILD
      *
     C     UTHOV         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     FILTER        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'N'           OMIT              1
      *
     C     1             DO        900           XN                3 0
     C     EX(XN)        IFEQ      0
     C                   LEAVE
     C                   ELSE
     C     EX(XN)        IFEQ      LHMN
     C                   MOVE      'J'           OMIT
     C                   LEAVE
     C                   END
     C                   END
     C                   END
      *
     C     W2ALN         IFEQ      0
      * FILTER...
     C     W2TDT         IFNE      *ZEROS
     C     W2TDT         ANDNE     LHTDT
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C     W2BNR         IFNE      *BLANKS
     C     W2BNR         ANDNE     LHBNR
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C     W2ORDR        IFNE      *BLANKS
     C     W2ORDR        ANDNE     LHORDR
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C     W2PAK         IFNE      *BLANKS
     C     W2PAK         ANDNE     LHPAK
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C     W2FLN         IFNE      *BLANKS
     C     W2FLN         ANDNE     LHFLN
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C     W2BPNF        IFNE      0
     C     W2BPNT        IFEQ      0
     C                   MOVE      W2BPNF        W2BPNT
     C                   END
     C     W2BPNF        IFGT      LHBPN
     C     W2BPNT        ORLT      LHBPN
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
     C                   END
      *
     C     W2BLK         IFNE      *BLANKS
     C     W2BLK         ANDNE     'NO'
     C     W2BPUT        IFEQ      *BLANKS
     C                   MOVE      W2BPUF        W2BPUT
     C                   END
     C     W2BPUF        IFGT      LHBPU
     C     W2BPUT        ORLT      LHBPU
     C     W2BLK         ORNE      LHBLK
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
     C                   END
      *
     C     W2TN          IFNE      0
     C     W2TN          ANDNE     LHTN
     C                   MOVE      'J'           OMIT
     C                   GOTO      UTFILT
     C                   END
      *
     C                   ELSE
      *
     C     W2ALN         IFNE      LHALN
     C                   MOVE      'J'           OMIT
     C                   END
      *
     C                   END
      *
     C     UTFILT        ENDSR
      *
      *
      *////////////////////////////////////////////////////////////
     C     OPTION        BEGSR
      *////////////////////////////////////////////////////////////
N06  C                   MOVE      'N'           X_SPLITT          1
N06   *
     C     SLETT         IFNE      '*SLETT  '                                   1<-B
     C     OVERF         ANDNE     '*OVERFØR'
     C     UPDATE        ANDEQ     'J'
      * ENDRE HEADING/LINJEE (OPT. 2) ELLER LINJER (OPT. 7)
     C     WSNR          IFEQ      '2'                                           2<-B
     C     WSNR          OREQ      '7'
     C     LHMN          CHAIN(N)  LLHEAD                             33
     C  N33              EXSR      CHGLH
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * SLETTE HEADING
     C     WSNR          IFEQ      '4'                                           2<-B
     C     LHMN          CHAIN(N)  LLHEAD                             33
     C  N33              EXSR      DLTLH
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * TA BORT ARBEIDSLISTENR.
     C     WSNR          IFEQ      '9'                                           2<-B
     C     LHMN          CHAIN     LLHEAD                             33
     C                   MOVE      *ZEROS        LHALN
     C                   UPDATE    LLHEADR
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * VIS FRITEKST
     C     WSNR          IFEQ      'F'                                           2<-B
      * IKKE FERDIG PROGRAMMERT.
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
N06   * SPLITT PLUKKLISTE
N06  C     WSNR          IFEQ      'D'                                           2<-B
N06  C                   EXSR      SPLITT
N06  C                   MOVE      ' '           WSNR
N06  C                   UPDATE    SUBFIL
N06  C                   GOTO      SLOPT
N06  C                   END                                                     2<-E
      * PLUKKLISTE
     C     WSNR          IFEQ      'P'                                           2<-B
     C                   EXSR      ARBLIS
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * SAMLE PLUKKLISTE
     C     WSNR          IFEQ      'S'                                           2<-B
     C                   EXSR      SAMLIS
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * KONTROLL
     C     WSNR          IFEQ      'K'                                           2<-B
N05  c     LHST1         ifeq      'K'
N05  C     LHMN          CHAIN     LLHEAD                             33
N05  C                   MOVE      ' '           LHST1
N05  C                   UPDATE    LLHEADR
N05  c                   else
     C                   EXSR      KTRREC
N05  c                   endif
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      * OVER TIL DISTRIBUSJONS OPPDRAG
     C     WSNR          IFEQ      'O'                                           2<-B
     C     LHALN         ANDNE     0
     C     LHST1         IFNE      'K'
     C                   EXSR      KTRREC
     C                   END
     C                   EXSR      TILOPD
     C                   GOTO      SLOPT
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
     C     SLOPT         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CRTNEW        BEGSR
      *////////////////////////////////////////////////////////////
     C     XRECNO        IFEQ      *ZEROS
     C                   WRITE     SUBCTL
     C                   END
     C                   MOVE      'M'           LHOPR
     C                   MOVE      *BLANKS       LHSTA
     C                   MOVE      *ZEROS        LHMN
     C                   MOVE      XIDAG         WSTDT
     C                   MOVE      *BLANKS       WSBNR
     C                   MOVE      *BLANKS       WSBNA
     C                   MOVE      *BLANKS       WSBA1
     C                   MOVE      *BLANKS       WSBA2
     C                   MOVE      *ZEROS        WSBPN
     C                   MOVE      *BLANKS       WSBA3
     C                   MOVE      *BLANKS       WSBLK
     C                   MOVE      *BLANKS       WSBPU
     C                   MOVE      *ZEROS        WSTN
     C                   MOVE      *BLANKS       WSLSD
     C                   MOVE      *BLANKS       WSPRKD
     C                   MOVE      *BLANKS       WSFLN
     C                   MOVE      *BLANKS       WSORDR
     C                   MOVE      *BLANKS       WSPAK
     C                   MOVE      *ZEROS        LHALN
     C                   MOVE      *ZEROS        LHALG
     C                   MOVE      *ZEROS        LHANT0
     C                   MOVE      *ZEROS        LHANTL
     C                   MOVE      'ESK'         LHAEH1
     C                   MOVE      *ZEROS        LHANT1
     C                   MOVE      'KRT'         LHAEH2
     C                   MOVE      *ZEROS        LHANT2
     C                   MOVE      'PAL'         LHAEH3
     C                   MOVE      *ZEROS        LHANT3
     C                   MOVE      *ZEROS        LHVEK
     C                   MOVE      *ZEROS        LHWVEK
     C                   MOVE      *ZEROS        LHKUB
     C                   MOVE      *ZEROS        LHWKUB
     C                   MOVE      *BLANKS       LHST1
     C                   MOVE      *BLANKS       LHST2
     C                   MOVE      *BLANKS       LHST3
     C                   MOVE      *ZEROS        LHTLIN
     C                   MOVE      *ZEROS        LHAVD
     C                   MOVE      *ZEROS        LHOPD
     C                   MOVE      *ZEROS        LHFBN
     C                   MOVE      *ZEROS        KUKUN2
     C                   MOVE      *ZEROS        KUVADR
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      'J'           XNYH              1
     C                   MOVE      '0'           *IN40
     C                   MOVE      '1'           *IN61
      *
     C     STCRT         TAG
     C                   EXFMT     CHGREC
     C                   MOVEA     '0000'        *IN(87)
     C                   MOVE      '0'           *IN30
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STCRT
     C                   END
      *
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      STCRT
     C                   END
      *
     C     *IN12         IFEQ      '0'
     C                   EXSR      TESTB
     C   30              GOTO      STCRT
      *
     C     XNYH          IFEQ      'J'
     C     1             CHAIN     LLTELL                             33                    1
     C                   IF        *IN33
     C                   Z-ADD     1001          LLREC1
     C                   WRITE     LLTELLR
     C                   ELSE
     C                   ADD       1             LLREC1
     C                   UPDATE    LLTELLR
     C                   END
     C                   MOVE      LLREC1        LHMN
     C                   MOVE      'M'           LHOPR
     C                   EXSR      MOVWLH
     C                   MOVE      *ZEROS        LHAPAL
     C                   MOVE      *ZEROS        LHBPAL
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      WDT           LHRDT
N01  C                   MOVE      WTM           LHRTD
     C                   WRITE     LLHEADR
     C                   MOVE      'N'           XNYH
     C                   ELSE
     C     LHMN          CHAIN     LLHEAD                             33
     C                   EXSR      MOVWLH
     C                   UPDATE    LLHEADR
     C                   END
     C     *IN18         IFEQ      '1'
     C                   CALL      'LL035R'
     C                   PARM                    LHMN
     C                   PARM                    UOPTXT
     C     LHMN          CHAIN     LLHETXT                            61
     C                   GOTO      STCRT
     C                   END
     C                   ELSE
     C                   GOTO      SLCRT
     C                   END
      *
     C                   EXSR      TILLN
     C     UFLAGG        IFNE      3
     C     LHMN          CHAIN(N)  LLHEAD                             33
     C                   GOTO      STCRT
     C                   END
      *
     C     SLCRT         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     MOVWLH        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      WSTDT         LHTDT
     C                   MOVE      WSBNR         LHBNR
     C                   MOVE      WSBNA         LHBNA
     C                   MOVE      WSBA1         LHBA1
     C                   MOVE      WSBA2         LHBA2
     C                   MOVE      WSBPN         LHBPN
     C                   MOVE      WSBA3         LHBA3
     C                   MOVE      WSBLK         LHBLK
     C                   MOVE      WSBPU         LHBPU
     C                   MOVE      WSTN          LHTN
     C                   MOVE      WSLSD         LHLSD
     C                   MOVE      WSPRKD        LHPRKD
     C                   MOVE      WSFLN         LHFLN
     C                   MOVE      WSORDR        LHORDR
     C                   MOVE      WSPAK         LHPAK
     C                   MOVE      WSKLL         LHKLL
     C                   MOVE      WSMLP         LHMLP
     C                   IF        WSLSD <> *BLANKS
     C     LLVMLSK       CHAIN     LLVMLS                             33
     C                   IF        *IN33
     C                   EVAL      DSKN = UPNR
     C                   EVAL      DSVMNR = WSBNR
     C                   EVAL      DSLSKD = WSLSD
     C                   WRITE     LLVMLSR
     C                   ELSE
     C                   EVAL      DSLSKD = WSLSD
     C                   UPDATE    LLVMLSR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CHGLH         BEGSR
      *////////////////////////////////////////////////////////////
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      '1'           *IN40
      * HENT INTERNT KUNDENR/VADR FØR VISNING
     C                   MOVEL     LHBNR         KUINTN
     C     KUNKOK        CHAIN     KUNKO2                             90
     C                   EXSR      MOVLHW
     C     WSNR          IFEQ      '7'
     C                   MOVE      '1'           *IN05
     C                   GOTO      STCHG2
     C                   END
     C     LHMN          CHAIN     LLHETXT                            61
      *
     C     STCHG         TAG
     C                   EXFMT     CHGREC
     C                   MOVEA     '000'         *IN(88)
     C                   MOVE      '0'           *IN30
     C     *IN12         IFEQ      '1'
     C                   GOTO      SLCHG
     C                   END
      *
     C     *IN02         IFEQ      '1'
     C                   CALL      'LL030R'
     C                   PARM                    UMODE
     C                   PARM                    UGRP8
     C                   PARM                    UPNR8
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      STCHG
      *
     C     LHMN          CHAIN     LLHEAD                             33
     C                   EXSR      MOVWLH
     C                   UPDATE    LLHEADR
      *
     C     *IN18         IFEQ      '1'
     C                   CALL      'LL035R'
     C                   PARM                    LHMN
     C                   PARM                    UOPTXT
     C     LHMN          CHAIN     LLHETXT                            61
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN05         CABEQ     '0'           SLCHG
      *
     C     STCHG2        TAG
     C                   EXSR      TILLN
     C     UFLAGG        IFNE      3
     C     LHMN          CHAIN(N)  LLHEAD                             33
     C                   GOTO      STCHG
     C                   END
      *
     C     SLCHG         ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     MOVLHW        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      LHTDT         WSTDT
     C                   MOVE      LHBNR         WSBNR
     C                   MOVE      LHBNA         WSBNA
     C                   MOVE      LHBA1         WSBA1
     C                   MOVE      LHBA2         WSBA2
     C                   MOVE      LHBPN         WSBPN
     C                   MOVE      LHBA3         WSBA3
     C                   MOVE      LHBLK         WSBLK
     C                   MOVE      LHBPU         WSBPU
     C                   MOVE      LHTN          WSTN
     C                   MOVE      LHLSD         WSLSD
     C                   MOVE      LHPRKD        WSPRKD
     C                   MOVE      LHFLN         WSFLN
     C                   MOVE      LHORDR        WSORDR
     C                   MOVE      LHPAK         WSPAK
     C                   MOVE      LHKLL         WSKLL
     C                   MOVE      LHMLP         WSMLP
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     DLTLH         BEGSR
      *////////////////////////////////////////////////////////////
     C                   EXSR      MOVLHW
     C     STDLT         TAG
     C                   EXFMT     DLTREC
     C                   SELECT                                                 1<-B
     C     *IN12         WHENEQ    '1'
     C     *IN23         WHENEQ    '1'
      * SLETT HODE
     C     LHMN          CHAIN     LLHEAD                             33
     C                   MOVE      'D'           LHSTA
     C                   MOVE      LHALN         LHALG
     C                   MOVE      *ZEROS        LHALN
     C                   UPDATE    LLHEADR
     C                   MOVE      ' '           LHSTA
      * SLETT LINJER
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE     LLLINE                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
      * DEALLOKER LAGER
     C                   MOVE      'DL2'         UTYPE             3
     C                   CALL      'LL019R'
     C                   PARM                    UGRP
     C                   PARM                    UPNR
     C                   PARM                    LLANR
     C                   PARM                    LLMN
     C                   PARM                    LLVN
     C                   PARM                    UTYPE
      *
     C                   MOVE      *ZEROS        LLWNT0
     C                   UPDATE    LLLINER
     C     LHMN          READE     LLLINE                                 33
     C  N33              ENDDO                                                   2<-E
      * SLETT SERIENR
     C     LHMN          SETLL     LLSERL02
     C     LHMN          READE     LLSERL02                               33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        SNTYPE = 'U'
     C                   DELETE    LLSERR
     C                   ELSE
     C                   MOVE      *ZEROS        SNMNU
     C                   MOVE      *ZEROS        SNVNU
     C                   UPDATE    LLSERR
     C                   END
     C     LHMN          READE     LLSERL02                               33
     C  N33              ENDDO                                                   2<-E
      *
     C                   MOVE      LHMN          EX(XN)
     C                   MOVE      *BLANKS       LHBNR
     C                   MOVE      *BLANKS       LHLSD
     C                   MOVE      *ZEROS        LHTDT
     C                   MOVE      *BLANKS       LHORDR
     C                   MOVE      *BLANKS       LHPAK
     C                   MOVE      *ZEROS        LHALN
     C                   MOVE      *BLANKS       LHFLN
     C                   MOVE      *BLANKS       LHBNA
     C                   MOVE      *BLANKS       LHST1
     C                   MOVE      *BLANKS       LHST2
     C                   MOVE      *BLANKS       LHST3
     C                   MOVE      *ZEROS        LHANT0
     C                   MOVE      *ZEROS        LHANTL
     C                   MOVE      *ZEROS        LHANT1
     C                   MOVE      *ZEROS        LHANT2
     C                   MOVE      *ZEROS        LHANT3
     C                   MOVE      *ZEROS        LHWVEK
     C                   MOVE      *ZEROS        LHWKUB
     C                   MOVEL     '*SLETT  '    SLETT
     C                   OTHER
     C                   GOTO      STDLT
     C                   ENDSL                                                  1<-E
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TILLN         BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'N'           UKONTR            1
     C                   MOVE      LHANT0        UANT0
     C                   MOVE      LHANTL        UANTL
     C                   MOVE      LHAEH1        UAEH1
     C                   MOVE      LHANT1        UANT1
     C                   MOVE      LHAEH2        UAEH2
     C                   MOVE      LHANT2        UANT2
     C                   MOVE      LHAEH3        UAEH3
     C                   MOVE      LHANT3        UANT3
     C                   MOVE      LHWVEK        UVEK
     C                   MOVE      LHWKUB        UKUB
     C                   MOVE      LHTLIN        UTLIN
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'LL012R'
     C                   PARM                    LHMN
     C                   PARM                    FIFIRM
     C                   PARM                    KNAVN
     C                   PARM                    UANT0
     C                   PARM                    UANTL
     C                   PARM                    UAEH1
     C                   PARM                    UANT1
     C                   PARM                    UAEH2
     C                   PARM                    UANT2
     C                   PARM                    UAEH3
     C                   PARM                    UANT3
     C                   PARM                    UVEK
     C                   PARM                    UKUB
     C                   PARM                    UTLIN
     C                   PARM                    UKONTR
     C                   PARM                    UFLAGG            1 0
      *
     C     LHMN          CHAIN     LLHEAD                             33
     C                   MOVE      UANT0         LHANT0
     C                   MOVE      UANTL         LHANTL
     C                   MOVE      UAEH1         LHAEH1
     C                   MOVE      UANT1         LHANT1
     C                   MOVE      UAEH2         LHAEH2
     C                   MOVE      UANT2         LHANT2
     C                   MOVE      UAEH3         LHAEH3
     C                   MOVE      UANT3         LHANT3
     C                   MOVE      UVEK          LHWVEK
     C                   MOVE      UKUB          LHWKUB
     C                   MOVE      UTLIN         LHTLIN
     C                   UPDATE    LLHEADR
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TESTB         BEGSR
      *////////////////////////////////////////////////////////////
      * TEST BUTIKKNR
     C     WSBNR         IFEQ      *BLANKS
     C                   MOVE      *ZEROS        KUKUN2
     C                   MOVE      *ZEROS        KUVADR
     C     WSBNA         COMP      *BLANKS                                90
     C     *IN90         CABEQ     '0'           STTBDT
     C                   ELSE
     C                   MOVEL     WSBNR         KUINTN
     C     KUNKOK        CHAIN     KUNKO2                             90
     C     WSBNA         CABNE     *BLANKS       STTBDT
     C                   END
     C     *IN90         IFEQ      '0'                                          1<-B
     C                   MOVE      KUKUN2        KUNDNR
     C     KUVADR        IFEQ      *ZEROS                                        2<-B
     C     CUND1K        CHAIN     CUNDL01                            90
     C  N90AKTKOD        COMP      'I'                                    90
     C     *IN90         IFEQ      '0'                                            3<-B
     C                   MOVE      KNAVN         WSBNA
     C                   MOVE      ADR1          WSBA1
     C                   MOVE      ADR2          WSBA2
     C                   MOVE      *BLANKS       WSBA3
     C                   MOVE      POSTNR        WSBPN
     C                   MOVE      ADR3          WSBA3
     C                   MOVE      SYLAND        WSBLK
     C                   MOVEL     SYPOGE        WSBPU
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     VADRK         CHAIN     VADR                               90
     C  N90AKTKOD        COMP      'I'                                    90
     C     *IN90         IFEQ      '0'                                            3<-B
     C                   MOVE      VADRNA        WSBNA
     C                   MOVE      VADRN1        WSBA1
     C                   MOVE      VADRN2        WSBA2
      * NORSK POSTNR??
     C                   TESTN                   VXPNR                33
     C     *IN33         IFEQ      '1'                                             4<-B
     C     VXBLAN        ANDEQ     ' '
     C                   MOVE      VXPNR         WSBPN
     C     VXBLA2        IFEQ      *BLANKS
     C                   MOVEL     VXSTD2        WSBA3
     C                   ELSE
     C                   MOVEL     VXSTED        WSBA3
     C                   END
     C                   ELSE                                                      4
     C                   MOVEL     VADRN3        WSBA3
     C                   END                                                       4<-E
     C                   MOVE      VALAND        WSBLK
     C                   MOVE      *BLANKS       WSBPU
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     WSBLK         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      FILAND        WSBLK
     C                   END                                                     2<-E
     C                   IF        *IN90                                         2<-B
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1913'     ZMSGNO
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0584'     ZMSGNO
     C                   END                                                    1<-E
      *
      * TEST TRANSPORTDATO
     C     STTBDT        TAG
     C                   MOVE      WSTDTD        UDD               2 0
     C                   MOVE      WSTDTM        UMM               2 0
     C                   MOVE      WSTDTÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C     *IN89         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
      *
      * TEST TRANSPORTØR
     C     WSTN          IFNE      0
     C     TRANK         CHAIN     TRAN                               88
     C  N30*IN88         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     60            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPT0105'     ZMSGNO
     C                   END
     C                   END
      * TEST PRODUKTKODE
     C     WSPRKD        IFNE      *BLANKS
     C     PROKEY        CHAIN     KOFAST                             87
     C  N30*IN87         IFEQ      '1'
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     75            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SHU0790'     ZMSGNO
     C                   END
     C                   END
      * TEST PRIO PLUKKLAGER
     C                   IF        WSLSD <> *BLANKS
     C     WSLSD         CHAIN     LLLSDF                             86
     C  N30*IN86         IFEQ      '1'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     60            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0669'     ZMSGNO
     C                   END
     C                   END
      * HENT PRIO PLUKKLAGER
     C                   IF        WSLSD = *BLANKS
     C     LLVMLSK       CHAIN(N)  LLVMLS                             33
     C  N33              EVAL      WSLSD = DSLSKD
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     KTRREC        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'J'           UKONTR            1
     C                   MOVE      LHANT0        UANT0
     C                   MOVE      LHANTL        UANTL
     C                   MOVE      LHAEH1        UAEH1
     C                   MOVE      LHANT1        UANT1
     C                   MOVE      LHAEH2        UAEH2
     C                   MOVE      LHANT2        UANT2
     C                   MOVE      LHAEH3        UAEH3
     C                   MOVE      LHANT3        UANT3
     C                   MOVE      LHWVEK        UVEK
     C                   MOVE      LHWKUB        UKUB
     C                   MOVE      LHTLIN        UTLIN
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'LL012R'
     C                   PARM                    LHMN
     C                   PARM                    FIFIRM
     C                   PARM                    KNAVN
     C                   PARM                    UANT0
     C                   PARM                    UANTL
     C                   PARM                    UAEH1
     C                   PARM                    UANT1
     C                   PARM                    UAEH2
     C                   PARM                    UANT2
     C                   PARM                    UAEH3
     C                   PARM                    UANT3
     C                   PARM                    UVEK
     C                   PARM                    UKUB
     C                   PARM                    UTLIN
     C                   PARM                    UKONTR
     C                   PARM                    UFLAGG            1 0
     C     LHMN          CHAIN     LLHEAD                             33
     C                   MOVE      UANT0         LHANT0
     C                   MOVE      UANTL         LHANTL
     C                   MOVE      UAEH1         LHAEH1
     C                   MOVE      UANT1         LHANT1
     C                   MOVE      UAEH2         LHAEH2
     C                   MOVE      UANT2         LHANT2
     C                   MOVE      UAEH3         LHAEH3
     C                   MOVE      UANT3         LHANT3
     C                   MOVE      UVEK          LHWVEK
     C                   MOVE      UKUB          LHWKUB
     C                   MOVE      UTLIN         LHTLIN
     C     LHTLIN        IFEQ      0
     C                   MOVE      ' '           LHST1
     C                   END
     C                   UPDATE    LLHEADR
      *
     C                   ENDSR
      *
N06   *////////////////////////////////////////////////////////////
N06  C     SPLITT        BEGSR
N06   *////////////////////////////////////////////////////////////
N06  C                   CALL      'LL011RS'
N06  C                   PARM                    LHMN
N06  C                   PARM                    UFLAGG
N06  C                   IF        UFLAGG = 1
N06  C                   MOVE      'J'           X_SPLITT
N06  C                   END
N06   *
N06  C                   ENDSR
N06   *
      *////////////////////////////////////////////////////////////
     C     ARBLIS        BEGSR
      *////////////////////////////////////////////////////////////
     C                   Z-ADD     LHALN         WSALNG
     C                   MOVE      '0'           *IN45
     C     WSNR          CABEQ     'S'           STALS1
     C                   MOVE      'L'           WSSORT
     C     STAL          TAG
     C                   Z-ADD     205           KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C     WSPRT         IFEQ      *BLANKS
     C     WSPRT         OREQ      '*JOB    '
     C  N33              MOVE      KOPNVN        WSPRT
     C                   END
     C  N33              MOVE      KOPLAS        ULASER            1
     C  N33              MOVE      KOPFM         USTR              5
     C                   EXFMT     BESTAL
     C                   MOVEA     '0000'        *IN(87)
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLAL
      *
     C     STALS1        TAG
     C                   MOVE      *ZEROS        XALNG
     C     WSALNG        IFNE      0                                            1<-B
      * TEST OM TASTET ARBEIDSLISTENR. FINNES
     C     WSALNG        CHAIN     LLHEAD02                           33
     C     *IN33         IFEQ      '1'                                           2<-B
     C                   MOVE      '1'           *IN89
     C                   MOVE      '1'           *IN30
     C                   GOTO      STAL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     WSNR          CABEQ     'S'           STALS2
      *
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN88
     C                   MOVE      '1'           *IN30
     C                   GOTO      STAL
     C                   END
      *
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD10        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   OPEN      LLW013
      * VED KOPI GÅ TIL STALK
     C     STALS2        TAG
     C     WSALNG        CABNE     0             STALK
      *
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE(N)  LLLINE                                 33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C                   WRITE     LLW013R
     C     LHMN          READE(N)  LLLINE                                 33
     C  N33              ENDDO                                                  1<-E
      *
     C                   GOTO      STAL2
      *
     C     STALK         TAG
     C     WSALNG        CHAIN     LLHEAD02                           33
     C     *IN33         IFEQ      '0'                                          1<-B
     C     XALNG         IFEQ      0                                             2<-B
     C                   MOVE      LHALG         XALNG
     C                   END                                                     2<-E
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE(N)  LLLINE                                 33
     C     *IN33         DOWEQ     '0'                                           2<-B
     C                   WRITE     LLW013R
     C     LHMN          READE(N)  LLLINE                                 33
     C  N33              ENDDO                                                   2<-E
     C                   END                                                    1<-E
      *
     C     STAL2         TAG
     C     WSNR          IFNE      'S'
     C                   CLOSE     LLW013
     C                   END
      *
     C                   MOVE      XALNG         UALNG             7
     C                   MOVE      WSALNG        UALCPY            7
     C                   MOVE      'P'           ULTYPE            1
     C     WSNR          IFEQ      'S'
     C                   MOVE      'S'           USORT             1
     C                   ELSE
     C                   MOVE      WSSORT        USORT
     C                   END
     C                   CALL      'LL013C'
     C                   PARM                    FIFIRM
     C                   PARM                    UALNG
     C                   PARM                    UALCPY
     C                   PARM                    WSPRT
     C                   PARM                    USORT
     C                   PARM                    ULTYPE
     C                   PARM                    ULASER
     C                   PARM                    USTR
      *
     C     LHALN         IFEQ      0
     C                   MOVE      UALNG         LHALN
     C                   END
      *
     C     SLAL          ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     SAMLIS        BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      'L'           WSSORT
     C                   MOVE      '1'           *IN45
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
      *
     C     STSL1         TAG
     C                   Z-ADD     205           KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C     WSPRT         IFEQ      *BLANKS
     C     WSPRT         OREQ      '*JOB    '
     C  N33              MOVE      KOPNVN        WSPRT
     C                   END
     C  N33              MOVE      KOPLAS        ULASER            1
     C  N33              MOVE      KOPFM         USTR              5
     C                   EXFMT     BESTAL
     C                   MOVEA     '0000'        *IN(87)
     C                   MOVE      '0'           *IN30
     C     *IN12         CABEQ     '1'           SLSL
      *
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN88
     C                   MOVE      '1'           *IN30
     C                   GOTO      STSL1
     C                   END
      *
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD10        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   OPEN      LLW013
      *
     C                   MOVE      'S'           WSNR
     C                   EXSR      ARBLIS
     C                   MOVE      ' '           WSNR
     C     STSL3         TAG
     C                   READC     SUBFIL                                 52
     C     *IN52         IFEQ      '0'
     C     SLETT         IFNE      '*SLETT  '
     C     OVERF         ANDNE     '*OVERFØR'
     C     WSNR          ANDEQ     'S'
     C                   EXSR      ARBLIS
     C                   END
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   GOTO      STSL3
     C                   END
      *
     C                   CLOSE     LLW013
      *
     C                   MOVE      *ZEROS        UALNG             7
     C                   MOVE      *ZEROS        UALCPY            7
     C                   MOVE      'S'           ULTYPE
     C                   CALL      'LL013C'
     C                   PARM                    FIFIRM
     C                   PARM                    UALNG
     C                   PARM                    UALCPY
     C                   PARM                    WSPRT
     C                   PARM                    WSSORT
     C                   PARM                    ULTYPE
     C                   PARM                    ULASER
     C                   PARM                    USTR
      *
     C     SLSL          ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TILOPD        BEGSR
      *////////////////////////////////////////////////////////////
      *
     C                   MOVE      *BLANKS       UAN
     C                   MOVE      *ZEROS        URC
     C                   MOVE      *ZEROS        XN
     C                   MOVE      *BLANKS       XXBNA            30
N02  C                   EVAL      *IN98 = *OFF
     C     *IN98         DOWEQ     *OFF
     C     LHTLIN        CABEQ     0             SLOPD
     C     LHST1         CABNE     'K'           SLOPD
     C     LHALN         CABEQ     0             SLOPD
     C                   UPDATE    SUBFIL
     C                   ADD       1             XN
     C                   MOVE      LHALN         UAN(XN)
     C                   MOVE      ZRECNO        URC(XN)
     C     XXBNA         IFEQ      *BLANKS
     C                   MOVE      LHBNA         XXBNA
     C                   MOVE      LHBA1         XXBA1            30
     C                   MOVE      LHBA2         XXBA2            30
     C                   MOVE      LHBPN         XXBPN             4 0
     C                   MOVE      LHBA3         XXBA3            24
     C                   MOVE      LHBLK         XXBLK             2
     C                   MOVE      LHBPU         XXBPU             9
     C                   ELSE
     C     XXBNA         IFNE      LHBNA
     C     XXBA1         ORNE      LHBA1
     C     XXBA2         ORNE      LHBA2
     C     XXBPN         ORNE      LHBPN
     C     XXBA3         ORNE      LHBA3
     C     XXBLK         ORNE      LHBLK
     C     XXBPU         ORNE      LHBPU
     C                   GOTO      SLOPD
     C                   END
     C                   END
     C                   READC     SUBFIL                                 98
     C  N98LHST1         IFNE      'K'
     C                   EXSR      KTRREC
     C                   END
     C  N98              ENDDO
      *
     C     LHST3         IFEQ      ' '
     C     XN            ORGT      1
     C                   MOVE      'J'           WSPSDL
     C                   ELSE
     C                   MOVE      'N'           WSPSDL
     C                   END
      *
     C                   MOVE      *BLANKS       WSPSD
     C                   MOVE      *ZEROS        WSPTDF
     C                   MOVE      *ZEROS        WSPTDT
     C                   MOVE      *BLANKS       WSPSG
     C                   MOVE      LHKLL         WSKLL
     C                   MOVE      LHMLP         WSMLP
     C                   MOVE      *ZEROS        WSAPAL
     C                   MOVE      *ZEROS        WSBPAL
      *
     C                   EXSR      HENTVKTKUB
      *
     C     LHPNR         CHAIN     LLKUNF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      KFPAVD        WSAVD
     C                   MOVE      KFPUR         WSMOD
     C                   MOVE      KFPFB         WSFBR
     C                   MOVE      KFPAFF        WSPAFF
     C                   MOVE      KFPFAK        WSPFAK
     C                   MOVE      KFPFKØ        WSPFKØ
     C                   ELSE
     C                   MOVE      'N'           KFPPLS
     C                   MOVE      'N'           KFPAFF
     C                   MOVE      'N'           KFPFAK
     C                   MOVE      'N'           KFPFKØ
     C                   MOVE      UDSAVD        WSAVD
     C                   END
     C                   MOVE      UDSSG         WSSG
      *
     C     STOPD         TAG
     C                   Z-ADD     37            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C     WSPRT         IFEQ      *BLANKS
     C     WSPRT         OREQ      '*JOB    '
     C  N33              MOVE      KOPNVN        WSPRT
     C                   END
     C  N33              MOVE      KOPLAS        ULASER            1
     C  N33              MOVE      KOPFM         USTR              5
     C                   EXFMT     OVROPPD
     C                   MOVEA     '0000000000'  *IN(81)
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   MOVEL     'LAGERPLU'    KFTYP
     C                   MOVE      'SG'          KFTYP
     C                   MOVE      ' '           UUPDAT            1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C     KUFASK        CHAIN     KUFAST                             33
     C                   MOVEL     KFTXT         WSPSG
     C                   END
     C                   GOTO      STOPD
     C                   ENDDO
     C   12              GOTO      SLOPD
      *
     C     WSAVD         COMP      0                                      90
     C  N90WSAVD         CHAIN     TELL                               90
     C     *IN90         IFEQ      '1'
     C                   MOVE      'SPA0001'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     KODSFK        CHAIN     KODTSF                             89
     C     *IN89         IFEQ      '1'
     C                   MOVE      'SPS0001'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     WSPSDL        IFEQ      'J'
     C     WSPRT         ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN88
     C                   MOVE      'YBC0675'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
      * TEST OM FIRMA VIL REGISTRERE PLUKKINFORMASJON.
     C     KFPPLS        IFEQ      'J'
     C     WSPSD         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN87
     C                   MOVE      'YBC1865'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     WSPTDF        COMP      0                                    8686
     C  N86              MOVEL     WSPTDF        XNR02             2 0
     C  N86XNR02         COMP      24                                 86  86
     C  N86              MOVE      WSPTDF        XNR02
     C  N86XNR02         COMP      60                                 86  86
     C     *IN86         IFEQ      '1'
     C                   MOVE      'YBC1866'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     WSPTDT        COMP      0                                    8585
     C  N85              MOVEL     WSPTDT        XNR02             2 0
     C  N85XNR02         COMP      24                                 85  85
     C  N85              MOVE      WSPTDT        XNR02
     C  N85XNR02         COMP      60                                 85  85
     C     *IN86         IFEQ      '1'
     C                   MOVE      'YBC1867'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
     C                   END
      *
     C     WSPSG         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN84
     C                   MOVE      'YBC1868'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     WSKLL         IFEQ      0
     C                   MOVE      '1'           *IN83
     C                   MOVE      'YBC1872'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     KFPML         IFEQ      'J'
     C     WSMLP         ANDEQ     0
     C                   MOVE      '1'           *IN82
     C                   MOVE      'YBC1874'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      *
     C     WSWVEK        IFEQ      0
     C                   MOVE      '1'           *IN81
     C                   MOVE      'SPV0002'     ZMSGNO
     C                   MOVE      '1'           *IN30
     C                   GOTO      STOPD
     C                   END
      * OPPDATER X-AVTALER
     C                   CALL      'LL059R'
     C                   PARM                    UGRP
     C                   PARM                    UPNR
     C                   PARM                    LHMN
      *
     C     LHMN          CHAIN     LLHEAD                             33
     C     KFPPLS        IFEQ      'J'
     C                   MOVE      WSPSD         LHPSD
     C                   MOVE      WSPTDF        LHPTDF
     C                   MOVE      WSPTDT        LHPTDT
     C                   MOVE      WSPSG         LHPSG
     C                   END
     C                   MOVE      WSKLL         LHKLL
     C                   MOVE      WSMLP         LHMLP
     C                   MOVE      WSWVEK        LHWVEK
     C                   MOVE      WSWKUB        LHWKUB
     C                   MOVE      WSAPAL        LHAPAL
     C                   MOVE      WSBPAL        LHBPAL
     C                   UPDATE    LLHEADR
      *
     C     1             DO        XN            X2                3 0
     C                   MOVE      URC(X2)       ZRECNO
     C     ZRECNO        CHAIN     SUBFIL                             98
     C                   MOVE      ' '           WSNR
     C                   MOVE      *BLANKS       LHBNR
     C                   MOVEL     '*OVERFØR'    OVERF
     C                   UPDATE    SUBFIL
     C                   ENDDO
      *
     C                   SELECT
     C                   WHEN      WSPFKØ <> 'J'
     C                   MOVE      'N'           WSPAFF
     C                   MOVE      'N'           WSPFAK
     C                   WHEN      WSPFAK <> 'J'
     C                   MOVE      'N'           WSPAFF
     C                   ENDSL
      *
     C                   MOVE      WSAVD         UAVD              4
     C                   CALL      'LL017R'
     C                   PARM                    FIFIRM
     C                   PARM                    WSMOD
     C                   PARM                    UAVD
     C                   PARM                    WSSG
     C                   PARM                    UAN
     C                   PARM                    WSFBR
     C                   PARM                    WSPAFF
     C                   PARM                    WSPFAK
     C                   PARM                    WSPFKØ
      *
     C     WSPSDL        IFEQ      'J'
     C     1             DO        XN            X2                3 0
     C                   MOVE      UAN(X2)       UALN              7
     C                   MOVE      X2            UNR               1
     C                   MOVE      XN            UTOT              1
     C                   CALL      'LL014C'
     C                   PARM                    FIFIRM
     C                   PARM                    UALN
     C                   PARM                    UKOPI             1
     C                   PARM                    WSPRT
     C                   PARM                    UNR
     C                   PARM                    UTOT
     C                   PARM                    ULASER
     C                   PARM                    USTR
     C                   PARM                    XVAMAIL          70
     C                   MOVE      UAN(X2)       LH15_LHALN
     C     LLHEAD15K     CHAIN     LLHEAD15                           33
     C     VADR3KEY      CHAIN     VADR3                              33
      * VED SENDING PÅ E-POST SKAL NESTE LINEJ FJERNES.
      * (GJELDER OGSÅ I LL040R, ENDRING 7)
     C                   MOVE      *ON           *IN33
     C  N33              IF        VAMAIL <> *BLANKS
     C                   CALL      'LL014C2'
     C                   PARM                    FIFIRM
     C                   PARM                    UALN
     C                   PARM                    UKOPI
     C                   PARM                    WSPRT
     C                   PARM                    UNR
     C                   PARM                    UTOT
     C                   PARM                    ULASER
     C                   PARM                    USTR
     C                   PARM                    VAMAIL
     C                   END
     C                   ENDDO
     C                   END
      *
     C     SLOPD         TAG
     C                   MOVE      '0'           *IN98
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * Summere frakt-vekt og frakt-kubikk             HENTVKTKUB /
      *////////////////////////////////////////////////////////////
     C     HENTVKTKUB    BEGSR

     C     LLAGJL01K     KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    VDMN
     C     LLAGJD02K     KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LHMN
     C                   KFLD                    LLVN
     C     *LIKE         DEFINE    LHWVEK        XHWVEK
     C     *LIKE         DEFINE    LHWKUB        XHWKUB
     C                   MOVE      *ZEROS        WSWVEK
     C                   MOVE      *ZEROS        WSWKUB

     C     LHMN          SETLL     LLLINE
     C     LHMN          READE(N)  LLLINE                                 52
     C                   DOW       *IN52 = *OFF
     C     LLAGJD02K     SETLL     LLAGJD02
     C     LLAGJD02K     READE     LLAGJD02                               53
     C                   DOW       *IN53 = *OFF
     C     LLAGJL01K     CHAIN     LLAGJL01                           54
     C                   IF        AL1_VAVKF0 = 0
     C                   EVAL      XHWVEK = AL1_VAVKT0 * VDSAE0
     C                   ELSE
     C                   EVAL      XHWVEK = AL1_VAVKF0 * VDSAE0
     C                   ENDIF
     C                   IF        AL1_VAKUF0 = 0
     C                   EVAL      XHWKUB = AL1_VAKUB0 * VDSAE0
     C                   ELSE
     C                   EVAL      XHWKUB = AL1_VAKUF0 * VDSAE0
     C                   ENDIF
     C                   EVAL      WSWVEK = WSWVEK + XHWVEK
     C                   EVAL      WSWKUB = WSWKUB + XHWKUB
     C                   IF        AL1_VAVKF1 = 0
     C                   EVAL      XHWVEK = AL1_VAVKT1 * VDSAE1
     C                   ELSE
     C                   EVAL      XHWVEK = AL1_VAVKF1 * VDSAE1
     C                   ENDIF
     C                   IF        AL1_VAKUF1 = 0
     C                   EVAL      XHWKUB = AL1_VAKUB1 * VDSAE1
     C                   ELSE
     C                   EVAL      XHWKUB = AL1_VAKUF1 * VDSAE1
     C                   ENDIF
     C                   EVAL      WSWVEK = WSWVEK + XHWVEK
     C                   EVAL      WSWKUB = WSWKUB + XHWKUB
     C                   IF        AL1_VAVKF2 = 0
     C                   EVAL      XHWVEK = AL1_VAVKT2 * VDSAE2
     C                   ELSE
     C                   EVAL      XHWVEK = AL1_VAVKF2 * VDSAE2
     C                   ENDIF
     C                   IF        AL1_VAKUF2 = 0
     C                   EVAL      XHWKUB = AL1_VAKUB2 * VDSAE2
     C                   ELSE
     C                   EVAL      XHWKUB = AL1_VAKUF2 * VDSAE2
     C                   ENDIF
     C                   EVAL      WSWVEK = WSWVEK + XHWVEK
     C                   EVAL      WSWKUB = WSWKUB + XHWKUB
     C                   IF        AL1_VAVKF3 = 0
     C                   EVAL      XHWVEK = AL1_VAVKT3 * VDSAE3
     C                   ELSE
     C                   EVAL      XHWVEK = AL1_VAVKF3 * VDSAE3
     C                   ENDIF
     C                   IF        AL1_VAKUF3 = 0
     C                   EVAL      XHWKUB = AL1_VAKUB3 * VDSAE3
     C                   ELSE
     C                   EVAL      XHWKUB = AL1_VAKUF3 * VDSAE3
     C                   ENDIF
     C                   EVAL      WSWVEK = WSWVEK + XHWVEK
     C                   EVAL      WSWKUB = WSWKUB + XHWKUB
     C     LLAGJD02K     READE     LLAGJD02                               53
     C  N53              ENDDO
     C     LHMN          READE(N)  LLLINE                                 52
     C  N52              ENDDO

     C                   ENDSR

      *////////////////////////////////////////////////////////////
     C     SØKDTA        BEGSR
      *////////////////////////////////////////////////////////////
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFA81B'
     C                   PARM      UPNR          UPNR2             8 0
     C                   PARM                    UBNR             17
     C                   PARM                    UKN               8 0
     C     UBNR          IFNE      *BLANKS
     C                   MOVE      UBNR          WSBNR
     C                   EXSR      TESTB
     C                   END
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     59
     C     POSNBR        ANDLE     66
     C                   MOVE      *ZEROS        UTN               8 0
     C                   CALL      'SYTR04A'
     C                   PARM                    UTN
     C     UTN           IFNE      0
     C                   MOVE      UTN           WSTN
     C                   END
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     79
     C                   MOVE      ' '           UUPDAT            1
     C                   MOVE      *BLANKS       PROKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    PROTYP
     C                   PARM                    UUPDAT
     C                   PARM                    PROKOD
     C                   MOVEL     PROKOD        WSPRKD
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     64
     C                   CALL      'LL006R'
     C                   PARM                    WSLSD
     C                   GOTO      SLSØK
     C                   END
      *
     C     SLSØK         ENDSR
      *
