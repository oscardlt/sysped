      *
      ***************************************************************
      *** PROGRAM SKAL BEREGNE KUBIKK         (KALLES FRA GSS1r ) ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01 03-11 14-26                       ***
      *** LEDIGE INDIKATORER 27-99                                ***
********************************************************************
      * RETTINGER I DETTE PROGRAM:
      *
     FHLBFIL    UF A E           K DISK
     FGSS082D   CF   E             WORKSTN
     D                 DS
     D  HO                     1     51  0
     D                                     DIM(17)
     D  WSH1                   1      3  0
     D  WSH2                   4      6  0
     D  WSH3                   7      9  0
     D  WSH4                  10     12  0
     D  WSH5                  13     15  0
     D  WSH6                  16     18  0
     D  WSH7                  19     21  0
     D  WSH8                  22     24  0
     D  WSH9                  25     27  0
     D  WSH10                 28     30  0
     D  WSH11                 31     33  0
     D  WSH12                 34     36  0
     D  WSH13                 37     39  0
     D  WSH14                 40     42  0
     D  WSH15                 43     45  0
     D  WSH16                 46     48  0
     D  WSH17                 49     51  0
     D                 DS
     D  LE                     1     51  0
     D                                     DIM(17)
     D  WSL1                   1      3  0
     D  WSL2                   4      6  0
     D  WSL3                   7      9  0
     D  WSL4                  10     12  0
     D  WSL5                  13     15  0
     D  WSL6                  16     18  0
     D  WSL7                  19     21  0
     D  WSL8                  22     24  0
     D  WSL9                  25     27  0
     D  WSL10                 28     30  0
     D  WSL11                 31     33  0
     D  WSL12                 34     36  0
     D  WSL13                 37     39  0
     D  WSL14                 40     42  0
     D  WSL15                 43     45  0
     D  WSL16                 46     48  0
     D  WSL17                 49     51  0
     D                 DS
     D  BR                     1     51  0
     D                                     DIM(17)
     D  WSB1                   1      3  0
     D  WSB2                   4      6  0
     D  WSB3                   7      9  0
     D  WSB4                  10     12  0
     D  WSB5                  13     15  0
     D  WSB6                  16     18  0
     D  WSB7                  19     21  0
     D  WSB8                  22     24  0
     D  WSB9                  25     27  0
     D  WSB10                 28     30  0
     D  WSB11                 31     33  0
     D  WSB12                 34     36  0
     D  WSB13                 37     39  0
     D  WSB14                 40     42  0
     D  WSB15                 43     45  0
     D  WSB16                 46     48  0
     D  WSB17                 49     51  0
     D                 DS
     D  AN                     1     51  0
     D                                     DIM(17)
     D  WSA1                   1      3  0
     D  WSA2                   4      6  0
     D  WSA3                   7      9  0
     D  WSA4                  10     12  0
     D  WSA5                  13     15  0
     D  WSA6                  16     18  0
     D  WSA7                  19     21  0
     D  WSA8                  22     24  0
     D  WSA9                  25     27  0
     D  WSA10                 28     30  0
     D  WSA11                 31     33  0
     D  WSA12                 34     36  0
     D  WSA13                 37     39  0
     D  WSA14                 40     42  0
     D  WSA15                 43     45  0
     D  WSA16                 46     48  0
     D  WSA17                 49     51  0
     D                 DS
     D  VK                     1    119  2
     D                                     DIM(17)
     D  WSV1                   1      7  2
     D  WSV2                   8     14  2
     D  WSV3                  15     21  2
     D  WSV4                  22     28  2
     D  WSV5                  29     35  2
     D  WSV6                  36     42  2
     D  WSV7                  43     49  2
     D  WSV8                  50     56  2
     D  WSV9                  57     63  2
     D  WSV10                 64     70  2
     D  WSV11                 71     77  2
     D  WSV12                 78     84  2
     D  WSV13                 85     91  2
     D  WSV14                 92     98  2
     D  WSV15                 99    105  2
     D  WSV16                106    112  2
     D  WSV17                113    119  2
     D                 DS
     D  HOF                    1     51  0
     D                                     DIM(17)
     D  FIH1                   1      3  0
     D  FIH2                   4      6  0
     D  FIH3                   7      9  0
     D  FIH4                  10     12  0
     D  FIH5                  13     15  0
     D  FIH6                  16     18  0
     D  FIH7                  19     21  0
     D  FIH8                  22     24  0
     D  FIH9                  25     27  0
     D  FIH10                 28     30  0
     D  FIH11                 31     33  0
     D  FIH12                 34     36  0
     D  FIH13                 37     39  0
     D  FIH14                 40     42  0
     D  FIH15                 43     45  0
     D  FIH16                 46     48  0
     D  FIH17                 49     51  0
     D                 DS
     D  LEF                    1     51  0
     D                                     DIM(17)
     D  FIL1                   1      3  0
     D  FIL2                   4      6  0
     D  FIL3                   7      9  0
     D  FIL4                  10     12  0
     D  FIL5                  13     15  0
     D  FIL6                  16     18  0
     D  FIL7                  19     21  0
     D  FIL8                  22     24  0
     D  FIL9                  25     27  0
     D  FIL10                 28     30  0
     D  FIL11                 31     33  0
     D  FIL12                 34     36  0
     D  FIL13                 37     39  0
     D  FIL14                 40     42  0
     D  FIL15                 43     45  0
     D  FIL16                 46     48  0
     D  FIL17                 49     51  0
     D                 DS
     D  BRF                    1     51  0
     D                                     DIM(17)
     D  FIB1                   1      3  0
     D  FIB2                   4      6  0
     D  FIB3                   7      9  0
     D  FIB4                  10     12  0
     D  FIB5                  13     15  0
     D  FIB6                  16     18  0
     D  FIB7                  19     21  0
     D  FIB8                  22     24  0
     D  FIB9                  25     27  0
     D  FIB10                 28     30  0
     D  FIB11                 31     33  0
     D  FIB12                 34     36  0
     D  FIB13                 37     39  0
     D  FIB14                 40     42  0
     D  FIB15                 43     45  0
     D  FIB16                 46     48  0
     D  FIB17                 49     51  0
     D                 DS
     D  ANF                    1     51  0
     D                                     DIM(17)
     D  FIA1                   1      3  0
     D  FIA2                   4      6  0
     D  FIA3                   7      9  0
     D  FIA4                  10     12  0
     D  FIA5                  13     15  0
     D  FIA6                  16     18  0
     D  FIA7                  19     21  0
     D  FIA8                  22     24  0
     D  FIA9                  25     27  0
     D  FIA10                 28     30  0
     D  FIA11                 31     33  0
     D  FIA12                 34     36  0
     D  FIA13                 37     39  0
     D  FIA14                 40     42  0
     D  FIA15                 43     45  0
     D  FIA16                 46     48  0
     D  FIA17                 49     51  0
     D                 DS
     D  VKF                    1    119  2
     D                                     DIM(17)
     D  FIV1                   1      7  2
     D  FIV2                   8     14  2
     D  FIV3                  15     21  2
     D  FIV4                  22     28  2
     D  FIV5                  29     35  2
     D  FIV6                  36     42  2
     D  FIV7                  43     49  2
     D  FIV8                  50     56  2
     D  FIV9                  57     63  2
     D  FIV10                 64     70  2
     D  FIV11                 71     77  2
     D  FIV12                 78     84  2
     D  FIV13                 85     91  2
     D  FIV14                 92     98  2
     D  FIV15                 99    105  2
     D  FIV16                106    112  2
     D  FIV17                113    119  2
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XUL≈≈                 11     14  0
     D                 DS
     D  UL≈≈                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     c                   exsr      sum
     C                   EXFMT     BILDE
     c     *in03         ifeq      *on
     c     *in12         oreq      *on
     C                   GOTO      SLUTT
     C                   end
     C                   GOTO      START
     C     SLUTT         TAG
      *
     C*
     c                   move      HO            HOF
     c                   move      BR            BRF
     c                   move      LE            LEF
     c                   move      AN            ANF
     c                   move      VK            VKF
     C     *IN12         IFNE      '1'
     C   33              WRITE     HLBFILR
     C  N33              UPDATE    HLBFILR
     C                   ELSE
     C* N33              DELETE    HLBFILR
     C                   MOVE      *ZEROS        WSTOT
     C                   MOVE      *ZEROS        WSTOTA
     C                   MOVE      *ZEROS        WSTOTV
     C                   END
     C                   SETON                                        LR
     C                   RETURN
      ***********************************************************************
     C     INIT          BEGSR
      ***********************************************************************
     C     *ENTRY        PLIST
     C                   PARM                    ORONO             7 0
     C                   PARM                    WSTOT             7 3
     C                   PARM                    WSTOTA            5 0
     C                   PARM                    WSTOTV            8 2
      *
     c                   move      *ZEROS        HO
     c                   move      *ZEROS        BR
     c                   move      *ZEROS        LE
     c                   move      *ZEROS        AN
     c                   move      *ZEROS        VK
      *
     C                   WRITE     WINDOWSZ
      *
     C     ORONO         CHAIN     HLBFIL                             33
      *
     C     *in33         ifeq      '0'
     c                   move      HOF           HO
     c                   move      BRF           BR
     c                   move      LEF           LE
     c                   move      ANF           AN
     c                   move      VKF           VK
     c                   end
     C                   MOVE      *ZEROS        WSTOTT            7 5
     C                   ENDSR
      ***********************************************************************
     C     SUM           BEGSR
      ***********************************************************************
     c                   move      *zeros        wstot
     c                   move      *zeros        wstota
     c                   move      *zeros        wstotv
     C                   Z-ADD     1             XN                2 0
     C                   DO        17
     C     HO(XN)        MULT      LE(XN)        XKUB             14 5
     C                   MULT      BR(XN)        XKUB
     C     AN(XN)        IFGT      0
     C                   MULT      AN(XN)        XKUB
     C                   ELSE
     C     ho(xn)        ifne      0
     C                   Z-ADD     1             AN(XN)
     C                   END
     C                   END
     C                   DIV       1000000       XKUB
     C                   ADD       XKUB          WSTOT
     C                   ADD       1             XN
     C                   END
     c                   Xfoot     an            wstota
     c                   Xfoot     vk            wstotv
     C                   ENDSR
