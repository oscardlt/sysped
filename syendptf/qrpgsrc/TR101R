********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10250 * 01 YBC PTF10 DOKUMENTKODE ER ENDRET FRA 3A TIL 4A
10253 * 02 YBC PTF10 NY PAKKETYPE VS, BEHANLES SAMME SOM VR
10XXX * 03 YBC PTF10 BEHANDLE NF PÅ SAMME MÅTE SOM NE
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 04 YBC PTF11 FJERN TEST PÅ TET00004
11128 * 05 YBC PTF11 VEKT ER ENDRET FRA 9.0 TIL 11.3
11129 * 06 YBC PTF11 NYE KODER FOR FORHÅNDSVARSEL FRA JUNI 2016
11XXX * 07 YBC PTF11 RETT FEIL FLERE FORSEGLING LINJER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 08 YBC PTF12 FTX-segment for varebeskrivelse glemte : etter 70 tegn
12XXX * 09 YBC PTF12 Hent telefonnr fra SYPARF og send den i NAD+AH
      *              i følge brev fra tollvesenet
********************************************************************
     FEDIS      UF   E           K DISK
     FEDIMC     UF   E           K DISK
     FHEADF     IF   E           K DISK
     FTRUGH     UF   E           K DISK
     FTRUGD     IF   E           K DISK
     FTRUH      UF   E           K DISK
     FTRUHFV    IF   E           K DISK
     FTRUHK     UF   E           K DISK
     FTRUHFS    IF   E           K DISK
     FTRUHGB    IF   E           K DISK
     FTRUHGN    IF   E           K DISK
     FTRUV      UF   E           K DISK
     FTRUVFV    IF   E           K DISK
     FTRUVAM    IF   E           K DISK
     FTRUVCN    IF   E           K DISK
     FTRUVDK    IF   E           K DISK
     FTRUVFS    IF   E           K DISK
     FTRUVMN    IF   E           K DISK
     FTRUVTD    IF   E           K DISK
     FTRUVVT    IF   E           K DISK
     FEDIJ2     IF   E           K DISK
     FTARI      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
N09  FSYPARL2   IF   E           K DISK
N09  FSYPARL3   IF   E           K DISK    RENAME(SYPARFR:SYPARFR3)
     FSYPTFF    IF   E           K DISK
     FEDISE     O  A E             DISK
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
N08  D                 DS
N08  D  XAN140                 1    140
N08  D  XAN140_1               1     70
N08  D  XAN140_2              71    140
     D                 DS
     D  TS                     1     64
     D                                     DIM(8)                               Transit tollsted
     D  THTSD1                 1      8
     D  THTSD2                 9     16
     D  THTSD3                17     24
     D  THTSD4                25     32
     D  THTSD5                33     40
     D  THTSD6                41     48
     D  THTSD7                49     56
     D  THTSD8                57     64
     D                 DS
     D  FT                     1    350
     D                                     DIM(5)                               Kanselleringsgrunnla
     D  TKFT1                  1     70
     D  TKFT2                 71    140
     D  TKFT3                141    210
     D  TKFT4                211    280
     D  TKFT5                281    350
     D                 DS
     D  THLKR1                 1      2
     D  THLKR2                 3      4
     D  THLKR3                 5      6
     D  THLKR4                 7      8
     D  THLKR5                 9     10
     D  THLKR6                11     12
     D  THLKR7                13     14
     D  THLKR8                15     16
     D  LKR                    1     16    DIM(8)
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1     70
     D                                     DIM(70)                              Input string
     D  ADS                    1     70
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  SDATA                  1     80
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN163                  1     16  3
     D  ØA163H                 1     13
     D  ØA163X                 5     13
     D  ØA163D                14     16
     D                 DS
     D  ØA13                   1     13
     D  Ø13                    1     13
     D                                     DIM(13)                              Num edit
      *//////////////
      *  Hodelogikk /
      *//////////////
      * Initiering av variabler og nøkler
     C                   EXSR      SRA
      * Initiering av sendingsutgang (IBM/NIT)
     C                   EXSR      SRB
      * Plukk SAD og send til Tollvesenet
     C                   EXSR      SRC
      * Avsluttning av sending
     C                   EXSR      SRD
     C                   MOVE      '1'           *INLR
      *
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SSN           WSN
     C     *LIKE         DEFINE    S0036         W0036
     C     *LIKE         DEFINE    JCLFE         WCLFE
     C     *LIKE         DEFINE    MST           WST
     C     *LIKE         DEFINE    MVEN          WVEN
     C     *LIKE         DEFINE    TATAR         WATAR
      *
     C                   MOVE      '+'           WST
     C                   MOVE      *BLANKS       WVEN
     C                   MOVE      *BLANKS       WCLFE
     C                   MOVE      *BLANKS       WATAR
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              13
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     0             WORK             15 5
     C                   MOVEL     *BLANKS       UWS              10
     C                   MOVEL     'TVINN'       UWS
     C                   MOVE      *BLANKS       XTAR              3
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WSN
     C     KEYB          KLIST
     C                   KFLD                    SSR
     C                   KFLD                    WST
     C                   KFLD                    WVEN
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    S0035
     C     KEYC          KLIST
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    WCLFE
     C     KEYD          KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     KEYE          KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C                   KFLD                    TVLI
     C     TRVK          KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     HEADFK        KLIST
     C                   KFLD                    TVAVD2
     C                   KFLD                    TVTDN2
     C     TARIK         KLIST
     C                   KFLD                    TVVNT
     C                   KFLD                    XTAR
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
N09  C     SYPARL2K      KLIST
N09  C                   KFLD                    SYUSER
N09  C                   KFLD                    SYPAID
N09  C     SYPARL3K      KLIST
N09  C                   KFLD                    SYPAID
N09  C                   KFLD                    SYVRDA
      *_____________
      * Init av felt
      *"""""""""""""
      * Hente dagens dato og klokkeslett.
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
S04  C*    'TET00004'    CHAIN     SYPTFF                             33
S04  C*  33              MOVE      99999999      PTFDT
     C                   MOVE      WDT           XIDAG             8 0
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                2 0          Index for B
     C                   Z-ADD     0             AXV               2 0          Leftindx A
     C                   Z-ADD     0             AXH               2 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
     C                   MOVE      *BLANKS       WCONT             5            Continues
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WSN           PARM                    WSN
     C                   PARM                    WNETW             1
      *__________________
      * Output parametrer
      *""""""""""""""""""
     C     PLISTA        PLIST
     C                   PARM      S0004         S0004
     C                   PARM      S0010         S0010
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_____________________________
      * Hente data fra sendningslogg
      *"""""""""""""""""""""""""""""
     C     KEYA          CHAIN     EDIS                               81
     C                   MOVEL     SMBR          SEMBR
     C                   Z-ADD     0             W0036
      *_______________________________________________
      * Legg in JCL i starten av filen for Kommunedata
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   SELECT
     C     WNETW         WHENEQ    '1'
      *
     C                   MOVE      'F'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   ENDSL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Les meldinger                                        SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
      *_____________________________
      * Legg in UNB-segment (Sendningsstart)
      *_____________________________
     C                   EXSR      UNB00
      *
     C     KEYB          CHAIN     EDIMC                              8182
     C     *IN81         DOWEQ     '0'                                          1<-B
     C  N82M0065         IFEQ      'CUSDEC'                                      2<-B
     C     M1001         ANDEQ     'TET'
     C     M0065         OREQ      'SANCRT'
     C     M1001         ANDEQ     'TET'
     C     M1N07         IFEQ      '014'                                          3<-B
     C     M1N07         OREQ      '015'
     C     KEYD          CHAIN     TRUH                               82
     C     *IN82         IFEQ      '0'                                             4<-B
     C                   MOVE      'A'           THST
     C                   UPDATE    TRUHR
     C                   Z-ADD     SSN           MSN
     C                   MOVE      'A'           MST
     C                   MOVEL     WDT           MDT
     C                   MOVEL     WTM           MTM
     C                   UPDATE    EDIMR
     C                   SELECT                                                     5<-B
     C     M1N07         WHENEQ    '014'
     C                   EXSR      KANSEL
     C     M1N07         WHENEQ    '015'
     C                   EXSR      TRANSI
     C                   ENDSL                                                      5<-E
     C                   MOVEA     '00'          *IN(81)
     C                   GOTO      SLSRC
     C                   ELSE                                                      4
     C                   UPDATE    EDIMR
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     M1N07         IFEQ      '026'                                           4<-B
     C                   MOVEL     M0068         TGGNR
     C     TGGNR         CHAIN     TRUGH                              82
     C                   IF        *IN82 = '0'                                      5<-B
     C                   MOVE      'A'           TGST
     C                   UPDATE    TRUGHR
     C                   Z-ADD     SSN           MSN
     C                   MOVE      'A'           MST
     C                   MOVEL     WDT           MDT
     C                   MOVEL     WTM           MTM
     C                   UPDATE    EDIMR
     C                   EXSR      GARANTI
     C                   MOVEA     '00'          *IN(81)
     C                   GOTO      SLSRC
     C                   ELSE                                                       5
     C                   UPDATE    EDIMR
     C                   END                                                        5<-E
     C                   UPDATE    EDIMR
     C                   END                                                       4<-E
     C                   UPDATE    EDIMR
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   UPDATE    EDIMR
     C                   END                                                     2<-E
     C     KEYB          READE     EDIMC                                8281
     C  N81              END                                                    1<-E
      *_____________________________
      * Legg in UNZ (Slutt sendning)
      *"""""""""""""""""""""""""""""
     C     SLSRC         TAG
     C                   EXSR      UNZ00
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Slutt på file                                        SRD /
      *////////////////////////////////////////////////////////////
     C     SRD           BEGSR
      *________________________
      * Oppdatere sendningslogg
      *""""""""""""""""""""""""
     C                   MOVE      'A'           SST
     C                   Z-ADD     W0036         S0036
     C                   UPDATE    EDISR
      *_______________________________________________
      * Legg in JCL i slutten av filen for Kommunedata
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C     WNETW         IFEQ      '1'
     C                   MOVE      'E'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   END
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Send garantis adgangskode til Tollvesnet                   /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     GARANTI       BEGSR
      *
     C                   EXSR      UNH00
     C                   EXSR      BGM00G
     C                   EXSR      LOC00G
     C                   EXSR      NAD02G
     C                   EXSR      LIN09G
     C                   EXSR      UNT00
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Send kansellering til Tollvesnet                           /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     KANSEL        BEGSR
      *
     C     KEYD          CHAIN     TRUHK                              82
     C                   MOVE      WDT           TKDT
     C                   UPDATE    TRUHKR
      *
     C                   EXSR      UNH00
     C                   EXSR      BGM00X
     C                   EXSR      LOC00X
     C                   EXSR      DTM00X
     C                   EXSR      FTX00X
     C                   EXSR      NAD06X
     C                   EXSR      UNS00A
     C                   EXSR      UNS00B
     C                   EXSR      UNT00
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Send transittering til Tollvesnet                          /
      * Her skrive UNH, BGM og UNT segment                         /
      */////////////////////////////////////////////////////////////
     C     TRANSI        BEGSR
      *
     C     KEYD          CHAIN     TRUHFV                             33
     C                   IF        *IN33
     C                   MOVE      'N'           XFORHV            1
     C                   CLEAR                   TRUHFVR
     C                   ELSE
     C                   MOVE      'J'           XFORHV
     C                   END
      *
     C                   EXSR      UNH00
     C                   EXSR      BGM00
     C                   EXSR      LOC00
     C                   EXSR      DTM00
     C                   EXSR      GIS00
      * TEST OM VARELINJER HAR FORSKJELLIGE AVSENDER/MOTTAKER
     C                   EXSR      TSTAM
     C                   EXSR      FII00
     C                   EXSR      MEA00
     C                   EXSR      EQD00
     C                   EXSR      SEL00
     C                   EXSR      FTX00
     C                   EXSR      RFF01
     C                   EXSR      TDT04
     C                   EXSR      NAD06
     C                   EXSR      UNS00A
     C                   EXSR      CST30
     C                   EXSR      UNS00B
     C                   EXSR      CNT00
     C                   EXSR      UNT00
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Sendningsstart                                     UNB00 /
      *////////////////////////////////////////////////////////////
     C     UNB00         BEGSR
      *______________
      * START SEGMENT
      *""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNB+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *______________________
      * SYNTAX IDENTIFIKASJON
      *""""""""""""""""""""""
      * Identifikasjon og versjon
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNOC:3+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________________
      * OVERFØRINGSAVSENDER
      *""""""""""""""""""""
      * Identifikasjon
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0004         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________________
      * OVERFØRINGSMOTTAKER
      *""""""""""""""""""""
      * Identifikasjon og Qualifier
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0010         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________________________________
      * DATO/TID FOR FREMSTILLING AV OVERFØRINGEN
      *""""""""""""""""""""""""""""""""""""""""""
      * Dato
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SDT           ADS
     C                   Z-ADD     3             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Tid
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     STM           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________
      * OVERFØRINGENS REFERANSE
      *""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0020         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      *______________________________________________
      * APPLIKASJONSREFERANSE (Kun hvis nettverk=IBM)
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     WNETW         IFEQ      '2'                                          <----------I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     '++'          ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     2             AXH                                       I
     C                   MOVE      'N'           WCHART                                    I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     S0026         ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     14            AXH                                       I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   END                                                    <----------I
      *______________
      * TESTINDIKATOR
      *""""""""""""""
     C     S0035         IFGT      '0'                                          <----------I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   SELECT
     C     WNETW         WHENEQ    '1'                                           <--------II
     C                   MOVEL     '++++++'      ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     6             AXH                                      II
     C     WNETW         WHENEQ    '2'                                           <--------II
     C                   MOVEL     '++++'        ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     4             AXH                                      II
     C                   OTHER                                                   <--------II
     C                   MOVEL     '++++++'      ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     6             AXH                                      II
     C                   ENDSL                                                   <--------II
     C                   MOVE      'N'           WCHART                                    I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     S0035         ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     1             AXH                                       I
     C                   EXSR      SRÅ                                                     I
     C                   END                                                    <----------I
      *______________
      * SLUTT SEGMENT
      *""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsstart                                      UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNH+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0062         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     14            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0065         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':D:96B:U'    ADS
     C                   SELECT
     C     M1N07         WHENEQ    '014'
     C                   MOVEA     'N:CC014A'    A(9)
     C     M1N07         WHENEQ    '015'
S04  C*                  IF        PTFDT <= XIDAG
     C                   MOVEA     'N:CC015B'    A(9)
S04  C*                  ELSE
S04  C*                  MOVEA     'N:CC015A'    A(9)
S04  C*                  END
     C     M1N07         WHENEQ    '026'
     C                   MOVEA     'N:CC026A'    A(9)
     C                   ENDSL
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM+:::'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                     LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+118+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THCATS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      *_____________
      * Avsendesland
      *"""""""""""""
      * Segmentnavn
     C     THALK         IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+35+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLSTL        IFEQ      0
     C                   MOVEL     THALK         ADS
     C                   ELSE
     C                   MOVEL     '--'          ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *_________________
      * Bestemmelsesland
      *"""""""""""""""""
      * Segmentnavn
     C     THBLK         IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+36+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THBLK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *____________________
      * Avtalt kontrollsted
      *""""""""""""""""""""
      * Segmentnavn
     C                   IF        THENKL = 'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+26+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOLLSTED'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *__________
      * Lastested
      *""""""""""
     C     THLSD         IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+9+'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THLSD         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *_________________________
      * Transitteringstollsteder
      *"""""""""""""""""""""""""
     C     1             DO        8             XN                3 0
     C     TS(XN)        IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+50+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TS(XN)        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
      *_________________________________________
      * Dato og tidspunkt for ankomst til grense
      *"""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THSIK = 1) AND (XN = 1))
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      THDTA         XAN08             8
     C                   MOVE      THTMA         XAN04             4
     C                   EVAL      ADS = XAN08 + XAN04
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
     C                   END
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
     C                   ENDDO
      *____________________
      * Bestemmelsetollsted
      *""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+45+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTSB         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_____________________
      * Deklarasjonstollsted
      *"""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+91+:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDST         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+++'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THDSK         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THDSK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________________
      * Avtalt lagringssted
      * Foreløpig fasttekst
      *""""""""""""""""""""
      * Segmentnavn
     C     THENKL        IFEQ      'J'
     C     THENKL        ANDEQ     'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+14++'    ADS
     C                   MOVEA     'Main++NO'    A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *__________
      * Lossested
      *""""""""""
      * Segmentnavn
     C                   IF        THLOSD <> *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'LOC+58+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THLOSDSK = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THLOSDSK
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = ':::'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THLOSD
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dato                                               DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
      *_________________
      * Deklarasjonsdato
      *"""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+137:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WDT           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________
      * Tidsfrist for kontroll
      *"""""""""""""""""""""""
      * Segmentnavn
     C     THDDT         IFGT      0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+268:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDDT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 GIS00 /
      *////////////////////////////////////////////////////////////
     C     GIS00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
      * Container
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THKDC         IFEQ      ' '
     C                   MOVE      '0'           THKDC
     C                   END
     C                   MOVEL     THKDC         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':109'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Segmentnavn
      * W0074  --->  Teller for antall segment
      * Normal eller forenklet prosedyre
     C     THENKL        IFEQ      'J'
     C     THENKL        ANDEQ     'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '1'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':119'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      * Sikkerhet
      * Segmentnavn
     C                   IF        XFORHV = 'J'
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'GIS+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSIK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = ':187'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                 FII00 /
      *////////////////////////////////////////////////////////////
     C     FII00         BEGSR
      * Kommesielt referansenr
      * Segmentnavn
     C                   IF        ((THKREF <> *BLANKS) AND (XULIKKREF <> 'J'))
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FII+XX++:::::::'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THKREF
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål                                                MEA00 /
      *////////////////////////////////////////////////////////////
     C     MEA00         BEGSR
      *_________________
      * Total Bruttovekt
      *"""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AD+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Bruttovekt
     C                   MOVE      *BLANKS       ADS
S05  C*                  MOVEL     THVKB         ADS
N05  C                   Z-ADD     THVKB         ØN163
N05  C                   EXSR      SRNE
N05  C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
S05  C*                  Z-ADD     9             AXH
N05  C                   Z-ADD     12            AXH
S05  C*                  MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Reiserute                                          EQD00 /
      *////////////////////////////////////////////////////////////
     C     EQD00         BEGSR
      *
     C     1             DO        8             XN                3 0
      *_________
      * Landkode
      *"""""""""
     C                   IF        LKR(XN) <> *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'EQD+CH+:::'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = LKR(XN)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forsegling                                         SEL00 /
      *////////////////////////////////////////////////////////////
     C     SEL00         BEGSR
      *
     C     THDANT        CABEQ     0             SEL099
      *___________
      * Forsegling
      *"""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'SEL+0+::'    ADS
     C                   MOVE      ':'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDFKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
      *
     C     THDFSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDFSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYD          SETLL     TRUHFS
     C     KEYD          READE     TRUHFS                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'SEL+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
S07  C*    TFDFSK        IFNE      *BLANKS
S07  C*                  MOVE      *BLANKS       ADS
S07  C*                  MOVEL     TFDFSK        ADS
N07  C                   EVAL      ADS = '0'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
S07  C*                  END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+:::'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TFDFKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
N07   *
N07  C     TFDFSK        IFNE      *BLANKS
N07  C                   MOVE      *BLANKS       ADS
N07  C                   MOVEL     '+'           ADS
N07  C                   Z-ADD     1             AXV
N07  C                   Z-ADD     1             AXH
N07  C                   MOVE      'N'           WCHART
N07  C                   EXSR      SRÅ
N07   *
N07  C                   MOVE      *BLANKS       ADS
N07  C                   MOVEL     TFDFSK        ADS
N07  C                   Z-ADD     1             AXV
N07  C                   Z-ADD     2             AXH
N07  C                   EXSR      SRÅ
N07  C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYD          READE     TRUHFS                                 34
     C  N34              ENDDO
      *
     C     SEL099        ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster                                         FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
      *________________________________
      * Dialogspråk ved avgangstollsted
      *""""""""""""""""""""""""""""""""
      * ikke benyttet ennå på SYSPED
      *____________________________
      * Språkkode for følgedokument
      *""""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ALL+'    ADS
     C                   MOVEA     '+++'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THSKFD        IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THSKFD        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *______________________
      * Representens_fullmakt
      *""""""""""""""""""""""
      * Ikke benyttet ennå på SYSPED
      *______________________
      * Kontrollresultat kode
      *""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     THDKR         IFNE      *BLANKS
     C     THDK          ANDNE     'SS'
N06  C     THDK          ANDNE     'ENTRY'
N06  C     THDK          ANDNE     'EXIT'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ADO+'    ADS
     C                   MOVEL     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDKR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_______________________________
      * Transportkostnad betalingsmåte
      *"""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THTKBM <> *BLANKS) AND (XULIKTKBM <> 'J'))
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FTX+PAI+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THTKBM
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_____________________________
      * Transportens referansenummer
      *"""""""""""""""""""""""""""""
      * Segmentnavn
     C                   IF        THTREF <> *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FTX+ACR+++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THTREF
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referanser                                         RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *____________________
      * Deklarasjons-ID LRN
      *""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+ABE:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Felles referanse, deklarant-ID/dato/sekvensnr.
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0068         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     22            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Garantitype
      *""""""""""""
      * Segmentnavn
      * INGEN GARANTIOPPLYSNING VED RENT FORHÅNDSVARSLING
     C                   IF        THDK <> 'SS'
N06  C                             AND THDK <> 'ENTRY' AND THDK <> 'EXIT'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+ABL:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGKD         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PAC02
     C                   END
      *______________________
      * Spesiell omstendighet
      *""""""""""""""""""""""
      * Segmentnavn
     C                   IF        THSPOM <> *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'RFF+AMJ:'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THSPOM
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                  NAD02G /
      *////////////////////////////////////////////////////////////
     C     NAD02G        BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Garanti referanse                                  PAC02 /
      *////////////////////////////////////////////////////////////
     C     PAC02         BEGSR
     C                   MOVE      THGFT1        XGGFT1           24
     C                   MOVE      THGADK        XGGADK            4
     C                   MOVE      THGBGI        XGGBGI            1 0
     C                   MOVE      THGBGU        XGGBGU            2
     C                   MOVE      THGBL         XGGBL            11 0
     C                   MOVE      THGVK         XGGVK             3
     C     KEYD          SETLL     TRUHGN
     C     STPAC02       TAG
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+1+++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Adgangskode
      *""""""""""""
     C     THGADK        IFNE      *BLANKS
     C     THGKD         OREQ      0
     C     THGKD         OREQ      1
     C     THGKD         OREQ      2
     C     THGKD         OREQ      4
     C     THGKD         OREQ      9
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGADK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C     THGFT2        IFEQ      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   ELSE
     C                   MOVEL     ':::'         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THGFT2        IFEQ      *BLANKS
      *___________________
      * Garantireferansenr
      *"""""""""""""""""""
     C                   MOVEL     THGFT1        ADS
     C                   ELSE
      *_________________________
      * Annen Garantireferansenr
      *"""""""""""""""""""""""""
     C                   MOVEL     THGFT2        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PCI03
      *
     C     KEYD          READE     TRUHGN                                 34
     C                   IF        *IN34 = '0'
     C                   MOVE      TGGFT1        THGFT1
     C                   MOVE      TGGADK        THGADK
     C                   MOVE      TGGBGI        THGBGI
     C                   MOVE      TGGBGU        THGBGU
     C                   GOTO      STPAC02
     C                   END
     C                   MOVE      XGGFT1        THGFT1
     C                   MOVE      XGGADK        THGADK
     C                   MOVE      XGGBGI        THGBGI
     C                   MOVE      XGGBGU        THGBGU
     C                   MOVE      XGGBL         THGBL
     C                   MOVE      XGGVK         THGVK
     C
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Begrensning av garantis gyldighet                  PCI03 /
      *////////////////////////////////////////////////////////////
     C     PCI03         BEGSR
      *__________________________________
      * Begrensning av gyldighet innen EU
      *""""""""""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     THGBGU        IFEQ      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+19+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGBGI        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ELSE
      *____________________________________
      * Begrensning av gyldighet utenfor EU
      *""""""""""""""""""""""""""""""""""""
     C*          THGBGU    CABEQ*BLANKS   PCI099
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THGBGU        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THGBGU        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYD          SETLL     TRUHGB
     C     KEYD          READE     TRUHGB                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THGBGU        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGGBGU        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     KEYD          READE     TRUHGB                                 34
     C  N34              ENDDO
      *
     C                   END
      *
     C     PCI099        ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetljer                                   TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
      *_________________________
      * Innenlands transportmåte
      *"""""""""""""""""""""""""
      * Ikke benyttet i SYSPED
      *
     C     THTRM         IFNE      0
      *_________________________
      * Transportmåte ved avgang
      *"""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TDT+11++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTRM         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *____________________________________________
      * Transportmiddel ved grensepassning rubr. 21
      *""""""""""""""""""""""""""""""""""""""""""""
      * Ikke benyttet i SYSPED
      *
     C     THTRM         IFNE      20
     C     THTRM         ANDNE     23
     C     THTRM         ANDNE     50
     C     THTRM         ANDNE     70
     C     THTGID        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+++++:::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________________
      * Transportmidlets identitet ved grensepassning rubr. 21
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTGID        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________________________________________________
      * Transportmidlets nasjonalitet ved grensepassning rubr. 21
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C     THTGLK        IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THTGLK        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTRM         IFNE      20
     C     THTRM         ANDNE     23
     C     THTRM         ANDNE     50
     C     THTRM         ANDNE     70
     C                   EXSR      TPL04A
     C                   END
      *
     C                   END
      *___________________________
      * Transportmiddel ved avgang
      *"""""""""""""""""""""""""""
     C     THTRM         IFNE      50
     C     THTRM         ANDNE     70
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TDT+12++'    ADS
     C                   MOVEA     '+++++:::'    A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     16            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________
      * Transportmidlets identitet ved avgang rubr. 18
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTAID        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
      *
     C     THTRM         IFNE      20
     C     THTRM         ANDNE     23
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______________________________________________
      * Transportmidlets identitet ved avgang rubr. 18
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTALK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     27            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      TPL04B
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transport placement                               TPL04A /
      *////////////////////////////////////////////////////////////
     C     TPL04A        BEGSR
      *____________________________________________________________
      * Språkkode for transportmidlets identitet ved grensepassning
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     THTGSK        IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TPL+::::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTGSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transport placement                               TPL04B /
      *////////////////////////////////////////////////////////////
     C     TPL04B        BEGSR
      *____________________________________________________
      * Språkkode for transportmidlets identitet ved avgang
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     THTASK        IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TPL+::::'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTASK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                   NAD06 /
      *////////////////////////////////////////////////////////////
     C     NAD06         BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINA        IFNE      *BLANKS                                      1<-B
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADA1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADA1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKA         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKA         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THLKA         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________________
      * Representantnavn
      *"""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AH++'    ADS
     C                   MOVE      '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
N09   *
N09  C                   IF        XFORHV = 'J'
N09  C*                  EVAL      SYUSER = THSG
N09  C                   EVAL      SYVRDA = THSG
N09  C                   EVAL      SYPAID = 'USRID'
N09  C     SYPARL3K      CHAIN     SYPARL3                            33
N09  C                   IF        *IN33 = *OFF
N09  C                   EVAL      SYPAID = 'TETAH'
N09  C     SYPARL2K      CHAIN     SYPARL2                            33
N09  C                   END
N09  C   33              EVAL      SYVRDA = THTARF
N09  C  N33              EVAL      SYVRDA = %TRIM(SYVRDA) + ' ' + %TRIM(THTARF)
N09  C                   ELSE
N09  C                   EVAL      SYVRDA = THTARF
N09  C                   END
      *
     C                   MOVE      *BLANKS       ADS
S09  C*                  MOVEL     THTARF        ADS
N09  C                   EVAL      ADS = SYVRDA
     C                   Z-ADD     1             AXV
S09  C*                  Z-ADD     16            AXH
N09  C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________
      * Avsender
      *"""""""""
      * Segmentnavn
     C     XULIK         IFEQ      'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CZ+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINS        IFNE      *BLANKS                                      1<-B
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADS1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADS1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKS         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKS         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THLKS         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C*                    END                             1<-E
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________
      * Mottaker
      *"""""""""
      * Segmentnavn
     C     XULIKM        IFEQ      'N'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CN+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     THTINK        XHTINK            9
     C     THTINK        IFNE      *BLANKS                                      1<-B
     C     XHTINK        ANDNE     *ZEROS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADK1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADK1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKK         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKK         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THLKK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_____________________
      * Autoriserte mottaker
      *"""""""""""""""""""""
     C     THTINK        IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+TD+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   IF        XFORHV = 'J'
     C                   EXSR      NAD06FV
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser FORHÅNDSVARSLING                NAD06FV /
      *////////////////////////////////////////////////////////////
     C     NAD06FV       BEGSR
      *___________________
      * Avsender sikkerhet
      *"""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THNASS <> *BLANKS) AND (XULIKS = 'N'))
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'NAD+GL+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THTINSS <> *BLANKS                           1<-B
     C                   EVAL      ADS = THTINSS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   EVAL      ADS = '++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THNASS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THADSS1 = *BLANKS
     C                   EVAL      ADS = '.'
     C                   ELSE
     C                   EVAL      ADS = THADSS1
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPSSS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THSKSS = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THSKSS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPNSS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THLKSS = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THLKSS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
      *___________________
      * Mottaker sikkerhet
      *"""""""""""""""""""
      * Segmentnavn
     C                   IF        ((THNAKS <> *BLANKS) AND (XULIKMS = 'N'))
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'NAD+UC+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THTINKS <> *BLANKS                           1<-B
     C                   EVAL      ADS = THTINKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   EVAL      ADS = '++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THNAKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THADKS1 = *BLANKS
     C                   EVAL      ADS = '.'
     C                   ELSE
     C                   EVAL      ADS = THADKS1
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPSKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THSKKS = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THSKKS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPNKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THLKKS = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THLKKS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *____________
      * Transportør
      *""""""""""""
      * Segmentnavn
     C                   IF        THNAT <> *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'NAD+GA+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THTINT <> *BLANKS                            1<-B
     C                   EVAL      ADS = THTINT
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
     C                   EVAL      ADS = '++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THNAT
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THADT1 = *BLANKS
     C                   EVAL      ADS = '.'
     C                   ELSE
     C                   EVAL      ADS = THADT1
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPST
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THSKT = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THSKT
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = THPNT
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        THLKT = *BLANKS
     C                   EVAL      ADS = 'NO'
     C                   ELSE
     C                   EVAL      ADS = THLKT
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Garantinr                                         LIN09G /
      *////////////////////////////////////////////////////////////
     C     LIN09G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LIN+++'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Garantinr
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGGNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX11G
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Adgangskode                                       FTX11G /
      *////////////////////////////////////////////////////////////
     C     FTX11G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ABY++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Gammel adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGAKGM        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+CCI++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Ny adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGAKNY        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TGGNR         SETLL     TRUGD
     C     TGGNR         READE     TRUGD                                  33
     C                   DOW       *IN33 = *OFF
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+AUT++'   ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adgangskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TDAK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     TGGNR         READE     TRUGD                                  33
     C                   ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                     UNS00A /
      *////////////////////////////////////////////////////////////
     C     UNS00A        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+D'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varelinjer                                         CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR
     C                   MOVE      *ZEROS        XVN               5 0
     C     TRVK          SETLL     TRUV
     C     TRVK          READE     TRUV                                   33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XVN
     C                   MOVE      XVN           TVLN
     C                   UPDATE    TRUVR
     C     KEYE          CHAIN     TRUVFV                             33
     C   33              CLEAR                   TRUVFVR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CST+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     XVN           ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      *
     C     THLSTL        IFEQ      0
      *
     C     TVVNT         IFNE      0
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Varenr
     C     TVVNT         IFNE      0
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVVNT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     THDK          IFEQ      'T-'
     C                   MOVE      *BLANKS       ADS
     C     TVVNT         IFEQ      0
     C                   MOVEL     '+++++'       ADS
     C                   ELSE
     C                   MOVEL     '++++'        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX30
     C     THLSTL        IFEQ      0
     C                   EXSR      LOC30
     C                   EXSR      MEA30
     C                   EXSR      NAD30
     C                   EXSR      TDT30
     C                   EXSR      PAC31
     C                   EXSR      RFF35
     C                   END
     C                   EXSR      DOC37
     C                   EXSR      TOD38
     C     THLSTL        IFEQ      0
     C                   EXSR      GIR44
     C                   END
      *
     C     TRVK          READE     TRUV                                   33
     C  N33              ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varebeskrivelse                                    FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
      *
     C     TVVT          IFEQ      *BLANKS
     C     TARIK         CHAIN     TARI                               34
     C  N34              MOVEL     TAALFA        TVVT
     C                   END
      * Segmentnavn
      * W0074  --->  Teller for antall segment
N08  C                   EVAL      XAN140 = TVVT
     C     KEYE          SETLL     TRUVVT
N08  C     KEYE          READE     TRUVVT                                 34
N08  C                   DOW       *IN34 = *OFF
N08  C                   EVAL      XAN140 = %TRIM(XAN140) + ' ' + %TRIM(TVVT)
N08  C     KEYE          READE     TRUVVT                                 34
N08  C                   ENDDO
S08  C*    FTX30A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+AAA+'    ADS
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
S08  C*                  MOVEL     TVVT          ADS
N08  C                   MOVEL     XAN140_1      ADS
     C                   Z-ADD     1             AXV
S08  C*                  Z-ADD     48            AXH
N08  C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
N08  C                   IF        XAN140_2 <> *BLANKS
N08  C                   EVAL      ADS = ':'
N08  C                   Z-ADD     1             AXV
N08  C                   Z-ADD     1             AXH
N08  C                   MOVE      'N'           WCHART
N08  C                   EXSR      SRÅ
N08  C                   EVAL      ADS = XAN140_2
N08  C                   Z-ADD     1             AXV
N08  C                   Z-ADD     70            AXH
N08  C                   EXSR      SRÅ
N08  C                   END
      *
     C     TVVTSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVVTSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
S08  C*    FTX30B        TAG
S08  C*    KEYE          READE     TRUVVT                                 34
S08  C* N34TVVT          IFEQ      *BLANKS
S08  C*                  GOTO      FTX30B
S08  C*                  ELSE
S08  C*                  GOTO      FTX30A
S08  C*                  END
      *
      * FORHÅNDSVARSLING, KOMMESIELT REFERANSENR
      * Segmentnavn
     C                   IF        ((XFORHV = 'J') AND (XULIKKREF = 'J'))
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FTX+IND+++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVKREF = *BLANKS
     C                   EVAL      ADS = THKREF
     C                   ELSE
     C                   EVAL      ADS = TVKREF
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                     LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
     C     THALK         IFEQ      *BLANKS
      *______________________________________________
      * Avsendesland (Ikke sende ved papirlasteliste)
      *""""""""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+35+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVALK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________________
      * Bestemmelsesland
      *"""""""""""""""""
      * Segmentnavn
     C     THBLK         IFEQ      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+36+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVBLK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål                                                MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *___________
      * Bruttovekt
      *"""""""""""
     C     TVVKTB        IFNE      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AB+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
S05  C*                  MOVEL     TVVKTB        ADS
N05  C                   Z-ADD     TVVKTB        ØN163
N05  C                   EXSR      SRNE
N05  C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
S05  C*                  Z-ADD     9             AXH
N05  C                   Z-ADD     12            AXH
S05  C*                  MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________
      * Nettovekt
      *""""""""""
     C     TVVKTN        IFNE      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'MEA+WT+A'    ADS
     C                   MOVEA     'AA+KGM:'     A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     15            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
S05  C*                  MOVEL     TVVKTN        ADS
N05  C                   Z-ADD     TVVKTN        ØN163
N05  C                   EXSR      SRNE
N05  C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
S05  C*                  Z-ADD     9             AXH
N05  C                   Z-ADD     12            AXH
S05  C*                  MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                   NAD30 /
      *////////////////////////////////////////////////////////////
     C     NAD30         BEGSR
      *
     C     XULIK         IFEQ      'J'                                          1<-B
     C     XULIKM        OREQ      'J'
     C     KEYE          CHAIN     TRUVAM                             34
     C     *IN34         IFEQ      '0'                                           2<-B
     C     XULIK         IFEQ      'J'                                            3<-B
     C     TVNAS         ANDEQ     *BLANKS
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   END                                                      3<-E
     C     XULIKM        IFEQ      'J'                                            3<-B
     C     TVNAK         ANDEQ     *BLANKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
      *
     C     TVAVD2        IFNE      0                                              3<-B
     C     HEADFK        CHAIN     HEADF                              34
     C                   MOVE      HENAS         TVNAS
     C                   MOVE      HEADS1        TVADS1
     C                   MOVEL     HEADS3        TVPNS
     C                   MOVEL     HEADS3        TVPSS
     C                   MOVEL     'NO'          TVSKS
     C     HEUR          IFEQ      'B'                                             4<-B
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      'NO'          TVLKS
     C                   ELSE                                                      4
     C                   MOVE      HELKA         TVLKS
     C                   END                                                       4<-E
     C     HEKNS         IFEQ      0                                               4<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                      4
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C     SYFOR9        IFEQ      *ZEROS                                           5<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                       5
     C                   MOVEL     SYFORE        TVTINS
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   MOVE      HENAK         TVNAK                            3<-E
     C                   MOVE      HEADK1        TVADK1
     C                   MOVEL     HEADK3        TVPNK
     C                   MOVEL     HEADK3        TVPSK
     C                   MOVEL     'NO'          TVSKK
     C     HEUR          IFEQ      'A'                                            3<-B
     C     HEUR          OREQ      'C'
     C     HEUR          OREQ      'F'
     C                   MOVEL     'NO'          TVLKK
     C                   ELSE                                                     3
     C                   MOVEL     HELKA         TVLKK
     C                   END                                                      3<-E
     C     HEKNK         IFEQ      0                                              3<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                     3
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C     SYFOR9        IFEQ      *ZEROS                                          4<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                      4
     C                   MOVEL     SYFORE        TVTINK
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     TVADS1        IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADS1
     C                   END                                                     2<-E
     C     TVADK1        IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADK1
     C                   END                                                     2<-E
      *
     C     XULIKS        IFEQ      'J'                                          1<-B
     C     XULIKMS       OREQ      'J'
     C     KEYE          CHAIN     TRUVFV                             34
     C     *IN34         IFEQ      '0'                                           2<-B
     C     XULIKS        IFEQ      'J'                                            3<-B
     C     TVNASS        ANDEQ     *BLANKS
     C                   MOVE      THTINSS       TVTINSS
     C                   MOVE      THNASS        TVNASS
     C                   MOVE      THADSS1       TVADSS1
     C                   MOVE      THPNSS        TVPNSS
     C                   MOVE      THPSSS        TVPSSS
     C                   MOVE      THLKSS        TVLKSS
     C                   MOVE      THSKSS        TVSKSS
     C                   END                                                      3<-E
     C     XULIKMS       IFEQ      'J'                                            3<-B
     C     TVNAKS        ANDEQ     *BLANKS
     C                   MOVE      THTINKS       TVTINKS
     C                   MOVE      THNAKS        TVNAKS
     C                   MOVE      THADKS1       TVADKS1
     C                   MOVE      THPNKS        TVPNKS
     C                   MOVE      THPSKS        TVPSKS
     C                   MOVE      THLKKS        TVLKKS
     C                   MOVE      THSKKS        TVSKKS
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     TVADSS1       IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADSS1
     C                   END                                                    1<-E
     C     TVADKS1       IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADKS1
     C                   END                                                    1<-E
      *_________
      * Avsender
      *"""""""""
      * Segmentnavn
     C     XULIK         IFEQ      'J'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CZ+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVNAS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVADS1        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPSS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVSKS         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'NO'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVSKS         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPNS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVLKS         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'NO'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVLKS         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *_________
      * Mottaker
      *"""""""""
      * Segmentnavn
     C     XULIKM        IFEQ      'J'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+CN+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVNAK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVADK1        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVSKK         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'NO'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVSKK         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVPNK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     TVLKK         IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     'NO'          ADS
     C                   ELSE                                                     3
     C                   MOVEL     TVLKK         ADS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   END                                                    1<-E
      *
     C                   IF        XFORHV = 'J'
     C                   EXSR      NAD30FV
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser FORHÅNDSVARSLING                NAD30FV /
      *////////////////////////////////////////////////////////////
     C     NAD30FV       BEGSR
      *
     C     XULIKS        IFEQ      'J'                                          1<-B
     C     XULIKMS       OREQ      'J'
     C     KEYE          CHAIN     TRUVFV                             34
     C     *IN34         IFEQ      '0'                                           2<-B
     C     XULIKS        IFEQ      'J'                                            3<-B
     C     TVNASS        ANDEQ     *BLANKS
     C                   MOVE      THTINSS       TVTINSS
     C                   MOVE      THNASS        TVNASS
     C                   MOVE      THADSS1       TVADSS1
     C                   MOVE      THPNSS        TVPNSS
     C                   MOVE      THPSSS        TVPSSS
     C                   MOVE      THLKSS        TVLKSS
     C                   MOVE      THSKSS        TVSKSS
     C                   END                                                      3<-E
     C     XULIKMS       IFEQ      'J'                                            3<-B
     C     TVNAKS        ANDEQ     *BLANKS
     C                   MOVE      THTINKS       TVTINKS
     C                   MOVE      THNAKS        TVNAKS
     C                   MOVE      THADKS1       TVADKS1
     C                   MOVE      THPNKS        TVPNKS
     C                   MOVE      THPSKS        TVPSKS
     C                   MOVE      THLKKS        TVLKKS
     C                   MOVE      THSKKS        TVSKKS
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVE      THTINS        TVTINS
     C                   MOVE      THNAS         TVNAS
     C                   MOVE      THADS1        TVADS1
     C                   MOVE      THPNS         TVPNS
     C                   MOVE      THPSS         TVPSS
     C                   MOVE      THLKS         TVLKS
     C                   MOVE      THSKS         TVSKS
     C                   MOVE      THTINK        TVTINK
     C                   MOVE      THNAK         TVNAK
     C                   MOVE      THADK1        TVADK1
     C                   MOVE      THPNK         TVPNK
     C                   MOVE      THPSK         TVPSK
     C                   MOVE      THLKK         TVLKK
     C                   MOVE      THSKK         TVSKK
     C                   END                                                     2<-E
      *
     C     TVADSS1       IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADSS1
     C                   END                                                     2<-E
     C     TVADKS1       IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     '.'           TVADKS1
     C                   END                                                     2<-E
      *___________________
      * Avsender sikkerhet
      *"""""""""""""""""""
      * Segmentnavn
     C                   IF        XULIKS = 'J'                                  2<-B
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'NAD+GM+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     TVTINSS       XAN09             9
     C                   IF        ((TVTINSS <> *BLANKS) AND (XAN09 <> *ZEROS))   3<-B
     C                   EVAL      ADS = TVLKSS + TVTINS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                      3<-E
      *
     C                   EVAL      ADS = '++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVNASS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVADSS1
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVPSSS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVSKSS = *BLANKS                               3<-B
     C                   EVAL      ADS = 'NO'
     C                   ELSE                                                     3
     C                   EVAL      ADS = TVSKSS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVPNSS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVLKS = *BLANKS                                3<-B
     C                   EVAL      ADS = 'NO'
     C                   ELSE                                                     3
     C                   EVAL      ADS = TVLKS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END                                                     2<-E
      *___________________
      * Mottaker sikkerhet
      *"""""""""""""""""""
      * Segmentnavn
     C                   IF        XULIKMS = 'J'                                 2<-B
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'NAD+DP+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     TVTINKS       XAN09             9
     C                   IF        ((TVTINKS <> *BLANKS) AND (XAN09 <> *ZEROS))   3<-B
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTINKS       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   END                                                      3<-E
      *
     C                   EVAL      ADS = '++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVNAKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVADKS1
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVPSKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVSKKS = *BLANKS                               3<-B
     C                   EVAL      ADS = 'NO'
     C                   ELSE                                                     3
     C                   EVAL      ADS = TVSKKS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVPNKS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = '+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVLKKS = *BLANKS                               3<-B
     C                   EVAL      ADS = 'NO'
     C                   ELSE                                                     3
     C                   EVAL      ADS = TVLKKS
     C                   END                                                      3<-E
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Farlig gods kode                                   TDT30 /
      *////////////////////////////////////////////////////////////
     C     TDT30         BEGSR
      *
     C                   IF        ((XULIKTKBM = 'J') OR (TVFGKD <> *BLANKS))
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'TDT+10+++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________________________________
      * Transportkostnad - betalingsmåte
      *"""""""""""""""""""""""""""""""""
     C                   IF        XULIKTKBM = 'J'
     C                   IF        TVTKBM = *BLANKS
     C                   EVAL      ADS = THTKBM
     C                   ELSE
     C                   EVAL      ADS = TVTKBM
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
     C                   END
      *_________________
      * Farlig gods kode
      *"""""""""""""""""
     C                   IF        TVFGKD <> *BLANKS                            1<-B
     C                   EVAL      ADS = '++++'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EVAL      ADS = TVFGKD
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      * Slutt segment
     C                   EVAL      ADS = WAPSTR
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END                                                    1<-E
      *
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Pakkning                                           PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR
     C     KEYE          SETLL     TRUVMN
     C                   MOVE      *ZEROS        XANTMN            3 0
     C                   MOVE      TVMN          XTVMN            17
     C                   MOVE      TVMNSK        XTVMNSK           2
     C     KEYE          READE     TRUVMN                                 34
     C     *IN34         DOWEQ     *OFF
     C                   ADD       1             XANTMN
     C     KEYE          READE     TRUVMN                                 34
     C  N34              ENDDO
     C                   MOVE      XTVMN         TVMN
     C                   MOVE      XTVMNSK       TVMNSK
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+6+++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Pakktype
      *""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEH          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C     TVEH          IFNE      'VQ'
     C     TVEH          ANDNE     'VG'
     C     TVEH          ANDNE     'VL'
     C     TVEH          ANDNE     'VY'
     C     TVEH          ANDNE     'VR'
     C     TVEH          ANDNE     'VO'
N02  C     TVEH          ANDNE     'VS'
     C     TVEH          ANDNE     'NE'
N03  C     TVEH          ANDNE     'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        XANTMN = 0
     C                   Z-ADD     TVNT          ØN163
     C                   ELSE
     C                   Z-ADD     1             ØN163
     C                   SUB       1             TVNT
     C                   END
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     TVEH          IFEQ      'NE'
N13  C     TVEH          OREQ      'NF'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':::'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVNTEH        ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      PCI32
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakningsidentifikasjon                          PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
      *
     C     KEYE          SETLL     TRUVMN
     C     TVMN          CABNE     *BLANKS       PCI32A
     C     TVEH          CABEQ     'NE'          PCI32A
N13  C     TVEH          CABEQ     'NF'          PCI32A
     C     TVEH          IFNE      'VQ'
     C     TVEH          ANDNE     'VG'
     C     TVEH          ANDNE     'VL'
     C     TVEH          ANDNE     'VY'
     C     TVEH          ANDNE     'VR'
     C     TVEH          ANDNE     'VO'
N02  C     TVEH          ANDNE     'VS'
     C                   GOTO      PCI32A
     C                   END
     C                   GOTO      PCI32C
     C     PCI32A        TAG
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI+28+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMN          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      *
     C     TVMNSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMNSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     PCI32B        TAG
     C     KEYE          READE     TRUVMN                                 34
     C  N34TVMN          IFEQ      *BLANKS
     C                   GOTO      PCI32B
     C                   ELSE
     C                   IF        XANTMN > 0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+6+++'    ADS
     C                   CAT       TVEH:0        ADS
     C                   CAT       ':':0         ADS
     C                   IF        XANTMN = 1
     C                   Z-ADD     TVNT          ØN163
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         ADS
     C                   ELSE
     C                   CAT       '1':0         ADS
     C                   SUB       1             TVNT
     C                   END
     C                   SUB       1             XANTMN
     C                   CAT       WAPSTR:0      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   GOTO      PCI32A
     C                   END
     C                   END
      *
     C     PCI32C        ENDSR
      *////////////////////////////////////////////////////////////
      *  Referanser                                         RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *
     C     TVCNR         IFNE      *BLANKS
      *____________
      * Containernr
      *""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+AAQ:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVCNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYE          SETLL     TRUVCN
     C     KEYE          READE     TRUVCN                                 34
     C     *IN34         DOWEQ     '0'
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+AAQ:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVCNR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     19            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYE          READE     TRUVCN                                 34
     C  N34              END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dokumenter                                         DOC37 /
      *////////////////////////////////////////////////////////////
     C     DOC37         BEGSR
      *
     C     KEYE          SETLL     TRUVTD
     C     TVDK          IFGE      'T2   '
     C     TVDK          ANDLE     'T2999'
     C                   GOTO      DOC37A
     C                   END
     C     TVDK          IFEQ      *BLANKS
     C     THDK          ANDGE     'T2   '
     C     THDK          ANDLE     'T2999'
     C                   GOTO      DOC37A
     C                   END
     C                   GOTO      DOC37C
     C     DOC37A        TAG
      *_______________________
      * Tidligere dokumenttype
      *"""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DOC+190:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDR         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVTDO         IFNE      *BLANKS
     C     TVTDOS        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDOS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVTDO         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDO         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C     TVTDSK        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTDSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     DOC37B        TAG
     C     KEYE          READE     TRUVTD                                 34
     C  N34TVTDT         IFEQ      *BLANKS
     C     TVTDR         ANDEQ     *BLANKS
     C                   GOTO      DOC37B
     C                   ELSE
     C                   GOTO      DOC37A
     C                   END
      *
     C     DOC37C        TAG
      *___________________
      * Dokument referanse
      *"""""""""""""""""""
     C     TVDTY         IFNE      *BLANKS
     C     KEYE          SETLL     TRUVDK
      * Segmentnavn
     C     DOC37D        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DOC+916:'    ADS
     C                   MOVEA     '::'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDTY         ADS
     C                   Z-ADD     1             AXV
S01  C*                  Z-ADD     3             AXH
N01  C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDREF        IFNE      *BLANKS
     C     TVDO          OREQ      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDREF        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     20            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDO          IFNE      *BLANKS
     C     TVDOSK        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDOSK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDO          IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVDO          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     TVDREF        IFNE      *BLANKS
     C     TVDO          OREQ      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C     TVDSK         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     TVDSK         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     DOC37E        TAG
     C     KEYE          READE     TRUVDK                                 34
     C  N34TVDTY         IFEQ      *BLANKS
     C                   GOTO      DOC37E
     C                   ELSE
     C                   GOTO      DOC37D
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Spesielle merknader                                TOD38 /
      *////////////////////////////////////////////////////////////
     C     TOD38         BEGSR
      *
     C                   IF        ((XVN = 1) AND (THDK <> 'SS'))
N06  C                             AND THDK <> 'ENTRY' AND THDK <> 'EXIT'
     C     KEYD          SETLL     TRUHGN
     C     STTOD38       TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOD+2'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX38GAR
      *
     C     KEYD          READE     TRUHGN                                 34
     C                   IF        *IN34 = '0'
     C                   MOVE      TGGFT1        THGFT1
     C                   MOVE      TGGADK        THGADK
     C                   MOVE      TGGBGI        THGBGI
     C                   MOVE      TGGBGU        THGBGU
     C                   MOVE      TGGBL         THGBL
     C                   MOVE      TGGVK         THGVK
     C                   GOTO      STTOD38
     C                   END
      *
     C                   END
      *
     C     TVTLO         IFEQ      'DG0'
     C     TVTLO         OREQ      'DG1'
      * Segmentnavn
     C     KEYE          SETLL     TRUVDK
     C     TOD38A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOD+2++'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Eksport fra EU
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEXKD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Leveringsbetingelser
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVEXLK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   EXSR      FTX38
      *
     C     TOD38B        TAG
     C     KEYE          READE     TRUVCN                                 34
     C  N34TVTLO         IFEQ      'DG0'
     C     TVTLO         OREQ      'DG1'
     C                   GOTO      TOD38A
     C                   ELSE
     C                   GOTO      TOD38B
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tilleggsopplysninger                               FTX38 /
      *////////////////////////////////////////////////////////////
     C     FTX38         BEGSR
      *
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ACB+'    ADS
     C                   MOVEL     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVTLO         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMTXT        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     48            AXH
     C                   EXSR      SRÅ
      *
     C     TVMSK         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVMSK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Garanti                                         FTX38GAR /
      *////////////////////////////////////////////////////////////
     C     FTX38GAR      BEGSR
      *
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   EVAL      ADS = 'FTX+ACB++CAL+'
     C                   Z-ADD     1             AXV
     C                   Z-ADD     13            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     THGBL         ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   CAT       THGVK:0       ADS
     C                   CAT       THGFT1:0      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     38            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Følsomme varer                                     GIR44 /
      *////////////////////////////////////////////////////////////
     C     GIR44         BEGSR
      *
     C     TVFVNT        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     KEYE          SETLL     TRUVFS
     C     GIR44A        TAG
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIR+3+'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     TVFVNT        ØN163
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':AP'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   IF        TVFV <> *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TVFV          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':AP'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     GIR44B        TAG
     C     KEYE          READE     TRUVFS                                 34
     C  N34TVFVNT        IFGT      0
     C                   GOTO      GIR44A
     C                   ELSE
     C                   GOTO      GIR44B
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                     UNS00B /
      *////////////////////////////////////////////////////////////
     C     UNS00B        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+S'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontrolltotaler                                    CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      *_____________
      * Antall kolli
      *"""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+11:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNTK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________________
      * Antall lastelister
      *"""""""""""""""""""
     C     THLSTL        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+13:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THLSTL        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________________
      * Antall forsegling
      *""""""""""""""""""
     C     THDANT        IFGT      0
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+16:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THDANT        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
      *__________________
      * Antall varelinjer
      *""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+5:'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLSTL        IFEQ      0
     C                   MOVEL     XVN           ADS
     C                   ELSE
     C                   MOVEL     THVPOS        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0036
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNT+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall segmenter i meldingen (inkludert UNH og UNT)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     W0074         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0062         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     14            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Sendningsslutt                                     UNZ00 /
      *////////////////////////////////////////////////////////////
     C     UNZ00         BEGSR
      * Start segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNZ+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     W0036         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0020         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Legg in 3 blanke i slutten for IBM IN
     C     WNETW         IFEQ      '2'
     C     1             DO        3
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ' '           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDDO
     C                   ENDIF
      *
     C     BX            IFGT      1
     C                   WRITE     EDISER
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                  BGM00X /
      *////////////////////////////////////////////////////////////
     C     BGM00X        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      * Status
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTRNR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     18            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                  BGM00G /
      *////////////////////////////////////////////////////////////
     C     BGM00G        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM++6'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                    LOC00X /
      *////////////////////////////////////////////////////////////
     C     LOC00X        BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+118+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THCATS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                    LOC00G /
      *////////////////////////////////////////////////////////////
     C     LOC00G        BEGSR
      *________________
      * Avgangstollsted
      *""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+119+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TGTSD         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dato                                              DTM00X /
      *////////////////////////////////////////////////////////////
     C     DTM00X        BEGSR
      *__________________
      * Kanselleringsdato
      *""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+318:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WDT           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster                                        FTX00X /
      *////////////////////////////////////////////////////////////
     C     FTX00X        BEGSR
      *__________________________
      * Grunnlag for kansellering
      *""""""""""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'FTX+ACD+'    ADS
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     FT(1)         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
      *
     C     2             DO        5             XN                3 0
     C     FT(XN)        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     FT(XN)        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     70            AXH
     C                   EXSR      SRÅ
     C                   END
     C                   END
      *
     C     TKSK          IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TKSK          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                  NAD06X /
      *////////////////////////////////////////////////////////////
     C     NAD06X        BEGSR
      *_______________
      * Hovedansvarlig
      *"""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AF+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THTINA        IFNE      *BLANKS                                      1<-B
     C     THDKR         ORNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THTINA        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
     C                   ELSE                                                   1
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THNAA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   IF        THADA1 = *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     THADA1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPSA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     THSKA         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THSKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     THPNA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C     THLKA         IFEQ      *BLANKS
     C                   MOVEL     'NO'          ADS
     C                   ELSE
     C                   MOVEL     THLKA         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   END                                                    1<-E
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_______________
      * Find positions
      *""""""""""""""""
      * Find first non-0 position
     C     WDIR          IFEQ      'L'                                          <-------------I
     C     AXV           DO        AXH           AXV                             <-----------II
     C     A(AXV)        COMP      '0'                                  8383                 II
     C   83              END                                                     <-----------II
      * Find last non-blank position                                     I
     C                   ELSE                                                   <-------------I
      *                                                                  I
     C     SRÅ01         TAG                                                                  I
      *                                                                  I
     C     AXH           IFGT      AXV                                           <-----------II
     C     A(AXH)        IFEQ      *BLANKS                                        <---------III
     C                   SUB       1             AXH                                        III
     C                   GOTO      SRÅ01                                                    III
     C                   END                                                      <---------III
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C                   MOVE      'R'           WDIR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          IFEQ      'R'                                            <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   END                                                      <---------III
     C                   END                                                     <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I
      * If arrayindex for output array is over 80 Then add a record      I
     C     BX            IFGT      80                                            <-----------II
     C                   WRITE     EDISER                                                    II
     C                   Z-ADD     1             BX                                          II
     C                   MOVE      *BLANKS       SDATA                                       II
     C                   END                                                     <-----------II
      *                                                                  I
     C                   END                                                    <-------------I
      *
     C                   MOVE      'Y'           WCHART
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C     BX            IFGT      80                                           <-------------I
     C                   WRITE     EDISER                                                     I
     C                   Z-ADD     1             BX                                           I
     C                   MOVE      *BLANKS       SDATA                                        I
     C                   END                                                    <-------------I
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 13-felt
     C                   MOVE      *ZEROS        ØA13
     C     ØA163D        IFEQ      '000'                                        <-------------I
     C                   MOVE      ØA163H        ØA13                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA163X        ØA13                                         I
     C                   MOVE      '.   '        ØA13                                         I
     C                   MOVE      ØA163D        ØA13                                         I
     C     Ø13(13)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(13)
     C     Ø13(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(12)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        12            ØX                             <-------------I
     C     Ø13(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
N05  C                   IF        Ø13(ØX) = '.'
N05  C                   EVAL      ØX = ØX - 1
N05  C                   END
     C                   MOVEA     Ø13(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TEST OM VARELINJER HAR FORSKJELLIGE AVSENDER/MOTTAKER    /
      *////////////////////////////////////////////////////////////
     C     TSTAM         BEGSR
     C                   MOVE      'N'           XULIK             1
     C                   MOVE      'N'           XULIKM            1
     C                   MOVE      'N'           XULIKS            1
     C                   MOVE      'N'           XULIKMS           1
     C                   MOVE      'N'           XULIKTKBM         1
     C                   MOVE      'N'           XULIKKREF         1
     C     THVPOS        IFGT      1
     C                   MOVE      'J'           X1VP              1
     C     TRVK          SETLL     TRUV
     C     TRVK          READE(N)  TRUV                                   33
     C     *IN33         DOWEQ     '0'
      *
     C     KEYE          CHAIN     TRUVAM                             34
     C     *IN34         IFEQ      '0'
     C     TVNAS         IFEQ      *BLANKS
     C                   MOVEL     THNAS         XNAA
     C                   MOVEL     THADS1        XADA1
     C                   ELSE
     C                   MOVEL     TVNAS         XNAA
     C                   MOVEL     TVADS1        XADA1
     C                   END
     C     TVNAK         IFEQ      *BLANKS
     C                   MOVEL     THNAK         XNAM
     C                   MOVEL     THADK1        XADM1
     C                   ELSE
     C                   MOVEL     TVNAK         XNAM
     C                   MOVEL     TVADK1        XADM1
     C                   END
     C                   ELSE
     C     TVAVD2        IFEQ      0
     C                   MOVEL     THNAS         XNAA             30
     C                   MOVEL     THADS1        XADA1            30
     C                   MOVEL     THNAK         XNAM             30
     C                   MOVEL     THADK1        XADM1            30
     C                   ELSE
     C     HEADFK        CHAIN     HEADF                              34
     C                   MOVE      HENAS         XNAA
     C                   MOVE      HEADS1        XADA1
     C                   MOVE      HENAK         XNAM
     C                   MOVE      HEADK1        XADM1
     C                   END
     C                   END
      *
     C                   IF        XFORHV = 'J'
     C     KEYE          CHAIN     TRUVFV                             34
     C     *IN34         IFEQ      '0'
     C     TVNASS        IFEQ      *BLANKS
     C                   MOVEL     THNASS        XNAAS
     C                   MOVEL     THADSS1       XADAS1
     C                   ELSE
     C                   MOVEL     TVNASS        XNAAS
     C                   MOVEL     TVADSS1       XADAS1
     C                   END
     C     TVNAKS        IFEQ      *BLANKS
     C                   MOVEL     THNAKS        XNAMS
     C                   MOVEL     THADKS1       XADMS1
     C                   ELSE
     C                   MOVEL     TVNAKS        XNAMS
     C                   MOVEL     TVADKS1       XADMS1
     C                   END
     C                   ELSE
     C                   MOVEL     THNASS        XNAAS            30
     C                   MOVEL     THADSS1       XADAS1           30
     C                   MOVEL     THNAKS        XNAMS            30
     C                   MOVEL     THADKS1       XADMS1           30
     C                   END
     C     TVTKBM        IFEQ      *BLANKS
     C                   MOVE      THTKBM        XTKBM             1
     C                   ELSE
     C                   MOVE      TVTKBM        XTKBM             1
     C                   END
     C     TVKREF        IFEQ      *BLANKS
     C                   MOVE      THKREF        XKREF            70
     C                   ELSE
     C                   MOVE      TVKREF        XKREF            70
     C                   END
     C                   END
      *
     C     X1VP          IFEQ      'J'
     C                   MOVE      XNAA          X2NAA            30
     C                   MOVE      XADA1         X2ADA1           30
     C                   MOVE      XNAM          X2NAM            30
     C                   MOVE      XADM1         X2ADM1           30
     C                   IF        XFORHV = 'J'
     C                   MOVE      XNAAS         X2NAAS           30
     C                   MOVE      XADAS1        X2ADAS1          30
     C                   MOVE      XNAMS         X2NAMS           30
     C                   MOVE      XADMS1        X2ADMS1          30
     C                   MOVE      XTKBM         X2TKBM            1
     C                   MOVE      XKREF         X2KREF           70
     C                   END
     C                   MOVE      'N'           X1VP
     C                   END
      *
     C     XNAA          IFNE      X2NAA
     C     XADA1         ORNE      X2ADA1
     C                   MOVE      'J'           XULIK
     C                   END
     C     XNAM          IFNE      X2NAM
     C     XADM1         ORNE      X2ADM1
     C                   MOVE      'J'           XULIKM
     C                   END
      *
     C                   IF        XFORHV = 'J'
     C     XNAAS         IFNE      X2NAAS
     C     XADAS1        ORNE      X2ADAS1
     C                   MOVE      'J'           XULIKS
     C                   END
     C     XNAMS         IFNE      X2NAMS
     C     XADMS1        ORNE      X2ADMS1
     C                   MOVE      'J'           XULIKMS
     C                   END
     C     XTKBM         IFNE      X2TKBM
     C                   MOVE      'J'           XULIKTKBM
     C                   END
     C     XKREF         IFNE      X2KREF
     C                   MOVE      'J'           XULIKKREF
     C                   END
     C                   END
      *
     C     TRVK          READE(N)  TRUV                                   33
     C  N33              ENDDO
     C                   END
      *
     C                   ENDSR
