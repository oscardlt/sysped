********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 SVENSK GODSJOURNAL
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL HENTE PRINTERSTYRING LAGER-LISTE          ***
      **************************************************************
      *
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FLL025BD   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSLF1                  1      5
     D  WSLF2                  6     25
     D  WSLAGF                 1     25
     D                 DS
     D  WSLT1                  1      5
     D  WSLT2                  6     25
     D  WSLAGT                 1     25
     D                 DS
     D  WSDTC                  1      2  0
     D  WSDTÅ                  3      4  0
     D  WSDTM                  5      6  0
     D  WSDTD                  7      8  0
     D  WSDT                   3      8  0
     D  WSDT8                  1      8  0
     D                 DS
     D  XTID                   1      6  0
     D  XDTD                   7      8  0
     D  XDTM                   9     10  0
     D  XDTÅ                  11     14  0
     D  XTIME                  1     14  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  WSAG                   1     25
     D  WSAG01                 1      5
     D  WSAG02                 6     10
     D  WSAG03                11     15
     D  WSAG04                16     20
     D  WSAG05                21     25
      *
     C     *ENTRY        PLIST
     C                   PARM                    WSGRUA
     C                   PARM                    WSKJEA
     C                   PARM                    UDT
     C                   PARM                    WSARTF
     C                   PARM                    WSARTT
     C                   PARM      WSLAGF        ULAGF            25
     C                   PARM      WSLAGT        ULAGT            25
     C                   PARM                    FRADAA
     C                   PARM                    TILDAA
     C                   PARM                    WSFORP
     C                   PARM                    WSDET
     C                   PARM                    WSSALD
     C                   PARM                    WSTYPE
     C                   PARM                    WSBRUD
     C                   PARM                    WSSORT
     C                   PARM                    WSBATC
     C                   PARM      WSAG          UAG              25
     C                   PARM                    WSEIER
N01  C                   PARM                    WSSVGS
     C                   PARM                    UIN01             1
      *
     C                   TIME                    XTIME
     C                   MOVE      XDTD          XIDAGD
     C                   MOVE      XDTM          XIDAGM
     C                   MOVE      XDTÅ          XIDAGÅ
     C                   MOVE      99999999      WSDT8
      *
     C                   MOVE      *ZEROS        WSGRUP
     C                   MOVE      *ZEROS        WSKJED
     C                   MOVE      'N'           WSBATC
     C                   MOVE      *ZEROS        FRADAT
     C                   MOVE      *ZEROS        TILDAT
     C                   MOVE      '0'           UIN01
     C                   MOVE      *BLANKS       WSAG
      *
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YYKNR             8 0
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   30
      *
N01  C                   IF        FILAND = 'NO'
N01  C                   EVAL      *IN27 = *ON
N01  C                   EVAL      WSSVGS = 'J'
N01  C                   END
     C                   MOVE      *BLANKS       NVNGRU
     C                   MOVE      *BLANKS       WSLAGF
     C                   MOVE      *BLANKS       WSLAGT
     C                   MOVE      *BLANKS       NVNKJE
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     20            POSNBR
      *
     C     START         TAG
     C     WSGRUP        COMP      0                                      49
     C                   EXFMT     BILDE1
      **  AVSLUTT
     C     *IN03         IFEQ      *ON
     C                   MOVE      '1'           UIN01
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN03
      **
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     LINNBR        IFEQ      3
     C     LINNBR        OREQ      4
     C     LINNBR        IFEQ      3
     C                   MOVE      'SØKGRP  '    UTYPE             8
     C                   ELSE
     C                   MOVE      WSGRUP        UTYPE
     C                   END
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRUP
     C                   PARM                    WSKJED
     C     WSGRUP        IFNE      0
     C                   MOVE      WSGRUP        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNGRU
     C                   END
     C                   MOVE      WSKJED        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C  N30              MOVEL     KNAVN         NVNKJE
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   END
     C                   END
     C                   GOTO      START
     C                   END
     C*
     C*
     C                   MOVE      '0'           *IN30
      *
     C*
      * GYLDIG KUNDENR...
     C     WSGRUP        IFNE      *ZEROS
     C                   MOVE      WSGRUP        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C     *IN30         IFEQ      '1'
     C                   MOVE      *BLANKS       NVNGRU
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0824'     MSGNR
     C                   GOTO      START
     C                   ELSE
     C                   MOVEL     KNAVN         NVNGRU
     C                   END
     C                   END
      *
     C                   MOVE      WSKJED        YYKNR
     C     KUNKEY        CHAIN     CUNDL01                            30
     C     *IN30         IFEQ      '1'
     C                   MOVE      *BLANKS       NVNKJE
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'JOV0825'     MSGNR
     C                   GOTO      START
     C                   ELSE
     C                   MOVEL     KNAVN         NVNKJE
     C                   END
     C* TELLINGSDATO
     C                   SELECT
     C     WSDT          WHENEQ    0
     C     WSDT          oreq      999999
     C                   MOVE      99999999      WSDT8
     C     WSDT          WHENGT    900101
     C                   MOVEL     19            WSDTC
     C                   OTHER
     C                   MOVEL     20            WSDTC
     C                   ENDSL
     C* ER DATO OPPGITT ..
     C     WSDATF        IFNE      *ZEROS
     C     WSSORT        OREQ      '3'
     C     WSDATT        IFEQ      *ZEROS
     C                   MOVE      WSDATF        WSDATT
     C                   END
     C                   IF        ((WSSORT = '3') AND (WSDATT = 0))
     C                   MOVE      891231        WSDATT
     C                   END
     C                   MOVE      WSDATF        FRADAT            8 0
     C     WSDATF        IFGT      900101
     C                   MOVEL     19            FRADAT
     C                   ELSE
     C                   MOVEL     20            FRADAT
     C                   END
     C                   MOVE      WSDATT        TILDAT            8 0
     C     WSDATT        IFGT      900101
     C                   MOVEL     19            TILDAT
     C                   ELSE
     C                   MOVEL     20            TILDAT
     C                   END
     C                   END
      *
     C*
     C* TESTER
     C* ETT AV BEGREPENE MÅ VÆRE UTFYLT
     C     WSARTF        IFEQ      *BLANKS
     C     WSLAGF        ANDEQ     *BLANKS
     C     WSDATF        ANDEQ     *ZEROS
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   MOVE      'JOV0827'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      START
     C                   END
      *
      **  BLANK I ART.NR.  TIL -> SAMME SOM FRA
     C     WSARTT        IFEQ      *BLANKS
     C                   MOVE      WSARTF        WSARTT
     C                   ENDIF
     C*
      **  BLANK I LAGERLOK TIL -> SAMME SOM FRA
     C     WSLAGT        IFEQ      *BLANKS
     C                   MOVE      WSLAGF        WSLAGT
     C                   ENDIF
      * OVER I ALFA-PARAM..
     C                   MOVE      FRADAT        FRADAA            8
     C                   MOVE      TILDAT        TILDAA            8
     C                   MOVE      WSDT8         UDT               8
     C                   MOVE      WSGRUP        WSGRUA            8
     C                   MOVE      WSKJED        WSKJEA            8
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
