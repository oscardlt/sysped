      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE MERKELAPP FOR BOX               ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-98                ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P8XXX * 01 JOV PTF8 kan velge size ledetekst
P9XXX * 02 YBC PTF8 FLYTT TEKSTEN LITT OPP
P9XXX * 03 SH  PTF8 alpha lokasjoner mulig
********************************************************************
     FGSSBIF    IF   E           K DISK
     FGSS072D   CF   E             WORKSTN
     FLISTE     O    F   36        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D A6              S              1    DIM(6)                               INPUT STRING
     D B6              S              1    DIM(6)                               OUTPUT STRING
     D                 DS
     D  DATA                   1     36
     D  DATA1                  4     36
     D  DATA3                  1      3
     D UCMD            DS          1024
     D                 DS
     D XCMD01          C                   CONST('OVRPRTF -
     D                                     FILE(LISTE) -
     D                                     OUTQ(')
     D XCMD02          C                   CONST('PAGESIZE(73 132) -
     D                                     CPI(10) -
     D                                     OVRFLW(73)')
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH00,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS             7
     D XBOX            C                   CONST('BOX-ID:')
     D                 DS             5
     D XLOK            C                   CONST('LOK-ID:')
     D                 DS
     D  XPRE                   1      3
S03  D* WSBOX                  4      9  0
S03  D  WSBOXDS                4      9
     D  WSBOXA                 4      5
     D  WSBOXB                 6      7
     D  WSBOXC                 8      9
     D  XBOXID                 1      9
     D                 DS
     D  LANUMA                 1      6  0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     GSS072DA
     C                   MOVE      '0'           *IN99
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN99
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1811'     MSGNR
     C                   GOTO      START
     C                   END
      *
      * OK- 51 ON = BOKSLAPP, 51 OFF = LOKASJONSLAPP
     C     WSTYPE        IFEQ      'B'
     C                   MOVE      *ON           *IN51
     C                   MOVE      '998'         XPRE
     C                   ELSE
     C                   MOVE      *OFF          *IN51
     C                   MOVE      '999'         XPRE
     C                   END
      *
      * OVERSTYRE PRINTERFIL
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD01        CAT       WSPRT:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD02:1      UCMD
     C                   CALL      'QCMDEXC'                            55
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   MOVE      *ZEROS        WSBOX
      *
     C     START2        TAG
     C                   EXFMT     GSS072DB
     C                   MOVEA     '00000'       *IN(95)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
N03  C     WSBOXAL       ifne      *blanks
N03  C                   move      wsboxal       wsboxds
N03  C                   else
N03  C                   move      wsbox         wsboxds
N03  C                   end
     C     WSBOX         IFEQ      0
N03  C     WSBOXAL       ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN99
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1815'     MSGNR
     C                   GOTO      START2
     C                   END
N03  C     WSBOX         IFNE      0
N03  C     WSBOXAL       ANDNE     *BLANKS
N03  C                   MOVE      '1'           *IN99
N03  C                   MOVE      '1'           *IN30
N03  C                   MOVE      'SHU1384'     MSGNR
N03  C                   GOTO      START2
N03  C                   END
     C     WSTYPE        IFEQ      'B'
     C     WSBOX         ANDGT     999
     C                   MOVE      '1'           *IN99
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1821'     MSGNR
     C                   GOTO      START2
     C                   END
      *
     C     WSTYPE        IFEQ      'B'
     C                   EXSR      PRTBOX
     C                   ELSE
     C                   EXSR      PRTLOK
     C                   END
     C                   MOVE      WSBOX         WSBOXS
N03  C                   MOVE      WSBOXAL       WSBOXSA
N03  C                   MOVE      *zeros        WSBOX
N03  C                   MOVE      *blanks       WSBOXAL
     C                   GOTO      START2
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     PRTBOX        BEGSR
     C***********************************************
      * OPEN PRINTERFILE
     C                   OPEN      LISTE                                55
      * EXECUTE INIT ROUTINE ONLY ONCE
     C                   EXSR      SRINIT
      *
      * EXECUTE LABEL INIT
     C                   EXSR      SR0001
      * EXECUTE BOX-ID
     C                   EXSR      SR0010
      * EXECUTE BOX-ID AS BAR CODES
     C                   EXSR      SR0060
      * EXECUTE END LABEL FORMAT
     C                   EXSR      SREND
      *
      * CLOSE PRINERFILE
     C                   CLOSE     LISTE                                55
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTLOK        BEGSR
     C***********************************************
      * OPEN PRINTERFILE
     C                   OPEN      LISTE                                55
      * EXECUTE INIT ROUTINE ONLY ONCE
     C                   EXSR      SRINIT
      *
      * EXECUTE LABEL INIT
     C                   EXSR      SR0001
      * EXECUTE BOX-ID
     C                   EXSR      SR0110
      * EXECUTE BOX-ID AS BAR CODES
     C                   EXSR      SR0160
      * EXECUTE END LABEL FORMAT
     C                   EXSR      SREND
      *
      * CLOSE PRINERFILE
     C                   CLOSE     LISTE                                55
      *
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UUSR             10
      *
     C     UUSR          CHAIN     GSSBIF                             33
     C                   MOVE      BIPRTM        WSPRT
     C                   MOVE      'B'           WSTYPE
N01  C                   MOVE      '1'           WSSIZE
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * INITIALISE SUBROUTINE, SET CHARACTER SET
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
     C                   MOVE      *ON           *IN50
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVE      *BLANKS       MSGVAR            7            MESSAGE VARIABEL
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LABEL INIT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * SEND DEFAULT INSTRUCTIONS
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE BOX-ID
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * START OF TEXT BIT (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
S02  C*                  MOVEL     '540,300'     DATA1
N02  C                   MOVEL     '560,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XBOX          DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * START OF TEXT BIT (^XA)
      *                    MOVE *BLANKS   DATA
      *                    MOVELWXA       DATA
      *                    EXCPTLISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
S01  C*                  MOVEL     '540,720'     DATA1
N01  C                   select
N01  C     WSSIZE        Wheneq    '2'
S02  C*                  MOVEL     '530,600'     DATA1
N02  C                   MOVEL     '550,600'     DATA1
N01  C     WSSIZE        Wheneq    '3'
S02  C*                  MOVEL     '520,600'     DATA1
N02  C                   MOVEL     '540,600'     DATA1
N01  C     WSSIZE        Wheneq    '4'
S02  C*                  MOVEL     '500,600'     DATA1
N02  C                   MOVEL     '520,600'     DATA1
N01  C     WSSIZE        Wheneq    '5'
S02  C*                  MOVEL     '400,600'     DATA1
N02  C                   MOVEL     '420,600'     DATA1
N01  C                   other
S02  C*                  MOVEL     '540,600'     DATA1
N02  C                   MOVEL     '560,600'     DATA1
N01  C                   endsl
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
N01  C                   select
N01  C     WSSIZE        Wheneq    '2'
N01  C                   MOVEL     'R,100,90'    DATA1
N01  C     WSSIZE        Wheneq    '3'
N01  C                   MOVEL     'R,130,100'   DATA1
N01  C     WSSIZE        Wheneq    '4'
N01  C                   MOVEL     'R,200,120'   DATA1
N01  C     WSSIZE        Wheneq    '5'
N01  C                   MOVEL     'R,400,250'   DATA1
N01  C                   other
     C                   MOVEL     'R,70,50'     DATA1
N01  C                   endsl
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     WSBOX         LANUMA
     C                   MOVE      LANUMA        CHAR6             6
     C                   MOVEA     CHAR6         A6
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B6
     C     A6(X)         DOWEQ     '0'
     C     X             ANDLT     6
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     6
     C                   MOVEA     A6(X)         B6(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C                   MOVEA     B6            DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LOCATION-ID AS BARCODE
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0060        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
S02  C*                  MOVEL     '300,300'     DATA1
N02  C                   MOVEL     '320,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE FIELD DEFAULT)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^BY'         DATA
     C*                    MOVEL'3,3:1,15'DATA1
     C                   MOVEL     '4,4:1,15'    DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE INTERLEAVED 2 OF 5)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^B3'         DATA
     C*                    MOVEL'R,N,90,Y'DATA1
     C                   MOVEL     'R,N,120,'    DATA1
     C                   CAT       'Y':0         DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED AS BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XBOXID        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LOC-ID - TEXT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0110        BEGSR
      * START OF TEXT BIT (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
S02  C*                  MOVEL     '160,100'     DATA1
N02  C                   MOVEL     '180,100'     DATA1
N01  C     WSSIZE        Ifeq      '5'
S02  C*                  MOVEL     '700,100'     DATA1
N02  C                   MOVEL     '720,100'     DATA1
N01  C                   end
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XLOK          DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
s01  C*                  MOVEL     '160,350'     DATA1
S02  C*                  MOVEL     '150,350'     DATA1
N02  C                   MOVEL     '170,350'     DATA1
N01  C     WSSIZE        Ifeq      '5'
S02  C*                  MOVEL     '160,100'     DATA1
N02  C                   MOVEL     '180,100'     DATA1
N01  C                   end
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
N01  C                   select
N01  C     WSSIZE        Wheneq    '2'
N01  C                   MOVEL     'R,100,90'    DATA1
N01  C     WSSIZE        Wheneq    '3'
N01  C                   MOVEL     'R,130,100'   DATA1
N01  C     WSSIZE        Wheneq    '4'
N01  C                   MOVEL     'R,200,120'   DATA1
N01  C     WSSIZE        Wheneq    '5'
N01  C                   MOVEL     'R,500,300'   DATA1
N01  C                   other
     C                   MOVEL     'R,70,50'     DATA1
N01  C                   endsl
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WSBOXA        DATA1
     C     DATA1         CAT       WSBOXB:1      DATA1
     C     DATA1         CAT       WSBOXC:1      DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LOCATION-ID AS BARCODE
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0160        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
S02  C*                  MOVEL     '050,100'     DATA1
N02  C                   MOVEL     '070,100'     DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE FIELD DEFAULT)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^BY'         DATA
     C*                    MOVEL'3,3:1,15'DATA1
     C                   MOVEL     '4,4:1,15'    DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE INTERLEAVED 2 OF 5)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^B3'         DATA
     C*                    MOVEL'R,N,90,Y'DATA1
     C                   MOVEL     'R,N,120,'    DATA1
     C                   CAT       'Y':0         DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED AS BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XBOXID        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * SUBROUTINE TO END LABEL FORMAT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    LISTEA
     C                   ENDSR
      *
     OLISTE     E            LISTEA
     O                       DATA
