********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11016 * 01 YBC PTF11 OMBEREGNING
12282 * 02 YBC PTF12 4 SIFFER PROSEDYRE OG 2 SIFFER TRANSAKSJONSTYPE
********************************************************************
     H DEBUG(*YES)
      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE PRINTERSTYRING SAD-EKSPORT ***
      ************************************************************
     Fsysthlp   IF   E             DISK
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTA     IF   E           K DISK
     FEDII      IF   E           K DISK
     FSTANDE    UF A E           K DISK
     FSYPTFF    IF   E           K DISK
     FSYFTAEFM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  SEDTÅ                  1      4  0
     D  SEDTM                  5      6  0
     D  SEDTD                  7      8  0
     D  SEDT                   1      8  0
     D                 DS
     D  SELV2                  1      3
     D  SEUATK                 1      1
     C*
     C                   EXSR      INIT
     c     mode          ifeq      'E'
     c                   move      uavd          wsaavd
     c                   goto      startb
     c                   end
      *
     C*
     C     START         TAG
     C                   EXFMT     BILDE01
     c   01              do
     c                   movel     'syftae'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START
     c                   end
     c     startb        tag
     C   03              GOTO      SLUTT
     C     KODTAK        CHAIN     KODTA                              99
     C   99              GOTO      START
     C                   EXSR      HENT
     C*
     C     START2        TAG
     C                   EXFMT     BILDE02
     C                   MOVEA     '0000000'     *IN(93)
     C                   SETOFF                                       30
     c   01              do
     c                   movel     'syftae'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START2
     c                   end
     C*
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C                   EXSR      TESTB2
     C   30              GOTO      START2
     C*
     C     WSTOLK        IFEQ      'J'
     C     CUNDKE        CHAIN     CUNDL01                            33
     C  N33              MOVEL     SYRG          WSFORE
     C     START3        TAG
     C                   EXFMT     BILDE03
     C                   MOVEA     '000000'      *IN(94)
     C                   SETOFF                                       30
     c   01              do
     c                   movel     'syftae'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START3
     c                   end
     C   03              GOTO      SLUTT
     C   12              GOTO      START2
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   END
     C*
     C     HELP1         TAG
     C                   EXFMT     BILDE04
     C   03              GOTO      SLUTT
     C   12              GOTO      START2
     c   01              do
     c                   movel     'syftae'      hlpna             8
     c                   exsr      helpsr
     C                   GOTO      HELP1
     c                   end
     C                   EXSR      OPDSTA
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     WSAAVD        CHAIN     STANDE                             60
     C   60              EXSR      MOVEB
     C  N60              EXSR      MOVEW
     C  N60              UPDATE    STANDER
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSDL          COMP      ' '                                    99
     C   99              MOVE      'SPD0004'     MSGNR
     C   99              SETON                                        30
     C*
     C     WSTDN         COMP      0                                    9494
     C   94
     CANN30              MOVE      'SPT0023'     MSGNR
     C   94              SETON                                        30
     C*
     C     WSTOLK        COMP      'N'                                9393
     C   93WSTOLK        COMP      'J'                                9393
     C   93
     CANN30              MOVE      'SPT0024'     MSGNR
     C   93              SETON                                        30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C     *IN45         IFEQ      '0'
     C     W3039D        COMP      0                                    9797
     C   97
     CANN30              MOVE      'SPD0005'     MSGNR
     C   97              SETON                                        30
     C                   ELSE
     C     WSFORE        COMP      *BLANKS                                97
     C  N97WSFORE        COMP      *ZEROS                                 97
     C   97
     CANN30              MOVE      'JOV1259'     MSGNR
     C   97              SETON                                        30
     C                   END
     C*
     C     W3039E        COMP      0                                    9696
     C   96
     CANN30              MOVE      'SPD0006'     MSGNR
     C   96              SETON                                        30
     C*
     C     W0004         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN95
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
     C*
     C     W0010         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN94
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   MOVE      SETDN         WSTDN
     C                   MOVE      SEDTY         WSDTY
     C                   MOVE      SEDP          WSDP
N02  C                   MOVE      SEDP2         WSDP2
     C                   MOVE      SEKNS         WSKNS
     C                   MOVE      SENAS         WSNAS
     C                   MOVE      SEADS1        WSADS1
     C                   MOVE      SEADS2        WSADS2
     C                   MOVE      SEADS3        WSADS3
     C                   MOVE      SENTK         WSNTK
     C                   MOVE      SEVKB         WSVKB
     C                   MOVE      SEKDC         WSKDC
     C                   MOVE      SEKNK         WSKNK
     C                   MOVE      SERG          WSRG
     C                   MOVE      SENAK         WSNAK
     C                   MOVE      SEADK1        WSADK1
     C                   MOVE      SEADK2        WSADK2
     C                   MOVE      SEADK3        WSADK3
     C                   MOVE      SELKA         WSLKA
     C                   MOVE      SETLF         WSTLF
     C                   MOVE      SENAD         WSNAD
     C                   MOVE      SELV          WSLV
     C                   MOVE      SELVT         WSLVT
     C                   MOVE      SETRID        WSTRID
     C                   MOVE      SELKT         WSLKT
     C                   MOVE      SEVAL1        WSVAL1
     C                   MOVE      SEBEL1        WSBEL1
     C                   MOVE      SEVKU         WSVKU
     C                   MOVE      SEKDH         WSKDH
     C                   MOVE      SETST         WSTST
     C                   MOVE      SEBEL2        WSBEL2
     C                   MOVE      SEFTG2        WSFTG2
     C                   MOVE      SETRM         WSTRM
     C                   MOVE      SEFIF         WSFIF
     C                   MOVE      SEKTA         WSKTA
     C                   MOVE      SEKTB         WSKTB
     C                   MOVE      SEKTC         WSKTC
     C                   MOVE      SEGN          WSGN
     C                   MOVE      SEFT1         WSFT1
     C                   MOVE      SEFT2         WSFT2
     C                   MOVE      SEFT3         WSFT3
     C                   MOVE      SEDST         WSDST
     C                   MOVE      SEDTG         WSDTG
     C                   MOVE      SETLL         WSTLL
     C                   MOVE      SETLE         WSTLE
     C                   MOVE      SELS          WSLS
     C                   MOVE      SEKDLS        WSKDLS
     C                   MOVE      SESKI         WSSKI
     C                   MOVE      SEDTD         WSDTD
     C                   MOVE      SEDTM         WSDTM
     C                   MOVE      SEDTÅ         WSDTÅ
     C     SEUATK        IFEQ      ' '
     C                   MOVE      'N'           WSUATK
     C                   ELSE
     C                   MOVE      SEUATK        WSUATK
     C                   END
     C                   MOVE      SEKDDK        WSKDDK
     C*                  MOVE      SEGKD         WSGKD
     C*                  MOVE      SEGFT1        WSGFT1
     C*                  MOVE      SEGFT2        WSGFT2
     C                   MOVE      SEPOS         WSPOS
     C                   MOVE      SEFTB         WSFTB
     C                   MOVE      SELKB         WSLKB
     C                   MOVE      SEKDFT        WSKDFT
     C                   MOVE      SELKAT        WSLKAT
     C                   MOVE      SEVAL2        WSVAL2
     C*
     C* PRINTERSTYRING
     C                   MOVE      SEDL          WSDL
     C                   MOVE      SETOLK        WSTOLK
     C                   MOVE      SEA4          WSA4
     C* TVINN - VARIABLER
     C                   MOVE      S3039D        W3039D
     C                   MOVE      S3039E        W3039E
N01  C                   MOVE      S3039EO1      W3039EO1
N01  C                   MOVE      S3039EO2      W3039EO2
     C                   MOVE      S0004         W0004
     C                   MOVE      S0010         W0010
     C                   MOVE      S0026         W0026
     C                   MOVE      S0035         W0035
     C                   MOVE      SEEKST        WSEKST
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEB         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *BLANKS       WSDTY
     C                   MOVE      *ZEROS        WSDP
N02  C                   MOVE      *ZEROS        WSDP2
     C                   MOVE      *ZEROS        WSKNS
     C                   MOVE      *BLANKS       WSNAS
     C                   MOVE      *BLANKS       WSADS1
     C                   MOVE      *BLANKS       WSADS2
     C                   MOVE      *BLANKS       WSADS3
     C                   MOVE      *BLANKS       WSNTK
     C                   MOVE      *BLANKS       WSVKB
     C                   MOVE      *BLANKS       WSKDC
     C                   MOVE      *ZEROS        WSKNK
     C                   MOVE      *BLANKS       WSRG
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      *BLANKS       WSADK1
     C                   MOVE      *BLANKS       WSADK2
     C                   MOVE      *BLANKS       WSADK3
     C                   MOVE      *BLANKS       WSLKA
     C                   MOVE      *BLANKS       WSTLF
     C                   MOVE      *BLANKS       WSNAD
     C                   MOVE      *BLANKS       WSLV
     C                   MOVE      *BLANKS       WSLVT
     C                   MOVE      *BLANKS       WSTRID
     C                   MOVE      *BLANKS       WSLKT
     C                   MOVE      *BLANKS       WSVAL1
     C                   MOVE      *ZEROS        WSBEL1
     C                   MOVE      *ZEROS        WSVKU
     C                   MOVE      *ZEROS        WSKDH
     C                   MOVE      *ZEROS        WSTST
     C                   MOVE      *ZEROS        WSBEL2
     C                   MOVE      *BLANKS       WSFTG2
     C                   MOVE      *ZEROS        WSTRM
     C                   MOVE      *BLANKS       WSFIF
     C                   MOVE      *ZEROS        WSFID
     C                   MOVE      *ZEROS        WSKTA
     C                   MOVE      *ZEROS        WSKTB
     C                   MOVE      *BLANKS       WSKTC
     C                   MOVE      *BLANKS       WSGN
     C                   MOVE      *BLANKS       WSFT1
     C                   MOVE      *BLANKS       WSFT2
     C                   MOVE      *BLANKS       WSFT3
     C                   MOVE      *BLANKS       WSDST
     C                   MOVE      *BLANKS       WSDTG
     C                   MOVE      *BLANKS       WSTLL
     C                   MOVE      *BLANKS       WSTLE
     C                   MOVE      *BLANKS       WSLS
     C                   MOVE      *BLANKS       WSKDLS
     C                   MOVE      *BLANKS       WSSKI
     C                   MOVE      'N'           WSUATK
     C                   MOVE      *BLANKS       WSKDDK
     C*                  MOVE      *ZEROS        WSGKD
     C*                  MOVE      *BLANKS       WSGFT1
     C*                  MOVE      *BLANKS       WSGFT2
     C                   MOVE      *BLANKS       WSPOS
     C                   MOVE      *BLANKS       WSFTB
     C                   MOVE      *BLANKS       WSLKB
     C                   MOVE      *BLANKS       WSKDFT
     C                   MOVE      *BLANKS       WSLKAT
     C                   MOVE      *BLANKS       WSVAL2
     C* PRINTERSTYRING
     C                   MOVE      *BLANKS       WSDL
     C                   MOVE      *BLANKS       WSTOLK
     C                   MOVE      *BLANKS       WSA4
     C* TVINN - VARIABLER
     C                   MOVE      *ZEROS        W3039D
     C                   MOVE      *ZEROS        W3039E
N01  C                   MOVE      *ZEROS        W3039EO1
N01  C                   MOVE      *ZEROS        W3039EO2
     C                   MOVE      *BLANKS       W0004
     C                   MOVE      *BLANKS       W0010
     C                   MOVE      *BLANKS       W0026
     C                   MOVE      *BLANKS       W0035
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDSTA        BEGSR
     C***********************************************
     C     STANEK        CHAIN     STANDE                             60
     C                   EXSR      MOVEST
     C   60              WRITE     STANDER
     C  N60              UPDATE    STANDER
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEST        BEGSR
     C***********************************************
     C*                    MOVE WSST      SEST
     C                   MOVE      WSAAVD        SEAVD
     C                   MOVE      WSTDN         SETDN
     C                   MOVE      WSDTY         SEDTY
     C                   MOVE      WSDP          SEDP
N02  C                   MOVE      WSDP2         SEDP2
     C                   MOVE      WSKNS         SEKNS
     C                   MOVE      WSNAS         SENAS
     C                   MOVE      WSADS1        SEADS1
     C                   MOVE      WSADS2        SEADS2
     C                   MOVE      WSADS3        SEADS3
     C                   MOVE      WSNTK         SENTK
     C                   MOVE      WSVKB         SEVKB
     C                   MOVE      WSKDC         SEKDC
     C                   MOVE      WSKNK         SEKNK
     C                   MOVE      WSRG          SERG
     C                   MOVE      WSNAK         SENAK
     C                   MOVE      WSADK1        SEADK1
     C                   MOVE      WSADK2        SEADK2
     C                   MOVE      WSADK3        SEADK3
     C                   MOVE      WSLKA         SELKA
     C                   MOVE      WSTLF         SETLF
     C                   MOVE      WSNAD         SENAD
     C                   MOVE      WSLV          SELV
     C                   MOVE      WSLVT         SELVT
     C                   MOVE      WSTRID        SETRID
     C                   MOVE      WSLKT         SELKT
     C                   MOVE      WSVAL1        SEVAL1
     C                   MOVE      WSBEL1        SEBEL1
     C                   MOVE      WSVKU         SEVKU
     C                   MOVE      WSKDH         SEKDH
     C                   MOVE      WSTST         SETST
     C                   MOVE      WSBEL2        SEBEL2
     C                   MOVE      WSFTG2        SEFTG2
     C                   MOVE      WSTRM         SETRM
     C                   MOVE      WSFIF         SEFIF
     C                   MOVE      WSKTA         SEKTA
     C                   MOVE      WSKTB         SEKTB
     C                   MOVE      WSKTC         SEKTC
     C                   MOVE      WSGN          SEGN
     C                   MOVE      WSFT1         SEFT1
     C                   MOVE      WSFT2         SEFT2
     C                   MOVE      WSFT3         SEFT3
     C                   MOVE      WSDST         SEDST
     C                   MOVE      WSDTG         SEDTG
     C                   MOVE      WSTLL         SETLL
     C                   MOVE      WSTLE         SETLE
     C                   MOVE      WSLS          SELS
     C                   MOVE      WSKDLS        SEKDLS
     C                   MOVE      WSSKI         SESKI
     C                   MOVE      UDAY          SEDTD
     C                   MOVE      UMONTH        SEDTM
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          SEDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          SEDTÅ
     C                   END
     C                   MOVE      WSUATK        SEUATK
     C                   MOVE      WSKDDK        SEKDDK
     C*                  MOVE      WSGKD         SEGKD
     C*                  MOVE      WSGFT1        SEGFT1
     C*                  MOVE      WSGFT2        SEGFT2
     C                   MOVE      WSPOS         SEPOS
     C                   MOVE      WSFTB         SEFTB
     C                   MOVE      WSLKB         SELKB
     C                   MOVE      WSKDFT        SEKDFT
     C                   MOVE      WSLKAT        SELKAT
     C                   MOVE      WSVAL2        SEVAL2
     C*
     C* PRINTERSTYRING OG TAD KOMMUNIKASJON
     C                   MOVE      WSDL          SEDL
     C                   MOVE      WSTOLK        SETOLK
     C                   MOVE      WSA4          SEA4
     C* TVINN - VARIABLER
     C                   MOVE      W3039D        S3039D
     C                   MOVE      W3039E        S3039E
N01  C                   MOVE      W3039EO1      S3039EO1
N01  C                   MOVE      W3039EO2      S3039EO2
     C                   MOVE      W0004         S0004
     C                   MOVE      W0010         S0010
     C                   MOVE      W0026         S0026
     C                   MOVE      W0035         S0035
     C                   MOVE      WSEKST        SEEKST
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     c     *entry        plist
     c                   parm                    uavd              4 0
     C                   parm                    mode              1
     C     CUNDKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     STANEK        KLIST
     C                   KFLD                    WSAAVD
     C*
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      *ZEROS        WSFID
     C                   MOVE      *ZEROS        SEFID
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        SEDT
     C     'TVI00004'    CHAIN     SYPTFF                             45
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C     PTFDT         COMP      WDT80                                4545
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   30
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HELPSR        BEGSR
     C***********************************************
     c
     c                   move      *blanks       pcocmd           70
     c     1             chain     systhlp                            33
     c     *in(33)       ifeq      '0'
      *
      * intern
     c                   movel     'http://'     pcocmd
     C     pcocmd        CAT       systip:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       systba:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       hlpna:0       pcocmd
     C     pcocmd        CAT       '.htm':0      pcocmd
      *
     c                   call      'SYGE34CL'
     c                   parm                    pcocmd
     c                   end
     C                   ENDSR
