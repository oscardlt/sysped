             PGM        PARM(&DOKNA &FAX &NAVN &PTIME &PDATE &STD +
                        &MAPPE &GEN &KNAVN &AVD &OPD &TUR &KODE +
                        &EPOST +
                        &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 &CVP6 +
                        &CVP7 &CVP8 +
                               &EPOSTJ)
             DCL        VAR(&BPARM) TYPE(*CHAR) LEN(260)
             DCL        VAR(&BPARME) TYPE(*CHAR) LEN(580)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DOKNA) TYPE(*CHAR) LEN(8)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(50)
             DCL        VAR(&KNAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&STD) TYPE(*CHAR) LEN(12)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&GEN) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&FIFIRM) TYPE(*CHAR) LEN(2)
             DCL        VAR(&FILIBF) TYPE(*CHAR) LEN(10)
    /* */
             DCLF       FILE(FAXSEN)

/* HENT FILBIBLIOTEKSNAVN */
             CALL       PGM(GETFIRMF2) PARM(&FIFIRM &FILIBF)
             RCVF       RCDFMT(*FILE)
             RTVJOBA    JOB(&QJOB)
             DLTF       FILE(&DOKNA)
             MONMSG     MSGID(CPF0000)
             CPYF       FROMFILE(FHEADF) TOFILE(&FILIBF/&DOKNA) +
                          FROMMBR(&QJOB) TOMBR(&DOKNA) +
                          MBROPT(*REPLACE) CRTFILE(*YES)
/*                         */
/*  EPOST SENDING          */
/*                         */
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&BPARME) VALUE(&DOKNA *CAT &FAX *CAT +
                          &NAVN *CAT &PTIME *CAT &PDATE *CAT &STD +
                          *CAT &MAPPE *CAT &GEN *CAT &QJOB *CAT +
                          &KNAVN *CAT &AVD *CAT &OPD *CAT &TUR *CAT +
                          &EPOST +
                          *CAT &CVP1 *CAT &CVP2 *CAT &CVP3 +
                          *CAT &CVP4 *CAT &CVP5 *CAT &CVP6 *CAT +
                          &CVP7 *CAT &CVP8 *CAT &KODE)
             SBMJOB     CMD(CALL PGM(FAX004CLE) PARM(&BPARME)) +
                          JOB(SNDFAXMAL) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             RETURN
             ENDDO
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*                         */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             CHGVAR     VAR(&BPARM) VALUE(&DOKNA *CAT &FAX *CAT +
                          &NAVN *CAT &PTIME *CAT &PDATE *CAT &STD +
                          *CAT &MAPPE *CAT &GEN *CAT &QJOB *CAT +
                          &KNAVN *CAT &AVD *CAT &OPD *CAT &TUR *CAT +
                          &EPOST *CAT &KODE)
             SBMJOB     CMD(CALL PGM(FAX004CLJ) PARM(&BPARM)) +
                          JOB(SNDFAXMAL) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(FAX004CL2) PARM(&DOKNA &FAX +
                          &NAVN &PTIME &PDATE &STD &MAPPE &GEN +
                          &QJOB &KNAVN &AVD &OPD &TUR &KODE)) +
                          JOB(SNDFAXMAL) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             SBMJOB     CMD(CALL PGM(FAX004CLB) PARM(&DOKNA &FAX +
                          &NAVN &PTIME &PDATE &STD &MAPPE &GEN +
                          &QJOB &KNAVN &AVD &OPD &TUR &KODE)) +
                          JOB(SNDFAXMAL) JOBD(*USRPRF) +
                          JOBQ(SYJOBQPRT)
             ENDDO
SLUTT:       OVRDBF     FILE(FHEADF) TOFILE(FHEADF) MBR(&QJOB)
             ENDPGM
