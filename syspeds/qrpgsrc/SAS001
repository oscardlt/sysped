N01  Fnofly     IP   E             DISK
N01  Fnoflypj   IF   E           k DISK
     Fnoflysp   IF   E           k disk
     Fnoflydum  IF   E           k disk
     F                                     RENAME(noflyr:xxflyr)
N01  Fnoflyso   O  a E             DISK
     c*
     c* genererer alle fra til steder i norge
     c*
     c                   movel     st2kod        sofra
     c                   move      st2son        sonfrx            1 0
     c                   setoff                                       33
     c     sofra         chain     noflypj                            34
     c     *in34         ifne      '1'
     c     *loval        setll     noflydum
     c     *in33         doweq     '0'
     c                   read      noflydum                               33
     c  N33st2kod        ifne      sofra
     C                   EXSR      GENson
     c                   endif
     c                   enddo
     c                   endif
     c****************************************
     c     genson        begsr
     c****************************************
     c                   move      sonfrx        sonfra            1 0
     c                   z-add     st2son        sontil            1 0
     c                   movel     st2KOD        SOTIL
     c
     c* VED FRASTED lik TRD BOO TOS
     c* spesial ved TRD BOO TOS  trondheim bodø tromsø
     c* må trekke fra 1 hvis på fra sone hvis det går sørover
     c*
     c     sofra         ifeq      'TRD'
     c     sofra         oreq      'BOO'
     c     sofra         oreq      'TOS'
     c     sontil        iflt      sonfra
     c                   sub       1             sonfra
     c                   end
     c                   end
     c* VED TILSTED lik TRD BOO TOS
     c* spesial ved TRD BOO TOS  trondheim bodø tromsø
     c* må trekke fra 1 hvis på fra sone hvis det går norover
     c*
     c     sotil         ifeq      'TRD'
     c     sotil         oreq      'BOO'
     c     sotil         oreq      'TOS'
     c     sontil        ifgt      sonfra
     c                   sub       1             sontil
     c                   end
     c                   end
     c*
     c                   movel     sonfra        sotab
     c                   move      sontil        sotab
     c     sotab         chain     noflysp                            33
     c*
     c* tilleg ved viderø destinasjon
     c*
     c     st2vid        ifeq      'J'
     c                   add       8             sopris
     c                   end
     c                   write     noflysor
     c                   endsr
     c*
