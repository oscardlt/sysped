********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 HENT BEST.STED FRA KUNDES DIV. PARMETER (TETBS)
10003 * 02 YBC PTF10 KLARGJØR TIL EKSTERN REFERANSE
10XXX * 03 YBC PTF10 OPPDATER SIGILL-ID
10XXX * 04 YBC PTF10 BRUKER KODE *CN
10XXX * 05 YBC PTF10 NYTT PARAMETER FOR Å HÅNDTERE FEILDATO
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 06 YBC PTF11 PARAMETER VED KALL PÅ SVX013R
11XXX * 07 YBC PTF11 Beregn frist
11133 * 08 YBC PTF11 VEKT ER ENDRET FRA 9.1 TIL 11.3, EGET FELT FOR GARANTI
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 09 YBC PTF12 Feil indikator ved test på lastested
12XXX * 10 CB  PTF12 Ikke oppdater negative garantibelöp
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED EL.TRANSIT HOVED-OPPLYSNING***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05 06 08 09 11 13 16 18-26
      *** LEDIGE INDIKATORER 40-43
      ***        INDIKATOR   27 PÅ = SPØRRING                 ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FFRATXT    IF   E           K DISK
     FSVXH      UF A E           K DISK
     FSVXH10    IF   E           K DISK    RENAME(SVXHR:SVXHR10)
     FSVXHFV    IF A E           K DISK    PREFIX(FV_)
     FSVXV      IF A E           K DISK
     FSVXVFV    IF A E           K DISK    PREFIX(FV_)
     FSVXVAM    IF A E           K DISK
     FSVXVCN    IF A E           K DISK
     FSVXVDK    IF A E           K DISK
     FSVXVFS    IF A E           K DISK
     FSVXVMN    IF A E           K DISK
     FSVXVTD    IF A E           K DISK
     FSVXVVT    IF A E           K DISK
     FSVXSTD    UF   E           K DISK
     FSVXKODL01 IF   E           K DISK
     FSVXHL     UF A E           K DISK
     FSVXHGB    IF A E           K DISK
     FSVXHFS    IF A E           K DISK
     FSVXHGN    IF A E           K DISK
     FSVXGH     UF   E           K DISK
     FSVXGD     IF   E           K DISK
     FSVTVK     IF   E           K DISK
     FSVTKD     IF   E           K DISK
     FSVTHA     IF   E           K DISK
N02  FFRISOK    IF A E           K DISK
N02  FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOKR1)
N02  FZSVXHL01  UF   E           K DISK    RENAME(SVXHR:ZSVXHR)
N02  F                                     PREFIX(Z_)
N01  FSYPARL1   IF   E           K DISK
     FTURER14   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FSVEH      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FEDIM1     UF   E           K DISK
     FEDIM4     IF   E           K DISK
     F                                     RENAME(EDIMR:EDIMR4)
     F*MULTKOD2  IF   E           K DISK
     FKODTS4    IF   E           K DISK
     FSVX011D   CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  TUBILN                 1     10
     D  TUBIL8                 1      8
     D                 DS
     D  TUHENG                 1     10
     D  TUHEN8                 1      8
     D                 DS
     D  WSDDTÅ                 1      4  0
     D  WSDDTM                 5      6  0
     D  WSDDTD                 7      8  0
     D  WSDDT                  1      8  0
     D                 DS
     D  XXDDTD                 1      2  0
     D  XXDDTM                 3      4  0
     D  XXDDTÅ                 5      6  0
     D  XXDDT                  1      6  0
     D                 DS
     D  WSTDTÅ                 1      4  0
     D  WSTDTM                 5      6  0
     D  WSTDTD                 7      8  0
     D  WSTRDT                 1      8  0
     D                 DS
     D  HESG                   1      3
     D  SVEH_SYSG              1      3
     D                 DS
     D  HEVKT                  1      9  0
     D  SVEH_BRUT              1     12  3
     D                 DS
     D  HENT                   2      8  0
     D  SVEH_KOTA              1      8  0
      *
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  THAVD                  1      4  0
     D  THTDN                  5     11  0
     D  BLUR                  12     12
     D  UWS2                  13     22
     D  UIN27                 24     24
     D  UIN36                 26     26
S08  D* THVKB                 27     35  1
N08  D  THVKB                 27     37  3
E08  D  U1N07                 38     40
E08  D  THDK                  41     45
E08  D  THKDC                 46     46
E08  D  THALK                 47     48
E08  D  THBLK                 49     50
E08  D  WSPRO                 51     58  0
E08  D  WSLSTL                59     62  0
E08  D  U2REFF                63     79
E08  D  U2UNIK                80     88  0
     D  UPARM2                 1    128
      *
     C                   OPEN      SVX011D
     C                   EXSR      INIT
     C     UTYPE         CABEQ     'DSP'         START1
      *...............................................
      * BILDE-1 INNLESING AV OPDNR./TARIFFØR OSV.
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30
     CANN31              Z-ADD     10            LINNBR
     C  N30
     CAN 31              Z-ADD     9             LINNBR
     C  N30UTYPE         IFEQ      'CPY'
     C                   Z-ADD     11            LINNBR
     C                   END
     C  N30              Z-ADD     34            POSNBR
     C  N30WSSG          IFEQ      *BLANKS
     C                   Z-ADD     9             LINNBR
     C                   END
     C                   EXFMT     SVX011D01
     C                   MOVEA     '00'          *IN(98)
     C                   SETOFF                                       3095
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START
     C                   END
     C   12              GOTO      SLUTT
      *
     C     START1        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C   04UFLAGG        CABEQ     1             START
      *
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *BLANKS       WSTRNR
     C                   MOVE      *BLANKS       WSTRDT
     C                   MOVE      *ZEROS        WSDDT
     C                   END
      *===============================================
      *
      *...............................................
      * BILDE-2 INNLESING AV HOVED OPPLYSNINGER AV SAD
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START2        TAG
     C  N30              Z-ADD     2             LINNBR
     C  N30              Z-ADD     10            POSNBR
     C     ST21          TAG
      *
     C                   EXSR      TSTOPL
      *
     C                   EXFMT     SVX011D02
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '000000000000'*IN(76)
     C                   MOVEA     '000000000000'*IN(64)
     C                   MOVEA     '000000000000'*IN(52)
     C                   MOVEA     '0000000'     *IN(45)
     C                   SETOFF                                       30
      *
      *  04 = SØK AVSENDER/MOTTAKER/HOVEDANSVARLIG
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      ST21
     C                   END
      *
      *  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
      *
      *  10 = SE OPPLYSNIGER OM GODKJENNELSE FRA TOLLVESENET (KUN KOMMUNIKASJON)
     C   10              DO
     C                   EXSR      VISTOL
     C                   GOTO      START2
     C                   END
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL SVX011D01
     C   12              DO
     C     UTYPE         IFNE      'DSP'
     C     SVHK          CHAIN     SVXH                               33
     C                   MOVE      ' '           THST
     C  N33              UPDATE    SVXHR
     C                   END
     C                   GOTO      SLUTT
     C                   END
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
      *
     C   15UTYPE         IFEQ      'DSP'
     C                   EXSR      TILKOD
     C                   GOTO      START2
     C                   END
      *
     C     UTYPE         IFEQ      'DSP'
     C                   GOTO      START3
     C                   END
      *
      * ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      * TEST OM GARANTITYPE PASSER PROSEDYRE
     C                   IF        ((WSENKL = 'J') AND (WSGKD > 1))
     C                   MOVE      'J'           WSJN
     C                   EXFMT     SVX011D04
     C     WSJN          CABEQ     'N'           START2
     C                   MOVE      'N'           WSENKL
     C                   END
      *
      * ----- INGEN FEIL HITTIL     OPPDATER SVXH -----
     C                   EXSR      OPDSVH
     C   15              GOTO      START2
      *
      *===============================================
      *
     C     START3        TAG
      *
      * VEDLIKEHOLD INFORMASJONER OM FORHÅNDSVARSLING
     C     SVHK          CHAIN     SVXHFV                             33
     C                   IF        (((WSBLK = 'SJ') OR
     C                               (WSBLK = 'FO')) OR
     C                               (*IN33 = *OFF) OR *IN06)
     C                   MOVE      WSTDN         UTDN
     C                   CALL      'SVX011RA'
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    WSSG
     C                   PARM                    WSDK
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C     UFLAGG        CABEQ     1             START2
     C                   END
      *
     C                   EXSR      TOSVV
     C   12              GOTO      START2
      *
     C     SLUTT         TAG
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   Z-ADD     0             UFLAGG
     C                   END
     C                   CLOSE     SVX011D
N01  C                   EVAL      *INLR = *ON
     C                   RETURN
      *
     C***********************************************
     C     TILKOD        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     76
     C     POSNBR        ANDLE     77
     C                   CALL      'SVX017R'
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSGBGU
     C                   PARM                    UTYPE
     C     SVHK          CHAIN     SVXH                               33
     C                   MOVE      WSGBGU        THGBGU
     C                   UPDATE    SVXHR
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     31
     C     *IN35         IFEQ      '1'
     C     WSGKD         OREQ      2
     C     WSGKD         OREQ      4
     C                   CALL      'SVX025R'
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSGFT1
     C                   PARM                    WSGADK
     C                   PARM                    WSGBGI
     C                   PARM                    WSGBGU
     C                   PARM                    WSGBL
     C                   PARM                    WSGVK
     C                   PARM                    UTYPE
     C     SVHK          CHAIN     SVXH                               33
     C                   MOVE      WSGFT1        THGFT1
     C                   MOVE      WSGADK        THGADK
     C                   MOVE      WSGBGI        THGBGI
     C                   MOVE      WSGBGU        THGBGU
     C                   UPDATE    SVXHR
     C                   END
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     79
     C                   CALL      'SVX016R'
     C                   PARM                    UAVD
     C                   PARM      WSTDN         UTDN3             7 0
     C                   PARM                    WSDFKD
     C                   PARM                    WSDFSK
     C                   PARM                    UTYPE
     C     SVHK          CHAIN     SVXH                               33
     C                   MOVE      WSDFKD        THDFKD
     C                   MOVE      WSDFSK        THDFSK
     C                   UPDATE    SVXHR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * DEKLARASJONSTYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDK          UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDK
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSNR
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVSENDERSLANDKODE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSALK = UKD
     C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * BESTEMMELESLANDKODE
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSBLK = UKD
     C                   END
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL AVSENDER
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKS = UKD
     C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL AVSENDER
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKS         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKS
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * MOTTAKERSNR
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     43            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     72
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSTALK = UKD
     C                   END
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTASK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTASK
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED GRENSE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     72
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSTGLK = UKD
     C                   END
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL TRANSPORTMIDDEL VED GRENSE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     75
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTGSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTGSK
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL MOTTAKER
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKK = UKD
     C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL MOTTAKER
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKK         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKK
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTMÅTE
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRMI
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TRANSPORTMÅTE
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRM
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * HOVEDANSVARLIGNR
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNA
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * AVGANGSTOLLSTED
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     64
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSCATS        UKODE
     C                   MOVE      'AVG'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSCATS
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     63            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE PÅ FØLGEDOKUMENTER
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     63
     C     POSNBR        ANDLE     64
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKFD        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKFD
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL HOVEDANSVARLIG
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSLKA = UKD
     C                   END
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL HOVEDANSVARLIG
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     33
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSSKA         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSKA
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-1
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     6
     C     POSNBR        ANDLE     13
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD1        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD1
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-2
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD2        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD2
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-3
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     24
     C     POSNBR        ANDLE     31
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD3        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD3
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-4
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     40
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD4        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD4
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-5
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     49
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD5        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD5
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-6
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     58
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD6        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD6
     C                   Z-ADD     60            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-7
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     67
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD7        UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD7
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * TOLLSTED TRANSIT-8
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     76
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTSD8        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSD8
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      * ADGANGSKODE FOR GARANTI
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     69
     C     POSNBR        ANDLE     72
     C                   IF        WSGFT1 <> *BLANKS
     C                   CALL      'SVX034R'
     C                   PARM                    WSGFT1
     C                   PARM                    WSGADK
     C                   ELSE
     C                   MOVE      '105'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGADK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGADK
     C                   END
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * LANDKODE TIL GARANTI BEGRENSNING
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     76
     C     POSNBR        ANDLE     77
     C                   CALL      'SVT003R'
     C                   PARM                    SVKD_TYP
     C                   PARM                    SVKD_IE
     C                   PARM                    WDT
     C                   PARM                    UKD              10
     C                   IF        UKD <> *BLANKS
     C                   EVAL      WSGBGU = UKD
     C                   END
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     35
     C     POSNBR        ANDLE     37
     C                   CALL      'SVT007R'
     C                   PARM                    UKD              10
     C     UKD           IFNE      *BLANKS
     C                   EVAL      WSGVK = UKD
     C                   ENDIF
     C                   Z-ADD     67            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * BESTEMMELSESTEDS TOLLSTED
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     67
     C     POSNBR        ANDLE     74
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'ANK'         UTYPE2            3
     C                   MOVEL     WSTSB         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTSB
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     52            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * SPRÅKKODE TIL DEKLARASJON
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     78
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDSK         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDSK
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      * KONTROLL RESULTAT
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     14
     C                   MOVE      '047'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDKR         UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDKR
     C                   Z-ADD     22            POSNBR
     C                   END
      * SPRÅKKODE TIL FORSEGLING
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDFSK        UKODE
     C                   CALL      'SVX002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDFSK
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
N02  C                   MOVE      *ZEROS        Z_THUNIK
N02  C                   MOVE      *BLANKS       Z_THREFF
N02   *
N02   * henter fra eksterref
N02   *
N02  C   04              IF        LINNBR = 8
N02  C                   CALL      'SYGE47R'
N02  C                   PARM      'B'           UHEUR             1
N02  C                   PARM                    WSEXTR
N02  C                   EVAL      *IN04=*OFF
N02  C                   IF        WSEXTR = *BLANKS
N02  C                   EVAL      *IN30=*ON
N02  C                   GOTO      SLTB1
N02  C                   ENDIF
N02  C                   ENDIF
N02   * EKSTEN REFERANSE
N02  C                   IF        ((UTYPE <> 'CPY') AND (WSEXTR <> *BLANKS))
N02  C     FRISOL01K     CHAIN     FRISOL01                           33
N02  C                   DOW       *IN33 = *OFF
N02  C     SVHKFRI       CHAIN(N)  SVXH                               33
N02  C                   IF        *IN33 = *OFF
N02  C                   MOVE      FSOPD         WSTDN
N02  C                   MOVE      FSAVD         UAVD
N02  C                   LEAVE
N02  C                   END
N02  C     FRISOL01K     READE     FRISOL01                               33
N02  C                   ENDDO
N02   * Ny ekstern ref  - hent data
N02  C   33              IF        THEKST = 'J'
N02  C                   MOVE      *ZEROS        UXOPD             7 0
N02  C                   CALL      'SADEXT'
N02  C                   PARM                    UAVD
N02  C                   PARM                    WSEXTR
N02  C                   PARM                    UXOPD
N02  C                   PARM                    WSSG
N02  C                   MOVE      UXOPD         WSTDN
N02  C                   IF        WSTDN = 0
N02  C                   SETON                                        30
N02  C                   Z-ADD     7             LINNBR
N02  C                   Z-ADD     20            POSNBR
N02  C                   MOVE      'SHU1172'     MSGNR
N02  C                   GOTO      SLTB1
N02  C                   END
N02  C                   END
N02  C                   END
      *** TEST AVDELING
     C     UAVD          CHAIN(N)  SVXSTD                             95
     C  N95              DO
     C                   MOVE      *BLANKS       THST
     C                   MOVE      *ZEROS        THTDN
N07  C                   MOVE      *ZEROS        THDDT
S08  C*                  IF        THGBL < 100
S08  C*                  MOVE      *ZEROS        THGBL
S08  C*                  END
     C                   END
     C   95              DO
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
      *** TEST TARIFFØR
     C     WSSG          CHAIN     SVTHA                              99
     C   99              DO
     C                   MOVE      'SPS0001'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END
      *
      *** TEST OM TASTET TOLLDEKNR. ER RIKTIG
      * WSTDN = 0  --> HENT STANDARD NCTS-OPPLYSNINGER
     C     UTYPE         IFEQ      'CPY'                                        1<-B
     C     SVHKK         CHAIN(N)  SVXH                               33
     C                   ELSE                                                   1
     C     WSTDN         IFNE      0                                             2<-B
     C     SVHK          CHAIN     SVXH                               33
     C  N33UTYPE         IFEQ      'DSP'                                          3<-B
     C                   UPDATE    SVXHR
     C                   GOTO      STTB1
     C                   END                                                      3<-E
      * THST = ' ' --> ÅPEN TRANSITTERING
      *        '+' --> Midlertidig "arb.status" - Alle som hadde Q på et gitt tidspunkt.(=klar sendi
      *        'A' --> HOLD PÅ Å SENDE UT
      *        'B' --> SENDT TIL IBM
      *        'C' --> SENDT TIL TOLLVESENET
      *        'D' --> KANSELLERT
      *        'E' --> HOLD PÅ Å BLI ENDRET
      *        'F' --> MELDING OM INGEN FRIGIVELSE
      *        'G' --> MELDING OM INGEN FRIGIVELSE OG GARANTI FEIL
      *        'K' --> VENT PÅ Å BLI UTSKREVET
      *        'M' --> FEILMELDING FRA TOLLVESENET
      *        'P' --> UTSKREVET
      *        'R' --> NØDPROSEDYRE
      *        'Q' --> "Intern postkasse" (Venter på at program skal lage en sending av denne)
      *        'S' --> SKICKA
      *        'U' --> HAR FÅTT MRN-NUMMER
      *        'V' --> VAREKONTROLL
      *        'W' --> INGEN FRIGIVELSE
      *        'Y' --> MELDING OM AVVIST FRIGIVELSE
      *        'Z' --> TRANSITT AVSLUTTET
     C  N33THST          IFNE      ' '                                            3<-B
     C     THST          ANDNE     'K'
     C     THST          ANDNE     'M'
     C     THST          COMP      'P'                                9898
     C   98THST          COMP      'Q'                                9898
     C   98THST          COMP      'F'                                9898
     C   98THST          COMP      'G'                                9898
     C   98THST          COMP      'W'                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98THST          IFEQ      'A'                                            3<-B
     C     THWS          COMP      UWS                                9898
     C                   END                                                      3<-E
      *
     C  N33
     CANN98              DO                                                       3<-B
     C                   EXSR      TSTM
     C   98              UPDATE    SVXHR
     C   98              GOTO      SLTB1
     C                   END                                                      3<-E
     C  N33
     CANN98              MOVE      'E'           THST
     C  N33
     CANN98              IF        ((THST = 'F') OR (THST = 'G'))
     C                   EVAL      THTUID = *BLANKS
     C                   EVAL      THSGDK = *BLANKS
     C                   EVAL      THSGME = *BLANKS
     C                   EVAL      THSGUT = *BLANKS
     C                   EVAL      THSGDT = *BLANKS
     C                   END
     C  N33              UPDATE    SVXHR
     C   33HEADFK        CHAIN     HEADF                              98
     C   33
     CAN 98SVHK          CHAIN     SVEH                               98
      *
     C   98              DO                                                       3<-B
     C                   MOVE      'SPT0028'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N02   *
N02   *  04 = PLUKK FRA Z-FIL
N02  C                   MOVE      *ZEROS        UZAVD             4 0
N02  C                   MOVE      *ZEROS        UZTDN             7 0
N02  C                   MOVE      *BLANKS       UZREFF           17
N02  C                   MOVE      *ZEROS        UZUNIK            9 0
N02  C  N30              IF        *IN04
N02  C                   CALL      'SVX011RB'
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    UZAVD
N02  C                   PARM                    UZTDN
N02  C                   PARM                    UZREFF
N02  C                   PARM                    UZUNIK
N02  C                   PARM                    UFLAGG
N02  C     UFLAGG        CABEQ     1             SLTB1
N02  C                   IF        UZREFF <> *BLANKS
N02  C                   EVAL      WSSOK = UZREFF
N02  C                   END
N02  C                   END
      *
      *** HENT OPPLYSNINGER FRA HEADF/DOKUF
     C  N30
     CAN 33              MOVE      WSTDN         UTDN
     C  N30
     CAN 33              EXSR      SRU1
      *
      *** FLYTT DATA FRA FIL-VARIABLER TIL WS-VARIABLER
     C     STTB1         TAG
     C  N30              EXSR      MOVW2
N02   *
N02  C  N30              IF        (*IN04 OR (Z_THREFF <> *BLANKS))
N02  C                   EXSR      HZFIL
N02  C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TSTM          BEGSR
     C***********************************************
      *
      * Test om det finnes sending i "postkasse"
     C     TVINMK        SETGT     EDIM1
     C     STTSTM        TAG
     C     TVINMK        READPE    EDIM1                                  98
     C  N98MSR           IFEQ      'S'
     C     M1001         ANDEQ     'STE'
     C   10              DELETE    EDIMR
     C   10              GOTO      SLTSTM
     C                   UPDATE    EDIMR
     C                   MOVE      'SPT0043'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   GOTO      STTSTM
     C                   END
      *
      * Test om det har fått transitteringsnr
     C     TVIM4K        SETLL     EDIM4                              98
     C     STTST2        TAG
     C     TVI41K        READPE    EDIM4                                  98
     C  N98MST           IFEQ      'D'
     C     M1001         ORNE      'STE'
     C                   GOTO      STTST2
     C                   ELSE
     C     M1N07         IFEQ      '028'
     C     M1N07         OREQ      '029'
     C                   MOVE      'SVX0819'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   END
     C                   END
     C                   MOVE      '0'           *IN98
      *
     C     SLTSTM        ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSPRO         IFNE      0
     C     WSLSTL        ORGT      0
     C     WSENKL        ANDEQ     'N'
     C     WSPRO         CHAIN     TURER14                            99
     C   99              MOVE      'SPT0017'     MSGNR
     C   99              SETON                                        30
     C     *IN99         IFEQ      '0'
     C     WSKNK         IFEQ      0
     C     WSNAK         ANDEQ     *BLANKS
     C                   MOVE      TUKNA         WSKNK
     C                   END
     C     WSTAID        IFEQ      *BLANKS
     C                   MOVEL     TUBILN        WSTAID
     C                   END
     C     WSTGID        IFEQ      *BLANKS
     C                   MOVEL     TUBILN        WSTGID
     C                   END
     C     WSTRM         IFEQ      0
     C                   MOVE      TUTRMA        WSTRM
     C                   END
     C                   END
     C                   END
      *
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDK          YKODE
     C     SVK01K        CHAIN     SVXKODL01                          98
     C   98
     CANN30              MOVE      'SVX0809'     MSGNR
     C   98              SETON                                        30
      *
     C     WSENKL        IFEQ      'J'
     C     WSLSTL        ANDGT     0
     C  N30              MOVE      'SVX1734'     MSGNR
     C                   MOVE      '1'           *IN55
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSKNS         IFNE      0
     C                   EXSR      TESTSS
     C                   END
      *
     C     WSENKL        IFEQ      'J'
     C*    WSTINS        COMP      *BLANKS                                96
     C   96
     CANN30              MOVE      'SVX0812'     MSGNR
     C   96              SETON                                        30
     C                   END
      *
     C     WSNAS         COMP      *BLANKS                                95
     C   95
     CANN30              MOVE      'SPK0037'     MSGNR
     C   95              SETON                                        30
      *
     C                   IF        WSALK <> *BLANKS
     C                   EVAL      SVKD_KD = WSALK
     C     SVTKDK        CHAIN     SVTKD                              94
     C   94
     CANN30              MOVE      'SPL0001'     MSGNR
     C   94              SETON                                        30
     C                   END
      *
     C                   IF        WSBLK <> *BLANKS
N01  C                   IF        ((WSBLK = *BLANKS) AND (WSKNK <> 0))
N01  C                   MOVE      WSKNK         KUNDNR
N01  C     CUND1K        CHAIN     CUNDL01                            33
N01  C  N33              MOVE      SYLAND        WSBLK
N01  C                   END
     C                   EVAL      SVKD_KD = WSBLK
     C     SVTKDK        CHAIN     SVTKD                              93
     C   93
     CANN30              MOVE      'SPL0001'     MSGNR
     C   93              SETON                                        30
     C                   END
      *
     C     WSLKS         IFEQ      *BLANKS
     C                   MOVE      FILAND        WSLKS
     C                   END
     C                   EVAL      SVKD_KD = WSLKS
     C     SVTKDK        CHAIN     SVTKD                              92
     C   92
     CANN30              MOVE      'SPL0001'     MSGNR
     C   92              SETON                                        30
      *
     C     WSTAID        IFEQ      *BLANKS
     C  N30              MOVE      'SVX1705'     MSGNR
     C                   SETON                                        3056
     C                   END
      *
     C     WSSKS         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKS         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          91
     C   91
     CANN30              MOVE      'SVX0810'     MSGNR
     C   91              SETON                                        30
     C                   END
      *
     C     WSKNK         IFNE      0
     C                   EXSR      TESTKK
     C                   END
      *
     C                   EVAL      SVKD_KD = WSTALK
     C     SVTKDK        CHAIN     SVTKD                              89
     C   89
     CANN30              MOVE      'SPL0001'     MSGNR
     C   89              SETON                                        30
      *
     C     WSTASK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTASK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          88
     C   88
     CANN30              MOVE      'SVX0810'     MSGNR
     C   88              SETON                                        30
     C                   END
      *
     C     WSNAK         COMP      *BLANKS                                87
     C   87
     CANN30              MOVE      'SPK0038'     MSGNR
     C   87              SETON                                        30
      *
     C     WSADK1        COMP      *BLANKS                                53
     C   53
     CANN30              MOVE      'SVX1883'     MSGNR
     C   53              SETON                                        30
      *
     C     WSPNK         COMP      *BLANKS                                52
     C   52
     CANN30              MOVE      'SVX1884'     MSGNR
     C   52              SETON                                        30
      *
     C     WSPSK         COMP      *BLANKS                                51
     C   51
     CANN30              MOVE      'SVX1885'     MSGNR
     C   51              SETON                                        30
      *
     C     WSTGID        COMP      *BLANKS                                54
     C   54
     CANN30              MOVE      'SVX1705'     MSGNR
     C   54              SETON                                        30
      *
     C                   EVAL      SVKD_KD = WSTGLK
     C     SVTKDK        CHAIN     SVTKD                              86
     C   86
     CANN30              MOVE      'SPT0030'     MSGNR
     C   86              SETON                                        30
      *
     C                   IF        *IN06
S09  C*    WSLASD        COMP      *BLANKS                                45
S09  C*  45
S09  C*NN30              MOVE      'SVX0001'     MSGNR
S09  C*  45              SETON                                        30
N09  C     WSLASD        COMP      *BLANKS                                46
N09  C   46
N09  CANN30              MOVE      'SVX0001'     MSGNR
N09  C   46              SETON                                        30
     C                   END
      *
     C     WSTGSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTGSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          85
     C   85
     CANN30              MOVE      'SVX0810'     MSGNR
     C   85              SETON                                        30
     C                   END
      *
     C                   EVAL      SVKD_KD = WSLKK
     C     SVTKDK        CHAIN     SVTKD                              84
     C   84
     CANN30              MOVE      'SPL0001'     MSGNR
     C   84              SETON                                        30
      *
     C     WSSKK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKK         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          86
     C   83
     CANN30              MOVE      'SVX0810'     MSGNR
     C   83              SETON                                        30
     C                   END
      *
     C                   IF        WSTRMI <> 0
     C     KODS4K        CHAIN     KOS4R                              45
     C   45
     CANN30              MOVE      'SPL0001'     MSGNR
     C   45              SETON                                        30
     C                   END
      *
     C     KODS4K        CHAIN     KOS4R                              82
     C   82
     CANN30              MOVE      'SPL0001'     MSGNR
     C   82              SETON                                        30
      *
     C     WSKNA         IFNE      0
     C                   EXSR      TESTAA
     C                   END
      *
     C     WSENKL        IFEQ      'J'
     C     WSDKR         ORNE      *BLANKS
     C     WSTINA        COMP      *BLANKS                                80
     C   80
     CANN30              MOVE      'SVX0812'     MSGNR
     C   80              SETON                                        30
     C                   END
      *
     C     WSENKL        IFEQ      'J'
     C     WSLSD         COMP      *BLANKS                                47
     C   47WSLAS2        COMP      *BLANKS                                47
     C   47
     CANN30              MOVE      'SVX1938'     MSGNR
     C   47              SETON                                        30
     C                   END
      *
     C     WSNAA         COMP      *BLANKS                                79
     C   79
     CANN30              MOVE      'SPK0037'     MSGNR
     C   79              SETON                                        30
      *
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSCATS        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          78
     C   78
     CANN30              MOVE      'SVX1768'     MSGNR
     C   78              SETON                                        30
      *
     C     WSSKFD        IFEQ      *BLANKS
     C                   MOVE      WSSKA         WSSKFD
     C                   ELSE
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKFD        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          77
     C   77
     CANN30              MOVE      'SVX0810'     MSGNR
     C   77              SETON                                        30
     C                   END
      *
     C                   EVAL      SVKD_KD = WSLKA
     C     SVTKDK        CHAIN     SVTKD                              76
     C   76
     CANN30              MOVE      'SPL0001'     MSGNR
     C   76              SETON                                        30
      *
     C     WSSKA         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSKA         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          75
     C   75
     CANN30              MOVE      'SVX0810'     MSGNR
     C   75              SETON                                        30
     C                   END
      *
     C     WSDSK         IFEQ      *BLANKS
     C                   MOVE      WSSKA         WSDSK
     C                   ELSE
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDSK         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          62
     C   62
     CANN30              MOVE      'SVX0810'     MSGNR
     C   62              SETON                                        30
     C                   END
      *
     C     WSTSD1        IFNE      *BLANKS
     C*    WSENKL        OREQ      'J'
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD1        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          74
     C   74
     CANN30              MOVE      'SVX1768'     MSGNR
     C   74              SETON                                        30
     C                   END
      *
     C     WSTSD2        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD2        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          73
     C   73
     CANN30              MOVE      'SVX1768'     MSGNR
     C   73              SETON                                        30
     C                   END
      *
     C     WSTSD3        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD3        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          72
     C   72
     CANN30              MOVE      'SVX1768'     MSGNR
     C   72              SETON                                        30
     C                   END
      *
     C     WSTSD4        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD4        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          71
     C   71
     CANN30              MOVE      'SVX1768'     MSGNR
     C   71              SETON                                        30
     C                   END
      *
     C     WSTSD5        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD5        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          70
     C   70
     CANN30              MOVE      'SVX1768'     MSGNR
     C   70              SETON                                        30
     C                   END
      *
     C     WSTSD6        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD6        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          69
     C   69
     CANN30              MOVE      'SVX1768'     MSGNR
     C   69              SETON                                        30
     C                   END
      *
     C     WSTSD7        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD7        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          68
     C   68
     CANN30              MOVE      'SVX1768'     MSGNR
     C   68              SETON                                        30
     C                   END
      *
     C     WSTSD8        IFNE      *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD8        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          67
     C   67
     CANN30              MOVE      'SVX1768'     MSGNR
     C   67              SETON                                        30
     C                   END
      *
     C                   MOVE      *ZEROS        XGGBLR           11 0
     C     WSGFT1        IFEQ      *BLANKS                                      1<-B
     C     WSGFT2        COMP      *BLANKS                                66
     C   66              MOVE      'SVX0838'     MSGNR
     C   66              SETON                                        30
      *
     C     WSGKD         IFEQ      0                                             2<-B
     C     WSGKD         OREQ      1
     C     WSGKD         OREQ      2
     C     WSGKD         OREQ      4
     C     WSGKD         OREQ      9
     C     WSGADK        ORNE      *BLANKS
     C                   MOVE      '105'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSGADK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          65
     C   65
     CANN30              MOVE      'SVX0811'     MSGNR
     C   65              SETON                                        30
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      *
     C                   IF        ((WSGKD = 2) OR (WSGKD = 4))                  2<-B
     C     WSGADK        COMP      *BLANKS                                65
     C   65
     CANN30              MOVE      'SVX0811'     MSGNR
     C   65              MOVE      '1'           *IN30
     C                   ELSE                                                    2
     C                   MOVE      *BLANKS       WSGFT2
     C     WSGFT1        CHAIN(N)  SVXGH                              50
     C  N50TGST          COMP      'S'                                    50
     C  N50              IF        TGGTY >= 6                                     3<-B
     C                   Z-ADD     0             XSGBL2           13 2
     C                   EVAL      XSGBL2 = TGGBL - TGGBLB + XSGBL - WSGBL
     C     XSGBL2        COMP      0                                    50
     C                   END                                                      3<-E
     C                   IF        *IN50                                          3<-B
     C  N30              MOVE      'SVX1900'     MSGNR
     C  N30              SETON                                        30
     C                   ELSE                                                     3
     C                   MOVE      TGGTY         WSGKD
     C                   EVAL      XGGBLR = TGGBL - TGGBLB + XSGBL
     C                   MOVE      TGGVK         WSGVK
     C                   IF        ((WSGADK <> TGAKNY) OR (WSGADK = *BLANKS))      4<-B
     C     SVXGDK        CHAIN     SVXGD                              65
     C   65
     CANN30              MOVE      'SVX0811'     MSGNR
     C   65              MOVE      '1'           *IN30
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     WSGBGU        IFEQ      *BLANKS
     C     SVHK          SETLL     SVXHGB
     C     SVHK          READE     SVXHGB                                 33
     C     *IN33         IFEQ      '0'
     C  N30              MOVE      'SVX0822'     MSGNR
     C                   MOVE      '1'           *IN66
     C                   SETON                                        30
     C                   END
     C                   ELSE
     C                   EVAL      SVKD_KD = WSGBGU
     C     SVTKDK        CHAIN     SVTKD                              64
     C   64
     CANN30              MOVE      'SPL0001'     MSGNR
     C   64              SETON                                        30
     C                   END
      *
     C                   IF        ((WSGBL > XGGBLR) AND (XGGBLR <> 0))
     C  N30              MOVE      'SVX1902'     MSGNR
     C                   MOVE      '1'           *IN49
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSGVK         CHAIN     SVTVK                              48
     C   48
     CANN30              MOVE      'SPV0001'     MSGNR
     C   48              MOVE      '1'           *IN30
      *
N01  C                   IF        WSTSB = *BLANKS
N01  C     SYPARL1K      CHAIN     SYPARL1                            33
N01  C  N33              EVAL      WSTSB = SYVRDA
N01  C                   END
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSB         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          63
     C   63
     CANN30              MOVE      'SVX1768'     MSGNR
     C   63              SETON                                        30
      *
     C     WSDKR         IFNE      *BLANKS
     C     WSDDT         ORNE      0
     C     WSENKL        OREQ      'J'                                          FORENKLET PROS.
     C                   MOVE      '047'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDKR         YKODE
     C     SVK01K        CHAIN     SVXKODL01                          61
     C   61
     CANN30              MOVE      'SVX0854'     MSGNR
     C   61              SETON                                        30
      *
     C     WSDDT         IFEQ      0
     C                   MOVE      *ZEROS        UINNDT            6 0
N07  C                   IF        XANTDG = 0
     C                   Z-ADD     8             UANTDG            3 0
N07  C                   ELSE
N07  C                   Z-ADD     XANTDG        UANTDG
N07  C                   END
     C                   MOVE      WSDDTD        XXDDTD
     C                   MOVE      WSDDTM        XXDDTM
     C                   MOVE      WSDDTÅ        XXDDTÅ
     C                   CALL      'SYFA20B'
     C                   PARM                    UINNDT
     C                   PARM                    UANTDG
     C     XXDDT         PARM                    UUTDT             6 0
N05  C                   PARM                    UFLAGG            1 0
     C                   MOVE      XXDDTD        WSDDTD
     C                   MOVE      XXDDTM        WSDDTM
     C     2000          ADD       XXDDTÅ        WSDDTÅ
     C                   END
      *
     C                   CALL      'TESTDATO'
     C                   PARM      WSDDTD        UDD               2 0
     C                   PARM      WSDDTM        UMM               2 0
     C                   PARM      WSDDTÅ        UÅÅ               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      60
     C   60
     CANN30              MOVE      'SPD0001'     MSGNR
     C   60              SETON                                        30
     C                   END
      *
     C     WSDFSK        IFNE      *BLANKS
      * KREVES HVIS DET ER SENSITIVE VARER. DET ER IKKE MULIG PÅ NÅVARENDE TIDPUNKT.
     C*          WSENKL    OREQ 'J'                        FORENKLET PROS.
     C     WSDFKD        COMP      *BLANKS                                59
     C   59
     CANN30              MOVE      'SVX0839'     MSGNR
     C   59              SETON                                        30
     C                   END
      *
     C     WSDFSK        IFNE      *BLANKS
      * KREVES HVIS DET ER SENSITIVE VARER. DET ER IKKE MULIG PÅ NÅVARENDE TIDPUNKT.
     C*          WSENKL    OREQ 'J'                        FORENKLET PROS.
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDFSK        YKODE
     C     SVK01K        CHAIN     SVXKODL01                          58
     C   58
     CANN30              MOVE      'SVX0810'     MSGNR
     C   58              SETON                                        30
     C                   END
      *
     C  N59
     CANN58WSDFSK        IFEQ      *BLANKS
     C     WSDFKD        ANDEQ     *BLANKS
     C     WSDANT        IFGT      0
     C  N30              MOVE      'SVX0820'     MSGNR
     C                   SETON                                        3059
     C                   END
     C                   ELSE
     C     WSDANT        IFEQ      0
     C                   Z-ADD     1             WSDANT
     C                   END
     C                   END
      *
     C     WSTRDT        IFNE      0
     C                   CALL      'TESTDATO'
     C                   PARM      WSTDTD        UDD
     C                   PARM      WSTDTM        UMM
     C                   PARM      WSTDTÅ        UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      57
     C   57
     CANN30              MOVE      'SPD0001'     MSGNR
     C   57              SETON                                        30
     C                   END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   57              Z-ADD     22            LINNBR
     C   57              Z-ADD     72            POSNBR
     C   58              Z-ADD     21            LINNBR
     C   58              Z-ADD     78            POSNBR
     C   59              Z-ADD     21            LINNBR
     C   59              Z-ADD     57            POSNBR
     C   60              Z-ADD     21            LINNBR
     C   60              Z-ADD     22            POSNBR
     C   61              Z-ADD     21            LINNBR
     C   61              Z-ADD     13            POSNBR
     C   63              Z-ADD     20            LINNBR
     C   63              Z-ADD     67            POSNBR
     C   48              Z-ADD     20            LINNBR
     C   48              Z-ADD     35            POSNBR
     C   49              Z-ADD     20            LINNBR
     C   49              Z-ADD     15            POSNBR
     C   64              Z-ADD     19            LINNBR
     C   64              Z-ADD     76            POSNBR
     C   65              Z-ADD     19            LINNBR
     C   65              Z-ADD     69            POSNBR
     C   66              Z-ADD     19            LINNBR
     C   66              Z-ADD     33            POSNBR
     C   50              Z-ADD     19            LINNBR
     C   50              Z-ADD     8             POSNBR
     C   67              Z-ADD     18            LINNBR
     C   67              Z-ADD     69            POSNBR
     C   68              Z-ADD     18            LINNBR
     C   68              Z-ADD     60            POSNBR
     C   69              Z-ADD     18            LINNBR
     C   69              Z-ADD     51            POSNBR
     C   70              Z-ADD     18            LINNBR
     C   70              Z-ADD     42            POSNBR
     C   71              Z-ADD     18            LINNBR
     C   71              Z-ADD     33            POSNBR
     C   72              Z-ADD     18            LINNBR
     C   72              Z-ADD     24            POSNBR
     C   73              Z-ADD     18            LINNBR
     C   73              Z-ADD     15            POSNBR
     C   74              Z-ADD     18            LINNBR
     C   74              Z-ADD     6             POSNBR
     C   62              Z-ADD     17            LINNBR
     C   62              Z-ADD     77            POSNBR
     C   75              Z-ADD     17            LINNBR
     C   75              Z-ADD     32            POSNBR
     C   76              Z-ADD     17            LINNBR
     C   76              Z-ADD     12            POSNBR
     C   77              Z-ADD     15            LINNBR
     C   77              Z-ADD     63            POSNBR
     C   78              Z-ADD     14            LINNBR
     C   78              Z-ADD     57            POSNBR
     C   79              Z-ADD     14            LINNBR
     C   79              Z-ADD     2             POSNBR
     C   47              Z-ADD     13            LINNBR
     C   47              Z-ADD     60            POSNBR
     C   80              Z-ADD     13            LINNBR
     C   80              Z-ADD     22            POSNBR
     C   46              Z-ADD     12            LINNBR
     C   46              Z-ADD     64            POSNBR
     C   83              Z-ADD     12            LINNBR
     C   83              Z-ADD     32            POSNBR
     C   84              Z-ADD     12            LINNBR
     C   84              Z-ADD     12            POSNBR
     C   82              Z-ADD     11            LINNBR
     C   82              Z-ADD     78            POSNBR
     C   85              Z-ADD     11            LINNBR
     C   85              Z-ADD     74            POSNBR
     C   86              Z-ADD     11            LINNBR
     C   86              Z-ADD     71            POSNBR
     C   54              Z-ADD     11            LINNBR
     C   54              Z-ADD     43            POSNBR
     C   51              Z-ADD     11            LINNBR
     C   51              Z-ADD     12            POSNBR
     C   52              Z-ADD     11            LINNBR
     C   52              Z-ADD     2             POSNBR
     C   53              Z-ADD     10            LINNBR
     C   53              Z-ADD     2             POSNBR
     C   87              Z-ADD     9             LINNBR
     C   87              Z-ADD     2             POSNBR
     C   45              Z-ADD     8             LINNBR
     C   45              Z-ADD     78            POSNBR
     C   88              Z-ADD     8             LINNBR
     C   88              Z-ADD     74            POSNBR
     C   89              Z-ADD     8             LINNBR
     C   89              Z-ADD     71            POSNBR
     C   56              Z-ADD     8             LINNBR
     C   56              Z-ADD     43            POSNBR
     C   91              Z-ADD     7             LINNBR
     C   91              Z-ADD     32            POSNBR
     C   92              Z-ADD     7             LINNBR
     C   92              Z-ADD     12            POSNBR
     C   93              Z-ADD     6             LINNBR
     C   93              Z-ADD     56            POSNBR
     C   94              Z-ADD     5             LINNBR
     C   94              Z-ADD     56            POSNBR
     C   95              Z-ADD     4             LINNBR
     C   95              Z-ADD     2             POSNBR
     C   96              Z-ADD     3             LINNBR
     C   96              Z-ADD     22            POSNBR
     C   55              Z-ADD     2             LINNBR
     C   55              Z-ADD     26            POSNBR
     C   98              Z-ADD     2             LINNBR
     C   98              Z-ADD     10            POSNBR
     C   99              Z-ADD     1             LINNBR
     C   99              Z-ADD     72            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVW2         BEGSR
     C***********************************************
N02  C                   IF        WSSOK = *BLANKS
N02  C                   EVAL      WSSOK = WSEXTR
N02  C                   END
     C     WSTDN         IFEQ      0
     C                   MOVE      UPRO2         WSPRO
     C                   MOVE      *ZEROS        WSDDTK
     C                   MOVE      *BLANKS       WSDATS
S02  C*                  MOVE      *BLANKS       WSDKAV
S02  C*                  MOVE      *BLANKS       WSDKSK
     C                   ELSE
     C                   MOVE      THPRO         WSPRO
     C                   MOVE      THDDTK        WSDDTK
     C                   MOVE      THDATS        WSDATS
S02  C*                  MOVE      THDKAV        WSDKAV
S02  C*                  MOVE      THDKSK        WSDKSK
     C                   END
     C                   MOVE      THDK          WSDK
     C                   MOVE      THKNA         WSKNA
     C                   MOVE      THNAA         WSNAA
     C                   MOVE      THADA1        WSADA1
     C                   MOVE      THPNA         WSPNA
     C                   MOVE      THPSA         WSPSA
     C                   MOVE      THLKA         WSLKA
     C                   MOVE      THSKA         WSSKA
     C                   MOVE      THTINA        WSTINA
     C                   MOVE      THKNS         WSKNS
     C                   MOVE      THNAS         WSNAS
     C                   MOVE      THADS1        WSADS1
     C                   MOVE      THPNS         WSPNS
     C                   MOVE      THPSS         WSPSS
     C                   MOVE      THLKS         WSLKS
     C                   MOVE      THSKS         WSSKS
     C                   MOVE      THTINS        WSTINS
     C                   MOVE      THKNK         WSKNK
     C                   MOVE      THNAK         WSNAK
     C                   MOVE      THADK1        WSADK1
     C                   MOVE      THPNK         WSPNK
     C                   MOVE      THPSK         WSPSK
     C                   MOVE      THLKK         WSLKK
     C                   MOVE      THSKK         WSSKK
     C                   MOVE      THTINK        WSTINK
     C                   MOVE      THBLK         WSBLK
     C                   MOVE      THLSD         WSLSD
     C                   MOVE      THLASD        WSLASD
     C                   MOVE      THLAS2        WSLAS2
     C                   MOVE      THALK         WSALK
     C                   MOVE      THTRM         WSTRM
     C                   MOVE      THTRMI        WSTRMI
     C                   MOVE      THTAID        WSTAID
     C                   MOVE      THTASK        WSTASK
     C                   MOVE      THTALK        WSTALK
     C                   MOVE      THTGID        WSTGID
     C                   MOVE      THTGSK        WSTGSK
     C                   MOVE      THTGLK        WSTGLK
     C                   MOVE      THSKFD        WSSKFD
     C                   MOVE      THCATS        WSCATS
     C                   MOVE      THTSD1        WSTSD1
     C                   MOVE      THTSD2        WSTSD2
     C                   MOVE      THTSD3        WSTSD3
     C                   MOVE      THTSD4        WSTSD4
     C                   MOVE      THTSD5        WSTSD5
     C                   MOVE      THTSD6        WSTSD6
     C                   MOVE      THTSD7        WSTSD7
     C                   MOVE      THTSD8        WSTSD8
     C                   MOVE      THTSB         WSTSB
     C                   MOVE      THDDT         WSDDT
     C                   MOVE      THDFKD        WSDFKD
     C                   MOVE      THDFSK        WSDFSK
     C                   MOVE      THDKR         WSDKR
     C                   MOVE      THDANT        WSDANT
     C                   MOVE      THGKD         WSGKD
     C                   MOVE      THGFT1        WSGFT1
     C                   IF        THGBL < 0
     C                   Z-SUB     THGBL         WSGBL
     C                   MOVE      *ZEROS        XSGBL            13 2
     C                   ELSE
     C                   MOVE      THGBL         WSGBL
     C                   MOVE      THGBL         XSGBL            13 2
     C                   END
     C                   MOVE      THGVK         WSGVK
     C                   MOVE      THGFT2        WSGFT2
     C                   MOVE      THGADK        WSGADK
     C                   MOVE      THGBGI        WSGBGI
     C                   MOVE      THGBGU        WSGBGU
     C                   MOVE      THKDC         WSKDC
     C                   MOVEL     THTSN1        WSTSN1
     C                   MOVEL     THTSN2        WSTSN2
     C                   MOVE      THLSTL        WSLSTL
     C                   MOVE      THVPOS        WSVPOS
     C                   MOVE      THNTK         WSNTK
     C                   MOVE      THVKB         WSVKB
     C                   MOVE      THDST         WSDST
     C                   MOVE      THDSK         WSDSK
     C     WSSG          CHAIN     SVTHA                              33
     C                   MOVEL     SVTH_NAMN     WSTARF
     C                   MOVE      THTRNR        WSTRNR
     C                   MOVE      THTRDT        WSTRDT
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVSVH        BEGSR
     C***********************************************
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      WSSG          THSG
     C                   MOVE      WSENKL        THENKL
     C                   MOVE      WSPRO         THPRO
     C                   MOVE      WSDDTK        THDDTK
     C                   MOVE      WSDK          THDK
     C                   MOVE      WSKNA         THKNA
     C                   MOVE      WSNAA         THNAA
     C                   IF        WSADA1 = *BLANKS
     C                   EVAL      THADA1 = '.'
     C                   ELSE
     C                   MOVE      WSADA1        THADA1
     C                   END
     C                   MOVE      WSPNA         THPNA
     C                   MOVE      WSPSA         THPSA
     C                   MOVE      WSLKA         THLKA
     C                   MOVE      WSSKA         THSKA
     C                   MOVE      WSTINA        THTINA
     C                   MOVE      WSKNS         THKNS
     C                   MOVE      WSNAS         THNAS
     C                   IF        WSADS1 = *BLANKS
     C                   EVAL      THADS1 = '.'
     C                   ELSE
     C                   MOVE      WSADS1        THADS1
     C                   END
     C                   MOVE      WSPNS         THPNS
     C                   MOVE      WSPSS         THPSS
     C                   MOVE      WSLKS         THLKS
     C                   MOVE      WSSKS         THSKS
     C                   MOVE      WSTINS        THTINS
     C                   MOVE      WSKNK         THKNK
     C                   MOVE      WSNAK         THNAK
     C                   IF        WSADK1 = *BLANKS
     C                   EVAL      THADK1 = '.'
     C                   ELSE
     C                   MOVE      WSADK1        THADK1
     C                   END
     C                   MOVE      WSPNK         THPNK
     C                   MOVE      WSPSK         THPSK
     C                   MOVE      WSLKK         THLKK
     C                   MOVE      WSSKK         THSKK
     C                   MOVE      WSTINK        THTINK
     C                   MOVE      WSBLK         THBLK
     C                   MOVE      WSLSD         THLSD
     C                   MOVE      WSLASD        THLASD
     C                   MOVE      WSLAS2        THLAS2
     C                   MOVE      WSALK         THALK
     C                   MOVE      WSTRM         THTRM
     C                   MOVE      WSTRMI        THTRMI
     C                   MOVE      WSTAID        THTAID
     C                   MOVE      WSTASK        THTASK
     C                   MOVE      WSTALK        THTALK
     C                   MOVE      WSTGID        THTGID
     C                   MOVE      WSTGSK        THTGSK
     C                   MOVE      WSTGLK        THTGLK
     C                   MOVE      WSSKFD        THSKFD
     C                   MOVE      WSCATS        THCATS
     C                   MOVE      WSTSD1        THTSD1
     C                   MOVE      WSTSD2        THTSD2
     C                   MOVE      WSTSD3        THTSD3
     C                   MOVE      WSTSD4        THTSD4
     C                   MOVE      WSTSD5        THTSD5
     C                   MOVE      WSTSD6        THTSD6
     C                   MOVE      WSTSD7        THTSD7
     C                   MOVE      WSTSD8        THTSD8
     C                   MOVE      WSTSB         THTSB
     C                   MOVE      WSDDT         THDDT
     C                   MOVE      WSDFKD        THDFKD
     C                   MOVE      WSDFSK        THDFSK
     C                   MOVE      WSDKR         THDKR
     C                   MOVE      WSDANT        THDANT
      * OPPDATER TOTAL PÅ GAMMEL GARANTI
     C  N33              IF        ((THGFT1 <> *BLANKS) AND
     C                             ((THGKD <= 1) OR
     C                               (THGKD >= 6)))
N10  C                   IF        THGBL > 0
     C     THGFT1        CHAIN     SVXGH                              30
     C  N30              EVAL      TGGBLB = TGGBLB - THGBL
     C  N30              UPDATE    SVXGHR
     C  N30              MOVE      THGBL         XSGBL            13 2
     C                   MOVE      '0'           *IN30
N10  C                   ENDIF
     C                   END
      * OPPDATER TOTAL PÅ NY GARANTI
     C                   IF        ((WSGFT1 <> *BLANKS) AND
     C                             ((WSGKD <= 1) OR
     C                               (WSGKD >= 6)))
N10  C                   IF        WSGBL > 0
     C     WSGFT1        CHAIN     SVXGH                              30
     C                   IF        *IN30 = *OFF
     C                   EVAL      TGGBLB = TGGBLB + WSGBL
     C                   UPDATE    SVXGHR
     C                   MOVE      THGBL         XSGBL            13 2
     C                   IF        TGGBLB > TGGBL
     C                   Z-ADD     100           XPRM
     C                   ELSE
     C     TGGBLB        DIV       TGGBL         XPRM              5 2
     C                   MULT      100           XPRM
     C                   END
     C                   IF        ((XPRM > TGPRM) AND (TGPRM <> 0))
     C                   EXFMT     SVX011D03
     C                   END
     C                   END
     C                   MOVE      '0'           *IN30
N10  C                   ENDIF
     C                   END
      *
     C                   MOVE      WSGBL         THGBL
     C                   MOVE      WSGVK         THGVK
     C                   MOVE      WSGKD         THGKD
     C                   MOVE      WSGFT1        THGFT1
     C                   MOVE      WSGFT2        THGFT2
     C                   MOVE      WSGADK        THGADK
     C                   MOVE      WSGBGI        THGBGI
     C                   MOVE      WSGBGU        THGBGU
     C                   MOVE      WSKDC         THKDC
     C                   MOVEL     WSTSN1        THTSN1
     C                   MOVEL     WSTSN2        THTSN2
     C                   MOVE      WSLSTL        THLSTL
     C                   MOVE      WSVPOS        THVPOS
     C                   MOVE      WSNTK         THNTK
     C                   MOVE      WSVKB         THVKB
     C                   MOVE      WSDST         THDST
     C                   MOVE      WSDSK         THDSK
     C                   MOVE      WSTARF        THTARF
     C                   MOVE      UWS           THWS
     C                   MOVE      WSTRNR        THTRNR
     C                   MOVE      WSTRDT        THTRDT
     C                   MOVE      '015'         THMF
     C                   MOVE      *ZEROS        THMP
     C                   MOVE      'J'           THPKL
     C                   MOVE      *BLANKS       TH0035
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSVH        BEGSR
     C***********************************************
     C     WSTDN         IFEQ      0
     C     UAVD          CHAIN     SVXSTD                             33
     C                   MOVE      THTDN         WSTDN
     C                   ADD       1             THTDN
     C                   UPDATE    SVXSTDR
     C                   END
      *
     C     SVHK          CHAIN     SVXH                               33
     C                   EXSR      MOVSVH
      *
     C                   MOVE      'E'           THST
     C   33              DO
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      WSSG          THSG
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           THDT
     C     UTYPE         IFEQ      'CPY'
     C     KAVD          ANDNE     0
     C                   EXSR      CPYSVV
     C                   MOVE      *ZEROS        KAVD
     C                   END
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *BLANKS       THTUID
     C                   END
     C                   Z-ADD     1             THTET
     C                   CALL      'SVG001R'
     C                   PARM                    U_THTUID         10
     C                   MOVE      UYEAR         XÅR               2
     C                   EVAL      THTUID = 'SE' + XÅR + U_THTUID
     C                   EVAL      THSGME = 'SD'
     C                   MOVEL     SVTH_ANNN     THSGID
     C                   WRITE     SVXHR
N02   *
N02   * OPPDATER Z-FIL
N02   *
N02  C                   IF        ((Z_THREFF<>*BLANKS) AND (Z_THUNIK <> 0))     2<-B
N02  C     ZSVXHK        CHAIN     ZSVXHL01                           33
N02  C                   IF        *IN33 = *OFF                                   3<-B
N02  C                   MOVE      'O'           Z_THST
N02  C                   MOVE      THAVD         Z_THAVD
N02  C                   MOVE      THTDN         Z_THTDN
N02  C                   MOVE      THDT          Z_THDT
N02  C                   UPDATE    ZSVXHR
N02  C                   END                                                      3<-E
N02  C                   MOVE      '1'           *IN33
N02  C                   END                                                     2<-E
      *
     C                   END
     C  N33              IF        THTUID = *BLANKS
     C                   CALL      'SVG001R'
     C                   PARM                    U_THTUID
     C                   MOVE      UYEAR         XÅR
     C                   EVAL      THTUID = 'SE' + XÅR + U_THTUID
     C                   END
N03  C  N33              EVAL      THSGME = 'SD'
N03  C  N33              MOVEL     SVTH_ANNN     THSGID
     C  N33              UPDATE    SVXHR
      *
     C     WSLSTL        IFEQ      0
     C     SVHK          SETLL     SVXHL
     C     SVHK          READE     SVXHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVXHLR
     C     SVHK          READE     SVXHL                                  33
     C  N33              END
     C                   END
N02   *
N02   * FOR DE SOM REGISTRERER EGEN REF
N02   *
N02  C                   IF        ((THEKST = 'R') AND (WSEXTR <> 'WSSOK'))
N02  C     FRISOKK2      CHAIN     FRISOK                             33
N02  C                   EVAL      FSSOK = WSSOK
N02  C                   IF        *IN33
N02  C                   EVAL      FSAVD  = THAVD
N02  C                   EVAL      FSOPD  = THTDN
N02  C                   EVAL      FSKODE = WSKODE
N02  C                   EVAL      FSSOK  = WSSOK
N02  C                   EVAL      FSDTOP = THDT
N02  C                   WRITE     FRISOKR
N02  C                   ELSE
N02  C                   EVAL      WSSOK  = WSEXTR
N02  C                   END
N02  C                   END
      *
     C   15              EXSR      TILKOD
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYSVV        BEGSR
     C***********************************************
     C     SVHKK         CHAIN     SVXHFV                             33
     C                   IF        *IN33 = *OFF
     C                   MOVE      THAVD         FV_THAVD
     C                   MOVE      THTDN         FV_THTDN
     C                   WRITE     SVXHFVR
     C                   END
      *
     C     SVHK          SETLL     SVXHFS
     C     SVHK          READE     SVXHFS                                 33
     C     *IN33         IFEQ      '1'
     C     SVHKK         SETLL     SVXHFS
     C     SVHKK         READE     SVXHFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TFAVD
     C                   MOVE      THTDN         TFTDN
     C                   WRITE     SVXHFSR
     C     SVHKK         READE     SVXHFS                                 33
     C  N33              ENDDO
     C                   END
      *
     C     SVHK          SETLL     SVXHL
     C     SVHK          READE(N)  SVXHL                                  33
     C     *IN33         IFEQ      '1'
     C     SVHKK         SETLL     SVXHL
     C     SVHKK         READE(N)  SVXHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TLAVD
     C                   MOVE      THTDN         TLTDN
     C                   WRITE     SVXHLR
     C     SVHKK         READE(N)  SVXHL                                  33
     C  N33              ENDDO
     C                   END
      *
     C     SVHK          SETLL     SVXHGB
     C     SVHK          READE     SVXHGB                                 33
     C     *IN33         IFEQ      '1'
     C     SVHKK         SETLL     SVXHGB
     C     SVHKK         READE     SVXHGB                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TGAVD
     C                   MOVE      THTDN         TGTDN
     C                   WRITE     SVXHGBR
     C     SVHKK         READE     SVXHGB                                 33
     C  N33              ENDDO
     C                   END
      *
     C     SVHK          SETLL     SVXHGN
     C     SVHK          READE     SVXHGN                                 33
     C     *IN33         IFEQ      '1'
     C     SVHKK         SETLL     SVXHGN
     C     SVHKK         READE     SVXHGN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TGAVD
     C                   MOVE      THTDN         TGTDN
     C                   WRITE     SVXHGNR
     C     SVHKK         READE     SVXHGN                                 33
     C  N33              ENDDO
     C                   END
      *
     C     SVHKK         SETLL     SVXV
     C     SVHKK         READE     SVXV                                   33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVR
     C     SVHKK         READE     SVXV                                   33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVFV
     C     SVHKK         READE     SVXVFV                                 33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      THAVD         FV_TVAVD
     C                   MOVE      THTDN         FV_TVTDN
     C                   WRITE     SVXVFVR
     C     SVHKK         READE     SVXVFV                                 33
     C                   ENDDO
      *
     C     SVHKK         SETLL     SVXVAM
     C     SVHKK         READE     SVXVAM                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVAMR
     C     SVHKK         READE     SVXVAM                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVCN
     C     SVHKK         READE     SVXVCN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVCNR
     C     SVHKK         READE     SVXVCN                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVDK
     C     SVHKK         READE     SVXVDK                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVDKR
     C     SVHKK         READE     SVXVDK                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVFS
     C     SVHKK         READE     SVXVFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVFSR
     C     SVHKK         READE     SVXVFS                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVMN
     C     SVHKK         READE     SVXVMN                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVMNR
     C     SVHKK         READE     SVXVMN                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVTD
     C     SVHKK         READE     SVXVTD                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVTDR
     C     SVHKK         READE     SVXVTD                                 33
     C  N33              ENDDO
      *
     C     SVHKK         SETLL     SVXVVT
     C     SVHKK         READE     SVXVVT                                 33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      THAVD         TVAVD
     C                   MOVE      THTDN         TVTDN
     C                   WRITE     SVXVVTR
     C     SVHKK         READE     SVXVVT                                 33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     TOSVV         BEGSR
     C***********************************************
      *
     C                   MOVE      *IN27         UIN27
N02  C                   MOVE      UZREFF        U2REFF
N02  C                   MOVE      UZUNIK        U2UNIK
     C                   CALL      'SVX012R'
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C     *IN27         IFEQ      '0'
     C                   MOVE      *ZEROS        WSVPOS
     C                   MOVE      *ZEROS        WSVKB
     C                   MOVE      *ZEROS        WSNTK
     C     SVHK          SETLL     SVXV
     C     SVHK          READE     SVXV                                   33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             WSVPOS
     C                   ADD       TVVKTB        WSVKB
     C     TVNT          IFEQ      0
     C                   ADD       TVNTEH        WSNTK
     C                   ELSE
     C                   ADD       TVNT          WSNTK
     C                   END
     C     TVEH          IFEQ      'VQ'
     C     TVEH          OREQ      'VG'
     C     TVEH          OREQ      'VL'
     C     TVEH          OREQ      'VY'
     C     TVEH          OREQ      'VR'
     C     TVEH          OREQ      'VO'
     C                   ADD       1             WSNTK
     C                   END
     C     SVHK          READE     SVXV                                   33
     C  N33              ENDDO
      *
     C     SVHK          SETLL     SVXVMN
     C     SVHK          READE     SVXVMN                                 33
     C     *IN33         DOWEQ     '0'
     C     TVNT          IFEQ      0
     C                   ADD       TVNTEH        WSNTK
     C                   ELSE
     C                   ADD       TVNT          WSNTK
     C                   END
     C     TVEH          IFEQ      'VQ'
     C     TVEH          OREQ      'VG'
     C     TVEH          OREQ      'VL'
     C     TVEH          OREQ      'VY'
     C     TVEH          OREQ      'VR'
     C     TVEH          OREQ      'VO'
     C                   ADD       1             WSNTK
     C                   END
     C     SVHK          READE     SVXVMN                                 33
     C  N33              ENDDO
      *
     C     SVHK          CHAIN     SVXH                               33
     C                   MOVE      WSPRO         THPRO
     C     WSLSTL        IFNE      0
     C                   MOVE      *ZEROS        WSVPOS
     C     SVHK          SETLL     SVXHL
     C     SVHK          READE     SVXHL                                  33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             WSVPOS
     C     SVHK          READE     SVXHL                                  33
     C  N33              ENDDO
     C                   END
     C                   MOVE      WSVPOS        THVPOS
     C                   MOVE      WSVKB         THVKB
     C                   MOVE      WSNTK         THNTK
     C                   MOVE      ' '           THST
     C                   UPDATE    SVXHR
     C                   END
      *
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      2                                      17
     C     UFLAGG        COMP      3                                      03
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISTOL        BEGSR
     C***********************************************
      *________________________
      * Call på eksternt CL-pgm
      *""""""""""""""""""""""""
     C                   MOVE      '5'           WIN03             1
     C                   MOVE      THTDN         UTDN2             7 0
     C                   CALL      'SVX006R'
     C                   PARM                    UAVD
     C                   PARM                    UTDN2
     C                   PARM                    WIN03
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTSS        BEGSR
     C***********************************************
     C                   MOVE      WSKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C     *IN97         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     3             LINNBR
     C  N30              Z-ADD     13            POSNBR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNS
     C                   MOVEL     POSTNR        WSPNS
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNS
     C                   END
     C                   MOVE      ADR3          WSPSS
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKS
     C                   END
     C     WSTINS        IFEQ      *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        WSLKS = *BLANKS
     C                   EVAL      WSTINS = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINS = WSLKS + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINS = EORI
     C                   ENDSL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTKK        BEGSR
     C***********************************************
     C                   MOVE      WSKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            90
     C     *IN90         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     8             LINNBR
     C  N30              Z-ADD     13            POSNBR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNK
     C                   MOVEL     POSTNR        WSPNK
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNK
     C                   END
     C                   MOVE      ADR3          WSPSK
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKK
     C                   END
     C     WSTINK        IFEQ      *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        WSLKK = *BLANKS
     C                   EVAL      WSTINK = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINK = WSLKK + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINK = EORI
     C                   ENDSL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTAA        BEGSR
     C***********************************************
     C                   MOVE      WSKNA         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            81
     C     *IN81         IFEQ      '1'
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     13            LINNBR
     C  N30              Z-ADD     13            POSNBR
     C                   SETON                                        30
     C                   ELSE
     C                   MOVE      KNAVN         WSNAA
     C                   MOVE      ADR1          WSADA1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       WSPNA
     C                   MOVEL     POSTNR        WSPNA
     C                   ELSE
     C                   MOVEL     SYPOGE        WSPNA
     C                   END
     C                   MOVE      ADR3          WSPSA
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        WSLKA
     C                   END
     C     WSTINA        IFEQ      *BLANKS
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        WSLKA = *BLANKS
     C                   EVAL      WSTINA = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      WSTINA = WSLKA + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINA = EORI
     C                   ENDSL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SRU1          BEGSR
     C***********************************************
     C                   MOVE      UTDN          WSTDN
     C     SVHK          CHAIN     SVXH                               98
     C     *IN98         IFEQ      '0'
     C                   MOVE      'E'           THST
     C                   UPDATE    SVXHR
     C                   GOTO      SLSRU
     C                   END
      *
      * HENT STANDARDVERDIER FOR AVDELING
     C     SVSTDK        CHAIN(N)  SVXSTD                             98
     C  N98              MOVE      *BLANKS       THST
     C                   MOVE      *ZEROS        THGBL
N07  C                   MOVE      *ZEROS        THDDT
      * HENT FRA OPPDRAG
     C                   CLEAR                   HEADFR
     C                   CLEAR                   SVEHR
     C     HEADFK        CHAIN     HEADF                              98
     C     SVHK          CHAIN     SVEH                               33
     C   98
     CANN33              MOVE      '0'           *IN98
     C                   MOVE      *ZEROS        WSTDN
      *
     C  N98WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          WSSG
     C                   END
     C     THTARF        IFEQ      *BLANKS
     C     WSSG          CHAIN     SVTHA                              97
     C  N97              MOVE      SVTH_NAMN     THTARF
     C                   END
      *
      *** START N98
     C  N98              DO
      *
      *.................................................
      *** FLYTT DATA FRA HEADF TIL SVXH
      ** AVSENDER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   IF        *IN33
     C                   MOVE      HEKNS         THKNS
     C                   MOVE      HEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        THKNS
     C                   MOVE      HENAS         THNAS
     C                   MOVE      HEADS1        THADS1
     C                   IF        SVEH_AVPN = *BLANKS
     C                   MOVEL     HEADS3        THPNS
     C                   ELSE
     C                   MOVEL     SVEH_AVPN     THPNS
     C                   END
     C                   MOVEL     HEADS3        THPSS
     C                   ELSE
     C                   MOVE      KNAVN         THNAS
     C                   MOVE      ADR1          THADS1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       THPNS
     C                   MOVEL     POSTNR        THPNS
     C                   ELSE
     C                   MOVEL     SYPOGE        THPNS
     C                   END
     C                   MOVE      ADR3          THPSS
     C     SYLAND        IFEQ      *BLANKS
     C                   MOVE      FILAND        THLKS
     C                   ELSE
     C                   MOVE      SYLAND        THLKS
     C                   END
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        THLKS = *BLANKS
     C                   EVAL      THTINS = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      THTINS = THLKS + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      THTINS = EORI
     C                   ENDSL
     C                   END
     C     HEUR          IFNE      'H'
     C                   MOVE      HELKA         THBLK
     C                   ELSE
     C                   MOVE      HETRI         THBLK
     C                   END
     C                   ELSE
     C                   EVAL      THTINS = SVEH_AVEO
     C                   EVAL      THKNS  = SVEH_AVKN
     C                   EVAL      THNAS  = SVEH_AVNA
     C                   EVAL      THADS1 = SVEH_AVA1
     C                   EVAL      THPNS  = SVEH_AVPN
     C                   EVAL      THPSS  = SVEH_AVPA
     C                   EVAL      THLKS  = SVEH_AVLK
     C                   END
      *
      ** MOTTAKER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   IF        *IN33
     C                   MOVE      HEKNK         THKNK
     C                   MOVE      HEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        THKNK
     C                   MOVE      *BLANKS       THTINK
     C                   MOVE      HENAK         THNAK
     C                   MOVE      HEADK1        THADK1
     C                   IF        SVEH_MOPN = *BLANKS
     C                   MOVEL     HEADK3        THPNK
     C                   ELSE
     C                   MOVEL     SVEH_MOPN     THPNK
     C                   END
     C                   MOVEL     HEADK3        THPSK
     C                   MOVE      HELKK         THLKK
     C                   ELSE
     C                   MOVE      KNAVN         THNAK
     C                   MOVE      ADR1          THADK1
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       THPNK
     C                   MOVEL     POSTNR        THPNK
     C                   ELSE
     C                   MOVEL     SYPOGE        THPNK
     C                   END
     C                   MOVE      ADR3          THPSK
     C     SYLAND        IFNE      *BLANKS
     C                   MOVE      SYLAND        THLKK
     C                   END
     C                   SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        THLKK = *BLANKS
     C                   EVAL      THTINK = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      THTINK = THLKK + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      THTINK = EORI
     C                   ENDSL
     C                   END
     C                   ELSE
     C     CUND1K        CHAIN     CUNDL01                            97
     C  N97              SELECT
     C                   WHEN      EORI = *BLANKS
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))
     C                   IF        SYLAND = *BLANKS
     C                   EVAL      THTINK = 'SE' + SYFOR9
     C                   ELSE
     C                   EVAL      THTINK = SYLAND + SYFOR9
     C                   END
     C                   END
     C                   OTHER
     C                   EVAL      WSTINK = EORI
     C                   ENDSL
     C                   EVAL      THKNK  = SVEH_MOKN
     C                   EVAL      THNAK  = SVEH_MONA
     C                   EVAL      THADK1 = SVEH_MOA1
     C                   EVAL      THPNK  = SVEH_MOPN
     C                   EVAL      THPSK  = SVEH_MOPA
     C                   EVAL      THLKK  = SVEH_MOLK
     C                   END
      *
     C                   Z-ADD     HENT          THNTK
     C                   Z-ADD     HEVKT         THVKB
     C                   MOVE      HEPRO         THPRO
     C     SVEH_AUBE     IFNE      *BLANKS
     C                   MOVE      SVEH_AUBE     THBLK
     C                   END
     C     SVEH_TRGR     IFNE      *BLANKS
     C                   MOVEL     SVEH_TRGR     THTRM
     C                   END
     C     SVEH_TRID     IFNE      *BLANKS
     C     SVEH_TRLK     ORNE      *BLANKS
     C                   MOVEL     SVEH_TRID     THTGID
     C                   IF        SVEH_TRID = SVEH_TRAI
     C                   MOVE      SVEH_TRAL     THTGLK
     C                   ELSE
     C                   MOVE      SVEH_TRLK     THTGLK
     C                   END
     C                   MOVE      *BLANKS       THTGSK
     C                   MOVEL     SVEH_TRAI     THTAID
     C                   MOVE      SVEH_TRAL     THTALK
     C                   MOVE      *BLANKS       THTASK
     C                   END
     C                   MOVE      *ZEROS        THDDTK
     C                   MOVE      *BLANKS       THDATS
     C                   MOVE      *BLANKS       THDKAV
     C                   MOVE      *BLANKS       THDKSK
     C                   MOVE      UTDN          WSTDN
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          THSG
     C                   END
      *
     C                   END
      *
     C     SLSRU         TAG
     C                   SETOFF                                       9897
      *
     C                   ENDSR
      *
N02   ***********************************************
N02  C     HZFIL         BEGSR
N02   ***********************************************
N02  C                   MOVE      UZUNIK        Z_THUNIK
N02  C                   MOVE      UZREFF        Z_THREFF
N02   *
N02  C     ZSVXHK        CHAIN(N)  ZSVXHL01                           98
N02  C     *IN98         IFEQ      '0'                                          1<-B
N02  C                   IF        WSDK = *BLANKS                                2<-B
N02  C                   MOVE      Z_THDK        WSDK
N02  C                   END                                                     2<-E
N02  C                   IF        ((WSKNS = 0) AND (WSNAS = *BLANKS))           2<-B
N02  C                   MOVE      Z_THKNS       WSKNS
N02  C                   MOVE      Z_THNAS       WSNAS
N02  C                   MOVE      Z_THADS1      WSADS1
N02  C                   MOVE      Z_THPNS       WSPNS
N02  C                   MOVE      Z_THPSS       WSPSS
N02  C                   MOVE      Z_THLKS       WSLKS
N02  C                   MOVE      Z_THSKS       WSSKS
N02  C                   MOVE      Z_THTINS      WSTINS
N02  C                   END                                                     2<-E
N02  C                   IF        ((WSKNK = 0) AND (WSNAK = *BLANKS))           2<-B
N02  C                   MOVE      Z_THKNK       WSKNK
N02  C                   MOVE      Z_THNAK       WSNAK
N02  C                   MOVE      Z_THADK1      WSADK1
N02  C                   MOVE      Z_THPNK       WSPNK
N02  C                   MOVE      Z_THPSK       WSPSK
N02  C                   MOVE      Z_THLKK       WSLKK
N02  C                   MOVE      Z_THSKK       WSSKK
N02  C                   MOVE      Z_THTINK      WSTINK
N02  C                   END                                                     2<-E
N02  C                   IF        WSBLK = *BLANKS                               2<-B
N02  C                   MOVE      Z_THBLK       WSBLK
N02  C                   END                                                     2<-E
N02  C                   IF        WSLSD = *BLANKS                               2<-B
N02  C                   MOVE      Z_THLSD       WSLSD
N02  C                   END                                                     2<-E
N02  C                   IF        WSALK = *BLANKS                               2<-B
N02  C                   MOVE      Z_THALK       WSALK
N02  C                   END                                                     2<-E
N02  C                   IF        WSTRM = 0                                     2<-B
N02  C                   MOVE      Z_THTRM       WSTRM
N02  C                   END                                                     2<-E
N02  C                   IF        WSTAID = *BLANKS                              2<-B
N02  C                   MOVE      Z_THTAID      WSTAID
N02  C                   MOVE      Z_THTASK      WSTASK
N02  C                   MOVE      Z_THTALK      WSTALK
N02  C                   END                                                     2<-E
N02  C                   IF        WSTGID = *BLANKS                              2<-B
N02  C                   MOVE      Z_THTGID      WSTGID
N02  C                   MOVE      Z_THTGSK      WSTGSK
N02  C                   MOVE      Z_THTGLK      WSTGLK
N02  C                   END                                                     2<-E
N02  C                   IF        WSTSD1 = *BLANKS                              2<-B
N02  C                   MOVE      Z_THTSD1      WSTSD1
N02  C                   MOVE      Z_THTSD2      WSTSD2
N02  C                   MOVE      Z_THTSD3      WSTSD3
N02  C                   MOVE      Z_THTSD4      WSTSD4
N02  C                   MOVE      Z_THTSD5      WSTSD5
N02  C                   MOVE      Z_THTSD6      WSTSD6
N02  C                   MOVE      Z_THTSD7      WSTSD7
N02  C                   MOVE      Z_THTSD8      WSTSD8
N02  C                   END                                                     2<-E
N02  C                   IF        WSTSB = *BLANKS                               2<-B
N02  C                   MOVE      Z_THTSB       WSTSB
N02  C                   END                                                     2<-E
N02  C                   IF        WSKDC = *BLANKS                               2<-B
N02  C                   MOVE      Z_THKDC       WSKDC
N02  C                   END                                                     2<-E
N02  C                   END                                                    1<-E
N02   *
N02  C                   ENDSR
N02   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'L'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     SVHK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     SVH10K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UPRO2
     C     SVHKK         KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C     SVSTDK        KLIST
     C                   KFLD                    UAVD
     C     SVK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     SVXGDK        KLIST
     C                   KFLD                    WSGFT1
     C                   KFLD                    WSGADK
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     BILLK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     SVTKDK        KLIST
     C                   KFLD                    SVKD_IE
     C                   KFLD                    SVKD_TYP
     C                   KFLD                    SVKD_KD
     C     KODS4K        KLIST
     C                   KFLD                    XS4UNI
     C                   KFLD                    WSTRM
     C     KODS4KI       KLIST
     C                   KFLD                    XS4UNI
     C                   KFLD                    WSTRMI
     C     TVINMK        KLIST
     C                   KFLD                    YST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     TVIM4K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     TVI41K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
N01  C     SYPARL1K      KLIST
N01  C                   KFLD                    WSKNK
N01  C                   KFLD                    SYPAID
N01  C                   EVAL      SYPAID = 'TETBS'
N02  C     SVHKFRI       KLIST
N02  C                   KFLD                    FSAVD
N02  C                   KFLD                    FSOPD
N02  C     FRISOL01K     KLIST
N02  C                   KFLD                    WSKODE            3
N02  C                   KFLD                    WSEXTR
S04  C*                  MOVEL     '*CR'         WSKODE
N04  C                   MOVEL     '*CN'         WSKODE
N02  C     FRISOKK1      KLIST
N02  C                   KFLD                    UAVD
N02  C                   KFLD                    WSTDN
N02  C                   KFLD                    WSKODE            3
N02  C     FRISOKK2      KLIST
N02  C                   KFLD                    THAVD
N02  C                   KFLD                    THTDN
N02  C                   KFLD                    WSKODE            3
N02  C     ZSVXHK        KLIST
N02  C                   KFLD                    Z_THREFF
N02  C                   KFLD                    Z_THUNIK
      *
     C     *LIKE         DEFINE    THTDN         UTDN
     C     *LIKE         DEFINE    THPRO         UPRO
     C     *LIKE         DEFINE    THPRO         UPRO2
     C     *LIKE         DEFINE    THSG          USG
     C     *LIKE         DEFINE    THWS          UWS
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     WSTDN         PARM      WSTDN         UTDN
     C     UPRO2         PARM                    UPRO
     C     WSSG          PARM                    USG
     C                   PARM                    UTYPE             3
     C     UWS2          PARM      UWS2          UWS
     C                   PARM                    UFLAGG            1 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C                   MOVE      *ZEROS        THAVD
     C                   MOVE      *ZEROS        THTDN
     C                   MOVE      *BLANKS       BLUR
     C                   MOVE      '0'           UIN27
     C                   MOVE      *ZEROS        THVKB
     C                   MOVE      *BLANKS       U1N07
      *
     C     UTYPE         IFEQ      'CSL'
     C                   MOVE      UAVD          THAVD
     C                   MOVE      WSTDN         THTDN
     C                   MOVE      '014'         U1N07
     C                   CALL      'SVX013R'
S06  C*                  PARM      UPARM2        UPARM1
N06  C                   PARM                    UAVD
N06  C                   PARM                    WSTDN
N06  C                   PARM                    U1N07
     C                   PARM                    UFLAGG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C     UTYPE         IFEQ      'PRT'
     C     SVHK          CHAIN     SVXH                               31
     C  N31              DO
     C                   MOVE      UWS           THWS
     C                   MOVE      'K'           THST
     C                   MOVE      'J'           THPKL
     C                   MOVE      ' '           TH0035
     C                   UPDATE    SVXHR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   END
      *
     C     UPRO2         IFNE      0
     C     SVH10K        SETLL     SVXH10
     C     SVH10K        READE     SVXH10                                 33
     C     *IN33         DOWEQ     '0'
     C     THLSTL        IFGT      0
     C                   MOVE      THTDN         UTDN
     C                   MOVE      THTDN         WSTDN
     C                   MOVE      *ZEROS        UPRO2
     C                   MOVE      'CHG'         UTYPE
     C                   LEAVE
     C                   END
     C     SVH10K        READE     SVXH10                                 33
     C  N33              ENDDO
     C                   END
      *
     C     UTYPE         COMP      'DSP'                                  27
     C     UTYPE         COMP      'CHG'                                  31
     C     UTYPE         COMP      'CHG'                                  32
     C  N32UTYPE         COMP      'CPY'                                  32
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      WSTDN         KTDN              7 0
     C                   MOVE      *ZEROS        WSTDN
     C                   END
      *
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        KUNDNR            8 0
     C                   MOVE      'GCY'         SVKD_TYP
     C                   MOVE      'A'           SVKD_IE
     C                   MOVE      'S4 '         XS4UNI            3
     C                   MOVE      ' '           YST               1
     C                   MOVE      '99999999'    MAX0B             8 0
     C                   MOVE      '999999'      MAX0C             6 0
     C                   MOVE      '99'          MAX0D             2 0
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      *ZEROS        WSDDT
     C                   MOVE      *ZEROS        WSTRDT
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      *ZEROS        THDDT
     C                   MOVE      *ZEROS        THTRDT
      *
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      'AVSENDER'    SOTXT1            8
S01  C*                  MOVE      'MOTTAKER'    SOTXT2            8
S01  C*                  MOVE      'H.ANSVAR'    SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UAVD          CHAIN(N)  SVXSTD                             33
N07  C                   IF        THDDT < 100
N07  C                   Z-ADD     THDDT         XANTDG
N07  C                   ELSE
N07  C                   MOVE      *ZEROS        XANTDG            3 0
N07  C                   END
N07  C                   MOVE      *ZEROS        THDDT
      *
     C                   MOVE      THENKL        WSENKL
     C     HEADFK        SETLL     HEADF
     C                   READ      HEADF                                  36
     C                   MOVE      *IN36         UIN36
N02   *
N02   * henteventuell externrefkode
N02   *
N02  C     FRISOKK1      CHAIN     FRISOK                             33
N02  C  N33              MOVEL     FSSOK         WSEXTR
N02  C     THEKST        COMP      'R'                                4444
      *
     C                   ENDSR
      *
      *
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * AVSENDER   ...
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C     WSKNS         ANDGT     0
     C                   MOVE      WSKNS         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * MOTTAGER   ...
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C     WSKNK         ANDGT     0
     C                   MOVE      WSKNK         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * HOVEDANSVARLIG   ...
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
     C     WSKNA         ANDGT     0
     C                   MOVE      WSKNA         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
      *
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR            8 0
     C                   PARM                    XSKMOT            8
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
      *
     C     SLVISO        ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '000'         *IN(37)
     C                   MOVEA     '00'          *IN(28)
     C                   MOVE      '0'           *IN35
      *** TEST OM SELGER OPPLYSNING. HVIS DET, SETT 37 PÅ
     C                   MOVE      WSKNS         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        37
      *
      *** TEST OM KJØPER OPPLYSNING. HVIS DET, SETT 38 PÅ
     C                   MOVE      WSKNK         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        38
      *
      *** TEST OM HOVEDANSVALIG OPPLYSNING. HVIS DET, SETT 39 PÅ
     C                   MOVE      WSKNA         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        39
      *** TEST OM FLERE LANDKODER PÅ GARANTIBEGRENSNING
     C     SVHK          SETLL     SVXHGB
     C     SVHK          READE     SVXHGB                                 33
     C  N33              SETON                                        28
      *** TEST OM FLERE FORSEGLINGSLINJER
     C     SVHK          SETLL     SVXHFS
     C     SVHK          READE     SVXHFS                                 33
     C  N33              SETON                                        29
      *** TEST OM FLERE FORSEGLINGSLINJER
     C     SVHK          SETLL     SVXHGN
     C     SVHK          READE     SVXHGN                                 33
     C  N33              SETON                                        35
      *
     C                   ENDSR
      *
