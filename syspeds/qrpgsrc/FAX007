      *
      ***********************************************************
      *** PROGRAM SKAL SENDE FAKTURA PÅ FAX                   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 32 35 38 51-56 58-69    ***
      ***                    74-78 80-87 89-99                ***
      ***********************************************************
     FFAXLK     IF   E           K DISK
     FHEADF     IF   E           K DISK
     FFAIN      IF   E           K DISK
     FFAK3      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     D XXX            UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT                   30     35  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  AF                   101    310  0
     D                                     DIM(35)
     D  UGN                  981    995
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  FAXNR                  1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     C*
     C                   EXSR      INIT
     C*
     C                   SETOFF                                       30
     C                   EXSR      TEST
     C   30              GOTO      SLUTT
     C                   EXSR      SNDFAX
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TEST          BEGSR
     C***********************************************
     C                   Z-ADD     1             XN                2 0
     C*
     C                   MOVE      UUUFAK        YFN
     C     FAINK         CHAIN     FAIN                               30
     C  N30HEADFK        CHAIN     HEADF                              30
     C  N30HEST          COMP      ' '                                    30
     C   30              GOTO      SLTB
     C*
     C* KALLER SYFA20
     C*
     C  N30              DO
     C                   MOVE      'F'           FA00              1
     C     FAKEY         SETLL     FAK3
     C     FAKEY         READE     FAK3                                   32
     C   32              MOVE      'G'           FA00              1
     C   32FAKEY         SETLL     FAK3
     C   32FAKEY         READE     FAK3                                   32
     C   32              MOVE      'O'           FA00              1
     C   32FAKEY         SETLL     FAK3
     C   32FAKEY         READE     FAK3                                   32
     C  N32              DO
     C     KUNDNR        IFEQ      *ZEROS
     C                   MOVE      FAKUNR        KUNDNR
     C                   END
     C     KUKEY         CHAIN     CUNDL01                            31
     C  N31WSLAND        IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSLAND            2
     C                   END
     C  N31FAXNR         IFEQ      *BLANKS
     C                   MOVE      TFAXNR        FAXNR
     C                   END
     C  N31FAXNR         IFEQ      *BLANKS
     C                   SETON                                        30
     C   30              GOTO      SLTB
     C                   END
     C                   END
     C                   END
     C     WSLAND        IFNE      *BLANKS
     C     WSLAND        CHAIN     FAXLK                              33
     C     FAX05A        IFEQ      FAX05B
     C                   MOVE      *BLANKS       FAXRET
     C                   END
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *LIKE         DEFINE    FAFAKT        YFN
     C     *DTAARA       DEFINE    *LDA          XXX
     C     *ENTRY        PLIST
     C                   PARM                    PP1               2
     C                   PARM                    PP2               1
     C                   PARM                    PP3               1
     C                   PARM                    PP4               1
     C                   PARM                    PP5               1
     C                   PARM                    PP6               1
     C                   PARM                    PP7               1
     C                   PARM                    UUUFAK            7
     C     FAINK         KLIST
     C                   KFLD                    YFN
     C     FAKEY         KLIST
     C                   KFLD                    FA00
     C                   KFLD                    YFN
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     KUKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C                   READ      FIRM                                   44
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
     C     FAXRET        IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     FAXNR         FAXNRP
     C                   END
     C                   MOVE      *ZEROS        AF
     C                   MOVE      UUUFAK        AF(1)
     C                   MOVE      'N'           UBBS
     C                   SETON                                        LR
     C                   OUT       XXX
     C*
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C                   MOVE      'O'           UUKODE            1
     C                   MOVEL     'FAKTURA'     DOKNAV           12
     C                   MOVE      FAAVD         FAXAVD            4
     C                   MOVE      FAOPD         FAXOPD            7
     C                   MOVEL     'SYFA20P '    FILEN            10
     C     HEUR          IFEQ      'F'
     C     HEUR          OREQ      'G'
     C                   MOVEL     'SYFA20PS'    FILEN            10
     C                   END
     C                   CALL      'FAX002CL'
     C                   PARM                    FAXNRP
     C                   PARM                    FILEN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    KNAVN
     C                   PARM                    FAXAVD
     C                   PARM                    FAXOPD
     C                   PARM                    UUKODE
     C                   PARM                    DOKNAV
     C                   PARM                    PP1               2
     C                   PARM                    PP2               1
     C                   PARM                    PP3               1
     C                   PARM                    PP4               1
     C                   PARM                    PP5               1
     C                   PARM                    PP6               1
     C                   PARM                    PP7               1
     C                   MOVE      *BLANKS       WSLAND
     C                   MOVE      *BLANKS       FAXRET
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVE      *BLANKS       FAXNR
     C                   MOVE      *ZEROS        KUNDNR
     C                   ENDSR
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
