             PGM        PARM(&Æ001 &Æ002 &Æ003 &Æ004 &Æ005 &Æ006 +
                          &Æ007 &Æ008 &Æ009 &Æ010)
        /*___________*/
        /* VARIABLER */
        /*"""""""""""*/
             DCL        VAR(&Æ001) TYPE(*CHAR) LEN(1) /* SND/RCV */
             DCL        VAR(&Æ002) TYPE(*CHAR) LEN(8) /* ACCOUNT SRC */
             DCL        VAR(&Æ003) TYPE(*CHAR) LEN(8) /* USERID SRC */
             DCL        VAR(&Æ004) TYPE(*CHAR) LEN(8) /* PASSWORD SRC */
             DCL        VAR(&Æ005) TYPE(*CHAR) LEN(8) /* ACCOUNT TAR */
             DCL        VAR(&Æ006) TYPE(*CHAR) LEN(8) /* USERID TAR */
             DCL        VAR(&Æ007) TYPE(*CHAR) LEN(1) /* STATUS +
                          '0'=OK   '2'=NOK passw exp     '3'=NOK */
             DCL        VAR(&Æ008) TYPE(*CHAR) LEN(10) /* LIBRARY */
             DCL        VAR(&Æ009) TYPE(*CHAR) LEN(10) /* FILE */
             DCL        VAR(&Æ010) TYPE(*CHAR) LEN(10) /* MEMBER */
             DCL        VAR(&Æ011) TYPE(*CHAR) LEN(80) /* Host msg */
             DCL        VAR(&DEVNAM) TYPE(*CHAR) LEN(10) /* SkjermID +
                          for å sende melding */
             DCL        VAR(&STRPOS) TYPE(*DEC) LEN(3) VALUE(2) /* +
                          Startposisjon for å lese datarea: EDIDTA */
             DCL        VAR(&COUNT) TYPE(*DEC) LEN(1) VALUE(0)
        /*______________*/
        /* OVERSTYR FIL */
        /*""""""""""""""*/
             RCLRSC
             OVRDBF     FILE(ENITF) TOFILE(&Æ008/&Æ009) MBR(&Æ010) +
                          FRCRATIO(1) NBRRCDS(1) LVLCHK(*NO) +
                          SEQONLY(*YES 1)
        /*_____________*/
        /* SND/RCV FIL */
        /*"""""""""""""*/
SND:         CALL       PGM(E071R) PARM(&Æ001 &Æ002 &Æ003 &Æ004 +
                          &Æ005 &Æ006 &Æ007 &Æ011)
             CHGVAR     VAR(&COUNT) VALUE(&COUNT + 1)
        /*_____________*/
        /* VELLYKKET ! */
        /*"""""""""""""*/
             IF         COND(&Æ007 *EQ '0') THEN(GOTO CMDLBL(END))
        /*__________________________*/
        /* MISSLYKKET, PRØV IGJEN ! */
        /*""""""""""""""""""""""""""*/
             IF         COND((&Æ007 *EQ '3') *AND (&COUNT *LT 9)) +
                          THEN(GOTO CMDLBL(SND))
        /*_________________________________________*/
        /* PASSORDBYTTE, SEND MELDING TIL SKJERMER */
        /*"""""""""""""""""""""""""""""""""""""""""*/
             IF         COND(&Æ007 *EQ '2') THEN(DO)
GETDEV:      RTVDTAARA  DTAARA(EDIDTA (&STRPOS 10)) RTNVAR(&DEVNAM)
             IF         COND(&DEVNAM *NE ' ') THEN(DO)
             SNDBRKMSG  MSG('Passordet hos NIT må byttes !') +
                          TOMSGQ(&DEVNAM)
             MONMSG     MSGID(CPF0000)
             CHGVAR     VAR(&STRPOS) VALUE(&STRPOS + 10)
             GOTO GETDEV
             ENDDO
             CALL       PGM(E073R) PARM(&Æ002 &Æ003 &Æ007 +
                          &Æ011)
             CHGVAR     VAR(&STRPOS) VALUE(2)
GETDEV2:     RTVDTAARA  DTAARA(EDIDTA (&STRPOS 10)) RTNVAR(&DEVNAM)
             IF         COND(&DEVNAM *NE ' ') THEN(DO)
             SNDBRKMSG  MSG(&Æ011) TOMSGQ(&DEVNAM)
             MONMSG     MSGID(CPF0000)
             CHGVAR     VAR(&STRPOS) VALUE(&STRPOS + 10)
             GOTO GETDEV2
             ENDDO
             ENDDO

 END:        RCLRSC
             ENDPGM
