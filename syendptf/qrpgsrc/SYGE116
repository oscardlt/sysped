     FTALLBOKF  IF   E           K DISK
     D                 DS
     D  ta                     1     13
     D                                     DIM(13)
     D  tat                    1     13
     c     *ENTRY        PLIST
     c                   parm                    lk                2
     c                   parm                    tall             13 2
     c                   parm                    boks            128
     c                   move      tall          tat
     c                   z-add     1             nr                2 0
      *
     c     tallvk        klist
     c                   kfld                    lk
     c                   kfld                    tallv
      * finner 1. ikke null verdi
     c                   do        13
     c     ta(nr)        ifeq      '0'
     c                   add       1             nr
     c                   else
     c                   goto      ut
     c                   end
     c                   enddo
     c     ut            tag
     c
     c     nr            ifeq      3
     c                   exsr      sr1
     c                   exsr      sr100
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      4
     c     ta(nr)        ifne      '0'
     c                   exsr      sr10
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      5
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   end
      * skriver millioner
     c                   exsr      sr1000000
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      6
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   exsr      sr100
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      7
     c     ta(nr)        ifne      '0'
     c                   exsr      sr10
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      8
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   exsr      sr1000
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      9
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   exsr      sr100
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      10
     c     ta(nr)        ifne      '0'
     c                   exsr      sr10
     c                   end
     c                   add       1             nr
     c                   end
      *
     c     nr            ifeq      11
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   end
     c                   add       1             nr
     c                   end
     c     ta(12)        ifne      '0'
     c     ta(13)        orne      '0'
     c     boks          cat       'point':0     boks
     c     ta(12)        ifne      '0'
     c                   exsr      sr10
     c                   end
     c                   end
     c                   seton                                        lr
     c                   return
      ********************************************************************************
     c     sr1           begsr
      ********************************************************************************
     c                   move      *zeros        tallv
     c                   move      ta(nr)        tallv            11 0
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c                   endsr
      ********************************************************************************
     c     sr10          begsr
      ********************************************************************************
      * 20-90
     c     ta(nr)        ifgt      '1'
     c                   move      *zeros        tallv
     c                   move      ta(nr)        tallv            11 0
     c                   mult      10            tallv
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c                   add       1             nr
     c     ta(nr)        ifne      '0'
     c                   exsr      sr1
     c                   end
     c     nr            ifeq      8
     c                   exsr      sr1000
     c                   end
     c                   else
      * 11-19
     c                   move      *zeros        tallv
     c                   move      ta(nr)        tallv            11 0
     c                   mult      10            tallv
     c                   add       1             nr
     c                   move      ta(nr)        tallv            11 0
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c     nr            ifeq      8
     c                   exsr      sr1000
     c                   end
     c                   end
     c                   endsr
      ********************************************************************************
     c     sr100         begsr
      ********************************************************************************
     c                   z-add     100           tallv
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c                   endsr
      ********************************************************************************
     c     sr1000        begsr
      ********************************************************************************
     c                   z-add     1000          tallv
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c                   endsr
      ********************************************************************************
     c     sr1000000     begsr
      ********************************************************************************
     c                   z-add     1000000       tallv
     c     tallvk        chain     tallbokf                           33
     c     boks          cat       bokstaver:0   boks
     c                   endsr
