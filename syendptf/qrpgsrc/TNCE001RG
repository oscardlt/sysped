     H debug(*yes)
      *
     FSVXH      IF   E           K DISK
     FSVXV      IF   E           K DISK
     FSVEH      IF   E           K DISK
     FSVTVK     IF   E           K DISK
     FSVXSTD    IF   E           K DISK
     c                   exsr      init
     c                   exsr      bergb0
     c                   seton                                        lr
     c                   return
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C     *entry        plist
     c                   parm                    uavd              4 0
     c                   parm                    utdn              7 0
     C                   parm                    UBEL             13 2
     C     SVXHKEY       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     UAVD          CHAIN     SVXSTD                             66
     C     SVXHKEY       CHAIN     SVXH                               66
     c                   endsr
      *********************************************************
     C     BERGB0        Begsr
      *********************************************************
     c                   setoff                                       66
     C                   MOVE      *ZEROS        XBEL1            11 0
     C                   MOVE      *ZEROS        XBEL1S           11 0
     c
     C     SvxhKey       setll     SVXV
     c     *in66         doweq     '0'
     C     SvxhKey       reade     SVXV                                   66
     c     *in66         ifeq      '0'
     c     SVXV_42C      ifne      0
     c                   add       svxv_42c      xbel1s
     c                   else
     c                   exsr      BERGB1
     c                   endif
     c                   endif
     c                   enddo
     C                   EVAL(H)   UBEL  = XBEL1S * THGPR / 100
     C                   DUMP
     c                   endsr
      *
      *********************************************************
     C     BERGB1        Begsr
      *********************************************************
     C     SVXVKEY       KLIST
     C                   KFLD                    TVAVD2
     C                   KFLD                    TVTDN2
     C     SVTVKK        KLIST
     C                   KFLD                    SVEH_VAKD
     C                   KFLD                    XSVVK_DTS
     C     *LIKE         DEFINE    SVVK_DTS      XSVVK_DTS
     C                   EVAL      XSVVK_DTS = 99999999
      * omregn
     C     SvxvKey       CHAIN     SVEH                               67
     c     *in67         ifeq      '0'
     C     SVTVKK        SETGT     SVTVK
     C     SVEH_VAKD     READPE    SVTVK                                  67
     C                   DOW       *IN66 = *OFF
     C                   IF        SVEH_SYDT>= SVVK_DTS
     C                   LEAVE
     C                   END
     C     SVEH_VAKD     READPE    SVTVK                                  67
     C                   ENDDO
     C                   IF        SVEH_VAKU = 0
     C                   EVAL(H)   XBEL1 = SVEH_FABL * SVVK_KRS / SVVK_OMR
     C                   ELSE
     C                   EVAL(H)   XBEL1 = SVEH_FABL * SVEH_VAKU / SVVK_OMR
     C                   END
     c                   end
     c                   add       xbel1         xbel1s
     c                   endsr
