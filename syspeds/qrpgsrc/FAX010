      *
     FCUNDC     IF   E             DISK
     FSTED2     IF   E           K DISK
     FSTED2D    IF   E           K DISK
     F                                     RENAME(STED2R:STED2DR)
     FKODTSF    IF   E           K DISK
     FKODTA     IF   E           K DISK
     FFAX010FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     FFAX010PF  O    E             PRINTER USROPN
     FFIRM      IF   E           K DISK
     FFAXAVT    IF   E           K DISK
     FFAXLK     IF   E           K DISK
     FFREETXT2  IF   E           K DISK
     FDOKEF     IF   E           K DISK
     FDOKUI     IF   E           K DISK
     FUNITL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FFHEADF    UF A E           K DISK    USROPN
     F                                     RENAME(HEADFR:HEADFR2)
     FFAXH      IF   E           K DISK
     FCUNDL01   UF   E           K DISK
     FKUNDL01   UF   E           K DISK
     F                                     RENAME(KUNDR:KUNDR2)
     FFAXTELL   UF A E           K DISK
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  USØKKN                 1     30
     D  USØKKO                 1      2
     D  URRN                   3     12
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D WSTEXT          DS
     D  WSLIN1                 1     80
     D  WSLIN2                81    160
     D  WSLIN3               161    240
     D  WSLIN4               241    320
     D  WSLIN5               321    400
     D  WSLIN6               401    480
     D  WSLIN7               481    560
     D  WSLIN8               561    640
     D  WSLIN9               641    720
     D                 DS
     D  WRI001                 1     70
     D  WRI002                71    140
     D  WRI003               141    210
     D  WRI004               211    280
     D  WRI005               281    350
     D  WRI006               351    420
     D  WRI007               421    490
     D  WRI008               491    560
     D  WRI009               561    630
     D  FT                     1    630
     D                                     DIM(9)
     D                 DS
     D  FRI001                 1     70
     D  FRI002                71    140
     D  FRI003               141    210
     D  FRI004               211    280
     D  FRI005               281    350
     D  FRI006               351    420
     D  FRI007               421    490
     D  FRI008               491    560
     D  FRI009               561    630
     D  FAT                    1    630
     D                                     DIM(9)
     D                 DS
     D  DNAVN                  1     50
     D  KNAVN                  1     30
     D  FRITXT                31     50
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  FAXNR                  1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyz')
     D epotxt          C                   CONST('Orderinformation    -
     D                                     via email')
     IKUNDR
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
     C                   EXSR      INIT
     C     KUNDNR        IFNE      *ZEROS
     C                   GOTO      FORT
     C                   END
     C     FEIL          TAG
     C                   MOVE      'M'           UUPAR1
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     FORT          TAG
     C*
     C   03              GOTO      SLUTT
     C*
     C*
     C* SØKING
     C*
     C   04              DO
     c                   move      *blanks       EPOFAX
     C     LINNBR        IFeq      9
     C     LO:UP         XLATE     EPOST         usok
     C                   CALL      'VCUNDC2R'
     C                   PARM                    FIFIRM
     C                   PARM                    USOK             30
     C                   PARM                    URRN2            10 0
     c                   parm                    epofax            1
     C     URRN2         IFNE      *ZEROS
     C                   MOVE      URRN2         URRN
     C                   MOVE      'KP'          USØKKO
     C                   END
     C                   else
     C     LINNBR        IFEQ      3
     C                   MOVE      *BLANKS       USØKKN
     C                   CALL      'SOEKKUN'
     C                   PARM                    KUNDNR
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   END
     C                   END
      *
      * RETUR MED KONTAKTPERS
      *
     C     USØKKO        IFEQ      'KP'
     C                   MOVE      URRN          RRN              10 0
     C     RRN           CHAIN     CUNDC                              31
     c     epofax        ifne      'E'
     C  N31              MOVEL     CFAX          FAXNR
     c                   else
     c                   move      *blanks       faxnr
     c                   end
     c     epofax        ifne      'F'
     C  N31              MOVEL     CEMAIL        EPOST
     c                   else
     c                   move      *blank        epost
     c                   end
     C  N31              MOVE      CCOMPN        KUNDNR
     C                   END
     C     LINNBR        IFEQ      7
     C                   CALL      'FAX005CL'
     C                   PARM                    MAPPE
     C                   GOTO      FEIL
     C                   END
     C     LINNBR        IFEQ      14
     C                   CALL      'FAX006CL'
     C                   GOTO      FEIL
     C                   END
     C                   END
      * N25=ÅPEN FOR X-PART / BIL.NR.
      * SLÅ AV X-PART/BILNR MODUS..
     C   08
     CANN25              DO
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   SETON                                        25
     C                   GOTO      FEIL
     C                   END
      *
     C* B I KODEFELT  - HENT BILNR FRA OPPDRAGET, SIMULER F9
     C     WSAM          IFEQ      'B'
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVEL     HEHAWB        KNAVN
     C                   MOVE      *ON           *IN09
     C                   MOVE      *OFF          *IN25
     C                   MOVE      ' '           WSAM
     C                   END
      * 09-TASTET NÅR DET ER ÅPENT FOR INPUT..
     C   09
     CANN25              DO
     C  N26              GOTO      FEIL                                           IKKE TRMOD
      * 09-TASTET I TR.MODUL. - UTFØR BILNR/FAXNR-SØK
     C                   MOVE      *BLANKS       TFAXNR
     C                   MOVE      *ZEROS        KUNDNR
     C                   MOVEL     KNAVN         UUSOEK           10
     C* HVIS BILNR ANGITT-SJEKK GYLDIGHET
     C     UUSOEK        IFNE      *BLANKS
     C     UUSOEK        CHAIN     UNITL01                            33
     C   33              MOVE      *BLANKS       UUSOEK
     C                   END
     C* GYLDIG BILNR IKKE GITT I KNAVN-LINJA - SØK I BILREGISTER
     C     UUSOEK        IFEQ      *BLANKS
     C                   CALL      'SYTR19'
     C                   PARM                    UUSOEK
     C                   END
     C* GYLDIG BILNR ER TILSTEDE- VIS EVT AUTOPLUKK FAXNR+TEKST
     C     UUSOEK        IFNE      *BLANKS
     C                   MOVE      'P'           UMODUS            1
     C                   CALL      'SYTR09'
     C                   PARM                    UUSOEK
     C                   PARM                    TFAXNR
     C                   PARM                    UTEXT            20
     C                   PARM                    UMODUS
     C*
     C     TFAXNR        IFNE      *BLANKS
     C                   MOVE      TFAXNR        FAXNR
     C                   MOVEL     UUSOEK        KNAVN
     C                   MOVE      UTEXT         KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *BLANKS       SYADR3
     C                   MOVE      *BLANKS       WSPART
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   END
     C                   END
     C                   GOTO      FEIL
     C                   END
     C*
      * SLÅ PÅ X-PART/BILNR MODUS
     C     *IN08         IFEQ      '1'
     C     *IN09         OREQ      '1'
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     42            POSNBR
     C                   SETOFF                                       25
     C                   GOTO      FEIL
     C                   END
     C*
     C   07              DO
     C                   CALL      'FAXSOK'
     C                   PARM                    BRUKER
     C                   GOTO      FEIL
     C                   END
     C     WSAM          IFNE      ' '
     C                   MOVE      *ZEROS        KUNDNR
     C                   SETOFF                                       25
     C     WSAM          IFEQ      'S'
     C                   MOVE      HENAS         KNAVN
     C                   MOVE      HEADS1        ADR1
     C                   MOVE      HEADS2        ADR2
     C                   MOVE      HEADS3        SYADR3
     C                   ELSE
     C                   MOVE      HENAK         KNAVN
     C                   MOVE      HEADK1        ADR1
     C                   MOVE      HEADK2        ADR2
     C                   MOVE      HEADK3        SYADR3
     C                   END
     C                   MOVE      ' '           WSAM
     C                   END
     C*
     C* TESTER BILDET
     C*
     C                   EXSR      TESTB1
     C   30              GOTO      FEIL
     C   11              DO
     C     WSTEXT        IFNE      *BLANKS
     C                   EXSR      PFAX
     C                   END
     C                   END
     C*
     C* SKRIVER DOKUMENT
     C*
     C* EDITER DOKUMENT
     C*
     C   06              DO
     C                   SETON                                        74
     C     FIFIRM        CHAIN     FAXTELL                            33
     C   33              Z-ADD     1             COUNTN
     C   33              WRITE     FAXTELLR
     C  N33              ADD       1             COUNTN
     C  N33              UPDATE    FAXTELLR
     C* CREERER DOKUMENT
     C                   MOVEL     'F'           DOKNA             8
     C                   MOVE      COUNTN        DOKNA
     C                   CALL      'FAX003CL'
     C                   PARM                    DOKNA
     C                   PARM                    TFAXNR
     C                   PARM                    DNAVN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    FAXSTD
     C                   PARM                    MAPPE
     C*                    EXSR BL
     C                   END
     C*
     C* SEND DOKUMENT
     C*
     C   10              DO
     C                   MOVE      'N'           GEN
     C* TILDELER DOKUMENTNAVN
     C     DOKNA         IFEQ      *BLANKS
     C     FAXSTD        IFNE      *BLANKS
     C                   MOVE      'J'           GEN               1
     C     FIFIRM        CHAIN     FAXTELL                            33
     C   33              Z-ADD     1             COUNTN
     C   33              WRITE     FAXTELLR
     C  N33              ADD       1             COUNTN
     C  N33              UPDATE    FAXTELLR
     C                   MOVEL     'F'           DOKNA             8
     C                   MOVE      COUNTN        DOKNA
     C                   ELSE
     C                   MOVE      'SHU0193'     MSGNR
     C                   SETON                                        30
     C                   GOTO      FEIL
     C                   END
     C                   END
     C*
     C* OPPDATERER FAXMOTTAGER
     C*
     C     HEAVD         IFNE      *ZEROS
     C     OPDKEY        CHAIN     FHEADF                             33
     C  N33              DO
     C                   MOVE      FAXNR         HEFAX
     C                   MOVE      *BLANKS       UFAX             21
     C                   MOVEL     HEFAX         UFAX
     C                   CALL      'FAX010C2'
     C                   PARM                    UFAX
     C                   MOVEL     UFAX          HEFAX
     C                   MOVE      KNAVN         FAXNA
     C                   MOVE      ADR1          FAXAD1
     C                   MOVE      ADR2          FAXAD2
     C                   MOVE      SYADR3        FAXAD3
     C                   MOVEA     FT            FAT
     C                   MOVE      WKPERS        FAXKON
     C                   UPDATE    HEADFR2
     C                   END
     C                   END
     C* SENDER AVGÅRDE FAXEN
     C                   CLOSE     FHEADF
     C* FIXER EVENTUELL RETNINGSNUMMER
     C     FAXRET        IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     FAXNR         FAXNRP
     C                   END
     C                   MOVE      'O'           UUKODE            1
     C                   MOVE      HEAVD         UUAVD             4
     C                   MOVE      HEOPD         UUOPD             7
     C                   MOVE      'N'           EPOSTJ            1
     C     EPOST         IFNE      *BLANKS
     C                   MOVEL     'MAIL'        FAXNRP
     C                   MOVEL     EPOST         KNAVN
     C                   MOVE      'J'           EPOSTJ
     C                   END
     C*EPOST COVERPAGE
     c                   movel     epotxt        cov01
     C                   CALL      'EPOCVP'
     C                   PARM                    COV01            40
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    FUNK              1
     C     FUNK          IFEQ      'A'
     C                   GOTO      FEIL
     C                   END
      *
     C                   CALL      'FAX004CL'
     C                   PARM                    DOKNA
     C                   PARM                    FAXNRP
     C                   PARM                    DNAVN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    FAXSTD
     C                   PARM                    MAPPE
     C                   PARM                    GEN
     C                   PARM                    KNAVN
     C                   PARM                    UUAVD
     C                   PARM                    UUOPD
     C                   PARM                    UUPRO             8
     C                   PARM                    UUKODE
     C                   PARM                    EPOST
     C                   PARM                    COV01            40
     C                   PARM                    COV02            40
     C                   PARM                    COV03            40
     C                   PARM                    COV04            40
     C                   PARM                    COV05            40
     C                   PARM                    COV06            40
     C                   PARM                    COV07            40
     C                   PARM                    COV08            40
     C                   PARM                    EPOSTJ
     C                   EXSR      BL
     C                   OPEN      FHEADF
     C                   END
     C     UUPAR1        IFNE      'A'
     C                   GOTO      FEIL
     C                   END
     C*
     C     SLUTT         TAG
     C                   CLOSE     FHEADF
     C                   SETON                                        LR
     C                   RETURN
     C***********************************************
     C     PFAX          BEGSR
     C***********************************************
     C                   OPEN      FAX010PF
     C                   WRITE     HEADER
     C                   CLOSE     FAX010PF
     C                   CALL      'FAX002CL'
     C                   PARM                    TFAXNR
     C                   PARM                    PRINA
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   EXSR      BL
     C                   ENDSR
     C***********************************************
     C     BL            BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        KUNDNR
     C                   MOVE      *BLANKS       KNAVN
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *BLANKS       ADR3
     C                   MOVE      *BLANKS       WKPERS
     C                   MOVE      *ZEROS        POSTNR
     C                   MOVE      'SHU0171'     MSGNR
     C                   MOVE      *BLANKS       WSTEXT
     C                   MOVE      *BLANKS       FAXSTD
     C                   MOVE      DOKNA         DOKNAO
     C                   MOVE      *BLANKS       DOKNA
     C                   SETON                                        30
     C                   ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   SETOFF                                       713073
     C*
     C* HENT FAXSTANDARD
     C*
     C     FAXSTD        IFEQ      *BLANKS
     C                   EXSR      FAXSSS
     C                   END
     C*
     C   25              DO
     C     KUNKEY        CHAIN(N)  CUNDL01                            70
     C   70              MOVE      'SPK0001'     MSGNR
     C   70              SETON                                        30
     C  N70WSLAND        IFEQ      *BLANKS
     C                   MOVE      SYLAND        WSLAND
     C                   END
     C  N70WKPERS        IFEQ      *BLANKS
     C                   MOVE      KPERS         WKPERS
     C                   END
     C  N70
     CAN 74              MOVE      KPERS         WKPERS
     C                   SETOFF                                       74
     C  N70              DO
     C*
     C     POSTNR        IFNE      *ZEROS
     C                   MOVEL     POSTNR        SYADR3
     C                   MOVE      ADR3          SYADR3
     C                   ELSE
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          SYADR3
     C                   ELSE
     C                   MOVEL     SYPOGE        XXXX34           34
     C                   MOVE      ADR3          XXXX34
     C                   MOVEL     XXXX34        SYADR3
     C                   END
     C                   END
     C                   END
     C  N70FAXNR         IFEQ      *BLANKS
     C     EPOST         ANDEQ     *BLANKS
     C                   MOVEL     TFAXNR        FAXNR
     C                   MOVEL     syepos        epost
     C                   END
     C                   END
     C*
     C*
     C     FAXNR         IFEQ      *BLANKS
     C     EPOST         ANDEQ     *BLANKS
     C                   SETON                                        71
     C   71              MOVE      'SHU0165'     MSGNR
     C   71              SETON                                        30
     C                   END
      *
      * BÅDE FAX OG EPOST-ADRESSE LAGT INN
     C     FAXNR         IFNE      *BLANKS
     C     EPOST         ANDNE     *BLANKS
     C                   SETON                                        3071
     C   30              MOVE      'SHU0538'     MSGNR
     C                   END
      *
     C*
     C* OPPDATERER KUNDEREGISTER
     C*
     C   25              DO
     C  N30FAXNR         IFNE      *BLANKS
     C     TFAXNR        IFEQ      *BLANKS
     C     KUNKEY        CHAIN     CUNDL01                            33
     C  N33              MOVE      FAXNR         TFAXNR
     C  N33              EXCEPT    UPD
     C     KUNKEY        CHAIN     KUNDL01                            33
     C  N33              MOVE      FAXNR         TFAXNR
     C  N33              EXCEPT    UPD2
     C                   END
     C                   END
     C                   END
     C*
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C     WSTIME        IFNE      *ZEROS
     C     WSDATE        IFNE      *ZEROS
     C                   MOVE      *BLANKS       PTIME
     C                   MOVEL     *BLANKS       PDATE
     C                   MOVEL     WSTIME        PTIME
     C                   MOVEL     WSDATE        PDATE
     C                   END
     C                   END
     C  N30FAXSTD        IFNE      *BLANKS
     C                   CALL      'FAXOBJ'
     C                   PARM                    FAXSTD
     C                   PARM                    MAPPE
     C     FINS          PARM      FINS          FINS              1
     C     FINS          IFNE      'J'
     C                   SETON                                        3073
     C                   MOVE      'SHU0196'     MSGNR
     C                   END
     C                   END
     C     FRIKOD        IFNE      ' '
     C                   EXSR      FRI
     C                   END
     C                   MOVE      *BLANKS       FAXRET
     C     WSLAND        IFNE      *BLANKS
     C     WSLAND        CHAIN     FAXLK                              33
     C     FAX05A        IFEQ      FAX05B
     C                   MOVE      *BLANKS       FAXRET
     C                   END
     C                   END
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C                   SETON                                        25
     C     *ENTRY        PLIST
     C                   PARM                    KUNDNU            8 0
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    UUPAR1            1
     C                   PARM                    WSPART
     C                   PARM                    WSAM
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     AGKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNA
     C     SEKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNS
     C     KJKEY         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNK
     C     OPDKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     DOKEKE        KLIST
     C                   KFLD                    DOKUNI            1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      'F'           DOKUNI
     C     DOKUKE        KLIST
     C                   KFLD                    DIRI              1
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    DIFBNR
     C                   MOVE      'I'           DIRI
     C                   Z-ADD     1             DIFBNR
     C     KEYF          KLIST
     C                   KFLD                    LANDF             2
     C                   KFLD                    HESDF
     C     KEYT          KLIST
     C                   KFLD                    LANDT             2
     C                   KFLD                    HESDT
     C     KEYFF         KLIST
     C                   KFLD                    HELKS
     C                   KFLD                    HESDFF
     C     KEYVT         KLIST
     C                   KFLD                    HELKK
     C                   KFLD                    HESDVT
     C     KOKEY2        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'A'           XAUNI             1
     C     KODSFK        KLIST
     C                   KFLD                    XSFUNI
     C                   KFLD                    HESG
     C                   MOVE      'SF'          XSFUNI            2
     C*
     C                   MOVEL     'FAXSTD'      MAPPE            20
     C                   READ      FIRM                                   33
     C                   OPEN      FHEADF
     C     HEAVD         IFNE      *ZEROS
     C     OPDKEY        CHAIN     HEADF                              33
     C  N33              DO
     C     HEUR          COMP      'H'                                    26
     C*
     C* HENTER OM POSTNUMMERBASERT LØSNING
     C* I SÅ FALL BENYTTES LANDKODE I NØKKEL
     C* GJELDER IKKE VED FLY   C/D/E
     C*
     C     HEUR          IFNE      'C'
     C     HEUR          ANDNE     'D'
     C     HEUR          ANDNE     'E'
     C     KOKEY2        CHAIN     KOAR                               34
     C                   END
     C     KODSFK        CHAIN     KODTSF                             34
     C  N34              MOVEL     KOSFNV        XESG
     C     KOAPOS        IFEQ      'J'
     C                   MOVE      HELKA         LANDF
     C                   MOVE      FILAND        LANDT
     C     HEUR          IFEQ      'B'
     C     HEUR          OREQ      'D'
     C     HEUR          OREQ      'G'
     C                   MOVE      HELKA         LANDT
     C                   MOVE      FILAND        LANDF
     C                   END
     C     KEYF          CHAIN     STED2D                             34
     C  N34              MOVE      ST2NVN        XESDF
     C     KEYT          CHAIN     STED2D                             34
     C  N34              MOVE      ST2NVN        XESDT
     C     KEYFF         CHAIN     STED2D                             34
     C  N34              MOVE      ST2NVN        XESDFF
     C     KEYVT         CHAIN     STED2D                             34
     C  N34              MOVE      ST2NVN        XESDVT
     C                   ELSE
      *
     C* IKKE POSTNUMMERBASERT
      *
     C     HESDF         CHAIN     STED2                              34
     C  N34              MOVE      ST2NVN        XESDF
     C     HESDT         CHAIN     STED2                              34
     C  N34              MOVE      ST2NVN        XESDT
     C     HESDFF        CHAIN     STED2                              34
     C  N34              MOVE      ST2NVN        XESDFF
     C     HESDVT        CHAIN     STED2                              34
     C  N34              MOVE      ST2NVN        XESDVT
     C                   END
     C*
     C     HEKNA         IFNE      *ZEROS
     C     AGKEY         CHAIN(N)  CUNDL01                            33
     C  N33              DO
     C                   MOVE      KNAVN         AGNAVN
     C                   MOVE      ADR1          AGADR1
     C                   MOVE      ADR2          AGADR2
     C                   MOVE      TFAXNR        AGFAX
     C                   MOVE      TLF           AGTLF
     C     POSTNR        IFNE      *ZEROS
     C                   MOVEL     POSTNR        AGADR3
     C                   MOVE      ADR3          AGADR3
     C                   ELSE
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          AGADR3
     C                   ELSE
     C                   MOVEL     SYPOGE        XXXX34           34
     C                   MOVE      ADR3          XXXX34
     C                   MOVEL     XXXX34        AGADR3
     C                   END
     C                   END
     C                   END
     C                   END
     C     SEKEY         CHAIN(N)  CUNDL01                            33
     C  N33              DO
     C                   MOVE      TFAXNR        SEFAX
     C                   MOVE      TLF           SETLF
     C                   END
     C     KJKEY         CHAIN(N)  CUNDL01                            33
     C  N33              DO
     C                   MOVE      TFAXNR        KJFAX
     C                   MOVE      TLF           KJTLF
     C                   END
     C                   MOVE      'F'           FRIKOD            1
     C                   EXSR      FRI
     C     DOKEKE        CHAIN     DOKEF                              80
     C     DOKUKE        CHAIN     DOKUI                              80
     C                   MOVE      *BLANKS       UFAX             21
     C                   MOVEL     HEFAX         UFAX
     C                   CALL      'FAX010C2'
     C                   PARM                    UFAX
     C                   MOVEL     UFAX          HEFAX
     C                   WRITE     HEADFR2
     C                   END
     C                   END
     C                   MOVEL     'FAX010PF'    PRINA            10
     C     HODEK1        KLIST
     C                   KFLD                    SPRAAK
     C                   KFLD                    BRUKER           10
     C     HODEK2        KLIST
     C                   KFLD                    SPRAAK
     C                   KFLD                    DUM              10
     C* HENTER BRUKERID
     C                   MOVE      ZUSER         BRUKER
     C     HODEK1        CHAIN     FAXH                               33
     C   33HODEK2        CHAIN     FAXH                               33
     C                   MOVE      KUNDNU        KUNDNR
     C                   MOVE      *BLANKS       KNAVN
     C   26WSAM          IFEQ      'B'
     C     HEHAWB        IFNE      *BLANKS
     C                   MOVEL     HEHAWB        KNAVN
     C                   ELSE
     C                   MOVEL     ' '           WSAM
     C                   END
     C                   MOVE      *ON           *IN09
     C                   MOVE      *OFF          *IN25
     C                   END
     C                   MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       ADR2
     C                   MOVE      *BLANKS       ADR3
     C                   MOVE      *BLANKS       WKPERS
     C                   MOVE      *ZEROS        POSTNR
     C     UUPAR1        COMP      'A'                                    10
     C                   ENDSR
     C*****************************************************
     C     FRI           BEGSR
     C*****************************************************
     C                   MOVEA     *BLANKS       FT
     C                   Z-ADD     1             NR                2 0
     C     FRIKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FRIKOD
     C                   KFLD                    FRIFAK            7 0
     C     FRIKEY        SETLL     FREETXT2
     C     STF           TAG
     C     FRIKEY        READE     FREETXT2                               33
     C  N33              MOVE      FRTTXT        FT(NR)
     C  N33              ADD       1             NR
     C  N33NR            IFLT      10
     C                   GOTO      STF
     C                   END
     C                   ENDSR
     C*****************************************************
     C     FAXSSS        BEGSR
     C*****************************************************
     C                   MOVE      KUNDNR        FAXKNR
     C                   MOVE      WSPART        FAXTYP
     C     STTEST        TAG
     C                   MOVE      HEAVD         FAXAVD
     C                   MOVE      HEOT          FAXOPD
     C     FASTKE        KLIST
     C                   KFLD                    FAXKNR
     C                   KFLD                    FAXAVD
     C                   KFLD                    FAXOPD
     C                   KFLD                    FAXTYP
     C*
     C* KUNDE/AVD/OPDTYP
     C     FASTKE        CHAIN     FAXAVT                             33
     C  N33              GOTO      STMOV
     C* KUNDE/OPDTYP
     C                   MOVE      *ZEROS        FAXAVD
     C     FASTKE        CHAIN     FAXAVT                             33
     C  N33              GOTO      STMOV
     C* KUNDE/AVD
     C                   MOVE      HEAVD         FAXAVD
     C                   MOVE      *BLANKS       FAXOPD
     C     FASTKE        CHAIN     FAXAVT                             33
     C  N33              GOTO      STMOV
     C* KUNDE
     C                   MOVE      *ZEROS        FAXAVD
     C     FASTKE        CHAIN     FAXAVT                             33
     C  N33              GOTO      STMOV
     C*
     C* NY LØKKE HVIS KUNDE ULIK 0
     C*
     C     FAXKNR        IFNE      *ZEROS
     C                   MOVE      *ZEROS        FAXKNR
     C                   GOTO      STTEST
     C                   END
     C     FAXTYP        IFNE      *BLANKS
     C                   MOVE      *BLANKS       FAXTYP
     C                   MOVE      KUNDNR        FAXKNR
     C                   GOTO      STTEST
     C                   END
     C*
     C                   GOTO      FAXEND
     C     STMOV         TAG
     C                   MOVE      FAXDOC        FAXSTD
     C                   MOVE      FAXMAP        MAPPE
     C     FAXEND        ENDSR
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
     OKUNDR     E            UPD
     O                       TFAXNR
     OKUNDR2    E            UPD2
     O                       TFAXNR
