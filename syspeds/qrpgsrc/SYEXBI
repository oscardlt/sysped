      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE         ***
      ***                   BILL OF LADING                     ***
      *** INDIKATOR 27 PÅ = KOPIUTSKRIFT (KALLE FRA SYEX41CLK) ***
      ***           27 AV = ORG.UTSKRIFT (KALLE FRA SYEX41CL)  ***
      ************************************************************
     FFIRM      IF   E           K DISK
     FDOKEB     IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FSYEXBIFM  CF   E             WORKSTN
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UOP1                  22     28  0
     D  UOP2                  29     35  0
     D  UOP3                  36     42  0
     D  UOP4                  43     49  0
     D  UOP5                  50     56  0
     D  UOP6                  57     63  0
     D  UOP7                  64     70  0
     D  UOP8                  71     77  0
V10  D  UOPD                  82     88  0
     D* XBLA1/XBLA2 ER IKKE I BRUK. HVIS TAR NOEN POSISJONER TIL BRUK
     D* HUSK Å SYNKE STØRRELSE PÅ XBLA1/XBL2
     D  XBLA1                 78    256
     D  XBLA2                257    510
     D  UPRT26               581    590
     D  UPT26                591    600
     I*
     C*
     C     DOKEBK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    YOPD
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPLNR
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    YFUNI
     C                   KFLD                    WSSG
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UJBK              1
     C                   PARM                    UIN01             1
     C                   PARM                    UKOPI             1
     C                   PARM                    UANT              3 0
     C     UKOPI         COMP      'J'                                    27
     C                   MOVE      '0'           UIN01
     C                   MOVE      'N'           UJBK
     C*
     C                   MOVE      'P'           YPUNI             1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      'SF'          YFUNI             2
     C                   MOVE      *ZEROS        YOPD              7 0
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
V10  C                   MOVE      *ZEROS        UOPD
     C                   Z-ADD     1             WSANT
     C* BLANKE DE FELTENE SOM IKKE ER I BRUK
     C                   MOVE      *BLANKS       XBLA1
     C                   MOVE      *BLANKS       XBLA2
     C*
     C     FIFIRM        CHAIN     FIRM                               99
     C                   READ      FIRM                                   99
     C                   MOVE      FIFIRM        UFIRM
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     C                   MOVEA     '00000000'    *IN(90)
     C                   SETOFF                                       309998
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C  N99              Z-ADD     26            WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT26
     C  N99              MOVE      KOPTY         UPT26
     C   99              MOVE      'SPA0010'     MSGNR
     C   99              SETON                                        30
     C     WSSG          IFNE      'ALL'
     C     KODSFK        CHAIN     KODTSF                             98
     C   98
     CANN30              MOVE      'SPS0001'     MSGNR
     C   98              SETON                                        30
     C                   END
     C   27              DO
     C     WSOP1         IFNE      0
     C                   MOVE      WSOP1         YOPD
     C     DOKEBK        CHAIN     DOKEB                              97
     C   97
     CANN30              MOVE      'SPO0011'     MSGNR
     C   97              SETON                                        30
     C                   END
     C     WSOP2         IFNE      0
     C                   MOVE      WSOP2         YOPD
     C     DOKEBK        CHAIN     DOKEB                              92
     C   96
     CANN30              MOVE      'SPO0011'     MSGNR
     C   96              SETON                                        30
     C                   END
     C     WSOP3         IFNE      0
     C                   MOVE      WSOP3         YOPD
     C     DOKEBK        CHAIN     DOKEB                              95
     C   95
     CANN30              MOVE      'SPO0011'     MSGNR
     C   95              SETON                                        30
     C                   END
     C     WSOP4         IFNE      0
     C                   MOVE      WSOP4         YOPD
     C     DOKEBK        CHAIN     DOKEB                              94
     C   94
     CANN30              MOVE      'SPO0011'     MSGNR
     C   94              SETON                                        30
     C                   END
     C     WSOP5         IFNE      0
     C                   MOVE      WSOP5         YOPD
     C     DOKEBK        CHAIN     DOKEB                              93
     C   93
     CANN30              MOVE      'SPO0011'     MSGNR
     C   93              SETON                                        30
     C                   END
     C     WSOP6         IFNE      0
     C                   MOVE      WSOP6         YOPD
     C     DOKEBK        CHAIN     DOKEB                              92
     C   92
     CANN30              MOVE      'SPO0011'     MSGNR
     C   92              SETON                                        30
     C                   END
     C     WSOP7         IFNE      0
     C                   MOVE      WSOP7         YOPD
     C     DOKEBK        CHAIN     DOKEB                              91
     C   91
     CANN30              MOVE      'SPO0011'     MSGNR
     C   91              SETON                                        30
     C                   END
     C     WSOP8         IFNE      0
     C                   MOVE      WSOP8         YOPD
     C     DOKEBK        CHAIN     DOKEB                              90
     C   90
     CANN30              MOVE      'SPO0011'     MSGNR
     C   90              SETON                                        30
     C                   END
     C                   END
     C   30              GOTO      START
     C*
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSSG          USG
     C                   MOVE      WSOP1         UOP1
     C                   MOVE      WSOP2         UOP2
     C                   MOVE      WSOP3         UOP3
     C                   MOVE      WSOP4         UOP4
     C                   MOVE      WSOP5         UOP5
     C                   MOVE      WSOP6         UOP6
     C                   MOVE      WSOP7         UOP7
     C                   MOVE      WSOP8         UOP8
     C                   MOVE      WSJBK         UJBK
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT26
     C                   END
     C     UPRT26        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT26
     C                   END
     C     UPT26         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT26
     C                   END
     C     WSANT         IFEQ      *ZEROS
     C                   Z-ADD     1             WSANT
     C                   END
     C                   MOVE      WSANT         UANT
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
