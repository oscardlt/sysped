********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 POSISJON FLYTTING I UDS
10XXX * 02 JOV PTF10 manglende blanking av UDS opd/fbr
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 03 JOV PTF10 Edi-part def direkte på TRAN=send EDI via fr.br(syfa12/TG/LG...) ikke GodsL-EDI
********************************************************************
      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE UT      ***
      ***                   GODSLISTE INNLAND                  ***
      ************************************************************
      *
     FFIRM      IF   E           K DISK
     FTURER14   UF   E           K DISK
     FHEAD14    IF   E           K DISK
     FWRKAG     O  A E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTH     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FECMSG     IF   E           K DISK
     FTRAN      IF   E           K DISK
     FSYFAGIFM  CF   E             WORKSTN USROPN
     D                 DS
     D  SYFR05                 1      3
     D  SYSTAX                 1      1
     D                 DS
     D  TUXXX2                 1      4
     D  TUPLUT                 1      2
     D  TUPLIN                 3      4
     D                UDS
     D  UFIRM                  1      2
     D  KOVFIR                 3      4
     D  KOVPRO                13     13
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D* XBLA1/XBLA2 ER IKKE I BRUK. HVIS TAR NOEN POSISJONER TIL BRUK
     D* HUSK Å SYNKE STØRRELSE PÅ XBLA1/XBL2
     D  XBLA1                 30    256
     D  XBLA2                257    510
     D  CMR                   30     30
     D  INS1                  56     85
     D  STAR                  55     55
     D  ULKOD                 56     60
     D  LASGOD                61     61
     D  UNYE                  62     62
     D  UDATO                 64     69  0
S01  D* VED2                  86    115
S01  D* INS2                 116    145
S01  D* VED3                 146    175
S01  D* INS3                 176    205
S01  D* INS4                 206    235
S01  D* CFRANK               236    238
N02  D  UOPD                  82     88  0
N02  D  UFBNR                 89     91  0
N01  D  VED2                  96    125
N01  D  INS2                 126    155
N01  D  VED3                 156    185
N01  D  INS3                 186    215
N01  D  INS4                 216    245
N01  D  CFRANK               246    248
     D* SYINN 200689 - LEV.ADRESSE STYRES FRA BESTILLINGSBILDE
     D  LEV1                 265    294
     D  LEV2                 295    324
     D  LEV3                 325    354
     D  LEV4                 355    384
     D  CSTED                385    410
     D  CDATO                411    416  0
     D  VED1                 417    446
     D  UPRT6                721    730
     D  UPT6                 731    740
     D  UPRT8                761    770
     D  UPT8                 771    780
     D  UPRT9                781    790
     D  UPT9                 791    800
     D  UPRT10               801    810
     D  UPT10                811    820
     D  UPRT11               821    830
     D  UPT11                831    840
     D  UPRT12               841    850
     D  UPT12                851    860
     D  UPRT13               861    870
     D  UPT13                871    880
     D  UPRT67               921    930
     D  UPT67                931    940
     D  UPRT57               941    950
     D  UPT57                951    960
     D  BRUDDA               961    961
     I*
     C*
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    WSPLNR
     C     KODTWK        KLIST
     C                   KFLD                    WSWUNI
     C                   KFLD                    UAVD
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    UAVD
     C     KODTHK        KLIST
     C                   KFLD                    WSHUNI
     C                   KFLD                    UAVD
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    TUAVD
     C     KODSFK        KLIST
     C                   KFLD                    WSFUNI
     C                   KFLD                    USG
     C     TRAKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TUKNT2
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UIN03             1
     C                   PARM                    UIN01             1
     C                   PARM                    FAXJN             1
     C                   PARM                    FAXNR            15
     C                   PARM                    UUAVD             4
     C                   PARM                    UUTUR             8
     C                   PARM                    UBRUD             1
     C                   PARM                    EDIJN
     C                   PARM                    LISJN
     C                   PARM                    BELJN
     C                   PARM                    BELJN2
     C                   PARM                    WSSAML
     C                   PARM                    WSFRBR
     C                   PARM                    EDITR
      *
     C     UIN01         IFEQ      '1'
     C                   move      'J'           FRAPDA            1
     C                   else
     C                   open      SYFAGIFM
     C                   end
     C                   MOVE      '0'           UIN01
     C                   MOVE      'J'           BRUDDA
     C                   MOVE      'J'           LISJN
     C                   MOVE      'T'           BELJN
     C                   MOVE      'A'           BELJN2
     C*
     C                   MOVE      'P'           WSPUNI            1
     C                   MOVE      'W'           WSWUNI            1
     C                   MOVE      'V'           WSVUNI            1
     C                   MOVE      'H'           WSHUNI            1
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      'SF'          WSFUNI            2
     C                   MOVE      'J'           WSSAML            1
     C                   MOVE      'J'           WSFRBR            1
     C                   MOVE      ' '           EDITR             1
     C* BLANKE DE FELTENE SOM IKKE ER I BRUK
     C                   MOVE      *BLANKS       XBLA1
N02  C                   MOVE      *ZEROS        UOPD
N02  C                   MOVE      *ZEROS        UFBNR
     C                   MOVE      *ZEROS        UDATO
     C                   MOVE      *BLANKS       XBLA2
     C                   MOVE      '*'           STAR
     C                   MOVE      *BLANKS       ULKOD
     C                   MOVE      'G'           LASGOD
     C                   MOVE      ' '           UNYE
     C*
     C                   READ      FIRM                                   99
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      UUTUR         WSPRO
     C     WSPRO         IFNE      *ZEROS
     C                   EXSR      GETPRO
     C                   END
     C     FRAPDA        IFEQ      'J'
     C                   MOVE      'N'           WSKOPI
     C                   goto      skippbi
     C                   end
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     c                   Move      *off          *in96
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
      *
      * TURENS AVD BESTEMMER UAVD-> PRINTERVALG M.M.
     C     SKIPPBI       TAG
     C     WSPRO         CHAIN(N)  TURER14                            97
     C     FRAPDA        IFNE      'J'
     C   97              GOTO      START
     C                   end
     C                   MOVE      TUAVD         UAVD
     C                   MOVE      TUAVD         UUAVD
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C  N99KODTWK        CHAIN     KODTW                              99
     C  N99KODTHK        CHAIN     KODTH                              99
     C  N99              Z-ADD     22            WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT11
     C  N99              MOVE      KOPTY         UPT11
     C  N99              Z-ADD     23            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT12
     C  N99              MOVE      KOPTY         UPT12
     C  N99              Z-ADD     6             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT6
     C  N99              MOVE      KOPTY         UPT6
     C  N99              Z-ADD     8             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT8
     C  N99              MOVE      KOPTY         UPT8
     C  N99              Z-ADD     9             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT9
     C  N99              MOVE      KOPTY         UPT9
     C  N99              Z-ADD     10            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT10
     C  N99              MOVE      KOPTY         UPT10
     C  N99              Z-ADD     67            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT67
     C  N99              MOVE      KOPTY         UPT67
     C  N99              Z-ADD     57            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT57
     C  N99              MOVE      KOPTY         UPT57
     C     FRAPDA        IFNE      'J'
     C   99              GOTO      START
     C                   END
      * HENT TURVERDIER
     C     *IN02         IFEQ      '1'
     C     WSPRO         IFNE      *ZEROS
     C                   EXSR      GETPRO
     C                   GOTO      START
     C                   END
     C                   END
      * Kopi / original
     C     WSKOPI        IFNE      'J'
     C     WSKOPI        andne     'N'
     c                   Move      *on           *in96
     C                   GOTO      START
     c                   end
      * endre UDS-paramter - Ikke kopi - Øk versjonsnr
     C     WSKOPI        IFNE      'J'
     C                   MOVE      'V'           LASGOD
     c                   else
     C                   MOVE      'G'           LASGOD
     c                   end
      * HVIS EKSTRA PLL FYLT UT (OG IKKE AVREGNET FØR.. OPPDATER.)
     C     *IN50         IFEQ      '0'
     C     PLLEXT        ANDNE     *ZEROS
     C     WSPRO         CHAIN     TURER14                            97
     C                   MOVE      PLLEXT        TUPLUT
     C  N97              UPDATE    TURERR
     C                   END
     C*
     C* ALLE TESTER OK -
     C*
     C     EDIJN         IFEQ      'J'
     C                   MOVE      'J'           BRUDDA
     C                   END
     C*
     C                   MOVE      WSPRO         UPRO
     C                   MOVE      WSPRO         UUTUR
     C     KOHLS2        IFEQ      'L'                                                      TÅENDE')
     C                   MOVE      '0'           UIN03
     C                   ELSE
     C                   MOVE      '1'           UIN03
     C                   END
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT11
     C                   MOVE      WSPRT         UPRT12
     C                   END
     C     WSPRT2        IFNE      *BLANKS
     C                   MOVE      WSPRT2        UPRT6
     C                   END
     C*
     C     UPRT11        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT11
     C                   END
     C     UPT11         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT11
     C                   END
     C     UPRT12        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT12
     C                   END
     C     UPT12         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT12
     C                   END
     C     UPRT6         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT6
     C                   END
     C     UPT6          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT6
     C                   END
     C     UPRT8         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT8
     C                   END
     C     UPT8          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT8
     C                   END
     C     UPRT9         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT9
     C                   END
     C     UPT9          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT9
     C                   END
     C     UPRT10        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT10
     C                   END
     C     UPT10         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT10
     C                   END
     C     UPRT57        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT57
     C                   END
     C     UPT57         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT57
     C                   END
     C     UPRT67        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT67
     C                   END
     C     UPT67         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT67
     C                   END
     C*
     C     BRUDDA        IFEQ      'J'
     C     FAXJN         ANDEQ     'J'
     C     EDIJN         OREQ      'J'
     C                   EXSR      AGENT
     C                   END
     C     LISJN         IFNE      'J'
     C     BELJN         ANDEQ     'J'
     C                   MOVE      *BLANK        BELJN
     C                   ENDIF
     C     FAXJN         IFNE      'J'
     C     BELJN2        ANDEQ     'J'
     C                   MOVE      *BLANK        BELJN2
     C                   ENDIF
     C*
     C     SLUTT         TAG
     C                   MOVE      BRUDDA        UBRUD
     C     FRAPDA        IFNE      'J'
     C                   close     SYFAGIFM
     C                   end
     C                   SETON                                        LR
     C                   RETURN
     C*
     C*
     C***********************************************
     C     AGENT         BEGSR
     C***********************************************
     C     AGKE1         KLIST
     C                   KFLD                    WSPRO
     C                   KFLD                    HEKNA             8 0
     C                   MOVE      *ZEROS        HEKNA
     C     AGKE2         KLIST
     C                   KFLD                    WSPRO
     C     AGKE3         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNA             8 0
      *_______________
      * Brudd på Agent
      *"""""""""""""""
     C                   SELECT
     C     BRUDDA        WHENEQ    'J'
      *
     C     STAG          TAG
     C     AGKE1         SETLL     HEAD14
     C     AGKE2         READE     HEAD14                                 33
     C  N33              DO
     C     AGKE3         CHAIN     CUNDL01                            34
     C  N34              DO
     C                   MOVE      TFAXNR        AFAXNR
     C                   Z-ADD     TUAVD         WRAVD
     C                   Z-ADD     WSPRO         WRPRO
     C                   WRITE     WRKAGR
     C                   END
     C                   ADD       1             HEKNA
     C                   GOTO      STAG
     C                   END
      *____________________
      * Ikke brudd på Agent
      *""""""""""""""""""""
     C                   OTHER
      *
     C                   MOVE      TUKNA         HEKNA
     C     AGKE3         CHAIN     CUNDL01                            34
     C     *IN34         IFEQ      '0'
     C                   MOVE      TFAXNR        AFAXNR
     C                   Z-ADD     TUAVD         WRAVD
     C                   Z-ADD     WSPRO         WRPRO
     C                   WRITE     WRKAGR
     C                   ENDIF
      *
     C                   ENDSL
      *
     C                   ENDSR
      *
      *
     C*
     C***********************************************
     C     GETPRO        BEGSR
     C***********************************************
     C     *LIKE         DEFINE    ECSR          WCSR
     C     *LIKE         DEFINE    EC0065        WC0065
     C     ECMKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    HEKNA
     C                   KFLD                    WCSR
     C                   KFLD                    WC0065
     C                   MOVE      'S'           WCSR
      * ER PALLER PÅ TUREN ALT OPPDATERT...
     C                   MOVE      ' '           TUXXX1
     C                   MOVE      *ZEROS        TUXXX2
     C                   MOVE      *ZEROS        PLLOPD
     C                   MOVE      *ZEROS        PLLEXT
     C     WSPRO         CHAIN(N)  TURER14                            97
     C     *IN97         CABEQ     '1'           UTPRO
     C     KODTAK        CHAIN     KODTA                              33
     C     TRAKEY        CHAIN     TRAN                               97
     C     TUXXX1        COMP      'X'                                    50
      *
     C     WSPRO         SETLL     HEAD14
     C     WSPRO         READE     HEAD14                                 35
     C     *IN35         DOWEQ     '0'
      * SKAL DET SENDES EDI / EMAIL TIL AGENTEN
     C     HEKNA         IFNE      *ZEROS
     C     HEKNA         ANDNE     GMKNA
      * HVIS AGENT ER SAMME SOM TRANSPORTØRNR (KUNDENR) SÅ HINDRE
      * AT EDI OGSÅ SENDES MOT TRANSPORTØR
     C     VMTRKU        IFEQ      HEKNA
     C                   MOVE      *ZEROS        VMTRKU
     C                   END
      * EDI..
     C     EDIJN         IFNE      'J'
     C                   MOVE      'IFCSUM'      WC0065
     C     ECMKEY        CHAIN     ECMSG                              33
     C   33              MOVE      'IFTMIN'      WC0065
     C   33ECMKEY        CHAIN     ECMSG                              33
     C  N33              MOVE      'J'           EDIJN
     C                   END
      * E-MAIL/FAX
     C     FAXJN         IFNE      'J'
     C     AGKE3         CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C     SYFR01        ANDNE     'N'                                          SKAL FAXADV.
     C     TFAXNR        IFNE      *BLANKS
     C     SYEPOS        ORNE      *BLANKS
     C  N33              MOVE      'J'           FAXJN
     C                   END
     C                   END
     C                   END
      *
     C                   END
     C                   MOVE      HEKNA         GMKNA             8 0
      * SUMMER OPP ANT. PALLER
     c                   ADD       HXPALL        PLLOPD
      * FINNES DET KUNDER MED AVTALE OM SAMTAXERING
     C     HEKNKF        IFNE      *ZEROS
     C                   MOVE      HEKNKF        HEKNA
     C                   ELSE
     C                   MOVE      HEKNSF        HEKNA
     C                   END
     C     AGKE3         CHAIN     CUNDL01                            33
     C   33              MOVE      ' '           SYSTAX
     C     SYSTAX        IFEQ      'J'
     C                   MOVE      'J'           STAXJN            1
     C                   END
     C     WSPRO         READE     HEAD14                                 35
     C                   END
      *
     C     FRAPDA        CABEQ     'J'           UTPRO
      *
      * VIS PALLTALL SOM ALT ER AVREGNET...
     C   50TUPLUT        IFGE      '01'
     C     TUPLUT        ANDLE     '99'
     C                   MOVE      TUPLUT        TOTPL             2 0
     C     TOTPL         SUB       PLLOPD        PLLEXT
     C     PLLEXT        IFLT      *ZEROS
     C                   MOVE      *ZEROS        PLLEXT
     C                   END
     C                   END
      *
      * HVIS KUNDE MED KRAV OM SAMTASKERING.., KALL PROG MED "A"=AUTO
      * (VISER SAMTAKSERINGSVINDU - MEN KUN HVIS SAMTAX-VILKÅR FINNES)
     C     STAXJN        IFEQ      'J'
     C                   MOVE      WSPRO         UTTPRO            8
     C                   MOVE      'A'           UTTYPE            1
     C                   CALL      'SYTR88S'
     C                   PARM                    UTTPRO
     C                   PARM                    UTTYPE
     C                   END
      *
      * HVIS TRANSPORTØR IKKE ER (EN AV) AGENTENE, SJEKK OM TRANS-EDI.
      * MEN KUN HVIS DET ER UTGÅENDE  TUR..
N03   * Når edi-part er definer direkte på TRAN skal EDI sendes via fr.brev (syfa12-> 12TG/LG..)
     C                   MOVE      ' '           EDITR             1
     C     VMTRKU        IFNE      *ZEROS
     C     KOAIE         ANDEQ     '1'
     C                   MOVE      VMTRKU        HEKNA
     C                   MOVE      'IFCSUM'      WC0065
     C     ECMKEY        CHAIN     ECMSG                              33
N03  c     VM0010        ifeq      *blanks
     C   33              MOVE      'IFTMIN'      WC0065
     C   33ECMKEY        CHAIN     ECMSG                              33
N03  c                   endif
     C  N33              MOVE      'J'           EDITR
     C                   END
      * Vis nattport-tekst, ikke skriv fraktbrev nå..
     C     TUTST3        IFEQ      '1'
     C                   EVAL      NATTXT = '*NATTPORT* Foreløpig godsliste'
     C                   MOVE      ' '           WSFRBR
     C                   END
      * SKREVET "FRA BOKS" (ELLER F2  PÅ GITT TUR) - ØK VERSJONSNR
     C                   MOVE      'V'           LASGOD
     C                   MOVE      'N'           WSKOPI
     C     UTPRO         ENDSR
