/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 YBC PTF10 NYTT PARAMETER VED KALL PÅ GSS031R                 */
/* ********************************************************************    */
             PGM        PARM(&TNO &STMF)
             DCL        VAR(&LOGO) TYPE(*CHAR) LEN(8) VALUE('LOGOFAKT')
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TNO) TYPE(*CHAR) LEN(11)
/*N01*/      DCL        VAR(&OTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(50)
             DCL        VAR(&STMF2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(3) VALUE('WEB')
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CPY) TYPE(*CHAR) LEN(1) VALUE('1')
             DCL        VAR(&UTFAX) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CUR) TYPE(*CHAR) LEN(3) VALUE('NOK')
             DCL        VAR(&COMM) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&KNC) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&LOC1) TYPE(*CHAR) LEN(5)
             DCL        VAR(&LOC2) TYPE(*CHAR) LEN(5)
             DCL        VAR(&LOC3) TYPE(*CHAR) LEN(5)

             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)

    /* OVERRIDE PRINTERFILE/SKRIV-PACKINGLIST */
             OVRPRTF    FILE(GSS031P) DEVTYPE(*AFPDS) PAGESIZE(70 +
                          120) LPI(6) CPI(15) FRONTMGN(0 0,2) +
                          OVRFLW(59) FRONTOVL(&LOGO 0 0) +
                          OUTQ(SYCGIOUTQ) FORMTYPE(*STD) SPLFOWN(*JOB)

             CHGVAR     VAR(&PRT) VALUE(&QUSER)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
             RMVM       FILE(GSS031W) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
             ADDPFM     FILE(GSS031W) MBR(&UNIK)
             OVRDBF     FILE(GSS031W) TOFILE(GSS031W) MBR(&UNIK)

/*S01        CALL       PGM(GSS031R) PARM(&TNO &TYPE &PRT &CUR &CPY +
                          &UTFAX &COMM &KNC &QJOB &QUSER &QNBR &LOC1 +
                          &LOC2 &LOC3)                                   */
/*N01*/      CALL       PGM(GSS031R) PARM(&TNO &TYPE &PRT &OTYPE +
                          &CUR &CPY &UTFAX &COMM &KNC &QJOB &QUSER +
                          &QNBR &LOC1 &LOC2 &LOC3)

             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             CALL       PGM(SYGE40) PARM(&INFOP)
             IF         COND(&INFOP = 'N') THEN(DO)
             CHGVAR     VAR(&STMF2) VALUE('/syspeddev/temp/' *CAT +
                          &TNO *CAT 'inv.PDF')
             CHGVAR     VAR(&STMF) VALUE(&STMF2)
             RMVLNK     OBJLNK(&STMF)
             MONMSG     MSGID(CPF0000)
             CVTSPLFPDF SPLF(GSS031P) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST) TOPDF(&STMF)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('GSS031P')
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &STMF)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)

             DLTSPLF    FILE(GSS031P) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
    /* */
 SLUTT:      ENDPGM
