      *////////////////////////////////////////////////////////////
      *  CHARGE PAYMENT INSTRUCTIONS                         CPI  /
      *////////////////////////////////////////////////////////////
     C     CPI           BEGSR
      *_____________
      * SEGMENT NAME
      *"""""""""""""
     C                   ADD       1             W0074
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     'CPI'         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_____________________
      * C229 CHARGE CATEGORY
      *"""""""""""""""""""""
     C     C5237         IFEQ      *BLANKS
     C     C4215         ANDEQ     *BLANKS
     C     C4237         ANDEQ     *BLANKS
     C                   GOTO      CPIEND
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 5237 Charge category, coded
     C     C5237         IFEQ      *BLANKS
     C     C1131A        ANDEQ     *BLANKS
     C     C3055A        ANDEQ     *BLANKS
     C                   GOTO      CPI001
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C5237         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      * 1131 Code list qualifier
     C     C1131A        IFEQ      *BLANKS
     C     C3055A        ANDEQ     *BLANKS
     C                   GOTO      CPI001
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     C1131A        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C1131A        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 3055 Code list responsible agency, coded
     C     C3055A        CABEQ     *BLANKS       CPI001
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C3055A        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *_______________________
      * C231 METHOD OF PAYMENT
      *"""""""""""""""""""""""
     C     CPI001        TAG
      *
     C     C4215         IFEQ      *BLANKS
     C     C4237         ANDEQ     *BLANKS
     C                   GOTO      CPIEND
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4215 Transport charges method of payment, coded
     C     C4215         IFEQ      *BLANKS
     C     C1131B        ANDEQ     *BLANKS
     C     C3055B        ANDEQ     *BLANKS
     C                   GOTO      CPI002
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C4215         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      * 1131 Code list qualifier
     C     C1131B        IFEQ      *BLANKS
     C     C3055B        ANDEQ     *BLANKS
     C                   GOTO      CPI002
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     C1131B        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C1131B        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 3055 Code list responsible agency, coded
     C     C3055B        CABEQ     *BLANKS       CPI002
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C3055B        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *______________________________________
      * 4237 PREPAID/COLLECT INDICATOR, CODED
      *""""""""""""""""""""""""""""""""""""""
     C     CPI002        TAG
      *
     C     C4237         IFEQ      *BLANKS
     C                   GOTO      CPIEND
     C                   ENDIF
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     C4237         IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     C4237         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      *_______________
      * END OF SEGMENT
      *"""""""""""""""
     C     CPIEND        TAG
      *
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     WAPSTR        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
