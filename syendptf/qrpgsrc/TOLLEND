********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10262 * 02 YBC PTF10 SATS ER UTVIDERT TIL 7.2
10286 * 03 YBC PTF10 VEKT ER ENDRET FRA 9.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
10329 * 04 YBC PTF10 MENGDE I ANNEN ENHET ER ENDRET FRA 7.0 TIL 9.0
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11174 * 05 YBC PTF11 TILLEGGSLINJER MED SAMME POST
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12053 * 06 YBC PTF12 FLERE BELØP-FELTER ER ENDRET FOR Å TA STØRRE VERDI
12XXX * 07 YBC PTF12 SIKDH ER BRUKT TIL NOE ANNET
12281 * 08 YBC PTF12 4 SIFFER PROSEDYRE OG 2 SIFFER TRANSAKSJONSTYPE
********************************************************************
      *****************************************************************
      *** PROGRAM SKAL LAGE EDI-FACT FILE FOR IMPORT                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01-26                                  ***
      *** LEDIGE INDIKATORER 27-32 35-37 39 40 44-50 54-80 84-89    ***
      ***                    91 95-99
      *****************************************************************
N08  FSYPTFF    IF   E           K DISK
     FEDIS      UF   E           K DISK
     FEDIMC     UF   E           K DISK
     FEDIM4     IF   E           K DISK
     F                                     RENAME(EDIMR:EDIMR4)
     FSADH      UF   E           K DISK
     FSADV2     UF   E           K DISK
     FSADVJ     IF   E           K DISK
     FWFILEIMP  UF A E           K DISK
     FSADW      IF   E           K DISK
     FEDIJ2     IF   E           K DISK
     FSADF      IF   E           K DISK
     FKODTVA    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FTARI      IF   E           K DISK
N03  FSOKTARI2  IF   E           K DISK
     FEDII      IF   E           K DISK
     FEDISE     O  A E             DISK
     D Y1              S              2    DIM(24)                              Avg.type
     D E1              S              3    DIM(24)                              Avg.SEKVENSE
E06  D G1              S             13  2 DIM(24)                              Avg.grunnlag
     D S1              S              7  2 DIM(24)                              Avg.sats
     D P1              S              1    DIM(24)                              Avg.type.sats
E06  D B1              S             11  0 DIM(24)                              Beløp
     D TR              S              2    DIM(24)                              Havnekode
     D T1              S              2    DIM(20)
E06  D T2              S             11  0 DIM(20)
     D T3              S              2    DIM(20)
      *____________________
      * DS for BILFORTOLL  NUMERISK EDIT
      *""""""""""""""""""""
     D                 DS
     D  BN                     1      6
     D                                     DIM(6)
     D  BILNUM                 1      6
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1     70
     D                                     DIM(70)                              Input string
     D  ADS                    1     70
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1     80
     D                                     DIM(80)                              Output string
     D  SDATA                  1     80
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
      *__________________
      * DS for Godsnummer
      *""""""""""""""""""
     D                 DS
     D  SIG014                 1      4
     D  SIG615                 6     15
     D  SIGN                   1     15
     D  SIGN91                 5      5
     D  SIGN9B                 6      6
     D  SIGN92                 5      6
     D  SIGN99                13     13
     D  SIGN71                 7      7
      *____________
      * DS for Dato
      *""""""""""""
     D                 DS
     D  WTIME                  1     14  0
     D  WTM                    1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  WDT                    1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
      *_________________
      * DS for FOReløbig
      *"""""""""""""""""
     D                 DS
     D  SIFT3                  1     45
     D  XFT3KD                 1      3
     D  XFT3                   5     45
     D                 DS
     D  SIFT4                  1     45
     D  XFT4KD                 1      3
     D  XFT4                   5     45
     D                 DS
     D  WFIRNR                 1      5  0
     D  XN2                    2      5  0
N03  D                 DS
N03  D  WFIVKB                 1      9  0
N03  D  WFIVKB123              1     12  3
N03  D                 DS
N03  D  WFIVKN                 1      9  0
N03  D  WFIVKN123              1     12  3
     D                 DS
     D  WFITY1                 1      2
     D  WFITY2                 3      4
     D  WFITY3                 5      6
     D  WFITY4                 7      8
     D  WFITY5                 9     10
     D  Y2                     1     14    DIM(7)
     D                 DS
     D  WFISK1                 1      3
     D  WFISK2                 4      6
     D  WFISK3                 7      9
     D  WFISK4                10     12
     D  WFISK5                13     15
     D  E2                     1     21    DIM(7)
     D                 DS
E06  D  WFIGL1                 1     13  2
E06  D  WFIGL2                14     26  2
E06  D  WFIGL3                27     39  2
E06  D  WFIGL4                40     52  2
E06  D  WFIGL5                53     65  2
E06  D  G2                     1     91  2 DIM(7)
     D                 DS
     D  WFIST1                 1      7  2
     D  WFIST2                 8     14  2
     D  WFIST3                15     21  2
     D  WFIST4                22     28  2
     D  WFIST5                29     35  2
     D  S2                     1     49  2 DIM(7)
     D                 DS
     D  WFIPR1                 1      1
     D  WFIPR2                 2      2
     D  WFIPR3                 3      3
     D  WFIPR4                 4      4
     D  WFIPR5                 5      5
     D  P2                     1      7    DIM(7)
     D                 DS
E06  D  WFIBL1                 1     13  2
E06  D  WFIBL2                14     26  2
E06  D  WFIBL3                27     39  2
E06  D  WFIBL4                40     52  2
E06  D  WFIBL5                53     65  2
E06  D  B2                     1     91  2 DIM(7)
      * ARRAY MED SÆRAVGIFTER BILFORTOLLING
     D                 DS
     D  SWWTY1                 1      2
     D  SWWTY2                 3      4
     D  SWWTY3                 5      6
     D  SWWTY4                 7      8
     D  SWWTY5                 9     10
     D  Y2W                    1     10    DIM(5)
     D                 DS
     D  SWWSK1                 1      3
     D  SWWSK2                 4      6
     D  SWWSK3                 7      9
     D  SWWSK4                10     12
     D  SWWSK5                13     15
     D  E2W                    1     15    DIM(5)
     D                 DS
     D  SWWGL1                 1      9  2
     D  SWWGL2                10     18  2
     D  SWWGL3                19     27  2
     D  SWWGL4                28     36  2
     D  SWWGL5                37     45  2
     D  G2W                    1     45  2 DIM(5)
     D                 DS
     D  SWWST1                 1      7  2
     D  SWWST2                 8     14  2
     D  SWWST3                15     21  2
     D  SWWST4                22     28  2
     D  SWWST5                29     35  2
     D  S2W                    1     35  2 DIM(5)
     D                 DS
     D  SWWPR1                 1      1
     D  SWWPR2                 2      2
     D  SWWPR3                 3      3
     D  SWWPR4                 4      4
     D  SWWPR5                 5      5
     D  P2W                    1      5    DIM(5)
     D                 DS
     D  SWWBL1                 1      7  0
     D  SWWBL2                 8     14  0
     D  SWWBL3                15     21  0
     D  SWWBL4                22     28  0
     D  SWWBL5                29     35  0
     D  B2W                    1     35  0 DIM(5)
      *
     D                 DS
S03  D* WFIKN1                 1     17
S03  D* WFIKN2                18     34
S03  D* WFIKN3                35     51
S03  D* WFIKN4                52     68
S03  D* WFIKN5                69     85
S03  D* WFIKN6                86    102
S03  D* WFIKN7               103    119
S03  D* KN                     1    119    DIM(7) ASCEND                        Merke & nummer
N03  D  WFIKN1                 1     28
N03  D  WFIKN2                29     56
N03  D  WFIKN3                57     84
N03  D  WFIKN4                85    112
N03  D  WFIKN5               113    140
N03  D  WFIKN6               141    168
N03  D  WFIKN7               169    196
N03  D  KN                     1    196    DIM(7) ASCEND                        Merke & nummer
     D                 DS
S03  D* WFIVB1                 1     15
S03  D* WFIVB2                16     30
S03  D* WFIVB3                31     45
S03  D* WFIVB4                46     60
S03  D* WFIVB5                61     75
S03  D* WFIVB6                76     90
S03  D* WFIVB7                91    105
S03  D* WFIVB72               91    105
S03  D* VB                     1    105    DIM(7) ASCEND                        Varebeskr
N03  D  WFIVB1                 1     30
N03  D  WFIVB2                31     60
N03  D  WFIVB3                61     90
N03  D  WFIVB4                91    120
N03  D  WFIVB5               121    150
N03  D  VB                     1    210    DIM(7) ASCEND                        Varebeskr
     D                 DS
     D  WFITO1                 1     45
     D  WFITO2                46     90
     D  WFITO3                91    135
     D  WFITO4               136    180
     D  WFITO5               181    225
     D  TO                     1    225
     D                                     DIM(5)                               Til.opl
     D                 DS
     D  WFITC1                 1      3
     D  WFITC2                 4      6
     D  WFITC3                 7      9
     D  WFITC4                10     12
     D  WFITC5                13     15
     D  TC                     1     15
     D                                     DIM(5)                               Cref ved komm.
     D                 DS
     D  XDP1                   1      1  0
     D  SIDP                   1      2  0
N08  D  SIDP2                  3      4  0
N08  D  SIDP_4SIFF             1      4  0
     D                 DS
E06  D  WFITOL                 1     11  0
E06  D  XWFTOL                 1     13  2
     D                 DS
E06  D  WFITLG                 1     11  0
E06  D  XWFTLG                 1     13  2
     D                 DS
     D  WFISTB                 1     13  0
     D  XWFSTB                 1     15  2
     D                 DS
     D  SVVNT                  1      8  0
     D  SVLK                   9     10
     D  SVTN                  11     11
     D  SVPRE                 12     12
S02  D* SVAS                  13     17  2
S02  D* SVPVA                 18     18
S02  D* SVMFR                 19     19
S02  D* SVVF                  20     20
S02  D* XBRUD1                 1     20
N02  D  SVAS                  13     19  2
N02  D  SVPVA                 20     20
N02  D  SVMFR                 21     21
N02  D  SVVF                  22     22
N02  D  XBRUD1                 1     22
     D                 DS
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D  XTOPP                  1     45
     D                 DS
     D  SWTX1A                 1      6  1
     D  SWVK15                 1      5
     D  SWVK25                 2      5
     D  SWVK66                 6      6
     D                 DS
     D  SWTX2A                 1      6  2
     D  SWEF14                 1      4
     D  SWEF24                 2      4
     D  SWEF56                 5      6
     D  SWEF55                 5      5
     D  SWEF66                 6      6
     D                 DS
     D  DSFTXV                 1     26
     D  DSV                    1      1
     D  DSTX1A                 3      8
     D  DSTX1B                10     15
     D  SWTX1C                17     26
     D                 DS
     D  DSFTXE                 1     26
     D  DSE                    1      1
     D  DSTX2A                 3      8
     D  DSTX2B                10     15
     D  SWTX2C                17     26
     D                 DS
     D  DSFTXK                 1     29
     D  DSK                    1      1
     D  DSTX3A                 3      8
     D  DSTX3B                10     15
     D  SWTX3C                17     29
     D                 DS
     D  DSPCIC                 1     26
     D  DSC                    1      1
     D  DSPC1A                 3      8
     D  DSPC1B                10     15
     D  SWPC1C                17     17
     D  SWPC1D                19     20
     D                 DS
     D  DSPCI                  1     26
     D  DSPROS                 1      6
     D  DSPROT                 8      8
     D  DSPC2B                10     15
     D  DSPC2C                21     26
     D                 DS
     D  SVAKD1                 1      2
     D  SVAKD2                 3      4
     D  SVAKD3                 5      6
     D  SVAKD4                 7      8
     D  SVAKD5                 9     10
     D  SVAKD6                11     12
     D  SVAKD7                13     14
     D  SVAKD8                15     16
     D  SVAKD                  1     16    DIM(8)
     D                 DS
     D  SVASV1                 1      3
     D  SVASV2                 4      6
     D  SVASV3                 7      9
     D  SVASV4                10     12
     D  SVASV5                13     15
     D  SVASV6                16     18
     D  SVASV7                19     21
     D  SVASV8                22     24
     D  SVASV                  1     24    DIM(8)
     D                 DS
     D  SVASA1                 1      7  2
     D  SVASA2                 8     14  2
     D  SVASA3                15     21  2
     D  SVASA4                22     28  2
     D  SVASA5                29     35  2
     D  SVASA6                36     42  2
     D  SVASA7                43     49  2
     D  SVASA8                50     56  2
     D  SVASA                  1     56  2 DIM(8)
     D                 DS
E06  D  SVAGR1                 1     13  2
E06  D  SVAGR2                14     26  2
E06  D  SVAGR3                27     39  2
E06  D  SVAGR4                40     52  2
E06  D  SVAGR5                53     65  2
E06  D  SVAGR6                66     78  2
E06  D  SVAGR7                79     91  2
E06  D  SVAGR8                92    104  2
E06  D  SVAGR                  1    104  2 DIM(8)
     D                 DS
E06  D  SVABL1                 1     13  2
E06  D  SVABL2                14     26  2
E06  D  SVABL3                27     39  2
E06  D  SVABL4                40     52  2
E06  D  SVABL5                53     65  2
E06  D  SVABL6                66     78  2
E06  D  SVABL7                79     91  2
E06  D  SVABL8                92    104  2
E06  D  SVABL                  1    104  2 DIM(8)
     D                 DS
     D  SVEH21                 1      1
     D  SVEH22                 2      2
     D  SVEH23                 3      3
     D  SVEH24                 4      4
     D  SVEH25                 5      5
     D  SVEH26                 6      6
     D  SVEH27                 7      7
     D  SVEH28                 8      8
     D  SVEH2                  1      8    DIM(8)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
     D  SVNT01                 1      6  0
     D  SVNT02                 7     12  0
     D  SVNT03                13     18  0
     D  SVNT04                19     24  0
     D  SVNT05                25     30  0
     D  SVNT06                31     36  0
     D  SVNT07                37     42  0
     D  SVNT                   1     48  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)
     IEDIMR4
     I              M0004                       N0004
     I              M0010                       N0010
     I              M0035                       N0035
     I              M0062                       N0062
     I              M0065                       N0065
     I              M0068                       N0068
     I              M0068A                      N0068A
     I              M0068B                      N0068B
     I              M0068C                      N0068C
     I              M0068D                      N0068D
     I              M0068E                      N0068E
     I              M0068F                      N0068F
     I              M1001                       N1001
     I              M1004                       N1004
     I              M1225                       N1225
     I              M2005B                      N2005B
     I              M3039D                      N3039D
     I              M3039E                      N3039E
     I              M5004D                      N5004D
     I              M1N07                       N1N07
     I              M1N08                       N1N08
     I              M9N01                       N9N01
     I              MSN                         NSN
     I              MMN                         NMN
     I              MSR                         NSR
     I              MST                         NST
     I              MDT                         NDT
     I              MTM                         NTM
     I              MVEN                        NVEN
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRC
     C                   EXSR      SRD
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SSN           WSN
     C     *LIKE         DEFINE    S0036         W0036
     C     *LIKE         DEFINE    JCLFE         WCLFE
     C     *LIKE         DEFINE    MST           WST
     C     *LIKE         DEFINE    MVEN          WVEN
     C     *LIKE         DEFINE    SIBEL5        XBEL5
     C     *LIKE         DEFINE    SIBEL6        XBEL6
     C     *LIKE         DEFINE    SIBEL7        XBEL7
     C     *LIKE         DEFINE    SIBELT        XBELT
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             7 0
     C                   MOVE      *BLANKS       XTAR              3
S03  C*                  MOVE      *BLANKS       BLAN15           15
S03  C*                  MOVE      *BLANKS       BLAN17           17
N03  C                   MOVE      *BLANKS       BLAN30           30
N03  C                   MOVE      *BLANKS       BLAN28           28
     C                   MOVE      *ZEROS        T1X               2 0
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WSN
     C     KEYB          KLIST
     C                   KFLD                    SSR
     C                   KFLD                    WST
     C                   KFLD                    WVEN
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    S0035
     C     KEYC          KLIST
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    WCLFE
     C     KEYD          KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     KEYE          KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     SADV2K        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C     SADVJK        KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    SVLI
     C     KODVAK        KLIST
     C                   KFLD                    XVAUNI
     C                   KFLD                    SIVAL3
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    SILKA
S07  C*    KODTSK        KLIST
S07  C*                  KFLD                    XTSUNI
S07  C*                  KFLD                    SIKDH
     C     TARIK         KLIST
     C                   KFLD                    WFIVNT
     C                   KFLD                    XTAR
     C     TARIKM        KLIST
     C                   KFLD                    WFIVNT
     C                   KFLD                    XTAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
     C     TVIM4K        KLIST
     C                   KFLD                    XSR
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C                   KFLD                    M0068A
     C                   KFLD                    M0068B
     C     WFKEY         KLIST
     C                   KFLD                    SIAVD
     C                   KFLD                    SITDN
     C                   KFLD                    XNR
     C     *LIKE         DEFINE    MSR           XSR
     C                   MOVE      'R'           XSR
N08   *
N08  C     'TVI00011'    CHAIN     SYPTFF                             33
N08  C   33              Z-ADD     0             X_4SIFF           8 0
      *_____________
      * Init av felt
      *"""""""""""""
      * Hente dagens dato og klokkeslett.
     C                   TIME                    WTIME
     C                   Z-ADD     WÅÅ           WÅ
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
     C                   MOVE      '+'           WST
     C                   MOVE      *BLANKS       WVEN
     C                   MOVE      *BLANKS       WCLFE
     C                   MOVE      'VA'          XVAUNI            2
     C                   MOVE      'TST'         XTSUNI            3
     C                   MOVE      'S2 '         XS2UNI            3
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                2 0          Index for B
     C                   Z-ADD     0             AXV               2 0          Leftindx A
     C                   Z-ADD     0             AXH               2 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WSN           PARM                    WSN
     C                   PARM                    WNETW             1
      *_______________________________
      * Hente momssats fra firmarecord
      *"""""""""""""""""""""""""""""""                     *Eksempel:*
     C                   READ      FIRM                                   33    FITAX=0.2200
     C                   MOVE      FITAX         XTAX              4 4
     C                   MOVE      FITAX         FITAXX            4 2          FITAXX=22.00
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_____________________________
      * Hente data fra sendningslogg
      *"""""""""""""""""""""""""""""
     C     KEYA          CHAIN     EDIS                               81
     C                   Z-ADD     0             W0036
     C                   MOVEL     SMBR          SEMBR
      *_______________________________________________
      * Legg in JCL i starten av filen for Kommunedata
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C                   SELECT
     C     WNETW         WHENEQ    '1'
      *
     C                   MOVE      'F'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   ENDSL
      * Legg in UNB-segment (Sendningsstart)
     C                   EXSR      UNB0
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Les meldinger                                        SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
     C     KEYB          CHAIN     EDIMC                              8182
     C     *IN81         DOWEQ     '0'                                          1<-B
     C  N82M0065         IFEQ      'CUSDEC'                                      2<-B
     C     M1001         ANDEQ     '929'
     C     M1N07         IFEQ      'DFU'                                          3<-B
     C     M1N07         OREQ      'DMA'
     C     M1N07         OREQ      'DFO'
     C     M1N07         OREQ      'DEN'
     C     M1N07         OREQ      'DKO'
     C     M1N07         OREQ      'DOM'
     C     KEYD          CHAIN(N)  SADH                               82
     C     *IN82         IFEQ      '0'                                             4<-B
     C                   Z-ADD     SSN           MSN
     C                   MOVE      'A'           MST
     C                   Z-ADD     WDT           MDT
     C                   Z-ADD     WTM           MTM
     C                   UPDATE    EDIMR
     C                   EXSR      PRINT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     KEYB          READE     EDIMC                                8281
     C  N81              END                                                    1<-E
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Slutt på file                                        SRD /
      *////////////////////////////////////////////////////////////
     C     SRD           BEGSR
      *_____________________________
      * Legg in UNZ (Slutt sendning)
      *"""""""""""""""""""""""""""""
     C                   EXSR      UNZ0
      *________________________
      * Oppdatere sendningslogg
      *""""""""""""""""""""""""
     C                   MOVE      'A'           SST
     C                   Z-ADD     W0036         S0036
     C                   UPDATE    EDISR
      *_______________________________________________
      * Legg in JCL i slutten av filen for Kommunedata
      *"""""""""""""""""""""""""""""""""""""""""""""""
     C     WNETW         IFEQ      '1'
     C                   MOVE      'E'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   END
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Skriv ut Tolldeklarasjon, denne delen er hentet fra SAD61P /
      */////////////////////////////////////////////////////////////
     C     PRINT         BEGSR
      *
     C     M0068A        IFGE      FITAXD
     C                   Z-ADD     XTAX          FITAX
     C                   ELSE
     C                   Z-ADD     FITAX2        FITAX
     C                   END
     C                   MOVE      FITAX         FITAXX            4 2
     C     SADV2K        CHAIN     SADW                               82
     C     *IN82         IFEQ      '0'
     C                   MOVE      'J'           MVOGN             1
     C                   ELSE
     C                   MOVE      'N'           MVOGN
     C                   END
      *
     C                   EXSR      UNH0
     C                   EXSR      BGM0
      *__________________________________
      * Sette nødvendige indkatorer på/av
      *""""""""""""""""""""""""""""""""""
     C                   EXSR      SETIN1
      *_____________________________________________________________
      * I SUMVAR gjøres nødvendige beregninger (summerer varelinjer)
      * og skriver ut på filen WFILEIMP
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C  N41              EXSR      SUMVAR
      *___________________________________
      * Sette nødvendige indikatorer på/av
      *"""""""""""""""""""""""""""""""""""
     C                   EXSR      SETIN2
      *________________________________
      * Skrive tolldekl. til EDIFACT-fil
      *""""""""""""""""""""""""""""""""
     C                   EXSR      PRINT2
     C                   EXSR      UNT0
      *_________________________________
      * Oppdater toll, moms, ... på SADH
      *"""""""""""""""""""""""""""""""""
     C                   MOVE      SIBEL7        XBEL7
     C                   MOVE      SIBELT        XBELT
     C     KEYD          CHAIN     SADH                               82
     C     *IN82         IFEQ      '0'
     C                   MOVE      XBEL5         SIBEL5
     C                   MOVE      XBEL6         SIBEL6
     C                   MOVE      XBEL7         SIBEL7
     C                   MOVE      XBELT         SIBELT
     C                   MOVE      'A'           SIST
     C                   EXCEPT    OPDSAD
     C                   END
      *
     C                   ENDSR
      *
      */////////////////////////////////////////////////////////////
      * Sette nødvendige indikatorer på/av                         /
      */////////////////////////////////////////////////////////////
     C     SETIN1        BEGSR
      *___________________
      * Blanke ut workfile
      *"""""""""""""""""""
     C                   EXSR      MOVBWF
     C                   MOVE      *ZEROS        XTVF             17 9
     C                   MOVE      *ZEROS        XTVF2            17 9
      *______________________
      * Er dette et instikk ?
      *""""""""""""""""""""""
     C                   SETOFF                                       41        =Instikk
     C     SIMF          IFEQ      'DFO'
     C                   MOVE      '1'           *IN41
     C                   END
      *
     C  N41SIMF          IFEQ      'DKO'                                        1<-B
     C     SIMI          ANDEQ     'I'
     C     TVIM4K        SETLL     EDIM4                              33
     C     STSI1         TAG
     C     TVIM4K        READE     EDIM4                                  33
     C  N33NST           IFEQ      'D'                                           2<-B
     C     N1N07         ORNE      'DUA'
     C                   GOTO      STSI1
     C                   END                                                     2<-B
     C   33              MOVE      '1'           *IN41
     C                   END                                                    1<-B
      *
      * PROS.=47,70-77 ---> 90 PÅ
     C     SIDP          COMP      70                                 90  90
     C   90SIDP          COMP      77                                   9090
     C  N90SIDP          COMP      47                                     90
      *
     C   41              DO                                                     Ved instikk
     C     KODS2K        CHAIN     KODTS2                             42
     C  N42KS2PRE        COMP      *BLANKS                                42
     C                   END
      *__________________________
      * Finn faktor for varelinje
      *""""""""""""""""""""""""""
     C  N41SIBEL3        IFNE      0
     C     SIBEL4        DIV(H)    SIBEL3        XTVF
     C                   END
     C  N41SIBELR        IFNE      0
     C     SIBEL3        ANDNE     0
     C     SIBELS        DIV(H)    SIBEL3        XTVF2
     C                   END
      *
     C     SIVAL3        IFEQ      *BLANKS
     C                   MOVE      FICURR        SIVAL3
     C                   END
     C     KODVAK        CHAIN     KODTVA                             33
     C   33              MOVE      *ZEROS        KVAOMR
      *____________________________________________
      * Diverse tester for del-1 av tolldeklarasjon
      *""""""""""""""""""""""""""""""""""""""""""""
     C     SILV          COMP      'TFR'                                  38
      *
     C                   MOVE      *ZEROS        XNR               5 0
     C                   MOVE      *ZEROS        XN2               4 0
     C                   MOVE      *ZEROS        XN3               5 0
     C                   MOVE      *ZEROS        SIBELT
     C                   MOVE      *ZEROS        XBEL5
     C                   MOVE      *ZEROS        XBEL6
     C                   MOVE      *ZEROS        XTOT1            13 2
     C                   MOVE      *ZEROS        XTOT2            13 2
     C                   MOVE      *ZEROS        XTOTBV            9 0
     C                   MOVE      *ZEROS        XTVKTB            9 0
     C                   MOVE      *ZEROS        XTJUS            10 0
      *
     C     *IN41         IFEQ      '1'
     C                   MOVE      '1'           *IN94
     C                   ELSE
     C     SIBEL3        MULT      SIVKU         XIBEL3           15 2
     C                   DIV(H)    KVAOMR        XIBEL3
     C                   SELECT
     C     SIDP          WHENEQ    48
      * PROSEDYRE=48 --> POSTORDRE, ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C     XIBEL3        WHENGT    200
      * VAREVERDI>200--> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   OTHER
     C                   MOVE      '1'           *IN94
     C                   ENDSL
     C                   END
     C                   MOVE      '1'           *IN92
      *
     C                   ENDSR
      *///////////////////////////////////////////////////////
      * Sammentrekkning av varelinjer                 SUMVAR /
      *///////////////////////////////////////////////////////
     C     SUMVAR        BEGSR
S02  C*                  MOVE      *BLANKS       XBRUD2           20
N02  C                   MOVE      *BLANKS       XBRUD2           22
     C     SADV2K        SETLL     SADV2
     C                   SETOFF                                       33
      *
     C     STSV          TAG
     C     SADV2K        READE     SADV2                                  33
     C   33XBRUD2        IFNE      *BLANKS
     C                   EXSR      REGN
     C                   END
     C   33              GOTO      SLSV
      * STARTER LINJETELLER MED 1 VED 1. RECORD
     C     XBRUD2        IFEQ      *BLANKS
     C                   EXSR      FLYTT
     C                   ELSE
     C     XBRUD1        IFNE      XBRUD2
      * VED BRUDD OPPDATER VARELINJE PÅ WFILEIMP
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
      *
     C                   Z-ADD     XNR           SVLN
     C                   EXCEPT    SADVLN
      *
     C                   MOVE      XBRUD1        XBRUD2
     C     XTVF          MULT(H)   SVBELT        XTVRD            11 2
      *
     C     1             DO        7             XN2                            1<-B
     C                   IF        SVFT(XN2) <> *BLANKS                          2<-B
     C     1             DO        7             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      KN(XN4) = *BLANKS                               4
     C                   EVAL      KN(XN4) = SVFT(XN2)
     C                   LEAVE
     C                   WHEN      KN(XN4) = SVFT(XN2)                             4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
     C     STSV2         TAG
     C     WFIVT         IFEQ      *BLANKS
     C                   MOVE      SVEH01        WFIVT
     C                   END
      *
     C     1             DO        7             XN2                            1<-B
     C                   EVAL      WFIANT = WFIANT + SVNT(XN2)
     C                   ENDDO                                                  1<-E
      *
     C     1             DO        10            XN2                            1<-B
     C                   IF        SVTOP(XN2) <> *BLANKS                         2<-B
     C     1             DO        10            XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      TO(XN4) = *BLANKS                               4
     C                   EVAL      TO(XN4) = SVTOP(XN2)
     C                   EVAL      TC(XN4) = SVTCR(XN2)
     C                   LEAVE
     C                   WHEN      TO(XN4) = SVTOP(XN2) AND TC(XN4) = SVTCR(XN2)   4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
     C     STSV3         TAG
     C     SVPVA         COMP      'P'                                    51
     C     SVPVA         COMP      'V'                                    52
     C  N52SVPVA         COMP      'W'                                    52
     C     SVPVA         COMP      'A'                                    53
      *
S03  C*                  ADD       SVVKTB        WFIVKB
S03  C*                  ADD       SVVKTN        WFIVKN
N03  C                   ADD       SVVKTB        WFIVKB123
N03  C                   ADD       SVVKTN        WFIVKN123
     C   53              ADD       SVNTM         XNTM              9 0
     C     SVBELT        MULT      SIVKU         XWORK
     C                   DIV(H)    KVAOMR        XWORK
      * ADDER TIL DATASTRUKTURFELT MED DESIMAL
     C                   ADD(H)    XWORK         XWFSTB
     C     SIBELR        IFNE      0
     C     XTVF2         MULT(H)   SVBELT        XTVRD2           11 2
     C                   ADD       SVBELT        XBELR2           11 2
     C                   END
      * SUMMER EKSTRAAVGIFTER
     C     1             DO        8             XN2                            1<-B
     C                   IF        SVAKD(XN2) <> *BLANKS                         2<-B
     C     1             DO        8             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      Y2(XN4) = *BLANKS                               4
     C                   EVAL      Y2(XN4) = SVAKD(XN2)
     C                   EVAL      E2(XN4) = SVASV(XN2)
     C                   EVAL      S2(XN4) = SVASA(XN2)
     C                   EVAL      P2(XN4) = SVEH2Æ
     C                   EVAL      B2(XN4) = SVABL(XN2)
     C                   EVAL      G2(XN4) = SVAGR(XN2)
     C                   LEAVE
     C                   WHEN      Y2(XN4) = SVAKD(XN2) AND E2(XN4) = SVASV(XN2)   4
     C                   EVAL      B2(XN4) = B2(XN4) + SVABL(XN2)
     C                   EVAL      G2(XN4) = G2(XN4) + SVAGR(XN2)
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      * FINN TOLLBELØP
     C                   MOVE      *ZEROS        XTBEL            13 2
     C   51XTVRD         MULT      SVAS          XWORK
     C   51XWORK         DIV(H)    100           XTBEL
     C   52SVVKTN        MULT      SVAS          XTBEL
     C   52SVPVA         IFEQ      'W'
     C                   DIV(H)    100           XTBEL
     C                   END
     C   53SVNTM         MULT      SVAS          XTBEL
     C                   ADD       XTBEL         XWFTOL
     C                   ADD       SVNTM         WFINTM
     C                   ADD       XTVRD         XWFTLG
      *
     C                   GOTO      STSV
      *
     C     SLSV          ENDSR
      *////////////////////////////////////////////////////////////
      * Sette nødvendige indikatorer på/av                        /
      *////////////////////////////////////////////////////////////
     C     SETIN2        BEGSR
     C     MVOGN         IFEQ      'J'
     C                   Z-ADD     SIBEL7        XTOT2                            TOTAL
     C     XTOT2         SUB       SIBELT        XTOT1                            UTEN TA
     C                   END
      *
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN4               2 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        T2
     C                   MOVE      *BLANKS       T3
     C                   MOVE      *ZEROS        SIBEL7
      *
     C                   SETON                                        51
      * XTAVG = T0TAL TRAFIKKAVGIFT
     C     SIBELT        COMP      5                                    93
      * XTOT1 = TOTAL AVGIFTER UTEN TRAFIKKAVGIFT
      * *IN94 AV --> KREVE AVGIFTER. HVIS AVGIFT=0, SLÅ PÅ *IN94
     C  N94XTOT1         COMP      0                                    9494
      * "BV/TO" > 0  --->  ALLTID MED MOMOS
      *
     C     SIVKU         IFNE      0
     C     SIVALB        IFEQ      'P  '
     C                   Z-ADD     0             XWORK            17 6
     C                   ELSE
     C     SIVALB        IFEQ      SIVAL3
     C                   Z-ADD     SIBEL2        XWORK
     C                   ELSE
     C     SIBEL9        MULT      KVAOMR        XWORK
     C     XWORK         DIV(H)    SIVKU         XWORK
     C                   END
     C                   END
     C                   END
     C     SIFTG2        IFNE      '-'                                          B1
     C     SIFTG2        ANDNE     '+'
     C                   Z-ADD     SIBEL3        XBEL3
     C                   ELSE                                                   X1
     C     SIFTG2        IFEQ      '+'                                           B2
     C     SIBEL3        ADD(H)    XWORK         XBEL3            12 2
     C                   ELSE                                                    X2
     C     SIFTG2        IFEQ      '-'                                            B3
     C     SIBEL3        SUB(H)    XWORK         XBEL3
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Skrive tolldekl. til EDIFACT-fil                          /
      *////////////////////////////////////////////////////////////
     C     PRINT2        BEGSR
      * Skrive ut meldingshode til EDIFACT-fil
     C                   EXSR      UTHODE
      * Seksjonskille
     C                   EXSR      UNSD
      * Skrive ut fakturainfomasjoner
     C                   EXSR      DMS0
      * Skrive ut meldingsvarelinjer til EDIFACT-fil
     C                   EXSR      UTVLIN
      * Seksjonskille
     C                   EXSR      UNSS
      * Skrive ut meldingssumlinje til EDIFACT-fil
     C  N41              EXSR      UTSUML
      *
     C   41              EXSR      CNT0M
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Skrive meldingshode til EDIFACT-fil                       /
      *////////////////////////////////////////////////////////////
     C     UTHODE        BEGSR
      * Tollstatus for gods
     C                   EXSR      CST0
      * Referanser
     C                   EXSR      RFF0
      * Stedsangivelse
     C                   EXSR      LOC0
      * Ønsket behandlingsdato, ekspedisjonsdato og bokføringsdato
     C                   EXSR      DTM0
      * Transportdetaljer
     C     *IN41         IFEQ      '0'
     C                   EXSR      TDT0
      * Generell indikator
     C                   EXSR      GIS0
     C                   END
      * Eksportør, mottaker, deklaranten, ekspedisjonsenhet hvor
      * deklatasjonen skal ekspederes og toll-/avgiftsbetaler
     C                   EXSR      NAD0
      * Kontaktinformasjon
     C                   EXSR      CTA0
      * Leveringsbetingelse
     C  N41              EXSR      TOD0
      * Fakturasum
     C  N41              EXSR      MOA0
      * Valuta
     C  N41              EXSR      CUX0
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                       UTVLIN
      */////////////////////////////////////////////////////////////
     C     UTVLIN        BEGSR
      *________________
      * Skriv dataliste
      *""""""""""""""""
     C     *IN41         IFEQ      '0'                                          1<-B
      *
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN3
     C     MVOGN         IFEQ      'J'
     C                   MOVE      *ZEROS        XNR                            ANT.POSTER
     C     SADV2K        SETLL     SADW
     C     SADV2K        READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADV2K        SETLL     WFILEIMP                           33
     C     SADV2K        READE     WFILEIMP                               33
     C  N33              DELETE    WFILEIR
     C                   END
     C     STUDD         TAG
     C                   Z-ADD     0             XN3
     C                   MOVE      *BLANKS       Y1
     C                   MOVE      *BLANKS       E1
     C                   EXSR      REGN2
      * Tollstatus for gods
     C                   EXSR      CST0V
      * Forpakning
     C     MVOGN         IFEQ      'J'
     C                   EXSR      PAC0VB
     C                   ELSE
     C                   EXSR      PAC0V
     C                   END
      * Forpakningsidentifikasjon
     C     MVOGN         IFEQ      'J'
     C                   EXSR      PCI0VB
     C                   ELSE
     C                   EXSR      PCI0V
     C                   END
      * Oppringelseslandkode
     C                   EXSR      LOC0V
      * Tollverdi
     C     SIDP          IFNE      44
     C     SITST         ORNE      9
     C                   EXSR      MOA0V
     C                   END
      * Vekt og annen enhet
     C                   EXSR      MEA0V
      * Avgifter
     C  N90              EXSR      TAX0V
      * Nødvendige dokumenter
     C                   EXSR      DCR0V
      * Godsbeskrivelse (TAD-kode)
     C                   EXSR      GDS0V
      * Godsbeskrivelse
     C     MVOGN         IFEQ      'J'
     C                   EXSR      FTX0VB
     C                   ELSE
     C                   EXSR      FTX0V
     C                   END
      *
     C     MVOGN         IFEQ      'J'
     C     SADV2K        READE     SADW                                   33
     C  N33              EXSR      MOVSWW
     C                   ELSE
     C     SADV2K        READE     WFILEIMP                               33
     C  N33              DELETE    WFILEIR
     C                   END
     C  N33              GOTO      STUDD
      *
     C                   Z-ADD     1             XN4
     C     XN4           DOWLT     16                                            2<-B
     C     T1(XN4)       IFEQ      *BLANKS                                        3<-B
     C                   GOTO      STUDD3
     C                   END                                                      3<-E
     C                   ADD       1             XN4
     C                   END                                                     2<-E
      *
     C     STUDD3        TAG
      *
     C     T1(20)        IFNE      *BLANKS                                       2<-B
     C                   MOVE      'MV'          T1(XN4)
     C                   MOVE      T2(20)        T2(XN4)
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      *________________________________________________________
      * Skriv ut til EDIfact-file isteden for Print ved instikk
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      * Tollstatus for gods
     C                   EXSR      CST0M
      * Oppringelseslandkode
     C                   EXSR      LOC0M
      * Vekt og annen enhet
     C                   EXSR      MEA0M
      * Nødvendige dokumenter
     C                   EXSR      DCR0M
      * Godsbeskrivelse (TAD-kode)
     C                   EXSR      GDS0M
      * Godsbeskrivelse
     C                   EXSR      FTX0M
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * Skrive ut meldingssumlinje til EDIFACT-fil                /
      *////////////////////////////////////////////////////////////
     C     UTSUML        BEGSR
      * Sum avgifter
     C  N90              EXSR      TAX0S
      * Kontroll totaler
     C                   EXSR      CNT0S
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                        FLYTT
      */////////////////////////////////////////////////////////////
     C     FLYTT         BEGSR
      *
     C                   ADD       1             XNR
     C                   Z-ADD     1             XN2
     C                   Z-ADD     1             XN3
     C     SVMFR         IFEQ      'F'
     C                   MOVE      *ZEROS        WFIMVA
     C                   ELSE
      *WFIMVA er resultatfeltet for ferdig utregnet moms.
      *Bruker feltet som "indikator" for at MOMS SKAL BEREGNES PÅ LINJA
      *(workfile har ikke felt tilsvarende SVMFR - 99 kun dummy verdi)
     C                   MOVE      99            WFIMVA
     C                   END
     C                   EXSR      MOVBWF
      *
     C                   MOVE      SVTN          WFITN
     C                   MOVE      SVVNT         WFIVNT
     C                   MOVE      SVLK          WFILK
     C                   MOVE      SVPRE         WFIPRE
     C                   MOVE      SVVF          WFIVF
     C                   MOVE      SVAS          WFISAT
     C                   MOVE      SVEH21        WFIPRO
     C                   MOVE      SVPVA         XPVA1             1
     C                   MOVE      *BLANKS       Y2
     C                   MOVE      *BLANKS       E2
     C                   MOVE      *ZEROS        G2
     C                   MOVE      *ZEROS        S2
     C                   MOVE      *BLANKS       P2
     C                   MOVE      *ZEROS        B2
     C                   MOVE      *BLANKS       KN
     C                   MOVE      *ZEROS        WFIANT
     C                   MOVE      *ZEROS        WFINTM
     C                   MOVE      *BLANKS       WFIVT
      *
     C                   SELECT
     C     SVVNT         WHENGE    22030000
     C     SVVNT         ANDLE     22089999
      * ALKOHOL --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '0'           *IN92
     C     SVVNT         WHENGE    24010000
     C     SVVNT         ANDLE     24039999
      * TOBAKK  --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '0'           *IN92
     C     SVVNT         WHENGE    48130000
     C     SVVNT         ANDLE     48139999
      * TOBAKK  --> ALLTID KREVE AVGIFTER
     C                   MOVE      '0'           *IN94
     C                   MOVE      '0'           *IN92
     C                   ENDSL
      * HENTE JUSTERINGSBELØP
     C     SADVJK        CHAIN     SADVJ                              34
     C   34              MOVE      *ZEROS        SJBELN
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                       FLYTT2
      */////////////////////////////////////////////////////////////
     C     FLYTT2        BEGSR
      *
     C                   ADD       1             XN3
     C     XN3           MULT      8             XN4
     C     XN4           SUB       7             XN4
     C                   MOVE      SIAS          XSIAS             5 1
S07  C*    1             DO        5             XN6
S07  C*    Y2(XN6)       IFEQ      'TA'
S07  C*                  MOVE      *ZEROS        SIAS
S07  C*                  MOVE      *ZEROS        WFITRA
S07  C*                  END
S07  C*                  END
      *
S07   * N93, 94, 92 ---> KUN "TA" AVGIFT
      * N93,N94,N92 ---> "TA", "BV/TO" AVGIFTER
      *  93,N94,N92 ---> KUN "BV/TO" AVGIFTER
     C   92
     CAN 94
     CANN93
     CORN92
     CANN94              DO                                                     1<-B
     C  N94SIBELR        IFEQ      0
     C                   Z-ADD     WFISTB        WFIMVG
     C                   ELSE
     C                   Z-ADD     WFIBBL        WFIMVG
     C                   END
     C                   MOVE      *ZEROS        WFISUM
     C     1             DO        5             XN6                             2<-B
S07  C* N93Y2(XN6)       CABEQ     'TA'          STF201
     C  N94XTOTBV        IFGT      0                                              3<-B
     C     Y2(XN6)       CABEQ     'BV'          STF201
     C     Y2(XN6)       CABEQ     'TO'          STF201
     C     Y2(XN6)       CABEQ     'EC'          STF201
     C     Y2(XN6)       CABEQ     'GC'          STF201
     C     Y2(XN6)       CABEQ     'EB'          STF201
     C     Y2(XN6)       CABEQ     'EG'          STF201
     C     Y2(XN6)       CABEQ     'NA'          STF201
     C     Y2(XN6)       CABEQ     'RR'          STF201
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       Y2(XN6)
     C                   MOVE      *BLANKS       E2(XN6)
     C                   MOVE      *ZEROS        G2(XN6)
     C                   MOVE      *ZEROS        S2(XN6)
     C                   MOVE      *BLANKS       P2(XN6)
     C                   MOVE      *ZEROS        B2(XN6)
     C     STF201        TAG
     C     Y2(XN6)       IFNE      'TA'                                           3<-B
     C     Y2(XN6)       ANDNE     *BLANKS
     C                   ADD       B2(XN6)       WFISUM
     C     Y2(XN6)       IFNE      'EC'                                            4<-B
     C     Y2(XN6)       ANDNE     'GC'
     C     Y2(XN6)       ANDNE     'RR'
     C                   ADD       B2(XN6)       WFIMVG
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * DEKLARER TOLL DERSOM PVA IKKE="F"
     C     WFPVA         IFNE      'F'
     C                   MOVE      'TL'          Y1(XN4)
     C                   MOVE      '1  '         E1(XN4)
     C                   Z-ADD     WFITLG        G1(XN4)
     C                   Z-ADD     WFISAT        S1(XN4)
     C                   MOVE      WFIPRO        P1(XN4)
     C                   MOVE      WFITOL        B1(XN4)
     C  N92
     CANN94              ADD       WFITOL        WFIMVG
S07  C*                  MOVE      *BLANKS       TR(XN4)
     C                   ADD       1             XN4
     C                   END
      * Selv ved TA mindre enn 5 (93 ON) skal den oppgis på linjenivå
      * Det er sats > 0 som er avgjørende, IKKE beløp > 0
     C                   Z-ADD     WFIMVG        VFIMVG            9 0
S07  C*    SIAS          IFGT      0
S07  C*                  MOVE      'TA'          Y1(XN4)
S07  C*                  MOVE      '1  '         E1(XN4)
S07  C*                  Z-ADD     WFITRG        G1(XN4)
S07  C*                  Z-ADD     SIAS          S1(XN4)
S07  C*                  MOVE      WFITRP        P1(XN4)
S07  C*                  MOVE      WFITRA        B1(XN4)
S07  C*                  MOVE      SIKDH         TR(XN4)
S07  C*                  ADD       1             XN4
S07   * VFIMVG er grunnlag uavhengig av TA < 5 (benyttes på linjenivå)
S07   * WFIMVG er justert for TA kun når TA > 5 (benyttes på totalnivå)
S07  C* N93              ADD       WFITRA        WFIMVG
S07  C* N93              ADD       WFITRA        WFISUM
S07  C*                  ADD       WFITRA        VFIMVG
S07  C*                  END
      *
     C                   Z-ADD     1             XN6               1 0
     C     XN6           DOWLE     5
     C     Y2(XN6)       IFNE      *BLANKS
S07  C*    Y2(XN6)       IFEQ      'TA'
S07   * Trafikkavgift skal angis/inngå i Tollgrunnlag på enkeltlinjer
S07   * selv om TA er under 5 kr (VFIMVG=grl. detalj WFIMVG=grl. total)
S07  C*                  ADD       B2(XN6)       VFIMVG
S07  C* N93
S07  C*NN94              ADD       B2(XN6)       WFIMVG
S07  C* N93              ADD       B2(XN6)       WFISUM
S07  C*                  MOVE      SIKDH         TR(XN4)
S07  C*                  ELSE
S07  C*                  MOVE      *BLANKS       TR(XN4)
S07  C*                  END
     C                   MOVE      Y2(XN6)       Y1(XN4)
     C                   MOVE      E2(XN6)       E1(XN4)
     C                   MOVE      G2(XN6)       G1(XN4)
     C                   MOVE      S2(XN6)       S1(XN4)
     C                   MOVE      P2(XN6)       P1(XN4)
     C                   Z-ADD     B2(XN6)       B1(XN4)
     C                   ADD       1             XN4
     C                   END
     C                   ADD       1             XN6
     C                   END
      *
     C     WFIMVA        IFNE      0
     C     WFIMVG        MULT(H)   FITAX         WFIMVA
      * Det er Mvagrunnl inkl evt TA<5 som skal brukes på detaljnivå
     C     VFIMVG        MULT(H)   FITAX         VFIMVA            9 0
     C                   Z-ADD     FITAXX        S1(XN4)
     C*                    ADD  WFIMVA    WFISUM
     C   92
     CAN 94
     CANN93
     CORN92
     CANN94WFPVA         IFNE      'F'
     C                   ADD       WFITOL        WFISUM
     C                   END
     C  N94              ADD       WFIMVA        WFISUM
     C                   MOVE      'MV'          Y1(XN4)
     C                   MOVE      '1  '         E1(XN4)
      * På detaljnivå er det Tolgrl ink evt TA<5 som benyttes
     C                   Z-ADD     VFIMVG        G1(XN4)
     C                   MOVE      '%'           P1(XN4)
      * På detaljnivå er det Toll med evt.TA<5 som grunnlag som brukes
     C                   MOVE      VFIMVA        B1(XN4)
S07  C*                  MOVE      *BLANKS       TR(XN4)
     C                   END
      *
     C                   MOVE      XSIAS         SIAS
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                        REGN
      */////////////////////////////////////////////////////////////
     C     REGN          BEGSR
N03  C                   IF        WFIVKB123 < 0.5
N03  C                   Z-ADD     1             WFIVKB
N03  C                   ELSE
N03  C                   ADD       0,5           WFIVKB123
N03  C                   END
N03  C                   IF        WFIVKN123 < 0.5
N03  C                   Z-ADD     1             WFIVKN
N03  C                   ELSE
N03  C                   ADD       0,5           WFIVKN123
N03  C                   END
N03   *
     C     SIBELR        IFNE      0
     C     XTVF2         MULT(H)   XBELR2        WFIBBL
     C                   END
      *
     C                   MOVE      *ZEROS        XECEI             9 0
     C                   ADD       0.5           XWFTLG
     C                   ADD       0.5           XWFSTB
      * AVRUNDING VIA DATASTRUKTUR
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     5
     C     B2(XN4)       IFNE      0
     C                   Z-ADD(H)  B2(XN4)       XAVG              9 0
     C                   Z-ADD     XAVG          B2(XN4)
     C                   END
     C                   ADD       1             XN4
     C                   END
     C                   MOVE      *ZEROS        XWFTOL
     C     XPVA1         IFEQ      'P'
     C     WFITLG        MULT      WFISAT        XWORK
     C     XWORK         DIV(H)    100           XWFTOL
     C                   END
     C     XPVA1         IFEQ      'V'
     C     WFIVKN        MULT      WFISAT        XWFTOL
     C                   END
     C     XPVA1         IFEQ      'W'
     C     WFIVKN        MULT      WFISAT        XWFTOL
     C                   DIV(H)    100           XWFTOL
     C                   END
     C     XPVA1         IFEQ      'A'
     C     WFINTM        MULT      WFISAT        XWFTOL
     C                   END
     C                   ADD       0.5           XWFTOL
      *
     C                   MOVE      *ZEROS        XTRAVG            9 0
     C     SIKDTR        IFEQ      *BLANKS
     C     WFIVKN        DIV       1000          XTRAV2           11 3
     C                   MOVE      *BLANKS       WFITRP
     C                   Z-ADD     WFIVKN        WFITRG
     C                   ELSE
     C     WFITLG        DIV       100           XTRAV2
     C                   Z-ADD     WFITLG        WFITRG
     C                   MOVE      '%'           WFITRP
     C                   END
     C     XTRAV2        MULT(H)   SIAS          WFITRA
      *
     C                   MOVE      *ZEROS        WFIMVG
     C                   Z-ADD     1             XN4
      *
     C     XN4           DOWLE     5
S07  C*    Y2(XN4)       IFEQ      'TA'
S07  C*                  Z-ADD     B2(XN4)       XTRAVG
S07  C*                  MOVE      *ZEROS        WFITRA
S07  C*                  ELSE
     C     Y2(XN4)       IFEQ      'BV'                                           3<-B
     C     Y2(XN4)       OREQ      'TO'
     C                   ADD       B2(XN4)       XTOTBV
     C                   END                                                      3<-E
     C     Y2(XN4)       IFEQ      'EC'                                           3<-B
     C     Y2(XN4)       OREQ      'GC'
     C     Y2(XN4)       OREQ      'RR'
     C                   ADD       B2(XN4)       XECEI
     C                   END                                                      3<-E
     C                   ADD       B2(XN4)       WFIMVG
S07  C*                  END
     C                   ADD       1             XN4
     C                   END
      *
     C                   ADD       XTRAVG        WFITRA
     C                   Z-ADD     WFITRA        XTRAVG
     C                   ADD       WFITRA        SIBELT
      * 38 PÅ = TOLLFRANKO
     C   38              DO
     C     WFITLG        SUB       XTRAVG        XHELP             9 0
     C     WFITLG        SUB       WFISTB        WFIJUS
     C     WFIJUS        SUB       XTRAVG        WFIJUS
      *  WFISAT PÅ F.EKS 25,75  LEGGES I ARB.FELT SOM 1.2575
      *  FOR Å KUNNE TREKKE UT TOLL SOM ALT ER INNKALK. I HAND.FAKTURA.
      * VERDITOLL
     C  N52              MOVE      WFISAT        XTSATS            7 4
     C  N52              ADD       1             XTSATS
     C  N52XHELP         DIV(H)    XTSATS        WFITLG
     C  N52WFITLG        MULT(H)   WFISAT        WFITOL
     C  N52              DIV(H)    100           WFITOL
      * VEKTTOLL
     C   52WFIVKN        MULT(H)   WFISAT        WFITOL
     C   52XHELP         SUB       WFITOL        WFITLG
     C     WFIJUS        SUB       WFITOL        WFIJUS
     C     WFIJUS        IFLT      0
     C                   MULT      -1            WFIJUS
     C                   MOVE      '-'           WFIFTG
     C                   ELSE
     C                   MOVE      *BLANKS       WFIFTG
     C                   END
     C                   END
      * ADDERE JUSTERINGSBELØP
     C                   ADD       SJBELN        WFITLG
      *
     C  N38WFITLG        IFGE      WFISTB
     C                   MOVE      *BLANKS       WFIFTG
     C     WFITLG        SUB       WFISTB        WFIJUS
     C                   ELSE
     C                   MOVE      '-'           WFIFTG
     C     WFISTB        SUB       WFITLG        WFIJUS
     C                   END
      *
     C                   Z-ADD     WFITLG        WFISTB
     C                   ADD       WFITOL        WFIMVG
     C                   Z-ADD     WFIMVG        WFISUM
     C     SIBELR        IFEQ      0
     C                   ADD       WFITLG        WFIMVG
     C                   ELSE
     C                   ADD       WFIBBL        WFIMVG
     C                   END
     C                   SUB       XECEI         WFIMVG
     C   52              Z-ADD     WFIVKN        WFITLG
     C   53              Z-ADD     XNTM          WFITLG
     C                   Z-ADD     SIAVD         WFAVD
     C                   Z-ADD     SITDN         WFTDN
     C                   MOVE      XNR           WFIRNR
     C                   MOVE      XPVA1         WFPVA
      * Fyll ut default-verdier hvis blank.
     C                   MOVE      '0'           *IN34
S03  C*    BLAN17        LOOKUP    KN                                 34
N03  C     BLAN28        LOOKUP    KN                                 34
     C  N34              MOVEL     'ADR'         KN(1)
      *
     C     WFIVT         IFEQ      *BLANKS
     C                   MOVEL     'EX'          WFIVT
     C                   END
      *
     C                   MOVE      '0'           *IN34
S03  C*    BLAN15        LOOKUP    VB                                 34
S03  C* N34TARIK         CHAIN     TARI                               34
S03  C* N34              MOVEL     TAALFA        VB(1)
N03  C     BLAN30        LOOKUP    VB                                 34
N03  C                   IF        *IN34 = *OFF
N03  C     WFIVNT        CHAIN     SOKTARI2                           34
N03  C                   IF        *IN34
N03  C     TARIK         CHAIN     TARI                               34
N03  C  N34              EVAL      VB(1) = TAALFA
N03  C                   ELSE
N03  C                   EVAL      VB(1) = BESKR1
N03  C                   END
N03  C                   END
      * Ordne justering og vekt
     C                   ADD       SVVKTB        XTVKTB
     C     SIFTG2        IFEQ      '-'
     C     SIFTG2        OREQ      'M'
     C                   SUB       WFIJUS        XTJUS
     C                   ELSE
     C                   ADD       WFIJUS        XTJUS
     C                   END
      *
     C     WFKEY         CHAIN     WFILEIMP                           34
     C   34              WRITE     WFILEIR
      *
     C                   Z-ADD     WFIMVG        XTOT10           13 2
     C     WFIMVG        ADD       WFITRA        XTOT20           13 2
     C     WFIMVA        IFNE      0
     C     XTOT10        MULT(H)   FITAX         XTOT10
     C     XTOT20        MULT(H)   FITAX         XTOT20
     C                   ADD       XTOT10        XTOT1
     C                   ADD       XTOT20        XTOT2
     C                   END
     C                   ADD       WFITRA        XTOT2
     C                   ADD       WFISUM        XTOT1
     C                   ADD       WFISUM        XTOT2
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                        REGN2
      */////////////////////////////////////////////////////////////
      * Summerer avgifter av samme type for SUM pr type
     C     REGN2         BEGSR
     C                   EXSR      FLYTT2
      *
     C                   ADD       WFISUM        SIBEL7
     C  N94              ADD       WFITOL        T2(19)
     C                   ADD       WFITOL        XBEL5
      *
     C     WFIMVA        IFNE      0
     C  N94              ADD       WFIMVA        T2(20)
     C                   ADD       WFIMVA        XBEL6
     C                   MOVE      'MV'          T1(20)
     C                   END
      *
     C                   Z-ADD     6             XN6
     C     WFITOL        IFNE      0
     C  N94              Z-ADD     WFITOL        B2(XN6)
     C   94              MOVE      *ZEROS        B2(XN6)
     C                   MOVE      'TL'          Y2(XN6)
     C                   MOVE      '1  '         E2(XN6)
     C                   EXSR      TYPLIK
     C                   END
      *
S07  C* N93SIAS          IFGT      0
S07  C*                  MOVE      'TA'          Y2(XN6)
S07  C*                  MOVE      '1  '         E2(XN6)
S07  C*                  Z-ADD     WFITRA        B2(XN6)
S07  C*                  EXSR      TYPLIK
S07  C*                  MOVE      SIKDH         T3(XN4)
S07  C*                  END
      *
     C                   Z-ADD     1             XN6
     C     XN6           DOWLE     5
     C     Y2(XN6)       IFEQ      *BLANKS
     C                   GOTO      SLREGN
     C                   END
S07  C*    Y2(XN6)       IFEQ      'TA'
S07  C*                  MOVE      SIKDH         T3(XN6)
S07  C*                  END
     C                   EXSR      TYPLIK
     C                   END
      *
     C     SLREGN        ENDSR
      */////////////////////////////////////////////////////////////
      *                                                       TYPLIK
      */////////////////////////////////////////////////////////////
     C     TYPLIK        BEGSR
      *
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     16
     C     T1(XN4)       IFEQ      *BLANKS
     C     T1(XN4)       OREQ      Y2(XN6)
     C                   GOTO      SLTYPL
     C                   END
     C                   ADD       1             XN4
     C                   END
      *
     C     SLTYPL        TAG
     C     XN4           IFLE      15
     C                   MOVE      Y2(XN6)       T1(XN4)
     C                   ADD       B2(XN6)       T2(XN4)
     C                   END
     C                   ADD       1             XN6
      *
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      *                                                       MOVSWW
      */////////////////////////////////////////////////////////////
     C     MOVSWW        BEGSR
     C                   ADD       1             XNR
      * TØM VARIABLER FOR WFILEIMP
     C                   EXSR      MOVBWF
      * FLYTTE FRA MOTORV.FORTOLLING TIL VARIABLER FOR WFILEIMP
     C                   MOVE      SWAVD         WFAVD
     C                   MOVE      SWTDN         WFTDN
     C                   MOVE      SWLI          WFIRNR
     C                   MOVE      SWVNT         WFIVNT
     C                   MOVE      SWTN          WFITN
     C                   MOVE      SWLK          WFILK
S03  C*                  MOVE      SWVKTB        WFIVKB
S03  C*                  MOVE      SWVKTN        WFIVKN
N03  C                   Z-ADD     SWVKTB        WFIVKB123
N03  C                   Z-ADD     SWVKTN        WFIVKN123
     C                   MOVE      SWPRE         WFIPRE
S04  C*                  MOVE      SWNTM         WFINTM
N04  C                   Z-ADD     SWNTM         WFINTM
     C                   MOVE      SWPVA         WFPVA
     C                   MOVE      SWVF          WFIVF
     C                   MOVE      SWWJUS        WFIJUS
     C                   MOVE      SWWFTG        WFIFTG
     C                   MOVE      SWBELS        WFISTB
     C                   MOVE      SWWMVA        WFIMVA
     C                   MOVE      SWWMVG        WFIMVG
     C                   MOVE      SWWTOL        WFITOL
     C                   MOVE      SWWTLG        WFITLG
     C     XTVF2         MULT(H)   SWBELT        WFIBBL
     C                   MOVE      SWWTRA        WFITRA
     C                   MOVE      SWWSAT        WFISAT
     C                   MOVE      SWWSUM        WFISUM
      * SIKRE AT SÆRAVGIFTENE LIGGER I TOPPEN AV ARRAYENE Y2,G2,S2....
     C                   MOVE      *ZEROS        W2                1 0
     C     1             DO        5             W1                1 0
     C     Y2W(W1)       IFNE      '  '
     C                   ADD       1             W2
     C                   MOVE      Y2W(W1)       Y2(W2)                           AVG.TYPE
     C                   MOVE      E2W(W1)       E2(W2)                           AVG.SEKVEN
     C                   Z-ADD     G2W(W1)       G2(W2)                           GRUNNLAG
     C                   Z-ADD     S2W(W1)       S2(W2)                           SATS
     C                   MOVE      P2W(W1)       P2(W2)                           SATSTYPE
     C                   Z-ADD     B2W(W1)       B2(W2)                           AVG.BELØP
     C                   END
     C                   END
      *
     C                   MOVE      SWWPRO        WFIPRO
     C*MERKE/NR - GÅR SOM PCI - KUN CIFVERDI.MM. HÅNDTERES I PCI0VB
     C*ANTAL/MERKE GÅR SOM PAC                   HÅNDTERES I PAC0VB
     C*VEKT/EFFEKT/KUB+++ GÅR SOM FTX            HÅNDTERES I FTX0VB
     C* CHASSISNR M.M. HÅNDTERES SOM VANLIG R.44.
     C                   MOVEL     SWR441        WFITO1
     C                   MOVEL     SWR442        WFITO2
     C                   MOVEL     SWR443        WFITO3
     C                   MOVEL     SWR444        WFITO4
     C                   MOVEL     SWR445        WFITO5
     C                   MOVE      SWREF1        WFITC1
     C                   MOVE      SWREF2        WFITC2
     C                   MOVE      SWREF3        WFITC3
     C                   MOVE      SWREF4        WFITC4
     C                   MOVE      SWREF5        WFITC5
     C* UDEF I SADW..      MOVE SWITRG    WFITRG
     C*  --- " ----        MOVE SWITRP    WFITRP
     C* DIV. FELT LEGGES I STRENGER VIA DATASTRUKTURER
     C                   MOVE      'V'           DSV
     C                   MOVE      'E'           DSE
     C                   MOVE      'K'           DSK
     C                   MOVE      'C'           DSC
     C                   MOVE      '%'           DSPROT
      *
     C                   MOVE      *ZEROS        BILNUM            6
     C     SWVK66        IFEQ      *ZEROS
     C                   MOVE      SWVK15        BILNUM
     C                   ELSE
     C                   MOVEL     SWVK25        BILNUM
     C                   MOVE      ','           BN(5)
     C                   MOVE      SWVK66        BILNUM
     C                   END
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX1A
     C                   MOVE      SWTX1B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX1B
      *
     C                   MOVE      *ZEROS        BILNUM            6
     C     SWEF56        IFEQ      *ZEROS
     C                   MOVE      SWEF14        BILNUM
     C                   ELSE
     C     SWEF66        IFEQ      *ZEROS
     C                   MOVEL     SWEF14        BILNUM
     C                   MOVE      ','           BN(5)
     C                   MOVE      SWEF55        BILNUM
     C                   ELSE
     C                   MOVEL     SWEF24        BILNUM
     C                   MOVE      ','           BN(4)
     C                   MOVE      SWEF56        BILNUM
     C                   END
     C                   END
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX2A
     C                   MOVE      SWTX2B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX2B
      *
     C                   MOVE      SWTX3A        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX3A
     C                   MOVE      SWTX3B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSTX3B
      *
     C                   MOVE      SWPC1A        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC1A
     C                   MOVE      SWPC1B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC1B
      *
     C                   MOVE      SWPC2B        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC2B
     C                   MOVE      SWPC2C        BILNUM
     C                   EXSR      BLANBI
     C                   MOVE      BILNUM        DSPC2C
      *
     C                   MOVE      '   ,  '      DSPROS
     C                   MOVEL     SWPC2A        PROHEL            3 0
     C                   MOVE      SWPC2A        PRODEC            2 0
     C                   MOVEL     PROHEL        DSPROS
     C                   MOVE      PRODEC        DSPROS
     C     PROHEL        IFLT      100
     C                   MOVEL     ' '           DSPROS
     C                   END
     C                   ENDSR
      */////////////////////////////////////////////////////////////
     C     BLANBI        BEGSR
      * BLANK FORANSTILTE NULLER I BILFORTOLLINGSDS...
     C                   Z-ADD     1             NN                1 0
     C     BN(NN)        DOWEQ     '0'
     C                   MOVE      ' '           BN(NN)
     C     NN            CABEQ     5             UTBLAN
     C                   ADD       1             NN
     C                   END
     C     UTBLAN        ENDSR
      *
      */////////////////////////////////////////////////////////////
      *                                                       MOVBWF
      */////////////////////////////////////////////////////////////
     C     MOVBWF        BEGSR
      *
     C                   MOVE      *BLANKS       VB
     C                   MOVE      *BLANKS       TO
     C                   MOVE      *BLANKS       TC
     C                   MOVE      *ZEROS        WFIVNT
     C                   MOVE      *ZEROS        XNTM
     C                   MOVE      *BLANKS       WFITN
     C                   MOVE      *BLANKS       WFILK
S03  C*                  MOVE      *ZEROS        WFIVKB
S03  C*                  MOVE      *ZEROS        WFIVKN
N03  C                   MOVE      *ZEROS        WFIVKB123
N03  C                   MOVE      *ZEROS        WFIVKN123
     C                   MOVE      *BLANKS       WFIPRE
     C                   MOVE      *ZEROS        WFIANT
     C                   MOVE      *BLANKS       WFIVF
     C                   MOVE      *ZEROS        WFIJUS
     C                   MOVE      *ZEROS        XWFSTB
     C                   MOVE      *ZEROS        XBELR2
     C                   MOVE      *ZEROS        WFIBBL
     C                   MOVE      *BLANKS       WFIFTG
     C                   MOVE      *ZEROS        WFIMVG
     C                   MOVE      *ZEROS        XWFTLG
     C                   MOVE      *ZEROS        XWFTOL
     C                   MOVE      *ZEROS        WFITRA
     C                   MOVE      *ZEROS        WFISUM
     C                   MOVE      *ZEROS        WFISAT
     C                   MOVE      *BLANKS       Y2
     C                   MOVE      *BLANKS       E2
     C                   MOVE      *ZEROS        B2
     C                   MOVE      *ZEROS        G2
     C                   MOVE      *ZEROS        S2
     C                   MOVE      *BLANKS       P2
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_______________
      * Find positions
      *""""""""""""""""
      * Find first non-0 position
     C     WDIR          IFEQ      'L'                                          <-------------I
     C     AXV           DO        AXH           AXV                             <-----------II
     C     A(AXV)        COMP      '0'                                  8383                 II
     C   83              END                                                     <-----------II
      * Find last non-blank position                                     I
     C                   ELSE                                                   <-------------I
      *                                                                  I
     C     SRÅ01         TAG                                                                  I
      *                                                                  I
     C     AXH           IFGT      AXV                                           <-----------II
     C     A(AXH)        ANDEQ     *BLANKS                                                  III
     C                   SUB       1             AXH                                        III
     C                   GOTO      SRÅ01                                                    III
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C                   MOVE      'R'           WDIR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          ANDEQ     'R'                                                      III
     C     WCHAR         IFEQ      ';'                                                      III
     C                   MOVE      ':'           WCHAR
     C                   ENDIF                                                    <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   END                                                     <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I
      * If arrayindex for output array is over 80 Then add a record      I
     C     BX            IFGT      80                                            <-----------II
     C                   WRITE     EDISER                                                    II
     C                   Z-ADD     1             BX                                          II
     C                   MOVE      *BLANKS       SDATA                                       II
     C                   END                                                     <-----------II
      *                                                                  I
     C                   END                                                    <-------------I
      *
     C                   MOVE      'Y'           WCHART
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C     BX            IFGT      80                                           <-------------I
     C                   WRITE     EDISER                                                     I
     C                   Z-ADD     1             BX                                           I
     C                   MOVE      *BLANKS       SDATA                                        I
     C                   END                                                    <-------------I
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      ',  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Sendningsstart                                      UNB0 /
      *////////////////////////////////////////////////////////////
     C     UNB0          BEGSR
      *______________
      * START SEGMENT
      *""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNB+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *______________________
      * SYNTAX IDENTIFIKASJON
      *""""""""""""""""""""""
      * Identifikasjon og versjon
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNOA:1+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________________
      * OVERFØRINGSAVSENDER
      *""""""""""""""""""""
      * Identifikasjon
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0004         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     S0004         CHAIN     EDII                               33
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     IN0007        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________________
      * OVERFØRINGSMOTTAKER
      *""""""""""""""""""""
      * Identifikasjon og Qualifier
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0010         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     S0010         CHAIN     EDII                               33
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     IN0007        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________________________________________
      * DATO/TID FOR FREMSTILLING AV OVERFØRINGEN
      *""""""""""""""""""""""""""""""""""""""""""
      * Dato
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SDT           ADS
     C                   Z-ADD     3             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Tid
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     STM           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________
      * OVERFØRINGENS REFERANSE
      *""""""""""""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0020         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      *______________________________________________
      * APPLIKASJONSREFERANSE (Kun hvis nettverk=IBM)
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     WNETW         IFEQ      '2'                                          <----------I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     '++'          ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     2             AXH                                       I
     C                   MOVE      'N'           WCHART                                    I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     S0026         ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     14            AXH                                       I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   END                                                    <----------I
      *______________
      * TESTINDIKATOR
      *""""""""""""""
     C     S0035         IFGT      '0'                                          <----------I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   SELECT
     C     WNETW         WHENEQ    '1'                                           <--------II
     C                   MOVEL     '++++++'      ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     6             AXH                                      II
     C     WNETW         WHENEQ    '2'                                           <--------II
     C                   MOVEL     '++++'        ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     4             AXH                                      II
     C                   OTHER                                                   <--------II
     C                   MOVEL     '++++++'      ADS                                      II
     C                   Z-ADD     1             AXV                                      II
     C                   Z-ADD     6             AXH                                      II
     C                   ENDSL                                                   <--------II
     C                   MOVE      'N'           WCHART                                    I
     C                   EXSR      SRÅ                                                     I
      *                                                               I
     C                   MOVE      *BLANKS       ADS                                       I
     C                   MOVEL     S0035         ADS                                       I
     C                   Z-ADD     1             AXV                                       I
     C                   Z-ADD     1             AXH                                       I
     C                   EXSR      SRÅ                                                     I
     C                   END                                                    <----------I
      *______________
      * SLUTT SEGMENT
      *""""""""""""""
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsstart                                       UNH0 /
      *////////////////////////////////////////////////////////////
     C     UNH0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNH+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0062         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0065         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     ':1:902:U'    A(1)
     C                   MOVEA     'N:NEP-I+'    A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Felles referanse, deklarant-ID/dato/sekvensnr./versjonsnr.
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0068         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     24            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start på melding                                    BGM0 /
      *////////////////////////////////////////////////////////////
     C     BGM0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'BGM+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M1001         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++137:'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Dato for documentutstedelse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SDT           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':102+'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingskode
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     1             AXV
     C     M1225         IFEQ      '18 '
     C                   MOVEL     '18+ABE'      ADS
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   ELSE
     C                   MOVEL     M1225         ADS
     C                   Z-ADD     3             AXH
     C                   END
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tollstatus for gods                                 CST0 /
      *////////////////////////////////////////////////////////////
     C     CST0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CST++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Deklarasjon (EU=EF/EFTA-land  EX=Ikke EF/EFTA-land)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIDTY         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Deklarasjon (ekspedisjonstyep)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     XDP1          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':104:1+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Transaksjonstype
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SITST         ADS
N08  C                   IF        SITST > 9
     C                   Z-ADD     1             AXV
N08  C                   ELSE
N08  C                   Z-ADD     2             AXV
N08  C                   END
S08  C*                  Z-ADD     1             AXH
N08  C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':112:NO1'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referanser                                          RFF0 /
      *////////////////////////////////////////////////////////////
     C     RFF0          BEGSR
      *__________________________________________
      * Registreringnummer hos fylkesskattesjefen
      *""""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+VA:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referansenummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIRG          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________
      * Godsnummer
      *"""""""""""
      * Segmentnavn
     C     SIDP          IFNE      47
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+XC:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referansenummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIGN          ADS
      * Hvis 1 er bokstav (A/F) og niende utfylt-de ar det AWB-nummer
      * (Da skal bare nummerdelen sendes - bokstaben legges i Konn.nr.)
     C     SIGN91        IFLT      '0'
     C     SIGN99        ANDNE     *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIG014        GODS14           14
     C                   MOVE      SIG615        GODS14
     C                   MOVEL     GODS14        ADS
     C                   END
     C                   Z-ADD     15            AXH
     C                   Z-ADD     1             AXV
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *____________
      * Konnosement
      *""""""""""""
      * Segmentnavn
     C     SIGN71        IFEQ      'P'
     C     SITRM         ANDEQ     50
     C                   GOTO      SLRFF
     C                   END
     C     SIGN71        IFEQ      'D'
     C                   GOTO      SLRFF
     C                   END
      *
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'RFF+LAR:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Referansenummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIPOS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   EXSR      SRÅ
      * Ved Braathen/SAS legg "prefixbokstav" umidd. etter kon.nr
     C     SIGN91        IFEQ      'A'
     C     SIGN91        OREQ      'F'
     C     SIGN9B        IFGE      '0'
     C     SIGN9B        ANDLE     '9'
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIGN91        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
     C                   END
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C     SLRFF         ENDSR
      *////////////////////////////////////////////////////////////
      *  Stedsangivelse                                      LOC0 /
      *////////////////////////////////////////////////////////////
     C     LOC0          BEGSR
      *___________________
      * Innførselslandkode
      *"""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+35:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SILKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________________
      * Innførselstollsted
      *"""""""""""""""""""
      *____________________
      * Varens lagringssted
      *""""""""""""""""""""
     C     SIKDLS        IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+14:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIKDLS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Dato                                                DTM0 /
      *////////////////////////////////////////////////////////////
     C     DTM0          BEGSR
      *_______________________
      * Ønsket behandlingsdato
      *"""""""""""""""""""""""
      * Segmentnavn
     C     M2005B        IFNE      0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DTM+256:'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M2005B        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':102'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetljer                                    TDT0 /
      *////////////////////////////////////////////////////////////
     C     TDT0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TDT+11++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SITRM         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C     SITRM         IFNE      50
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+:::::'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SILKT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Generell indikator                                  GIS0 /
      *////////////////////////////////////////////////////////////
     C     GIS0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
      * Container
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GIS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIKDC         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Navn og adresser                                    NAD0 /
      *////////////////////////////////////////////////////////////
     C     NAD0          BEGSR
      *_________
      * Importør
      *"""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+IM+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Tollkreditnr.
     C     SIKDDK        IFEQ      *BLANKS
     C     SIKTC         ORNE      ' '
      * Kodeform
     C     SIKTC         IFNE      ' '
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIKTC         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
     C                   END
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIKTA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIKTB         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ELSE
      * Ikke kodeform
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Navn
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SINAK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      * Adresse-1
     C     SIADK1        IFEQ      *BLANKS
     C                   MOVEL     '.'           SIADK1
     C                   END
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIADK1        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      * Adresse-2
     C     SIADK2        IFEQ      *BLANKS
     C                   MOVEL     '.'           SIADK2
     C                   END
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIADK2        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      * Adresse-3
     C     SIADK3        IFEQ      *BLANKS
     C                   MOVEL     '.'           SIADK3
     C                   END
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIADK3        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_________
      * Avsender
      *"""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+SE++'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Navn
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SINAS         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Adresse-1
     C                   MOVE      *BLANKS       ADS
     C     SIADS1        IFEQ      *BLANKS
     C                   MOVEL     '.'           ADS
     C                   ELSE
     C                   MOVEL     SIADS1        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      * Adresse-2
     C     SIADS2        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIADS2        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
     C                   END
      * Adresse-3
     C     SIADS3        IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIADS3        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________
      * Deklarant
      *""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+DT+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kundenr. hos tollvesenet
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M3039D        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *________________________
      * Toll- og avgiftsbetaler
      *""""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+AA+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Måneds-/dags-/kontantoppgjør
     C                   MOVE      *BLANKS       ADS
     C     SIKDDK        IFEQ      ' '
     C                   MOVEL     'M'           ADS
     C                   ELSE
     C                   MOVEL     SIKDDK        ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_____________________________________________________
      * Ekspedisjonsenhet hvor deklarasjonen skal ekspederes
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NAD+EE+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Ekspedisjonsenhet
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M3039E        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '::NO1'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontaktinformasjon                                  CTA0 /
      *////////////////////////////////////////////////////////////
     C     CTA0          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CTA++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SISG          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leveringsbetingelser                                TOD0 /
      *////////////////////////////////////////////////////////////
     C     TOD0          BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'TOD+++'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Levereingsbetingelser, kodet
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SILV2         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+1::::'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Leveringsbetingelser
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SILVT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fakturasum / fraktbeløp                             MOA0 /
      *////////////////////////////////////////////////////////////
     C     MOA0          BEGSR
      *___________
      * Fakturasum
      *"""""""""""
      * Segmentnavn
     C     XBEL3         IFNE      0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MOA+4+39'    A(1)
     C                   MOVEA     ':'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beløp
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     XBEL3         ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Valutakode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIVAL3        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *___________
      * Fraktbeløp
      *"""""""""""
      * Segmentnavn
     C     SIBEL8        IFNE      0
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+144:'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beløp
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     SIBEL8        ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Valuta                                              CUX0 /
      *////////////////////////////////////////////////////////////
     C     CUX0          BEGSR
      * Segmentnavn
     C     *IN41         IFNE      '1'
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CUX+2++'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Valutakurs
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     SIVKU         ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSD /
      *////////////////////////////////////////////////////////////
     C     UNSD          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+D'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fakturanummer og dato                               DMS0 /
      *////////////////////////////////////////////////////////////
     C     DMS0          BEGSR
      *
     C     SIFID         IFNE      0                                            1<-B
     C     SIFID         IFNE      99999999                                      2<-B
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DMS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturanummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIFIF         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+137:'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Dato/tid - qualifier
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIFID         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':102+380'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ELSE                                                    2
      *
     C     KEYE          SETLL     SADF                               33
     C     KEYE          READE     SADF                                   33
     C     *IN33         DOWEQ     '0'                                           3<-B
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DMS+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fakturanummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SFTXT         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+137:'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Dato, kodet
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SFDT          ADS                            ÅR MND DAG
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':102+380'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     KEYE          READE     SADF                                   33
      *
     C  N33              END                                                      3<-E
      *
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tollstatus for gods                                CST0V /
      *////////////////////////////////////////////////////////////
     C     CST0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CST+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varepostnummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIRNR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varenummer
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIVNT        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':122:NO1'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Prosedyre, kodet
     C                   MOVE      *BLANKS       ADS
N08  C                   IF        WDT < X_4SIFF
     C                   MOVEL     SIDP          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
N08  C                   ELSE
N08  C                   MOVEL     SIDP_4SIFF    ADS
N08  C                   Z-ADD     1             AXV
N08  C                   Z-ADD     4             AXH
N08  C                   END
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':117:1+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Preferansekode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIPRE        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     ':116:NO1'    A(1)
     C                   MOVEA     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Verdifastsettelseskode
     C                   MOVE      *BLANKS       ADS
     C     WFIVF         IFLE      '0'
     C                   MOVEL     '1'           ADS
     C                   ELSE
     C                   MOVEL     WFIVF         ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':109:1'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Tollnedsettelseskode
     C     WFITN         IFNE      *BLANKS
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFITN         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':110:NO1'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakning                                         PAC0V /
      *////////////////////////////////////////////////////////////
     C     PAC0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall kolli
     C                   MOVE      *BLANKS       ADS
     C     WFIANT        IFEQ      0
     C                   MOVEL     '1'           ADS
     C                   Z-ADD     1             AXH
     C                   ELSE
     C                   MOVEL     WFIANT        ADS
     C                   Z-ADD     6             AXH
     C                   END
     C                   Z-ADD     1             AXV
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Enhet
     C                   MOVE      *BLANKS       ADS
     C     WFIVT         IFEQ      'EX  '
     C                   MOVEL     'PK  '        ADS
     C                   ELSE
     C     WFIVT         IFEQ      *BLANKS
     C                   MOVEL     'PK  '        ADS
     C                   ELSE
     C                   MOVEL     WFIVT         ADS
     C                   END
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakningsidentifikasjon                          PCI0V /
      *////////////////////////////////////////////////////////////
     C     PCI0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   Z-ADD     1             XN3
S03  C*    XN3           DOWLE     5
N03  C     XN3           DOWLE     7
     C     KN(XN3)       ANDNE     *BLANKS
      * Merke & nr.
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     KN(XN3)       ADS
     C                   Z-ADD     1             AXV
S03  C*                  Z-ADD     17            AXH
N03  C                   Z-ADD     28            AXH
     C                   EXSR      SRÅ
     C                   ADD       1             XN3
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster   BILFORTOLLING                         FTX0VB/
      *////////////////////////////////////////////////////////////
     C     FTX0VB        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'FTX+AAA+'    A(1)
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst 1= VEKT....
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     DSFTXV        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst 2= EFFEKT..
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     DSFTXE        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst 3= KUBIKK..
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     DSFTXK        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     29            AXH
     C                   EXSR      SRÅ
      *
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakning   BILFORTOLLING                         PAC0VB/
      *////////////////////////////////////////////////////////////
     C     PAC0VB        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PAC+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall kolli
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SWPACA        ADS
     C                   Z-ADD     4             AXH
     C                   Z-ADD     1             AXV
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '++'          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *7065 TYPE OF PACKAGE ID(=BILMERKE)=IKKE I.H.T. STD-KODER
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SWPACB        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Forpakningsidentifikasjon  BILFORTOLLING           PCI0VB/
      *////////////////////////////////////////////////////////////
     C     PCI0VB        BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'PCI++'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
      * Merke & nr. 1 = CIVVERDI,AVGIFT....
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     DSPCIC        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
     C*
      * DSPCI MÅ LEGGES I TAG1154, ETTER 1153(AAQ = CONT.MERKE)
      * KUN "TRIKS" FORDI TOLLVESENETS SYSTEM KUN VISER EN LINJE MED
      * MERKE/NR (INKL. EVT CONTAINERMERKING)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+AAQ:'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * TOTALER
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     DSPCI         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     26            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Oppringelseslandkode                               LOC0V /
      *////////////////////////////////////////////////////////////
     C     LOC0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+27:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFILK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tollverdi / justering                              MOA0V /
      *////////////////////////////////////////////////////////////
     C     MOA0V         BEGSR
      *----------
      * Tollverdi
      *""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MOA+14+1'    A(1)
     C                   MOVEA     '23:'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beløp
     C                   MOVE      *BLANKS       ADS
     C     WFISTB        IFEQ      0
     C                   MOVEL     '0'           ADS
     C                   Z-ADD     1             AXH
     C                   ELSE
     C                   MOVEL     WFISTB        ADS
     C                   Z-ADD     13            AXH
     C                   MOVE      'L'           WDIR
     C                   END
     C                   Z-ADD     1             AXV
     C                   EXSR      SRÅ
      *----------
      * Justering
      *""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     WFIJUS        IFNE      0
     C                   MOVE      *BLANKS       ADS
     C     WFIFTG        IFEQ      '-'
     C                   MOVEL     '+21:'        ADS
     C                   Z-ADD     4             AXH
     C                   ELSE
     C                   MOVEL     '+160:'       ADS
     C                   Z-ADD     5             AXH
     C                   END
     C                   Z-ADD     1             AXV
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beløp
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIJUS        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
     C                   END
      *--------------------
      * Bearbeidingskostand
      *""""""""""""""""""""
     C     SIBELR        IFNE      0
     C                   MOVE      *BLANKS       ADS
     C     WFIJUS        IFEQ      0
     C                   MOVEL     '++40:'       ADS
     C                   Z-ADD     5             AXH
     C                   ELSE
     C                   MOVEL     '+40:'        ADS
     C                   Z-ADD     4             AXH
     C                   END
     C                   Z-ADD     1             AXV
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Beløp
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIBBL        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     13            AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål                                                MEA0V /
      *////////////////////////////////////////////////////////////
     C     MEA0V         BEGSR
      *___________
      * Bruttovekt
      *"""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MEA+AAF+'    A(1)
     C                   MOVEA     'G+KGM:'      A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     14            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Bruttovekt
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIVKB        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *__________
      * Nettovekt
      *""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MEA+AAF+'    A(1)
     C                   MOVEA     'N+KGM:'      A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     14            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Nettovekt
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFIVKN        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______
      * Mengde
      *"""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   33
     C     *IN33         DOWEQ     '0'
     C     TADATO        IFLE      M0068A
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      M0068A
N01  C     TADTS         ANDGE     M0068A
     C                   LEAVE
     C                   END
     C     TARIK         READPE    TARI                                   33
     C  N33              ENDDO
      *
     C  N33TAENHE        IFNE      *BLANKS
     C     WFINTM        ANDNE     0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MEA+AAF+'    A(1)
     C                   MOVEA     'ZZ+'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Enhet
     C     TAENHE        IFEQ      'stk'
     C     TAENHE        OREQ      'STK'
     C                   MOVE      'NMB'         TAENHE
     C                   END
     C     TAENHE        IFEQ      'par'
     C     TAENHE        OREQ      'PAR'
     C                   MOVE      'NPR'         TAENHE
     C                   END
     C     TAENHE        IFEQ      'lit'
     C     TAENHE        OREQ      'LIT'
     C                   MOVE      'LTR'         TAENHE
     C                   END
     C     TAENHE        IFEQ      'm3 '
     C     TAENHE        OREQ      'M3 '
     C                   MOVE      'MTO'         TAENHE
     C                   END
     C     TAENHE        IFEQ      'm2 '
     C     TAENHE        OREQ      'M2 '
     C                   MOVE      'MTK'         TAENHE
     C                   END
     C     TAENHE        IFEQ      'gra'
     C     TAENHE        OREQ      'GRA'
     C                   MOVE      'GRM'         TAENHE
     C                   END
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TAENHE        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Mengde
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WFINTM        ADS
     C                   Z-ADD     1             AXV
S04  C*                  Z-ADD     7             AXH
N04  C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
     C                   SETOFF                                       33
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Avgifter                                           TAX0V /
      *////////////////////////////////////////////////////////////
     C     TAX0V         BEGSR
     C     1             DO        16            XN3
     C     Y1(XN3)       IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'TAX+1+16'    A(1)
     C                   MOVEA     '1:'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftsbeløp
     C                   MOVE      *BLANKS       ADS
     C                   Z-ADD     1             AXV
     C     B1(XN3)       IFEQ      0
     C                   MOVEL     '0'           ADS
     C                   Z-ADD     1             AXH
     C                   ELSE
     C                   MOVEL     B1(XN3)       ADS
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   END
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftstype
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     Y1(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     ':107:NO1'    A(1)
     C                   MOVEA     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgifts sekvens
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     E1(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     ':105:NO1'    A(1)
     C                   MOVEA     '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftsgrunnlag
     C                   MOVE      *BLANKS       ADS
     C                   MOVE      G1(XN3)       XFD02N            2 0
     C     XFD02N        IFEQ      0
     C                   MOVEL     G1(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   ELSE
     C                   Z-ADD     G1(XN3)       ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   MOVE      'N'           WCHART
     C                   END
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftsats
     C                   MOVE      *BLANKS       ADS
     C     S1(XN3)       IFEQ      0
     C                   MOVEL     '0'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   ELSE
     C                   Z-ADD     S1(XN3)       ØN152
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     13            AXH
     C                   MOVE      'N'           WCHART
     C                   END
     C                   EXSR      SRÅ
      * Havnekasse, kodet
S07  C*    Y1(XN3)       IFEQ      'TA'
S07   *
S07  C*                  MOVE      *BLANKS       ADS
S07  C*                  MOVEL     '+'           ADS
S07  C*                  Z-ADD     1             AXV
S07  C*                  Z-ADD     1             AXH
S07  C*                  MOVE      'N'           WCHART
S07  C*                  EXSR      SRÅ
S07   *
S07  C*                  MOVE      *BLANKS       ADS
S07  C*                  MOVEL     TR(XN3)       ADS
S07  C*                  Z-ADD     1             AXV
S07  C*                  Z-ADD     2             AXH
S07  C*                  EXSR      SRÅ
S07   *
S07  C*                  MOVE      *BLANKS       ADS
S07  C*                  MOVEL     ':139:NO1'    ADS
S07  C*                  Z-ADD     1             AXV
S07  C*                  Z-ADD     8             AXH
S07  C*                  MOVE      'N'           WCHART
S07  C*                  EXSR      SRÅ
S07   *
S07  C*                  END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Nødvendige dokumenter                              DCR0V /
      *////////////////////////////////////////////////////////////
     C     DCR0V         BEGSR
     C     1             DO        5             XN3
     C     TO(XN3)       IFNE      *BLANKS
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DCR+811+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kode for dokument
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TC(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Dokument
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     TO(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Godsbeskrivelse                                    GDS0V /
      *////////////////////////////////////////////////////////////
     C     GDS0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GDS+2'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster                                         FTX0V /
      *////////////////////////////////////////////////////////////
     C     FTX0V         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'FTX+AAA+'    A(1)
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     VB(1)         ADS
     C                   Z-ADD     1             AXV
S03  C*                  Z-ADD     15            AXH
N03  C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
      *
     C     2             DO        5             XN3
     C     VB(XN3)       IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     VB(XN3)       ADS
     C                   Z-ADD     1             AXV
S03  C*                  Z-ADD     15            AXH
N03  C                   Z-ADD     30            AXH
     C                   EXSR      SRÅ
     C                   END
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tollstatus for gods  DFO                           CST0M /
      *////////////////////////////////////////////////////////////
     C     CST0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'CST+1+00'    A(1)
     C                   MOVEA     '000000:1'    A(9)
     C                   MOVEA     '22:NO1+'     A(17)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     23            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Prosedyre, kodet
     C                   MOVE      *BLANKS       ADS
N08  C                   IF        WDT < X_4SIFF
     C                   MOVEL     SIDP          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
N08  C                   ELSE
N08  C                   MOVEL     SIDP_4SIFF    ADS
N08  C                   Z-ADD     1             AXV
N08  C                   Z-ADD     4             AXH
N08  C                   END
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':117:1+'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Preferansekode
     C                   MOVE      *BLANKS       ADS
     C     SIDP          IFEQ      70
     C     SIDP          OREQ      72
     C                   MOVEL     'N'           ADS
     C                   ELSE
     C  N42              MOVEL     'J'           ADS
     C   42              MOVEL     'N'           ADS
     C                   END
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     ':116:NO1'    A(1)
     C                   MOVE      '+'           A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Verdifastsettelseskode
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '1:109:1'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Oppringelseslandkode     DFO                       LOC0M /
      *////////////////////////////////////////////////////////////
     C     LOC0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'LOC+27:'     ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SILKA         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mål          DFO                                   MEA0M /
      *////////////////////////////////////////////////////////////
     C     MEA0M         BEGSR
      *___________
      * Bruttovekt
      *"""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MEA+AAF+'    A(1)
     C                   MOVEA     'G+KGM:'      A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     14            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Bruttovekt
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIVKB         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *_______
      * Mengde
      *"""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     SINTK         IFNE      0
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'MEA+AAF+'    A(1)
     C                   MOVEA     'ZZ+'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Enhet
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'NMB'         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Mengde
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SINTK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Nødvendige dokumenter  DFO                         DCR0M /
      *////////////////////////////////////////////////////////////
     C     DCR0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C     XFT3KD        IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'DCR+811+'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Kode for dokument
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     XFT3KD        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Dokument
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     XFT3          ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     17            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Godsbeskrivelse    DFO                             GDS0M /
      *////////////////////////////////////////////////////////////
     C     GDS0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'GDS+2'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekster   DFO                                   FTX0M /
      *////////////////////////////////////////////////////////////
     C     FTX0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'FTX+AAA+'    A(1)
     C                   MOVEA     '++'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIFT1         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     31            AXH
     C                   EXSR      SRÅ
      *
     C     SIFT2         IFNE      *BLANKS
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Fritekst
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIFT2         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     31            AXH
     C                   EXSR      SRÅ
     C                   END
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSS /
      *////////////////////////////////////////////////////////////
     C     UNSS          BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNS+S'       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Sum avgifter                                       TAX0S /
      *////////////////////////////////////////////////////////////
     C     TAX0S         BEGSR
     C  N93
     CORN94T1(1)         IFNE      *BLANKS
      *___________________
      * Sum av totalavgift
      *"""""""""""""""""""
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'TAX+4+16'    A(1)
     C                   MOVEA     '1:'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftsbeløp
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SIBEL7        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   END                                                    1<E
      *
      *___________________
      * Sum av delavgift
      *"""""""""""""""""""
     C                   Z-ADD     1             XN3
     C  N93
     CORN94XN3           DOWLE     8                                            1<B
      * VED TRAFIKKAVGIFT UNDER 5 KR. IKKE LEGGE UT SEGMENT
S07  C*  93T1(XN3)       IFEQ      'TA'
S07  C*                  MOVE      *BLANKS       T1(XN3)
S07  C*                  END
     C     T1(XN3)       IFNE      *BLANKS                                       2<-B
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'TAX+3+16'    A(1)
     C                   MOVEA     '1:'          A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftsbeløp
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     T2(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     9             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Avgiftstype
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     T1(XN3)       ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     2             AXH
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ':107:NO1'    ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     8             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   END                                                     2<-E
     C                   ADD       1             XN3
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontrolltotaler                                    CNT0S /
      *////////////////////////////////////////////////////////////
     C     CNT0S         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'CNT+5:'      ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     6             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall poster
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     XNR           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     5             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+11:'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall poster
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SINTK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontrolltotaler    SIDP = 70/72  or DFO            CNT0M /
      *////////////////////////////////////////////////////////////
     C     CNT0M         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEA     'CNT+5:1+'    A(1)
     C                   MOVEA     '11:'         A(9)
     C                   Z-ADD     1             AXV
     C                   Z-ADD     11            AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall poster
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     SINTK         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                       UNT0 /
      *////////////////////////////////////////////////////////////
     C     UNT0          BEGSR
      * Segmentnavn
     C                   ADD       1             W0036
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNT+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Antall segmenter i meldingen (inkludert UNH og UNT)
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     W0074         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     M0062         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     12            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Sendningsslutt                                      UNZ0 /
      *////////////////////////////////////////////////////////////
     C     UNZ0          BEGSR
      * Start segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     'UNZ+'        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     W0036         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     7             AXH
     C                   MOVE      'L'           WDIR
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     '+'           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     S0020         ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     10            AXH
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     WAPSTR        ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     4             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Legg in 3 blanke i slutten for IBM IN
     C     WNETW         IFEQ      '2'
     C     1             DO        3
     C                   MOVE      *BLANKS       ADS
     C                   MOVEL     ' '           ADS
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDDO
     C                   ENDIF
      *
     C     BX            IFGT      1
     C                   WRITE     EDISER
     C                   END
     C                   ENDSR
      *
     OSADVR     E            SADVLN
     O                       SVLN
     OSADHR     E            OPDSAD
     O                       SIST
     O                       SIBELT
     O                       SIBEL5
     O                       SIBEL6
     O                       SIBEL7
