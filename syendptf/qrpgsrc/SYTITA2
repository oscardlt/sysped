********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10262 * 02 YBC PTF10 SATS ER UTVIDERT TIL 7.2, INGEN MERKING
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11020 * 03 YBC PTF11 FLERE NYE LAND OG REGIONER
11020 * 04 SH  PTF12 FLERE NYE LAND OG REGIONER
11020 * 05 SH  PTF12 RÅTT FJERNET SLETTING 3 MÅNEDERS POSTER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 06 YBC PTF12 HOPE OVER TARIFF ER UTGÅTT.
      *              TEST OGSÅ OM TARIFF ER UTGÅTT. I SÅ FALL SETTE SLUTTDATO
12236 * 07 YBC PTF12 21069060, 93, 98 og 35019010, 35022090 kan ha to sats med ulike måter
12XXX * 08 SH  PTF12 ikke oppdater dato på tariffnr 22
12XXX * 09 YBC PTF12 Ikke sett sluttdato på tariffnr 99
12XXX * 10 sh  PTF12 Ikke sett sluttdato på tariffnr 77
12XXX * 11 sh  PTF12 Ikke sett sluttdato på tariffnr 88
12XXX * 12 YBC PTF12 Ordinal sats = 0 -> Sett beregningsmåte til F
12275 * 13 YBC PTF12 21069093 og 35022090 er ikke med 2 satser fra 2022. Men 21069094, 95 med.
********************************************************************
      * LES GAMMEL TARI...
      * 1. SAMMENLIGNER GAMMEL OG NY POST.
      *    HVIS DET ER FORSKJELL, SKRIV UT RAPPORT.
      *    HVIS DET ER LIKT, SLETT FRA NY FIL.
      * 2. OPPDATER TEKST OG ALFASØK PÅ TARINY
      *
     H DATEDIT(*DMY)
     FTARI      IP   E           K DISK    RENAME(TARIR:TARIRIN)
     FTARIGM    UF   E           K DISK    RENAME(TARIR:TARIRGM)
     FTARINY    UF   E           K DISK
     F*LISTE     O    F  210        PRINTER OFLIND(*INOF)
     FLISTE     O    F  300        PRINTER OFLIND(*INOF)
N01  D                UDS
N01  D  UDATO                101    108  0
     D                 DS
S03  D* NYPOST                 1    227
S04  D* NYPOST                 1    297
N04  D  NYPOST                 1    339
     D  TASTK                  1      1
     D  TAENHE                 2      4
     D  TAKAP                  5      5
     D  TAKAPA                 6      9
     D  TAORDK                10     10
     D  TAORDB                11     17  2
     D  TAEFTB                18     24  2
     D  TAEFB                 25     31  2
     D  TAEØSB                32     38  2
     D  TATSJB                39     45  2
     D  TATYRB                46     52  2
     D  TAISRB                53     59  2
     D  TAELLB                60     66  2
     D  TABULB                67     73  2
     D  TAPOLB                74     80  2
     D  TAROMB                81     87  2
     D  TAUNGB                88     94  2
     D  TASLOB                95    101  2
     D  TAMULB               102    108  2
     D  TAOULB               109    115  2
     D  TAGRLB               116    122  2
     D  TAFÆRB               123    129  2
     D  TAISTB               130    136  2
     D  TAMARB               137    143  2
     D  TAMEXB               144    150  2
     D  TAVGAB               151    157  2
     D  TAN01B               158    164  2
     D  TAN02B               165    171  2
     D  TAN03B               172    178  2
     D  TAN04B               179    185  2
     D  TAN05B               186    192  2
     D  TAN06B               193    199  2
     D  TAN07B               200    206  2
     D  TAN08B               207    213  2
     D  TAN09B               214    220  2
     D  TAN10B               221    227  2
N03  D  TAN11B               228    234  2
N03  D  TAN12B               235    241  2
N03  D  TAN13B               242    248  2
N03  D  TAN14B               249    255  2
N03  D  TAN15B               256    262  2
N03  D  TAN16B               263    269  2
N03  D  TAN17B               270    276  2
N03  D  TAN18B               277    283  2
N03  D  TAN19B               284    290  2
N03  D  TAN20B               291    297  2
N04  D  TAN21B               298    304  2
N04  D  TAN22B               305    311  2
N04  D  TAN23B               312    318  2
N04  D  TAN24B               319    325  2
N04  D  TAN25B               326    332  2
N04  D  TAN26B               333    339  2
      *
N04   * OBS ALLE POSISJONER UTVIDET MED 200 START
S01  D* NYPOS2               501    531
N01  D  NYPOS2               501    639
     D  TATANR               501    508  0
     D  TATAR                509    511
     D  TADATO               512    519  0
     D  TADTÅ                512    515  0
     D  TADTM                516    517  0
     D  TADTD                518    519  0
     D  TATXT                520    599
     D  TAKAPN               600    601  0
     D  TAALFA               602    616
     D  TAREST               617    618
     D  TAKDAÆ               619    620
     D  TAKDSÆ               621    623
     D  TADTR                624    631  0
     D  TADTRÅ               624    627  0
     D  TADTRM               628    629  0
     D  TADTRD               630    631  0
N01  D  TADTS                632    639  0
N04   * OBS ALLE POSISJONER UTVIDET MED 200 START
      *
     D                 DS
S03  D* GMPOST                 1    227
S04  D* GMPOST                 1    297
N04  D  GMPOST                 1    339
     D  GMSTK                  1      1
     D  GMENHE                 2      4
     D  GMKAP                  5      5
     D  GMKAPA                 6      9
     D  GMORDK                10     10
     D  GMORDB                11     17  2
     D  GMEFTB                18     24  2
     D  GMEFB                 25     31  2
     D  GMEØSB                32     38  2
     D  GMTSJB                39     45  2
     D  GMTYRB                46     52  2
     D  GMISRB                53     59  2
     D  GMELLB                60     66  2
     D  GMBULB                67     73  2
     D  GMPOLB                74     80  2
     D  GMROMB                81     87  2
     D  GMUNGB                88     94  2
     D  GMSLOB                95    101  2
     D  GMMULB               102    108  2
     D  GMOULB               109    115  2
     D  GMGRLB               116    122  2
     D  GMFÆRB               123    129  2
     D  GMISTB               130    136  2
     D  GMMARB               137    143  2
     D  GMMEXB               144    150  2
     D  GMVGAB               151    157  2
     D  GMN01B               158    164  2
     D  GMN02B               165    171  2
     D  GMN03B               172    178  2
     D  GMN04B               179    185  2
     D  GMN05B               186    192  2
     D  GMN06B               193    199  2
     D  GMN07B               200    206  2
     D  GMN08B               207    213  2
     D  GMN09B               214    220  2
     D  GMN10B               221    227  2
N03  D  GMN11B               228    234  2
N03  D  GMN12B               235    241  2
N03  D  GMN13B               242    248  2
N03  D  GMN14B               249    255  2
N03  D  GMN15B               256    262  2
N03  D  GMN16B               263    269  2
N03  D  GMN17B               270    276  2
N03  D  GMN18B               277    283  2
N03  D  GMN19B               284    290  2
N03  D  GMN20B               291    297  2
N04  D  GMN21B               298    304  2
N04  D  GMN22B               305    311  2
N04  D  GMN23B               312    318  2
N04  D  GMN24B               319    325  2
N04  D  GMN25B               326    332  2
N04  D  GMN26B               333    339  2
      *
N04   * OBS ALLE POSISJONER UTVIDET MED 200 START
S01  D* GMPOS2               201    331
N01  D  GMPOS2               501    639
     D  GMTANR               501    508  0
     D  GMTAR                509    511
     D  GMDATO               512    519  0
     D  GMTXT                520    599
     D  GMKAPN               600    601  0
     D  GMALFA               602    616
     D  GMREST               617    618
     D  GMKDAÆ               619    620
     D  GMKDSÆ               621    623
     D  GMDTR                624    631  0
N01  D  GMDTS                632    639  0
N04   * OBS ALLE POSISJONER UTVIDET MED 200 SLUTT
     D                 DS
     D  DATO                   1      8  0
     D  DTÅ                    1      4  0
     D  DTM                    5      6  0
     D  DTD                    7      8  0
      *
     C     *IN99         IFEQ      *OFF
     C     TARGMK        KLIST
     C                   KFLD                    GMTANR
     C                   KFLD                    XATANR            3
     C                   KFLD                    GMDATO
     C     TARINYK       KLIST
     C                   KFLD                    GMTANR
     C                   KFLD                    XATANR            3
     C                   KFLD                    TADATO
N12  C                   IF        TAORDB = 0
N12  C                   EVAL      TAORDK = 'F'
N12  C                   END
S03  C*                  MOVE      NYPOST        G2POST          227
S04  C*                  MOVE      NYPOST        G2POST          297
N04  C                   MOVE      NYPOST        G2POST          339
S01  C*                  MOVE      NYPOS2        G2POS2          131
N01  C                   MOVE      NYPOS2        G2POS2          139
     C     *LOVAL        SETLL     TARINY
     C                   READ(N)   TARINY                                 33
     C   33              MOVE      *ON           *INLR
     C   33              RETURN
     C  N33              MOVE      TADTR         XXDTR             8 0
     C                   MOVE      G2POST        NYPOST
     C                   MOVE      G2POS2        NYPOS2
     C                   Z-SUB     1             GMTANR            8 0
     C                   Z-ADD     1             SIDE              4 0
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           DATO
     C                   MOVE      WTM           TID               6 0
     C                   EXCEPT    PHEAD                                         1 PAGE
     C                   SETON                                        99
     C                   END
     C   OF              ADD       1             SIDE              4 0
     C   OF              EXCEPT    PHEAD
     C   OF              SETOFF                                       OF         OVERFLOW
N12   *
N12  C                   IF        TAORDB = 0
N12  C                   EVAL      TAORDK = 'F'
N12  C                   END
      *
     C     GMTANR        IFEQ      -1
     C                   MOVE      NYPOST        GMPOST
     C                   MOVE      NYPOS2        GMPOS2
     C                   GOTO      SLUTT
     C                   END
      *
     C                   MOVE      NYPOST        G2POST
S01  C*                  MOVE      NYPOS2        G2POS2          131
N01  C                   MOVE      NYPOS2        G2POS2
N06  C                   IF        GMDTS = 0
N06   * TARIFF ER AKTIV
     C                   EXSR      UTPOST
N06  C                   END
     C                   MOVE      G2POST        GMPOST
     C                   MOVE      G2POS2        GMPOS2
     C                   MOVE      G2POST        NYPOST
     C                   MOVE      G2POS2        NYPOS2
      *
     C     SLUTT         TAG
     CLR                 EXSR      UTPOST
      *
     C***********************************************
     C     UTPOST        BEGSR
     C***********************************************
N01  C                   MOVE      'J'           XOPDSDT           1
     C     GMTANR        SETLL     TARINY
     C     GMTANR        READE     TARINY                                 33
N07   *
S13  C*                  IF        (TATANR = 21069060 OR TATANR = 21069093 OR
S13  C*                             TATANR = 21069098 OR TATANR = 35019010 OR
S13  C*                             TATANR = 35022090)
N13  C                   IF        (TATANR = 21069060 OR TATANR = 21069094 OR
N13  C                              TATANR = 21069095 OR TATANR = 21069098 OR
N13  C                              TATANR = 35019010)
N07  C                             AND TAORDK <> GMORDK
N07  C     GMTANR        READE     TARINY                                 33
N07  C                   END
N07   *
     C     *IN33         IFEQ      '0'                                          1<-B
N12  C                   IF        TAORDB = 0
N12  C                   EVAL      TAORDK = 'F'
N12  C                   END
N01  C                   MOVE      'N'           XOPDSDT
     C     STUTP1        TAG
     C     NYPOST        IFEQ      GMPOST                                        2<-B
     C                   DELETE    TARIR
     C                   MOVE      TADTR         G2DTR             8 0
     C     TARGMK        SETLL     TARIGM
     C     TARGMK        READE     TARIGM                                 33
     C                   DOW       *IN33 = *OFF                                   3<-B
N12  C                   IF        TAORDB = 0
N12  C                   EVAL      TAORDK = 'F'
N12  C                   END
S13  C*                  IF        (TATANR = 21069060 OR TATANR = 21069093 OR
S13  C*                             TATANR = 21069098 OR TATANR = 35019010 OR
S13  C*                             TATANR = 35022090)
N13  C                   IF        (TATANR = 21069060 OR TATANR = 21069094 OR
N13  C                              TATANR = 21069095 OR TATANR = 21069098 OR
N13  C                              TATANR = 35019010)
N07  C                             AND TAORDK <> GMORDK
N07  C                   ELSE
     C     NYPOST        IFEQ      GMPOST                                          4<-B
     C                   MOVE      G2DTR         TADTR
     C                   MOVE      G2DTR         GMDTR             8 0
     C                   UPDATE    TARIRGM
     C                   LEAVE
     C                   END                                                       4<-E
N07  C                   END
     C                   UPDATE    TARIRGM
     C     TARGMK        READE     TARIGM                                 33
     C  N33              ENDDO                                                    3<-E
     C                   ELSE                                                    2
     C                   IF        TAALFA = *BLANKS                               3<-B
     C                   MOVE      GMTXT         TATXT
     C                   MOVE      GMALFA        TAALFA
     C                   UPDATE    TARIR
     C                   IF        TATANR > 100                                    4<-B
     C                   EXCEPT    DET1
     C                   END                                                       4<-E
     C                   EXCEPT    DET2
     C                   ELSE                                                     3
     C                   UPDATE    TARIR
     C     TARINYK       READE     TARINY                                 33
     C  N33              GOTO      STUTP1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
      * SLETT 3 MÅNED GAMLE REGISTRERTE TARIFF
n05  C* SLETTET RÅTT
N06  C                   ELSE                                                   1
N06   * TARIFF FINNES IKKE I NEDLASTNINGSFIL. --> UTGÅ --> SETT DAGENSDATO SOM SLUTTDATO
N06  C*                  IF        GMTANR = 44089009
N06  C*                  EVAL      GMTANR = 44089009
N06  C*                  END
N06  C     GMTANR        SETLL     TARIGM
N06  C     GMTANR        READE     TARIGM                                 33
N06  C                   DOW       *IN33 = *OFF                                  2<-B
S13  C*                  IF        (TATANR = 21069060 OR TATANR = 21069093 OR
S13  C*                             TATANR = 21069098 OR TATANR = 35019010 OR
S13  C*                             TATANR = 35022090)
N13  C                   IF        (TATANR = 21069060 OR TATANR = 21069094 OR
N13  C                              TATANR = 21069095 OR TATANR = 21069098 OR
N13  C                              TATANR = 35019010)
N07  C                             AND TAORDK <> GMORDK
N07  C                   ELSE
N06  C                   IF        TADTS = 0                                      3<-B
N08  c     tatanr        ifne      00000022
N09  c     tatanr        andne     00000099
N10  c     tatanr        andne     00000077
N11  c     tatanr        andne     00000088
N06  C                   EVAL      TADTS = DATO
N06  C                   EXCEPT    DET3
N08  C                   END                                                      3<-E
N06  C                   END                                                      3<-E
N07  C                   END
N06  C                   UPDATE    TARIRGM
N06  C     GMTANR        READE     TARIGM                                 33
N06  C                   ENDDO                                                   2<-E
      *
     C                   END                                                    1<-E
     C*
     C                   ENDSR
     C*
     OLISTE     E            PHEAD            02
     O                                           24 '** ENDREDE OG UTGÅENDE  '
     O                                           40 'TOLLTARIFFNR ** '
     O                                           86 'KJØRT DATO:'
     O                       UDATE         Y     96
     O                                          101 'TID:'
     O                       TID                110 '0  :  :  '
     O                                          120 'SIDE:'
     O                       SIDE          Z    125
     OLISTE     E            PHEAD            04
     O                                           24 '------------------------'
     O                       *PLACE              48
     O                       *PLACE              72
     O                       *PLACE              96
     O                       *PLACE             120
     O                       *PLACE             144
     O                       *PLACE             168
     OLISTE     E            PHEAD            05
     O*                                          24 ' KODE   TARIFFNR ST ENH'
     O*                                             ' KAP. PVA ORDIN.  EFTA  '
     O*                                             '  EF    EØS  KROAT. TYRK'
     O*                                             'IA ISRAEL SINGA. CHILE  '
     O*                                             ' MAKED SØR KR JORDAN TUN'
     O*                                             'ISIA MULAND OULAND GRØNL'
     O*                                             '. FÆRØYE INDIA. MAROKK M'
     O*                                             'EXICO V.GAZA LIBANO  SAC'
     O*                                             'U   EGYPT CANADA'
     O                                           24 ' KODE   TARIFFNR ST ENH'
     O                                              ' KAP. PVA ORDINÆR  EFTA   '
     O                                              '  EF       EØS      KROATI'
     O                                              'A  TYRKIA   ISRAEL   SINGA'
     O                                              'AP. CHILE    MARKEDON SØRS'
     O                                              'OREA JORDAN   TUNISIA  MUL'
     O                                              '.LAND OU.LAND  GRØNLAND FÆ'
     O                                              'ÆRØYEN INDIA.ST MAROKKO  M'
     O                                              'EXICO   VESTGAZA LIBANON  '
     O                                              'SACU     EGYPT    CANADA'
     OLISTE     E            PHEAD            06
     O                                           24 '------------------------'
     O                       *PLACE              48
     O                       *PLACE              72
     O                       *PLACE              96
     O                       *PLACE             120
     O                       *PLACE             144
     O                       *PLACE             168
     OLISTE     E            DET1        2
     O              N33                          10 'ENDREDE:'
     O               33                          10 'UTGÅENDE:'
     O                       TATANR              19
     O                       GMSTK               22
     O                       GMENHE              26
     O                       GMKAP               28
     O                       GMKAPA              33
     O                       GMORDK              35
     O                       GMORDB        J     42
     O                       GMEFTB        J
     O                       GMEFB         J
     O                       GMEØSB        J
     O                       GMTSJB        J
     O                       GMTYRB        J
     O                       GMISRB        J
     O                       GMELLB        J
     O                       GMBULB        J
     O                       GMPOLB        J
     O                       GMROMB        J
     O                       GMUNGB        J
     O                       GMSLOB        J
     O                       GMMULB        J
     O                       GMOULB        J
     O                       GMGRLB        J
     O                       GMFÆRB        J
     O                       GMISTB        J
     O                       GMMARB        J
     O                       GMMEXB        J
     O                       GMVGAB        J
     OLISTE     E            DET2        1
     O                                           10 'NY VERDI:'
     O                       TASTK               22
     O                       TAENHE              26
     O                       TAKAP               28
     O                       TAKAPA              33
     O                       TAORDK              35
     O                       TAORDB        J     42
     O                       TAEFTB        J
     O                       TAEFB         J
     O                       TAEØSB        J
     O                       TATSJB        J
     O                       TATYRB        J
     O                       TAISRB        J
     O                       TAELLB        J
     O                       TABULB        J
     O                       TAPOLB        J
     O                       TAROMB        J
     O                       TAUNGB        J
     O                       TASLOB        J
     O                       TAMULB        J
     O                       TAOULB        J
     O                       TAGRLB        J
     O                       TAFÆRB        J
     O                       TAISTB        J
     O                       TAMARB        J
     O                       TAMEXB        J
     O                       TAVGAB        J
     OLISTE     E            DET3        1
     O                                           10 'UTGÅENDE:'
     O                       TATANR              19
     O                       TASTK               22
     O                       TAENHE              26
     O                       TAKAP               28
     O                       TAKAPA              33
     O                       TAORDK              35
     O                       TAORDB        J     42
     O                       TAEFTB        J
     O                       TAEFB         J
     O                       TAEØSB        J
     O                       TATSJB        J
     O                       TATYRB        J
     O                       TAISRB        J
     O                       TAELLB        J
     O                       TABULB        J
     O                       TAPOLB        J
     O                       TAROMB        J
     O                       TAUNGB        J
     O                       TASLOB        J
     O                       TAMULB        J
     O                       TAOULB        J
     O                       TAGRLB        J
     O                       TAFÆRB        J
     O                       TAISTB        J
     O                       TAMARB        J
     O                       TAMEXB        J
     O                       TAVGAB        J
