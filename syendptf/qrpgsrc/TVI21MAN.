********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 SH  PTF12 regenerer hvis finnes fra før
12XXX * 02 SH  PTF12 kaller arc002
12332 * 03 CB  PTF12 Skriv og ut ved godsnummer som slutter på: 'DT'
12336 * 04 CB  PTF12 Oppdater digitoll med dato+sekv.nr
********************************************************************
********************************************************************
      *
     FARKIVL03  UF A E           K DISK
     FSADH      IF   E           K DISK
N04  FSADMOHL1  UF   E           K DISK
N04  FEDIM1     IF   E           K DISK
     D                SDS
     D  ZUSER                254    263
     C     *entry        plist
     C                   PARM                    ARFIRM            2
     c                   parm                    ARAVD             4 0
     c                   parm                    AROPD             7 0
     C     ARKIVK        KLIST
     C                   KFLD                    ARTYPE
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
     C                   EVAL      ARTYPE = 'sl'
      *
     c     key           klist
     c                   kfld                    ARAVD
     c                   kfld                    AROPD
N04  c     edim1key      klist
N04  c                   kfld                    WST               1
N04  c                   kfld                    ARAVD
N04  c                   kfld                    AROPD
N04  c                   EVAL      WST='C'
      *
     c     key           chain     sadh                               33
     C  N33              EXSR      ARKIVSR
     C                   SETON                                        LR        wrkqry
     C                   RETURN
      **********************************************************************************
     C     ARKIVSR       BEGSR
      **********************************************************************************
      * Lag forhåndssendt arkivdokument ved direktefortolling
     C                   IF        %SUBST(SIGN:5:2) >= '01' AND
S03  C*                            %SUBST(SIGN:5:2) <= '12' AND
     C                             %SUBST(SIGN:5:2) <= '12'
S03  C*                            %SUBST(SIGN:8:8) = *BLANKS AND
S03  C*                            %SUBST(SIGN:7:1) = 'D'
N03  C                   IF        %SUBST(SIGN:7:2) = 'D ' OR
N03  C                             %SUBST(SIGN:7:2) = 'DT'
     C                   EVAL      ARUSER = ZUSER
     C                   MOVE      SIKNK         ARKUND
     C     ARKIVK        CHAIN     ARKIVL03                           33
     C                   IF        *IN33
     C                   WRITE     ARKIVR
n01  c                   else
n01  c                   move      ' '           arstat
n01  c                   update    arkivr
n01  c                   move      'N'           nei
N02  C                   CALL      'ARC002CL'
N02  C                   PARM                    ARTYPE
N02  C                   PARM                    ZUSER
N02  C                   PARM                    NEI               1
N03  C                   ENDIF
N04   * Opddater digitoll med dato+sekv.nr
N04  C     EDIM1KEY      CHAIN     EDIM1                              34
N04  C  N34KEY           CHAIN     SADMOHL1                           34
N04  C                   IF        *IN34=*OFF
N04  C                   IF        EH0068A=*ZEROS
N04  C                   EVAL      EH0068A=M0068A
N04  C                   EVAL      EH0068B=M0068B
N04  C                   UPDATE    SADMOHFR
N04  C                   ENDIF
N04  C                   ENDIF
     C                   END
     C                   END
      *
     C                   ENDSR
      *
