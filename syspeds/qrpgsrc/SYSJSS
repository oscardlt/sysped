      *
      ***************************************************************
      *** PROGRAM SKAL HENTE OPPLYSN. FOR ≈ SKRIVE SAMLASTSPESIF. ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01 02 05-26                          ***
      *** LEDIGE INDIKATORER 27-29 31-95                          ***
      ***************************************************************
      *
     FSTED2     IF   E           K DISK
     FMULTKODT  IF   E           K DISK
     FSYSJSSFM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDT≈                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  WSDTSD                 1      2  0
     D  WSDTSM                 3      4  0
     D  WSDTS≈                 5      6  0
     D  WSDTS                  1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
      *
     C     KODSFK        KLIST
     C                   KFLD                    YFUNI
     C                   KFLD                    WSSG
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    YPLNR
     C*
     C*===============================================
     C     *ENTRY        PLIST
     C                   PARM                    UIN01             1
     C                   PARM                    USG2              3
     C                   PARM                    USD               5
     C                   PARM                    UDT               6
     C                   PARM                    UMN              17
     C                   PARM                    UDTS              6
     C                   PARM                    UPRT35           10
     C                   PARM                    UPT35            10
     C                   PARM                    UJBK              1
     C*===============================================
     C*
     C                   MOVE      'SF'          YFUNI             2
     C                   MOVE      'P'           YPUNI             1
     C                   MOVE      USG           WSSG
     C                   MOVE      'J'           WSJBK
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   Z-ADD     35            YPLNR             3 0
     C     KODTPK        CHAIN     KOPR                               99
     C  N99              MOVE      KOPNVN        UPRT35
     C  N99              MOVE      KOPTY         UPT35
     C                   SETOFF                                       99
     C                   MOVE      UPRT35        WSPRT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
     C*
     C   04              DO
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSD
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   GOTO      START
     C                   END
     C*
     C* TESTER DATA P≈ BILDE
     C*
     C     WSSG          IFNE      'ALL'
     C     KODSFK        CHAIN     KOSFR                              99
     C                   END
     C   99              MOVE      'SPS0001'     MSGNR
     C   99              SETON                                        30
     C*
     C     WSSD          CHAIN     STED2                              98
     C   98
     CANN30              MOVE      'SPS0107'     MSGNR
     C   98
     CANN30              SETON                                        30
     C*
     C     WSDT          IFEQ      0
     C     WSMN          COMP      *BLANKS                                97
     C   97
     CANN30              MOVE      'SPV0103'     MSGNR
     C   97
     CANN30              SETON                                        30
     C                   ELSE
     C                   MOVE      WSDT≈         U≈≈               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C   97
     CANN30              MOVE      'SPD0001'     MSGNR
     C   97
     CANN30              SETON                                        30
     C                   END
     C*
     C     WSDTS         IFNE      0
     C                   MOVE      WSDTS≈        U≈≈               2 0
     C                   MOVE      WSDTSM        UMM               2 0
     C                   MOVE      WSDTSD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      96
     C   96
     CANN30              MOVE      'SPD0001'     MSGNR
     C   96
     CANN30              SETON                                        30
     C                   END
     C*
     C   30              GOTO      START
     C*
     C     WSPRT         IFNE      *BLANKS
     C                   MOVE      WSPRT         UPRT35
     C                   END
     C     UPRT35        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT35
     C                   END
     C     UPT35         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT35
     C                   END
     C                   MOVE      WSSG          USG2
     C                   MOVE      WSSD          USD
     C                   MOVE      WSDT          UDT
     C                   MOVE      WSDTD         UDT
     C                   MOVEL     WSDT≈         UDT
     C                   MOVE      WSMN          UMN
     C                   MOVE      WSDTS         UDTS
     C                   MOVE      WSDTSD        UDTS
     C                   MOVEL     WSDTS≈        UDTS
     C                   MOVE      WSJBK         UJBK
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDT≈         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDT≈
     C*
     C                   MOVE      WSDTSD        UDT1              2 0
     C                   MOVE      WSDTSM        UDT2              2 0
     C                   MOVE      WSDTS≈        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTSD
     C                   MOVE      UDT2          WSDTSM
     C                   MOVE      UDT3          WSDTS≈
     C*
     C                   ENDSR
     C*
