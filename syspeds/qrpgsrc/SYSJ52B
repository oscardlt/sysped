********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 YBC PTF11 RETT FEIL FLAGG
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL VISE BOOKING                                 ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 02 04 06 08-11 13 15-26                ***
      *** LEDIGE INDIKATORER 27-30 32 34-99                         ***
      *****************************************************************
      *
     FBOOKING   IF   E           K DISK
     FSYSJ52FB  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BODTRÅ                 1      4  0
     D  BODTRM                 5      6  0
     D  BODTRD                 7      8  0
     D  BODTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  WSDTD1                 1      2  0
     D  WSDTM1                 3      4  0
     D  WSDTÅ1                 5      6  0
     D  WSDT1                  1      6  0
     D                 DS
     D  BODTÅ1                 1      4  0
     D  BODTM1                 5      6  0
     D  BODTD1                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
     D                 DS
     D  BODTÅ2                 1      4  0
     D  BODTM2                 5      6  0
     D  BODTD2                 7      8  0
     D  BODT2                  1      8  0
     D                 DS
     D  WSDTD3                 1      2  0
     D  WSDTM3                 3      4  0
     D  WSDTÅ3                 5      6  0
     D  WSDT3                  1      6  0
     D                 DS
     D  BODTÅ3                 1      4  0
     D  BODTM3                 5      6  0
     D  BODTD3                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  WSDTD4                 1      2  0
     D  WSDTM4                 3      4  0
     D  WSDTÅ4                 5      6  0
     D  WSDT4                  1      6  0
     D                 DS
     D  BODTÅ4                 1      4  0
     D  BODTM4                 5      6  0
     D  BODTD4                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  WSDTD5                 1      2  0
     D  WSDTM5                 3      4  0
     D  WSDTÅ5                 5      6  0
     D  WSDT5                  1      6  0
     D                 DS
     D  BODTÅ5                 1      4  0
     D  BODTM5                 5      6  0
     D  BODTD5                 7      8  0
     D  BODT5                  1      8  0
     D                 DS
     D  WSDTD6                 1      2  0
     D  WSDTM6                 3      4  0
     D  WSDTÅ6                 5      6  0
     D  WSDT6                  1      6  0
     D                 DS
     D  BODTÅ6                 1      4  0
     D  BODTM6                 5      6  0
     D  BODTD6                 7      8  0
     D  BODT6                  1      8  0
     D                 DS
     D  WSDTD7                 1      2  0
     D  WSDTM7                 3      4  0
     D  WSDTÅ7                 5      6  0
     D  WSDT7                  1      6  0
     D                 DS
     D  BODTÅ7                 1      4  0
     D  BODTM7                 5      6  0
     D  BODTD7                 7      8  0
     D  BODT7                  1      8  0
     D                 DS
     D  WSDTD8                 1      2  0
     D  WSDTM8                 3      4  0
     D  WSDTÅ8                 5      6  0
     D  WSDT8                  1      6  0
     D                 DS
     D  BODTÅ8                 1      4  0
     D  BODTM8                 5      6  0
     D  BODTD8                 7      8  0
     D  BODT8                  1      8  0
     D                 DS
     D  WSDTD9                 1      2  0
     D  WSDTM9                 3      4  0
     D  WSDTÅ9                 5      6  0
     D  WSDT9                  1      6  0
     D                 DS
     D  BODTÅ9                 1      4  0
     D  BODTM9                 5      6  0
     D  BODTD9                 7      8  0
     D  BODT9                  1      8  0
     D                UDS
     D  UFIRM                  1      2
     C*
     C                   EXSR      INIT
     C     UFLAGG        IFEQ      9
     C                   GOTO      SLUTT
     C                   END
     C*
     C     START         TAG
     C                   EXFMT     BILDE
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C     START2        TAG
     C   01
     COR 03
     COR 12              GOTO      SLUTT
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START
     C                   END
      *
     C   10
     COR 11              DO
     C                   EXSR      TILV
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      3                                      03
     C  N01
     CANN03              GOTO      START
     C                   GOTO      SLUTT
     C                   END
      *
     C   07              DO
     C                   EXFMT     BILDE03
     C   12              GOTO      START
     C                   GOTO      START2
     C                   END
      *
     C  N05              GOTO      START
     C*
S01  C* N31              Z-ADD     2             UFLAGG
S01  C*  31              Z-ADD     3             UFLAGG
N01  C                   Z-ADD     2             UFLAGG
     C                   CALL      'SYSJ50A'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    BOSG
     C                   PARM                    UFLAGG
     C*** UFLAGG = 5   -->  GÅ TILBAKE TIL SYSJ52I FOR Å VISE B/L
     C     UFLAGG        IFEQ      5
     C                   Z-ADD     0             UFLAGG
     C                   GOTO      SLUTT
     C                   END
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      3                                      03
     C  N01
     CANN03              GOTO      START
     C*
     C     SLUTT         TAG
     C   01              Z-ADD     1             UFLAGG
     C   03              Z-ADD     3             UFLAGG
     C   12              Z-ADD     9             UFLAGG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     POSNBR        IFGE      8
     C     POSNBR        ANDLE     15
     C     LINNBR        IFEQ      2
     C                   MOVE      SOTXT2        YSKMOT            8
     C                   MOVE      BOKNA         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   ELSE
     C     LINNBR        IFEQ      3
     C                   MOVE      SOTXT3        YSKMOT
     C                   MOVE      BOKNS         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C                   END
     C                   END
     C*
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    UFIRM
     C                   PARM                    YSKKNR
     C                   PARM                    YSKMOT
     C                   PARM                    UFLAGG
     C*
     C     SLVISO        ENDSR
     C*
     C***********************************************
     C     TILV          BEGSR
     C***********************************************
     C                   MOVE      WSDTR         UDTR              6 0
     C   11              GOTO      STTV2
     C*
     C     STTV1         TAG
     C                   CALL      'SYSJ52E'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      6
     C                   GOTO      STTV2
     C                   ELSE
     C                   GOTO      SLTV
     C                   END
     C*
     C     STTV2         TAG
     C                   CALL      'SYSJ52F'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      5
     C                   GOTO      STTV1
     C                   END
      *
     C     SLTV          ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOOKK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C*
     C*** UFLAGG=1 --> FRA SPØRRING PÅ BILL OF LADING (SYSJ52I)
     C     UFLAGG        COMP      1                                      31
     C                   Z-ADD     0             UFLAGG
     C*
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BODTR
     C                   MOVE      *ZEROS        WSDT1
     C                   MOVE      *ZEROS        BODT1
     C                   MOVE      *ZEROS        WSDT2
     C                   MOVE      *ZEROS        BODT2
     C                   MOVE      *ZEROS        WSDT3
     C                   MOVE      *ZEROS        BODT3
     C                   MOVE      *ZEROS        WSDT4
     C                   MOVE      *ZEROS        BODT4
     C                   MOVE      *ZEROS        WSDT5
     C                   MOVE      *ZEROS        BODT5
     C                   MOVE      *ZEROS        WSDT6
     C                   MOVE      *ZEROS        BODT6
     C                   MOVE      *ZEROS        WSDT7
     C                   MOVE      *ZEROS        BODT7
     C                   MOVE      *ZEROS        WSDT8
     C                   MOVE      *ZEROS        BODT8
     C                   MOVE      *ZEROS        WSDT9
     C                   MOVE      *ZEROS        BODT9
     C*
     C     BOOKK         CHAIN     BOOKING                            33
     C   33              Z-ADD     9             UFLAGG
     C   33              GOTO      SLINIT
     C                   EXSR      KDTFMT
     C*
     C                   MOVE      'DIV3110'     XMSGNR            7
     C                   Z-ADD     3             XLEVEL            1 0
     C                   Z-ADD     0             XRETUR            1 0
     C                   Z-ADD     8             XMSGL             4 0
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV3111'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C*
     C     SLINIT        ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BODTRD        UDT1              2 0
     C                   MOVE      BODTRM        UDT2              2 0
     C                   MOVE      BODTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      BODTD1        UDT1
     C                   MOVE      BODTM1        UDT2
     C                   MOVE      BODTÅ1        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD1
     C                   MOVE      UDT2          WSDTM1
     C                   MOVE      UDT3          WSDTÅ1
     C*
     C                   MOVE      BODTD2        UDT1
     C                   MOVE      BODTM2        UDT2
     C                   MOVE      BODTÅ2        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD2
     C                   MOVE      UDT2          WSDTM2
     C                   MOVE      UDT3          WSDTÅ2
     C*
     C                   MOVE      BODTD3        UDT1
     C                   MOVE      BODTM3        UDT2
     C                   MOVE      BODTÅ3        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD3
     C                   MOVE      UDT2          WSDTM3
     C                   MOVE      UDT3          WSDTÅ3
     C*
     C                   MOVE      BODTD4        UDT1
     C                   MOVE      BODTM4        UDT2
     C                   MOVE      BODTÅ4        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD4
     C                   MOVE      UDT2          WSDTM4
     C                   MOVE      UDT3          WSDTÅ4
     C*
     C                   MOVE      BODTD5        UDT1
     C                   MOVE      BODTM5        UDT2
     C                   MOVE      BODTÅ5        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD5
     C                   MOVE      UDT2          WSDTM5
     C                   MOVE      UDT3          WSDTÅ5
     C*
     C                   MOVE      BODTD6        UDT1
     C                   MOVE      BODTM6        UDT2
     C                   MOVE      BODTÅ6        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD6
     C                   MOVE      UDT2          WSDTM6
     C                   MOVE      UDT3          WSDTÅ6
     C*
     C                   MOVE      BODTD7        UDT1
     C                   MOVE      BODTM7        UDT2
     C                   MOVE      BODTÅ7        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD7
     C                   MOVE      UDT2          WSDTM7
     C                   MOVE      UDT3          WSDTÅ7
     C*
     C                   MOVE      BODTD8        UDT1
     C                   MOVE      BODTM8        UDT2
     C                   MOVE      BODTÅ8        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD8
     C                   MOVE      UDT2          WSDTM8
     C                   MOVE      UDT3          WSDTÅ8
     C*
     C                   MOVE      BODTD9        UDT1
     C                   MOVE      BODTM9        UDT2
     C                   MOVE      BODTÅ9        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD9
     C                   MOVE      UDT2          WSDTM9
     C                   MOVE      UDT3          WSDTÅ9
     C*
     C                   ENDSR
     C*
