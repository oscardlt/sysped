      *
      ************************************************************
      * SKRIV UT FERJEBOOKING
      ************************************************************
      *
     FTUFE1     IF   E           K DISK
     FLEVEL01   IF   E           K DISK
     FTURER     IF   E           K DISK
     FSTED2     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYTR51FM  CF   E             WORKSTN
     FSYTR51PF  O    E             PRINTER
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  WSDTDT                 1      2  0
     D  WSDTMT                 3      4  0
     D  WSDTÅT                 5      6  0
     D  WSDTT                  1      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE1
     C   03              GOTO      SLUTT
     C   04              EXSR      SØKDTA
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C*
     C                   EXSR      PRINT
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C     TUFE1K        SETLL     TUFE1
     C                   READ      TUFE1                                  94
     C  N94FEFIRM        COMP      WSFENR                             9494
     C  N94FEDAT2        COMP      UUDTT                              94
     C*
     C     *IN94         DOWNE     '1'
     C* KUN FRA / TIL - STED??
     C     WSFROM        IFNE      *BLANKS
     C     WSFROM        ANDNE     FEFROM
     C                   GOTO      NYTUFE
     C                   END
     C     WSTO          IFNE      *BLANKS
     C     WSTO          ANDNE     FETO
     C                   GOTO      NYTUFE
     C                   END
     C* SIDESKIFT ???
     C     LINNR         IFGT      68
     C                   ADD       1             SIDE
     C                   WRITE     HEADP
     C                   Z-ADD     10            LINNR             2 0
     C                   END
     C* BLANKLINJE NÅR SKIFTE I KEYBEGREP
     C     FEDAT2        IFNE      GMDT
     C     FEFROM        ORNE      GMFROM
     C     FETO          ORNE      GMTO
     C                   ADD       1             LINNR
     C                   WRITE     TOMLI
     C                   END
     C*
     C*  KONVERTER DATO TIL INHOUSE
     C                   MOVE      FEDAT2        XEDATE
     C     FIDTFM        IFNE      3
     C                   CALL      'DATFM3'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM                    XEDATE
     C                   END
     C*
     C     FEFROM        CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XEFROM           20
     C   33              MOVE      *BLANKS       XEFROM
     C   33              MOVEL     FEFROM        XEFROM
     C     FETO          CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        XETO             20
     C   33              MOVE      *BLANKS       XETO
     C   33              MOVEL     FETO          XETO
     C     TURERK        CHAIN     TURER                              33
     C   33              MOVE      *BLANKS       TUBILN
     C   33              MOVEL     FEBILN        TUBILN
     C*
     C                   WRITE     DET
     C                   MOVE      FEDAT2        GMDT
     C                   MOVE      FEFROM        GMFROM
     C                   MOVE      FETO          GMTO
     C                   ADD       1             LINNR
     C                   ADD       1             ANTALL
     C     NYTUFE        TAG
     C                   READ      TUFE1                                  94
     C  N94FEFIRM        COMP      WSFENR                             9494
     C  N94FEDAT2        COMP      UUDTT                              94
     C  N94              END
     C*
     C*                    MOVE *BLANKS   LNAVN
     C                   SETON                                        30
     C     ANTALL        IFGT      0
     C                   MOVE      *ZEROS        WSFENR
     C                   MOVE      *BLANKS       WSFROM
     C                   MOVE      *BLANKS       WSTO
     C                   MOVE      'DIV2348'     MSGNR                          *SKREVET
     C                   ELSE
     C                   MOVE      'DIV2349'     MSGNR                          *INGENTING
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SJDATO        BEGSR
     C***********************************************
     C                   CALL      'TESTDATO'
     C                   PARM                    UDTD              2 0
     C                   PARM                    UDTM              2 0
     C                   PARM                    UDTÅ              2 0
     C                   PARM                    UFLAGG            1 0
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       UUSNAV           30
     C                   CALL      'SO1LEV'
     C                   PARM                    WSFENR
     C                   PARM                    FIFIRM
     C                   PARM                    UUSNAV
     C                   ENDSR
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   SETOFF                                       3050
     C                   SETOFF                                       979899
     C                   Z-ADD     0             ANTALL            4 0
     C                   Z-ADD     0             SIDE
     C                   Z-ADD     73            LINNR
     C                   MOVE      *ZEROS        GMDT              8 0
     C                   MOVE      *BLANKS       GMFROM            5
     C                   MOVE      *BLANKS       GMTO              5
     C*
     C*TEST  LEVERANDØR
     C     LEVEK         CHAIN     LEVEL01                            99
     C   99              DO
     C                   SETON                                        30
     C                   MOVE      'SPL0110'     MSGNR
     C                   GOTO      ENDB1
     C                   END
     C*TEST  FRADATO
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      98
     C   98              DO
     C                   SETON                                        30
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      ENDB1
     C                   END
     C*TEST  TILDATO ( OM UTFYLT)
     C     WSDTT         IFEQ      *ZEROS
     C                   MOVE      WSDT          WSDTT
     C                   ELSE
     C                   SETON                                        50
     C                   MOVE      WSDTDT        UDTD
     C                   MOVE      WSDTMT        UDTM
     C                   MOVE      WSDTÅT        UDTÅ
     C                   EXSR      SJDATO
     C     UFLAGG        COMP      1                                      97
     C   97              DO
     C                   SETON                                        30
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      ENDB1
     C                   END
     C                   END
     C*
     C* INGEN FEIL - KONVERTER DATOER TIL Å/M/D
     C                   Z-ADD     WSDT          UDTF6             6 0
     C                   Z-ADD     WSDTT         UDTT6             6 0
     C     FIDTFM        IFNE      3
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM      UDTF6         UDTF6
     C     UDTF6         IFGT      501231
     C     UDTF6         ADD       19000000      UUDT              8 0
     C                   ELSE
     C     UDTF6         ADD       20000000      UUDT
     C                   END
     C*
     C                   CALL      'DATFM5'
     C                   PARM      FIDTFM        FIDTFM
     C                   PARM      UDTT6         UDTT6
     C     UDTT6         IFGT      501231
     C     UDTT6         ADD       19000000      UUDTT             8 0
     C                   ELSE
     C     UDTT6         ADD       20000000      UUDTT
     C                   END
     C                   END
     C*
     C     ENDB1         ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C     TUFE1K        KLIST
     C                   KFLD                    WSFENR
     C                   KFLD                    UUDT
     C                   KFLD                    WSFROM
     C                   KFLD                    WSTO
     C*
     C     TURERK        KLIST
     C                   KFLD                    FEAVD
     C                   KFLD                    FETUR
     C*
     C     LEVEK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSFENR
     C*
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTT
     C*
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
