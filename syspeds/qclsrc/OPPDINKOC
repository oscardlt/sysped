/* OBS!!                                                                      */
/*     - HARDKODET SIKRING AV USERS- FØY TIL DE &USER SOM KAN KJØRE           */
/*                                                                            */
/* OBS!!!  DENNE QUERY-REKKE MÅ BETRAKTES SOM ET HALVFABRIKATA !!!            */
/*     FOR HVER INNTEKTS-"KOLONNE" KJØRES EGEN QUERY I SERIEN OPCSV11..(-19)  */
/*     FOR HVER KOSTNADS-"KOLONNE" KJØRES EGEN QUERY I SERIEN OPCSV21..(-29)  */
/*     DERSOM KUNDE SKAL HA INN NYE KOLONNER=QUERIER SÅ MÅ EN PASS PÅ AT      */
/*            FELTUTVALGENE GJENSIDIG UTELUKKER HVERANDRE SLIK AT SUM AV      */
/*            ALLE KOLONNENE GIR SAMLET OMSETN (ELLER KOSTNAD)                */
/* OBS!!!  STANDARDEN TAR IKKE MED 'TOL'/'MVA' (I QUERY OPCSV12,22 )          */

             PGM
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             RTVJOBA    USER(&USER)

/*     - HARDKODET SIKRING AV USERS- FØY TIL DE &USER SOM KAN KJØRE           */
             IF         COND(&USER *EQ 'JOVO      ') THEN(GOTO USEROK)
             IF         COND(&USER *EQ 'STB       ') THEN(GOTO USEROK)
  /* IKKE BLANT DE UTVALGTE - HOPP UT */
             SNDPGMMSG  MSG('Du er IKKE autorisert for å kjøre denne +
                          rapporten! ')
             GOTO SLUTT


USEROK:
/* OPPDRAGSUTVALG */
             RUNQRY     QRY(OPCSV01) RCDSLT(*YES) QRYFILE((HEADF) (TURER))

/* INNTEKTER      */
             RUNQRY     QRY(OPCSV11) QRYFILE((OPCSV01) (FAKT))
             RUNQRY     QRY(OPCSV12) QRYFILE((OPCSV01) (FAKT))

/* KOSTNADER      */
             RUNQRY     QRY(OPCSV21) QRYFILE((OPCSV01) (FAKT))
             RUNQRY     QRY(OPCSV22) QRYFILE((OPCSV01) (FAKT))

/* KOSTNADER  - NÅR EN VIL HA KLASSIFISERT TR.AVR/AG.AVD/ANNET  */
/*           RUNQRY     QRY(OPCSV31) QRYFILE((OPCSV01) (FAKT))  */
/*           RUNQRY     QRY(OPCSV32) QRYFILE((OPCSV01) (FAKT))  */
/*           RUNQRY     QRY(OPCSV33) QRYFILE((OPCSV01) (FAKT))  */

/* SATT SAMME TIL FIL QTEMP/OPPDINKO   */
             RUNQRY     QRY(OPCSV92) ??OUTTYPE(*OUTFILE)
/* SATT SAMME TIL FIL QTEMP/OPPDINKO - NÅR TR-AVR-INNDELING AV KOST... */
/*           RUNQRY     QRY(OPCSV92) ??OUTTYPE(*OUTFILE)  */
             SNDPGMMSG  MSG('Dersom til *OUTFILE er nå fil OPPDINKO +
                          skapt. Send via meny epost pkt 11')
 SLUTT:      ENDPGM
