     H DECEDIT(',') debug(*yes)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 sende lista på epost
10XXX * 02 SH  PTF10 velge delsystem liste på skjerm selekt avd
10XXX * 03 SH  PTF10 includer / utelat avdelinger
10XXX * 04 SH  PTF11 WSSAM   SAMMENDRAG
10XXX * 05 SH  PTF11 default fra forrige bestilling
10XXX * 06 SH  PTF11 medta duppoppdrag
00XXX * 07 SH  PTF11 fra til periode
10XXX * 08 SH  PTF11 vis kostnad
10XXX * 09 SH  PTF11 endret workfile
10XXX * 10 SH  PTF12 test epostadresse
10XXX * 11 SH  PTF12 utvidet test epostadresse
********************************************************************
      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE         ***
      ***          PURRING AV UFAKTURERTE OPPDRAG              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01 02 04-26                       ***
      *** LEDIGE INDIKATORER 28 29 31-98                       ***
      ************************************************************
N05  FSYPARAF   UF A E           K DISK
     FSYPARAFM  CF   E             WORKSTN
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
N05  D                SDS
N05  D  WSUSER               254    263
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
N02  D                 DS
N02  D  av                     1     80  0
N02  D                                     DIM(20)                              avd
N02  D  WSAV01                 1      4  0
N02  D  WSAV02                 5      8  0
N02  D  WSAV03                 9     12  0
N02  D  WSAV04                13     16  0
N02  D  WSAV05                17     20  0
N02  D  WSAV06                21     24  0
N02  D  WSAV07                25     28  0
N02  D  WSAV08                29     32  0
N02  D  WSAV09                33     36  0
N02  D  WSAV10                37     40  0
N02  D  WSAV11                41     44  0
N02  D  WSAV12                45     48  0
N02  D  WSAV13                49     52  0
N02  D  WSAV14                53     56  0
N02  D  WSAV15                57     60  0
N02  D  WSAV16                61     64  0
N02  D  WSAV17                65     68  0
N02  D  WSAV18                69     72  0
N02  D  WSAV19                73     76  0
N02  D  WSAV20                77     80  0
N02  D  WSAVD                  1     80
     D                UDS
     D  UFIRM                  1      2
     D  UAVDF                 22     25  0
     D  UAVDT                 26     29  0
     D  UDTÅ                  30     31  0
     D  UDTM                  32     33  0
     D  UDTD                  34     35  0
     D  UDT                   30     35  0
     D  UA4                   36     36
     D  USIGN                 37     39
     D  USORT                 40     40
     D  UAGR                  49     55
N02  D  UDELS1                56     56
N02  D  UDELS2                57     57
N02  D  UDELS3                58     58
     D  IUAVD                100    100
N02  D  UAVD                 101    180
N07  D  UPEAAF               181    182  0
N07  D  UPEMMF               183    184  0
N07  D  UPEFRA               181    184  0
N07  D  UPEAAT               185    186  0
N07  D  UPEMMT               187    188  0
N07  D  UPETIL               185    188  0
N08  D  UKOST                189    189
      *
      * alle linjer før start flyttet umerket til init
      *
n05  c                   exsr      init
      *
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
n07  c                   setoff                                       989930
     C                   EXSR      KDTFMT
     C   03              MOVE      '1'           UPIN01
     C   03              GOTO      SLUTT
     C*
     C     *IN(04)       IFEQ      '1'
      * Avd.grp
     C                   CALL      'SYFA59A'
     C                   PARM                    WSAGR
     C                   GOTO      START
     C                   END
      *
      * ikke fra  avdeling større enn til
      *
     C     WSAVDF        COMP      WSAVDT                             99
     C   99              DO
     C                   SETON                                        30
     C                   MOVE      'SPA0003'     MSGNR
     C                   GOTO      START
     C                   END
n10   *
n10   * må ha epost ved XML
n10   *
n10   * til excel
n10  C     WSSKJE        ifeq      'X'
n10  c     wsepos        andeq     *blanks
n10  C                   SETON                                        30
n10  C                   MOVE      'SHU2067'     MSGNR
n10  C                   GOTO      START
n10  C                   END
n11   * eller teste når ikke til skjerm
n10  C     WSSKJE        ifne      'J'
n11  c     wsepos        ifne      *blanks
n10  c                   call      'SYGE126'
n10  c                   parm                    wsepos
n10  c                   parm                    umsgnr            7
n10  c     umsgnr        ifne      *blanks
n10  C                   SETON                                        30
n10  C                   MOVE      UMSGNR        MSGNR
n10  C                   goto      start
n10  C                   endif
n11  C                   endif
n11  C                   endif
     C*
      *
      * periode fra ikke større enn til
      *
N07  c                   move      WPEAAF        UPEAAF
N07  c                   move      WPEMMF        UPEMMF
N07  c                   move      WPEAAT        UPEAAT
N07  c                   move      WPEMMT        UPEMMT
N07  C     UPEFRA        COMP      UPETIL                             98
     c*
N07  C   98              DO
N07  C                   SETON                                        30
N07  C                   MOVE      'SHU1633'     MSGNR
N07  C                   GOTO      START
N07  C                   END
     C*
     c     wsagr         ifne      *blanks
     C                   MOVE      *ZEROS        WSAVDF
     C                   MOVE      9999          WSAVDT
     c                   end
     C                   MOVE      WSAVDF        UAVDF
     C                   MOVE      WSAVDT        UAVDT
     C     WSDT          IFEQ      0
     C                   MOVE      '490101'      UDT
     C                   ELSE
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   END
     C                   MOVE      WSA4          UA4
     C                   MOVE      WSA4          UPA4
     C                   MOVE      WSSAML        USAML
N04  C                   MOVE      WSSAM         USAM
     C                   MOVE      WSSIGN        USIGN
     C                   MOVE      WSSORT        USORT
     C                   MOVE      WSAGR         UAGR
N02  C                   MOVE      WSDELS1       UDELS1
N02  C                   MOVE      WSDELS2       UDELS2
N02  C                   MOVE      WSDELS3       UDELS3
N02  C                   MOVE      WSAVD         UAVD
N03  C                   MOVE      WSIUAV        IUAVD
N06  C                   MOVE      WSDUPP        UDUPP
N08  C                   MOVE      WSKOST        UKOST
     C*
N05  C                   EXSR      OPDSTD
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*********************************************************************
     C     INIT          BEGSR
     C*********************************************************************
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPA4              1
     C                   PARM                    UPIN01            1
     C                   PARM                    UUFAKT            1
     C                   PARM                    USAML             1
N01  C                   PARM                    WSEPOS           70
S05  C*                  PARM                    SKJERM
N05  C                   PARM                    WSSKJE
N04  C                   PARM                    USAM              1
N06  C                   PARM                    UDUPP             1
      *
     C                   MOVE      UPA4          WSA4
     C     UUFAKT        COMP      'J'                                2727
     C                   MOVE      '0'           UPIN01
     C*
     C                   MOVE      'A'           WSSORT
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      'N'           WSSAML
     C                   MOVE      *ZEROS        WSAVDF
     C                   MOVE      9999          WSAVDT
     C                   MOVE      *BLANKS       UAGR
N02  C                   MOVE      *ZEROS        WSAVD
N03  C                   MOVE      'I'           WSIUAV
N04  C                   MOVE      ' '           WSSAM             1
N06  C                   MOVE      'J'           WSDUPP
N07  C                   MOVE      *ZEROS        UPEFRA
N07  C                   MOVE      *ZEROS        UPETIL
N08  C                   MOVE      'J'           WSKOST
     C*
     C     wsuser        chain(N)  syparaf                            33
     C  n33              exsr      movestd
     C                   endsr
N05  C*********************************************************************
N05  C     MOVESTD       BEGSR
N05  C*********************************************************************
N05  C*
N05  c                   move      XSAVDF        WSAVDF
N05  c                   move      XSAVDT        WSAVDT
N05  c                   move      XSAGR         WSAGR
N05  c                   move      XSDT          WSDT
N05  c                   move      XSSAML        WSSAML
N05  c                   move      XSSAM         WSSAM
N05  c                   move      XSSIGN        WSSIGN
N05  c                   move      XSSORT        WSSORT
N05  c                   move      XSDELS1       WSDELS1
N05  c                   move      XSDELS2       WSDELS2
N05  c                   move      XSDELS3       WSDELS3
N05  c                   move      XSSKJE        WSSKJE
N05  c                   move      XSIUAV        WSIUAV
N05  c                   move      XSAV01        WSAV01
N05  c                   move      XSAV02        WSAV02
N05  c                   move      XSAV03        WSAV03
N05  c                   move      XSAV04        WSAV04
N05  c                   move      XSAV05        WSAV05
N05  c                   move      XSAV06        WSAV06
N05  c                   move      XSAV07        WSAV07
N05  c                   move      XSAV08        WSAV08
N05  c                   move      XSAV09        WSAV09
N05  c                   move      XSAV10        WSAV10
N05  c                   move      XSAV11        WSAV11
N05  c                   move      XSAV12        WSAV12
N05  c                   move      XSAV13        WSAV13
N05  c                   move      XSAV14        WSAV14
N05  c                   move      XSAV15        WSAV15
N05  c                   move      XSAV16        WSAV16
N05  c                   move      XSAV17        WSAV17
N05  c                   move      XSAV18        WSAV18
N05  c                   move      XSAV19        WSAV19
N05  c                   move      XSAV20        WSAV20
n09  c                   move      xsdupp        wsdupp
n09  c                   move      xskost        wskost
N05  c                   move      XSA4          WSA4
N05  c                   move      XSEPOS        WSEPOS
N05  c                   endsr
N05  C*********************************************************************
N05  C     OPDSTD        BEGSR
N05  C*********************************************************************
N05  C     WSUSER        chain     syparaf                            33
N05  C*
N05  c                   move      WSAVDF        XSAVDF
N05  c                   move      WSAVDT        XSAVDT
N05  c                   move      WSAGR         XSAGR
N05  c                   move      WSDT          XSDT
N05  c                   move      WSSAML        XSSAML
N05  c                   move      WSSAM         XSSAM
N05  c                   move      WSSIGN        XSSIGN
N05  c                   move      WSSORT        XSSORT
N05  c                   move      WSDELS1       XSDELS1
N05  c                   move      WSDELS2       XSDELS2
N05  c                   move      WSDELS3       XSDELS3
N05  c                   move      WSSKJE        XSSKJE
N05  c                   move      WSIUAV        XSIUAV
N05  c                   move      WSAV01        XSAV01
N05  c                   move      WSAV02        XSAV02
N05  c                   move      WSAV03        XSAV03
N05  c                   move      WSAV04        XSAV04
N05  c                   move      WSAV05        XSAV05
N05  c                   move      WSAV06        XSAV06
N05  c                   move      WSAV07        XSAV07
N05  c                   move      WSAV08        XSAV08
N05  c                   move      WSAV09        XSAV09
N05  c                   move      WSAV10        XSAV10
N05  c                   move      WSAV11        XSAV11
N05  c                   move      WSAV12        XSAV12
N05  c                   move      WSAV13        XSAV13
N05  c                   move      WSAV14        XSAV14
N05  c                   move      WSAV15        XSAV15
N05  c                   move      WSAV16        XSAV16
N05  c                   move      WSAV17        XSAV17
N05  c                   move      WSAV18        XSAV18
N05  c                   move      WSAV19        XSAV19
N05  c                   move      WSAV20        XSAV20
n09  c                   move      wsdupp        xsdupp
n09  c                   move      wskost        xskost
N05  c                   move      WSA4          XSA4
N05  c                   move      WSEPOS        XSEPOS
N05  C   33              WRITE     SYPARAFR
N05  C  N33              UPDATE    SYPARAFR
N05  c                   endsr
