      * Validere ett oppdrag (det meste er validert av eSpedsg client prog
      *          Varelinjer valideres i eget prog - se TJGE23RV
      *********************************************************************
CRTPG+*  CRTPGM SYSPED/TJEOPD6LV MODULE(*LIBL/TJEOPD6LV *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
      *********************************************************************
      *  01 PTF11 JOV  Beregne tillegskoder  +
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FBRPARF    IF   E           K DISK    USROPN
     FFIRM      IF   E             DISK    USROPN
     FHEAD1     IF   E             DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D P               S              5U 0
     D WSUSER          S             10
     D HEAVDA          S              4
     D NEWSYAVA        S              4
     D NEWAVD          S              4  0
     D HEOPDA          S              7
     D NEWOPD          S              7  0
     D WMODE           S              2
     D WHESG           S              3
     D NEWHESG         S              3
N14  D WSSCONT         S             30
N14  D WSSTLF          S             30
N14  D WSSMAIL         S             70
N14  D WSKCONT         S             30
N14  D WSKTLF          S             30
N14  D WSKMAIL         S             70
     D WSATAD          S              8  0
     D WSATAK          S              4  0
     D WSATDD          S              8  0
     D WSATDK          S              4  0
     D WSETAD          S              8  0
     D WSETAK          S              4  0
     D WSETDD          S              8  0
     D WSETDK          S              4  0
N14  D HEBODT          S              8  0
N14  D WSBOTM          S              4  0
     D WA              S             15
     D JSONstring      S          32000
     D NyErr           S            150                                         en errormelding
     D NyVal           S            150                                         en infomelding
     D NyInf           S            150                                         en ny value i svar
     D Error           S           5000                                         flere feilmeldinger
     D InfoMsg         S           5000                                         flere infomeldinger
     D Values          S           5000                                         Flere nye verdier
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
      * tilleggsgebyrer
n04  D                 DS
n04  D  WTG                    1      5
n04  D   XHESTN1               1      1
n04  D   XHESTN2               2      2
n04  D   XHESTN3               3      3
n04  D   XHESTN4               4      4
n04  D   XHESTN5               5      5

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C  N50              EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬heavd¬ : ¬'+%trim(%editc(HEAVD:'Z'))+'¬, '
        +'¬heopd¬ : ¬'+%trim(%editc(HEOPD:'Z'))+'¬, '
        +'¬hesg¬ : ¬'+%trim(WHESG)+'¬, '
        +'¬infoMsg¬ : ¬'+%trim(InfoMsg)+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     C                   eval      JSONstring ='"ordervalidate" : ['
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * kunne her returnere en liste over felt som har fått nye verdier fra serverside ....
     c                   if        Values = *blanks
     c                   eval      JSONstring = *blanks
     c                   else
     C                   eval      JSONstring = '{' + %trim(values) + '}'
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
     c                   endif
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
     C                   callp     updHTMLvar('JSONstring':JSONstring)
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     FIRM
     C  N50              CLOSE     BRPARF
     C  N50              CLOSE     HEAD1

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      HEAVDA = zhbgetvar('AVD')
     C                   EVAL      HEAVD  = c2n2(HEAVDA)
     C                   EVAL      NEWSYAVA = zhbgetvar('NEWAVD')
     C                   EVAL      NEWAVD  = c2n2(NEWSYAVA)
     C                   EVAL      HEOPDA = zhbgetvar('OPD')
     C                   EVAL      HEOPD  = c2n2(HEOPDA)
     C                   EVAL      WMODE  = zhbgetvar('MODE')
     C                   EVAL      WHESG  = zhbgetvar('HESG')
     C                   EVAL      NEWHESG      = zhbgetvar('NEWHESG')
     C                   EVAL      HEST  = zhbgetvar('HEST')
     C                   EVAL      HEUR   =zhbgetvar('HEUR')
     C                   if        HEUR   = ' '
     C                   EVAL      HEUR   = 'H'
     C                   endif
     C                   EVAL      WA     =zhbgetvar('HEDTOP')
     C                   EVAL      HEDTOP =c2n2(WA)
     C                   EVAL      HESDFF =zhbgetvar('HESDFF')
     C                   EVAL      HESDF  =zhbgetvar('HESDF')
     C                   EVAL      HESDT  =zhbgetvar('HESDT')
     C                   EVAL      HESDVT =zhbgetvar('HESDVT')
     C                   EVAL      HEGN   =zhbgetvar('HEGN')
     C                   EVAL      HEGNN  =zhbgetvar('HEGNN')
     C                   EVAL      WA     =zhbgetvar('HEPRO')
     C                   EVAL      HEPRO  =c2n2(WA)
     C                   EVAL      HEPLAN =zhbgetvar('HEPLAN')
     C                   EVAL      WA     =zhbgetvar('TRRUND')
     C                   EVAL      TRRUND =c2n2(WA)
     C                   EVAL      HEPOS1 =zhbgetvar('HEPOS1')
     C                   EVAL      WA     =zhbgetvar('HEPOS2')
     C                   EVAL      HEPOS2 =c2n2(WA)
N01  C                   EVAL      WA     =zhbgetvar('TRKNFA')
     C                   EVAL      TRKNFA =c2n2(WA)
N01  C                   EVAL      HENAO  =zhbgetvar('HENAO')
     C                   EVAL      WA     =zhbgetvar('HEKNA')
     C                   EVAL      HEKNA  =c2n2(WA)
     C                   EVAL      HENAA  =zhbgetvar('HENAA')
N01  C                   EVAL      HERFA  =zhbgetvar('HERFA')
     C                   EVAL      HESAML =zhbgetvar('HESAML')
     C                   EVAL      HEHAWB =zhbgetvar('HEHAWB')
N01  C                   EVAL      HESDLA =zhbgetvar('HESDLA')
     C                   EVAL      HESDL  =zhbgetvar('HESDL')
     C                   EVAL      HEVALT =zhbgetvar('HEVALT')
     C                   EVAL      WA     =zhbgetvar('HEVALP')
     C                   EVAL      HEVALP =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEKNT')
     C                   EVAL      HEKNT  =c2n2(WA)
     C                   EVAL      HELKA  =zhbgetvar('HELKA')
     C                   EVAL      WA     =zhbgetvar('HEKNS')
     C                   EVAL      HEKNS  =c2n2(WA)
     C                   EVAL      HENAS  =zhbgetvar('HENAS')
     C                   EVAL      HEADS1 =zhbgetvar('HEADS1')
     C                   EVAL      HEADS2 =zhbgetvar('HEADS2')
N01  C                   EVAL      HEPNS  =zhbgetvar('HEPNS')
     C                   EVAL      HEADS3 =zhbgetvar('HEADS3')
     C                   EVAL      HELKS  =zhbgetvar('HELKS')
N01  C                   EVAL      WA     =zhbgetvar('HEKNH')
     C                   EVAL      HEKNH  =c2n2(WA)
N01  C                   EVAL      HENAH  =zhbgetvar('HENAH')
N01  C                   EVAL      HEADH1 =zhbgetvar('HEADH1')
N01  C                   EVAL      HEADH2 =zhbgetvar('HEADH2')
N01  C                   EVAL      HEPNH  =zhbgetvar('HEPNH')
N01  C                   EVAL      HEADH3 =zhbgetvar('HEADH3')
N01  C                   EVAL      HELKH  =zhbgetvar('HELKH')
N01  C                   EVAL      WA     =zhbgetvar('HEHBRE')
     C                   EVAL      HEHBRE =c2n2(WA)
N01  C                   EVAL      WA     =zhbgetvar('HEHLEN')
     C                   EVAL      HEHLEN =c2n2(WA)
N01  C                   EVAL      HEHBLK =zhbgetvar('HEHBLK')
     C                   EVAL      HEKDFS =zhbgetvar('HEKDFS')
     C                   EVAL      HEVALS =zhbgetvar('HEVALS')
     C                   EVAL      WA     =zhbgetvar('HEKNSF')
     C                   EVAL      HEKNSF =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEANS')
     C                   EVAL      HEANS  =c2n2(WA)
     C                   EVAL      HENASF =zhbgetvar('HENASF')
     C                   EVAL      WA     =zhbgetvar('HEKNK')
     C                   EVAL      HEKNK  =c2n2(WA)
     C                   EVAL      HENAK  =zhbgetvar('HENAK')
     C                   EVAL      HEADK1 =zhbgetvar('HEADK1')
     C                   EVAL      HEADK2 =zhbgetvar('HEADK2')
N01  C                   EVAL      HEPNK  =zhbgetvar('HEPNK')
     C                   EVAL      HEADK3 =zhbgetvar('HEADK3')
     C                   EVAL      HELKK  =zhbgetvar('HELKK')
N01  C                   EVAL      WA     =zhbgetvar('HEKNL')
     C                   EVAL      HEKNL  =c2n2(WA)
N01  C                   EVAL      HENAL  =zhbgetvar('HENAL')
N01  C                   EVAL      HEADL1 =zhbgetvar('HEADL1')
N01  C                   EVAL      HEADL2 =zhbgetvar('HEADL2')
N01  C                   EVAL      HEPNL  =zhbgetvar('HEPNL')
N01  C                   EVAL      HEADL3 =zhbgetvar('HEADL3')
N01  C                   EVAL      HELKL  =zhbgetvar('HELKL')
N01  C                   EVAL      WA     =zhbgetvar('HELBRE')
     C                   EVAL      HELBRE =c2n2(WA)
N01  C                   EVAL      WA     =zhbgetvar('HELLEN')
     C                   EVAL      HELLEN =c2n2(WA)
N01  C                   EVAL      HELBLK =zhbgetvar('HELBLK')
     C                   EVAL      HEKDFK =zhbgetvar('HEKDFK')
     C                   EVAL      HEVALK =zhbgetvar('HEVALK')
     C                   EVAL      WA     =zhbgetvar('HEKNKF')
     C                   EVAL      HEKNKF =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEANK')
     C                   EVAL      HEANK  =c2n2(WA)
     C                   EVAL      HENAKF =zhbgetvar('HENAKF')
     C                   EVAL      HEOT   =zhbgetvar('HEOT')
     C                   EVAL      HEKDPL =zhbgetvar('HEKDPL')
     C                   EVAL      HEFR   =zhbgetvar('HEFR')
     C                   EVAL      WA     =zhbgetvar('HENT')
     C                   EVAL      HENT   =c2n2(WA)
     C                   EVAL      HEVS1  =zhbgetvar('HEVS1')
     C                   EVAL      HEVS2  =zhbgetvar('HEVS2')
     C                   EVAL      HEGM1  =zhbgetvar('HEGM1')
     C                   EVAL      HEGM2  =zhbgetvar('HEGM2')
     C                   EVAL      WA     =zhbgetvar('HEVKT')
     C                   EVAL      HEVKT  =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HELM')
     C                   EVAL      HELM   =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEM3')
     C                   EVAL      HEM3   =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEFBV')
     C                   EVAL      HEFBV  =c2n2(WA)
     C                   EVAL      HEKF   =zhbgetvar('HEKF')
     C                   EVAL      HEKFT1 =zhbgetvar('HEKFT1')
     C                   EVAL      HEFT1  =zhbgetvar('HEFT1')
     C                   EVAL      WA     =zhbgetvar('HEDTCP')
     C                   EVAL      HEDTCP =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEDTAP')
     C                   EVAL      HEDTÅP =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEDTMP')
     C                   EVAL      HEDTMP =c2n2(WA)
     C                   EVAL      HEKDKK =zhbgetvar('HEKDKK')
     C                   EVAL      WA     =zhbgetvar('HEFNGK')
     C                   EVAL      HEFNGK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEFNGS')
     C                   EVAL      HEFNGS =c2n2(WA)
     C                   EVAL      HEKDTM =zhbgetvar('HEKDTM')
     C                   EVAL      WA     =zhbgetvar('HETRM')
     C                   EVAL      HETRM  =c2n2(WA)
     C                   EVAL      HETRI  =zhbgetvar('HETRI')
     C                   EVAL      WA     =zhbgetvar('HETRC')
     C                   EVAL      HETRC  =c2n2(WA)
     C                   EVAL      HETRCN =zhbgetvar('HETRCN')
     C                   EVAL      WA     =zhbgetvar('HEFBK')
     C                   EVAL      HEFBK  =c2n2(WA)
     C                   EVAL      HETLE  =zhbgetvar('HETLE')
     C                   EVAL      HETLL  =zhbgetvar('HETLL')
     C                   EVAL      HETLKU =zhbgetvar('HETLKU')
     C                   EVAL      WA     =zhbgetvar('HENTVS')
     C                   EVAL      HENTVS =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEVN')
     C                   EVAL      HEVN   =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HENTF')
     C                   EVAL      HENTF  =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEBELT')
     C                   EVAL      HEBELT =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEBELM')
     C                   EVAL      HEBELM =c2n2(WA)
     C                   EVAL      HESGM  =zhbgetvar('HESGM')
     C                   EVAL      HEDTMO =zhbgetvar('HEDTMO')
     C                   EVAL      WA     =zhbgetvar('HEKLMO')
     C                   EVAL      HEKLMO =c2n2(WA)
     C                   EVAL      HEPK1  =zhbgetvar('HEPK1')
     C                   EVAL      HEPK2  =zhbgetvar('HEPK2')
     C                   EVAL      HEPK3  =zhbgetvar('HEPK3')
     C                   EVAL      HEPK4  =zhbgetvar('HEPK4')
     C                   EVAL      HEPK5  =zhbgetvar('HEPK5')
     C                   EVAL      HEPK6  =zhbgetvar('HEPK6')
     C                   EVAL      HEPK7  =zhbgetvar('HEPK7')
     C                   EVAL      HEPK8  =zhbgetvar('HEPK8')
     C                   EVAL      HEPK9  =zhbgetvar('HEPK9')
     C                   EVAL      HEKDL  =zhbgetvar('HEKDL')
     C                   EVAL      HELB   =zhbgetvar('HELB')
     C                   EVAL      HELKFR =zhbgetvar('HELKFR')
     C                   EVAL      HESDFR =zhbgetvar('HESDFR')
     C                   EVAL      HESTFR =zhbgetvar('HESTFR')
     C                   EVAL      HERFK  =zhbgetvar('HERFK')
     C                   EVAL      TRSLAG =zhbgetvar('TRSLAG')
     C                   IF        TRSLAG = '  ' and HEUR = 'H'
     C                   EVAL      TRSLAG = 'HO'
     c                   endif
     C                   EVAL      WA     =zhbgetvar('TRAVD0')
     C                   EVAL      TRAVD0 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TROPD0')
     C                   EVAL      TROPD0 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRAVD1')
     C                   EVAL      TRAVD1 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TROPD1')
     C                   EVAL      TROPD1 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRAVD2')
     C                   EVAL      TRAVD2 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TROPD2')
     C                   EVAL      TROPD2 =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSFFD')
     C                   EVAL      TRSFFD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSFFK')
     C                   EVAL      TRSFFK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSDFD')
     C                   EVAL      TRSDFD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSDFK')
     C                   EVAL      TRSDFK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSDTD')
     C                   EVAL      TRSDTD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSDTK')
     C                   EVAL      TRSDTK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSVTD')
     C                   EVAL      TRSVTD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('TRSVTK')
     C                   EVAL      TRSVTK =c2n2(WA)
     C                   EVAL      TRKDAK =zhbgetvar('TRKDAK')
     C                   EVAL      TRKDFF =zhbgetvar('TRKDFF')
     c     trkdff        ifeq      ' '
     c     heknsf        ifne      *zeros
     C                   EVAL      TRKDFF = 'S'
     c                   else
     C                   EVAL      TRKDFF = 'K'
     c                   endif
     c                   endif
     c     trkdff        ifeq      'S'
     c                   move      heknsf        frabet            8 0
     c                   move      HEVALS        fraktVal          3
     c                   else
     c                   move      heknkf        frabet
     c                   move      HEVALK        fraktVal          3
     c                   end
     C                   EVAL      TRVERV =zhbgetvar('TRVERV')
     C                   EVAL      WA     =zhbgetvar('TRVERB')
     C                   EVAL      TRVERB =c2n2(WA)
     C                   EVAL      TRETTV =zhbgetvar('TRETTV')
     C                   EVAL      WA     =zhbgetvar('TRETTB')
     C                   EVAL      TRETTB =c2n2(WA)
     C                   EVAL      TRFRAK =zhbgetvar('TRFRAK')
     C                   EVAL      TRFRAV =zhbgetvar('TRFRAV')
     C                   EVAL      WA     =zhbgetvar('TRFRAB')
     C                   EVAL      TRFRAB =c2n2(WA)
     C                   EVAL      TRMVA  =zhbgetvar('TRMVA')
     C                   EVAL      TRFA11 =zhbgetvar('TRFA11')
     C                   EVAL      TRFA12 =zhbgetvar('TRFA12')
     C                   EVAL      WA     =zhbgetvar('TRFLP1')
     C                   EVAL      TRFLP1 =c2n2(WA)
     C                   EVAL      TRFA21 =zhbgetvar('TRFA21')
     C                   EVAL      TRFA22 =zhbgetvar('TRFA22')
     C                   EVAL      WA     =zhbgetvar('TRFLP2')
     C                   EVAL      TRFLP2 =c2n2(WA)
     C                   EVAL      TRTSTA =zhbgetvar('TRTSTA')
     C                   EVAL      TRSTAF =zhbgetvar('TRSTAF')
     C                   EVAL      TRSTAE =zhbgetvar('TRSTAE')
     C                   EVAL      TRSTA1 =zhbgetvar('TRSTA1')
     C                   EVAL      TRSTA2 =zhbgetvar('TRSTA2')
     C                   EVAL      TRSTA3 =zhbgetvar('TRSTA3')
     C                   EVAL      TRSTA4 =zhbgetvar('TRSTA4')
     C                   EVAL      WA     =zhbgetvar('TRKM')
     C                   EVAL      TRKM   =c2n2(WA)
     C                   EVAL      HE01   =zhbgetvar('HE01')
     C                   EVAL      WA     =zhbgetvar('HESTD')
     C                   EVAL      HESTD  =c2n2(WA)
     C                   EVAL      HXSNDN =zhbgetvar('HXSNDN')
     C                   EVAL      WA     =zhbgetvar('HXPALL')
     C                   EVAL      HXPALL =c2n2(WA)
     C                   EVAL      HXBLGK =zhbgetvar('HXBLGK')
     C                   EVAL      HXLKOD =zhbgetvar('HXLKOD')
     C                   EVAL      HXLLST =zhbgetvar('HXLLST')
     C                   EVAL      HXEDIK =zhbgetvar('HXEDIK')
     C                   EVAL      HXTERI =zhbgetvar('HXTERI')
S01  C                   EVAL      WA     =zhbgetvar('HEHAKN')
     C                   EVAL      HEHAKN =c2n2(WA)
S01  C                   EVAL      WA     =zhbgetvar('HEHAAN')
     C                   EVAL      HEHAAN =c2n2(WA)
S01  C                   EVAL      WA     =zhbgetvar('HELAKN')
     C                   EVAL      HELAKN =c2n2(WA)
S01  C                   EVAL      WA     =zhbgetvar('HELAAN')
     C                   EVAL      HELAAN =c2n2(WA)
TMS  C                   EVAL      WA     =zhbgetvar('HELMLA')
     C                   EVAL      HELMLA =c2n2(WA)
TMS  C                   EVAL      WA     =zhbgetvar('HEPOEN')
     C                   EVAL      HEPOEN =c2n2(WA)
TMS  C                   EVAL      HESTL1 =zhbgetvar('HESTL1')
TMS  C                   EVAL      HESTL2 =zhbgetvar('HESTL2')
TMS  C                   EVAL      HESTL3 =zhbgetvar('HESTL3')
TMS  C                   EVAL      HESTL4 =zhbgetvar('HESTL4')
TMS  C                   EVAL      HESTN1 =zhbgetvar('HESTN1')
TMS  C                   EVAL      HESTN2 =zhbgetvar('HESTN2')
TMS  C                   EVAL      HESTN3 =zhbgetvar('HESTN3')
TMS  C                   EVAL      HESTN4 =zhbgetvar('HESTN4')
TMS  C                   EVAL      HESTN5 =zhbgetvar('HESTN5')
TMS  C                   EVAL      HESTN6 =zhbgetvar('HESTN6')
TMS  C                   EVAL      HESTN7 =zhbgetvar('HESTN7')
TMS  C                   EVAL      HESTN8 =zhbgetvar('HESTN8')
TMS  C                   EVAL      HESTN9 =zhbgetvar('HESTN9')
TMS  C                   EVAL      HERFED =zhbgetvar('HERFED')
     C                   EVAL      HELIB  =zhbgetvar('HELIB')
     C                   EVAL      HEFILE =zhbgetvar('HEFILE')
     C                   EVAL      HEMBR  =zhbgetvar('HEMBR')
     C                   EVAL      HETYPE =zhbgetvar('HETYPE')
     C                   EVAL      HELVL  =zhbgetvar('HELVL')
     C                   EVAL      WA     =zhbgetvar('HESNN')
     C                   EVAL      HESNN  =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEUNIK')
     C                   EVAL      HEUNIK =c2n2(WA)
     C                   EVAL      HEREFF =zhbgetvar('HEREFF')
-----C                   EVAL      WSKCONT=zhbgetvar('WSKCONT')
-----C                   EVAL      WSKTLF =zhbgetvar('WSKTLF')
-----C                   EVAL      WSKMAIL=zhbgetvar('WSKMAIL')
-----C                   EVAL      WSSCONT=zhbgetvar('WSSCONT')
-----C                   EVAL      WSSTLF =zhbgetvar('WSSTLF')
-----C                   EVAL      WSSMAIL=zhbgetvar('WSSMAIL')
     C                   EVAL      WA     =zhbgetvar('WSATAD')
     C                   EVAL      WSATAD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSATAK')
     C                   EVAL      WSATAK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSATDD')
     C                   EVAL      WSATDD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSATDK')
     C                   EVAL      WSATDK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSETAD')
     C                   EVAL      WSETAD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSETAK')
     C                   EVAL      WSETAK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSETDD')
     C                   EVAL      WSETDD =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSETDK')
     C                   EVAL      WSETDK =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('HEBODT')
     C                   EVAL      HEBODT =c2n2(WA)
     C                   EVAL      WA     =zhbgetvar('WSBOTM')
     C                   EVAL      WSBOTM =c2n2(WA)
     C                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end


     C   50              EVAL      Error = 'Invalid userID'
     C  N50              OPEN      FIRM
     C  N50              OPEN      BRPARF
     C  N50              OPEN      HEAD1
     c     *IN50         cabeq     '1'           UtInit
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      * Hæmta firmaopplysninger
     C                   READ      FIRM
      * DUMMY READ AV HEAD1 FOR Å FÅ FELTNAVN
     C     *IN33         IFEQ      *OFF
     C     *IN33         ANDEQ     *ON
     C                   READ      HEAD1
     C                   ENDIF
      *
     C     BRPARKeyUs    klist
     C                   kfld                    WSUSER
     C                   kfld                    xxKUNR            8 0
     C                   kfld                    PAID
     C     BRPARKeyFi    klist
     C                   kfld                    FIuser           10
     C                   kfld                    xxKUNR            8 0
     C                   kfld                    PAID
     C                   EVAL      FiUser  = '*KUNDFT*'+BIFIRM
      * div parametre ?? summy chain foreløpig
N39  C                   MOVE      'xxxxx'       PAID
N39  C     BRPARKeyFi    CHAIN     BRPARF                             33
      *
     c     UtInit        ENDSR
      *
      *******************************************************
     C     TEST          BEGSR
      *******************************************************
      *
      /free
        // BRING - Max LM
        if HEOT='OX' or HEOT='LO' or HEOT='OB';
          if HELM > 13.6;
            NyErr='Lastemeter kan ikke vær over 13,6 på ojeekspressoppdrag';
        //  exsr AddErr;
            HELM = 13.6;
            NyVal='¬helm¬ : ¬'+%trim(%editc(HELM:'4'))+'¬';
            exsr AddVal;
          endif;
        endif;
        // BRING - Max antall
        if HENT > 999999;
          NyErr='Antall kolli kan ikke vær over 999999';
          exsr AddErr;
        endif;
      /end-free
     C                   ENDSR
      *
      *******************************************************
     C     AddErr        BEGSR
      *******************************************************
     c                   if        Error = *blanks
     c                   eval      Error = NyErr
     C                   else
     c                   eval      Error = %trim(Error) +'§'+NyErr
     C                   endif
     C                   ENDSR
      *
      *******************************************************
     C     AddInfo       BEGSR
      *******************************************************
     c                   if        InfoMsg = *blanks
     c                   eval      InfoMsg = NyInf
     C                   else
     c                   eval      InfoMsg = %trim(InfoMsg) +'§'+NyInf
     C                   endif
     C                   ENDSR
      *
      *******************************************************
     C     AddVal        BEGSR
      *******************************************************
     c                   if        Values = *blanks
     c                   eval      Values = NyVal
     C                   else
     c                   eval      Values = %trim(Values) +','+NyVal
     C                   endif
     C                   ENDSR
