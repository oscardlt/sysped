********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10028 * 01 YBC PTF10 RESTORDRE
********************************************************************
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE KUNDES DEFAULT VERDIER    ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05-11 13-26                ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-87                ***
      ***********************************************************
      *
     FLLKUNF    UF A E           K DISK
     FKODTA     IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FVADR      IF   E           K DISK
     FLL036D    CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '0000'        *IN(88)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C   03
     COR 12              GOTO      SLUTT
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C                   EXSR      OPDFIL
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSFMVA        IFNE      0
     C     VADRKM        CHAIN     VADR                               99
     C  N30*IN99         IFEQ      '1'
     C                   MOVE      'YBC1869'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   END
     C                   END
      *
     C     WSMAVD        IFNE      0
     C     KODAKM        CHAIN     KODTA                              97
     C  N30*IN97         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   END
     C                   END
      *
     C     WSMOT         IFNE      *BLANKS
     C     KODOKM        CHAIN     KODTOTY                            96
     C  N30*IN96         IFEQ      '1'
     C                   MOVE      'SPO0007'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   END
     C                   END
      *
     C     WSMFR         IFNE      *BLANKS
     C     KODFKM        CHAIN     KODTFR                             95
     C  N30*IN95         IFEQ      '1'
     C                   MOVE      'SPO0006'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     45            POSNBR
     C                   END
     C                   END
      *
     C     WSMAFF        IFEQ      'N'
     C     WSMFAK        ANDEQ     'J'
     C                   SETON                                        94
     C  N30              DO
     C                   MOVE      'YBC1870'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   END
     C                   END
      *
     C     WSMAFF        IFEQ      'N'
     C     WSMFKØ        ANDEQ     'J'
     C     WSMFAK        OREQ      'N'
     C     WSMFKØ        ANDEQ     'J'
     C                   SETON                                        93
     C  N30              DO
     C                   MOVE      'YBC1871'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     45            POSNBR
     C                   END
     C                   END
      *
     C     WSFAVA        IFNE      0
     C     VADRKA        CHAIN     VADR                               98
     C  N30*IN98         IFEQ      '1'
     C                   MOVE      'YBC1869'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   END
     C                   END
      *
     C     WSPAVD        IFNE      0
     C     KODAKP        CHAIN     KODTA                              92
     C  N30*IN94         IFEQ      '1'
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   END
     C                   END
      *
     C     WSPOT         IFNE      *BLANKS
     C     KODOKP        CHAIN     KODTOTY                            91
     C  N30*IN93         IFEQ      '1'
     C                   MOVE      'SPO0007'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   END
     C                   END
      *
     C     WSPFR         IFNE      *BLANKS
     C     KODFKP        CHAIN     KODTFR                             90
     C  N30*IN92         IFEQ      '1'
     C                   MOVE      'SPO0006'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     45            POSNBR
     C                   END
     C                   END
      *
     C     WSPAFF        IFEQ      'N'
     C     WSPFAK        ANDEQ     'J'
     C                   SETON                                        89
     C  N30              DO
     C                   MOVE      'YBC1870'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   END
     C                   END
      *
     C     WSPAFF        IFEQ      'N'
     C     WSPFKØ        ANDEQ     'J'
     C     WSPFAK        OREQ      'N'
     C     WSPFKØ        ANDEQ     'J'
     C                   SETON                                        88
     C  N30              DO
     C                   MOVE      'YBC1871'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     45            POSNBR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDFIL        BEGSR
     C***********************************************
     C     UKN           CHAIN     LLKUNF                             33
     C                   MOVE      WSFMVA        KFFMVA
     C                   MOVE      WSFAVA        KFFAVA
     C                   MOVE      WSMAVD        KFMAVD
     C                   MOVE      WSMUR         KFMUR
     C                   MOVE      WSMOT         KFMOT
     C                   MOVE      WSMFR         KFMFR
     C                   MOVE      WSMVB         KFMVB
     C                   MOVE      WSMAFF        KFMAFF
     C                   MOVE      WSMFAK        KFMFAK
     C                   MOVE      WSMFKØ        KFMFKØ
     C                   MOVE      WSMMRS        KFMMRS
     C                   MOVE      WSMSO         KFMSO
N01  C                   MOVE      WSMRS1        KFMRS1
N01  C                   MOVE      WSMRS2        KFMRS2
     C                   MOVE      WSPAVD        KFPAVD
     C                   MOVE      WSPUR         KFPUR
     C                   MOVE      WSPOT         KFPOT
     C                   MOVE      WSPFR         KFPFR
     C                   MOVE      WSPVB         KFPVB
     C                   MOVE      WSPAFF        KFPAFF
     C                   MOVE      WSPFAK        KFPFAK
     C                   MOVE      WSPFKØ        KFPFKØ
     C                   MOVE      WSPFB         KFPFB
     C                   MOVE      WSPML         KFPML
     C                   MOVE      WSPPLS        KFPPLS
     C                   MOVE      WSPRF         KFPRF
N01  C                   MOVE      WSPRES        KFPRES
     C     *IN33         IFEQ      '0'
     C                   UPDATE    LLKUNFR
     C                   ELSE
     C                   MOVE      UKN           KFKN
     C                   WRITE     LLKUNFR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVKWS        BEGSR
     C***********************************************
     C     *IN33         IFEQ      '0'
     C                   MOVE      KFFMVA        WSFMVA
     C                   MOVE      KFFAVA        WSFAVA
     C                   MOVE      KFMAVD        WSMAVD
     C                   MOVE      KFMUR         WSMUR
     C                   MOVE      KFMOT         WSMOT
     C                   MOVE      KFMFR         WSMFR
     C                   MOVE      KFMVB         WSMVB
     C                   MOVE      KFMAFF        WSMAFF
     C                   MOVE      KFMFAK        WSMFAK
     C                   MOVE      KFMFKØ        WSMFKØ
     C                   MOVE      KFMMRS        WSMMRS
     C                   MOVE      KFMSO         WSMSO
N01  C                   MOVE      KFMRS1        WSMRS1
N01  C                   MOVE      KFMRS2        WSMRS2
     C                   MOVE      KFPAVD        WSPAVD
     C                   MOVE      KFPUR         WSPUR
     C                   MOVE      KFPOT         WSPOT
     C                   MOVE      KFPFR         WSPFR
     C                   MOVE      KFPVB         WSPVB
     C                   MOVE      KFPAFF        WSPAFF
     C                   MOVE      KFPFAK        WSPFAK
     C                   MOVE      KFPFKØ        WSPFKØ
     C                   MOVE      KFPFB         WSPFB
     C                   MOVE      KFPML         WSPML
     C                   MOVE      KFPPLS        WSPPLS
     C                   MOVE      KFPRF         WSPRF
N01  C                   MOVE      KFPRES        WSPRES
     C                   ELSE
     C                   MOVE      *ZEROS        WSFMVA
     C                   MOVE      *ZEROS        WSFAVA
     C                   MOVE      *ZEROS        WSMAVD
     C                   MOVE      *BLANKS       WSMUR
     C                   MOVE      *BLANKS       WSMOT
     C                   MOVE      *BLANKS       WSMFR
     C                   MOVE      'J'           WSMVB
     C                   MOVE      'N'           WSMAFF
     C                   MOVE      'N'           WSMFAK
     C                   MOVE      'N'           WSMFKØ
     C                   MOVE      'N'           WSMMRS
     C                   MOVE      'I'           WSMSO
N01  C                   MOVE      'N'           WSMRS1
N01  C                   MOVE      'N'           WSMRS2
     C                   MOVE      *ZEROS        WSPAVD
     C                   MOVE      *BLANKS       WSPUR
     C                   MOVE      *BLANKS       WSPOT
     C                   MOVE      *BLANKS       WSPFR
     C                   MOVE      'J'           WSPVB
     C                   MOVE      'N'           WSPAFF
     C                   MOVE      'N'           WSPFAK
     C                   MOVE      'N'           WSPFKØ
     C                   MOVE      'J'           WSPFB
     C                   MOVE      'J'           WSPML
     C                   MOVE      'N'           WSPPLS
     C                   MOVE      'I'           WSPRF
N01  C                   MOVE      'N'           WSPRES
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     15
     C                   MOVE      WSFMVA        UADRNR
     C                   CALL      'SOEKVADR'
     C                   PARM                    UFIRM
     C                   PARM                    UKN
     C                   PARM                    UNAK             30
     C                   PARM                    UADK1            30
     C                   PARM                    UADK2            30
     C                   PARM                    UADK3            30
     C                   PARM                    ULAND             2
     C                   PARM                    UADRNR            5
     C                   MOVE      UADRNR        WSFMVA
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     15
     C                   MOVE      WSFAVA        UADRNR
     C                   CALL      'SOEKVADR'
     C                   PARM                    UFIRM
     C                   PARM                    UKN
     C                   PARM                    UNAK             30
     C                   PARM                    UADK1            30
     C                   PARM                    UADK2            30
     C                   PARM                    UADK3            30
     C                   PARM                    ULAND             2
     C                   PARM                    UADRNR            5
     C                   MOVE      UADRNR        WSFAVA
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     14
     C                   CALL      'SYFA14B'
     C                   PARM                    WSMAVD
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     34
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFI10C'
     C                   PARM                    WSMOT
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     45
     C     POSNBR        ANDLE     47
     C                   CALL      'SYFI10G'
     C                   PARM                    WSMFR
     C                   PARM                    USPED
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     14
     C                   CALL      'SYFA14B'
     C                   PARM                    WSPAVD
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     34
     C     POSNBR        ANDLE     35
     C                   CALL      'SYFI10C'
     C                   PARM                    WSPOT
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     45
     C     POSNBR        ANDLE     47
     C                   CALL      'SYFI10G'
     C                   PARM                    WSPFR
     C                   PARM                    USPED
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     VADRKM        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    UKN
     C                   KFLD                    WSFMVA
     C     VADRKA        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    UKN
     C                   KFLD                    WSFAVA
     C     KODAKM        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    WSMAVD
     C     KODOKM        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    WSMOT
     C     KODFKM        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    WSMFR
     C     KODAKP        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    WSPAVD
     C     KODOKP        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    WSPOT
     C     KODFKP        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    WSPFR
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UKNAVN2          25
     C                   PARM                    UKN               8 0
      *
     C                   MOVE      UKNAVN2       UKNAVN
     C                   MOVE      'J'           USPED             1
     C                   MOVEL     'A'           KOAUNI
     C                   MOVEL     'OTY'         KO1UNI
     C                   MOVEL     'FR'          KFRUNI
     C     UKN           CHAIN(N)  LLKUNF                             33
     C                   EXSR      MOVKWS
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
