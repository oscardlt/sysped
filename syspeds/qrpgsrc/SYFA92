      *
      ***********************************************************
      *** PROGRAM SKAL MERKE NULLFAKTURAER                    ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 35-40 43-49 51-79 81-98    ***
      *** INDIKATOR 50 BRUKES TIL ≈ VISE OVERFLOW             ***
      ***********************************************************
      *
     FFAK2      UF   E           K DISK
     FHEADF     UF   E           K DISK
     FHEAD1     IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD1R)
     FKODTV     IF   E           K DISK
     FSYFA92FM  CF   E             WORKSTN
     FSYFA92PF  O    E             PRINTER OFLIND(*IN50)
NRFA D                 DS
NRFA D  HERFA                  1     35
NRFA D  HERFA15                1     15
     D                 DS
     D  WSAVD1                 1      4  0
     D  WSAVD2                 5      8  0
     D  WSAVD3                 9     12  0
     D  WSAVD4                13     16  0
     D  WSAVD5                17     20  0
     D  WSAVD6                21     24  0
     D  WSAVD7                25     28  0
     D  AV                     1     28  0
     D                                     DIM(7)
     D                 DS
     D  WSFR1                  1      3
     D  WSFR2                  4      6
     D  WSFR3                  7      9
     D  WSFR4                 10     12
     D  WSFR5                 13     15
     D  WSFR6                 16     18
     D  WSFR7                 19     21
     D  FR                     1     21
     D                                     DIM(7)
     D                 DS
     D  WSOT1                  1      2
     D  WSOT2                  3      4
     D  WSOT3                  5      6
     D  WSOT4                  7      8
     D  WSOT5                  9     10
     D  WSOT6                 11     12
     D  WSOT7                 13     14
     D  WSOT8                 15     16
     D  WSOT9                 17     18
     D  WSOT10                19     20
     D  WSOT11                21     22
     D  WSOT12                23     24
     D  WSOT13                25     26
     D  WSOT14                27     28
     D  WSOT15                29     30
     D  WSOT16                31     32
     D  WSOT17                33     34
     D  WSOT18                35     36
     D  WSOT19                37     38
     D  WSOT20                39     40
     D  WSOT21                41     42
     D  OT                     1     42
     D                                     DIM(21)
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDT≈                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  HEDT≈                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D  HEDTOP                 1      8  0
     D                 DS
     D  XEDTD                  1      2  0
     D  XEDTM                  3      4  0
     D  XEDT≈                  5      6  0
     D  XEDTOP                 1      6  0
     D                 DS
     D  WSDT≈1                 1      4  0
     D  WSDTM1                 5      6  0
     D  WSDTD1                 7      8  0
     D  WSDT1                  1      8  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFM1
     C                   EXFMT     BILDE
     C                   EXSR      KDTFM1
     C                   SETOFF                                       3099
     C   03              GOTO      SLUTT
     C                   MOVE      WSDT≈         U≈≈               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    U≈≈
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      99
     C   99              SETON                                        30
     C   99              MOVE      'SPD0001'     MSGNR
     C   99              GOTO      START
     C*
     C                   MOVE      WSDTD         WSDTD1
     C                   MOVE      WSDTM         WSDTM1
     C     WSDT≈         IFGT      50
     C     WSDT≈         ADD       1900          WSDT≈1
     C                   ELSE
     C     WSDT≈         ADD       2000          WSDT≈1
     C                   END
     C*
     C* FINNER ALLE AVDELINGER P≈ ÿNSKET FIRM
     C*
     C                   MOVE      *ZEROS        XN                1 0
     C     AV(1)         IFEQ      0
     C     AV(2)         ANDEQ     0
     C     AV(3)         ANDEQ     0
     C     AV(4)         ANDEQ     0
     C     AV(5)         ANDEQ     0
     C     AV(6)         ANDEQ     0
     C     AV(7)         ANDEQ     0
     C                   SETON                                        34
     C                   END
     C     KODTVK        SETLL     KODTV
     C     START2        TAG
     C   34              DO
     C                   SETOFF                                       33
     C     YVUNI         READE     KODTV                                  33
     C   33              GOTO      SLUTT
     C                   END
     C  N34              DO
     C     ST21          TAG
     C                   ADD       1             XN
     C     XN            IFGT      7
     C                   GOTO      SLUTT
     C                   ELSE
     C     AV(XN)        IFEQ      0
     C                   GOTO      ST21
     C                   ELSE
     C                   MOVE      AV(XN)        YAVD
     C     KODTVK        CHAIN     KODTV                              33
     C   33              GOTO      ST21
     C                   END
     C                   END
     C                   END
     C*
     C     HEAD1K        SETLL     HEAD1
     C                   SETOFF                                       8031
     C     START3        TAG
     C     HEAD1K        READE     HEAD1                                  31
     C  N31HEDTR         IFLE      WSDT1
     C     HEOPD         IFLE      0
     C                   GOTO      START3
     C                   END
     C     wssg1         ifne      *blanks
     C     wssg2         orne      *blanks
      *
     C     hesg          ifne      wssg1
     C     hesg          andne     wssg2
     C                   GOTO      START3
     c                   end
     c                   end
      *
     C                   SETOFF                                       4142
     C                   SORTA     FR
     C                   SORTA     OT
     C     HEFR          LOOKUP    FR                                     41
     C     HEOT          LOOKUP    OT                                     42
     C   41
     CAN 42              EXSR      HOVED
     C                   GOTO      START3
     C                   END
     C                   GOTO      START2
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     HOVED         BEGSR
     C******************************************
     C                   MOVE      *ZEROS        XTOTAL            9 0
     C                   SETOFF                                       33
     C     FAK2K         SETLL     FAK2
     C*
     C     STHOV         TAG
     C     FAK2K         READE(N)  FAK2                                   33
     C  N33FASK          IFNE      'S'
     C     FASK          ANDNE     'K'
     C     FASK          ANDNE     'X'
     C     FASK          ANDNE     'I'
     C                   GOTO      STHOV
     C                   END
     C  N33FAKDA         IFEQ      'K'
     C     FAKDA         OREQ      'I'
     C     FAOPKO        OREQ      'D'
     C                   GOTO      STHOV
     C                   END
     C*
     C  N33              ADD       FABELN        XTOTAL            9 0
     C  N33              GOTO      STHOV
     C* HVIS SUM AV LINJER ER 0 (OGS≈ ETTER HELKREDIT) AKSEPTERES
     C* NULLFAKTURERING
     C     XTOTAL        IFEQ      *ZEROS
     C     WSJA          IFEQ      'J'
     C  N80
     COR 50              WRITE     HEADER
     C   50              SETOFF                                       50
     C                   SETON                                        80
     C                   EXSR      KDTFM2
     C                   WRITE     DET
     C                   END
      * SLETT 0-FAKTURALINJER
     C     FAK2K         SETLL     FAK2
     C     FAK2K         READE     FAK2                                   33
     C     *IN33         DOWEQ     '0'
     C     FASK          IFEQ      'S'
     C     FASK          OREQ      'K'
     C     FASK          OREQ      'X'
     C     FAKDA         IFNE      'K'
     C     FAOPKO        ANDNE     'D'
     C     FABELN        ANDEQ     0
     C                   DELETE    FAKTR
     C                   ELSE
     C                   UPDATE    FAKTR
     C                   END
     C                   ELSE
     C                   UPDATE    FAKTR
     C                   END
     C     FAK2K         READE     FAK2                                   33
     C  N33              ENDDO
      *
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              MOVE      'G'           HEST
     C  N33              UPDATE    HEADFR
     C                   END
     C*
     C     SLHOV         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEAD1K        KLIST
     C                   KFLD                    KOVAVD
     C                   KFLD                    YST
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    YAVD
     C*
     C                   MOVE      ' '           YST               1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      *ZEROS        YAVD              4 0
     C*
     C                   MOVE      *ZEROS        AV
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDT1
     C                   MOVE      'J'           WSJA
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDT≈         UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDT≈
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      HEDTD         UDT1
     C                   MOVE      HEDTM         UDT2
     C                   MOVE      HEDT≈         UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XEDTD
     C                   MOVE      UDT2          XEDTM
     C                   MOVE      UDT3          XEDT≈
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
