********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 FAKTURANR ER 7.0
********************************************************************
     FLLGSFL02  UF   E           K DISK
     FLLGSFL03  IF   E           K DISK
     F                                     RENAME(LLGSFR:LLGSFR03)
     FLLTKF     IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FLL054P    O    E             PRINTER OFLIND(*IN01) USROPN
     D                 DS
     D  XTIME                  1     14  0
     D  XTID                   1      4  0
     D  XDD                    7      8  0
     D  XMM                    9     10  0
     D  X≈≈                   11     14  0
     D                 DS
     D  XIDAG                  1      6  0
     D  XIDAGD                 1      2  0
     D  XIDAGM                 3      4  0
     D  XIDAG≈                 5      6  0
     D                 DS
     D  GS≈≈MU                 1      6  0
     D  GS≈≈                   1      4  0
     D  GSMM                   5      6  0
     D  GSUU                   5      6  0
     D                 DS
     D  TKTXT                  1     50
     D  XKTXT                  1     45
     D                 DS
     D  GSFN                   1      7  0
     D  XSFN                   1      7
      *
     C                   EXSR      INIT
      *
     C                   SELECT                                                 1<-B
     C     UOPT          WHENEQ    'K'
     C                   EXSR      CRDGRL
     C     UOPT          WHENEQ    'S'
     C                   EXSR      DLTGRL
     C     UOPT          WHENEQ    'E'
     C                   EXSR      CHGGRL
     C                   OTHER
     C     UKOPI         IFEQ      'J'                                           2<-B
     C     LLGS3X        SETLL     LLGSFL03
     C     LLGS3X        READE     LLGSFL03                               33
     C     *IN33         IFEQ      '0'                                            3<-B
     C     GSMMUU        ANDNE     *BLANKS
     C                   EXSR      PRTGRL
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     LLGS2X        SETLL     LLGSFL02
     C     LLGS2X        READE     LLGSFL02                               33
     C     *IN33         IFEQ      '0'                                            3<-B
     C     GSMMUU        IFEQ      *BLANKS                                         4<-B
     C                   EXSR      UPDGRL
     C                   ELSE                                                      4
     C                   EXSR      PRTGRL
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
     C     LLGS2K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    YLI
     C     LLGS2X        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     LLGS3X        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     KFASTK        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'LAGERLEI'    KFTYP
     C                   MOVE      'ER'          KFTYP
     C     KODTPK        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    YAVD
     C                   KFLD                    KOPLNR
     C                   MOVE      'P'           KOPUNI
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C                   PARM                    ULI               5
     C                   PARM                    UFDT              8
     C                   PARM                    UFN               7
     C                   PARM                    UKOPI             1
     C                   PARM                    UOPT              1
      *
     C                   MOVE      UAVD          YAVD              4 0
     C                   MOVE      UOPD          YOPD              7 0
     C                   MOVE      ULI           YLI               5 0
     C     UKOPI         COMP      'J'                                    45
     C                   TIME                    XTIME
     C                   MOVE      XDD           XIDAGD
     C                   MOVE      XMM           XIDAGM
     C                   MOVE      X≈≈           XIDAG≈
     C                   Z-ADD     19            KOPLNR
     C     KODTPK        CHAIN     KODTP                              33
     C     KOPFM         SETLL     KODTFM
     C     KOPFM         READE     KODTFM                                 33
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CRDGRL        BEGSR
      *////////////////////////////////////////////////////////////
     C     LLGS2K        SETLL     LLGSFL02
     C     LLGS2K        READE     LLGSFL02                               33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      'K'           GSST
     C                   MOVE      99999999      GSFDT
S01  C*                  MOVE      999999        GSFN
N01  C                   MOVE      9999999       GSFN
     C                   UPDATE    LLGSFR
     C     LLGS2K        READE     LLGSFL02                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     DLTGRL        BEGSR
      *////////////////////////////////////////////////////////////
     C     LLGS2K        SETLL     LLGSFL02
     C     LLGS2K        READE     LLGSFL02                               33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    LLGSFR
     C     LLGS2K        READE     LLGSFL02                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     CHGGRL        BEGSR
      *////////////////////////////////////////////////////////////
     C     LLGS2K        SETLL     LLGSFL02
     C     LLGS2K        READE     LLGSFL02                               33
     C     *IN33         DOWEQ     '0'
     C                   MOVE      'E'           GSST
     C                   MOVE      99999999      GSFDT
     C                   MOVE      999999        GSFN
     C                   UPDATE    LLGSFR
     C     LLGS2K        READE     LLGSFL02                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     UPDGRL        BEGSR
      *////////////////////////////////////////////////////////////
     C     *IN33         DOWEQ     '0'
     C                   MOVE      'F'           GSST
     C                   MOVE      UFDT          GSFDT
     C                   MOVE      UFN           GSFN
     C                   UPDATE    LLGSFR
     C     LLGS2X        READE     LLGSFL02                               33
     C  N33              ENDDO
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     PRTGRL        BEGSR
      *////////////////////////////////////////////////////////////
     c                   open      ll054p
     C     *IN33         CABEQ     '1'           SLPRT
     C                   MOVE      '1'           *IN01
     C                   MOVE      'N'           XPRT              1
     C     GSMMUU        COMP      'U'                                    45
      *
     C     *IN33         DOWEQ     '0'
     C     UKOPI         IFEQ      'J'
     C     UFN           CABNE     XSFN          PRTNXT
     C                   ELSE
     C     GSFN          CABNE     0             PRTNXT
     C                   END
     C                   MOVE      'J'           XPRT
     C     *IN01         IFEQ      '1'
     C                   WRITE     LL054P1
     C                   MOVE      '0'           *IN01
     C                   END
     C     GSLLT         CHAIN     LLTKF                              34
     C     *IN34         IFEQ      '1'
     C                   MOVE      *BLANKS       TKTXT
     C                   MOVEL     '*UKJENT'     TKTXT
     C                   END
     C                   MOVEL     GSLPT         KFKOD
     C     KFASTK        CHAIN     KOFAST                             34
     C     *IN34         IFEQ      '1'
     C                   MOVE      *BLANKS       KFTXT
     C                   MOVEL     '*UKJENT'     KFTXT
     C                   END
     C                   WRITE     LL054P2
     C                   ADD       GSBL          XTBL
     C     PRTNXT        TAG
     C     UKOPI         IFEQ      'J'
     C     LLGS3X        READE     LLGSFL03                               33
     C                   ELSE
     C                   MOVE      'F'           GSST
     C                   MOVE      UFN           GSFN
     C                   MOVE      UFDT          GSFDT
     C                   UPDATE    LLGSFR
     C     LLGS2X        READE     LLGSFL02                               33
     C                   END
     C  N33              ENDDO
     C     XPRT          IFEQ      'J'
     C                   WRITE     LL054P3
     C                   END
      *
     C     SLPRT         TAG
     c                   close     ll054p
     C                   ENDSR
      *
