     FDKIH      IF   E           K DISK
     FDKIV      UF   E           K DISK
      *____________________
      * DS for input string
      *""""""""""""""""""""
     D                 DS
     D  A                      1  30000
     D                                     DIM(30000)                           Input string
     D  ADS                    1  30000
      *_____________________
      * DS for output string
      *"""""""""""""""""""""
     D                 DS
     D  B                      1  30000
     D                                     DIM(30000)                           Output string
     D  BDS                    1  30000
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN164                  1     16  4
     D  ØA164H                 1     12
     D  ØA164D                13     16
     D                 DS
     D  ØA17                   1     17
     D  Ø17                    1     17
     D                                     DIM(17)                              Num edit
      *____________
      * DS for EORI
      *""""""""""""
     D                 DS
     D  WEORI                  1     17
     D  WEORIA                 1      2
     D  WEORIB                 3     17
     D                 DS
     D  WDKIH_30               1     24
     D  DKIH_301               1      2
     D  DKIH_302               3     18
     D  DKIH_303              19     21
     D  DKIH_304              22     24
     D                 DS
     D  DKIV_446TA             1    255
     D  W255A                  1     70
     D  W255B                 71    140
     D  W255C                141    210
     D  W255D                211    255
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    DKIH_SYAV     UKIH_SYAV
     C     *LIKE         DEFINE    DKIH_SYOP     UKIH_SYOP
     C     *LIKE         DEFINE    DKIV_32       UKIV_32

     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             7 0
     C                   Z-ADD     80            LEN               5 0
     C                   MOVEL     'EUNOAO  '    TABLE            10
     C                   MOVEL     '*LIBL   '    LIB              10
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UKIH_SYAV
     C                   KFLD                    UKIH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    DKIV_SYAV
     C                   KFLD                    DKIV_SYOP
     C                   KFLD                    DKIV_SYLI
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
      * Workfields for Array's
     C                   Z-ADD     0             AX                2 0          Index for A
     C                   Z-ADD     1             BX                5 0          Index for B
     C                   Z-ADD     0             AXV               5 0          Leftindx A
     C                   Z-ADD     0             AXH               5 0          Rightindx A
     C                   MOVE      'R'           WDIR              1            Search direction
     C                   MOVE      *BLANKS       WCHAR             1            Test character
     C                   MOVE      'Y'           WCHART            1            Test character
      * Workfields for separation character  '
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UKIH_SYAV
     C                   PARM                    UKIH_SYOP
     C                   PARM      BDS           UDATA         30000
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     KEYA          CHAIN     DKIH

      *_____________
      * Huvudsektion
      *"""""""""""""
      * Meddelandeingress
     C                   EXSR      UNH00
      * Meddelandebørjan
     C                   EXSR      BGM00
      * Plats lokaliseringsidentifikation
     C                   EXSR      LOC00
      * Datoer
     C                   EXSR      DTM00
      * Plomberingsoplsyninger
     C                   EXSR      SEL00
      * Fritekst
     C                   EXSR      FTX00
      * Generell indikator
      * Referenser
     C                   EXSR      RFF01
      * Transportdetaljer
     C                   EXSR      TDT04
      * NAD Vareafsender
     C                   EXSR      NAD06A
      * NAD Klarerer
     C                   EXSR      NAD06B
      * NAD Varemodtager
     C                   EXSR      NAD06C
      * NAD Repræsentant
     C                   EXSR      NAD06D
      * NAD Transportør
     C                   EXSR      NAD06E
      * NAD Underrettes
     C                   EXSR      NAD06F
      * Leveransvillkår
     C                   EXSR      TOD07
      * Belopp
     C                   EXSR      MOA08
      * Seksjonskille
     C                   EXSR      UNSD
      *______________
      * Detaljsektion
      *""""""""""""""
      * Vareposter
     C                   EXSR      CST30
      * Seksjonskille
     C                   EXSR      UNSS
      *_____________
      * Summasektion
      *"""""""""""""
      * Meddelandeslut
     C                   EXSR      CNT00
      * Meddelandeslut
     C                   EXSR      UNT00
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_________________
      * Trim left blanks
      *"""""""""""""""""
     C                   MOVEL(P)  ADS           ADS2          30000
     C                   EVAL      ADS=*BLANKS
     C                   EVAL      ADS=%TRIML(ADS2)
      *_______________
      * Find positions
      *""""""""""""""""
     C                   EVAL      AXV=1
     C     ' '           CHECKR    ADS           AXH
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV                            <-------------I
     C                   MOVE      A(AXV)        WCHAR                                        I
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'                                           <-----------II
     C     WDIR          ANDEQ     'R'
     C     WCHAR         IFEQ      ';'                                                      III
     C                   MOVE      ':'           WCHAR
     C                   ENDIF                                                    <---------III
     C     WCHAR         COMP      WAPSTR                                 83                III
     C  N83WCHAR         COMP      '+'                                    83                III
     C  N83WCHAR         COMP      ':'                                    83                III
     C  N83WCHAR         COMP      '?'                                    83                III
     C   83              EXSR      SRÅA                                                     III
     C                   ENDIF                                                   <-----------II
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)                                        I
     C                   ADD       1             BX                                           I

     C                   END                                                    <-------------I

     C                   MOVE      'Y'           WCHART
     C                   EVAL      ADS=*BLANKS
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA17
     C     ØA164D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA164H        ØA17                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA164H        ØA17                                         I
     C                   MOVE      ',    '       ØA17                                         I
     C                   MOVE      ØA164D        ØA17                                         I
     C     Ø17(17)       IFEQ      '0'
     C                   MOVE      ' '           Ø17(17)
     C     Ø17(16)       IFEQ      '0'
     C                   MOVE      ' '           Ø17(16)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        16            ØX                             <-------------I
     C     Ø17(ØX)       IFNE      '0'                                           <-----------II
     C     Ø17(ØX)       IFEQ      '.'                                           <-----------II
     C                   SUB       1             ØX
     C                   ENDIF                                                   <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø17(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandeingress                                  UNH00 /
      *////////////////////////////////////////////////////////////
     C     UNH00         BEGSR
      * Segmentnavn
      * W0074  --->  Teller for antall segment
     C                   Z-ADD     1             W0074
     C                   MOVEL     'UNH+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingsreferanse
     C                   MOVEL     DKIH_SYAV     W0062            11
     C                   MOVE      DKIH_SYOP     W0062
     C                   MOVEL     W0062         ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Meldingstype  (= CUSDEC)
     C                   MOVEL     'CUSDEC'      ADS
     C                   EXSR      SRÅ
      *
     C                   MOVEA     ':D:96B:U'    A(1)
     C                   MOVEA     'N:1053'      A(9)
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meddelandebørjan                                   BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'BGM+:::'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1000 Ang_type(2)
     C     DKIH_AART     IFNE      '01'
     C                   IF        DKIH_R011 <> *BLANKS
     C                   MOVEL     DKIH_R011     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * 1000 EU_Ang_typ(1)
     C                   IF        DKIH_R012 <> *BLANKS
     C                   MOVEL     DKIH_R012     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * 1000 Ang_art(2)
     C                   MOVEL     DKIH_AART     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1004 Internt_nr
     C                   MOVEL     W0062         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1056 Ajour_type
     C                   IF        DKIH_AJOU <> *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     DKIH_AJOU     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * 1225 ENS_Flag
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C                   IF        DKIH_ENSF <> *BLANKS
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVEL     DKIH_ENSF     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Slutt segment
     C                   MOVEL(P)  WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Kontroll totaler                                   CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'

      * Antal vareposter
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_AART     OREQ      '08'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=UKIV_32
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+5:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Antal kolli
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIH_06
     C                   EXSR      SRNE
     C                   EVAL      ADS='CNT+11:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varupostnivå                                       CST30 /
      *////////////////////////////////////////////////////////////
     C     CST30         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'

     C                   EVAL      *IN20=*OFF
     C                   EVAL      UKIV_32=*ZEROS
     C     KEYA          SETLL     DKIV
     C     KEYA          READE     DKIV                                   20
     C     *IN20         DOWEQ     *OFF
     C                   ADD       1             UKIV_32
     C                   EVAL      DKIV_32=UKIV_32
     C                   UPDATE    DKIVR

      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='CST+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varepost_nr
     C                   EVAL      ØN164=DKIV_32
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ

     C     DKIH_AART     IFEQ      '01'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '08'
     C                   GOTO      CST30A
     C                   ENDIF
      * Varekod
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIV_331      ADS
     C                   EXSR      SRÅ
      * Tillæg kode 1
     C     DKIV_332      CABEQ     *BLANKS       CST30a
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIV_332      ADS
     C                   EXSR      SRÅ

      * Tillæg kode 2
     C     DKIV_333      CABEQ     *BLANKS       CST30a
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIV_333      ADS
     C                   EXSR      SRÅ

     C     CST30A        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      * Andra segment under CST
     C                   EXSR      FTX30
     C                   EXSR      LOC30
     C                   EXSR      MEA30
     C                   EXSR      PAC31
     C                   EXSR      MOA33
     C                   EXSR      RFF35
     C                   EXSR      DOC37
     C                   EXSR      GIS40

      * Læs næsta varulinje
     C     KEYA          READE     DKIV                                   20
     C  N20              ENDDO

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Tidigare handlingar (tullid)                       DOC37 /
      *////////////////////////////////////////////////////////////
     C     DOC37         BEGSR
      *___________________
      * Sumarisk angivelse
      *"""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
      * Sumarisk angivelse 1
     C     DKIV_403A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401A+DKIV_402A+'+'
     C                                 +%trimr(DKIV_403A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 2
     C     DKIV_403B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401B+DKIV_402B+'+'
     C                                 +%trimr(DKIV_403B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 3
     C     DKIV_403C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401C+DKIV_402C+'+'
     C                                 +%trimr(DKIV_403C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 4
     C     DKIV_403D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401D+DKIV_402D+'+'
     C                                 +%trimr(DKIV_403D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 5
     C     DKIV_403E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401E+DKIV_402E+'+'
     C                                 +%trimr(DKIV_403E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 6
     C     DKIV_403F     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401F+DKIV_402F+'+'
     C                                 +%trimr(DKIV_403F)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 7
     C     DKIV_403G     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401G+DKIV_402G+'+'
     C                                 +%trimr(DKIV_403G)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 8
     C     DKIV_403H     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401H+DKIV_402H+'+'
     C                                 +%trimr(DKIV_403H)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 9
     C     DKIV_403I     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401I+DKIV_402I+'+'
     C                                 +%trimr(DKIV_403I)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 10
     C     DKIV_403J     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401J+DKIV_402J+'+'
     C                                 +%trimr(DKIV_403J)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 11
     C     DKIV_403K     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401K+DKIV_402K+'+'
     C                                 +%trimr(DKIV_403K)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 12
     C     DKIV_403L     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401L+DKIV_402L+'+'
     C                                 +%trimr(DKIV_403L)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 13
     C     DKIV_403M     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401M+DKIV_402M+'+'
     C                                 +%trimr(DKIV_403M)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 14
     C     DKIV_403N     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401N+DKIV_402N+'+'
     C                                 +%trimr(DKIV_403N)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 15
     C     DKIV_403O     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401O+DKIV_402O+'+'
     C                                 +%trimr(DKIV_403O)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 16
     C     DKIV_403P     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401P+DKIV_402P+'+'
     C                                 +%trimr(DKIV_403P)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 17
     C     DKIV_403Q     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401Q+DKIV_402Q+'+'
     C                                 +%trimr(DKIV_403Q)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 18
     C     DKIV_403R     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401R+DKIV_402R+'+'
     C                                 +%trimr(DKIV_403R)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 19
     C     DKIV_403S     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401S+DKIV_402S+'+'
     C                                 +%trimr(DKIV_403S)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 20
     C     DKIV_403T     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401T+DKIV_402T+'+'
     C                                 +%trimr(DKIV_403T)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 21
     C     DKIV_403U     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401U+DKIV_402U+'+'
     C                                 +%trimr(DKIV_403U)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 22
     C     DKIV_403V     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401V+DKIV_402V+'+'
     C                                 +%trimr(DKIV_403V)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 23
     C     DKIV_403W     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401W+DKIV_402W+'+'
     C                                 +%trimr(DKIV_403W)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 24
     C     DKIV_403X     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401X+DKIV_402X+'+'
     C                                 +%trimr(DKIV_403X)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Sumarisk angivelse 25
     C     DKIV_403Y     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+998:::'+DKIV_401Y+DKIV_402Y+'+'
     C                                 +%trimr(DKIV_403Y)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________
      * Certifikat
      *"""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
      * Certifikat-1
     C     DKIV_442A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4421+'+'
     C                                 +%trimr(DKIV_442A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-2
     C     DKIV_442B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4422+'+'
     C                                 +%trimr(DKIV_442B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-3
     C     DKIV_442C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4423+'+'
     C                                 +%trimr(DKIV_442C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-4
     C     DKIV_442D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4424+'+'
     C                                 +%trimr(DKIV_442D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-5
     C     DKIV_442E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4425+'+'
     C                                 +%trimr(DKIV_442E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-6
     C     DKIV_442F     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4426+'+'
     C                                 +%trimr(DKIV_442F)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-7
     C     DKIV_442G     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4427+'+'
     C                                 +%trimr(DKIV_442G)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-8
     C     DKIV_442H     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4428+'+'
     C                                 +%trimr(DKIV_442H)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Certifikat-9
     C     DKIV_442I     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+16:::'+DKIV_4429+'+'
     C                                 +%trimr(DKIV_442I)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________
      * Bevillingsnummer
      *"""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_441      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+911+'+%trimr(DKIV_441)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________
      * Præferencedokument
      *"""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_444A     IFNE      *BLANKS
     C     DKIV_444B     IFNE      *BLANKS
     C*                  ADD       1             W0074
     C*                  EVAL      ADS='DOC+861:10:105:'+DKIV_444B+'+'
     C*                                +%trimr(DKIV_444A)+WAPSTR
     C*                  MOVE      'N'           WCHART
     C*                  EXSR      SRÅ
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='DOC+861:10:105:'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIV_444B     ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIV_444A     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Datoer                                             DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'
      *_____________________________
      * Forventet ankomstdato og tid
      *"""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '01'
     C     DKIH_AART     OREQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_DTM1     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIH_DTM1
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+132:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________________
      * Faktisk ankomstdato og tid
      *"""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '01'
     C     DKIH_AART     OREQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_DTM2     IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIH_DTM2
     C                   EXSR      SRNE
     C                   EVAL      ADS='DTM+178:'+%trimr(ØAN)+':203'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Fritekst                                           FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
      *_____________________________
      * Begrundelse for fastholdelse
      *"""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_AART     OREQ      '08'
     C     DKIH_BEGA     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4451 Kode
     C                   MOVEL     'ZZZ'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 4440 Tekst
     C                   MOVEL     DKIH_BEGA     ADS
     C                   EXSR      SRÅ
     C     DKIH_BEGB     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIH_BEGB     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKIH_BEGC     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIH_BEGC     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C     DKIH_BEGD     IFNE      *BLANKS
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIH_BEGD     ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________________________
      * Indikator for anden specifik omstændighed
      *""""""""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_S32      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='FTX+ACF++'+DKIH_S32+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varebeskrivelse                                    FTX30 /
      *////////////////////////////////////////////////////////////
     C     FTX30         BEGSR
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '08'
     C                   GOTO      FTX30A
     C                   ENDIF
      * Varebeskrivelse-1
     C     DKIV_315A     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKIV_315A     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Varebeskrivelse-2
     C     DKIV_315B     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKIV_315B     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Varebeskrivelse-3
     C     DKIV_315C     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKIV_315C     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Varebeskrivelse-4
     C     DKIV_315D     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKIV_315D     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Varebeskrivelse-5
     C     DKIV_315E     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'AAA'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+++'         ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Varebeskrivelse
     C                   MOVEL     DKIV_315E     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C     FTX30A        TAG
     C     DKIH_AART     CABEQ     '01'          FTX309
     C     DKIV_446KA    IFEQ      *BLANKS
     C     DKIV_446TA    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF

      * Supplerende varebeskrivelse-1
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Textæmnes kvalificerare
     C                   MOVEL     'ACB'         ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '++'          ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KA    IFNE      *BLANKS
     C                   MOVEL     DKIV_446KA    ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse
     C                   MOVEL     W255A         ADS
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse
     C     W255B         CABEQ     *BLANKS       FTX30B
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     W255B         ADS
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse
     C     W255C         CABEQ     *BLANKS       FTX30B
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     W255C         ADS
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse
     C     W255D         CABEQ     *BLANKS       FTX30B
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     W255D         ADS
     C                   EXSR      SRÅ
     C     FTX30B        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse-2
     C     DKIV_446KB    IFEQ      *BLANKS
     C     DKIV_446TB    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ACB++'   ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KB    IFNE      *BLANKS
     C                   EVAL      ADS=DKIV_446KB+':ZZZ+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Supplerende varebeskrivelse
     C                   MOVEL     DKIV_446TB    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TC    CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TC    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TD    CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TD    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TE    CABEQ     *BLANKS       FTX30C
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TE    ADS
     C                   EXSR      SRÅ
     C     FTX30C        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse-3
     C     DKIV_446KF    IFEQ      *BLANKS
     C     DKIV_446TF    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ACB++'   ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KF    IFNE      *BLANKS
     C                   EVAL      ADS=DKIV_446KF+':ZZZ+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Supplerende varebeskrivelse
     C                   MOVEL     DKIV_446TF    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TG    CABEQ     *BLANKS       FTX30D
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TG    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TH    CABEQ     *BLANKS       FTX30D
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TH    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TI    CABEQ     *BLANKS       FTX30D
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TI    ADS
     C                   EXSR      SRÅ
     C     FTX30D        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse-4
     C     DKIV_446KJ    IFEQ      *BLANKS
     C     DKIV_446TJ    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ACB++'   ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KJ    IFNE      *BLANKS
     C                   EVAL      ADS=DKIV_446KJ+':ZZZ+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Supplerende varebeskrivelse
     C                   MOVEL     DKIV_446TJ    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TK    CABEQ     *BLANKS       FTX30E
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TK    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TL    CABEQ     *BLANKS       FTX30E
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TL    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TM    CABEQ     *BLANKS       FTX30E
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TM    ADS
     C                   EXSR      SRÅ
     C     FTX30E        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse-5
     C     DKIV_446KN    IFEQ      *BLANKS
     C     DKIV_446TN    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ACB++'   ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KN    IFNE      *BLANKS
     C                   EVAL      ADS=DKIV_446KN+':ZZZ+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Supplerende varebeskrivelse
     C                   MOVEL     DKIV_446TN    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TO    CABEQ     *BLANKS       FTX30F
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TO    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TP    CABEQ     *BLANKS       FTX30F
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TP    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TQ    CABEQ     *BLANKS       FTX30F
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TQ    ADS
     C                   EXSR      SRÅ
     C     FTX30F        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende varebeskrivelse-6
     C     DKIV_446KR    IFEQ      *BLANKS
     C     DKIV_446TR    ANDEQ     *BLANKS
     C                   GOTO      FTX309
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'FTX+ACB++'   ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Supplerende vareoplysningskode
     C     DKIV_446KR    IFNE      *BLANKS
     C                   EVAL      ADS=DKIV_446KR+':ZZZ+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Supplerende varebeskrivelse
     C                   MOVEL     DKIV_446TR    ADS
     C                   EXSR      SRÅ

     C     DKIV_446TS    CABEQ     *BLANKS       FTX30G
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     DKIV_446TS    ADS
     C                   EXSR      SRÅ
     C     FTX30G        TAG
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     FTX309        TAG

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Genrelell indikatorer                              GIS40 /
      *////////////////////////////////////////////////////////////
     C     GIS40         BEGSR
      *___________________________
      * Angivelse af procedurekode
      *"""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_37       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+ZZZ:117::'+DKIV_37+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_____________________________
      * Angivelse af varebestemmelse
      *"""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_443      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+ZZZ:110::'+DKIV_443+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________________
      * Antidumping/utligningstold
      *"""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_SIKK     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='GIS+1:ZZZ::'+DKIV_SIKK+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plats/lokaliseringsidentifikation                  LOC00 /
      *////////////////////////////////////////////////////////////
     C     LOC00         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'
      *_____________________________________
      * Identificering af oplag, SAD Box# 49
      *"""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_49       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+18+'+%trimr(DKIH_49)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________________________________________
      * Angivelse af varens placering, SAD Box# 30.1 -30.4
      *"""""""""""""""""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '01'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+14+'+WDKIH_30+':ZZZ'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________________________________
      * Angivelse af afsendesesland, SAD Box# 15a
      *""""""""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFNE      '03'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+35+'+DKIH_15+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________________________
      * Registreringstoldsted, SAD Box# A
      *""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFNE      '03'
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+91+'+DKIH_A+':1:105'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *_____________________________
      * Lastningssted, ICS oplysning
      *"""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_S17      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+9+:::'+%trimr(DKIH_S17)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *____________________________
      * Losningssted, ICS oplysning
      *""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_S18      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='LOC+130+:::'+%trimr(DKIH_S18)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Oprindelsesland                                    LOC30 /
      *////////////////////////////////////////////////////////////
     C     LOC30         BEGSR
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_34       IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   MOVEL     'LOC+'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringskvalifikator
     C                   MOVEL     '27'          ADS
     C                   EXSR      SRÅ

     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Plats/lokaliseringsidentitet
     C                   MOVEL     DKIV_34       ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Vareafsender                                      NAD06A /
      *////////////////////////////////////////////////////////////
     C     NAD06A        BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     CABEQ     '8'           NAD06A9

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_02A      IFEQ      *BLANKS
     C     DKIH_02B      ANDEQ     *BLANKS
     C                   GOTO      NAD06A9
     C                   ENDIF
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+SE+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_02A      IFNE      *BLANKS
     C                   MOVEL     DKIH_02A      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      * Navn
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKIH_02B      IFNE      *BLANKS
     C                   MOVEL     DKIH_02B      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Gade
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKIH_02C      IFNE      *BLANKS
     C                   MOVEL     DKIH_02C      ADS
     C                   ENDIF
     C                   EXSR      SRÅ
      * Postnr
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKIH_02D      IFNE      *BLANKS
     C                   MOVEL     DKIH_02D      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * By
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKIH_02e      IFNE      *BLANKS
     C                   MOVEL     DKIH_02E      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Land
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C     DKIH_02F      IFNE      *BLANKS
     C                   MOVEL     DKIH_02F      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C     NAD06A9       TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Klarerer                                          NAD06B /
      *////////////////////////////////////////////////////////////
     C     NAD06B        BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     CABEQ     '8'           NAD06B9

      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+DT+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Repr_status
     C     DKIH_AART     IFNE      '01'
     C     DKIH_14B      IFNE      *BLANKS
     C                   MOVEL     DKIH_14B      ADS
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ELSE
     C                   ADD       1             BX                                           I
     C                   MOVE      ' '           B(BX)                                        I
     C                   ENDIF
      * EORI
     C     DKIH_14A      IFNE      *BLANKS
     C                   MOVEL     DKIH_14A      ADS
     C                   EXSR      SRÅ
     C                   ADD       8             BX                                           I
     C                   MOVE      '        '    B(BX)                                        I
     C                   ENDIF
      * 1131 Kode
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     NAD06B9       TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Varemodtager                                      NAD06C /
      *////////////////////////////////////////////////////////////
     C     NAD06C        BEGSR
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CN+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKIH_08A      IFNE      *BLANKS
     C                   MOVEL     DKIH_08A      ADS
     C                   EXSR      SRÅ

     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * Navn
     C     DKIH_AART     CABEQ     '01'          NAD06CC
     C     DKIH_AART     CABEQ     '03'          NAD06CC
     C     DKIH_AART     CABEQ     '07'          NAD06CC
     C     DKIH_AART     CABEQ     '08'          NAD06CC
     C     DKIH_08B      CABEQ     *BLANKS       NAD06CC
     C     DKIH_08A      CABNE     'DK09999981'  NAD06CC
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_08B      ADS
     C                   EXSR      SRÅ
      * Gade
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_08C      ADS
     C                   EXSR      SRÅ
      * Postnr
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_08D      ADS
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_08E      ADS
     C                   EXSR      SRÅ
      * Land
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_08F      ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     NAD06CC       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Ræpresentant                                      NAD06D /
      *////////////////////////////////////////////////////////////
     C     NAD06D        BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     CABEQ     '8'           NAD06D9

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_REEO     IFNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+AG+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKIH_REEO     IFNE      *BLANKS
     C                   MOVEL     DKIH_REEO     ADS
     C                   EXSR      SRÅ
     C                   ADD       8             BX                                           I
     C                   MOVE      '        '    B(BX)                                        I
     C                   ENDIF
      * 1131
     C                   MOVEL     ':ZZZ'        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * Slutt segment
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C     NAD06D9       TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportør                                       NAD06E /
      *////////////////////////////////////////////////////////////
     C     NAD06E        BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     CABEQ     '8'           NAD06E9

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_TREO     IFNE      *BLANKS
     C     DKIH_TRNA     ORNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+CA+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKIH_TREO     IFNE      *BLANKS
     C                   MOVEL     DKIH_TREO     ADS
     C                   EXSR      SRÅ
     C                   ADD       8             BX                                           I
     C                   MOVE      '        '    B(BX)                                        I
     C                   ENDIF

     C     DKIH_TRNA     CABEQ     *BLANKS       NAD06EE
      * Navn
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_TRNA     ADS
     C                   EXSR      SRÅ
      * Gade
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_TRGA     ADS
     C                   EXSR      SRÅ
      * Postnr
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_TRPO     ADS
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_TRBY     ADS
     C                   EXSR      SRÅ
      * Land
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_TRLK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     NAD06EE       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C     NAD06E9       TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Part der skal underrettes                         NAD06F /
      *////////////////////////////////////////////////////////////
     C     NAD06F        BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     CABEQ     '8'           NAD06F9

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_NIEO     IFNE      *BLANKS
     C     DKIH_NINA     ORNE      *BLANKS
      * Segmentnavn
     C                   ADD       1             W0074
     C                   EVAL      ADS='NAD+NI+'
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * EORI
     C     DKIH_NIEO     IFNE      *BLANKS
     C                   MOVEL     DKIH_NIEO     ADS
     C                   EXSR      SRÅ
     C                   ADD       8             BX                                           I
     C                   MOVE      '        '    B(BX)                                        I
     C                   ENDIF

     C     DKIH_NINA     CABEQ     *BLANKS       NAD06FF
      * Navn
     C                   MOVEL     '+'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_NINA     ADS
     C                   EXSR      SRÅ
      * Gade
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_NIGA     ADS
     C                   EXSR      SRÅ
      * Postnr
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_NIPO     ADS
     C                   EXSR      SRÅ
      * By
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_NIBY     ADS
     C                   EXSR      SRÅ
      * Land
     C                   MOVEL     ':'           ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   MOVEL     DKIH_NILK     ADS
     C                   EXSR      SRÅ
      * Slutt segment
     C     NAD06FF       TAG
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ

     C                   ENDIF
     C                   ENDIF
     C     NAD06F9       TAG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSD /
      *////////////////////////////////////////////////////////////
     C     UNSD          BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='UNS+D'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Seksjonskille                                       UNSS /
      *////////////////////////////////////////////////////////////
     C     UNSS          BEGSR
     C                   ADD       1             W0074
     C                   EVAL      ADS='UNS+S'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Mått varulinje                                     MEA30 /
      *////////////////////////////////////////////////////////////
     C     MEA30         BEGSR
      *___________
      * Bruttovægt
      *"""""""""""
     C     DKIH_AART     IFEQ      '01'
     C     DKIH_AART     OREQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_35
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+AAB+KGM:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________
      * Nettovægt
      *""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_AART     OREQ      '08'
     C     DKIV_38       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_38
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+WT+AAA+KGM:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________
      * Supplerende mængde
      *"""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_412      IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_412
     C                   EXSR      SRNE
     C                   EVAL      ADS='MEA+AAR++'+%trimr(DKIV_411)+':'+
     C                                 %trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________
      * Supplerende oppl
      *"""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_449A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='MEA+DV+:::'+%trimr(DKIV_449A)+'+ZZZ:'+
     C                                 %trimr(DKIV_449B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Belopp, huvudnivå                                  MOA08 /
      *////////////////////////////////////////////////////////////
     C     MOA08         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'
      *_________________________
      * Møntsort og fakturabeløb
      *"""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_221      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIH_222
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+39:'+%trimr(ØAN)+':'
     C                             + %trimr(DKIH_221)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________________________
      * Interne EU leveringsomkostninger
      *"""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_AART     OREQ      '08'
     C     DKIH_12       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIH_12
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+72:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Beløp                                              MOA33 /
      *////////////////////////////////////////////////////////////
     C     MOA33         BEGSR
      *____________
      * Varens pris
      *""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_42       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_42
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+38:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________
      * Statistisk værdi
      *"""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_AART     OREQ      '08'
     C     DKIV_46       IFNE      *ZEROS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_46
     C                   EXSR      SRNE
     C                   EVAL      ADS='MOA+123:'+%trimr(ØAN)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Antal og art                                       PAC31 /
      *////////////////////////////////////////////////////////////
     C     PAC31         BEGSR
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
      * Linje-1
     C     DKIV_314A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_313A
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                 +%trimr(DKIV_314A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C     *LIKE         DEFINE    DKIV_311A     ZKIV_311
     C                   EVAL      ZKIV_311=DKIV_311A
     C                   EXSR      PCI32
     C                   ENDIF
      * Linje-2
     C     DKIV_314B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_313B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                  +%trimr(DKIV_314B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ZKIV_311=DKIV_311B
     C                   EXSR      PCI32
     C                   ENDIF
      * Linje-3
     C     DKIV_314C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_313C
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                 +%trimr(DKIV_314C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ZKIV_311=DKIV_311C
     C                   EXSR      PCI32
     C                   ENDIF
      * Linje-4
     C     DKIV_314D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_313D
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                 +%trimr(DKIV_314D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ZKIV_311=DKIV_311D
     C                   EXSR      PCI32
     C                   ENDIF
      * Linje-5
     C     DKIV_314E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ØN164=DKIV_313E
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           ADS
     C                   EVAL      ADS='PAC+'+%trimr(ØAN)+'++'
     C                                 +%trimr(DKIV_314E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ZKIV_311=DKIV_311E
     C                   EXSR      PCI32
     C                   ENDIF

     C                   ENDIF

     C     DKIH_AART     IFEQ      '05'
     C     DKIV_311A     ANDNE     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='PAC++0'+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   EVAL      ZKIV_311=DKIV_311A
     C                   EXSR      PCI32
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Førpackningsidentifikation                         PCI32 /
      *////////////////////////////////////////////////////////////
     C     PCI32         BEGSR
     C     ZKIV_311      IFNE      *BLANKS
     C                   EVAL      ADS=*BLANKS
     C                   ADD       1             W0074
     C                   MOVEL     'PCI+28+'     ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   MOVEL     ZKIV_311      ADS
     C                   EXSR      SRÅ
     C                   MOVEL     WAPSTR        ADS
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
      *____________________
      * Registration number
      *""""""""""""""""""""
     C     DKIH_AJOU     IFNE      '8'
     C     DKIH_07A      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AEI:'+%trimr(DKIH_07A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *____________________________
      * Secondary customs reference
      *""""""""""""""""""""""""""""
     C     DKIH_AJOU     IFNE      '8'
     C     DKIH_07B      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AFM:'+%trimr(DKIH_07B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *______________________________________
      * Reference number, tidligere angivelse
      *""""""""""""""""""""""""""""""""""""""
     C     DKIH_07C      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ACW:'+%trimr(DKIH_07C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      *____________
      * UCRN number
      *""""""""""""
     C     DKIH_AJOU     IFNE      '8'
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_07D      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ABE:'+%trimr(DKIH_07D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Referens                                           RFF35 /
      *////////////////////////////////////////////////////////////
     C     RFF35         BEGSR
      *_____________
      * Container id
      *"""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_AART     OREQ      '07'
      * ID-1
     C     DKIV_312A     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKIV_312A)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-2
     C     DKIV_312B     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKIV_312B)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-3
     C     DKIV_312C     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKIV_312C)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-4
     C     DKIV_312D     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKIV_312D)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
      * ID-5
     C     DKIV_312E     IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AAQ:'+%trimr(DKIV_312E)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF

     C                   ENDIF
      *_______________
      * Præferencekode
      *"""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_36       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+AIP:'+DKIV_36+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *____________________
      * Kontigentløbenummer
      *""""""""""""""""""""
     C     DKIH_AART     IFEQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIV_39       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+ABJ:'+DKIV_39+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_______________
      * FN farlig gods
      *"""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIV_S27      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='RFF+UN:'+DKIV_S27+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Plomberingsoplysninger                             SEL00 /
      *////////////////////////////////////////////////////////////
     C     SEL00         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_S28      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='SEL+0+:::'+%trimr(DKIH_S28)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Transportdetaljer                                  TDT04 /
      *////////////////////////////////////////////////////////////
     C     TDT04         BEGSR
     C     DKIH_AJOU     IFNE      '8'
      *___________________________
      * Id ved ankomst uten ref.nr
      *"""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '01'
     C     DKIH_AART     OREQ      '05'
     C     DKIH_181      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+13+++++++:::'
     C                                 +%trimr(DKIH_181)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *___________________________
      * Id ved ankomst uten ref.nr
      *"""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_181      IFNE      *BLANKS
     C     DKIH_18A      ANDEQ     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+13+++++++:::'
     C                                 +%trimr(DKIH_181)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________
      * Id ved ankomst med ref.nr
      *""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_181      IFNE      *BLANKS
     C     DKIH_18A      ANDNE     *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+13+'+%trimr(DKIH_18A)+
     C                                 '++++++:::'+%trimr(DKIH_181)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *________________________________________________
      * Id ved grænsepassage med Aktivt transportmiddel
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_211      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(DKIH_25)+
     C                                 '+++++::::'+%trimr(DKIH_211)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *_________________________________________________
      * Id ved grænsepassage uten Aktivt transportmiddel
      *"""""""""""""""""""""""""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_211      IFEQ      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+11++'+%trimr(DKIH_25)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF
      *__________________________
      * Indenlandsk transportmåde
      *""""""""""""""""""""""""""
     C     DKIH_AART     IFEQ      '03'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_AART     OREQ      '07'
     C     DKIH_26       IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TDT+1++'+%trimr(DKIH_26)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leveransvillkår                                    TOD07 /
      *////////////////////////////////////////////////////////////
     C     TOD07         BEGSR
      * Ikke ved ajourføringstype=8
     C     DKIH_AJOU     IFNE      '8'

     C     DKIH_AART     IFEQ      '02'
     C     DKIH_AART     OREQ      '04'
     C     DKIH_S29      IFNE      *BLANKS
     C                   ADD       1             W0074
     C                   EVAL      ADS='TOD+6++'+%trimr(DKIH_S29)+WAPSTR
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
     C                   ENDIF
     C                   ENDIF

     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Meldingsslutt                                      UNT00 /
      *////////////////////////////////////////////////////////////
     C     UNT00         BEGSR

     C                   ADD       1             W0074
     C                   EVAL      ØN164=W0074
     C                   EXSR      SRNE

     C                   EVAL      ADS='UNT+' + %trimr(ØAN) + '+'
     C                                 + %trimr(W0062) + WAPSTR
     C                   EVAL      AXV=1
     C     ' '           CHECKR(E) ADS           AXH
     C                   EVAL      WCHART='N'
     C                   EXSR      SRÅ
     C                   ENDSR
