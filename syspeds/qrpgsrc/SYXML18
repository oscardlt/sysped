BRI   * 01  HÅNDTERE PÅ FLERE VARELUTAKODE
BRI   * 02  <DateAndTime> med "MessageDate" for å vise dato til TVINN
BRI   * 03  HENT KUNDENR VIA ORGANISASJONSNR
BRI   * 04  HENT AVDELING KUN FRA CustomsBroker
BRI   *     HENT EKSPEDISJONSSTED FRA CustomsDepartment
BRI   * 05  HENT KUNDENR VIA ORGANISASJONSNR HVIS AN-KUNDENR IKKE
BRI   *     FINNES I SYSPED.
BRI   * 06  HENT RETTELSE PÅ ENDRING 4
BRI   * 07  OMREGN FAKTURASUM PÅ ET SENERE TIDSPUNKT
BRI   * 08  KLARGJØR FOR MOTORVOGN FORTOLLING
BRI   * 09  RETTELSE PÅ ENDRING 6
BRI   * 10  OPPDATER LEVERINGSSTED
BRI   * 11  FEIL STAVET KODE
BRI   * 12  EKSTRA LINJE SKAL UTEN KOLLI OG ENHET
BRI   * 13  T&T OPPDATERING
BRI   * 14  UPCASE FOR SIGNATUR
BRI   * 15  PROSEDYRE UTEN FORANSTILT NULL
BRI   * 16  Oppdater kunde hvis kundenr ikke finnes
BRI   * 17  Opphev endring 16
BRI   * 18  Flere linjer for beskrivelse
BRI   * 19  TEST AKTKOD VED CHAIN MOT CUNDL01
BRI   * 20  SVVT er utvidet fra 15A til 30A i versjon 11
BRI   * 21  Oppdater inaktiv AN-kunde i SYSPED ved kunde ikke finnes
BRI   * 22  SEBEL3 blir ikke beregnet.
BRI   * 23  TILLEGGSLINJER MED SAMME POST
      *
      ***********************************************************
      *                                                        **
      *** PROGRAM SKAL KONVERTER XML-FIL TIL SAD-IMPORT       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-88 95-97    ***
      ***********************************************************
      *
     FXMLRCVF   IF   E           K DISK
     FXMLRCVF01 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR01)
     FXMLRCVF02 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR02)
     FXMLRCVF03 IF   E           K DISK    RENAME(XMLRCVFR:XMLRCVFR03)
     FXMLRCLF   IF   E           K DISK
     FXMLRCAF   IF   E           K DISK
     FXMLSAEH   UF A E           K DISK
     FSAEH      UF A E           K DISK
     FSAEV      UF A E           K DISK
     FSAEF      UF A E           K DISK
     FSTANDE    IF   E           K DISK
     FEDIM      O  A E             DISK
     FEDIM2     IF   E           K DISK    PREFIX(M2_)
     F                                     RENAME(EDIMR:EDIMR2)
     FEDIM4     IF   E           K DISK    PREFIX(M4_)
     F                                     RENAME(EDIMR:EDIMR4)
     FEDIC      UF   E             DISK
     FTVIND     UF A E           K DISK
N13  FTRACKF    O  A E             DISK
     FHEADF     UF A E           K DISK
     FDISP      UF A E           K DISK
     FFRISOL01  IF A E           K DISK
     FFRISOK    UF   E           K DISK    RENAME(FRISOKR:FRISOKR0)
     FTELL      UF   E           K DISK
     FFIRM      IF   E           K DISK
S16  F*CUNDL01   IF   E           K DISK
N16  FCUNDL01   IF A E           K DISK
N16  FKUNDL01   O  A E             DISK    RENAME(KUNDR:KUNDRIBM)
N16  F                                     PREFIX(IBM_)
N03  FCUNDLFO   IF   E           K DISK    RENAME(KUNDR:KUNDRFO)
N03  F                                     PREFIX(FO_)
     FKODTA     IF   E           K DISK
     FKODTLB    IF   E           K DISK
     FKODTSI    IF   E           K DISK
     FKODTSD    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTS8    IF   E           K DISK
     F*KODTTSl2  IF   E           K DISK
     FKODTTST   IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
      *
N14  D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
N14  D                                     UVWXYZÆØÅ')
N14  D LC              C                   CONST('abcdefghijklmnopqrst-
N14  D                                     uvwxyzæøå')
S23  D*CNT1            S             17    DIM(7)
S23  D*DOK1            S              3    DIM(7)
S23  D*DOK2            S             17    DIM(7)
     D REF1            S              3    DIM(10)
     D REF2            S             35    DIM(10)
N23  D                 DS
N23  D  SVFT01                 1     28
N23  D  SVFT02                29     56
N23  D  SVFT03                57     84
N23  D  SVFT04                85    112
N23  D  SVFT05               113    140
N23  D  SVFT06               141    168
N23  D  SVFT07               169    196
N23  D  CNT1                   1    224    DIM(8)
N23  D                 DS
N23  D  SVTOP1                 1     17
N23  D  SVTOP2                18     34
N23  D  SVTOP3                35     51
N23  D  SVTOP4                52     68
N23  D  SVTOP5                69     85
N23  D  SVTOP6                86    102
N23  D  SVTOP7               103    119
N23  D  SVTOP8               120    136
N23  D  SVTOP9               137    153
N23  D  SVTOP10              154    170
N23  D  DOK2                   1    187    DIM(11)
N23  D                 DS
N23  D  SVCRE1                 1      3
N23  D  SVCRE2                 4      6
N23  D  SVCRE3                 7      9
N23  D  SVCRE4                10     12
N23  D  SVCRE5                13     15
N23  D  SVCRE6                16     18
N23  D  SVCRE7                19     21
N23  D  SVCRE8                22     24
N23  D  SVCRE9                25     27
N23  D  SVCRE10               28     30
N23  D  DOK1                   1     33    DIM(11)
N18  D                 DS
S18  D* VT1                    1    105    DIM(7)
S18  D* VT1ALL                 1    105
N20  D  VT1                    1    210    DIM(7)
N20  D  VT1ALL                 1    210
     D                 DS
     D  XTXT                   1     15
     D  XT                     1     15    DIM(15)
     D                 DS
     D  XTAL                   1     15  3
     D  XTALH                  1     12  0
     D  XTALD1                13     13
     D  XTALD2                14     14
     D  XTALD3                15     15
     D                 DS
     D  XAN08                  1      8
     D  XAN081                 1      7
     D  XAN082                 8      8
     D                 DS
     D  SEKTC                  1      1
     D  SEKTA                  2      6  0
     D  SEKTB                  7      8  0
     D  SEKT8                  1      8
     D  SEKT7                  2      8  0
     D                 DS
     D  XSEFID                 1     10
     D  XSEFIDÅ                1      4
     D  XSEFIDM                6      7
     D  XSEFIDD                9     10
     D                 DS
     D  SEFID                  1      8  0
     D  SEFIDÅ                 1      4  0
     D  SEFIDM                 5      6  0
     D  SEFIDD                 7      8  0
     D                 DS
     D  SFDT                   1      8  0
     D  SFDTÅ                  1      4  0
     D  SFDTM                  5      6  0
     D  SFDTD                  7      8  0
     D                 DS
     D  SEAVD                  1      4  0
     D  SVAVD                  1      4  0
     D  HEAVD                  1      4  0
     D  DEAVD                  1      4  0
     D  FSAVD                  1      4  0
     D  SETDN                  5     11  0
     D  SVTDN                  5     11  0
     D  HEOPD                  5     11  0
     D  FSOPD                  5     11  0
     D  DIOPD                  5     11  0
     D  SESG                  12     14
     D  HESG                  12     14
     D  DISG                  12     14
     D  X14S                   1     14
     D                 DS
     D  SEUR                   1      1
     D  HEUR                   1      1
     D                 DS
     D  SEDT                   1      8  0
     D  HEDTR                  1      8  0
     D  HEDTOP                 1      8  0
     D  FSDTOP                 1      8  0
     D                 DS
     D  SEKNK                  1      8  0
     D  HEKNS                  1      8  0
     D                 DS
     D  SENAK                  1     30
     D  HENAS                  1     30
     D                 DS
     D  SEADK1                 1     30
     D  HEADS1                 1     30
     D                 DS
     D  SEADK2                 1     30
     D  HEADS2                 1     30
     D                 DS
     D  SEADK3                 1     30
     D  HEADS3                 1     30
     D                 DS
     D  SEKNS                  1      8  0
     D  HEKNK                  1      8  0
     D                 DS
     D  SENAS                  1     30
     D  HENAK                  1     30
     D                 DS
     D  SEADS1                 1     30
     D  HEADK1                 1     30
     D                 DS
     D  SEADS2                 1     30
     D  HEADK2                 1     30
     D                 DS
     D  SEADS3                 1     30
     D  HEADK3                 1     30
     D                 DS
     D  SELKA                  1      2
     D  HELKA                  1      2
     D                 DS
     D  SELV                   1      3
     D  HEFR                   1      3
     D                 DS
     D  SENTK                  1      7  0
     D  HENT                   1      7  0
     D                 DS
     D  SEVKB                  1      9  0
     D  HEVKT                  1      9  0
     D                 DS
     D  KLBXXX                 1     35
     D  KLBHAD                 1      1
     D                 DS
     D  SYRG                   1     14
     D  SYFORE                 1      9
     D                 DS
     D  X0068Æ                 1      9  0
     D  M0068A                10     17  0
     D  M0068B                18     23  0
     D  M0068C                24     25  0
     D  X0068Å                 1     25
N07  D                SDS
N07  D  ZUSER                254    263
      *
     C                   EXSR      INIT
      *
     C                   EXSR      SRXML1
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     SRXML1        BEGSR
      ***********************************************
      *
      * HENT MELDINGS REFERANSE
     C                   Z-ADD     1             X001_XRLEV1
     C     STSRXML1      TAG
     C                   ADD       1             X001_XRLEV1
     C                   Z-ADD     1             X001_XRLEV2
     C                   Z-ADD     1             X001_XRLEV3
     C                   Z-ADD     0             X001_XRLEV4
     C                   Z-ADD     0             X001_XRLEV5
     C                   Z-ADD     0             X001_XRLEV6
     C                   Z-ADD     0             X001_XRLEV7
     C                   Z-ADD     0             X001_XRLEV8
     C                   Z-ADD     0             X001_XRLEV9
     C     XMLKEY01      CHAIN     XMLRCAF                            33
     C     *IN33         CABEQ     *ON           SLSRXML1
     C                   DOW       *IN33 = *OFF
     C                   IF        XRATN = 'consignmentId'
     C                   EVAL      FSSOK  = XRATV
     C                   MOVEL     XRATV         XORDREF          35
     C                   EXSR      SRXML2
     C                   GOTO      STSRXML1
     C                   END
     C     XMLKEY01      READE     XMLRCAF                                33
     C                   ENDDO
      *
     C     SLSRXML1      ENDSR
      *
      ***********************************************
     C     SRXML2        BEGSR
      ***********************************************
      *
     C                   EXSR      SRFINNAVD
      *
     C                   EXSR      SRHENTCN
      *
BRI01C                   MOVE      'N'           XFLERVAL          1
     C                   Z-ADD     0             SEVKB
     C                   Z-ADD     0             XSEVKB
     C                   Z-ADD     0             XSENTK
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
      * HENT INFOR. FRA <Consignment>
     C                   WHEN      XRNV = 'Consignment'                          2<-B
     C                   EXSR      SRXML311
      * HENT INFOR. FRA <CustomsClearance>
     C                   WHEN      XRNV = 'CustomsClearance'                     2<-B
     C                   EXSR      SRXML301
     C     XSLUTT        CABEQ     'J'           SLXML2
      * HENT INFOR. FRA <CommercialInvoice>
     C                   WHEN      XRNV = 'CommercialInvoice'                    2<-B
     C                   EXSR      SRXML302
      * HENT INFOR. FRA <ConsignmentGoodsItemSet>
     C                   WHEN      XRNV = 'ConsignmentGoodsItemSet'              2
     C                   EXSR      SRXML303
      * HENT INFOR. FRA <Party>
     C                   WHEN      XRNV = 'Party'                                2
     C                   EXSR      SRXML304
      * HENT INFOR. FRA <TransportLeg>
     C                   WHEN      XRNV = 'TransportLeg'                         2
     C                   EXSR      SRXML305
      * HENT INFOR. FRA <TermsOfDelivery>
     C                   WHEN      XRNV = 'TermsOfDelivery'                      2
     C                   EXSR      SRXML306
N02   * HENT DATEO FRA <DateAndTime>
N02  C                   WHEN      XRNV = 'DateAndTimes'                         2
N02  C                   EXSR      SRXML307
     C                   EXSR      SROPDHEA
     C                   EXSR      SNDTVINN
     C                   LEAVE
      * TREFF <PartyStructure> ER DET SLUTT
     C                   WHEN      XRNV = 'PartyStructure'                       2
     C                   LEAVE
      * HENT CONTAINER INFO. FRA <Equipment> <--- GJORT PÅ EGEN RUTINER
     C                   WHEN      XRNV = 'Equipment'                            2
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
      *
     C     SLXML2        ENDSR
      *
      ***********************************************
     C     SRXML311      BEGSR
      ***********************************************
      * TOTAL VEKT OG KOLLI
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 0
     C                   EVAL      X003_XRLEV5 = 0
     C                   EVAL      XM0068 = FSSOK
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TotalGrossWeight'                     2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          XSEVKB
     C                   WHEN      XRNV = 'NumberOfPackages'                     2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          XSENTK
     C                   WHEN      XRNV = 'Reference'                            2
     C                   EXSR      SRXML311A
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML311A     BEGSR
      ***********************************************
      * <Reference>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = XRLEV4
     C                   MOVE      *BLANKS       FSKODE
     C                   MOVE      *BLANKS       FSSOK
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ReferenceNo'                          2
     C                   EVAL      FSSOK  = XRVERD
     C                   WHEN      XRNV = 'ReferenceType'                        2
     C                   EVAL      FSKODE = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        ((FSSOK <> *BLANKS) AND (FSKODE <> *BLANKS))
     C                   ADD       1             XN1
     C                   EVAL      REF1(XN1) = FSKODE
     C                   EVAL      REF2(XN1) = FSSOK
     C                   END
      *
     C                   IF        FSKODE = 'AWR'
     C                   EVAL      XM0068 = FSSOK
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML301      BEGSR
      ***********************************************
     C                   MOVE      'N'           XSLUTT            1
     C                   MOVE      'N'           XINNSTIKK         1
     C                   MOVE      ' '           XSEMI             1
      * SJEKK OM INNSTIKK
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 0
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRATN = 'Status'                              2
     C                   WHEN      XRATN = 'function'                            2
     C                   IF        XRATV = 'Temporary'                            3<-B
     C                   MOVE      'J'           XINNSTIKK
     C                   ELSE                                                     3
     C                   MOVE      'N'           XINNSTIKK
     C                   END                                                      3<-E
     C                   LEAVE
     C                   ENDSL                                                   2<-E
     C     XMLKEY03      READE     XMLRCAF                                33
     C                   ENDDO                                                  1<-E
      *
     C                   EVAL      FSKODE = '*CE'
     C                   EVAL      FSSOK  = XM0068
     C     FRISOL01K     CHAIN     FRISOL01                           33
      *
     C                   IF        *IN33
N13  C                   EVAL      TTACTI = 'STR'
N13  C                   EVAL      TTTEXT = 'Order entrered by XML-'
N13  C                             + 'CustomsClearance EXPORT'
      * OPPDRAG FINNES IKKE FRA FØR
      * HENT AVDELINGSINFORAMSJON
     C     XXAVD         CHAIN     STANDE                             33
     C                   IF        *IN33 = *OFF
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      *OFF          *IN33
     C                   END
     C                   IF        WDT08 >= 20110217
     C                   Z-ADD     9502          SEAVD
     C                   ELSE
     C                   Z-ADD     9910          SEAVD
     C                   END
     C                   IF        *IN33
     C                   MOVE      SEAVD         XXAVD
      * AVDELING FRA XML-FIL FINNES IKKE. BRUKE INFORMASJON FRA AVD. 9501
     C     SEAVD         CHAIN     STANDE                             33
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   END
      * OPPDRAGSNR ALLTID TREKKES FRA 9501
     C     SEAVD         CHAIN     TELL                               33
     C                   MOVE      TEOPDN        SETDN
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      WDT           HEDTR
     C                   WRITE     FRISOKR
     C*                  EVAL      FSKODE = 'CMR'
     C*                  WRITE     FRISOKR
      *
     C                   ELSE
N13  C                   EVAL      TTACTI = 'CHG'
N13  C                   EVAL      TTTEXT = 'Order changed by XML-'
N13  C                             + 'CustomsClearance EXPORT'
      *
      * OPPDRAG FINNES FRA FØR.
     C                   MOVE      FSAVD         XAVD
     C                   MOVE      FSOPD         XTDN
     C     SAEHK         CHAIN     SAEH                               33
     C  N33              IF        ((SEST = ' ') OR (SEST = 'M'))
     C                   DELETE    SAEHR
     C     SAEHK         CHAIN     XMLSAEH                            33
     C  N33              DELETE    XMLSAEHR
     C                   MOVE      SEMI          XSEMI
     C                   ELSE
     C                   IF        SEST = 'P'                                     3<-B
     C     EDIM4K        SETLL     EDIM4
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   DOW       *IN33 = *OFF                                    4<-B
     C                   IF        M4_M0065 = 'CUSDEC' OR M4_M0065 = 'CUSRES'       5<-B
     C                   IF        M4_MST <> 'D' AND M4_M1001 = '830'                6<-B
     C                   IF        M4_M1N07 = 'DUA' OR M4_M1N07 = 'DTK'              7<-B
     C                   LEAVE
     C                   END                                                         7<-E
     C                   END                                                        6<-E
     C                   END                                                       5<-E
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   ENDDO                                                    4<-E
      * STATUS P + INGEN UA/TK --> LOV Å OPPDATERE PÅ NYTT
     C                   IF        *IN33                                          4<-B
     C                   DELETE    SAEHR
     C     SAEHK         CHAIN     XMLSAEH                            33
     C  N33              DELETE    XMLSAEHR
     C                   MOVE      SEMI          XSEMI
     C                   GOTO      STXML301
     C                   END                                                      4<-E
     C                   END                                                     3<-E
      * KAN IKKE TA NY VERSJON
     C                   UPDATE    SAEHR
     C                   EVAL      XMSGTXT = 'Fortolling ('
     C                             + %TRIM(FSSOK) + '/'
     C                             + %TRIM(%EDITC(FSAVD:'Z')) + '/'
     C                             + %TRIM(%EDITC(FSOPD:'Z')) + ')'
     C                             + 'kan ikke oppdateres pga. status='
     C                             + %TRIM(SEST)
     C*                            + %TRIM(SEST) + '.'
     C                   SELECT
     C                   WHEN      SEST = 'A'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (ligger i en sending i påvente av å bli'
     C                             + ' sendt).'
     C                   WHEN      SEST = 'C'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (er sendt til TVINN).'
     C                   WHEN      SEST = 'E'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (blir endret av en saksbehandler).'
     C                   WHEN      SEST = 'D'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (melding om dokumentkontroll).'
     C                   WHEN      SEST = 'K'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (klar for utskrift men er ikke skrevet'
     C                             + ' ut).'
     C                   WHEN      SEST = 'P'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (deklarasjonen er skrevet ut).'
     C                   WHEN      SEST = 'Q'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (ligger i utg. postkasse, men er ikke'
     C                             + ' sendt).'
     C                   WHEN      SEST = 'T'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (er lagt til manuell ekspedering).'
     C                   WHEN      SEST = 'V'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (melding om varekontroll).'
     C                   WHEN      SEST = 'U'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (utleveringsattest er mottatt).'
     C                   WHEN      SEST = 'Å'
     C                   EVAL      XMSGTXT = %TRIM(XMSGTXT)
     C                             + ' (klar for utskrift men er ikke skrevet'
     C                             + ' ut).'
     C                   ENDSL
     C                   EXSR      SRERROR
     C                   MOVE      'J'           XSLUTT
     C                   GOTO      SLXML301
     C                   END
      *
     C     STXML301      TAG
     C     SAEHK         CHAIN     HEADF                              33
     C  N33              DELETE    HEADFR
     C     SAEHK         CHAIN     DISP                               33
     C  N33              DELETE    DISPR
     C     SAEHK         SETLL     SAEV
     C     SAEHK         READE     SAEV                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SAEVR
     C     SAEHK         READE     SAEV                                   33
     C                   ENDDO
     C     SAEHK         SETLL     SAEF
     C     SAEHK         READE     SAEF                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADFR
     C     SAEHK         READE     SAEF                                   33
     C                   ENDDO
     C     SAEHK         SETLL     FRISOK
     C     SAEHK         READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF
     C*                  IF        FSKODE = 'CNT'
     C                   IF        FSKODE <> '*CE'
     C                   DELETE    FRISOKR0
     C                   ELSE
     C                   UPDATE    FRISOKR0
     C                   END
     C     SAEHK         READE     FRISOK                                 33
     C                   ENDDO
      *
     C                   CLEAR                   SAEHR
     C                   CLEAR                   SAEVR
     C                   CLEAR                   SADFR
     C                   CLEAR                   HEADFR
     C                   CLEAR                   DISPR
      * HENT AVDELINGSDEFAULT VERDIER FRA OPPGITT AVDELING I XML-FIL
     C     XXAVD         CHAIN     STANDE                             33
     C                   IF        *IN33
      * HVIS IKKE, HENT AVDELINGSDEFAULT VERDIER FRA TIDLIGERE AVDELING
     C                   MOVE      XAVD          XXAVD
     C     XXAVD         CHAIN     STANDE                             33
     C                   END
     C     KODTAK        CHAIN     KODTA                              33
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      XAVD          FSAVD
     C                   MOVE      XTDN          FSOPD
     C                   MOVE      WDT           HEDTR
      *
     C                   END
      *
      * OPPDATER REFERANSER PÅ FRISOK
     C     1             DO        10            XN1
     C                   IF        REF1(XN1) = *BLANKS
     C                   LEAVE
     C                   END
     C                   EVAL      FSKODE = REF1(XN1)
     C                   EVAL      FSSOK  = REF2(XN1)
     C                   WRITE     FRISOKR
     C                   ENDDO
      *
      * OPPDATER CONTAINERNR PÅ FRISOK
     C                   EVAL      FSKODE = 'CNT'
     C     1             DO        7             XN1
     C                   IF        CNT1(XN1) <> *BLANKS
     C                   EVAL      FSSOK  = CNT1(XN1)
     C                   WRITE     FRISOKR
     C                   END
     C                   ENDDO
      *
     C                   EVAL      SEKDDK = ' '
      *
      * INFOR. FRA <CustomsClearance>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Declaration'                          2
     C                   EXSR      SRXML301A
     C                   WHEN      XRNV = 'TransactionType'                      2
     C                   MOVEL     XRVERD        SETST
     C                   WHEN      XRNV = 'Location'                             2
     C                   EXSR      SRXML301B
     C                   WHEN      XRNV = 'DutyCreditAccount'                    2
     C                   MOVEL     XRVERD        XAN08
     C                   IF        XAN082 = *BLANKS
     C                   EVAL      SEKTC  = *BLANKS
     C*                  MOVE      XAN081        SEKT7
     C                   MOVEL     XAN081        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SEKT7
     C                   ELSE
     C                   MOVE      XAN08         SEKT8
     C                   END
     C                   WHEN      XRNV = 'DutyPaymentIndicator'                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XRVERD = 'Cash'                                3
     C                   EVAL      SEKDDK = 'K'
     C                   WHEN      XRVERD = 'Credit'                              3
     C                   EVAL      SEKDDK = 'D'
     C                   WHEN      XRVERD = 'Account'                             3
     C                   EVAL      SEKDDK = ' '
     C                   ENDSL                                                    3<-E
      *
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'dutyPayer'                            3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      XRATV = 'Buyer'                                 4
     C                   EVAL      SESKI = 'K'
     C                   WHEN      XRATV = 'Seller'                                4
     C                   EVAL      SESKI = 'S'
     C                   OTHER
     C                   EVAL      SESKI = 'I'
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
      *
     C                   WHEN      XRNV = 'FreightChargeAmount'                  2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   ADD       XTAL          SEBEL2
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'currencyIdentificationCode'           3<-B
     C                   EVAL      SEVAL2 = XRATV
     C                   END                                                      3<-E
     C     KODTVAL2K2    SETGT     KODTVAL2
     C     SEVAL2        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMR2             3 0
     C  N33              MOVE      KVAKRS        XKRS2             7 3
     C                   WHEN      XRNV = 'OtherChargesAmount'                   2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   ADD       XTAL          SEBEL2
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'currencyIdentificationCode'           3<-B
     C                   EVAL      SEVAL2 = XRATV
     C                   END                                                      3<-E
     C     KODTVAL2K2    SETGT     KODTVAL2
     C     SEVAL2        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMR2             3 0
     C  N33              MOVE      KVAKRS        XKRS2             7 3
     C                   WHEN      XRNV = 'OtherChargesStatus'                   2
     C                   MOVEL     XRVERD        SEFTG2
     C                   IF        SEFTG2 = '-'
     C                   EVAL      SEFTG2 = 'M'
     C                   END
     C                   WHEN      XRNV = 'EntryNumber'                          2
     C                   MOVEL     XRVERD        SEGN
     C                   WHEN      XRNV = 'EntryPostionNumber'                   2
     C                   MOVEL     XRVERD        SEPOS
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C     SLXML301      ENDSR
      *
      ***********************************************
     C     SRXML301A     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = XRLEV4
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'DeclarationType'                      2
     C                   EVAL      SEDTY  = XRVERD
     C                   WHEN      XRNV = 'Procedure'                            2
N15  C                   IF        %SUBST(XRVERD:2:1) = *BLANKS
N15  C                   MOVEL     XRVERD        XN01              1 0
N15  C                   Z-ADD     XN01          SEDP
N15  C                   ELSE
     C                   MOVEL     XRVERD        SEDP
N15  C                   END
     C                   ENDSL
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML301B     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = XRLEV4
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Location'                             2
     C                   MOVE      *BLANKS       XSUBCL           20
     C     XMLKEY032     CHAIN     XMLRCAF                            33
      *
     C                   DOW       *IN33 = *OFF                                   3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      XRATN = 'subClass'                              4
     C                   EVAL      XSUBCL = XRATV
     C                   WHEN      XRATN = 'locationId'                            4
     C                   SELECT                                                     5<-B
     C                   WHEN      XSUBCL = 'StorageLocation'                       5
     C                   EVAL      SEKDLS = XRATV
     C     SEKDLS        CHAIN     KODTSD                             33
     C  N33              MOVEL     KSDTXT        SELS
     C                   LEAVE
N04  C                   WHEN      XSUBCL = 'CustomsDepartment'                     5
N04  C                   IF        %SUBST(XRATV:5:1) <> *BLANKS AND                  6<-B
N04  C                             %SUBST(XRATV:7:1) = *BLANKS
S06  C*                  MOVEL     XRATV         XS3039E
N06  C                   MOVEL     XRATV         XTXT
N06  C                   EXSR      KNVTAL
S09  C*                  Z-ADD     XTAL          XS3039E
N09  C                   Z-ADD     XTAL          S3039E
N04  C                   END                                                         6<-E
N04  C                   LEAVE
     C                   WHEN      XSUBCL = 'BorderPassing'                         5
     C*                  MOVEL     XRATV         KTSPNR
     C                   MOVEL     XRATV         SEKDH
     C*    KODTTSTK      CHAIN     KODTTSl2                           33
     C     KODTTSTK      CHAIN     KODTTST                            33
     C* N33              MOVEL     KTSKOD        SEKDH
     C  N33              MOVEL     KTSNAV        SEKDFT
     C                   LEAVE
     C                   ENDSL                                                      5<-E
     C                   ENDSL                                                     4<-E
     C     XMLKEY032     READE     XMLRCAF                                33
     C                   ENDDO                                                    3<-E
      *
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   SELECT                                                   3<-B
     C                   WHEN      XSUBCL = 'StartLocation'                       3
     C                   MOVEL     XRVERD        KS2LK
     C                   MOVEL     XRVERD        SELKA
     C     KODTS2K       CHAIN     KODTS2                             33
     C                   MOVEL     KS2FTX        SELKAT
     C                   WHEN      XSUBCL = 'EndLocation'                         3
     C                   MOVEL     XRVERD        KS2LK
     C                   MOVEL     XRVERD        SELKB
     C     KODTS2K       CHAIN     KODTS2                             33
     C  N33              MOVEL     KS2FTX        SEFTB
     C  N33              IF        SEDTY   = *BLANKS                               4<-B
     C                   IF        (((KS2PRE = 'A') OR                              5<-B
     C                               (KS2PRE = 'B')) OR
     C                               (KS2PRE = 'C'))
     C                   MOVE      'EU'          SEDTY
     C                   ELSE                                                       5
     C                   MOVE      'EX'          SEDTY
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   ENDSL                                                    3<-E
      *
     C                   WHEN      XRNV = 'LocationName'                         2
     C                   IF        XSUBCL = 'BorderPassing'                       3<-B
     C                   EVAL      SEKDFT = XRVERD
     C                   END                                                      3<-E
      *
     C                   WHEN      XRNV = 'LocationType'                         2
     C                   ENDSL                                                   2<-E
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML302      BEGSR
      ***********************************************
      * INFOR. FRA <CommercialInvoice>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'InvoiceNo'                            2
      *
     C                   SELECT                                                   3<-B
     C                   WHEN      SEFIF  = *BLANKS                               3
     C                   EVAL      SEFIF  = XRVERD
     C                   WHEN      SEFIF  = 'F15  ER  BENYTTET'                   3
     C                   EVAL      SFTXT  = XRVERD
     C                   OTHER                                                    3
     C                   EVAL      SFAVD  = SEAVD
     C                   EVAL      SFOPDN = SETDN
     C                   EVAL      SFTXT  = SEFIF
     C                   EVAL      SFDT   = SEFID
     C                   EVAL      SFBL28 = SEBEL1
     C                   EVAL      SFVK28 = SEVAL1
     C                   EVAL      SFKR28 = SEVKU
     C                   EVAL      SFOM28 = XOMRF
     C                   WRITE     SADFR
     C                   EVAL      SEFIF  = 'F15  ER  BENYTTET'
     C                   EVAL      SEFID  = 99999999
     C                   EVAL      SFTXT  = XRVERD
     C                   ENDSL                                                    3<-E
      *
     C                   WHEN      XRNV = 'InvoiceDate'                          2
     C                   EVAL      XSEFID = XRVERD
     C                   IF        SEFIF  = 'F15  ER  BENYTTET'                   3<-B
     C                   MOVE      XSEFIDÅ       SFDTÅ
     C                   MOVE      XSEFIDM       SFDTM
     C                   MOVE      XSEFIDD       SFDTD
     C                   ELSE                                                     3
     C                   MOVE      XSEFIDÅ       SEFIDÅ
     C                   MOVE      XSEFIDM       SEFIDM
     C                   MOVE      XSEFIDD       SEFIDD
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'InvoiceAmount'                        2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   IF        SEFIF  = 'F15  ER  BENYTTET'                   3<-B
     C                   Z-ADD     XTAL          SFBL28
     C                   ELSE                                                     3
     C                   Z-ADD     XTAL          SEBEL1
     C                   END                                                      3<-E
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'currencyIdentificationCode'           3<-B
BRI01C                   IF        SEVAL1 <> *BLANKS AND SEVAL1 <> XRATV
BRI01C                   EVAL      XFLERVAL = 'J'
BRI01C                   END
     C                   EVAL      SEVAL1 = XRATV
     C     KODTVAL2K1    SETGT     KODTVAL2
     C     SEVAL1        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMRF             3 0
BRI01C* N33              IF        SEVKU = 0                                       4<-B
BRI01C*                  MOVE      KVAKRS        SEVKU
BRI01C*                  END                                                       4<-E
BRI01C  N33              MOVE      KVAKRS        SEVKU
     C                   IF        SEFIF  = 'F15  ER  BENYTTET'                    4<-B
     C                   EVAL      SFVK28 = SEVAL1
     C                   EVAL      SFKR28 = SEVKU
     C                   EVAL      SFOM28 = XOMRF
     C                   WRITE     SADFR
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      READE     XMLRCVF01                              33
     C                   ENDDO                                                  1<-E
S07   *
S07  C*                  IF        XFLERVAL = 'J'
S07  C*                  EXSR      SRBYTTVAL
S07  C*                  END
      *
     C                   ENDSR
      *
BRI01 ***********************************************
BRI01C     SRBYTTVAL     BEGSR
BRI01 ***********************************************
BRI01C                   EVAL      SEVAL1 = 'NOK'
BRI01C                   EVAL      SEVKU  = 100
BRI01C                   EVAL      SEBEL1 = 0
S07  C*    SAEHK         SETLL     SAEF
S07  C*    SAEHK         READE(N)  SAEF                                   33
N07  C     SAEHK2        SETLL     SAEF
N07  C     SAEHK2        READE(N)  SAEF                                   33
BRI01C                   DOW       *IN33 = *OFF
BRI01C                   EVAL(H)   SEBEL1 = SEBEL1 + SFBL28 * SFKR28 / SFOM28
S07  C*    SAEHK         READE(N)  SAEF                                   33
N07  C     SAEHK2        READE(N)  SAEF                                   33
BRI01C                   ENDDO
BRI01 *
BRI01C                   ENDSR
BRI01 *
      ***********************************************
     C     SRSJBEL1      BEGSR
      ***********************************************
     C                   IF        SEFIF = 'F15  ER  BENYTTET'
     C                   MOVE      *ZEROS        SEBEL1
     C     SAEHK2        SETLL     SAEF
     C     SAEHK2        READE(N)  SAEF                                   33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      SEVAL1 = SFVK28
     C                   EVAL      SEBEL1 = SEBEL1 + SFBL28
     C                   OTHER
     C                   GOTO      STSJBEL1
     C                   ENDSL
     C     SAEHK2        READE(N)  SAEF                                   33
     C                   ENDDO
     C                   GOTO      SLSJBEL1
      *
      * FORSKJELLIGE VALUTAKODER
     C     STSJBEL1      TAG
     C                   MOVE      *ZEROS        SEBEL1
     C                   MOVE      'NOK'         SEVAL1
     C                   MOVE      100           SEVKU
     C     SAEHK2        SETLL     SAEF
     C     SAEHK2        READE(N)  SAEF                                   33
     C                   DOW       *IN33 = *OFF
     C                   EVAL(H)   SEBEL1 = SEBEL1 + SFBL28 / SFOM28 * SFKR28
     C     SAEHK2        READE(N)  SAEF                                   33
     C                   ENDDO
      *
     C     SLSJBEL1      TAG
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML303      BEGSR
      ***********************************************
     C                   EXSR      SRSJBEL1
      * INFOR. FRA <ConsignmentGoodsItemSet>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   EVAL      SVLI   = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GoodsItem'                            2
     C                   EXSR      SRXML303A
     C                   WHEN      XRNV = 'CustomsDetails'                       2
     C                   EXSR      SRXML303B
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C                   EXSR      SROPDLIN
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML303A     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV4 = XRLEV4
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GoodsDescription'                     2
     C                   MOVEL     XRVERD        HEVS1
     C                   WHEN      XRNV = 'NumberOfPackages'                     2
     C*                  MOVEL     XRVERD        XTXT
     C*                  EXSR      KNVTAL
     C*                  Z-ADD     XTAL          SENTK
     C                   WHEN      XRNV = 'PackageTypeCode'                      2
     C                   WHEN      XRNV = 'GrossWeight'                          2
     C*                  MOVEL     XRVERD        XTXT
     C*                  EXSR      KNVTAL
     C*                  Z-ADD     XTAL          XSEVKB
     C                   ENDSL                                                   2<-E
      *
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML303B     BEGSR
      ***********************************************
      *
     C                   EXSR      SROPDLIN
      *
     C                   EVAL      XSVAVD  = SVAVD
     C                   EVAL      XSVTDN  = SVTDN
     C                   EVAL      XSVLI   = SVLI
     C                   CLEAR                   SAEVR
     C                   EVAL      SVAVD  = XSVAVD
     C                   EVAL      SVTDN  = XSVTDN
     C                   EVAL      SVLI   = XSVLI
     C                   EVAL      SVFYL  = '99'
      *
     C                   EVAL      SVLI = SVLI + 1
     C                   MOVE      *ZEROS        XN1               3 0
     C                   MOVE      *BLANKS       DOK1                           DOKUMENTKODE
     C                   MOVE      *BLANKS       DOK2                           DOKUMENTNR
N18  C                   MOVE      *BLANKS       VT1                            VAREBESKRIVELSE
     C                   MOVE      *ZEROS        XN2               3 0
     C                   EVAL      X003_XRLEV4 = XRLEV4
     C                   EVAL      X003_XRLEV5 = 1
     C                   EVAL      X003_XRLEV6 = 0
      *
     C     XMLKEY032     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'GrossWeight'                          2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD(H)  XTAL          SVVKTB
     C                   WHEN      XRNV = 'NetWeight'                            2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD(H)  XTAL          SVVKTN
     C                   WHEN      XRNV = 'PlaceOfOrigin'                        2
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                   3<-B
S11  C*                  IF        XRATV = 'County'                                4<-B
N11  C                   IF        XRATV = 'Country'                               4<-B
     C                   EVAL      SVFYL  = XRVERD
     C                   LEAVE
     C                   END                                                       4<-E
     C     XMLKEY032     READE     XMLRCAF                                33
     C                   ENDDO                                                    3<-E
     C                   WHEN      XRNV = 'CustomsArticleNumber'                 2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVVNT
     C                   WHEN      XRNV = 'TarriffLineAmount'                    2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'currencyIdentificationCode'           3<-B
     C                   IF        XRATV <> SEVAL1                                 4<-B
     C                   MOVEL     XRATV         XVALV             3
     C     KODTVAL2KV    SETGT     KODTVAL2
     C     XVALV         READPE    KODTVAL2                               33
     C  N33              EVAL(H)   SVBELT = XTAL / KVAOMR * KVAKRS
     C   33              EVAL(H)   SVBELT = XTAL
     C                   ELSE                                                     3
     C                   Z-ADD(H)  XTAL          SVBELT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'QuantityOtherUnit'                    2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD(H)  XTAL          SVNTM
     C                   WHEN      XRNV = 'CustomsTax'                           2
     C                   EXSR      SRXML303B1
     C                   WHEN      XRNV = 'DocumentReference'                    2
     C                   ADD       1             XN2
     C                   EVAL      DOK2(XN2) = XRVERD
     C     XMLKEY032     CHAIN     XMLRCAF                            33
     C  N33              IF        XRATN = 'referenceCode'                        3<-B
     C                   EVAL      DOK1(XN2) = XRATV
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'NetWeight'                            2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD(H)  XTAL          SVVKTN
     C                   WHEN      XRNV = 'GoodsDescription'                     2
S18  C*                  MOVEL     XRVERD        SVVT
N18  C                   EVAL      VT1ALL = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV5 = X003_XRLEV5 + 1
     C     XMLKEY032     CHAIN     XMLRCVF02                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML303B1    BEGSR
      ***********************************************
      *
     C     XMLKEY033     CHAIN     XMLRCVF03                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TaxCode'                              2
     C                   EVAL      SVAVT  = 'X'
     C                   WHEN      XRNV = 'TaxRateSequence'                      2
     C                   EVAL      SVAVTS = XRVERD
     C                   WHEN      XRNV = 'TaxBases'                             2
     C                   WHEN      XRNV = 'TaxRate'                              2
     C                   MOVEL     XRVERD        XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          SVAVTP
     C                   ENDSL                                                   2<-E
     C     XMLKEY033     READE     XMLRCVF03                              33
     C                   ENDDO                                                  1<-E
      *
     C                   IF        SVAVTP = 0
     C                   EVAL      SVAVT  = ' '
     C                   EVAL      SVAVTS = *BLANKS
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML304      BEGSR
      ***********************************************
N16  C                   MOVE      *BLANKS       XXPOSTNR          9
      * INFOR. FRA <Party>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 0
     C                   EVAL      X003_XRLEV5 = 0
      *
      * HENT PARAMETER FRA <Party>
     C                   MOVE      *BLANKS       XAVSMOT           8
     C                   MOVE      *ZEROS        XKNR              8 0
     C     XMLKEY03      SETLL     XMLRCAF
     C     XMLKEY03      READE     XMLRCAF                                33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      ((XRATN='subClass') AND (XRATV='Consignor'))
     C                   MOVE      'AVSENDER'    XAVSMOT           8
     C                   WHEN      ((XRATN='subClass') AND (XRATV='Consignee'))
     C                   MOVE      'MOTTAKER'    XAVSMOT           8
     C                   WHEN      ((XRATN='subClass') AND
     C                              (XRATV='CustomsBroker'))
     C                   MOVE      'ANSVARLI'    XAVSMOT           8
     C                   LEAVE
     C                   WHEN      XRATN = 'partyId'
     C                   MOVEL     XRATV         XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          XKNR              8 0
     C                   ENDSL
     C     XMLKEY03      READE     XMLRCAF                                33
     C                   ENDDO
      *
     C                   SELECT
     C                   WHEN      XAVSMOT = 'AVSENDER'
     C                   MOVE      XKNR          SEKNK
     C                   WHEN      XAVSMOT = 'MOTTAKER'
     C                   MOVE      XKNR          SEKNS
     C                   ENDSL
      *
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Name'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XAVSMOT = 'AVSENDER'                           3
     C                   EVAL      SENAK   = XRVERD
     C                   WHEN      XAVSMOT = 'MOTTAKER'                           3
     C                   EVAL      SENAS   = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'Address'                              2
     C                   EXSR      SRXML304A
     C                   WHEN      XRNV = 'VATNo'                                2
     C                   EVAL      SERG    = XRVERD
     C                   WHEN      XRNV = 'CustomsCreditNo'                      2
     C                   MOVEL     XRVERD        XAN08
     C                   IF        XAN082 = *BLANKS
     C                   EVAL      SEKTC  = *BLANKS
     C                   MOVE      XAN081        SEKT7
     C                   ELSE
     C                   MOVE      XAN08         SEKT8
     C                   END
     C                   WHEN      ((XRNV='Contact') AND (XAVSMOT='ANSVARLI'))   2
     C                   EXSR      SRXML304B
     C                   ENDSL                                                   2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML304A     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV4 = XRLEV4
     C                   EVAL      X003_XRLEV5 = 1
     C                   EVAL      X003_XRLEV6 = 0
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Street'                               2
     C                   SELECT                                                   3<-B
     C                   WHEN      XAVSMOT = 'AVSENDER'                           3
     C                   EVAL      SEADK1  = XRVERD
     C                   WHEN      XAVSMOT = 'MOTTAKER'                           3
     C                   EVAL      SEADS1  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'PostalCode'                           2
     C                   SELECT                                                   3<-B
     C                   WHEN      XAVSMOT = 'AVSENDER'                           3
     C                   EVAL      SEADK3  = XRVERD
N16  C                   EVAL      XXPOSTNR = XRVERD
     C                   WHEN      XAVSMOT = 'MOTTAKER'                           3
     C                   EVAL      SEADS3  = XRVERD
     C                   ENDSL                                                    3<-E
     C                   WHEN      XRNV = 'City'                                 2
     C                   SELECT                                                   3<-B
     C                   WHEN      XAVSMOT = 'AVSENDER'                           3
     C                   CAT       XRVERD:1      SEADK3
     C                   WHEN      XAVSMOT = 'MOTTAKER'                           3
     C                   CAT       XRVERD:1      SEADS3
     C                   ENDSL                                                    3<-E
     C                   ENDSL                                                   2<-E
      *
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML304B     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV4 = XRLEV4
     C                   EVAL      X003_XRLEV5 = 1
     C                   EVAL      X003_XRLEV6 = 0
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'ContactName'                          2
     C                   EVAL      SESG  = XRVERD
N14  C     LC:UC         XLATE     SESG          SESG
     C                   WHEN      XRNV = 'ContactFunction'                      2
     C                   EVAL      SETARF = XRVERD
     C                   ENDSL                                                   2<-E
      *
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML305      BEGSR
      ***********************************************
      * INFOR. FRA <TransportLeg>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TransportLegType'                     2
     C                   WHEN      XRNV = 'TransportLegId'                       2
     C                   WHEN      XRNV = 'Location'                             2
     C                   WHEN      XRNV = 'ModeOfTransport'                      2
     C                   MOVEL     XRVERD        SETRM
     C                   WHEN      XRNV = 'MeansOfTransport'                     2
     C                   EXSR      SRXML305A
     C                   ENDSL                                                   2<-e
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML305A     BEGSR
      ***********************************************
      *
     C                   EVAL      X003_XRLEV4 = XRLEV4
     C                   EVAL      X003_XRLEV5 = 1
     C                   EVAL      X003_XRLEV6 = 0
      *
     C     XMLKEY031     CHAIN     XMLRCVF02                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'MeansOfTransportId'                   2
     C                   EVAL      SETRID = XRVERD
     C                   WHEN      XRNV = 'CountryCode'                          2
     C                   EVAL      SELKT  = XRVERD
     C                   WHEN      XRNV = 'MeansOfTransportType'                 2
     C                   ENDSL
     C     XMLKEY031     READE     XMLRCVF02                              33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRXML306      BEGSR
      ***********************************************
      * INFOR. FRA <TermsOfDelivery>
      *
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 0
     C                   EVAL      X003_XRLEV5 = 0
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'TODConditionCode'                     2
     C                   EVAL      SELV   = XRVERD
     C     XMLKEY031     SETLL     XMLRCAF
     C     XMLKEY031     READE     XMLRCAF                                33
     C                   DOW       *IN33 = *OFF                                   3<-B
     C                   IF        XRATN = 'codeListAgencyIdentifier'              4<-B
     C                   MOVEL     XRATV         SELV
     C                   LEAVE
     C                   END                                                       4<-E
     C     XMLKEY031     READE     XMLRCAF                                33
     C                   ENDDO                                                   3<-E
      * FINN TEKST TIL LEVERINGSBETINGELSE
     C     KODTLBK       CHAIN     KODTLB                             33
     C  N33              MOVE      KLBKT         SELV2
     C  N33KLBHAD        IFEQ      'A'                                            3<-B
     C     SEADK3        IFNE      *BLANKS                                         4<-B
     C                   MOVEL     SEADK3        SELVT
     C                   ELSE                                                      4
     C     SEADK2        IFNE      *BLANKS                                          5<-B
     C                   MOVEL     SEADK2        SELVT
     C                   ELSE                                                       5
     C                   MOVEL     SEADK1        SELVT
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   ELSE                                                     3
      * KLBHAD = 'M'
     C     SEADS3        IFNE      *BLANKS                                         4<-B
     C                   MOVEL     SEADS3        SELVT
     C                   ELSE                                                      4
     C     SEADS2        IFNE      *BLANKS                                          5<-B
     C                   MOVEL     SEADS2        SELVT
     C                   ELSE                                                       5
     C                   MOVEL     SEADS1        SELVT
     C                   END                                                        5<-E
     C                   END                                                       4<-E
      *
     C                   END                                                      3<-E
N10   *
N10  C                   WHEN      XRNV = 'TODLocation'                          2
N10  C                   EVAL      SELVT  = XRVERD
      *
     C                   ENDSL                                                  2<-E
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
N02   ***********************************************
N02  C     SRXML307      BEGSR
N02   ***********************************************
N02   * DATO FRA <DateAndTime>
N02   *
N02  C                   EVAL      X003_XRLEV1 = XRLEV1
N02  C                   EVAL      X003_XRLEV2 = XRLEV2
N02  C                   EVAL      X003_XRLEV3 = XRLEV3
N02  C                   EVAL      X003_XRLEV4 = 0
N02  C                   EVAL      X003_XRLEV5 = 0
N02   * HENT PARAMETER FRA <DateAndTime>
N02  C                   MOVE      *ZEROS        XDTMSG            8 0
N02  C     XMLKEY03      SETLL     XMLRCAF
N02  C     XMLKEY03      READE     XMLRCAF                                33
N02  C                   DOW       *IN33 = *OFF
N02  C                   IF        XRATN = 'subClass'
N02  C     XRATV         CABNE     'MessageDate' SLSRXML307
N02  C                   LEAVE
N02  C                   END
N02  C     XMLKEY03      READE     XMLRCAF                                33
N02  C                   ENDDO
N02   *
N02  C     XMLKEY03      CHAIN     XMLRCVF01                          33
N02  C                   DOW       *IN33 = *OFF                                 1<-B
N02  C                   SELECT                                                  2<-B
N02  C                   WHEN      XRNV = 'Year'                                 2
N02  C                   MOVEL     XRVERD        XTXT
N02  C                   EXSR      KNVTAL
N02  C                   EVAL      XDTMSG = XDTMSG + XTAL * 10000
N02  C                   WHEN      XRNV = 'Month'                                2
N02  C                   MOVEL     XRVERD        XTXT
N02  C                   EXSR      KNVTAL
N02  C                   EVAL      XDTMSG = XDTMSG + XTAL * 100
N02  C                   WHEN      XRNV = 'Day'                                  2
N02  C                   MOVEL     XRVERD        XTXT
N02  C                   EXSR      KNVTAL
N02  C                   EVAL      XDTMSG = XDTMSG + XTAL
N02  C                   ENDSL                                                   2<-E
N02   *
N02  C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
N02  C     XMLKEY03      CHAIN     XMLRCVF01                          33
N02  C                   ENDDO                                                  1<-E
N02   *
N02  C     SLSRXML307    ENDSR
N02   *
      *
      ***********************************************
     C     SRHENTCN      BEGSR
      ***********************************************
      *
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      * INFOR. FRA <Equipment>
      *
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'Equipment'                            2
     C                   GOTO      STHENTCN01
     C                   ENDSL                                                   2<-E
     C                   ADD       1             X002_XRLEV3
     C     XMLKEY02      CHAIN     XMLRCVF                            33
     C                   ENDDO                                                  1<-E
     C                   GOTO      SLHENTCN
      *
     C     STHENTCN01    TAG
     C                   EVAL      X003_XRLEV1 = XRLEV1
     C                   EVAL      X003_XRLEV2 = XRLEV2
     C                   EVAL      X003_XRLEV3 = XRLEV3
     C                   EVAL      X003_XRLEV4 = 1
     C                   EVAL      X003_XRLEV5 = 0
     C                   MOVE      *ZEROS        CNT1
S23  C*                  MOVE      *ZEROS        SVNT
N23  C                   MOVE      *ZEROS        SVNT01
     C                   MOVE      *ZEROS        XN1
      *
     C     XMLKEY03      CHAIN     XMLRCVF01                          33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
     C                   WHEN      XRNV = 'EquipmentType'                        2
     C                   IF        XRVERD = 'CN'                                  3<-B
     C                   EVAL      SEKDC  = '1'
     C                   END                                                      3<-E
     C                   WHEN      XRNV = 'EquipmentId'                          2
S23  C*                  EVAL      SVNT   = SVNT + 1
S23  C*                  EVAL      CNT1(SVNT) = XRVERD
N23  C                   EVAL      SVNT01 = SVNT01 + 1
N23  C                   EVAL      CNT1(SVNT01) = XRVERD
     C                   WHEN      XRNV = 'Weight'                               2
     C                   WHEN      XRNV = 'Volume'                               2
     C                   ENDSL
      *
     C                   EVAL      X003_XRLEV4 = X003_XRLEV4 + 1
     C     XMLKEY03      READE     XMLRCVF01                              33
     C                   ENDDO                                                  1<-E
      *
     C     SLHENTCN      ENDSR
      *
      ***********************************************
     C     SROPDHEA      BEGSR
      ***********************************************
N07  C                   IF        XFLERVAL = 'J'
N07  C                   EXSR      SRBYTTVAL
N07  C                   END
N07   *
     C                   MOVE      *ZEROS        SEMP
     C                   MOVE      *BLANKS       SEDTØ
     C                   MOVE      *BLANKS       SE0035
     C                   IF        XINNSTIKK = 'J'
     C                   MOVE      'I'           SEMI
     C                   ELSE
     C                   MOVE      XSEMI         SEMI
     C                   END
      *
     C                   IF        SESG = *BLANKS
BL   C*                  MOVE      'AMT'         SESG
BL   C                   MOVE      'AUT'         SESG
     C                   END
     C*                  IF        SETARF = *BLANKS
     C     KODTSIK       CHAIN     KODTSI                             33
     C  N33              EVAL      SETARF = KSINAV
     C*                  END
     C                   MOVE      'H'           SEUR
     C                   MOVE      'Q'           SEST
     C                   MOVE      'F'           HEST
     C                   MOVE      'DFU'         SEMF
     C                   Z-ADD     3             SEMP
N05  C                   IF        SEKNK = 0
N05  C                   EVAL      *IN33 = *ON
N05  C                   ELSE
N05   * BEVARE FORETAKS FRA AVDELINGS KUNDE
N05  C                   EVAL      FO_SYRG = SYRG
N05  C     CUNDL01KAN    CHAIN     CUNDL01                            33
N05  C                   EVAL      SYRG = FO_SYRG
S21  C* N33AKTKOD        COMP      'A'                                3333
S17  C*                  IF        *IN33
S17   * OPPHEV ENDRING 16.   TELEFON FRA ANNE 18.09.2014. KL. 08.40
S21  C*                  IF        *IN33 AND *IN33 = *OFF
N21  C                   IF        *IN33
N16  C                   CLEAR                   KUNDR
S21  C*                  EVAL      AKTKOD = 'A'
N21  C                   EVAL      AKTKOD = 'I'
N16  C                   EVAL      KPERS  = 'AN-KUNDE'
N16  C                   EVAL      FIRMA  = FIFIRM
N16  C                   EVAL      KUNDNR = SEKNK
N16  C                   EVAL      KNAVN  = SENAK
N16  C                   EVAL      SONAVN = SENAK
N16  C                   EVAL      ADR1   = SEADK1
N16  C                   EVAL      ADR2   = SEADK2
N16  C                   EVAL      ADR3   = SEADK3
N16  C                   MOVE      *BLANKS       XAN01             1
N16  C                   IF        %SUBST(XXPOSTNR:5:5) = *BLANKS
N16  C     1             DO        4             XN                3 0
N16  C                   MULT      10            POSTNR
N16  C                   EVAL      XAN01 = %SUBST(XXPOSTNR:XN:1)
N16  C                   IF        XAN01 >= '0' AND XAN01 <= '9'
N16  C                   MOVE      XAN01         POSTNR
N16  C                   END
N16  C                   ENDDO
N16  C                   ELSE
N16  C                   EVAL      SYPOGE = XXPOSTNR
N16  C                   END
N16  C                   EVAL      SYKONT = SEKT7
N16  C                   EVAL      SYFR02 = SEKTC
N16  C                   EVAL      SYRG   = SERG
N16  C                   WRITE     KUNDR
N21  C                   IF        *IN33 AND *IN33 = *OFF
N16  C                   EVAL      IBM_AKTKOD = 'A'
N16  C                   EVAL      IBM_KPERS  = 'AN-KUNDE'
N16  C                   EVAL      IBM_FIRMA  = FIFIRM
N16  C                   EVAL      IBM_KUNDNR = SEKNK
N16  C                   EVAL      IBM_KNAVN  = SENAK
N16  C                   EVAL      IBM_SONAVN = SENAK
N16  C                   EVAL      IBM_ADR1   = SEADK1
N16  C                   EVAL      IBM_ADR2   = SEADK2
N16  C                   EVAL      IBM_ADR3   = SEADK3
N16  C                   EVAL      IBM_POSTNR = POSTNR
N16  C                   IF        SYRG = *BLANKS
N16  C                   MOVEL     *ZEROS        IBM_FORETN
N16  C                   ELSE
N16  C                   MOVEL     SYRG          IBM_FORETN
N16  C                   END
N16  C                   WRITE     KUNDRIBM
N21  C                   END
N16  C                   EVAL      SYRG = FO_SYRG
N16  C                   EVAL      *IN33 = *OFF
N16  C                   END
N05  C                   END
S05  C*                  IF        SERG <> *BLANKS
N05  C   33              IF        SERG <> *BLANKS
N03  C                   EVAL      FO_SYRG = SERG
N03  C     CUNDLFOK      CHAIN     CUNDLFO                            33
N03  C                   DOW       *IN33 = *OFF
N03  C                   IF        FO_AKTKOD = 'A'
N03  C                   EVAL      SEKNK = FO_KUNDNR
N03  C                   LEAVE
N03  C                   END
N03  C     CUNDLFOK      READE     CUNDLFO                                33
N03  C                   ENDDO
N03  C                   END
     C*                  IF        SEGN = *BLANKS
     C*                  MOVE      WDT           XAN04             4
     C*                  EVAL      SEGN = XAN04
     C*                  END
      *
     C                   MOVE      'CC'          HEOT
      *
     C                   WRITE     SAEHR
     C                   WRITE     HEADFR
     C                   WRITE     DISPR
     C                   MOVE      XXAVD         XSAVD
     C                   WRITE     XMLSAEHR
N13   *
N13  C                   EXSR      SROPDTT
      *
      * OPPDATER EDIM
     C                   MOVEL     WDT           M0068A
     C                   MOVE      *ZEROS        M0068B
     C                   MOVE      *ZEROS        M0068C
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   EVAL      M0004 = 'AMPHORA'
     C                   EVAL      M0010 = 'SYSPEDNO'
     C                   MOVE      S0035         M0035
     C                   EVAL      M0062 = X14S
     C                   MOVE      'XMLEXP'      M0065
     C                   EVAL      M0068 = XORDREF
     C                   MOVE      *ZEROS        M0068D
     C                   MOVE      *ZEROS        M0068E
     C                   MOVE      *ZEROS        M0068F
     C                   MOVE      '830'         M1001
     C                   EVAL      M1004 = X14S
     C                   MOVEL     'XML'         M1225
     C                   MOVE      *ZEROS        M5004D
     C                   MOVE      *BLANKS       M1N08
      *
     C                   MOVE      USN           MSN
     C                   Z-ADD     CMN           MMN
     C                   MOVE      'R'           MSR
     C                   MOVE      'C'           MST
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   MOVE      SEAVD         MAVD
     C                   MOVE      SETDN         MTDN
      *
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
N13   ***********************************************
N13  C     SROPDTT       BEGSR
N13   ***********************************************
N13   *
N13  C                   EVAL      TTAVD  = SEAVD
N13  C                   EVAL      TTOPD  = SETDN
N13  C                   MOVE      WDT           TTDATE
N13  C                   MOVE      WTM           TTTIME
N13  C                   EVAL      TTUSER = ZUSER
N13  C                   MOVE      WDT           TTDATL
N13  C                   MOVE      WTM           TTTIML
N13  C                   EVAL      TTNAME = 'SYXML18'
N13  C                   WRITE     TRACKFR
N13   *
N13  C                   ENDSR
N13   *
      ***********************************************
     C     SNDTVINN      BEGSR
      ***********************************************
      * SEND TIL TVINN
     C*                  MOVE      'DFU'         M1N07
     C                   EXSR      FINMTY
      *
     C                   IF        XNYSKV = 'J'                                 1<-B
     C                   MOVEL     WDT           M0068A
     C     M0068A        CHAIN     TVIND                              32
     C   32              Z-ADD     M0068A        D0068A
     C   32              Z-ADD     0             D0068B
     C                   ADD       1             D0068B
     C   32              WRITE     TVINDF
     C  N32              UPDATE    TVINDF
     C                   MOVE      D0068B        M0068B
     C                   Z-ADD     1             M0068C
     C                   ELSE                                                   1
     C                   EVAL      M0068A = M2_M0068A
     C                   EVAL      M0068B = M2_M0068B
     C                   EVAL      M0068C = 0
     C                   MOVE      *ZEROS        Æ0068C            2 0
     C     EDIM4K        SETLL     EDIM4
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C                   IF        M4_M0065 = 'CUSDEC' OR M4_M0065 = 'CUSRES'     3<-B
     C                   IF        M4_MST <> 'D' AND M4_M1001 = '830'              4<-B
     C                   IF        Æ0068C = 0                                       5<-B
     C                   EVAL      Æ0068C = M4_M0068C
     C                   END                                                        5<-E
     C                   IF        M1N07 <> 'DFI' AND                               5<-B
     C                             M1N07 <> 'DII' AND
     C                             M1N07 <> 'DPU'
     C                   EVAL      M0068C = Æ0068C + 1
     C                   LEAVE
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   ENDDO                                                   2<-E
     C                   END                                                    1<-E
      *
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   MOVE      S0004         M0004
     C                   MOVE      S0010         M0010
     C                   MOVE      S0035         M0035
     C                   EVAL      M0062 = X14S
     C                   MOVE      'CUSDEC'      M0065
     C                   MOVE      *BLANKS       M0068
     C                   MOVE      SYFORE        X0068Æ
     C                   MOVEL     X0068Å        M0068
     C                   MOVE      *ZEROS        M0068D
     C                   MOVE      *ZEROS        M0068E
     C                   MOVE      *ZEROS        M0068F
     C                   MOVE      '830'         M1001
     C                   MOVE      *BLANKS       M1004
     C                   SELECT
     C     M1N07         WHENEQ    'DFU'
     C                   MOVEL     '9  '         M1225
     C     M1N07         WHENEQ    'DMA'
     C                   MOVEL     'ZZ '         M1225
     C     M1N07         WHENEQ    'DFO'
     C                   MOVEL     '14 '         M1225
     C     M1N07         WHENEQ    'DEN'
     C                   MOVEL     '2  '         M1225
     C     M1N07         WHENEQ    'DKO'
     C                   MOVEL     '4  '         M1225
     C     M1N07         WHENEQ    'DOM'
     C                   MOVEL     '18 '         M1225
     C                   ENDSL
N02  C                   IF        XDTMSG = 0
     C                   MOVE      SEDTØ         M2005B
N02  C                   ELSE
N02  C                   Z-SUB     XDTMSG        M2005B
N02  C                   END
     C                   MOVE      S3039D        M3039D
     C                   MOVE      S3039E        M3039E
     C                   MOVE      *ZEROS        M5004D
     C                   MOVE      *BLANKS       M1N08
     C                   Z-ADD     3             M9N01
      *
     C                   MOVE      *ZEROS        MSN
     C                   Z-ADD     CMN           MMN
     C                   MOVE      'S'           MSR
     C                   MOVE      *BLANKS       MST
     C                   MOVE      *ZEROS        MDT
     C                   MOVE      *ZEROS        MTM
     C                   MOVE      SEAVD         MAVD
     C                   MOVE      SETDN         MTDN
      *
     C                   WRITE     EDIMR
      *
     C     SAEHK2        CHAIN     SAEH                               33
     C                   IF        XBMI = 'J'
     C                   MOVE      ' '           SEMI
     C                   END
     C                   IF        SEVKB = 0
     C                   MOVE      XSEVKB        SEVKB
     C                   END
     C                   MOVE      XSENTK        SENTK
     C                   MOVE      M1N07         SEMF
N22  C                   IF        SEBEL2 = 0
N22  C                   MOVE      *ZEROS        SEBEL3
N22  C                   ELSE
N22  C                   EVAL(H)   SEBEL3 = SEBEL2 * XKRS2 / XOMR2
N22  C                   END
     C                   UPDATE    SAEHR
     C     SAEHK2        CHAIN     HEADF                              33
     C                   IF        HEVKT = 0
     C                   MOVE      XSEVKB        HEVKT
     C                   END
     C                   MOVE      XSENTK        HENT
     C                   UPDATE    HEADFR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDLIN      BEGSR
      ***********************************************
      *
     C                   IF        SVVNT <> 0
     C                   SELECT
     C                   WHEN      ((SVVKTB = 0) AND (SVVKTN = 0))
     C                   EVAL      SVVKTB = 1
     C                   EVAL      SVVKTN = 1
     C                   WHEN      SVVKTB = 0
     C                   EVAL(H)   SVVKTB = SVVKTN * 1.1
     C                   WHEN      SVVKTN = 0
     C                   EVAL(H)   SVVKTN = SVVKTN * 0.9
     C                   ENDSL
     C*                  Z-ADD(H)  SVVKTN        XSVVKTN           9 0
     C*                  MOVE      SVBELT        XSVBELT          11 2
     C*                  MOVE      SVNTM         XSVNTM            7 0
     C                   ADD(H)    SVVKTB        SEVKB
N08   *
N08   * UNDERSTELLSNR SKAL LIGGE PÅ HOVEDLINJE
N08  C     1             DO        7             XN1
N08  C                   IF        DOK1(XN1) = 'VI'
S23  C*                  EVAL      SVEH    = 'U.NR'
S23  C*                  EVAL      SVNT    = 1
S23  C*                  EVAL      SVFT    = DOK2(XN1)
N23  C                   EVAL      SVEH01  = 'U.NR'
N23  C                   EVAL      SVNT01  = 1
N23  C                   EVAL      SVFT01  = DOK2(XN1)
N08  C     XN1           DO        6             XN2
N08  C                   EVAL      DOK1(XN2) = DOK1(XN2+1)
N08  C                   EVAL      DOK2(XN2) = DOK2(XN2+1)
N08  C                   ENDDO
N08  C                   EVAL      DOK1(7) = *BLANKS
N08  C                   EVAL      DOK2(7) = *BLANKS
N08  C                   LEAVE
N08  C                   END
N08  C                   ENDDO
      *
S23  C*                  IF        CNT1(1) <> *BLANKS
S23  C*                  MOVE      CNT1(1)       SVFT
S23  C*                  END
S23  C*                  MOVE      VT1(1)        SVVT
S23  C*                  MOVE      DOK1(1)       SVCREF
S23  C*                  MOVEL     DOK2(1)       SVTOA
     C                   WRITE     SAEVR
S23  C*                  MOVE      *ZEROS        SVVKTB
S23  C*                  MOVE      *ZEROS        SVVKTN
S23  C*                  MOVE      *ZEROS        SVBELT
S23  C*                  MOVE      *ZEROS        SVNTM
S23  C*                  MOVE      *BLANKS       SVVT
S23  C*                  EVAL      SVNT    = 0
S23  C*                  EVAL      SVFT    = *BLANKS
S23  C*                  MOVE      SVLI          SVREFL
S23  C*    2             DO        7             XN1
S23  C*                  IF        CNT1(XN1) = *BLANKS AND
S23  C*                            VT1(XN1) = *BLANKS AND
S23  C*                            DOK1(XN1) = *BLANKS
S23  C*                  LEAVE
S23  C*                  END
S23  C*                  MOVE      VT1(XN1)      SVVT
S23  C*                  MOVE      CNT1(XN1)     SVFT
S23  C*                  MOVE      DOK1(XN1)     SVCREF
S23  C*                  MOVEL     DOK2(XN1)     SVTOA
S23  C*                  ADD       1             SVLI
S23  C*                  WRITE     SAEVR
S23  C*                  ENDDO
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRFINNAVD     BEGSR
      ***********************************************
      *
     C                   EVAL      X002_XRLEV1 = XRLEV1
     C                   EVAL      X002_XRLEV2 = XRLEV2
     C                   EVAL      X002_XRLEV3 = 1
     C                   EVAL      X002_XRLEV4 = 0
      *
     C                   MOVE      'N'           XOKAVD            1
     C     XRSN          SETLL     XMLRCVF
     C     XRSN          READE     XMLRCVF                                33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   SELECT                                                  2<-B
S04  C*                  WHEN      XRNV = 'Location'                             2
S04  C*    XMLKEYAVD     CHAIN     XMLRCAF                            33
S04  C*                  DOW       *IN33 = *OFF                                   3<-B
S04  C*                  SELECT                                                    4<-B
S04  C*                  WHEN      ((XRATN = 'subClass') AND                       4
S04  C*                             (XRATV = 'CustomsDepartment'))
S04  C*                  MOVE      'J'           XOKAVD            1
S04  C*                  WHEN      ((XRATN = 'locationId') AND (XOKAVD = 'J'))     4
S04  C*                  MOVEL     XRATV         XTXT
S04  C*                  EXSR      KNVTAL
S04  C*                  Z-ADD     XTAL          XXAVD             4 0
S04  C*                  GOTO      SLFAVD
S04  C*                  ENDSL                                                     4<-E
S04  C*    XMLKEYAVD     READE     XMLRCAF                                33
S04  C*                  ENDDO                                                    3<-E
S04  C*                  IF        XOKAVD = 'N'                                   3<-B
S04  C*                  Z-ADD     0             XXAVD             4 0
S04  C*                  END                                                      3<-E
     C                   WHEN      XRNV = 'Party'                                2
S04  C*    XRSN          READE     XMLRCVF                                33
     C     XMLKEYAVD     CHAIN     XMLRCAF                            33
     C                   DOW       *IN33 = *OFF                                   3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      ((XRATN = 'subClass') AND                       4
     C                              (XRATV = 'CustomsBroker'))
     C                   MOVE      'J'           XOKAVD            1
     C                   WHEN      ((XRATN = 'subPartyId') AND (XOKAVD = 'J'))     4
     C                   MOVEL     XRATV         XTXT
     C                   EXSR      KNVTAL
     C                   Z-ADD     XTAL          XXAVD             4 0
     C                   GOTO      SLFAVD
     C                   ENDSL                                                     4<-E
     C     XMLKEYAVD     READE     XMLRCAF                                33
     C                   ENDDO                                                    3<-E
     C                   ENDSL                                                   2<-E
     C     XRSN          READE     XMLRCVF                                33
     C                   ENDDO                                                  1<-E
      *
     C     SLFAVD        ENDSR
      *
      ***********************************************
     C     KNVTAL        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XTAL
     C     1             DO        15            XN                3 0          1<-B
     C                   IF        ((XT(XN) = *BLANKS) OR (XT(XN) = '.'))        2<-B
     C                   LEAVE
     C                   ENDIF                                                   2<-E
     C                   MULT      10            XTALH
     C                   MOVE      XT(XN)        XTALH
     C                   ENDDO                                                  1<-E
      *
     C                   IF        XT(XN) = '.'                                 1<-B
     C                   ADD       1             XN
     C                   MOVE      XT(XN)        XTALD1
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                 2<-B
     C                   MOVE      XT(XN)        XTALD2
     C                   ADD       1             XN
     C                   IF        XT(XN) <> ' '                                  3<-B
     C                   MOVE      XT(XN)        XTALD3
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     FINMTY        BEGSR
      ***********************************************
     C                   MOVE      'N'           XBMI              1
     C                   MOVE      'N'           XINST             1
     C                   Z-ADD     3             M9N01
      *
     C     EDIM2K1       SETLL     EDIM2                              33
     C     STFMTY        TAG
     C     EDIM2K2       READPE    EDIM2                                  33
     C  N33              SELECT                                                 1<-B
     C     M2_M1001      WHENNE    '830'                                        1
     C     M2_MST        OREQ      'D'
     C     M2_MSR        OREQ      'S'
     C     M2_M1N07      OREQ      'DFI'
     C     M2_M1N07      OREQ      'DII'
     C     M2_M1N07      OREQ      'DPU'
     C     M2_M1N07      OREQ      'DKO'
     C     M2_M0068C     OREQ      0
     C     M2_M0068C     CABEQ     0             STFMTY
     C     M2_MSR        IFEQ      'S'                                           2<-B
     C     XINST         ANDEQ     'N'
     C     M2_M1N07      IFEQ      'DMA'                                          3<-B
     C     M2_M1N07      OREQ      'DEN'
      * DENNE TOLLDEK. KAN VÆRE INNSTIKK HVIS MELDING FØR DENNE
      * ER EN 'DUA' FRA TOLLVESENET.
     C                   MOVE      'J'           XINST             1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   GOTO      STFMTY
     C     M2_M1N07      WHENEQ    'DME'                                         2<-B
     C     SEMI          IFEQ      'I'                                           2<-B
     C                   GOTO      STFMTY
     C                   ELSE                                                    2
     C                   MOVE      'DKO'         M1N07
     C                   END                                                     2<-E
     C     M2_M1N07      WHENEQ    'DUA'                                        1<-B
     C     SEMI          IFEQ      'I'                                           2<-B
     C     XINST         OREQ      'J'
     C                   MOVE      'DEN'         M1N07
     C                   MOVE      'J'           XBMI
     C                   ELSE                                                    2
     C                   MOVE      'DKO'         M1N07
     C                   END                                                     2<-E
     C     M2_M1N07      WHENEQ    'DIU'                                        1
     C                   MOVE      '1'           *IN33
     C     M2_M1N07      WHENEQ    'DTK'                                        1
     C                   MOVE      'DOM'         M1N07
     C                   OTHER                                                  1
     C                   MOVE      '1'           *IN33
     C                   ENDSL                                                  1<-E
      *
     C  N33              MOVE      'N'           XNYSKV            1
     C   33              MOVE      'J'           XNYSKV            1
     C   33              SELECT                                                 1<-B
     C     SEMI          WHENEQ    'I'                                          1
     C                   MOVE      'DFO'         M1N07
     C     SEDP          WHENEQ    10                                           1
     C                   MOVE      'DFU'         M1N07
     C                   OTHER                                                  1
     C                   MOVE      'DMA'         M1N07
     C                   ENDSL                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    USN               9
      *
     C     SAEHK         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     SAEHK2        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     FRISOL01K     KLIST
     C                   KFLD                    FSKODE
     C                   KFLD                    FSSOK
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
N05  C     CUNDL01KAN    KLIST
N05  C                   KFLD                    FIFIRM
N05  C                   KFLD                    SEKNK
N03  C     CUNDLFOK      KLIST
N03  C                   KFLD                    FIFIRM
N03  C                   KFLD                    FO_SYRG
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    SEAVD
     C     KODTLBK       KLIST
     C                   KFLD                    KLBUNI
     C                   KFLD                    SELV
     C     KODTSIK       KLIST
     C                   KFLD                    KSIUNI
     C                   KFLD                    SESG
     C     KODTS2K       KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C     KODTTSTK      KLIST
     C                   KFLD                    KTSUNI
     C                   KFLD                    SEKDH
     C*                  KFLD                    KTSPNR
     C     KODTVAL2K1    KLIST
     C                   KFLD                    SEVAL1
     C                   KFLD                    WDT08
     C     KODTVAL2K2    KLIST
     C                   KFLD                    SEVAL2
     C                   KFLD                    WDT08
     C     KODTVAL2KV    KLIST
     C                   KFLD                    XVALV             3
     C                   KFLD                    WDT08
     C     EDIM2K1       KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    MAX0A
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C     EDIM2K2       KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     EDIM4K        KLIST
     C                   KFLD                    M4_MSR
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    MAX0A
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C     EDIM4K2       KLIST
     C                   KFLD                    M4_MSR
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     XMLKEY01      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X001_XRLEV1
     C                   KFLD                    X001_XRLEV2
     C                   KFLD                    X001_XRLEV3
     C                   KFLD                    X001_XRLEV4
     C                   KFLD                    X001_XRLEV5
     C                   KFLD                    X001_XRLEV6
     C                   KFLD                    X001_XRLEV7
     C                   KFLD                    X001_XRLEV8
     C                   KFLD                    X001_XRLEV9
     C     XMLKEY02      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X002_XRLEV1
     C                   KFLD                    X002_XRLEV2
     C                   KFLD                    X002_XRLEV3
     C                   KFLD                    X002_XRLEV4
     C     XMLKEY03      KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEY031     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C     XMLKEY032     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C                   KFLD                    X003_XRLEV6
     C     XMLKEY033     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    X003_XRLEV1
     C                   KFLD                    X003_XRLEV2
     C                   KFLD                    X003_XRLEV3
     C                   KFLD                    X003_XRLEV4
     C                   KFLD                    X003_XRLEV5
     C     XMLKEYAVD     KLIST
     C                   KFLD                    XRSN
     C                   KFLD                    XRLEV1
     C                   KFLD                    XRLEV2
     C                   KFLD                    XRLEV3
     C                   KFLD                    XRLEV4
     C                   KFLD                    XRLEV5
     C                   KFLD                    XRLEV6
      *
     C     *LIKE         DEFINE    SEAVD         XAVD
     C     *LIKE         DEFINE    SETDN         XTDN
     C     *LIKE         DEFINE    XRLEV1        X001_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X001_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X001_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X001_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X001_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X001_XRLEV6
     C     *LIKE         DEFINE    XRLEV7        X001_XRLEV7
     C     *LIKE         DEFINE    XRLEV8        X001_XRLEV8
     C     *LIKE         DEFINE    XRLEV9        X001_XRLEV9
     C     *LIKE         DEFINE    XRLEV1        X002_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X002_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X002_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X002_XRLEV4
     C     *LIKE         DEFINE    XRLEV1        X003_XRLEV1
     C     *LIKE         DEFINE    XRLEV2        X003_XRLEV2
     C     *LIKE         DEFINE    XRLEV3        X003_XRLEV3
     C     *LIKE         DEFINE    XRLEV4        X003_XRLEV4
     C     *LIKE         DEFINE    XRLEV5        X003_XRLEV5
     C     *LIKE         DEFINE    XRLEV6        X003_XRLEV6
     C     *LIKE         DEFINE    XRNV          X001_XRNV
     C     *LIKE         DEFINE    SEVKB         XSEVKB
     C     *LIKE         DEFINE    SENTK         XSENTK
     C     *LIKE         DEFINE    SVAVD         XSVAVD
     C     *LIKE         DEFINE    SVTDN         XSVTDN
     C     *LIKE         DEFINE    SVLI          XSVLI
S09  C*    *LIKE         DEFINE    S3039E        XS3039E
     C     *LIKE         DEFINE    M0068         XM0068
     C     *LIKE         DEFINE    M0068A        MAX0A
     C     *LIKE         DEFINE    M0068B        MAX0B
     C     *LIKE         DEFINE    M0068C        MAX0C
      *
     C                   MOVE      USN           XRSN
     C                   MOVE      'A'           KOAUNI
     C                   MOVE      'LB'          KLBUNI
     C                   MOVE      'SI'          KSIUNI
     C                   MOVE      'S2 '         KS2UNI
     C                   MOVE      'TST'         KTSUNI
     C                   MOVE      '99999999'    MAX0A
     C                   MOVE      '999999'      MAX0B
     C                   MOVE      '99'          MAX0C
     C                   MOVE      'R'           M4_MSR
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT08             8 0
     C                   MOVE      *BLANKS       XMSGTXT         200
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for håndtering av feil                         SRERROR /
      *////////////////////////////////////////////////////////////
     C     SRERROR       BEGSR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XDT               8 0
     C                   MOVE      WTM           XTM               6 0
     C                   EVAL      XMSG = 'Feil ved SAD-eksport, '
     C                             + 'DATO = ' + %TRIM(%EDITW(XDT:'    .  .  '))
     C                             + ', '
     C                             + 'TID = ' + %TRIM(%EDITW(XTM:'  :  :  '))
     C                             + '. '
     C                             + %TRIM(XMSGTXT)
     C                   CALL      'EDIERRC'
     C                   PARM                    XMSG            256
      *
     C                   ENDSR
      *
