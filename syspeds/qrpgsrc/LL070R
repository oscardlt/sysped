     FLLHEAD07  IF   E           K DISK    USROPN
     FLLLINE    IF   E           K DISK    USROPN
     FLLLISF    IF   E           K DISK    USROPN
     FLLMRF     IF   E           K DISK    USROPN
     FLLAGJD02  IF   E           K DISK    USROPN
     FLLAGJL01  IF   E           K DISK    USROPN
     FKODTVAL2  IF   E           K DISK
     FSADF      UF A E           K DISK
     FSAEF      UF A E           K DISK
     F                                     RENAME(SADFR:SAEFR)
     D T1              S             35    DIM(900)
     D T2              S              8    DIM(900)
     D T3              S              3    DIM(900)
     D T4              S             13  2 DIM(900)
     D                 DS
     D  X1DT                   1      8  0
     D  X1DTÅ                  1      4  0
     D  X1DTM                  5      6  0
     D  X1DTD                  7      8  0
     D                 DS
     D  X2DT                   1      6  0
     D  X2DTD                  1      2  0
     D  X2DTM                  3      4  0
     D  X2DTÅ                  5      6  0
     D                 DS
     D  MRGN                   1     15
     D  XXGN                  15     15
      *
     C                   EXSR      INIT
      *
     C                   MOVE      'N'           XFLERE            1
      * SUMMERE ALLE LINJE MED SAMME VALUTA
     C     LH07K         SETLL     LLHEAD07
     C     LH07K         READE     LLHEAD07                               33
      * SLETT ALLE LINJER FOR RUBR. 28
     C  N33UIE           IFEQ      'I'                                          1<-B
     C     LH07K         SETLL     SADF
     C     LH07K         READE     SADF                                   34
     C     *IN34         DOWEQ     '0'                                           2<-B
     C                   DELETE    SADFR
     C     LH07K         READE     SADF                                   34
     C  N34              ENDDO                                                   2<-E
     C                   ELSE                                                   1
     C     LH07K         SETLL     SAEF
     C     LH07K         READE     SAEF                                   34
     C     *IN34         DOWEQ     '0'                                           2<-B
     C                   DELETE    SAEFR
     C     LH07K         READE     SAEF                                   34
     C  N34              ENDDO                                                   2<-E
     C                   END                                                    1<-E
      *
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     LHMN          SETLL     LLLINE
     C     LHMN          READE     LLLINE                                 34
      *
     C     *IN34         DOWEQ     '0'                                           2<-B
     C     LD02K         CHAIN     LLAGJD02                           35
     C     LJ01K         CHAIN     LLAGJL01                           35
     C     LMRFK         CHAIN     LLMRF                              35
     C  N35XXGN          COMP      ' '                                    35
     C   35              GOTO      XNESTE
     C     VAFAR         IFEQ      *BLANKS
     C                   MOVEL     'NOK'         VAFAR
     C                   END
     C     UGN           IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     MRGN          UGN
     C                   END                                                      3<-E
     C     VAMN          SETLL     LLLISF
     C     VAMN          READE     LLLISF                                 35
     C                   MOVE      *ZEROS        XN
     C     *IN35         DOWEQ     '0'                                            3<-B
     C     LIKD          IFEQ      'FAK'                                           4<-B
     C     LITXT         IFEQ      *BLANKS                                          5<-B
     C                   MOVEL     'UKJENT'      LITXT
     C                   END                                                        5<-E
     C     1             DO        900           XN                3 0              5<-B
     C     T1(XN)        IFEQ      *BLANKS                                           6<-B
     C                   MOVEL     LITXT         T1(XN)
     C                   MOVE      VADATO        T2(XN)
     C                   MOVEL     VAFAR         T3(XN)
     C     UVAL1         IFEQ      *BLANKS                                            7<-B
     C                   MOVE      T3(XN)        UVAL1
     C                   ELSE                                                         7
     C     T3(XN)        IFNE      UVAL1                                               8<-B
     C                   MOVE      'J'           XFLERE
     C                   MOVE      'NOK'         UVAL1
     C                   END                                                           8<-E
     C                   END                                                          7<-E
     C                   GOTO      START1
     C                   END                                                         6<-E
     C     T1(XN)        CABEQ     LITXT         START1
     C                   ENDDO                                                      5<-E
     C                   END                                                       4<-E
     C     VAMN          READE     LLLISF                                 35
     C  N35              ENDDO                                                    3<-E
      *
     C     START1        TAG
      *
     C     XN            IFEQ      0                                              3<-B
      * INGEN LISENSLINJE MED KODE='FAK' FINNES
     C                   MOVEL     'UKJENT'      LITXT
     C     1             DO        900           XN                3 0             4<-B
     C     T1(XN)        IFEQ      *BLANKS                                          5<-B
     C                   MOVEL     LITXT         T1(XN)
     C                   MOVE      VADATO        T2(XN)
     C                   MOVEL     VAFAR         T3(XN)
     C     UVAL1         IFEQ      *BLANKS                                           6<-B
     C                   MOVE      T3(XN)        UVAL1
     C                   ELSE                                                        6
     C     T3(XN)        IFNE      UVAL1                                              7<-B
     C                   MOVE      'J'           XFLERE
     C                   MOVE      'NOK'         UVAL1
     C                   END                                                          7<-E
     C                   END                                                         6<-E
     C                   GOTO      ST11
     C                   END                                                        5<-E
     C     T1(XN)        CABEQ     LITXT         ST11
     C                   ENDDO                                                     4<-E
     C     ST11          TAG
     C                   END                                                      3<-E
      *
     C     LLPRI         IFEQ      0
     C     LLWNT0        MULT      VAVERD        XBEL             13 2
     C                   ELSE
     C     LLWNT0        MULT      LLPRI         XBEL             13 2
     C                   END
     C                   ADD       XBEL          T4(XN)
      *
     C     XNESTE        TAG
     C     LHMN          READE     LLLINE                                 34
     C  N34              ENDDO                                                   2<-E
     C     LH07K         READE     LLHEAD07                               33
     C  N33              ENDDO                                                  1<-E
      *
      * OPPDATER FAKTURA
     C     T1(2)         IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     T1(1)         UFIF
     C                   MOVE      T2(1)         X1DT
     C                   MOVE      X1DTÅ         X2DTÅ
     C                   MOVE      X1DTM         X2DTM
     C                   MOVE      X1DTD         X2DTD
     C                   MOVE      X2DT          UFID
     C                   MOVE      T3(1)         UVAL1
     C                   MOVE      T4(1)         XBEL1
     C                   ELSE                                                   1
     C                   MOVEL     'F15  ER '    UFIF
     C                   MOVE      'BENYTTET'    UFIF
     C                   MOVE      '999999'      UFID
     C                   MOVE      UAVD          SFAVD
     C                   MOVE      UOPD          SFOPDN
     C                   Z-ADD     100           SFKR28
     C                   Z-ADD     100           SFOM28
     C     XFLERE        IFNE      'J'                                           2<-B
     C     T3(1)         ANDNE     'NOK'
     C                   MOVE      T3(1)         KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C  N33              Z-ADD     KVAKRS        SFKR28
     C  N33              Z-ADD     KVAOMR        SFOM28
     C                   END                                                     2<-E
     C     1             DO        900           XN                              2<-B
     C     T1(XN)        CABEQ     *BLANKS       START2
     C                   MOVEL     T1(XN)        SFTXT
     C                   MOVE      T2(XN)        SFDT
     C                   MOVE      T3(XN)        SFVK28
     C                   MOVE      T4(XN)        SFBL28
     C     XFLERE        IFEQ      'J'                                            3<-B
     C                   MOVE      T3(XN)        KVAKOD
     C     KODVAK        SETGT     KODTVAL2
     C     KVAKOD        READPE    KODTVAL2                               33
     C                   Z-ADD     KVAKRS        SFKR28
     C                   Z-ADD     KVAOMR        SFOM28
     C     SFBL28        MULT      SFKR28        XBL              17 6
     C                   DIV(H)    SFOM28        XBL
     C                   ELSE                                                     3
     C                   Z-ADD     SFBL28        XBL
     C                   END                                                      3<-E
     C     UIE           IFEQ      'I'                                            3<-B
     C                   WRITE     SADFR
     C                   ELSE                                                     3
     C                   WRITE     SAEFR
     C                   END                                                      3<-E
     C                   ADD       XBL           XBEL1            13 2
     C                   ENDDO                                                   2<-E
     C     START2        TAG
     C                   END                                                    1<-E
      *
     C                   MOVE      XBEL1         UBEL1
      *
     C                   CLOSE     LLHEAD07
     C                   CLOSE     LLLINE
     C                   CLOSE     LLLISF
     C                   CLOSE     LLMRF
     C                   CLOSE     LLAGJD02
     C                   CLOSE     LLAGJL01
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C                   PARM                    UIE               1
     C                   PARM                    UDT               8
     C                   PARM                    UBEL1            13
     C                   PARM                    UVAL1             3
     C                   PARM                    UFIF             17
     C                   PARM                    UFID              6
     C                   PARM                    UGN              15
      *
     C     LH07K         KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XOPD
     C     LD02K         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    LLMN
     C                   KFLD                    LLVN
     C     LJ01K         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    VDMN
     C     LMRFK         KLIST
     C                   KFLD                    LHGRP
     C                   KFLD                    LHPNR
     C                   KFLD                    VAMRNR
     C     KODVAK        KLIST
     C                   KFLD                    KVAKOD
     C                   KFLD                    XDT
      *
     C                   MOVE      UAVD          XAVD              4 0
     C                   MOVE      UOPD          XOPD              7 0
     C     UDT           IFEQ      *ZEROS
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XDT               8 0
     C                   ELSE
     C                   MOVE      UDT           XDT               8 0
     C                   END
     C                   OPEN      LLHEAD07                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   OPEN      LLLINE                               33
     C                   OPEN      LLLISF                               33
     C                   OPEN      LLMRF                                33
     C                   OPEN      LLAGJD02                             33
     C                   OPEN      LLAGJL01                             33
      *
     C                   ENDSR
      *
