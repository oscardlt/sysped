      * Kompilere med bibliotek YAJL og LIBHTTP
     H DFTACTGRP(*NO) ACTGRP('KLEMENT') OPTION(*SRCSTMT)
     H BNDDIR('YAJL')

      /include yajl_h

      * å lese ut json-node via en resultat-datastruktur er vel fornuftig kun når denne skal
      * deretter benyttes i en SQL write e.l.
     D result          ds                  qualified
     D   url                        512

     D docNode         s                   like(yajl_val)
     D resNode         s                   like(yajl_val)
     D list            s                   like(yajl_val)
     D node            s                   like(yajl_val)
     D val             s                   like(yajl_val)

     D i               s             10i 0
     D j               s             10i 0
     D x               s             10i 0
     D errMsg          s            500a   varying
     D Key             s             50a   varying
     D ValStr          s             50a   varying


     c     *entry        plist
     c                   parm                    URL_ut          256
     c                   parm                    Filename         45


      /free
         // er ute etter å finne første "Url"
         // den er nøsta inn i 2 nivå  result : {   og derunder resources : [ {..... url: ...

         // load the json document into a tree.
         docNode = yajl_stmf_load_tree( %trim(Filename) : errMsg );
         if errMsg <> '';
            // handle error
         endif;

         node = YAJL_object_find(docNode: 'result');
         j=0;
         dow YAJL_OBJECT_LOOP(node : j : key : val);
           If key = 'resources';
             exsr ResultArray;
             leave;
           endif;
         enddo;

         yajl_tree_free(docNode);

         *inlr = *on;

         //****************
         begsr  ResultArray;
         //****************
         // vi vet at xml ligger i første arrayelement
         // mulig en kan hente det direkte i stedet for hele lista (prøvede men fikk ikke til)
         // Må heller lage array leseloop (ytre) og hoppe ut når indre loop gar funnet "url"
         list = YAJL_object_find(node: 'resources');
         i=0;
         dow YAJL_ARRAY_LOOP(list : i : node);
           j=0;
           dow YAJL_OBJECT_LOOP(node : j : key : val);
             if Key = 'url';
               Url_Ut = yajl_get_string(val);
               leave;
             endif;
           enddo;
           if Url_Ut <> *blanks;
             leave;
           endif;
         enddo;

         endsr;
