********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11045 * 01 CB  PTF11 Oppdater Dansk/Svensk dekl/ncts
12287 * 02 YBC PTF12 Oppdater på NCTS fase 5
********************************************************************
     FEDIS      UF   E           K DISK
     FEDISS     O  A E             DISK
     FEDIM6     UF   E           K DISK
     FSADH      UF   E           K DISK    USROPN
     FSAEH      UF   E           K DISK    USROPN
     FTRUH      UF   E           K DISK    USROPN
     FTRIH      UF   E           K DISK    USROPN
N02  FNCTSEH    UF   E           K DISK    USROPN
N02  F                                     PREFIX(P5_)
N02  FNCTSIH    UF   E           K DISK    USROPN
N02  F                                     PREFIX(P5_)
N01  FDKIH      UF   E           K DISK    USROPN
N01  FDKEH      UF   E           K DISK    USROPN
N01  FDKXH      UF   E           K DISK    USROPN
N01  F                                     PREFIX(DK_)
N01  FDKNH      UF   E           K DISK    USROPN
N01  F                                     PREFIX(DK_)
N01  FDKXGH     UF   E           K DISK    USROPN
N01  F                                     PREFIX(DK_)
N01  FSVIH      UF   E           K DISK    USROPN
N01  FSVEH      UF   E           K DISK    USROPN
N01  FSVXH      UF   E           K DISK    USROPN
N01  F                                     PREFIX(SV_)
N01  FSVNH      UF   E           K DISK    USROPN
N01  F                                     PREFIX(SV_)
N01  FSVXGH     UF   E           K DISK    USROPN
N01  F                                     PREFIX(SV_)
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SSN           WSN
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WSN
     C     KEYB          KLIST
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
      * HENTE DAGENS DATO OG TID
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO             8
     C                   PARM                    WTID              6
      *_____________
      * Init av felt
      *"""""""""""""
      *______________________
      * Åpne filer fra SYSPED
      *""""""""""""""""""""""
     C                   OPEN      SADH                                 53
     C                   OPEN      SAEH                                 54
     C                   OPEN      TRUH                                 55
     C                   OPEN      TRIH                                 56
N01  C                   OPEN      DKIH                                 58
N01  C                   OPEN      DKEH                                 58
N01  C                   OPEN      DKXH                                 59
N01  C                   OPEN      DKNH                                 59
N01  C                   OPEN      DKXGH                                59
N01  C                   OPEN      SVIH                                 58
N01  C                   OPEN      SVEH                                 58
N01  C                   OPEN      SVXH                                 59
N01  C                   OPEN      SVNH                                 59
N01  C                   OPEN      SVXGH                                59
N02  C                   OPEN      NCTSEH                               60
N02  C                   OPEN      NCTSIH                               61
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WSN           PARM                    WSN
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *_________________________________
      * Oppdatere status i sendningslogg
      *"""""""""""""""""""""""""""""""""
     C     KEYA          CHAIN     EDIS                               51
     C                   SELECT
     C     SST           WHENLT    'D'
     C                   MOVE      '1'           SST
     C     SST           WHENEQ    '1'
     C                   MOVE      '2'           SST
     C     SST           WHENEQ    '2'
     C                   MOVE      '3'           SST
     C     SST           WHENEQ    '3'
     C                   MOVE      '4'           SST
     C     SST           WHENEQ    '4'
     C                   MOVE      '5'           SST
     C     SST           WHENGE    '5'
     C                   MOVE      'E'           SST
     C                   ENDSL
     C                   MOVEL     WDATO         SDT
     C                   MOVEL     WTID          STM
     C                   EVAL      SSR='S'
     C                   UPDATE    EDISR
      *________________________________
      * Oppdatere status i meldingslogg
      *""""""""""""""""""""""""""""""""
     C     SST           IFEQ      'E'
     C     KEYA          CHAIN     EDIM6                              51
     C     *IN51         DOWEQ     '0'
     C                   MOVE      'E'           MST
     C                   MOVEL     WDATO         MDT
     C                   MOVEL     WTID          MTM
     C                   UPDATE    EDIMR

     C     *IN53         IFEQ      *OFF
     C     *IN54         ANDEQ     *OFF
     C     *IN55         ANDEQ     *OFF
     C     *IN56         ANDEQ     *OFF
N01  C     *IN58         ANDEQ     *OFF
N01  C     *IN59         ANDEQ     *OFF
N02  C     *IN60         ANDEQ     *OFF
N02  C     *IN61         ANDEQ     *OFF
     C     KEYB          CHAIN     SADH                               52
     C     *IN52         IFEQ      '0'
     C     SIST          IFEQ      'A'
     C     SIST          OREQ      'B'
     C                   MOVE      'E'           SIST
     C                   ENDIF
     C                   UPDATE    SADHR
     C                   ENDIF
     C     KEYB          CHAIN     SAEH                               52
     C     *IN52         IFEQ      '0'
     C     SEST          IFEQ      'A'
     C     SEST          OREQ      'B'
     C                   MOVE      'E'           SEST
     C                   UPDATE    SAEHR
     C                   ENDIF
     C                   ENDIF
     C     KEYB          CHAIN     TRUH                               52
     C     *IN52         IFEQ      '0'
     C     THST          IFEQ      'A'
     C     THST          OREQ      'B'
     C                   MOVE      'E'           THST
     C                   ENDIF
     C                   UPDATE    TRUHR
N02  C                   ELSE
N02  C     KEYB          CHAIN     NCTSEH                             52
N02  C     *IN52         IFEQ      '0'
N02  C     P5_THST       IFEQ      'A'
N02  C     P5_THST       OREQ      'B'
N02  C     P5_THST       OREQ      'E'
N02  C                   MOVE      'E'           P5_THST
N02  C                   ENDIF
N02  C                   UPDATE    NCTSEHR
N02  C                   ENDIF
     C                   ENDIF
     C     KEYB          CHAIN     TRIH                               52
     C     *IN52         IFEQ      '0'
     C     TIST          IFEQ      'A'
     C     TIST          OREQ      'B'
     C     TIMF          IFEQ      '007'
     C                   MOVE      'E'           TIST
     C                   ELSE
     C                   MOVE      'F'           TIST
     C                   ENDIF
     C                   ENDIF
     C                   UPDATE    TRIHR
N02  C                   ELSE
N02  C     KEYB          CHAIN     NCTSIH                             52
N02  C     *IN52         IFEQ      '0'
N02  C     P5_TIST       IFEQ      'A'
N02  C     P5_TIST       OREQ      'B'
N02  C     P5_TIST       OREQ      'E'
N02  C     P5_TIMF       IFEQ      '007'
N02  C                   MOVE      'E'           P5_TIST
N02  C                   ELSE
N02  C                   MOVE      'F'           P5_TIST
N02  C                   ENDIF
N02  C                   ENDIF
N02  C                   UPDATE    NCTSIHR
N02  C                   ENDIF
     C                   ENDIF
N01   * SKAT/TOLD
N01  C     KEYB          CHAIN     DKIH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     DKIH_SYST     IFEQ      'A'
N01  C     DKIH_SYST     OREQ      'B'
N01  C     DKIH_SYST     OREQ      'E'
N01  C                   MOVE      *BLANKS       DKIH_SYST
N01  C                   MOVEL     'E'           DKIH_SYST
N01  C                   ENDIF
N01  C                   UPDATE    DKIHR
N01  C                   ENDIF
N01  C     KEYB          CHAIN     DKEH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     DKEH_SYST     IFEQ      'A'
N01  C     DKEH_SYST     OREQ      'B'
N01  C     DKEH_SYST     OREQ      'E'
N01  C                   MOVE      *BLANKS       DKEH_SYST
N01  C                   MOVEL     'E'           DKEH_SYST
N01  C                   ENDIF
N01  C                   UPDATE    DKEHR
N01  C                   ENDIF
N01  C     KEYB          CHAIN     DKXH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     DK_THST       IFEQ      'A'
N01  C     DK_THST       OREQ      'B'
N01  C     DK_THST       OREQ      'E'
N01  C                   MOVE      'E'           DK_THST
N01  C                   ENDIF
N01  C                   UPDATE    DKXHR
N01  C                   ENDIF
N01
N01  C                   MOVEL     M0068         DK_TGGNR
N01  C     DK_TGGNR      CHAIN     DKXGH                              52
N01  C     *IN52         IFEQ      '0'
N01  C     DK_TGST       IFEQ      'A'
N01  C     DK_TGST       OREQ      'B'
N01  C     DK_TGST       OREQ      'E'
N01  C                   MOVE      'E'           DK_TGST
N01  C                   ENDIF
N01  C                   UPDATE    DKXGHR
N01  C                   ENDIF
N01
N01  C     KEYB          CHAIN     DKNH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     DK_TIST       IFEQ      'A'
N01  C     DK_TIST       OREQ      'B'
N01  C     DK_TIST       OREQ      'E'
N01  C                   MOVE      'E'           DK_TIST
N01  C                   ENDIF
N01  C                   UPDATE    DKNHR
N01   * TDS
N01  C     KEYB          CHAIN     SVIH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     SVIH_SYST     IFEQ      'A'
N01  C     SVIH_SYST     OREQ      'B'
N01  C     SVIH_SYST     OREQ      'E'
N01  C                   MOVE      'E'           SVIH_SYST
N01  C                   ENDIF
N01  C                   UPDATE    SVIHR
N01  C                   ENDIF
N01  C     KEYB          CHAIN     SVEH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     SVEH_SYST     IFEQ      'A'
N01  C     SVEH_SYST     OREQ      'B'
N01  C     SVEH_SYST     OREQ      'E'
N01  C                   MOVE      'E'           SVEH_SYST
N01  C                   ENDIF
N01  C                   UPDATE    SVEHR
N01  C                   ENDIF
N01   *
N01  C     KEYB          CHAIN     SVXH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     SV_THST       IFEQ      'A'
N01  C     SV_THST       OREQ      'B'
N01  C     SV_THST       OREQ      'E'
N01  C                   MOVE      'E'           SV_THST
N01  C                   ENDIF
N01  C                   UPDATE    SVXHR
N01  C                   ENDIF
N01   *
N01  C                   MOVEL     M0068         SV_TGGNR
N01  C     SV_TGGNR      CHAIN     SVXGH                              52
N01  C     *IN52         IFEQ      '0'
N01  C     SV_TGST       IFEQ      'A'
N01  C     SV_TGST       OREQ      'B'
N01  C     SV_TGST       OREQ      'E'
N01  C                   MOVE      'P'           SV_TGST
N01  C                   ENDIF
N01  C                   UPDATE    SVXGHR
N01  C                   ENDIF
N01   *
N01  C     KEYB          CHAIN     SVNH                               52
N01  C     *IN52         IFEQ      '0'
N01  C     SV_TIST       IFEQ      'A'
N01  C     SV_TIST       OREQ      'B'
N01  C     SV_TIST       OREQ      'E'
N01  C     SV_TIMF       IFEQ      '007'
N01  C                   MOVE      'C'           SV_TIST
N01  C                   ELSE
N01  C                   MOVE      'L'           SV_TIST
N01  C                   ENDIF
N01  C                   ENDIF
N01  C                   UPDATE    SVNHR
N01  C                   ENDIF
     C                   ENDIF
      *
     C                   ENDIF
     C     KEYA          READE     EDIM6                                  51
     C  N51              ENDDO
     C                   ENDIF
      * SKRIV POST TIL DETALJ LOGG
     C                   CLEAR                   EDISSR
     C                   Z-ADD     SSN           SSSN
     C                   MOVEL     WDATO         SSDT
     C                   MOVEL     WTID          SSTM
     C                   MOVEL     SST           SSST
     C                   EVAL      SSTEXT='Error, unsuccessfull'
     C                   WRITE     EDISSR
     C                   ENDSR
