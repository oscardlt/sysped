********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10038 * 01 CB  PTF10 Extra for SEND EXTENDED PASV
10018 * 02 CB  PTF10 Send direkte fra IFS
10XXX * 03 YBC PTF10 SENDE BINÆRT PÅ VEDLEGG
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 04 YBC PTF11 MOTTAKS FILNAVN = S0020+MBR+SIFS VED SIFS=.xml
********************************************************************
     FEDII      IF   E           K DISK
N02  FEDIS      IF   E           K DISK
S02  F*DI07CAR  O  A F   80        DISK
N02  FEDI07CAR  O  A F  512        DISK
N02  D A               S              1    DIM(256)
N02  C     *LIKE         DEFINE    SSN           WSSN
N02  C     *LIKE         DEFINE    SIFS          WSIFS
      * INPUT PARAMETER
     C     *ENTRY        PLIST
     C                   PARM                    LIB              10
     C                   PARM                    FILE             10
     C                   PARM                    MBR              10
     C                   PARM                    IID              35
     C                   PARM                    INTCHN
N02  C                   PARM                    WSSN
     C     IID           CHAIN     EDII                               20
N02  C     WSSN          CHAIN     EDIS                               20
      * USERID AND PASSWORD RECORD
S02  C*                  MOVEL(P)  INTCUS        DATA             80
N02  C                   MOVEL(P)  INTCUS        DATA            512
     C                   CAT       INTCPW:1      DATA
     C                   EXCEPT    AWRK
      * sendpasv 0
N01  C                   SELECT
N01  C     INSPASV       WHENEQ    'Y'
N01  C     INSPASV       OREQ      'J'
     C                   MOVEL(P)  'sendpasv 0'  DATA
     C                   EXCEPT    AWRK
N01  C     INSPASV       WHENEQ    'X'
N01  C                   MOVEL(P)  'sendepsv 0'  DATA
N01  C                   EXCEPT    AWRK
N01  C                   ENDSL
      * NAMEFMT
     C                   MOVEL(P)  'NAMEFMT 1'   DATA
     C                   EXCEPT    AWRK
N02   * EBCDIC eller IFS ?
N02  C                   IF        FILE='*IFS'
N02  C                   EXSR      IFS
N02  C                   ELSE
N02  C                   EXSR      EBCDIC
N02  C                   ENDIF
S02   * PUT
S02  C*                  MOVEL(P)  'PUT'         DATA
S02  C*                  CAT       '/':1         DATA
S02  C*                  CAT       LIB:0         DATA
S02  C*                  CAT       '/':0         DATA
S02  C*                  CAT       FILE:0        DATA
S02  C*                  CAT       '/':0         DATA
S02  C*                  CAT       MBR:0         DATA
S02   *
S02  C*                  CAT       INTCRDT:1     DATA
S02  C*                  CAT       '/':0         DATA
S02  C*                  CAT       MBR:0         DATA
S02  C*                  EXCEPT    AWRK
S02   * RENAME
S02  C*                  MOVEL(P)  'rename'      DATA
S02  C*                  CAT       INTCRDT:1     DATA
S02  C*                  CAT       '/':0         DATA
S02  C*                  CAT       MBR:0         DATA
S02  C*                  CAT       INTCRD:1      DATA
S02  C*                  CAT       '/':0         DATA
S02  C*                  CAT       MBR:0         DATA
S02  C*                  EXCEPT    AWRK
      * QUIT COMMAND RECORD
     C                   MOVEL(P)  'quit'        DATA
     C                   EXCEPT    AWRK
     C                   MOVE      '1'           *INLR
N02   *////////////////////////////////////////////////////////////
N02   *  EBCDIC                                            EBCDIC /
N02   *////////////////////////////////////////////////////////////
N02  C     EBCDIC        BEGSR
N02   * PUT
N02  C                   MOVEL(P)  'PUT'         DATA
N02  C                   CAT       '/':1         DATA
N02  C                   CAT       LIB:0         DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       FILE:0        DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       MBR:0         DATA
N02   *
N02  C                   CAT       INTCRDT:1     DATA
N02  C                   CAT       '/':0         DATA
N04  C                   IF        SIFS = '.xml'
N04  C                   CAT       S0020:0       DATA
N04  C                   END
N02  C                   CAT       MBR:0         DATA
N02  C                   CAT       SIFS:0        DATA
N02  C                   EXCEPT    AWRK
N02   * RENAME
N02  C                   MOVEL(P)  'rename'      DATA
N02  C                   CAT       INTCRDT:1     DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       MBR:0         DATA
N02  C                   CAT       SIFS:0        DATA
N02  C                   CAT       INTCRD:1      DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       MBR:0         DATA
N02  C                   CAT       SIFS:0        DATA
N02  C                   EXCEPT    AWRK
N02  C                   ENDSR
N02   *////////////////////////////////////////////////////////////
N02   *  IFS                                                  IFS /
N02   *////////////////////////////////////////////////////////////
N02  C     IFS           BEGSR
N03   * BIN
N03  C     INBIN         IFEQ      'Y'
N03  C     INBIN         OREQ      'J'
N03  C                   MOVEL(P)  'bin'         DATA
N03  C                   EXCEPT    AWRK
N03  C                   ENDIF
N02   * Finn filnavnet gjennom å finne siste skråstreken, alt bak den er filnavnet
N02  C                   EVAL      *IN21=*OFF
N02  C                   MOVEA     *BLANKS       A
N02  C                   MOVEA     SIFS          A
N02  C     1             DO        255           WX                3 0
N02  C     256           SUB       WX            WY                3 0
N02  C     A(WY)         IFEQ      '/'
N02  C                   LEAVE
N02  C                   ENDIF
N02  C                   ENDDO
N02  C                   ADD       1             WY
N02  C                   MOVEA     A(WY)         WSIFS
N02   * PUT
N02  C                   MOVEL(P)  'PUT'         DATA
N02  C                   CAT       SIFS:1        DATA
N02
N02  C                   CAT       INTCRDT:1     DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       WSIFS:0       DATA
N02  C                   EXCEPT    AWRK
N02   * RENAME
N02  C                   MOVEL(P)  'rename'      DATA
N02  C                   CAT       INTCRDT:1     DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       WSIFS:0       DATA
N02  C                   CAT       INTCRD:1      DATA
N02  C                   CAT       '/':0         DATA
N02  C                   CAT       WSIFS:0       DATA
N02  C                   EXCEPT    AWRK
N02  C                   ENDSR
     OEDI07CAR  EADD         AWRK
S02  O*                      DATA                80
N02  O                       DATA               512
