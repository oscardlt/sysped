     H DFTACTGRP(*NO)
     FWRKINV    O  A E             DISK
     d WhereC          s            512a
     d FirstW          s              1A
     d cQuote          c                   const('''')
     d SqlStm          s            512a
     d myrows          s             10i 0
     d X               S             10  0
     d MyPoDS          ds                  Qualified  dim(500)
     d  SIAVD                         4S 0
     d  SITDN                         7S 0
     d  SIFIF                        17
     d  SIFID                         8S 0
     ‚*  Prototype for tnoi000r2a
     d tnoi000r2a      pr
     d usrspcname_                         like(usrspcname)
     d winvno_                             like(winvno)
     ‚*  *ENTRY Interface for Main Procedure
     d tnoi000r2a      pi
     d usrspcname                    10
     d winvno                        17

         exsr SelSr;

         if myrows > 0;
           exsr LesSr;
         endif;

         *inlr = *on;
       //-----------------------------------------------------------------
       // Select fra fil via SQL
       //-----------------------------------------------------------------
       begsr     SelSr;

         Exsr  AddAnd;
         Eval  WhereC =  %trim(WhereC)  +
         ' SIFID  <> ' + cQuote + '99999999' + cQuote;

         Exsr  AddAnd;
         Eval  WhereC =  %trim(WhereC)  +
         ' SIFIF  <> ' + cQuote + 'F15  ER  BENYTTET' + cQuote;

         Exsr  AddAnd;
         Eval  WhereC =  %trim(WhereC)  +
         ' UPPER(SIFIF) LIKE UPPER(' + cQuote + '%' +
         %trim(WINVNO) + '%' + cQuote + ')';

         Eval      WhereC =  ' Where ' + %trim(WhereC);

         Eval       SqlStm = 'Select SIAVD, SITDN, SIFIF, SIFID ' +
                             'from SADH ' +
                              %trim(WhereC)  +
                             ' Order by '       +
                             'SIFIF ' +
                             'FOR READ ONLY ';
         Exec SQL PREPARE DynSel from :SqlStm;
         EXEC SQL DECLARE  A33  cursor for DynSel;
         Exec SQL OPEN A33;
         Myrows = %elem(MyPoDS);
         exec sql FETCH A33   for :MyRows rows
                  INTO :MyPoDs;
         Exec SQL CLOSE A33;
       endsr;
       //-----------------------------------------------------------------
       // Set inn "AND" mellom where settninger
       //-----------------------------------------------------------------
       begsr     AddAnd;
       If        FirstW =   'N';
         WhereC =  %trim(WhereC) + ' and ';
       EndIf;
         FirstW =   'N';
       endsr;
        // __________________________________________________
        // Læs array                                    LESSR
        // """"""""""""""""""""""""""""""""""""""""""""""""""
           begsr LesSr;

       for x = 1 to myrows;

         if mypods(x).sifif <> *blanks;
           clear wrkinvr;
                  WRKSPCN=usrspcname;
                  WRKAVD=mypods(x).siavd;
                  WRKTDN=mypods(x).sitdn;
                  WRKSIF=mypods(x).sifif;
           write wrkinvr;
         endif;

       endfor;

       endsr;
