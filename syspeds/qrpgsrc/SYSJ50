********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11011 * 02 YBC PTF11 SKILLE IMPORT OR EKSPORT
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE BOOKING                         ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01 06 08 10 13 16 17 19-26             ***
      *** LEDIGE INDIKATORER 27 31 32 34 36-50 57-66                ***
      *****************************************************************
      *
     FBOOKING   UF A E           K DISK
     FBLV1LF    UF A E           K DISK
     FMULTKODT  IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FCDLAST    IF   E           K DISK
     FCDTRAF    IF   E           K DISK
     FCDTRAFL2  IF   E           K DISK
     F                                     RENAME(CDTRAFR:CDTRAF2R)
     FFIRM      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FTELL      UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTRAN      IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FFRATXT    IF   E           K DISK
     FFREETXT   IF   E           K DISK
     FSYSJ50FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D SOR             S              3  0 DIM(4)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  BONT1                  1      7  0
     D  BONT2                  8     14  0
     D  BONT3                 15     21  0
     D  BONT4                 22     28  0
     D  NT                     1     28  0
     D                                     DIM(4)
     D                 DS
     D  BOKDC1                 1      2
     D  BOKDC2                 3      4
     D  BOKDC3                 5      6
     D  BOKDC4                 7      8
     D  KC                     1      8
     D                                     DIM(4)
     D                 DS
     D  BOMN1                  1     20
     D  BOMN2                 21     40
     D  BOMN3                 41     60
     D  BOMN4                 61     80
     D  MN                     1     80
     D                                     DIM(4)
     D                 DS
     D  BOVS1                  1     25
     D  BOVS2                 26     50
     D  BOVS3                 51     75
     D  BOVS4                 76    100
     D  VS                     1    100
     D                                     DIM(4)
     D                 DS
     D  BOVKT1                 1      9  0
     D  BOVKT2                10     18  0
     D  BOVKT3                19     27  0
     D  BOVKT4                28     36  0
     D  VK                     1     36  0
     D                                     DIM(4)
     D                 DS
     D  BOM31                  1      7  3
     D  BOM32                  8     14  3
     D  BOM33                 15     21  3
     D  BOM34                 22     28  3
     D  M3                     1     28  3
     D                                     DIM(4)
     D                 DS
     D  WSDP                   1     20
     D  WSDP1                  1      1
     D  WSDP2                  2     20
     D                 DS
     D  BODTRÅ                 1      4  0
     D  BODTRM                 5      6  0
     D  BODTRD                 7      8  0
     D  BODTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  WSDTD1                 1      2  0
     D  WSDTM1                 3      4  0
     D  WSDTÅ1                 5      6  0
     D  WSDT1                  1      6  0
     D                 DS
     D  BODTÅ1                 1      4  0
     D  BODTM1                 5      6  0
     D  BODTD1                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
     D                 DS
     D  BODTÅ2                 1      4  0
     D  BODTM2                 5      6  0
     D  BODTD2                 7      8  0
     D  BODT2                  1      8  0
     D                 DS
     D  WSDTD3                 1      2  0
     D  WSDTM3                 3      4  0
     D  WSDTÅ3                 5      6  0
     D  WSDT3                  1      6  0
     D                 DS
     D  BODTÅ3                 1      4  0
     D  BODTM3                 5      6  0
     D  BODTD3                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  WSDTD4                 1      2  0
     D  WSDTM4                 3      4  0
     D  WSDTÅ4                 5      6  0
     D  WSDT4                  1      6  0
     D                 DS
     D  BODTÅ4                 1      4  0
     D  BODTM4                 5      6  0
     D  BODTD4                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  WSDTD5                 1      2  0
     D  WSDTM5                 3      4  0
     D  WSDTÅ5                 5      6  0
     D  WSDT5                  1      6  0
     D                 DS
     D  BODTÅ5                 1      4  0
     D  BODTM5                 5      6  0
     D  BODTD5                 7      8  0
     D  BODT5                  1      8  0
     D                 DS
     D  WSDTD6                 1      2  0
     D  WSDTM6                 3      4  0
     D  WSDTÅ6                 5      6  0
     D  WSDT6                  1      6  0
     D                 DS
     D  BODTÅ6                 1      4  0
     D  BODTM6                 5      6  0
     D  BODTD6                 7      8  0
     D  BODT6                  1      8  0
     D                 DS
     D  WSDTD7                 1      2  0
     D  WSDTM7                 3      4  0
     D  WSDTÅ7                 5      6  0
     D  WSDT7                  1      6  0
     D                 DS
     D  BODTÅ7                 1      4  0
     D  BODTM7                 5      6  0
     D  BODTD7                 7      8  0
     D  BODT7                  1      8  0
     D                 DS
     D  WSDTD8                 1      2  0
     D  WSDTM8                 3      4  0
     D  WSDTÅ8                 5      6  0
     D  WSDT8                  1      6  0
     D                 DS
     D  BODTÅ8                 1      4  0
     D  BODTM8                 5      6  0
     D  BODTD8                 7      8  0
     D  BODT8                  1      8  0
     D                 DS
     D  WSDTD9                 1      2  0
     D  WSDTM9                 3      4  0
     D  WSDTÅ9                 5      6  0
     D  WSDT9                  1      6  0
     D                 DS
     D  BODTÅ9                 1      4  0
     D  BODTM9                 5      6  0
     D  BODTD9                 7      8  0
     D  BODT9                  1      8  0
     D SAVUDS         UDS
     D  UFIRM                  1      2
     C*
     C                   EXSR      INIT
     C                   GOTO      START0
     C*
     C     START         TAG
     C  N30              DO
     C                   MOVE      BOOPD         WSOPDG
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        WSPRO
     C                   MOVE      *ZEROS        BOAVD
     C                   MOVE      *ZEROS        BOOPD
     C                   END
     C                   EXFMT     BILDE01
     C                   SETOFF                                       30
     C                   MOVEA     '00000'       *IN(95)
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSOPD         UOPD
     C                   MOVE      WSSG          USG
     C                   OUT       SAVUDS
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   CALL      'SYSJ52'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C     WSAVD         IFEQ      0
     C     WSOPD         OREQ      0
     C                   GOTO      START
     C                   END
     C                   END
     C*
     C     START0        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      SLUTT
     C*
     C     START1        TAG
     C                   EXSR      TSTOPL
     C  N30
     CANN04
     CANN14              Z-ADD     1             LINNBR
     C  N30
     CANN04
     CANN14              Z-ADD     55            POSNBR
     C     ST11          TAG
     C*
     C*** TEST OM DET ER OPPLYSNINGER TIL OPPDRAG
     C     FREETK        SETLL     FREETXT
     C     FREETK        READE     FREETXT                                29
     C     *IN35         IFEQ      '0'
     C                   EXSR      SJKMOD
     C                   END
     C*
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE02
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000'       *IN(71)
     C                   MOVEA     '0000'        *IN(67)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   02              DO
     C     *IN35         IFEQ      '1'
     C                   MOVE      '0'           *IN35
     C                   ELSE
     C                   MOVE      '1'           *IN35
     C                   END
     C                   GOTO      ST11
     C                   END
     C   04              DO
     C                   EXSR      SØKDTA
     C   30              GOTO      START1
     C     UFLAGG        IFEQ      1
     C                   GOTO      START1
     C                   END
     C                   END
      *
     C   12              DO
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              MOVE      ' '           BOST
     C  N33              UPDATE    BOOKINGR
     C                   GOTO      SLUTT
     C                   END
      *
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START1
     C                   END
      *
      * FRI SØKEVEI
     C   15              DO
     C     WSOPD         IFEQ      *ZEROS
     C                   MOVE      'SHU0126'     MSGNR
     C                   SETON                                        30
     C                   GOTO      ST11
     C                   END
     C                   MOVE      *ZEROS        OTIKU1            8 0
     C                   MOVE      *ZEROS        OTIKU2            8 0
     C                   CALL      'SYFA64'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    OTIKU1
     C                   PARM                    OTIKU2
     C                   GOTO      ST11
     C                   END
     C* FREETEXT
     C   18              DO
     C     WSOPD         IFEQ      *ZEROS
     C                   MOVE      'SPO0106'     MSGNR
     C                   SETON                                        30
     C                   GOTO      ST11
     C                   END
     C                   EXSR      VISFRE
     C                   GOTO      ST11
     C                   END
     C*
     C                   EXSR      TESTB2
     C   30              GOTO      START1
      *
     C   07              DO
     C     START2        TAG
     C  N04
     CANN30              Z-ADD     2             LINNBR
     C  N04
     CANN30              Z-ADD     11            POSNBR
     C                   EXSR      KDTFM2
     C                   EXFMT     BILDE03
     C                   EXSR      KDTFM2
     C                   MOVEA     '000'         *IN(78)
     C                   MOVE      '0'           *IN30
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      START2
     C                   END
     C   15              DO
     C                   CALL      'SYFA64'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   GOTO      START2
     C                   END
     C   18              DO
     C                   EXSR      VISFRE
     C                   GOTO      START2
     C                   END
     C                   EXSR      TESTB3
     C   30              GOTO      START2
     C                   END
      *
     C                   EXSR      OPDBK
     C   05              DO
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'SYSJ50A'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      3
     C                   CALL      'SYSJ50B'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      START1
     C                   END
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              MOVE      ' '           BOST
     C  N33              UPDATE    BOOKINGR
     C*                    SETON                     03
     C                   GOTO      SLUTT
     C                   ELSE
     C                   GOTO      START1
     C                   END
     C                   END
      *
     C   10
     COR 11              EXSR      TILV
      *
     C  N03              GOTO      START1
     C*
     C   03              DO
     C                   CALL      'SYSJ50B'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      START1
     C                   END
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              MOVE      ' '           BOST
     C  N33              UPDATE    BOOKINGR
     C                   GOTO      SLUTT
     C                   END
     C*
     C*
     C     SLUTT         TAG
     C                   MOVE      WSOPD         UOPD
     C                   OUT       SAVUDS
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SJKMOD        BEGSR
     C***********************************************
     C     WSANM         COMP      *BLANKS                            3535
     C  N35WSREF1        COMP      *BLANKS                            3535
     C  N35WSANMN        COMP      *BLANKS                            3535
     C  N35WSDT2         COMP      0                                  3535
     C  N35WSCH          COMP      *BLANKS                            3535
     C  N35WSKNRP        COMP      0                                  3535
     C  N35WSNARP        COMP      *BLANKS                            3535
     C  N35WSMH          COMP      *BLANKS                            3535
     C  N35WSINS2        COMP      *BLANKS                            3535
     C  N35WSDP          COMP      *BLANKS                            3535
     C  N35WSDT5         COMP      0                                  3535
     C  N35WSREF3        COMP      *BLANKS                            3535
     C  N35WSINS3        COMP      *BLANKS                            3535
     C   35
     CAN 02              DO
     C                   MOVE      'JOV0804'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSOPD         IFGT      0                                            1<-B
     C     BOOPD         IFGT      0                                             2<-B
     C     BOAVD         ORGT      0
     C                   MOVE      'SPO0015'     MSGNR
     C                   SETON                                        3097
     C                   GOTO      SLT1
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     BOOPD         COMP      0                                  28
     C  N28BOAVD         COMP      0                                  28
     C*
     C*** TEST AVDELING
     C     KODTAK        CHAIN     KOAR                               98
     C  N98KODTVK        CHAIN     KOVR                               98
     C  N98              DO
     C     WSAVD         CHAIN     TELL                               98
     C   98XAVD0         CHAIN     TELL                               98
     C  N98              UPDATE    TELLR
     C                   END
     C   98              MOVE      'SPA0006'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLT1
     C*
     C*** TEST OPPDRAGSNR
     C  N28              DO                                                     1<-B
     C     WSOPD         COMP      *ZEROS                                 33
     C  N33BOOKK         CHAIN     BOOKING                            97
     C   97              MOVE      'SPO0002'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLT1
     C  N33
     CANN09WSSG          IFNE      BOSG
     C                   MOVE      BOSG          WSSG
     C                   MOVE      'YBC0036'     MSGNR
     C                   END
     C  N33
     CANN99BOST          IFNE      ' '
     C     BOST          COMP      'P'                                9797
     C                   END
     C   97              MOVE      'SPO0006'     MSGNR
     C   99              MOVE      'SPS0014'     MSGNR
     C   97
     COR 99              SETON                                        30
     C   30              UPDATE    BOOKINGR
     C   30              MOVE      *ZEROS        BOAVD
     C   30              MOVE      *ZEROS        BOOPD
     C   97
     COR 99              GOTO      SLT1
     C                   END                                                    1<-E
     C*
     C*** TEST AVDELING+OPPDRAGSNR FOR KOPIERING
     C   28              DO                                                     1<-B
     C     BOOKK2        CHAIN     BOOKING                            33
     C   33              SETON                                        9630
     C   96              MOVE      'SPA0007'     MSGNR
     C  N33              UPDATE    BOOKINGR
     C   96              GOTO      SLT1
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *ZEROS        WSPRO
     C     UFLAGG        IFEQ      0                                             2<-B
     C                   MOVE      BOAVD         WSAVDK            4 0
     C                   MOVE      BOOPD         WSOPDK            7 0
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C  N33
     CANN28              DO                                                     1<-B
     C                   MOVE      'X'           BOST
     C   09              MOVE      WSSG          BOSG
     C                   UPDATE    BOOKINGR
     C                   END                                                    1<-E
     C*
     C     WSOPD         IFEQ      0                                            1<-B
     C   28              EXSR      MOVBOW
     C  N28              EXSR      MOVB1
     C                   ELSE                                                   1
     C                   EXSR      MOVBOW
     C                   END                                                    1<-E
     C*
     C     SLT1          ENDSR
     C*
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C                   MOVE      'DIV0000'     MSGNR
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      USG           WSSG
     C                   ELSE
     C     KODSFK        CHAIN     KOSFR                              33
     C   33              MOVE      USG           WSSG
     C                   END
     C     WSUKE         COMP      1                                    99
     C  N99WSUKE         COMP      53                                 99
     C   99              MOVE      'SPU0101'     MSGNR
     C   99              SETON                                        30
     C*
     C*** TEST REDERINR.
     C     WSKNR         IFEQ      *ZEROS
     C     WSTR          ANDNE     *BLANKS
     C     CDTRK2        CHAIN     CDTRAFL2                           97
     C  N97              MOVE      CTKN          WSKNR
     C                   END
     C     WSKNR         IFNE      0
     C                   MOVE      WSKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C   98
     CANN30              MOVE      'SPK0121'     MSGNR
     C   98
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST TRAFIKK
     C     WSTR          IFNE      *BLANKS
     C     CDTRK         CHAIN     CDTRAF                             97
     C  N97CTAKT         COMP      'I'                                    97
     C   97
     CANN30              MOVE      'SPT0102'     MSGNR
     C   97
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST AVSENDER.
     C     WSKNA         IFNE      0
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            96
     C  N96              MOVEL     KNAVN         WSNAA
     C                   END
     C  N96WSNAA         COMP      *BLANKS                                96
     C   96
     CANN30              MOVE      'SPK0037'     MSGNR
     C   96
     CANN30              SETON                                        30
     C*
     C*** TEST SPEDITØR.
     C     WSKNS         IFNE      0
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            95
     C  N95              MOVEL     KNAVN         WSNAS
     C   95
     CANN30              MOVE      'SPK0122'     MSGNR
     C   95
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LOKAL BÅT
     C     WSLB          IFNE      *BLANKS
     C     WSLB          CHAIN     CDBOAT                             94
     C  N94              MOVEL     CBNAB         WSLBN
     C   94
     CANN30              MOVE      'SPB0102'     MSGNR
     C   94
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LASTEHAVN
     C     WSLSH         IFNE      *BLANKS
     C     WSLSH         CHAIN     STED2                              92
     C  N92              MOVEL     ST2NVN        WSLSHN
     C   92
     CANN30              MOVE      'SPS0102'     MSGNR
     C   92
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST AVGANGSDATO
     C                   MOVE      WSDTÅ1        UÅÅ               2 0
     C                   MOVE      WSDTM1        UMM               2 0
     C                   MOVE      WSDTD1        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      91
     C   91
     CANN30              MOVE      'SPD0001'     MSGNR
     C   91
     CANN30              SETON                                        30
     C*
     C*** TEST VALUTAKODE TIL RATE LOKAL BÅT
     C     WSBLL         IFNE      0
     C     WSVALL        ORNE      *BLANKS
     C                   MOVE      WSVALL        VALKOD
     C     VALU1K        CHAIN     VALUL01                            77
     C   77
     CANN30              MOVE      'SPV0001'     MSGNR
     C   77
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO AV ANMELDELSE
     C     WSDT2         IFNE      0
     C                   MOVE      WSDTÅ2        UÅÅ               2 0
     C                   MOVE      WSDTM2        UMM               2 0
     C                   MOVE      WSDTD2        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      90
     C   90
     CANN30              MOVE      'SPD0001'     MSGNR
     C   90
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LASTETYPE
     C     WSLSTY        IFNE      *BLANKS
     C     WSLSTY        CHAIN     CDLAST                             84
     C   84
     CANN30              MOVE      'SPL0104'     MSGNR
     C   84
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LOSSEHAVN (LOKALBÅT)
     C     WSVHL         IFNE      *BLANKS
     C     WSVHL         CHAIN     STED2                              70
     C  N70WSVH          IFEQ      *BLANKS
     C                   MOVE      WSVHL         WSVH
     C                   END
     C   70
     CANN30              MOVE      'YBC0699'     MSGNR
     C   70
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST ANKOMSTDATO TIL LOKALBÅT
     C     WSDT7         IFNE      0
     C                   MOVE      WSDTÅ7        UÅÅ               2 0
     C                   MOVE      WSDTM7        UMM               2 0
     C                   MOVE      WSDTD7        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      69
     C   69
     CANN30              MOVE      'SPD0001'     MSGNR
     C   69
     CANN30              SETON                                        30
     C  N69WSDT3         IFEQ      0
     C                   MOVE      WSDT7         WSDT3
     C                   END
     C                   END
     C*
     C*** TEST OVERSJØBÅT
     C     WSOB          IFNE      *BLANKS
     C     WSOB          CHAIN     CDBOAT                             88
     C  N88              MOVEL     CBNAB         WSOBN
     C   88
     CANN30              MOVE      'SPB0103'     MSGNR
     C   88
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST VIA HAVN
     C     WSVH          IFNE      *BLANKS
     C     WSVH          CHAIN     STED2                              89
     C  N89              MOVEL     ST2NVN        WSVHN
     C  N89WSVHL         IFEQ      *BLANKS
     C                   MOVE      WSVH          WSVHL
     C                   END
     C   89
     CANN30              MOVE      'SPS0103'     MSGNR
     C   89
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST VIAHAVN-2
     C     WSVH2         IFNE      *BLANKS
     C     WSVH2         CHAIN     STED2                              68
     C   68
     CANN30              MOVE      'YBC0700'     MSGNR
     C   68
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST ANKOMSTDATO TIL OVERSJØBÅT
     C     WSDT8         IFNE      0
     C                   MOVE      WSDTÅ8        UÅÅ               2 0
     C                   MOVE      WSDTM8        UMM               2 0
     C                   MOVE      WSDTD8        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      67
     C   67
     CANN30              MOVE      'SPD0001'     MSGNR
     C   67
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST AVGANGSDATO TIL OVERSJØBÅT
     C     WSDT3         IFNE      0
     C                   MOVE      WSDTÅ3        UÅÅ               2 0
     C                   MOVE      WSDTM3        UMM               2 0
     C                   MOVE      WSDTD3        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      87
     C   87
     CANN30              MOVE      'SPD0001'     MSGNR
     C   87
     CANN30              SETON                                        30
     C  N87WSDT7         IFEQ      0
     C                   MOVE      WSDT3         WSDT7
     C                   END
     C                   END
     C*
     C*** TEST LOSSEHAVN
     C     WSLOH         IFNE      *BLANKS
     C     WSLOH         CHAIN     STED2                              86
     C  N86              MOVEL     ST2NVN        WSLOHN
     C   86
     CANN30              MOVE      'SPS0104'     MSGNR
     C   86
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LOSSESTED
     C     WSLOS         IFNE      *BLANKS
     C     WSLOS         CHAIN     STED2                              85
     C  N85              MOVEL     ST2NVN        WSLOSN
     C   85
     CANN30              MOVE      'SPS0105'     MSGNR
     C   85
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST ROUTING PARTY
     C     WSKNRP        IFNE      0
     C                   MOVE      WSKNRP        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            93
     C  N93              MOVEL     KNAVN         WSNARP
     C   93
     CANN30              MOVE      'SPK0125'     MSGNR
     C   93
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DELIVERY AGENT
     C     WSKNDA        IFNE      0
     C                   MOVE      WSKNDA        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            75
     C  N75              MOVEL     KNAVN         WSNADA
     C   75
     CANN30              MOVE      'SPK0136'     MSGNR
     C   75
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST CONTAINERKODER
     C     WSKDC1        IFNE      *BLANKS
     C     WSKDC1        CHAIN     CDCON4                             74
     C   74
     CANN30              MOVE      'SPK0131'     MSGNR
     C   74
     CANN30              SETON                                        30
     C                   END
     C     WSKDC2        IFNE      *BLANKS
     C     WSKDC2        CHAIN     CDCON4                             73
     C   73
     CANN30              MOVE      'SPK0131'     MSGNR
     C   73
     CANN30              SETON                                        30
     C                   END
     C     WSKDC3        IFNE      *BLANKS
     C     WSKDC3        CHAIN     CDCON4                             72
     C   72
     CANN30              MOVE      'SPK0131'     MSGNR
     C   72
     CANN30              SETON                                        30
     C                   END
     C     WSKDC4        IFNE      *BLANKS
     C     WSKDC4        CHAIN     CDCON4                             71
     C   71
     CANN30              MOVE      'SPK0131'     MSGNR
     C   71
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST LASTESTED
     C     WSLSS         IFNE      *BLANKS
     C     WSLSS         CHAIN     STED2                              83
     C  N83              MOVEL     ST2NVN        WSLSSN
     C   83
     CANN30              MOVE      'SPS0106'     MSGNR
     C   83
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO TIL LASTESTED
     C     WSDT4         IFNE      0
     C                   MOVE      WSDTÅ4        UÅÅ               2 0
     C                   MOVE      WSDTM4        UMM               2 0
     C                   MOVE      WSDTD4        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      82
     C   82
     CANN30              MOVE      'SPD0001'     MSGNR
     C   82
     CANN30              SETON                                        30
     C                   END
     C*
     C*** HENTE DEPOT
     C     WSDP2         IFEQ      *BLANKS
     C     KODTEK        CHAIN     KOTMR                              33
     C  N33              MOVEL     KOTMNV        WSDP
     C                   END
     C*
     C*** TEST DATO TIL DEPOT
     C     WSDT5         IFNE      0
     C                   MOVE      WSDTÅ5        UÅÅ               2 0
     C                   MOVE      WSDTM5        UMM               2 0
     C                   MOVE      WSDTD5        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      81
     C   81
     CANN30              MOVE      'SPD0001'     MSGNR
     C   81
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST CC/PP LOKAL
     C                   SELECT
     C     WSCPL         WHENEQ    'C'
     C     WSBLG         COMP      *ZEROS                                 76
     C   76WSBLL         COMP      *ZEROS                                 76
     C   76
     CANN30              MOVE      'JOV1020'     MSGNR
     C   76
     CANN30              SETON                                        30
     C     WSCPL         WHENEQ    'P'
     C     WSBLCP        IFEQ      *ZEROS                                         FRAKT
     C     WSBLG         ANDEQ     *ZEROS                                         GEBYR
     C                   SETON                                        76
     C                   END
     C     WSBLL         IFEQ      *ZEROS                                         RATE
     C                   SETON                                        76
     C                   END
     C   76
     CANN30              MOVE      'JOV1020'     MSGNR
     C   76
     CANN30              SETON                                        30
     C                   OTHER
     C     WSBLCP        IFNE      *ZEROS                                         GEBYR
     C     WSBLG         ORNE      *ZEROS
     C                   SETON                                        76
     C                   END
     C   76
     CANN30              MOVE      'JOV1021'     MSGNR
     C   76
     CANN30              SETON                                        30
     C                   ENDSL
     C   30              EXSR      SETCUR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   81              Z-ADD     48            POSNBR
     C   82              Z-ADD     48            POSNBR
     C   83              Z-ADD     8             POSNBR
     C   71
     COR 72
     COR 73
     COR 74              Z-ADD     11            POSNBR
     C   75              Z-ADD     42            POSNBR
     C   93              Z-ADD     42            POSNBR
     C   85              Z-ADD     54            POSNBR
     C   86              Z-ADD     8             POSNBR
     C   67              Z-ADD     69            POSNBR
     C   68              Z-ADD     57            POSNBR
     C   87              Z-ADD     41            POSNBR
     C   89              Z-ADD     8             POSNBR
     C   88              Z-ADD     54            POSNBR
     C   69              Z-ADD     31            POSNBR
     C   70              Z-ADD     19            POSNBR
     C   84
     COR 90              Z-ADD     75            POSNBR
     C   77              Z-ADD     38            POSNBR
     C   76              Z-ADD     31            POSNBR
     C   91              Z-ADD     75            POSNBR
     C   92              Z-ADD     41            POSNBR
     C   94
     COR 95
     COR 96              Z-ADD     8             POSNBR
     C   97              Z-ADD     77            POSNBR
     C   98              Z-ADD     65            POSNBR
     C   99              Z-ADD     55            POSNBR
     C*
     C   81              Z-ADD     20            LINNBR
     C   82
     COR 83              Z-ADD     18            LINNBR
     C   71              Z-ADD     17            LINNBR
     C   72              Z-ADD     16            LINNBR
     C   73              Z-ADD     15            LINNBR
     C   74              Z-ADD     14            LINNBR
     C   75              Z-ADD     12            LINNBR
     C   93              Z-ADD     11            LINNBR
     C   85              Z-ADD     10            LINNBR
     C   86              Z-ADD     10            LINNBR
     C   87
     COR 67
     COR 68
     COR 89              Z-ADD     9             LINNBR
     C   69
     COR 70
     COR 88              Z-ADD     8             LINNBR
     C   84              Z-ADD     7             LINNBR
     C   90              Z-ADD     6             LINNBR
     C   76              Z-ADD     5             LINNBR
     C   77              Z-ADD     5             LINNBR
     C   91
     COR 92
     COR 94              Z-ADD     4             LINNBR
     C   95              Z-ADD     3             LINNBR
     C   96              Z-ADD     2             LINNBR
     C   97
     COR 98
     COR 99              Z-ADD     1             LINNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
     C*** TEST TRANSPORTØR
     C     WSKNT         IFNE      0
     C     TRANK         CHAIN     TRAN                               80
     C  N80              MOVEL     VMNAVN        WSNAT
     C   80
     CANN30              MOVE      'SPK0122'     MSGNR
     C   80
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST DATO TIL TRANSPORTØR
     C     WSDT6         IFNE      0
     C                   MOVE      WSDTÅ6        UÅÅ               2 0
     C                   MOVE      WSDTM6        UMM               2 0
     C                   MOVE      WSDTD6        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      79
     C   79
     CANN30              MOVE      'SPD0001'     MSGNR
     C   79
     CANN30              SETON                                        30
     C                   END
     C*
     C*** TEST VALUTAKODE
     C     WSBL          IFNE      0
     C     WSVAL         ORNE      *BLANKS
     C                   MOVE      WSVAL         VALKOD
     C     VALU1K        CHAIN     VALUL01                            78
     C   78
     CANN30              MOVE      'SPV0001'     MSGNR
     C   78
     CANN30              SETON                                        30
     C                   END
     C*
     C   30              EXSR      SETCU2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCU2        BEGSR
     C***********************************************
     C   78              Z-ADD     38            POSNBR
     C   79
     COR 80              Z-ADD     11            POSNBR
     C   78              Z-ADD     6             LINNBR
     C   79              Z-ADD     3             LINNBR
     C   80              Z-ADD     2             LINNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '000000'      *IN(51)
     C                   SETOFF                                       33
     C*
     C     WSKNR         IFNE      0
     C                   MOVE      WSKNR         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        51
     C                   END
     C*
     C     WSKNA         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNA         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        52
     C                   END
     C*
     C     WSKNS         IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNS         KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        53
     C                   END
     C*
     C     WSKNRP        IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNRP        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        54
     C                   END
     C*
     C     WSKNDA        IFNE      0
     C                   SETOFF                                       33
     C                   MOVE      WSKNDA        KUNDNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        56
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBOW        BEGSR
     C***********************************************
     C  N28              DO
     C                   MOVE      BOPRO         WSPRO
     C                   MOVE      BODTRD        WSDTRD
     C                   MOVE      BODTRM        WSDTRM
     C                   MOVE      BODTRÅ        WSDTRÅ
     C                   MOVE      BOAVDK        WSAVDK
     C                   MOVE      BOOPDK        WSOPDK
     C                   MOVE      BOLB          WSLB
     C                   MOVE      BOLBN         WSLBN
     C                   MOVE      BOLSH         WSLSH
     C                   MOVE      BOLSHN        WSLSHN
     C                   MOVE      BODTD1        WSDTD1
     C                   MOVE      BODTM1        WSDTM1
     C                   MOVE      BODTÅ1        WSDTÅ1
     C                   MOVE      BOANM         WSANM
     C                   MOVE      BOREF1        WSREF1
     C                   MOVE      BOANMN        WSANMN
     C                   MOVE      BODTD2        WSDTD2
     C                   MOVE      BODTM2        WSDTM2
     C                   MOVE      BODTÅ2        WSDTÅ2
     C                   MOVE      BOINS1        WSINS1
     C                   MOVE      BOOB          WSOB
     C                   MOVE      BOOBN         WSOBN
     C                   MOVE      BODTD3        WSDTD3
     C                   MOVE      BODTM3        WSDTM3
     C                   MOVE      BODTÅ3        WSDTÅ3
     C                   END
     C   28              DO
     C*                    MOVE BOPRO     WSPRO
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UYEAR         WSDTRÅ
     C                   MOVE      *BLANKS       WSLB
     C                   MOVE      *BLANKS       WSLBN
     C                   MOVE      *BLANKS       WSLSH
     C                   MOVE      *BLANKS       WSLSHN
     C                   MOVE      *ZEROS        WSDTD1
     C                   MOVE      *ZEROS        WSDTM1
     C                   MOVE      *ZEROS        WSDTÅ1
     C                   MOVE      *BLANKS       WSANM
     C                   MOVE      *BLANKS       WSREF1
     C                   MOVE      *BLANKS       WSANMN
     C                   MOVE      *ZEROS        WSDTD2
     C                   MOVE      *ZEROS        WSDTM2
     C                   MOVE      *ZEROS        WSDTÅ2
     C                   MOVE      *BLANKS       WSINS1
     C                   MOVE      *BLANKS       WSOB
     C                   MOVE      *BLANKS       WSOBN
     C                   MOVE      *ZEROS        WSDTD3
     C                   MOVE      *ZEROS        WSDTM3
     C                   MOVE      *ZEROS        WSDTÅ3
     C                   END
     C                   MOVE      BOAAR         WSAAR
     C                   MOVE      BOUKE         WSUKE
     C                   MOVE      BOKNR         WSKNR
     C                   MOVE      BOTR          WSTR
     C                   MOVE      BOKNA         WSKNA
     C                   MOVE      BONAA         WSNAA
     C                   MOVE      BOKNAA        WSKNAA
     C                   MOVE      BOKNS         WSKNS
     C                   MOVE      BONAS         WSNAS
     C                   MOVE      BOKNAS        WSKNAS
     C                   MOVE      BOBKNL        WSBKNL
     C                   MOVE      BOCPL         WSCPL
     C                   MOVE      BOVALL        WSVALL
     C                   MOVE      BOBLL         WSBLL
     C                   MOVE      BOBLCP        WSBLCP
     C                   MOVE      BOBLG         WSBLG
     C                   MOVE      BOVHL         WSVHL
     C                   MOVE      BODTD7        WSDTD7
     C                   MOVE      BODTM7        WSDTM7
     C                   MOVE      BODTÅ7        WSDTÅ7
     C                   MOVE      BOVH2         WSVH2
     C                   MOVE      BODTD8        WSDTD8
     C                   MOVE      BODTM8        WSDTM8
     C                   MOVE      BODTÅ8        WSDTÅ8
     C                   MOVE      BOVH          WSVH
     C                   MOVE      BOVHN         WSVHN
     C                   MOVE      BOREIS        WSREIS
     C                   MOVE      BOLOH         WSLOH
     C                   MOVE      BOLOHN        WSLOHN
     C                   MOVE      BODTD9        WSDTD9
     C                   MOVE      BODTM9        WSDTM9
     C                   MOVE      BODTÅ9        WSDTÅ9
     C                   MOVE      BOLOS         WSLOS
     C                   MOVE      BOLOSN        WSLOSN
     C                   MOVE      BOLSTY        WSLSTY
     C                   MOVE      BOKNRP        WSKNRP
     C                   MOVE      BONARP        WSNARP
     C                   MOVE      BOKNDA        WSKNDA
     C                   MOVE      BONADA        WSNADA
     C                   MOVE      BOMM          WSMM
     C                   MOVE      BOREFN        WSREFN
     C                   MOVE      BONT1         WSNT1
     C                   MOVE      BOKDC1        WSKDC1
     C                   MOVE      BOMN1         WSMN1
     C                   MOVE      BOVS1         WSVS1
     C                   MOVE      BOVKT1        WSVKT1
     C                   MOVE      BOM31         WSM31
     C                   MOVE      BONT2         WSNT2
     C                   MOVE      BOKDC2        WSKDC2
     C                   MOVE      BOMN2         WSMN2
     C                   MOVE      BOVS2         WSVS2
     C                   MOVE      BOVKT2        WSVKT2
     C                   MOVE      BOM32         WSM32
     C                   MOVE      BONT3         WSNT3
     C                   MOVE      BOKDC3        WSKDC3
     C                   MOVE      BOMN3         WSMN3
     C                   MOVE      BOVS3         WSVS3
     C                   MOVE      BOVKT3        WSVKT3
     C                   MOVE      BOM33         WSM33
     C                   MOVE      BONT4         WSNT4
     C                   MOVE      BOKDC4        WSKDC4
     C                   MOVE      BOMN4         WSMN4
     C                   MOVE      BOVS4         WSVS4
     C                   MOVE      BOVKT4        WSVKT4
     C                   MOVE      BOM34         WSM34
     C                   MOVE      BOLSS         WSLSS
     C                   MOVE      BOLSSN        WSLSSN
     C                   MOVE      BODTD4        WSDTD4
     C                   MOVE      BODTM4        WSDTM4
     C                   MOVE      BODTÅ4        WSDTÅ4
     C                   MOVE      BOREF2        WSREF2
     C                   MOVE      BOINS2        WSINS2
     C                   MOVE      BODP          WSDP
     C                   MOVE      BODTD5        WSDTD5
     C                   MOVE      BODTM5        WSDTM5
     C                   MOVE      BODTÅ5        WSDTÅ5
     C                   MOVE      BOREF3        WSREF3
     C                   MOVE      BOINS3        WSINS3
     C                   MOVE      BOKNT         WSKNT
     C                   MOVE      BONAT         WSNAT
     C                   MOVE      BODTD6        WSDTD6
     C                   MOVE      BODTM6        WSDTM6
     C                   MOVE      BODTÅ6        WSDTÅ6
     C                   MOVE      BOREF4        WSREF4
     C                   MOVE      BOINS4        WSINS4
     C                   MOVE      BOCH          WSCH
     C                   MOVE      BOMH          WSMH
     C                   MOVE      BORATE        WSRATE
     C                   MOVE      BOVAL         WSVAL
     C                   MOVE      BOBL          WSBL
     C                   MOVE      BOCP          WSCP
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UYEAR         WSDTRÅ
     C                   MOVE      *ZEROS        WSAVDK
     C                   MOVE      *ZEROS        WSOPDK
     C                   MOVE      UYEAR         WSAAR
     C                   MOVE      *ZEROS        WSUKE
     C                   MOVE      *ZEROS        WSKNR
     C                   MOVE      *BLANKS       WSTR
     C                   MOVE      *ZEROS        WSKNA
     C                   MOVE      *BLANKS       WSNAA
     C                   MOVE      *BLANKS       WSKNAA
     C                   MOVE      *ZEROS        WSKNS
     C                   MOVE      *BLANKS       WSNAS
     C                   MOVE      *BLANKS       WSKNAS
     C                   MOVE      *BLANKS       WSLB
     C                   MOVE      *BLANKS       WSLBN
     C                   MOVE      *BLANKS       WSLSH
     C                   MOVE      *BLANKS       WSLSHN
     C                   MOVE      *ZEROS        WSDT1
     C                   MOVE      *BLANKS       WSANM
     C                   MOVE      *BLANKS       WSREF1
     C                   MOVE      *BLANKS       WSANMN
     C                   MOVE      *ZEROS        WSDT2
     C                   MOVE      *BLANKS       WSINS1
     C                   MOVE      *BLANKS       WSBKNL
     C                   MOVE      *BLANKS       WSCPL
     C                   MOVE      *BLANKS       WSVALL
     C                   MOVE      *ZEROS        WSBLL
     C                   MOVE      *ZEROS        WSBLCP
     C                   MOVE      *ZEROS        WSBLG
     C                   MOVE      *BLANKS       WSVHL
     C                   MOVE      *ZEROS        WSDT7
     C                   MOVE      *BLANKS       WSVH2
     C                   MOVE      *ZEROS        WSDT8
     C                   MOVE      *BLANKS       WSVH
     C                   MOVE      *BLANKS       WSVHN
     C                   MOVE      *BLANKS       WSOB
     C                   MOVE      *BLANKS       WSOBN
     C                   MOVE      *BLANKS       WSREIS
     C                   MOVE      *ZEROS        WSDT3
     C                   MOVE      *BLANKS       WSLOH
     C                   MOVE      *BLANKS       WSLOHN
     C                   MOVE      *ZEROS        WSDT9
     C                   MOVE      *BLANKS       WSLOS
     C                   MOVE      *BLANKS       WSLOSN
     C                   MOVE      *BLANKS       WSLSTY
     C                   MOVE      *ZEROS        WSKNRP
     C                   MOVE      *BLANKS       WSNARP
     C                   MOVE      *ZEROS        WSKNDA
     C                   MOVE      *BLANKS       WSNADA
     C                   MOVE      *BLANKS       WSMM
     C                   MOVE      *BLANKS       WSREFN
     C                   MOVE      *ZEROS        WSNT1
     C                   MOVE      *BLANKS       WSKDC1
     C                   MOVE      *BLANKS       WSMN1
     C                   MOVE      *BLANKS       WSVS1
     C                   MOVE      *ZEROS        WSVKT1
     C                   MOVE      *ZEROS        WSM31
     C                   MOVE      *ZEROS        WSNT2
     C                   MOVE      *BLANKS       WSKDC2
     C                   MOVE      *BLANKS       WSMN2
     C                   MOVE      *BLANKS       WSVS2
     C                   MOVE      *ZEROS        WSVKT2
     C                   MOVE      *ZEROS        WSM32
     C                   MOVE      *ZEROS        WSNT3
     C                   MOVE      *BLANKS       WSKDC3
     C                   MOVE      *BLANKS       WSMN3
     C                   MOVE      *BLANKS       WSVS3
     C                   MOVE      *ZEROS        WSVKT3
     C                   MOVE      *ZEROS        WSM33
     C                   MOVE      *ZEROS        WSNT4
     C                   MOVE      *BLANKS       WSKDC4
     C                   MOVE      *BLANKS       WSMN4
     C                   MOVE      *BLANKS       WSVS4
     C                   MOVE      *ZEROS        WSVKT4
     C                   MOVE      *ZEROS        WSM34
     C                   MOVE      *BLANKS       WSLSS
     C                   MOVE      *BLANKS       WSLSSN
     C                   MOVE      *ZEROS        WSDT4
     C                   MOVE      *BLANKS       WSREF2
     C                   MOVE      *BLANKS       WSINS2
     C                   MOVE      *BLANKS       WSDP
     C                   MOVE      *ZEROS        WSDT5
     C                   MOVE      *BLANKS       WSREF3
     C                   MOVE      *BLANKS       WSINS3
     C                   MOVE      *ZEROS        WSKNT
     C                   MOVE      *BLANKS       WSNAT
     C                   MOVE      *ZEROS        WSDT6
     C                   MOVE      *BLANKS       WSREF4
     C                   MOVE      *BLANKS       WSINS4
     C                   MOVE      *BLANKS       WSCH
     C                   MOVE      *BLANKS       WSMH
     C                   MOVE      *BLANKS       WSRATE
     C                   MOVE      *BLANKS       WSVAL
     C                   MOVE      *ZEROS        WSBL
     C                   MOVE      *BLANKS       WSCP
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDBK         BEGSR
     C***********************************************
     C   09WSPRO         IFEQ      0
     C     WSAVD         CHAIN     TELL                               33
     C   33XAVD0         CHAIN     TELL                               33
     C  N33              MOVE      TETURN        WSPRO
     C  N33              ADD       1             TETURN
     C  N33              UPDATE    TELLR
     C                   END
     C*
     C     BOOKK         CHAIN     BOOKING                            33
     C                   EXSR      MOVWBO
     C  N33              UPDATE    BOOKINGR
     C   33              DO
     C     WSAVD         CHAIN     TELL                               33
     C   33XAVD0         CHAIN     TELL                               33
     C                   MOVE      TEOPDN        WSOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      WSAVD         BOAVD
     C                   MOVE      WSOPD         BOOPD
      *
     C                   MOVE      *ZEROS        BOKNTO
     C                   MOVE      *ZEROS        BOKNFO
     C                   MOVE      *ZEROS        BOKNCO
     C                   MOVE      *BLANKS       BOTFXO
     C                   MOVE      *ZEROS        BODTO
     C                   MOVE      *ZEROS        BOTIDO
     C                   MOVE      *ZEROS        BOKNTL
     C                   MOVE      *ZEROS        BOKNFL
     C                   MOVE      *ZEROS        BOKNCL
     C                   MOVE      *BLANKS       BOTFXL
     C                   MOVE      *ZEROS        BODTL
     C                   MOVE      *ZEROS        BOTIDL
     C                   MOVE      *ZEROS        BOKNTT
     C                   MOVE      *ZEROS        BOKNFT
     C                   MOVE      *ZEROS        BOKNCT
     C                   MOVE      *BLANKS       BOTFXT
     C                   MOVE      *ZEROS        BODTT
     C                   MOVE      *ZEROS        BOTIDT
     C                   MOVE      *ZEROS        BOKNTP
     C                   MOVE      *ZEROS        BOKNFP
     C                   MOVE      *ZEROS        BOKNCP
     C                   MOVE      *BLANKS       BOTFXP
     C                   MOVE      *ZEROS        BODTP
     C                   MOVE      *ZEROS        BOTIDP
     C                   MOVE      *ZEROS        BOKNTE
     C                   MOVE      *ZEROS        BOKNFE
     C                   MOVE      *ZEROS        BOKNCE
     C                   MOVE      *BLANKS       BOTFXE
     C                   MOVE      *ZEROS        BODTE
     C                   MOVE      *ZEROS        BOTIDE
     C                   MOVE      *ZEROS        BODTS
     C                   MOVE      *ZEROS        BODTB
     C                   MOVE      *ZEROS        BODTA
     C                   MOVE      *ZEROS        BOKNBB
     C                   MOVE      *BLANKS       BOTFBB
     C                   MOVE      *ZEROS        BODTBB
     C                   MOVE      *ZEROS        BOTIBB
      *
     C                   WRITE     BOOKINGR
     C                   END
      *
      * BEDT OM FORNYING AV BL-LINJENE?? - FJERN DE GAMLE
     C     WSBLLI        IFEQ      'J'
     C     BOOKK         SETLL     BLV1LF
     C     BOOKK         READE     BLV1LF                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    BLV1R
     C     BOOKK         READE     BLV1LF                                 33
     C                   END
     C                   MOVE      ' '           WSBLLI
     C                   END
      *
     C     WSNT1         IFNE      *ZEROS
     C     WSVKT1        ANDNE     *ZEROS
     C     BOOKK         SETLL     BLV1LF
     C     BOOKK         READE(N)  BLV1LF                                 33
     C   33              EXSR      KOPIB2
     C                   END
     C*
     C*** OPPDATER B/L OG OPPDRAG
     C     *IN03         IFEQ      '1'
     C     *IN05         OREQ      '1'
     C     *IN10         OREQ      '1'
     C     *IN11         OREQ      '1'
     C                   MOVE      BOAVD         UAVD1             4 0
     C                   MOVE      BOOPD         UOPD1             7 0
     C                   MOVE      BOAVDK        UAVD2             4 0
     C                   MOVE      BOOPDK        UOPD2             7 0
     C                   CALL      'SYSJ50M'
     C                   PARM                    UAVD1
     C                   PARM                    UOPD1
     C                   PARM                    BOSG
     C                   PARM                    UAVD2
     C                   PARM                    UOPD2
N02  C                   PARM                    UUR
     C*
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWBO        BEGSR
     C***********************************************
     C                   MOVE      'X'           BOST
     C                   MOVE      WSSG          BOSG
     C                   MOVE      WSPRO         BOPRO
     C                   MOVE      WSAVDK        BOAVDK
     C                   MOVE      WSOPDK        BOOPDK
     C                   MOVE      WSDTRD        BODTRD
     C                   MOVE      WSDTRM        BODTRM
     C     WSDTRÅ        IFGT      50
     C     WSDTRÅ        ADD       1900          BODTRÅ
     C                   ELSE
     C     WSDTRÅ        ADD       2000          BODTRÅ
     C                   END
     C                   MOVE      WSAAR         BOAAR
     C     WSAAR         IFGT      50
     C                   MOVE      '19'          BOACC
     C                   ELSE
     C                   MOVE      '20'          BOACC
     C                   END
     C                   MOVE      WSUKE         BOUKE
     C                   MOVE      WSKNR         BOKNR
     C                   MOVE      WSTR          BOTR
     C                   MOVE      WSKNA         BOKNA
     C                   MOVE      WSNAA         BONAA
     C                   MOVE      WSKNAA        BOKNAA
     C                   MOVE      WSKNS         BOKNS
     C                   MOVE      WSNAS         BONAS
     C                   MOVE      WSKNAA        BOKNAA
     C                   MOVE      WSLB          BOLB
     C                   MOVE      WSLBN         BOLBN
     C                   MOVE      WSLSH         BOLSH
     C                   MOVE      WSLSHN        BOLSHN
     C     WSDT1         IFEQ      0
     C                   MOVE      *ZEROS        BODT1
     C                   ELSE
     C                   MOVE      WSDTD1        BODTD1
     C                   MOVE      WSDTM1        BODTM1
     C     WSDTÅ1        IFGT      50
     C     WSDTÅ1        ADD       1900          BODTÅ1
     C                   ELSE
     C     WSDTÅ1        ADD       2000          BODTÅ1
     C                   END
     C                   END
     C                   MOVE      WSANM         BOANM
     C                   MOVE      WSREF1        BOREF1
     C                   MOVE      WSANMN        BOANMN
     C     WSDT2         IFEQ      0
     C                   MOVE      *ZEROS        BODT2
     C                   ELSE
     C                   MOVE      WSDTD2        BODTD2
     C                   MOVE      WSDTM2        BODTM2
     C*                    MOVE WSDTÅ2    BODTÅ2
     C     WSDTÅ2        IFGT      50
     C     WSDTÅ2        ADD       1900          BODTÅ2
     C                   ELSE
     C     WSDTÅ2        ADD       2000          BODTÅ2
     C                   END
     C                   END
     C                   MOVE      WSINS1        BOINS1
     C                   MOVE      WSVHL         BOVHL
     C     WSDT7         IFEQ      0
     C                   MOVE      *ZEROS        BODT7
     C                   ELSE
     C                   MOVE      WSDTD7        BODTD7
     C                   MOVE      WSDTM7        BODTM7
     C     WSDTÅ7        IFGT      50
     C     WSDTÅ7        ADD       1900          BODTÅ7
     C                   ELSE
     C     WSDTÅ7        ADD       2000          BODTÅ7
     C                   END
     C                   END
     C                   MOVE      WSVH2         BOVH2
     C     WSDT8         IFEQ      0
     C                   MOVE      *ZEROS        BODT8
     C                   ELSE
     C                   MOVE      WSDTD8        BODTD8
     C                   MOVE      WSDTM8        BODTM8
     C     WSDTÅ8        IFGT      50
     C     WSDTÅ8        ADD       1900          BODTÅ8
     C                   ELSE
     C     WSDTÅ8        ADD       2000          BODTÅ8
     C                   END
     C                   END
     C                   MOVE      WSVH          BOVH
     C                   MOVE      WSVHN         BOVHN
     C                   MOVE      WSOB          BOOB
     C                   MOVE      WSOBN         BOOBN
     C                   MOVE      WSREIS        BOREIS
     C     WSDT3         IFEQ      0
     C                   MOVE      *ZEROS        BODT3
     C                   ELSE
     C                   MOVE      WSDTD3        BODTD3
     C                   MOVE      WSDTM3        BODTM3
     C     WSDTÅ3        IFGT      50
     C     WSDTÅ3        ADD       1900          BODTÅ3
     C                   ELSE
     C     WSDTÅ3        ADD       2000          BODTÅ3
     C                   END
     C                   END
     C                   MOVE      WSLOH         BOLOH
     C                   MOVE      WSLOHN        BOLOHN
     C     WSDT9         IFEQ      0
     C                   MOVE      *ZEROS        BODT9
     C                   ELSE
     C                   MOVE      WSDTD9        BODTD9
     C                   MOVE      WSDTM9        BODTM9
     C     WSDTÅ9        IFGT      50
     C     WSDTÅ9        ADD       1900          BODTÅ9
     C                   ELSE
     C     WSDTÅ9        ADD       2000          BODTÅ9
     C                   END
     C                   END
     C                   MOVE      WSLOS         BOLOS
     C                   MOVE      WSLOSN        BOLOSN
     C                   MOVE      WSLSTY        BOLSTY
     C                   MOVE      WSKNRP        BOKNRP
     C                   MOVE      WSNARP        BONARP
     C                   MOVE      WSKNDA        BOKNDA
     C                   MOVE      WSNADA        BONADA
     C                   MOVE      WSMM          BOMM
     C                   MOVE      WSREFN        BOREFN
     C                   MOVE      WSNT1         BONT1
     C                   MOVE      WSKDC1        BOKDC1
     C                   MOVE      WSMN1         BOMN1
     C                   MOVE      WSVS1         BOVS1
     C                   MOVE      WSVKT1        BOVKT1
     C                   MOVE      WSM31         BOM31
     C                   MOVE      WSNT2         BONT2
     C                   MOVE      WSKDC2        BOKDC2
     C                   MOVE      WSMN2         BOMN2
     C                   MOVE      WSVS2         BOVS2
     C                   MOVE      WSVKT2        BOVKT2
     C                   MOVE      WSM32         BOM32
     C                   MOVE      WSNT3         BONT3
     C                   MOVE      WSKDC3        BOKDC3
     C                   MOVE      WSMN3         BOMN3
     C                   MOVE      WSVS3         BOVS3
     C                   MOVE      WSVKT3        BOVKT3
     C                   MOVE      WSM33         BOM33
     C                   MOVE      WSNT4         BONT4
     C                   MOVE      WSKDC4        BOKDC4
     C                   MOVE      WSMN4         BOMN4
     C                   MOVE      WSVS4         BOVS4
     C                   MOVE      WSVKT4        BOVKT4
     C                   MOVE      WSM34         BOM34
     C                   MOVE      WSLSS         BOLSS
     C                   MOVE      WSLSSN        BOLSSN
     C     WSDT4         IFEQ      0
     C                   MOVE      *ZEROS        BODT4
     C                   ELSE
     C                   MOVE      WSDTD4        BODTD4
     C                   MOVE      WSDTM4        BODTM4
     C     WSDTÅ4        IFGT      50
     C     WSDTÅ4        ADD       1900          BODTÅ4
     C                   ELSE
     C     WSDTÅ4        ADD       2000          BODTÅ4
     C                   END
     C                   END
     C                   MOVE      WSREF2        BOREF2
     C                   MOVE      WSINS2        BOINS2
     C                   MOVE      WSDP          BODP
     C     WSDT5         IFEQ      0
     C                   MOVE      *ZEROS        BODT5
     C                   ELSE
     C                   MOVE      WSDTD5        BODTD5
     C                   MOVE      WSDTM5        BODTM5
     C     WSDTÅ5        IFGT      50
     C     WSDTÅ5        ADD       1900          BODTÅ5
     C                   ELSE
     C     WSDTÅ5        ADD       2000          BODTÅ5
     C                   END
     C                   END
     C                   MOVE      WSREF3        BOREF3
     C                   MOVE      WSINS3        BOINS3
     C                   MOVE      WSKNT         BOKNT
     C                   MOVE      WSNAT         BONAT
     C     WSDT6         IFEQ      0
     C                   MOVE      *ZEROS        BODT6
     C                   ELSE
     C                   MOVE      WSDTD6        BODTD6
     C                   MOVE      WSDTM6        BODTM6
     C     WSDTÅ6        IFGT      50
     C     WSDTÅ6        ADD       1900          BODTÅ6
     C                   ELSE
     C     WSDTÅ6        ADD       2000          BODTÅ6
     C                   END
     C                   END
     C                   MOVE      WSREF4        BOREF4
     C                   MOVE      WSINS4        BOINS4
     C                   MOVE      WSCH          BOCH
     C                   MOVE      WSMH          BOMH
     C                   MOVE      WSRATE        BORATE
     C                   MOVE      WSVAL         BOVAL
     C                   MOVE      WSBL          BOBL
     C                   MOVE      WSCP          BOCP
     C                   MOVE      WSBKNL        BOBKNL
     C                   MOVE      WSCPL         BOCPL
     C                   MOVE      WSVALL        BOVALL
     C                   MOVE      WSBLL         BOBLL
     C                   MOVE      WSBLCP        BOBLCP
     C                   MOVE      WSBLG         BOBLG
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TILV          BEGSR
     C***********************************************
     C                   MOVE      WSDTR         UDTR              6 0
     C   11              GOTO      STTV2
      * MODELL 1
     C     STTV1         TAG
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYSJ50E'
     C                   PARM      BOAVD         UAVD1
     C                   PARM      BOOPD         UOPD1
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      2
     C                   GOTO      STTV2
     C                   ELSE
     C                   GOTO      SLTV
     C                   END
     C*
     C     STTV2         TAG
     C                   Z-ADD     1             UFLAGG
     C                   CALL      'SYSJ50F'
     C                   PARM      BOAVD         UAVD1
     C                   PARM      BOOPD         UOPD1
     C                   PARM                    UDTR
     C                   PARM                    BOSG
     C                   PARM                    BOUKE
     C                   PARM                    BOAAR
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      STTV1
     C                   END
      *
     C     SLTV          ENDSR
      *
     C***********************************************
     C     KOPIB2        BEGSR
     C***********************************************
     C                   Z-ADD     0             BVLI
     C                   MOVE      BOAVD         BVAVD
     C                   MOVE      BOOPD         BVOPD
     C     1             DO        4             XN                4 0          1<-B
     C     NT(XN)        IFNE      0                                             2<-B
     C     MN(XN)        ORNE      *BLANKS
     C     VS(XN)        ORNE      *BLANKS
     C     VK(XN)        ORNE      0
     C     M3(XN)        ORNE      0
     C                   ADD       1             BVLI
     C     BVLI          MULT      10            BVSORT
     C                   MOVEL     MN(XN)        BVMN
     C                   MOVE      NT(XN)        BVNT
     C                   MOVE      VK(XN)        BVVKT
     C                   MOVE      M3(XN)        BVM3
     C                   MOVE      KC(XN)        BVKDC
     C                   MOVE      *ZEROS        BVENH
     C     KC(XN)        IFEQ      *BLANKS                                        3<-B
     C                   MOVE      VS(XN)        BVVS
     C                   ELSE                                                     3
     C                   MOVE      KC(XN)        YKDC              2
     C     YKDC          CHAIN     CDCON4                             33
     C   33              MOVE      VS(XN)        BVVS
     C  N33              MOVEL     CC4FT         BVVS
     C  N33              MOVE      CC4NT         BVENH
     C  N33VS(XN)        IFNE      *BLANKS                                         4<-B
     C                   WRITE     BLV1R
     C                   MOVE      *BLANKS       BVMN
     C                   MOVE      VS(XN)        BVVS
     C                   ADD       1             BVLI
     C     BVLI          MULT      10            BVSORT
     C                   MOVE      *ZEROS        BVNT
     C                   MOVE      *BLANKS       BVKDC
     C                   MOVE      *ZEROS        BVENH
     C                   MOVE      *ZEROS        BVVKT
     C                   MOVE      *ZEROS        BVM3
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   WRITE     BLV1R
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISFRE        BEGSR
     C***********************************************
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYFA31CL'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    UFLAGG
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    SØKKUN        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNR
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNS
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    WSKNRP
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    WSKNDA
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*
S01  C*    WSKNA         IFNE      0
S01  C*                  MOVE      WSKNA         KUNDNR
S01  C*    KUND1K        CHAIN     CUNDL01                            33
S01  C* N33              MOVE      KNAVN         WSNAA
S01  C*                  END
S01  C*    WSKNS         IFNE      0
S01  C*                  MOVE      WSKNS         KUNDNR
S01  C*    KUND1K        CHAIN     CUNDL01                            33
S01  C* N33              MOVE      KNAVN         WSNAS
S01  C*                  END
S01  C*    WSKNRP        IFNE      0
S01  C*                  MOVE      WSKNRP        KUNDNR
S01  C*    KUND1K        CHAIN     CUNDL01                            33
S01  C* N33              MOVE      KNAVN         WSNARP
S01  C*                  END
S01  C*    WSKNDA        IFNE      0
S01  C*                  MOVE      WSKNDA        KUNDNR
S01  C*    KUND1K        CHAIN     CUNDL01                            33
S01  C* N33              MOVE      KNAVN         WSNADA
S01  C*                  END
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C   51LINNBR        IFEQ      1
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     72
     C                   MOVE      SOTXT1        YSKMOT            8
     C                   MOVE      WSKNR         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C*
     C     POSNBR        IFGE      8
     C     POSNBR        ANDLE     15
     C   52LINNBR        IFEQ      2
     C                   MOVE      SOTXT2        YSKMOT            8
     C                   MOVE      WSKNA         YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C   53LINNBR        IFEQ      3
     C                   MOVE      SOTXT3        YSKMOT
     C                   MOVE      WSKNS         YSKKNR
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C     POSNBR        IFGE      42
     C     POSNBR        ANDLE     49
     C   54LINNBR        IFEQ      11
     C                   MOVE      SOTXT4        YSKMOT            8
     C                   MOVE      WSKNRP        YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C   56LINNBR        IFEQ      12
     C                   MOVE      SOTXT5        YSKMOT            8
     C                   MOVE      WSKNDA        YSKKNR            8 0
     C                   GOTO      STVISO
     C                   END
     C                   END
     C*
     C     LINNBR        IFEQ      1
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     80
     C                   Z-ADD     1             UFLAGG
     C                   Z-ADD     2             UKODE             1 0
     C                   CALL      'SYSJ05'
     C                   PARM                    UKODE
     C                   PARM      WSKNR         UKNR              8 0
     C                   PARM      WSTR          UTR               4
     C                   PARM                    ULK               2
     C                   PARM                    UDT               6 0
     C                   PARM                    UKD               3
     C                   PARM                    UFLAGG
     C                   GOTO      SLVISO
     C                   END
     C*
     C                   MOVE      'DIV3730'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
     C*
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    YSKKNR
     C                   PARM                    YSKMOT
     C                   PARM                    UFLAGG
     C                   PARM                    HEUR01
     C*
     C     SLVISO        ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      1
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     72
S01  C*                  EXSR      SØKKUN
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNR
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
     C                   Z-ADD     77            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
S01  C*    LINNBR        IFGE      2
S01  C*    LINNBR        ANDLE     3
N01  C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     15
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAA
     C                   Z-ADD     56            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01   *
N01  C     LINNBR        IFEQ      3
N01  C     POSNBR        ANDGE     8
N01  C     POSNBR        ANDLE     15
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNS
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAS
N01  C                   Z-ADD     56            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
S01  C*    LINNBR        IFGE      11
S01  C*    LINNBR        ANDLE     12
N01  C     LINNBR        IFGE      11
     C     POSNBR        ANDGE     42
     C     POSNBR        ANDLE     49
S01  C*                  EXSR      SØKKUN
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNRP
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNARP
S01  C*                  Z-ADD     10            LINNBR
N01  C                   Z-ADD     12            LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
N01  C     LINNBR        IFGE      12
N01  C     POSNBR        ANDGE     42
N01  C     POSNBR        ANDLE     49
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNDA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNADA
N01  C                   Z-ADD     14            LINNBR
N01  C                   Z-ADD     2             POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C                   Z-ADD     1             UFLAGG
     C     LINNBR        IFEQ      1
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     80
     C                   CALL      'SYSJ17A'
     C                   PARM                    WSKNR
     C                   PARM                    WSTR
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSLB
     C     WSLB          CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         WSLBN
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     45
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C     WSLSH         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSLSHN
     C                   Z-ADD     75            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     38
     C     POSNBR        ANDLE     40
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVALL
     C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     77
     C                   CALL      'SYSJ19A'
     C                   PARM                    WSLSTY
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     19
     C     POSNBR        ANDLE     23
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSVHL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSVH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C     WSVH          CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSVHN
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     61
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSVH2
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     58
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSOB
     C     WSOB          CHAIN     CDBOAT                             33
     C  N33              MOVEL     CBNAB         WSOBN
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C     WSLOH         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSLOHN
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     57
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLOS
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C     WSLOS         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSLOSN
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     8             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     12
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKDC1
     C     WSKDC1        IFNE      *BLANKS
     C     WSKDC1        CHAIN     CDCON4                             74
     C                   END
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     12
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKDC2
     C     WSKDC2        IFNE      *BLANKS
     C     WSKDC2        CHAIN     CDCON4                             73
     C                   END
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     12
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKDC3
     C     WSKDC3        IFNE      *BLANKS
     C     WSKDC3        CHAIN     CDCON4                             72
     C                   END
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     12
     C                   CALL      'SYSJ02X'
     C                   PARM                    WSKDC4
     C     WSKDC4        IFNE      *BLANKS
     C     WSKDC4        CHAIN     CDCON4                             71
     C                   END
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     12
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLSS
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C     WSLSS         CHAIN     STED2                              33
     C  N33              MOVEL     ST2NVN        WSLSSN
     C                   Z-ADD     48            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     27
     C                   CALL      'SYFI10J'
     C                   PARM                    WSDP
     C                   Z-ADD     48            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     24
     C                   CALL      'SYTR04A'
     C                   PARM                    WSKNT
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     44
     C     POSNBR        ANDLE     46
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSVAL
     C                   Z-ADD     48            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOOKK         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     BOOKK2        KLIST
     C                   KFLD                    BOAVD
     C                   KFLD                    BOOPD
     C     CDTRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNR
     C                   KFLD                    WSTR
     C     CDTRK2        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSTR
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C     KODTVK        KLIST
     C                   KFLD                    YVUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    WSSG
     C     KODTEK        KLIST
     C                   KFLD                    YTEUNI
     C                   KFLD                    WSDP1
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    VALKOD
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     TRANK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNT
     C     FRATXK        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR01            1
     C                   MOVE      'G'           HEUR01
     C     FRAT2K        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    HEUR02            1
     C     FREETK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    USG               3
     C                   PARM                    UAVDCP            4 0
     C                   PARM                    UOPDCP            7 0
     C                   PARM                    UFLAGG            1 0
      *
N02  C                   IF        UFLAGG = 1
N02  C                   MOVE      'F'           UUR               1
N02  C                   ELSE
N02  C                   MOVE      'G'           UUR
N02  C                   END
N02  C                   EVAL      UFLAGG = 0
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UOPD          WSOPD
     C                   MOVE      USG           WSSG
     C                   MOVE      UAVDCP        BOAVD
     C                   MOVE      UOPDCP        BOOPD
     C*
     C     *DTAARA       DEFINE    *LDA          SAVUDS
     C                   IN        SAVUDS
     C*
S01  C*                  Z-ADD     5             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C                   MOVE      'J'           USØK              1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'V'           YVUNI             1
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'TERM'        YTEUNI            4
     C                   MOVE      *ZEROS        YFXLNR            2 0
     C                   MOVE      *ZEROS        XAVD0             4 0
     C                   MOVE      *ZEROS        NT
     C                   MOVE      *BLANKS       KC
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       VS
     C                   MOVE      *ZEROS        VK
     C                   MOVE      *ZEROS        M3
     C*
     C                   MOVE      *ZEROS        WSDTR
     C                   MOVE      *ZEROS        BODTR
     C                   MOVE      *ZEROS        WSDT1
     C                   MOVE      *ZEROS        BODT1
     C                   MOVE      *ZEROS        WSDT2
     C                   MOVE      *ZEROS        BODT2
     C                   MOVE      *ZEROS        WSDT3
     C                   MOVE      *ZEROS        BODT3
     C                   MOVE      *ZEROS        WSDT4
     C                   MOVE      *ZEROS        BODT4
     C                   MOVE      *ZEROS        WSDT5
     C                   MOVE      *ZEROS        BODT5
     C                   MOVE      *ZEROS        WSDT6
     C                   MOVE      *ZEROS        BODT6
     C                   MOVE      *ZEROS        WSDT7
     C                   MOVE      *ZEROS        BODT7
     C                   MOVE      *ZEROS        WSDT8
     C                   MOVE      *ZEROS        BODT8
     C                   MOVE      *ZEROS        WSDT9
     C                   MOVE      *ZEROS        BODT9
     C*
     C                   MOVE      'DIV3114'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV3110'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV3111'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C                   MOVE      'DIV3896'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT4            8
     C                   MOVE      'DIV3897'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     8             XMSGL
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT5            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   SETOFF                                       33
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTRD        UDT1              2 0
     C                   MOVE      WSDTRM        UDT2              2 0
     C                   MOVE      WSDTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      WSDTD1        UDT1
     C                   MOVE      WSDTM1        UDT2
     C                   MOVE      WSDTÅ1        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD1
     C                   MOVE      UDT2          WSDTM1
     C                   MOVE      UDT3          WSDTÅ1
     C*
     C                   MOVE      WSDTD2        UDT1
     C                   MOVE      WSDTM2        UDT2
     C                   MOVE      WSDTÅ2        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD2
     C                   MOVE      UDT2          WSDTM2
     C                   MOVE      UDT3          WSDTÅ2
     C*
     C                   MOVE      WSDTD3        UDT1
     C                   MOVE      WSDTM3        UDT2
     C                   MOVE      WSDTÅ3        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD3
     C                   MOVE      UDT2          WSDTM3
     C                   MOVE      UDT3          WSDTÅ3
     C*
     C                   MOVE      WSDTD4        UDT1
     C                   MOVE      WSDTM4        UDT2
     C                   MOVE      WSDTÅ4        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD4
     C                   MOVE      UDT2          WSDTM4
     C                   MOVE      UDT3          WSDTÅ4
     C*
     C                   MOVE      WSDTD5        UDT1
     C                   MOVE      WSDTM5        UDT2
     C                   MOVE      WSDTÅ5        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD5
     C                   MOVE      UDT2          WSDTM5
     C                   MOVE      UDT3          WSDTÅ5
     C*
     C                   MOVE      WSDTD7        UDT1
     C                   MOVE      WSDTM7        UDT2
     C                   MOVE      WSDTÅ7        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD7
     C                   MOVE      UDT2          WSDTM7
     C                   MOVE      UDT3          WSDTÅ7
     C*
     C                   MOVE      WSDTD8        UDT1
     C                   MOVE      WSDTM8        UDT2
     C                   MOVE      WSDTÅ8        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD8
     C                   MOVE      UDT2          WSDTM8
     C                   MOVE      UDT3          WSDTÅ8
     C*
     C                   MOVE      WSDTD9        UDT1
     C                   MOVE      WSDTM9        UDT2
     C                   MOVE      WSDTÅ9        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD9
     C                   MOVE      UDT2          WSDTM9
     C                   MOVE      UDT3          WSDTÅ9
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      WSDTD6        UDT1
     C                   MOVE      WSDTM6        UDT2
     C                   MOVE      WSDTÅ6        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD6
     C                   MOVE      UDT2          WSDTM6
     C                   MOVE      UDT3          WSDTÅ6
     C*
     C                   ENDSR
     C*
