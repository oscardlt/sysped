      *
     H FTRANS
     FLLHEAD    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FTRAN      IF   E           K DISK
     FZBARC     O    F   70        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D A4              S              1    DIM(4)                               Input string
     D B4              S              1    DIM(4)                               Output string
     D Æ               S              1    DIM(20)                              Input string
     D Å               S              1    DIM(20)                              Output string
     D                 DS
     D  DATAT                  1     70
     D  DATA                   1     36
     D  DATA1                  4     36
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS            10
     D BBOX1           C                   CONST('720,160,80')
     D SENDTXT         C                   CONST('Vår ref/Our ref')
     D KUNDTXT         C                   CONST('K-ref/C-ref')
     D TRANTXT         C                   CONST('Transportør/Carrier')
     D BARPAR          C                   CONST('N,220,N,N,Y,N')
     D                 DS
      * Gør om antall kolli
     D  LANUMA                 1      4  0
     D                 DS
     D  ØN151                  1     15  1
     D  ØA151H                 1     14
     D  ØA151X                 5     14
     D  ØA151D                15     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  WRK                    1      4  0
     D                 DS
     D  WPCN                   1      4  0
     D  WPCA                   1      4
     D  WPCB                   2      4
     D                 DS
     D  LHTDT                  1      8  0
     D  LHTDTÅ                 3      4
     D  LHTDTM                 5      6
     D  LHTDTD                 7      8
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
      * Input Parameter
     C     *ENTRY        PLIST
     C                   PARM                    WMN               7
     C                   MOVE      WMN           LHMN
      * Open Printerfile
     C                   OPEN      ZBARC                                55
      * Execute init routine only once
     C                   EXSR      SRINIT
     C     LHMN          CHAIN     LLHEAD                             55
     C     CUND1k        CHAIN     CUNDL01                            55
      * Loop number of pieces
     C                   MOVE      *ZEROS        WPCN2             5 0
     C     1             DO        LHMLP         WPCN
      * Execute Label Init
     C                   EXSR      SR0001
      * Execute Label top Text
     C                   EXSR      SR0010
      * Execute Label Lines vert/hor
     C                   EXSR      SR0005
     C                   MOVE      '.'           DATAT
      * Execute Shipper Name/address 1
     C                   EXSR      SR0080
      * Execute Shipper Name/address 2
     C                   EXSR      SR0090
      * Execute Shipper Name/address 4
     C                   EXSR      SR0105
      * Execute Consignee Name
     C                   EXSR      SR0110
      * Execute Consignee Address 1
     C                   IF        LHBA1 <> *BLANKS
     C                   EXSR      SR0120
     C                   ENDIF
      * Execute Consignee Address 2
     C                   IF        LHBA2 <> *BLANKS
     C                   EXSR      SR0125
     C                   ENDIF
      * Execute Consignee Name/address 4
     C                   IF        LHBPN = 0
     C                   EVAL      XADR3M = LHBPU
     C                   CAT       LHBA3:1       XADR3M           40
     C                   ELSE
N01  C                   MOVE      *BLANKS       XADR3M
     C                   MOVEL     LHBPN         XADR3M
     C                   CAT       LHBA3:1       XADR3M
     C                   END
     C                   IF        XADR3M <> *BLANKS
     C                   EXSR      SR0126
     C                   ENDIF
      * Execute Pieces in Consignment
     C                   EXSR      SR0050
      * Strekkode - Vårref.
     C                   MOVE      ' '           DATAT
     C                   EXSR      SR0190
      * Execute End Label Format
     C                   EXSR      SREND
     C     WPCN          DIV       10            XWPCN             3 0
     C                   MVR                     XWPCN
     C                   IF        XWPCN = 0
     C                   CLOSE     ZBARC                                55
     C                   OPEN      ZBARC                                55
     C                   END
      *
     C                   ENDDO
      * Close Prinerfile
     C                   CLOSE     ZBARC                                55
      * End Program
     C                   RETURN
      *_____________________________________________________
      * Execute Label Init
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * Send Default Instructions
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    ZBARCA
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *____________________________________________________
      * Execute Label Lines Hor/Vert
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0005        BEGSR
      * First  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,200'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Second horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,445'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Third  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,740'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '720,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Label top Text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      *
      * Transportørnavn
     C     TRANK         CHAIN     TRAN                               33
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,460'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     TRANTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Transportørnavn
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,480'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   IF        *IN33 = *ON
     C                   MOVEL     KOANVN        DATA1
     C                   ELSE
     C                   MOVEL     VMNAVN        DATA1
     C                   END
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,530'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Trans.date'  DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,550'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHTDTD        DATA1
     C                   CAT       '.':0         DATA1
     C                   CAT       LHTDTM:0      DATA1
     C                   CAT       '.':0         DATA1
     C                   CAT       LHTDTÅ:0      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * Senders ref. -ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,640'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     SENDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Senders ref. -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,640'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     LHALN         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position - A-ref
     C     LHPAK         IFNE      *BLANKS
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,620'     DATA1
     C                   EXCEPT    ZBARCA
      * Fon
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KUNDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * A-ref. -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,640'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHPAK         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Pieces in Consignment
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,680'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kolli'       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - kollinummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,680'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   IF        WPCN <= LHKLL
     C                   Z-ADD     WPCN          LANUMA
     C                   ELSE
     C                   ADD       1             WPCN2
     C                   Z-ADD     WPCN2         LANUMA
     C                   ENDIF
     C                   MOVE      LANUMA        CHAR4             4
     C                   MOVEA     CHAR4         A4
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B4
     C     A4(X)         DOWEQ     '0'
     C     X             ANDLT     4
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     4
     C                   MOVEA     A4(X)         B4(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C*                  MOVEA     B4            DATA1
     C                   MOVEA     B4            B4FELT            4
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     B4FELT        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Tekst - av
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '280,680'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     'AV'          DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - Tot. ant. kolli
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '370,680'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Z-ADD     LHKLL         LANUMA
     C                   MOVE      LANUMA        CHAR4             4
     C                   MOVEA     CHAR4         A4
     C                   Z-ADD     1             X                 1 0
     C                   Z-ADD     1             Y                 1 0
     C                   MOVEA     *BLANKS       B4
     C     A4(X)         DOWEQ     '0'
     C     X             ANDLT     4
     C                   ADD       1             X
     C                   ENDDO
     C     X             DOWLE     4
     C                   MOVEA     A4(X)         B4(Y)
     C                   ADD       1             X
     C                   ADD       1             Y
     C                   ENDDO
     C*                  MOVEA     B4            DATA1
     C                   MOVEA     B4            B4FELT            4
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     B4FELT        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0080        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,40'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Fra/from'    DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,60'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KNAVN         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0090        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,95'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     ADR1          DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0100        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,130'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     ADR2          DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Address 3
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0105        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,165'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   IF        POSTNR = 0
     C                   MOVEL     SYPOGE        DATA1
     C                   ELSE
     C                   MOVEL     POSTNR        DATA1
     C                   END
     C     DATA1         CAT       ADR3:1        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0110        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,220'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,240'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHBNA         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0120        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,290'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHBA1         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0125        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,340'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHBA2         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Address 3
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0126        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,390'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XADR3M        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *____________________________________________________
      * Strekkode SEND.NR
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0190        BEGSR
      * Send.nr ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,760'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     SENDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Send.nr data
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,780'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE  (1 parameter er bredde)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '3,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LHALN         DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Leftjustify num.fields
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRNE1         BEGSR
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA151D        IFEQ      '0'                                          <-------------I
     C     ØADEC         ANDEQ     'N'                                          <-------------I
     C                   MOVE      ØA151H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA151X        ØA12                                         I
     C                   MOVE      '. '          ØA12                                         I
     C                   MOVE      ØA151D        ØA12                                         I
     C                   END                                                    <-------------I
      * search from left and find first sign over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   LEAVE                                                               II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      * Reset decimal indicator
     C                   MOVE      'N'           ØADEC
      *
     C                   ENDSR
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WB3               3            B3
     C                   MOVE      'B3'          WB3               3            B3
      *
     C                   MOVEL     WA            WBC               3            B2
     C                   MOVE      'BC'          WBC               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WFR               3            FR
     C                   MOVE      'FR'          WFR               3            FR
      *
     C                   Z-ADD     0             ØX                3 0          Index for Ø
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   MOVE      'N'           ØADEC             1            Decimal Indicator
     C                   Z-ADD     0             ÆX                3 0
      * Define workfields
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    LHPNR
     C     CUND1KAVD     KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KOAKNR
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    UAVD
     C     TRANK         KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    LHTN
      *
     C                   MOVE      *BLANKS       DATAT
     C                   MOVE      'A'           KOAUNI
     C     KODTAK        CHAIN     KODTA                              33
     C     CUND1KAVD     CHAIN     CUNDL01                            33
      *
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
     OZBARC     E            ZBARCA
     O                       DATAT
** TABELL FOR OVERSETTELSE TIL Æ,Ø,Å FOR ZEBRA STRIPE PRINTERE
ZBARC     9E7B
ZBARC     E07C
ZBARC     9F5B
ZBARC     9CC0
ZBARC     BB6A
ZBARC     47D0
