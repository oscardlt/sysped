      *********************************************************************
CRTPG+*  CRTPGM SYSPED/T5CE002R MODULE(*LIBL/T5CE002R *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FNCTSEH    UF A E           K DISK    USROPN
     F                                     PREFIX(X_)
     FNCTSEH01  IF   E             DISK    USROPN
     F                                     RENAME(NCTSEHR:NCTSEHR01)
     FNCTSESTD  UF   E           K DISK    USROPN
     F                                     PREFIX(X_)
     FKODTSI1   IF   E           K DISK    USROPN
     F                                     RENAME(KOSIR:KOSIR1)
     FKODTSI    IF   E           K DISK    USROPN
     FNCTSEC    IF A E           K DISK    USROPN
     FNCTSECAM  IF A E           K DISK    USROPN
     FTRUVVT    IF A E           K DISK    USROPN
     FTRUVDK    IF A E           K DISK    USROPN
     FTRUVCN    IF A E           K DISK    USROPN
     FTRUVMN    IF A E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D NEWSYAVA        S              4
     D NEWAVD          S              4  0
     D NEWOPD          S              7  0
     D NEWSIGN         S              3
     D WMODE           S              2
     D WSIGN           S              3
     D WA              S             15
     D JSONstring      S          32000
     D Error           S            150

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT
      *
     c                   callp     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   callp     wrtsection('top')
      * Teste input og utfør
     C  N50              EXSR      TEST

      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      *
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬thavd¬ : ¬'+%trim(%editc(THAVD:'Z'))+'¬, '
        +'¬thtdn¬ : ¬'+%trim(%editc(THTDN:'Z'))+'¬, '
        +'¬newavd¬ : ¬'+%trim(%editc(NEWAVD:'Z'))+'¬, '
        +'¬newopd¬ : ¬'+%trim(%editc(NEWOPD:'Z'))+'¬, '
        +'¬newsign¬ : ¬'+%trim(NEWSIGN)+'¬, '
        +'¬mode¬ : ¬'+%trim(WMODE)+'¬, '
          +'¬thst¬ : ¬'+%trim(THST)+'¬, '
          +'¬thsg¬ : ¬'+%trim(THSG)+'¬, '
          +'¬thdt¬ : ¬'+%trim(%editc(THDT:'Z'))+'¬, '
          +'¬thpro¬ : ¬'+%trim(%editc(THPRO:'Z'))+'¬, '
          +'¬thenkl¬ : ¬'+%trim(THENKL)+'¬, '
          +'¬thdk¬ : ¬'+%trim(THDK)+'¬, '
          +'¬thdkt¬ : ¬'+%trim(THDKT)+'¬, '
          +'¬thtirn¬ : ¬'+%trim(THTIRN)+'¬, '
          +'¬thsecu¬ : ¬'+%trim(%editc(THSECU:'Z'))+'¬, '
          +'¬thrdin¬ : ¬'+%trim(%editc(THRDIN:'Z'))+'¬, '
          +'¬thscin¬ : ¬'+%trim(THSCIN)+'¬, '
          +'¬thclkd¬ : ¬'+%trim(THCLKD)+'¬, '
          +'¬thbini¬ : ¬'+%trim(%editc(THBINI:'Z'))+'¬, '
          +'¬thlidt¬ : ¬'+%trim(THLIDT)+'¬, '
          +'¬thatyp¬ : ¬'+%trim(THATYP)+'¬, '
          +'¬tharef¬ : ¬'+%trim(THAREF)+'¬, '
          +'¬thcats¬ : ¬'+%trim(THCATS)+'¬, '
          +'¬thtsb¬ : ¬'+%trim(THTSB)+'¬, '
          +'¬thtsd1¬ : ¬'+%trim(THTSD1)+'¬, '
          +'¬theta1¬ : ¬'+%trim(%editc(THETA1:'Z'))+'¬, '
          +'¬thetat1¬ : ¬'+%trim(%editc(THETAT1:'Z'))+'¬, '
          +'¬thtsd2¬ : ¬'+%trim(THTSD2)+'¬, '
          +'¬theta2¬ : ¬'+%trim(%editc(THETA2:'Z'))+'¬, '
          +'¬thetat2¬ : ¬'+%trim(%editc(THETAT2:'Z'))+'¬, '
          +'¬thtsd3¬ : ¬'+%trim(THTSD3)+'¬, '
          +'¬theta3¬ : ¬'+%trim(%editc(THETA3:'Z'))+'¬, '
          +'¬thetat3¬ : ¬'+%trim(%editc(THETAT3:'Z'))+'¬, '
          +'¬thtsd4¬ : ¬'+%trim(THTSD4)+'¬, '
          +'¬theta4¬ : ¬'+%trim(%editc(THETA4:'Z'))+'¬, '
          +'¬thetat4¬ : ¬'+%trim(%editc(THETAT4:'Z'))+'¬, '
          +'¬thtsd5¬ : ¬'+%trim(THTSD5)+'¬, '
          +'¬theta5¬ : ¬'+%trim(%editc(THETA5:'Z'))+'¬, '
          +'¬thetat5¬ : ¬'+%trim(%editc(THETAT5:'Z'))+'¬, '
          +'¬thtsd6¬ : ¬'+%trim(THTSD6)+'¬, '
          +'¬theta6¬ : ¬'+%trim(%editc(THETA6:'Z'))+'¬, '
          +'¬thetat6¬ : ¬'+%trim(%editc(THETAT6:'Z'))+'¬, '
          +'¬thtsd7¬ : ¬'+%trim(THTSD7)+'¬, '
          +'¬theta7¬ : ¬'+%trim(%editc(THETA7:'Z'))+'¬, '
          +'¬thetat7¬ : ¬'+%trim(%editc(THETAT7:'Z'))+'¬, '
          +'¬thtsd8¬ : ¬'+%trim(THTSD8)+'¬, '
          +'¬theta8¬ : ¬'+%trim(%editc(THETA8:'Z'))+'¬, '
          +'¬thetat8¬ : ¬'+%trim(%editc(THETAT8:'Z'))+'¬, '
          +'¬thtsde¬ : ¬'+%trim(THTSDE)+'¬, '
          +'¬thknh¬ : ¬'+%trim(%editc(THKNH:'Z'))+'¬, '
          +'¬thtinh¬ : ¬'+%trim(THTINH)+'¬, '
          +'¬thtirh¬ : ¬'+%trim(THTIRH)+'¬, '
          +'¬thnah¬ : ¬'+%trim(THNAH)+'¬, '
          +'¬thad1h¬ : ¬'+%trim(THAD1H)+'¬, '
          +'¬thpnh¬ : ¬'+%trim(THPNH)+'¬, '
          +'¬thpsh¬ : ¬'+%trim(THPSH)+'¬, '
          +'¬thlkh¬ : ¬'+%trim(THLKH)+'¬, '
          +'¬thcph¬ : ¬'+%trim(THCPH)+'¬, '
          +'¬thtlh¬ : ¬'+%trim(THTLH)+'¬, '
          +'¬themh¬ : ¬'+%trim(THEMH)+'¬, '
          +'¬thkna¬ : ¬'+%trim(%editc(THKNA:'Z'))+'¬, '
          +'¬thtina¬ : ¬'+%trim(THTINA)+'¬, '
          +'¬thsta¬ : ¬'+%trim(%editc(THSTA:'Z'))+'¬, '
          +'¬thcpa¬ : ¬'+%trim(THCPA)+'¬, '
          +'¬thtla¬ : ¬'+%trim(THTLA)+'¬, '
          +'¬thema¬ : ¬'+%trim(THEMA)+'¬, '
          +'¬thgkd¬ : ¬'+%trim(THGKD)+'¬, '
          +'¬thgft1¬ : ¬'+%trim(THGFT1)+'¬, '
          +'¬thgft2¬ : ¬'+%trim(THGFT2)+'¬, '
          +'¬thgadk¬ : ¬'+%trim(THGADK)+'¬, '
          +'¬thgbl¬ : ¬'+%trim(%editc(THGBL:'4'))+'¬, '
          +'¬thgvk¬ : ¬'+%trim(THGVK)+'¬,'
          +'¬thalk¬ : ¬'+%trim(THALK)+'¬, '
          +'¬thblk¬ : ¬'+%trim(THBLK)+'¬, '
          +'¬thkdc¬ : ¬'+%trim(THKDC)+'¬, '
          +'¬thtmin¬ : ¬'+%trim(%editc(THTMIN:'4'))+'¬, '
          +'¬thtmgr¬ : ¬'+%trim(%editc(THTMGR:'4'))+'¬, '
          +'¬thvkb¬ : ¬'+%trim(%editc(THVKB:'4'))+'¬, '
          +'¬thucr¬ : ¬'+%trim(THUCR)+'¬, '
          +'¬thtinc¬ : ¬'+%trim(THTINC)+'¬, '
          +'¬thknc¬ : ¬'+%trim(%editc(THKNC:'Z'))+'¬, '
          +'¬thnac¬ : ¬'+%trim(THNAC)+'¬, '
          +'¬thtlc¬ : ¬'+%trim(THTLC)+'¬, '
          +'¬themc¬ : ¬'+%trim(THEMC)+'¬, '
          +'¬thkns¬ : ¬'+%trim(%editc(THKNS:'Z'))+'¬, '
          +'¬thtins¬ : ¬'+%trim(THTINS)+'¬, '
          +'¬thnas¬ : ¬'+%trim(THNAS)+'¬, '
          +'¬thad1s¬ : ¬'+%trim(THAD1S)+'¬, '
          +'¬thpns¬ : ¬'+%trim(THPNS)+'¬, '
          +'¬thpss¬ : ¬'+%trim(THPSS)+'¬, '
          +'¬thlks¬ : ¬'+%trim(THLKS)+'¬, '
          +'¬thcps¬ : ¬'+%trim(THCPS)+'¬, '
          +'¬thtls¬ : ¬'+%trim(THTLS)+'¬, '
          +'¬thems¬ : ¬'+%trim(THEMS)+'¬, '
          +'¬thknk¬ : ¬'+%trim(%editc(THKNK:'Z'))+'¬, '
          +'¬thtink¬ : ¬'+%trim(THTINK)+'¬, '
          +'¬thnak¬ : ¬'+%trim(THNAK)+'¬, '
          +'¬thad1k¬ : ¬'+%trim(THAD1K)+'¬, '
          +'¬thpnk¬ : ¬'+%trim(THPNK)+'¬, '
          +'¬thpsk¬ : ¬'+%trim(THPSK)+'¬, '
          +'¬thlkk¬ : ¬'+%trim(THLKK)+'¬, '
          +'¬throle¬ : ¬'+%trim(THROLE)+'¬, '
          +'¬thidr¬ : ¬'+%trim(THIDR)+'¬, '
          +'¬thcnr¬ : ¬'+%trim(THCNR)+'¬, '
          +'¬thdant¬ : ¬'+%trim(%editc(THDANT:'Z'))+'¬, '
          +'¬thdfkd¬ : ¬'+%trim(THDFKD)+'¬, '
          +'¬thginr¬ : ¬'+%trim(%editc(THGINR:'Z'))+'¬, '
          +'¬thlgty¬ : ¬'+%trim(THLGTY)+'¬, '
          +'¬thlgid¬ : ¬'+%trim(THLGID)+'¬, '
          +'¬thlgau¬ : ¬'+%trim(THLGAU)+'¬, '
          +'¬thlgai¬ : ¬'+%trim(THLGAI)+'¬, '
          +'¬thlgun¬ : ¬'+%trim(THLGUN)+'¬, '
          +'¬thlgts¬ : ¬'+%trim(THLGTS)+'¬, '
          +'¬thlgla¬ : ¬'+%trim(THLGLA)+'¬, '
          +'¬thlglo¬ : ¬'+%trim(THLGLO)+'¬, '
          +'¬thkne¬ : ¬'+%trim(%editc(THKNE:'Z'))+'¬, '
          +'¬thtine¬ : ¬'+%trim(THTINE)+'¬, '
          +'¬thade1¬ : ¬'+%trim(THADE1)+'¬, '
          +'¬thpne¬ : ¬'+%trim(THPNE)+'¬, '
          +'¬thpse¬ : ¬'+%trim(THPSE)+'¬, '
          +'¬thlke¬ : ¬'+%trim(THLKE)+'¬, '
          +'¬thade2¬ : ¬'+%trim(THADE2)+'¬, '
          +'¬thpne2¬ : ¬'+%trim(THPNE2)+'¬, '
          +'¬thlke2¬ : ¬'+%trim(THLKE2)+'¬, '
          +'¬thcpe¬ : ¬'+%trim(THCPE)+'¬, '
          +'¬thtle¬ : ¬'+%trim(THTLE)+'¬, '
          +'¬theme¬ : ¬'+%trim(THEME)+'¬, '
          +'¬thtrm¬ : ¬'+%trim(%editc(THTRM:'Z'))+'¬, '
          +'¬thtaid¬ : ¬'+%trim(THTAID)+'¬, '
          +'¬thtalk¬ : ¬'+%trim(THTALK)+'¬, '
          +'¬thlkr1¬ : ¬'+%trim(THLKR1)+'¬, '
          +'¬thlkr2¬ : ¬'+%trim(THLKR2)+'¬, '
          +'¬thlkr3¬ : ¬'+%trim(THLKR3)+'¬, '
          +'¬thlkr4¬ : ¬'+%trim(THLKR4)+'¬, '
          +'¬thlkr5¬ : ¬'+%trim(THLKR5)+'¬, '
          +'¬thlkr6¬ : ¬'+%trim(THLKR6)+'¬, '
          +'¬thtgts¬ : ¬'+%trim(THTGTS)+'¬, '
          +'¬thtrmg¬ : ¬'+%trim(%editc(THTRMG:'Z'))+'¬, '
          +'¬thtgid¬ : ¬'+%trim(THTGID)+'¬, '
          +'¬thtglk¬ : ¬'+%trim(THTGLK)+'¬, '
          +'¬thtgcn¬ : ¬'+%trim(THTGCN)+'¬, '
          +'¬thlsun¬ : ¬'+%trim(THLSUN)+'¬, '
          +'¬thlslk¬ : ¬'+%trim(THLSLK)+'¬, '
          +'¬thlsna¬ : ¬'+%trim(THLSNA)+'¬, '
          +'¬thloun¬ : ¬'+%trim(THLOUN)+'¬, '
          +'¬thlolk¬ : ¬'+%trim(THLOLK)+'¬, '
          +'¬thlona¬ : ¬'+%trim(THLONA)+'¬, '
          +'¬thpdty¬ : ¬'+%trim(THPDTY)+'¬, '
          +'¬thpdrf¬ : ¬'+%trim(THPDRF)+'¬, '
          +'¬thpdin¬ : ¬'+%trim(THPDIN)+'¬, '
          +'¬thsdty¬ : ¬'+%trim(THSDTY)+'¬, '
          +'¬thsdrf¬ : ¬'+%trim(THSDRF)+'¬, '
          +'¬thsdln¬ : ¬'+%trim(%editc(THSDLN:'Z'))+'¬, '
          +'¬thsdin¬ : ¬'+%trim(THSDIN)+'¬, '
          +'¬thtdty¬ : ¬'+%trim(THTDTY)+'¬, '
          +'¬thtdrf¬ : ¬'+%trim(THTDRF)+'¬, '
          +'¬thadty¬ : ¬'+%trim(THADTY)+'¬, '
          +'¬thadrf¬ : ¬'+%trim(THADRF)+'¬, '
          +'¬thaicd¬ : ¬'+%trim(THAICD)+'¬, '
          +'¬thaitx¬ : ¬'+%trim(THAITX)+'¬, '
          +'¬thtrch¬ : ¬'+%trim(THTRCH)+'¬, '
          +'¬thddt¬ : ¬'+%trim(%editc(THDDT:'Z'))+'¬, '
          +'¬thdkr¬ : ¬'+%trim(THDKR)+'¬, '
          +'¬thddtk¬ : ¬'+%trim(%editc(THDDTK:'Z'))+'¬, '
          +'¬thdats¬ : ¬'+%trim(THDATS)+'¬, '
          +'¬thdkav¬ : ¬'+%trim(THDKAV)+'¬, '
          +'¬thdktx¬ : ¬'+%trim(THDKTX)+'¬, '
          +'¬thtssd¬ : ¬'+%trim(THTSSD)+'¬, '
          +'¬thtsn1¬ : ¬'+%trim(THTSN1)+'¬, '
          +'¬thtsn2¬ : ¬'+%trim(THTSN2)+'¬, '
          +'¬thtspn¬ : ¬'+%trim(THTSPN)+'¬, '
          +'¬thtsps¬ : ¬'+%trim(THTSPS)+'¬, '
          +'¬thtslk¬ : ¬'+%trim(THTSLK)+'¬, '
          +'¬thtssk¬ : ¬'+%trim(THTSSK)+'¬, '
          +'¬thlstl¬ : ¬'+%trim(%editc(THLSTL:'Z'))+'¬, '
          +'¬thvpos¬ : ¬'+%trim(%editc(THVPOS:'Z'))+'¬, '
          +'¬thntk¬ : ¬'+%trim(%editc(THNTK:'Z'))+'¬, '
          +'¬thdst¬ : ¬'+%trim(THDST)+'¬, '
          +'¬thtarf¬ : ¬'+%trim(THTARF)+'¬, '
          +'¬thws¬ : ¬'+%trim(THWS)+'¬, '
          +'¬thlrn¬ : ¬'+%trim(THLRN)+'¬, '
          +'¬thtrnr¬ : ¬'+%trim(THTRNR)+'¬, '
          +'¬thtrdt¬ : ¬'+%trim(%editc(THTRDT:'Z'))+'¬, '
          +'¬thomd¬ : ¬'+%trim(%editc(THOMD:'Z'))+'¬, '
          +'¬thbind¬ : ¬'+%trim(THBIND)+'¬, '
          +'¬thtet¬ : ¬'+%trim(%editc(THTET:'Z'))+'¬, '
          +'¬thmf¬ : ¬'+%trim(THMF)+'¬, '
          +'¬thmp¬ : ¬'+%trim(%editc(THMP:'Z'))+'¬, '
          +'¬thpkl¬ : ¬'+%trim(THPKL)+'¬, '
          +'¬thkdv¬ : ¬'+%trim(THKDV)+'¬, '
          +'¬th0035¬ : ¬'+%trim(TH0035)+'¬,'
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     c                   call      'JSONFIX'
     c                   parm                    JSONstring
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * ............................................................................................
      * Skriv JSON-LISTE Start (en liste er EN parameter(fra [ til   )
      * ............................................................................................
     c                   eval      JSONstring ='"orderupdate" : ['
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-Liste/Array  Avslutning
      * ............................................................................................
     c                   eval      JSONstring =']'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     c                   eval      JSONstring ='}'
CB   C*                  callp     updHTMLvar('JSONstring':JSONstring)
CB   C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   callp     wrtsection('JSONlin')
      *
      * Quit
     C                   exsr      Exit


      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     NCTSEH
     C  N50              CLOSE     NCTSEH01
     C  N50              CLOSE     NCTSESTD
     C  N50              CLOSE     KODTSI
     C  N50              CLOSE     KODTSI1

      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   return
     C                   endsr
      *
      *********************************************************
     C     Parse         Begsr
      *********************************************************
      * Get input
     C                   EVAL      WSUSER   = zhbgetvar('USER')
     C                   EVAL      WA       = zhbgetvar('NEWAVD')
     C                   EVAL      NEWAVD   = c2n2(WA)
     C                   EVAL      NEWSIGN  = zhbgetvar('NEWSIGN')
     C                   EVAL      WMODE    = zhbgetvar('MODE')
     C                   EVAL      WSIGN    = zhbgetvar('SIGN')
     C                   EVAL      THST     = zhbgetvar('THST')
     C                   EVAL      WA       = zhbgetvar('THAVD')
     C                   EVAL      THAVD    = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THTDN')
     C                   EVAL      THTDN    = c2n2(WA)
     C                   EVAL      THSG     = zhbgetvar('THSG')
     C                   EVAL      WA       = zhbgetvar('THDT')
     C                   EVAL      THDT     = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THPRO')
     C                   EVAL      THPRO    = c2n2(WA)
     C                   EVAL      THENKL   = zhbgetvar('THENKL')
     C                   EVAL      THDK     = zhbgetvar('THDK')
     C                   EVAL      THDKT    = zhbgetvar('THDKT')
     C                   EVAL      THTIRN   = zhbgetvar('THTIRN')
     C                   EVAL      WA       = zhbgetvar('THSECU')
     C                   EVAL      THSECU   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THRDIN')
     C                   EVAL      THRDIN   = c2n2(WA)
     C                   EVAL      THSCIN   = zhbgetvar('THSCIN')
     C                   EVAL      THCLKD   = zhbgetvar('THCLKD')
     C                   EVAL      WA       = zhbgetvar('THBINI')
     C                   EVAL      THBINI   = c2n2(WA)
     C                   EVAL      THLIDT   = zhbgetvar('THLIDT')
     C                   EVAL      THATYP   = zhbgetvar('THATYP')
     C                   EVAL      THAREF   = zhbgetvar('THAREF')
     C                   EVAL      THCATS   = zhbgetvar('THCATS')
     C                   EVAL      THTSB    = zhbgetvar('THTSB')
     C                   EVAL      THTSD1   = zhbgetvar('THTSD1')
     C                   EVAL      WA       = zhbgetvar('THETA1')
     C                   EVAL      THETA1   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT1')
     C                   EVAL      THETAT1  = c2n2(WA)
     C                   EVAL      THTSD2   = zhbgetvar('THTSD2')
     C                   EVAL      WA       = zhbgetvar('THETA2')
     C                   EVAL      THETA2   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT2')
     C                   EVAL      THETAT2  = c2n2(WA)
     C                   EVAL      THTSD3   = zhbgetvar('THTSD3')
     C                   EVAL      WA       = zhbgetvar('THETA3')
     C                   EVAL      THETA3   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT3')
     C                   EVAL      THETAT3  = c2n2(WA)
     C                   EVAL      THTSD4   = zhbgetvar('THTSD4')
     C                   EVAL      WA       = zhbgetvar('THETA4')
     C                   EVAL      THETA4   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT4')
     C                   EVAL      THETAT4  = c2n2(WA)
     C                   EVAL      THTSD5   = zhbgetvar('THTSD5')
     C                   EVAL      WA       = zhbgetvar('THETA5')
     C                   EVAL      THETA5   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT5')
     C                   EVAL      THETAT5  = c2n2(WA)
     C                   EVAL      THTSD6   = zhbgetvar('THTSD6')
     C                   EVAL      WA       = zhbgetvar('THETA6')
     C                   EVAL      THETA6   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT6')
     C                   EVAL      THETAT6  = c2n2(WA)
     C                   EVAL      THTSD7   = zhbgetvar('THTSD7')
     C                   EVAL      WA       = zhbgetvar('THETA7')
     C                   EVAL      THETA7   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT7')
     C                   EVAL      THETAT7  = c2n2(WA)
     C                   EVAL      THTSD8   = zhbgetvar('THTSD8')
     C                   EVAL      WA       = zhbgetvar('THETA8')
     C                   EVAL      THETA8   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THETAT8')
     C                   EVAL      THETAT8  = c2n2(WA)
     C                   EVAL      THTSDE   = zhbgetvar('THTSDE')
     C                   EVAL      WA       = zhbgetvar('THKNH')
     C                   EVAL      THKNH    = c2n2(WA)
     C                   EVAL      THTINH   = zhbgetvar('THTINH')
     C                   EVAL      THTIRH   = zhbgetvar('THTIRH')
     C                   EVAL      THNAH    = zhbgetvar('THNAH')
     C                   EVAL      THAD1H   = zhbgetvar('THAD1H')
     C                   EVAL      THPNH    = zhbgetvar('THPNH')
     C                   EVAL      THPSH    = zhbgetvar('THPSH')
     C                   EVAL      THLKH    = zhbgetvar('THLKH')
     C                   EVAL      THCPH    = zhbgetvar('THCPH')
     C                   EVAL      THTLH    = zhbgetvar('THTLH')
     C                   EVAL      THEMH    = zhbgetvar('THEMH')
     C                   EVAL      WA       = zhbgetvar('THKNA')
     C                   EVAL      THKNA    = c2n2(WA)
     C                   EVAL      THTINA   = zhbgetvar('THTINA')
     C                   EVAL      WA       = zhbgetvar('THSTA')
     C                   EVAL      THSTA    = c2n2(WA)
     C                   EVAL      THCPA    = zhbgetvar('THCPA')
     C                   EVAL      THTLA    = zhbgetvar('THTLA')
     C                   EVAL      THEMA    = zhbgetvar('THEMA')
     C*                  EVAL      WA       = zhbgetvar('THGKD')
     C*                  EVAL      THGKD    = c2n2(WA)
     C                   EVAL      THGKD    = zhbgetvar('THGKD')
     C                   EVAL      THGFT1   = zhbgetvar('THGFT1')
     C                   EVAL      THGFT2   = zhbgetvar('THGFT2')
     C                   EVAL      THGADK   = zhbgetvar('THGADK')
     C                   EVAL      WA       = zhbgetvar('THGBL')
     C                   EVAL      THGBL    = c2n2(WA)
     C                   EVAL      THGVK    = zhbgetvar('THGVK')
     C                   EVAL      THALK    = zhbgetvar('THALK')
     C                   EVAL      THBLK    = zhbgetvar('THBLK')
     C                   EVAL      THKDC    = zhbgetvar('THKDC')
     C                   EVAL      WA       = zhbgetvar('THTMIN')
     C                   EVAL      THTMIN   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THTMGR')
     C                   EVAL      THTMGR   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THVKB')
     C                   EVAL      THVKB    = c2n2(WA)
     C                   EVAL      THUCR    = zhbgetvar('THUCR')
     C                   EVAL      THTINC   = zhbgetvar('THTINC')
     C                   EVAL      WA       = zhbgetvar('THKNC')
     C                   EVAL      THKNC    = c2n2(WA)
     C                   EVAL      THNAC    = zhbgetvar('THNAC')
     C                   EVAL      THTLC    = zhbgetvar('THTLC')
     C                   EVAL      THEMC    = zhbgetvar('THEMC')
     C                   EVAL      WA       = zhbgetvar('THKNS')
     C                   EVAL      THKNS    = c2n2(WA)
     C                   EVAL      THTINS   = zhbgetvar('THTINS')
     C                   EVAL      THNAS    = zhbgetvar('THNAS')
     C                   EVAL      THAD1S   = zhbgetvar('THAD1S')
     C                   EVAL      THPNS    = zhbgetvar('THPNS')
     C                   EVAL      THPSS    = zhbgetvar('THPSS')
     C                   EVAL      THLKS    = zhbgetvar('THLKS')
     C                   EVAL      THCPS    = zhbgetvar('THCPS')
     C                   EVAL      THTLS    = zhbgetvar('THTLS')
     C                   EVAL      THEMS    = zhbgetvar('THEMS')
     C                   EVAL      WA       = zhbgetvar('THKNK')
     C                   EVAL      THKNK    = c2n2(WA)
     C                   EVAL      THTINK   = zhbgetvar('THTINK')
     C                   EVAL      THNAK    = zhbgetvar('THNAK')
     C                   EVAL      THAD1K   = zhbgetvar('THAD1K')
     C                   EVAL      THPNK    = zhbgetvar('THPNK')
     C                   EVAL      THPSK    = zhbgetvar('THPSK')
     C                   EVAL      THLKK    = zhbgetvar('THLKK')
     C                   EVAL      THROLE   = zhbgetvar('THROLE')
     C                   EVAL      THIDR    = zhbgetvar('THIDR')
     C                   EVAL      THCNR    = zhbgetvar('THCNR')
     C                   EVAL      WA       = zhbgetvar('THDANT')
     C                   EVAL      THDANT   = c2n2(WA)
     C                   EVAL      THDFKD   = zhbgetvar('THDFKD')
     C                   EVAL      WA       = zhbgetvar('THGINR')
     C                   EVAL      THGINR   = c2n2(WA)
     C                   EVAL      THLGTY   = zhbgetvar('THLGTY')
     C                   EVAL      THLGID   = zhbgetvar('THLGID')
     C                   EVAL      THLGAU   = zhbgetvar('THLGAU')
     C                   EVAL      THLGAI   = zhbgetvar('THLGAI')
     C                   EVAL      THLGUN   = zhbgetvar('THLGUN')
     C                   EVAL      THLGTS   = zhbgetvar('THLGTS')
     C                   EVAL      THLGLA   = zhbgetvar('THLGLA')
     C                   EVAL      THLGLO   = zhbgetvar('THLGLO')
     C                   EVAL      WA       = zhbgetvar('THKNE')
     C                   EVAL      THKNE    = c2n2(WA)
     C                   EVAL      THTINE   = zhbgetvar('THTINE')
     C                   EVAL      THADE1   = zhbgetvar('THADE1')
     C                   EVAL      THPNE    = zhbgetvar('THPNE')
     C                   EVAL      THPSE    = zhbgetvar('THPSE')
     C                   EVAL      THLKE    = zhbgetvar('THLKE')
     C                   EVAL      THADE2   = zhbgetvar('THADE2')
     C                   EVAL      THPNE2   = zhbgetvar('THPNE2')
     C                   EVAL      THLKE2   = zhbgetvar('THLKE2')
     C                   EVAL      THCPE    = zhbgetvar('THCPE')
     C                   EVAL      THTLE    = zhbgetvar('THTLE')
     C                   EVAL      THEME    = zhbgetvar('THEME')
     C                   EVAL      WA       = zhbgetvar('THTRM')
     C                   EVAL      THTRM    = c2n2(WA)
     C                   EVAL      THTAID   = zhbgetvar('THTAID')
     C                   EVAL      THTALK   = zhbgetvar('THTALK')
     C                   EVAL      THLKR1   = zhbgetvar('THLKR1')
     C                   EVAL      THLKR2   = zhbgetvar('THLKR2')
     C                   EVAL      THLKR3   = zhbgetvar('THLKR3')
     C                   EVAL      THLKR4   = zhbgetvar('THLKR4')
     C                   EVAL      THLKR5   = zhbgetvar('THLKR5')
     C                   EVAL      THLKR6   = zhbgetvar('THLKR6')
     C                   EVAL      THTGTS   = zhbgetvar('THTGTS')
     C                   EVAL      WA       = zhbgetvar('THTRMG')
     C                   EVAL      THTRMG   = c2n2(WA)
     C                   EVAL      THTGID   = zhbgetvar('THTGID')
     C                   EVAL      THTGLK   = zhbgetvar('THTGLK')
     C                   EVAL      THTGCN   = zhbgetvar('THTGCN')
     C                   EVAL      THLSUN   = zhbgetvar('THLSUN')
     C                   EVAL      THLSLK   = zhbgetvar('THLSLK')
     C                   EVAL      THLSNA   = zhbgetvar('THLSNA')
     C                   EVAL      THLOUN   = zhbgetvar('THLOUN')
     C                   EVAL      THLOLK   = zhbgetvar('THLOLK')
     C                   EVAL      THLONA   = zhbgetvar('THLONA')
     C                   EVAL      THPDTY   = zhbgetvar('THPDTY')
     C                   EVAL      THPDRF   = zhbgetvar('THPDRF')
     C                   EVAL      THPDIN   = zhbgetvar('THPDIN')
     C                   EVAL      THSDTY   = zhbgetvar('THSDTY')
     C                   EVAL      THSDRF   = zhbgetvar('THSDRF')
     C                   EVAL      WA       = zhbgetvar('THSDLN')
     C                   EVAL      THSDLN   = c2n2(WA)
     C                   EVAL      THSDIN   = zhbgetvar('THSDIN')
     C                   EVAL      THTDTY   = zhbgetvar('THTDTY')
     C                   EVAL      THTDRF   = zhbgetvar('THTDRF')
     C                   EVAL      THADTY   = zhbgetvar('THADTY')
     C                   EVAL      THADRF   = zhbgetvar('THADRF')
     C                   EVAL      THAICD   = zhbgetvar('THAICD')
     C                   EVAL      THAITX   = zhbgetvar('THAITX')
     C                   EVAL      THTRCH   = zhbgetvar('THTRCH')
     C                   EVAL      WA       = zhbgetvar('THDDT')
     C                   EVAL      THDDT    = c2n2(WA)
     C                   EVAL      THDKR    = zhbgetvar('THDKR')
     C                   EVAL      WA       = zhbgetvar('THDDTK')
     C                   EVAL      THDDTK   = c2n2(WA)
     C                   EVAL      THDATS   = zhbgetvar('THDATS')
     C                   EVAL      THDKAV   = zhbgetvar('THDKAV')
     C                   EVAL      THDKTX   = zhbgetvar('THDKTX')
     C                   EVAL      THTSSD   = zhbgetvar('THTSSD')
     C                   EVAL      THTSN1   = zhbgetvar('THTSN1')
     C                   EVAL      THTSN2   = zhbgetvar('THTSN2')
     C                   EVAL      THTSPN   = zhbgetvar('THTSPN')
     C                   EVAL      THTSPS   = zhbgetvar('THTSPS')
     C                   EVAL      THTSLK   = zhbgetvar('THTSLK')
     C                   EVAL      THTSSK   = zhbgetvar('THTSSK')
     C                   EVAL      WA       = zhbgetvar('THLSTL')
     C                   EVAL      THLSTL   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THVPOS')
     C                   EVAL      THVPOS   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THNTK')
     C                   EVAL      THNTK    = c2n2(WA)
     C                   EVAL      THDST    = zhbgetvar('THDST')
     C                   EVAL      THTARF   = zhbgetvar('THTARF')
     C                   EVAL      THWS     = zhbgetvar('THWS')
     C                   EVAL      THLRN    = zhbgetvar('THLRN')
     C                   EVAL      THTRNR   = zhbgetvar('THTRNR')
     C                   EVAL      WA       = zhbgetvar('THTRDT')
     C                   EVAL      THTRDT   = c2n2(WA)
     C                   EVAL      WA       = zhbgetvar('THOMD')
     C                   EVAL      THOMD    = c2n2(WA)
     C                   EVAL      THBIND   = zhbgetvar('THBIND')
     C                   EVAL      WA       = zhbgetvar('THTET')
     C                   EVAL      THTET    = c2n2(WA)
     C                   EVAL      THMF     = zhbgetvar('THMF')
     C                   EVAL      WA       = zhbgetvar('THMP')
     C                   EVAL      THMP     = c2n2(WA)
     C                   EVAL      THPKL    = zhbgetvar('THPKL')
     C                   EVAL      THKDV    = zhbgetvar('THKDV')
     C                   EVAL      TH0035   = zhbgetvar('TH0035')
     c                   ENDSR
      *********************************************************
     C     INIT          Begsr
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C  N50BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C                   call      BILIBL
     C                   end

     C     TRUHKEY       klist
     C                   kfld                    THAVD
     C                   kfld                    THTDN
     C     TRUHKEYG      klist
     C                   kfld                    GM_THAVD
     C                   kfld                    GM_THTDN
     C     KODTSIK       klist
     C                   kfld                    KSIUNI
     C                   kfld                    THSG
     C                   EVAL      KSIUNI = 'SI'
     C     *LIKE         DEFINE    X_THAVD       GM_THAVD
     C     *LIKE         DEFINE    X_THTDN       GM_THTDN
      *
     C   50              eval      Error = 'Invalid userID'
     C  N50              OPEN      NCTSEH
     C  N50              OPEN      NCTSEH01
     C  N50              OPEN      NCTSESTD
     C  N50              OPEN      KODTSI
     C  N50              OPEN      KODTSI1
      *_________________________________________________
      * Dummy read av NCTSEH01 for å få feltdefinisjoner
      *"""""""""""""""""""""""""""""""""""""""""""""""""
     C                   IF        *IN50
     C  N50              READ      NCTSEH01
     C                   ENDIF
      *_________________________________
      * Hæmta dagens datum och klockslag
      *"""""""""""""""""""""""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C  N50KODTSIK       CHAIN     KODTSI                             33
     C                   MOVEL     KSINAV        THTARF

     c                   endsr
      *
      *______________________________________________________
      * TEST                                             TEST
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     TEST          BEGSR
      * Hæmta userid
     C     WSUSER        CHAIN     KODTSI1
      * Hæmta ærende
     C     WMODE         IFNE      'A'
     C     TRUHKEY       CHAIN     NCTSEH                             55
N01  C                   ELSE
N01  C                   EVAL      *IN55 = *ON
     C                   ENDIF
      * MODE A=Add  D=Delete  U=Update
     C                   SELECT
     C     WMODE         WHENEQ    'A'
     C                   eval      Error = *blanks
     C                   EXSR      SRA
     C     WMODE         WHENEQ    'C'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   UPDATE    NCTSEHR
     C                   eval      Error = *blanks
     C                   EXSR      SRC
     C                   ENDIF
     C     WMODE         WHENEQ    'D'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRD
     C                   ENDIF
     C     WMODE         WHENEQ    'S'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRS
     C                   ENDIF
     C     WMODE         WHENEQ    'U'
     C                   IF        *IN55=*ON
     C                   eval      Error = 'Order not found'
     C                   ELSE
     C                   eval      Error = *blanks
     C                   EXSR      SRU
     C                   ENDIF
     C                   OTHER
N01  C  N55              UPDATE    NCTSEHR
     C                   eval      Error = 'Wrong mode'
     C                   ENDSL
     C                   ENDSR
      *______________________________________________________
      * Add                                               SRA
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRA           BEGSR
     C                   CLEAR                   NCTSEHR
      * Hæmta uppdragsnummer
     C     THAVD         CHAIN     NCTSESTD                           52
     C                   ADD       1             X_THTDN
     C                   UPDATE    NCTSESTDr
N02  C                   SUB       1             X_THTDN
     C                   EVAL      THTDN    = X_THTDN
     C                   EVAL      THST     = ' '
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = WSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
      * Write
     C                   WRITE     NCTSEHR
      * Oppdater WEB-variabler
     C                   EVAL      THST     = X_THST
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THDKT    = X_THDKT
     C                   EVAL      THTIRN   = X_THTIRN
     C                   EVAL      THSECU   = X_THSECU
     C                   EVAL      THRDIN   = X_THRDIN
     C                   EVAL      THSCIN   = X_THSCIN
     C                   EVAL      THCLKD   = X_THCLKD
     C                   EVAL      THBINI   = X_THBINI
     C                   EVAL      THLIDT   = X_THLIDT
     C                   EVAL      THATYP   = X_THATYP
     C                   EVAL      THAREF   = X_THAREF
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THETA1   = X_THETA1
     C                   EVAL      THETAT1  = X_THETAT1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THETA2   = X_THETA2
     C                   EVAL      THETAT2  = X_THETAT2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THETA3   = X_THETA3
     C                   EVAL      THETAT3  = X_THETAT3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THETA4   = X_THETA4
     C                   EVAL      THETAT4  = X_THETAT4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THETA5   = X_THETA5
     C                   EVAL      THETAT5  = X_THETAT5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THETA6   = X_THETA6
     C                   EVAL      THETAT6  = X_THETAT6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THETA7   = X_THETA7
     C                   EVAL      THETAT7  = X_THETAT7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THETA8   = X_THETA8
     C                   EVAL      THETAT8  = X_THETAT8
     C                   EVAL      THTSDE   = X_THTSDE
     C                   EVAL      THKNH    = X_THKNH
     C                   EVAL      THTINH   = X_THTINH
     C                   EVAL      THTIRH   = X_THTIRH
     C                   EVAL      THNAH    = X_THNAH
     C                   EVAL      THAD1H   = X_THAD1H
     C                   EVAL      THPNH    = X_THPNH
     C                   EVAL      THPSH    = X_THPSH
     C                   EVAL      THLKH    = X_THLKH
     C                   EVAL      THCPH    = X_THCPH
     C                   EVAL      THTLH    = X_THTLH
     C                   EVAL      THEMH    = X_THEMH
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THSTA    = X_THSTA
     C                   EVAL      THCPA    = X_THCPA
     C                   EVAL      THTLA    = X_THTLA
     C                   EVAL      THEMA    = X_THEMA
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTMIN   = X_THTMIN
     C                   EVAL      THTMGR   = X_THTMGR
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THUCR    = X_THUCR
     C                   EVAL      THTINC   = X_THTINC
     C                   EVAL      THKNC    = X_THKNC
     C                   EVAL      THNAC    = X_THNAC
     C                   EVAL      THTLC    = X_THTLC
     C                   EVAL      THEMC    = X_THEMC
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THAD1S   = X_THAD1S
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THCPS    = X_THCPS
     C                   EVAL      THTLS    = X_THTLS
     C                   EVAL      THEMS    = X_THEMS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THAD1K   = X_THAD1K
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THROLE   = X_THROLE
     C                   EVAL      THIDR    = X_THIDR
     C                   EVAL      THCNR    = X_THCNR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THGINR   = X_THGINR
     C                   EVAL      THLGTY   = X_THLGTY
     C                   EVAL      THLGID   = X_THLGID
     C                   EVAL      THLGAU   = X_THLGAU
     C                   EVAL      THLGAI   = X_THLGAI
     C                   EVAL      THLGUN   = X_THLGUN
     C                   EVAL      THLGTS   = X_THLGTS
     C                   EVAL      THLGLA   = X_THLGLA
     C                   EVAL      THLGLO   = X_THLGLO
     C                   EVAL      THKNE    = X_THKNE
     C                   EVAL      THTINE   = X_THTINE
     C                   EVAL      THADE1   = X_THADE1
     C                   EVAL      THPNE    = X_THPNE
     C                   EVAL      THPSE    = X_THPSE
     C                   EVAL      THLKE    = X_THLKE
     C                   EVAL      THADE2   = X_THADE2
     C                   EVAL      THPNE2   = X_THPNE2
     C                   EVAL      THLKE2   = X_THLKE2
     C                   EVAL      THCPE    = X_THCPE
     C                   EVAL      THTLE    = X_THTLE
     C                   EVAL      THEME    = X_THEME
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THTGTS   = X_THTGTS
     C                   EVAL      THTRMG   = X_THTRMG
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THTGCN   = X_THTGCN
     C                   EVAL      THLSUN   = X_THLSUN
     C                   EVAL      THLSLK   = X_THLSLK
     C                   EVAL      THLSNA   = X_THLSNA
     C                   EVAL      THLOUN   = X_THLOUN
     C                   EVAL      THLOLK   = X_THLOLK
     C                   EVAL      THLONA   = X_THLONA
     C                   EVAL      THPDTY   = X_THPDTY
     C                   EVAL      THPDRF   = X_THPDRF
     C                   EVAL      THPDIN   = X_THPDIN
     C                   EVAL      THSDTY   = X_THSDTY
     C                   EVAL      THSDRF   = X_THSDRF
     C                   EVAL      THSDLN   = X_THSDLN
     C                   EVAL      THSDIN   = X_THSDIN
     C                   EVAL      THTDTY   = X_THTDTY
     C                   EVAL      THTDRF   = X_THTDRF
     C                   EVAL      THADTY   = X_THADTY
     C                   EVAL      THADRF   = X_THADRF
     C                   EVAL      THAICD   = X_THAICD
     C                   EVAL      THAITX   = X_THAITX
     C                   EVAL      THTRCH   = X_THTRCH
     C                   EVAL      THDDT    = X_THDDT
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDDTK   = X_THDDTK
     C                   EVAL      THDATS   = X_THDATS
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKTX   = X_THDKTX
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSPS   = X_THTSPS
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THLRN    = X_THLRN
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
     C                   IF        THDDT    > *ZEROS
     C                   EXSR      SRDATPLU
     C                   ENDIF

     C                   ENDSR
      *______________________________________________________
      * Copy                                              SRC
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRC           BEGSR
     C                   EVAL      WSIGN = X_THSG
      * Hæmta uppdragsnummer
     C     NEWAVD        CHAIN     NCTSESTD                           52
     C                   ADD       1             X_THTDN
     C                   UPDATE    NCTSESTDR
N02  C                   SUB       1             X_THTDN
     C                   EVAL      NEWOPD   = X_THTDN
      *
     C                   EVAL      GM_THAVD = THAVD
     C                   EVAL      GM_THTDN = THTDN
     C     TRUHKEYG      CHAIN(N)  NCTSEH                             55
     C                   EVAL      X_THAVD  = NEWAVD
     C                   EVAL      X_THTDN  = NEWOPD
     C                   EVAL      THAVD    = NEWAVD
     C                   EVAL      THTDN    = NEWOPD
     C                   EVAL      X_THST   = ' '
     C                   EVAL      X_THSG   = NEWSIGN
     C                   MOVEL     WDT           X_THDT
     C                   MOVEL     WDT           THDT
     C                   EVAL      X_THTRNR = *BLANKS
     C                   EVAL      X_THTRDT = 0
     C                   EVAL      X_THOMD  = 0
     C                   EVAL      X_THBIND = *BLANKS
     C                   EVAL      X_THMF   = *BLANKS
     C                   EVAL      X_THMP   = 0
      * Write
     C                   WRITE     NCTSEHR
      * Oppdater WEB-variabler
     C                   EVAL      THST     = X_THST
     C                   EVAL      THSG     = X_THSG
     C                   EVAL      THDT     = X_THDT
     C                   EVAL      THPRO    = X_THPRO
     C                   EVAL      THENKL   = X_THENKL
     C                   EVAL      THDK     = X_THDK
     C                   EVAL      THDKT    = X_THDKT
     C                   EVAL      THTIRN   = X_THTIRN
     C                   EVAL      THSECU   = X_THSECU
     C                   EVAL      THRDIN   = X_THRDIN
     C                   EVAL      THSCIN   = X_THSCIN
     C                   EVAL      THCLKD   = X_THCLKD
     C                   EVAL      THBINI   = X_THBINI
     C                   EVAL      THLIDT   = X_THLIDT
     C                   EVAL      THATYP   = X_THATYP
     C                   EVAL      THAREF   = X_THAREF
     C                   EVAL      THCATS   = X_THCATS
     C                   EVAL      THTSB    = X_THTSB
     C                   EVAL      THTSD1   = X_THTSD1
     C                   EVAL      THETA1   = X_THETA1
     C                   EVAL      THETAT1  = X_THETAT1
     C                   EVAL      THTSD2   = X_THTSD2
     C                   EVAL      THETA2   = X_THETA2
     C                   EVAL      THETAT2  = X_THETAT2
     C                   EVAL      THTSD3   = X_THTSD3
     C                   EVAL      THETA3   = X_THETA3
     C                   EVAL      THETAT3  = X_THETAT3
     C                   EVAL      THTSD4   = X_THTSD4
     C                   EVAL      THETA4   = X_THETA4
     C                   EVAL      THETAT4  = X_THETAT4
     C                   EVAL      THTSD5   = X_THTSD5
     C                   EVAL      THETA5   = X_THETA5
     C                   EVAL      THETAT5  = X_THETAT5
     C                   EVAL      THTSD6   = X_THTSD6
     C                   EVAL      THETA6   = X_THETA6
     C                   EVAL      THETAT6  = X_THETAT6
     C                   EVAL      THTSD7   = X_THTSD7
     C                   EVAL      THETA7   = X_THETA7
     C                   EVAL      THETAT7  = X_THETAT7
     C                   EVAL      THTSD8   = X_THTSD8
     C                   EVAL      THETA8   = X_THETA8
     C                   EVAL      THETAT8  = X_THETAT8
     C                   EVAL      THTSDE   = X_THTSDE
     C                   EVAL      THKNH    = X_THKNH
     C                   EVAL      THTINH   = X_THTINH
     C                   EVAL      THTIRH   = X_THTIRH
     C                   EVAL      THNAH    = X_THNAH
     C                   EVAL      THAD1H   = X_THAD1H
     C                   EVAL      THPNH    = X_THPNH
     C                   EVAL      THPSH    = X_THPSH
     C                   EVAL      THLKH    = X_THLKH
     C                   EVAL      THCPH    = X_THCPH
     C                   EVAL      THTLH    = X_THTLH
     C                   EVAL      THEMH    = X_THEMH
     C                   EVAL      THKNA    = X_THKNA
     C                   EVAL      THTINA   = X_THTINA
     C                   EVAL      THSTA    = X_THSTA
     C                   EVAL      THCPA    = X_THCPA
     C                   EVAL      THTLA    = X_THTLA
     C                   EVAL      THEMA    = X_THEMA
     C                   EVAL      THGKD    = X_THGKD
     C                   EVAL      THGFT1   = X_THGFT1
     C                   EVAL      THGFT2   = X_THGFT2
     C                   EVAL      THGADK   = X_THGADK
     C                   EVAL      THGBL    = X_THGBL
     C                   EVAL      THGVK    = X_THGVK
     C                   EVAL      THALK    = X_THALK
     C                   EVAL      THBLK    = X_THBLK
     C                   EVAL      THKDC    = X_THKDC
     C                   EVAL      THTMIN   = X_THTMIN
     C                   EVAL      THTMGR   = X_THTMGR
     C                   EVAL      THVKB    = X_THVKB
     C                   EVAL      THUCR    = X_THUCR
     C                   EVAL      THTINC   = X_THTINC
     C                   EVAL      THKNC    = X_THKNC
     C                   EVAL      THNAC    = X_THNAC
     C                   EVAL      THTLC    = X_THTLC
     C                   EVAL      THEMC    = X_THEMC
     C                   EVAL      THKNS    = X_THKNS
     C                   EVAL      THTINS   = X_THTINS
     C                   EVAL      THNAS    = X_THNAS
     C                   EVAL      THAD1S   = X_THAD1S
     C                   EVAL      THPNS    = X_THPNS
     C                   EVAL      THPSS    = X_THPSS
     C                   EVAL      THLKS    = X_THLKS
     C                   EVAL      THCPS    = X_THCPS
     C                   EVAL      THTLS    = X_THTLS
     C                   EVAL      THEMS    = X_THEMS
     C                   EVAL      THKNK    = X_THKNK
     C                   EVAL      THTINK   = X_THTINK
     C                   EVAL      THNAK    = X_THNAK
     C                   EVAL      THAD1K   = X_THAD1K
     C                   EVAL      THPNK    = X_THPNK
     C                   EVAL      THPSK    = X_THPSK
     C                   EVAL      THLKK    = X_THLKK
     C                   EVAL      THROLE   = X_THROLE
     C                   EVAL      THIDR    = X_THIDR
     C                   EVAL      THCNR    = X_THCNR
     C                   EVAL      THDANT   = X_THDANT
     C                   EVAL      THDFKD   = X_THDFKD
     C                   EVAL      THGINR   = X_THGINR
     C                   EVAL      THLGTY   = X_THLGTY
     C                   EVAL      THLGID   = X_THLGID
     C                   EVAL      THLGAU   = X_THLGAU
     C                   EVAL      THLGAI   = X_THLGAI
     C                   EVAL      THLGUN   = X_THLGUN
     C                   EVAL      THLGTS   = X_THLGTS
     C                   EVAL      THLGLA   = X_THLGLA
     C                   EVAL      THLGLO   = X_THLGLO
     C                   EVAL      THKNE    = X_THKNE
     C                   EVAL      THTINE   = X_THTINE
     C                   EVAL      THADE1   = X_THADE1
     C                   EVAL      THPNE    = X_THPNE
     C                   EVAL      THPSE    = X_THPSE
     C                   EVAL      THLKE    = X_THLKE
     C                   EVAL      THADE2   = X_THADE2
     C                   EVAL      THPNE2   = X_THPNE2
     C                   EVAL      THLKE2   = X_THLKE2
     C                   EVAL      THCPE    = X_THCPE
     C                   EVAL      THTLE    = X_THTLE
     C                   EVAL      THEME    = X_THEME
     C                   EVAL      THTRM    = X_THTRM
     C                   EVAL      THTAID   = X_THTAID
     C                   EVAL      THTALK   = X_THTALK
     C                   EVAL      THLKR1   = X_THLKR1
     C                   EVAL      THLKR2   = X_THLKR2
     C                   EVAL      THLKR3   = X_THLKR3
     C                   EVAL      THLKR4   = X_THLKR4
     C                   EVAL      THLKR5   = X_THLKR5
     C                   EVAL      THLKR6   = X_THLKR6
     C                   EVAL      THTGTS   = X_THTGTS
     C                   EVAL      THTRMG   = X_THTRMG
     C                   EVAL      THTGID   = X_THTGID
     C                   EVAL      THTGLK   = X_THTGLK
     C                   EVAL      THTGCN   = X_THTGCN
     C                   EVAL      THLSUN   = X_THLSUN
     C                   EVAL      THLSLK   = X_THLSLK
     C                   EVAL      THLSNA   = X_THLSNA
     C                   EVAL      THLOUN   = X_THLOUN
     C                   EVAL      THLOLK   = X_THLOLK
     C                   EVAL      THLONA   = X_THLONA
     C                   EVAL      THPDTY   = X_THPDTY
     C                   EVAL      THPDRF   = X_THPDRF
     C                   EVAL      THPDIN   = X_THPDIN
     C                   EVAL      THSDTY   = X_THSDTY
     C                   EVAL      THSDRF   = X_THSDRF
     C                   EVAL      THSDLN   = X_THSDLN
     C                   EVAL      THSDIN   = X_THSDIN
     C                   EVAL      THTDTY   = X_THTDTY
     C                   EVAL      THTDRF   = X_THTDRF
     C                   EVAL      THADTY   = X_THADTY
     C                   EVAL      THADRF   = X_THADRF
     C                   EVAL      THAICD   = X_THAICD
     C                   EVAL      THAITX   = X_THAITX
     C                   EVAL      THTRCH   = X_THTRCH
     C                   EVAL      THDDT    = X_THDDT
     C                   EVAL      THDKR    = X_THDKR
     C                   EVAL      THDDTK   = X_THDDTK
     C                   EVAL      THDATS   = X_THDATS
     C                   EVAL      THDKAV   = X_THDKAV
     C                   EVAL      THDKTX   = X_THDKTX
     C                   EVAL      THTSSD   = X_THTSSD
     C                   EVAL      THTSN1   = X_THTSN1
     C                   EVAL      THTSN2   = X_THTSN2
     C                   EVAL      THTSPN   = X_THTSPN
     C                   EVAL      THTSPS   = X_THTSPS
     C                   EVAL      THTSLK   = X_THTSLK
     C                   EVAL      THTSSK   = X_THTSSK
     C                   EVAL      THLSTL   = X_THLSTL
     C                   EVAL      THVPOS   = X_THVPOS
     C                   EVAL      THNTK    = X_THNTK
     C                   EVAL      THDST    = X_THDST
     C                   EVAL      THTARF   = X_THTARF
     C                   EVAL      THWS     = X_THWS
     C                   EVAL      THLRN    = X_THLRN
     C                   EVAL      THTRNR   = X_THTRNR
     C                   EVAL      THTRDT   = X_THTRDT
     C                   EVAL      THOMD    = X_THOMD
     C                   EVAL      THBIND   = X_THBIND
     C                   EVAL      THTET    = X_THTET
     C                   EVAL      THMF     = X_THMF
     C                   EVAL      THMP     = X_THMP
     C                   EVAL      THPKL    = X_THPKL
     C                   EVAL      THKDV    = X_THKDV
     C                   EVAL      TH0035   = X_TH0035
      * Kopiera också varuposter
     C                   OPEN      NCTSEC
     C                   OPEN      NCTSECAM
     C                   OPEN      TRUVVT
     C                   OPEN      TRUVDK
     C                   OPEN      TRUVCN
     C                   OPEN      TRUVMN

     C     TRUHKEYG      SETLL     NCTSEC
     C     TRUHKEYG      READE     NCTSEC                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     NCTSECR
     C     TRUHKEYG      READE     NCTSEC                                 52
     C                   ENDDO

     C     TRUHKEYG      SETLL     NCTSECAM
     C     TRUHKEYG      READE     NCTSECAM                               52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     NCTSECAMR
     C     TRUHKEYG      READE     NCTSECAM                               52
     C                   ENDDO

     C     TRUHKEYG      SETLL     TRUVVT
     C     TRUHKEYG      READE     TRUVVT                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     TRUVVTR
     C     TRUHKEYG      READE     TRUVVT                                 52
     C                   ENDDO

     C     TRUHKEYG      SETLL     TRUVDK
     C     TRUHKEYG      READE     TRUVDK                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     TRUVDKR
     C     TRUHKEYG      READE     TRUVDK                                 52
     C                   ENDDO

     C     TRUHKEYG      SETLL     TRUVCN
     C     TRUHKEYG      READE     TRUVCN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     TRUVCNR
     C     TRUHKEYG      READE     TRUVCN                                 52
     C                   ENDDO

     C     TRUHKEYG      SETLL     TRUVMN
     C     TRUHKEYG      READE     TRUVMN                                 52
     C     *IN52         DOWEQ     *OFF
     C                   EVAL      TVAVD = NEWAVD
     C                   EVAL      TVTDN = NEWOPD
     C                   WRITE     TRUVMNR
     C     TRUHKEYG      READE     TRUVMN                                 52
     C                   ENDDO

     C                   CLOSE     NCTSEC
     C                   CLOSE     NCTSECAM
     C                   CLOSE     TRUVVT
     C                   CLOSE     TRUVDK
     C                   CLOSE     TRUVCN
     C                   CLOSE     TRUVMN

     C                   ENDSR
      *______________________________________________________
      * Delete                                            SRD
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRD           BEGSR
     C                   EVAL      X_THST    = 'D'
     C                   EVAL      THST      = 'D'
     C                   UPDATE    NCTSEHR
     C                   ENDSR
      *______________________________________________________
      * Skicka                                            SRS
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRS           BEGSR
     C                   eval      Error = *blanks
     C                   UPDATE    NCTSEHR
      *____________________
      * Skapa edifact + fil
      *""""""""""""""""""""
     C                   CALL      'SVX013R'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM      '015'         X1N07             3
     C                   PARM                    UFLAGG            1 0
     C                   ENDSR
      *______________________________________________________
      * Update                                            SRU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRU           BEGSR
     C                   EVAL      X_THST    =  THST
     C                   EVAL      X_THPRO   =  THPRO
     C                   EVAL      X_THENKL  =  THENKL
     C                   EVAL      X_THDK    =  THDK
     C                   EVAL      X_THDKT   =  THDKT
     C                   EVAL      X_THTIRN  =  THTIRN
     C                   EVAL      X_THSECU  =  THSECU
     C                   EVAL      X_THRDIN  =  THRDIN
     C                   EVAL      X_THSCIN  =  THSCIN
     C                   EVAL      X_THCLKD  =  THCLKD
     C                   EVAL      X_THBINI  =  THBINI
     C                   EVAL      X_THLIDT  =  THLIDT
     C                   EVAL      X_THATYP  =  THATYP
     C                   EVAL      X_THAREF  =  THAREF
     C                   EVAL      X_THCATS  =  THCATS
     C                   EVAL      X_THTSB   =  THTSB
     C                   EVAL      X_THTSD1  =  THTSD1
     C                   EVAL      X_THETA1  =  THETA1
     C                   EVAL      X_THETAT1 =  THETAT1
     C                   EVAL      X_THTSD2  =  THTSD2
     C                   EVAL      X_THETA2  =  THETA2
     C                   EVAL      X_THETAT2 =  THETAT2
     C                   EVAL      X_THTSD3  =  THTSD3
     C                   EVAL      X_THETA3  =  THETA3
     C                   EVAL      X_THETAT3 =  THETAT3
     C                   EVAL      X_THTSD4  =  THTSD4
     C                   EVAL      X_THETA4  =  THETA4
     C                   EVAL      X_THETAT4 =  THETAT4
     C                   EVAL      X_THTSD5  =  THTSD5
     C                   EVAL      X_THETA5  =  THETA5
     C                   EVAL      X_THETAT5 =  THETAT5
     C                   EVAL      X_THTSD6  =  THTSD6
     C                   EVAL      X_THETA6  =  THETA6
     C                   EVAL      X_THETAT6 =  THETAT6
     C                   EVAL      X_THTSD7  =  THTSD7
     C                   EVAL      X_THETA7  =  THETA7
     C                   EVAL      X_THETAT7 =  THETAT7
     C                   EVAL      X_THTSD8  =  THTSD8
     C                   EVAL      X_THETA8  =  THETA8
     C                   EVAL      X_THETAT8 =  THETAT8
     C                   EVAL      X_THTSDE  =  THTSDE
     C                   EVAL      X_THKNH   =  THKNH
     C                   EVAL      X_THTINH  =  THTINH
     C                   EVAL      X_THTIRH =   THTIRH
     C                   EVAL      X_THNAH  =   THNAH
     C                   EVAL      X_THAD1H =   THAD1H
     C                   EVAL      X_THPNH  =   THPNH
     C                   EVAL      X_THPSH  =   THPSH
     C                   EVAL      X_THLKH  =   THLKH
     C                   EVAL      X_THCPH  =   THCPH
     C                   EVAL      X_THTLH  =   THTLH
     C                   EVAL      X_THEMH  =   THEMH
     C                   EVAL      X_THKNA  =   THKNA
     C                   EVAL      X_THTINA =   THTINA
     C                   EVAL      X_THSTA  =   THSTA
     C                   EVAL      X_THCPA  =   THCPA
     C                   EVAL      X_THTLA  =   THTLA
     C                   EVAL      X_THEMA  =   THEMA
     C                   EVAL      X_THGKD  =   THGKD
     C                   EVAL      X_THGFT1 =   THGFT1
     C                   EVAL      X_THGFT2 =   THGFT2
     C                   EVAL      X_THGADK =   THGADK
     C                   EVAL      X_THGBL  =   THGBL
     C                   EVAL      X_THGVK  =   THGVK
     C                   EVAL      X_THALK  =   THALK
     C                   EVAL      X_THBLK  =   THBLK
     C                   EVAL      X_THKDC  =   THKDC
     C                   EVAL      X_THTMIN =   THTMIN
     C                   EVAL      X_THTMGR =   THTMGR
     C                   EVAL      X_THVKB  =   THVKB
     C                   EVAL      X_THUCR  =   THUCR
     C                   EVAL      X_THTINC =   THTINC
     C                   EVAL      X_THKNC  =   THKNC
     C                   EVAL      X_THNAC  =   THNAC
     C                   EVAL      X_THTLC  =   THTLC
     C                   EVAL      X_THEMC  =   THEMC
     C                   EVAL      X_THKNS  =   THKNS
     C                   EVAL      X_THTINS =   THTINS
     C                   EVAL      X_THNAS  =   THNAS
     C                   EVAL      X_THAD1S =   THAD1S
     C                   EVAL      X_THPNS  =   THPNS
     C                   EVAL      X_THPSS  =   THPSS
     C                   EVAL      X_THLKS  =   THLKS
     C                   EVAL      X_THCPS  =   THCPS
     C                   EVAL      X_THTLS  =   THTLS
     C                   EVAL      X_THEMS  =   THEMS
     C                   EVAL      X_THKNK  =   THKNK
     C                   EVAL      X_THTINK =   THTINK
     C                   EVAL      X_THNAK  =   THNAK
     C                   EVAL      X_THAD1K =   THAD1K
     C                   EVAL      X_THPNK  =   THPNK
     C                   EVAL      X_THPSK  =   THPSK
     C                   EVAL      X_THLKK  =   THLKK
     C                   EVAL      X_THROLE =   THROLE
     C                   EVAL      X_THIDR  =   THIDR
     C                   EVAL      X_THCNR  =   THCNR
     C                   EVAL      X_THDANT =   THDANT
     C                   EVAL      X_THDFKD =   THDFKD
     C                   EVAL      X_THGINR =   THGINR
     C                   EVAL      X_THLGTY =   THLGTY
     C                   EVAL      X_THLGID =   THLGID
     C                   EVAL      X_THLGAU =   THLGAU
     C                   EVAL      X_THLGAI =   THLGAI
     C                   EVAL      X_THLGUN =   THLGUN
     C                   EVAL      X_THLGTS =   THLGTS
     C                   EVAL      X_THLGLA =   THLGLA
     C                   EVAL      X_THLGLO =   THLGLO
     C                   EVAL      X_THKNE  =   THKNE
     C                   EVAL      X_THTINE =   THTINE
     C                   EVAL      X_THADE1 =   THADE1
     C                   EVAL      X_THPNE  =   THPNE
     C                   EVAL      X_THPSE  =   THPSE
     C                   EVAL      X_THLKE  =   THLKE
     C                   EVAL      X_THADE2 =   THADE2
     C                   EVAL      X_THPNE2 =   THPNE2
     C                   EVAL      X_THLKE2 =   THLKE2
     C                   EVAL      X_THCPE  =   THCPE
     C                   EVAL      X_THTLE  =   THTLE
     C                   EVAL      X_THEME  =   THEME
     C                   EVAL      X_THTRM  =   THTRM
     C                   EVAL      X_THTAID =   THTAID
     C                   EVAL      X_THTALK =   THTALK
     C                   EVAL      X_THLKR1 =   THLKR1
     C                   EVAL      X_THLKR2 =   THLKR2
     C                   EVAL      X_THLKR3 =   THLKR3
     C                   EVAL      X_THLKR4 =   THLKR4
     C                   EVAL      X_THLKR5 =   THLKR5
     C                   EVAL      X_THLKR6 =   THLKR6
     C                   EVAL      X_THTGTS =   THTGTS
     C                   EVAL      X_THTRMG =   THTRMG
     C                   EVAL      X_THTGID =   THTGID
     C                   EVAL      X_THTGLK =   THTGLK
     C                   EVAL      X_THTGCN =   THTGCN
     C                   EVAL      X_THLSUN =   THLSUN
     C                   EVAL      X_THLSLK =   THLSLK
     C                   EVAL      X_THLSNA =   THLSNA
     C                   EVAL      X_THLOUN =   THLOUN
     C                   EVAL      X_THLOLK =   THLOLK
     C                   EVAL      X_THLONA =   THLONA
     C                   EVAL      X_THPDTY =   THPDTY
     C                   EVAL      X_THPDRF =   THPDRF
     C                   EVAL      X_THPDIN =   THPDIN
     C                   EVAL      X_THSDTY =   THSDTY
     C                   EVAL      X_THSDRF =   THSDRF
     C                   EVAL      X_THSDLN =   THSDLN
     C                   EVAL      X_THSDIN =   THSDIN
     C                   EVAL      X_THTDTY =   THTDTY
     C                   EVAL      X_THTDRF =   THTDRF
     C                   EVAL      X_THADTY =   THADTY
     C                   EVAL      X_THADRF =   THADRF
     C                   EVAL      X_THAICD =   THAICD
     C                   EVAL      X_THAITX =   THAITX
     C                   EVAL      X_THTRCH =   THTRCH
     C                   EVAL      X_THDDT  =   THDDT
     C                   EVAL      X_THDKR  =   THDKR
     C                   EVAL      X_THDDTK =   THDDTK
     C                   EVAL      X_THDATS =   THDATS
     C                   EVAL      X_THDKAV =   THDKAV
     C                   EVAL      X_THDKTX =   THDKTX
     C                   EVAL      X_THTSSD =   THTSSD
     C                   EVAL      X_THTSN1 =   THTSN1
     C                   EVAL      X_THTSN2 =   THTSN2
     C                   EVAL      X_THTSPN =   THTSPN
     C                   EVAL      X_THTSPS =   THTSPS
     C                   EVAL      X_THTSLK =   THTSLK
     C                   EVAL      X_THTSSK =   THTSSK
     C                   EVAL      X_THLSTL =   THLSTL
     C                   EVAL      X_THVPOS =   THVPOS
     C                   EVAL      X_THNTK  =   THNTK
     C                   EVAL      X_THDST  =   THDST
     C                   EVAL      X_THTARF =   THTARF
     C                   EVAL      X_THWS   =   THWS
     C                   EVAL      X_THLRN  =   THLRN
     C                   EVAL      X_THTRNR =   THTRNR
     C                   EVAL      X_THTRDT =   THTRDT
     C                   EVAL      X_THOMD  =   THOMD
     C                   EVAL      X_THBIND =   THBIND
     C                   EVAL      X_THTET  =   THTET
     C                   EVAL      X_THMF   =   THMF
     C                   EVAL      X_THMP   =   THMP
     C                   EVAL      X_THPKL  =   THPKL
     C                   EVAL      X_THKDV  =   THKDV
     C                   EVAL      X_TH0035 =   TH0035
     C                   UPDATE    NCTSEHR
     C                   ENDSR
      *______________________________________________________
      * Räkna X antall dagar framåt                  SRDATPLU
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRDATPLU      BEGSR
     C                   Z-ADD     THDDT         UANTDG
     C                   CALL      'SYFA20B'
     C                   PARM      *ZEROS        UINNDT            6 0
     C                   PARM                    UANTDG            3 0
     C                   PARM                    UUTDT             6 0
     C                   PARM                    UFLAGG            1 0
     C     UUTDT         ADD       20000000      THDDT
     C                   ENDSR
