********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
********************************************************************
      *
      *****************************************************************
      * PROGRAM SKAL SKRIVE UT FRAKTAVTALER                           *
      * INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER              *
      * LEDIGE INDIKATORER 01 02 05-26                                *
      * LEDIGE INDIKATORER 43-49 56-93                                *
      *****************************************************************
      *
     FKODTFM    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTW     IF   E           K DISK
     FHODE      IF   E           K DISK
     FFRATN     IF   E           K DISK
     FFRATFRA   IF   E           K DISK    RENAME(FRATR:FRATFR)
     FFRATTIL   IF   E           K DISK    RENAME(FRATR:FRATTR)
     FFIRM      IF   E           K DISK
     FWFILEAVT  UF A E           K DISK
     FWFILEAV1  UF   E           K DISK    RENAME(WFAVTR:WFAVTR1)
E01  FSYYA02FM  CF   E             WORKSTN INFDS(FBAREA)
     FSYYA02PF  O    E             PRINTER OFLIND(*IN34)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
     D ZFB             S              5  0 DIM(12)
     D ZFV             S              5  0 DIM(12)
     D ZFM             S              5  0 DIM(12)
     D                 DS
     D  XINTF                  1      5  0
     D  XINTF2                 1      5  2
     D                 DS
     D  XINTT                  1      5  0
     D  XINTT2                 1      5  2
     D                 DS
     D  FIFT                   1     45
     D  FIFT40                 1     40
     D                 DS
     D  HOHT1                  1     80
     D  HOHT2                 81    160
     D  HOHT3                161    240
     D  HOHT4                241    320
     D  HOHT5                321    400
     D  HOHT6                401    480
     D  HOHT7                481    560
     D  HO                     1    560
     D                                     DIM(7)
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTÅ                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  FB01                   1      3P 0
     D  FB02                   4      6P 0
     D  FB03                   7      9P 0
     D  FB04                  10     12P 0
     D  FB05                  13     15P 0
     D  FB06                  16     18P 0
     D  FB07                  19     21P 0
     D  FB08                  22     24P 0
     D  FB09                  25     27P 0
     D  FB10                  28     30P 0
     D  FB11                  31     33P 0
     D  FB12                  34     36P 0
     D  FB                     1     36P 0
     D                                     DIM(12)
     D                 DS
     D  FM                     1     36P 0
     D                                     DIM(12)
     D  FM01                   1      3P 0
     D  FM02                   4      6P 0
     D  FM03                   7      9P 0
     D  FM04                  10     12P 0
     D  FM05                  13     15P 0
     D  FM06                  16     18P 0
     D  FM07                  19     21P 0
     D  FM08                  22     24P 0
     D  FM09                  25     27P 0
     D  FM10                  28     30P 0
     D  FM11                  31     33P 0
     D  FM12                  34     36P 0
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  FV                     1     60  0
     D                                     DIM(12)
     D                UDS
     D  UAVD                  15     18  0
      *
      *
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C                   MOVEA     '00000'       *IN(95)
     C                   MOVEA     '00000000'    *IN(27)
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      TESTB
     C  N30WSCMP         IFEQ      'N'
     C                   EXSR      PRINT
     C                   ELSE
     C                   EXSR      PRINTC
     C                   END
     C                   SETOFF                                       9930
     C                   MOVE      'J'           WSCMP
     C                   MOVE      'N'           WSHEAD
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     TESTB         BEGSR
     C******************************************
     C*
     C* TEST FRA OG TIL KUNDENR
     C     WSKNF         IFEQ      0
     C     WSKNT         COMP      0                                  9999
     C   99              MOVE      'SPK0018'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB
     C                   SETON                                        27
     C                   ELSE
     C     WSKNT         IFEQ      0
     C                   MOVE      WSKNF         WSKNT
     C                   ELSE
     C     WSKNT         COMP      WSKNF                                99
     C   99              MOVE      'SPK0019'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB
     C                   END
     C                   END
     C*
     C* TEST OM MAN SKAL HA KOMPRIMERT LISTE
     C     WSCMP         COMP      *BLANKS                                98
     C   98              MOVE      'SPC0005'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLTB
     C*
     C* TEST OM MAN SKAL HA UTENLANDSIDE I HEADING
     C     WSHEAD        COMP      'J'                                    38
     C                   SETOFF                                       39
     C*
     C* TEST FRA-STED
     C     WSSDF         IFNE      *BLANKS
     C     WSSDF         CHAIN     STED2                              97
     C   97              MOVE      'SPS0012'     MSGNR
     C   97              SETON                                        30
     C   97              GOTO      SLTB
     C                   SETON                                        29
     C                   END
     C*
     C* TEST TIL-STED
     C     WSSDT         IFNE      *BLANKS
     C     WSSDT         CHAIN     STED2                              96
     C   96              MOVE      'SPS0013'     MSGNR
     C   96              SETON                                        30
     C   96              GOTO      SLTB
     C                   SETON                                        31
     C                   END
     C*
     C*** TEST UTVALGKODE
     C     WSVALG        COMP      'U'                                    32
     C     WSVALG        COMP      'G'                                    33
     C*
     C*** TEST DATO
     C     WSDT          IFNE      0
     C                   MOVE      WSDTD         UDD               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      95
     C   95              MOVE      'SPD0001'     MSGNR
     C   95              SETON                                        30
     C   95              GOTO      SLTB
     C                   MOVE      WSDTD         XDTD
     C                   MOVE      WSDTM         XDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          XDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          XDTÅ
     C                   END
     C                   ELSE
     C                   MOVE      *ZEROS        XDT
     C                   END
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   Z-SUB     1             XKN               8 0
     C                   MOVE      '   '         XFR               3
     C                   MOVE      '  '          XOT               2
     C                   MOVE      'DIV0782'     MSGNR
     C*
     C   27FRATK         SETLL     FRATN
     C  N27
     CANN29
     CANN31FRAT1K        SETLL     FRATN
     C  N27
     CAN 29FRATFK        SETLL     FRATFRA
     C  N27
     CAN 31FRATTK        SETLL     FRATTIL
     C*
     C     STPR          TAG
     C   27
     CORN27
     CANN29
     CANN31              READ      FRATN                                  30
     C  N27
     CAN 29              READ      FRATFRA                                30
     C  N27
     CAN 31              READ      FRATTIL                                30
     C  N30
     CAN 27FTKNR         COMP      0                                  30
     C  N30
     CANN27WSKNT         COMP      FTKNR                                30
     C  N30
     CANN27
     CAN 29WSSDF         COMP      FTFRA                              3030
     C  N30
     CANN27
     CAN 31WSSDT         COMP      FTTIL                              3030
     C  N30              DO
     C     FTFRA         CHAIN     STED2                              99
     C  N99              MOVE      ST2LK         FTLKF
     C   99              MOVE      *BLANKS       FTLKF
     C     FTTIL         CHAIN     STED2                              99
     C  N99              MOVE      ST2LK         FTLKT
     C   99              MOVE      *BLANKS       FTLKT
     C     WSLK          IFNE      *BLANKS                                      *LANDKODE GITT
     C     WSLK          ANDNE     FTLKF                                        *MEN ULIK FRA
     C     WSLK          ANDNE     FTLKT                                        *OG ULIK TILKODE
     C                   GOTO      STPR
     C                   END
     C                   END
     C   30XKN           IFNE      -1
     C                   EXSR      PRT01
     C                   END
     C   30              GOTO      SLPR
     C*
     C*   SELEKTER OPPDRAGSTYPE
     C*
     C     WSOPDT        IFNE      *BLANKS
     C     FTOPDT        IFNE      WSOPDT
     C                   GOTO      STPR
     C                   END                                                    <FTOPDT
     C                   END                                                    <WSOPDT
     C*
     C   32XDT           CABLT     FTDT          STPR
     C   33XDT           CABGT     FTDT          STPR
     C                   MOVE      'DIV0781'     MSGNR
     C*
     C     XKN           IFNE      FTKNR
     C     XKN           ANDNE     -1
     C                   EXSR      PRT01
     C                   END
     C*
     C                   MOVE      FTKNR         XKN
     C*
     C                   WRITE     WFAVTR
     C*
     C                   GOTO      STPR
     C*
     C     SLPR          ENDSR
     C*
     C***********************************************
     C     PRT01         BEGSR
     C***********************************************
     C                   EXSR      MOVFTZ
     C*
     C     KUND1K        CHAIN     CUNDL01                            99
     C   99              MOVE      XFEIL1        KNAVN
     C   99              MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       XADR3            30
     C  N99POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XADR3
     C                   ELSE
     C                   MOVEL     POSTNR        XADR3
     C                   MOVE      ADR3          XADR3
     C                   END
     C*
     C     WFAVTK        SETLL     WFILEAVT
     C                   SETOFF                                       36
     C*
     C     STPR1         TAG
     C                   READ      WFILEAVT                               36
     C   36              GOTO      SLPR1
     C                   DELETE    WFAVTR
     C*
     C*
     C     FTOPDT        IFEQ      'GE'
     C                   MOVE      XFEIL5        KO1NTX
     C                   ELSE
     C                   MOVE      FTOPDT        XOT
     C     KODOTK        CHAIN     KODTOTY                            99
     C   99              MOVE      XFEIL3        KO1NTX
     C                   END
     C*
     C     FTFRA         CHAIN     STED2                              99
     C  N99              MOVE      ST2LK         XLKF
     C  N99              MOVEL     ST2NVN        XSTF
     C  N99              MOVE      ST2SOL        XSONEF
     C   99              MOVEL     XFEIL4        XSTF
     C     FTTIL         CHAIN     STED2                              99
     C  N99              MOVE      ST2LK         XLKT
     C  N99              MOVEL     ST2NVN        XSTT
     C  N99              MOVE      ST2SOL        XSONET
     C   99              MOVEL     XFEIL4        XSTT
     C*
     C     FTSK          COMP      'S'                                    28
     C     FTKOLL        COMP      ' '                                    51
     C     FTKOLL        COMP      'M'                                    52
     C     FTKOLL        COMP      'L'                                    53
     C     FTKOLL        COMP      'V'                                    54
     C   52
     COR 53              MOVE      FTPRPR        XPRPR             4 2
     C   54              Z-ADD     1             FTPRPR
     C*
     C     FTMM          COMP      0                                      40
     C     FTMM          COMP      1                                      41
     C     FTMM          COMP      2                                      42
     C*
     C                   WRITE     HEADER
     C*
     C                   MOVE      *ZEROS        XINTT
     C                   SETOFF                                       49
     C     1             DO        12            XN                2 0
     C     FV(XN)        COMP      99999                                  50
     C   50XN            COMP      1                                      49
     C  N50XINTT         ADD       1             XINTF
     C  N50              MOVE      FV(XN)        XINTT
     C                   MOVE      FB(XN)        XFB
     C                   MOVE      FM(XN)        XFM
     C  N42FTMIN         IFGT      XFM
     C                   Z-ADD     FTMIN         XFM
     C                   END                                                    <FTMIN
     C     FTFAST        COMP      XN                                   55
     C                   WRITE     DETALJ
     C   50              LEAVE
     C                   END
     C*
     C                   WRITE     TOMLIN
     C     FTMIN         IFNE      0
     C  N41              WRITE     MINIMUM
     C                   END
     C     FTMAX1        IFNE      0
     C                   WRITE     FORVOGN
     C                   END
     C     FTMAX2        IFNE      0
     C                   WRITE     HENGER
     C                   END
     C     FTMAX3        IFNE      0
     C                   WRITE     KOMPLETT
     C                   END
     C*
     C                   GOTO      STPR1
     C*
     C     SLPR1         TAG
     C                   EXSR      MOVZFT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVFTZ        BEGSR
     C***********************************************
     C                   MOVE      FTFRAN        ZFRAN             3
     C                   MOVE      FTOPDT        ZOPDT             2
     C                   MOVE      FTSK          ZSK               1
     C                   MOVE      FTFRA         ZFRA              5
     C                   MOVE      FTTIL         ZTIL              5
     C                   MOVE      FTAVTN        ZAVTN             1 0
     C                   MOVE      FTKODE        ZKODE             1
     C                   MOVE      FTMIN         ZMIN              5 0
     C                   MOVE      FTMAX1        ZMAX1             5 0
     C                   MOVE      FTKOLL        ZKOLL             1
     C                   MOVE      FTPRPR        ZPRPR             5 0
     C                   MOVE      FTMAX2        ZMAX2             5 0
     C                   MOVE      FTMAX3        ZMAX3             5 0
     C                   MOVE      FTFAST        ZFAST             2 0
     C                   MOVE      FTDT          ZDT               8 0
     C                   MOVE      FTMM          ZMM               1 0
     C                   MOVE      FTVAL         ZVAL              3
     C                   MOVE      FTLMOM        ZLMOM             5 0
     C                   MOVE      FTM3OM        ZM3OM             5 0
     C                   MOVEA     FB            ZFB
     C                   MOVEA     FV            ZFV
     C                   MOVEA     FM            ZFM
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVZFT        BEGSR
     C***********************************************
     C                   MOVE      ZFRAN         FTFRAN
     C                   MOVE      ZOPDT         FTOPDT
     C                   MOVE      ZSK           FTSK
     C                   MOVE      ZFRA          FTFRA
     C                   MOVE      ZTIL          FTTIL
     C                   MOVE      ZAVTN         FTAVTN
     C                   MOVE      ZKODE         FTKODE
     C                   MOVE      ZMIN          FTMIN
     C                   MOVE      ZMAX1         FTMAX1
     C                   MOVE      ZKOLL         FTKOLL
     C                   MOVE      ZPRPR         FTPRPR
     C                   MOVE      ZMAX2         FTMAX2
     C                   MOVE      ZMAX3         FTMAX3
     C                   MOVE      ZFAST         FTFAST
     C                   MOVE      ZDT           FTDT
     C                   MOVE      ZMM           FTMM
     C                   MOVE      ZVAL          FTVAL
     C                   MOVE      ZLMOM         FTLMOM
     C                   MOVE      ZM3OM         FTM3OM
     C                   MOVEA     ZFB           FB
     C                   MOVEA     ZFV           FV
     C                   MOVEA     ZFM           FM
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRINTC        BEGSR
     C***********************************************
     C                   MOVE      'DIV0782'     MSGNR
     C                   MOVE      *ZEROS        XSIDE
     C                   SETOFF                                       94
     C*
     C*  27 - FRA KUNDENUMMER = 0
     C*       TIL KUNDENUMMER = 0
     C*  29 - FRA STED UTFYLT
     C*  31 - TIL STED UTFYLT
     C*  38 - WSHEAD = J
     C*  39 - KJØR IMPORT/EXPORT RUTINE MED MOTSATTE TEKSTER
     C*
     C*  FRA ALLE STEDER / TIL ALLE STEDER
     C*
     C  N29
     CANN31              DO
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTIM                                        * EXPORT
     C                   EXSR      PRTEX                                        * IMPORT
     C                   ELSE                                                   <WSHEAD
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * EXPORT
     C                   EXSR      PRTIM                                        * IMPORT
     C                   END                                                    <WSHEAD
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * INNLAND
     C                   EXSR      PRTEX                                        * UTLAND
     C                   END
     C*  FRA ALLE STEDER / TIL VALGT STED
      *
     C  N29
     CAN 31              DO
     C     WSSDT         CHAIN     STED2                              99
     C     ST2LK         IFEQ      'NO'
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTEX                                        * IMPORT
     C                   ELSE
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * IMPORT
     C                   END                                                    <WSHEAD
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * INNLAND
     C                   ELSE
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTIM                                        * EXPORT
     C                   ELSE
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * EXPORT
     C                   END                                                    <WSHEAD
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * UTLAND
     C                   END
     C                   END
     C*  FRA VALGT STED / TIL ALLE STEDER
      *
     C   29
     CANN31              DO
     C     WSSDF         CHAIN     STED2                              99
     C     ST2LK         IFEQ      'NO'
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTIM                                        * EXPORT
     C                   ELSE
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * EXPORT
     C                   END                                                    <WSHEAD
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * INNLAND
     C                   ELSE
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTEX                                        * IMPORT
     C                   ELSE
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * IMPORT
     C                   END                                                    <WSHEAD
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * UTLAND
     C                   END
     C                   END
     C*  FRA VALGT STED / TIL VALGT STED
      *
     C   29
     CAN 31              DO
     C     WSSDF         CHAIN     STED2                              99
     C     ST2LK         IFEQ      'NO'
     C     WSSDT         CHAIN     STED2                              99
     C     ST2LK         IFEQ      'NO'
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * INNLAND
     C                   ELSE
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTIM                                        * EXPORT
     C                   ELSE                                                   <WSHEAD
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * EXPORT
     C                   END                                                    <WSHEAD
     C                   SETOFF                                       39
     C                   END
     C                   ELSE
     C     WSSDT         CHAIN     STED2                              99
     C     ST2LK         IFEQ      'NO'
     C     WSHEAD        IFEQ      'J'
     C                   SETOFF                                       35
     C                   SETON                                        39        * SPESIAL
     C                   EXSR      PRTEX                                        * IMPORT
     C                   ELSE                                                   <WSHEAD
     C                   SETOFF                                       35
     C                   SETOFF                                       39
     C                   EXSR      PRTIM                                        * IMPORT
     C                   END                                                    <WSHEAD
     C                   ELSE
     C                   SETON                                        35
     C                   SETOFF                                       39
     C                   EXSR      PRTEX                                        * UTLAND
     C                   END
     C                   END
     C                   END
     C*
     C   94              MOVE      'DIV0781'     MSGNR
     C                   ENDSR
     C*
     C***********************************************
     C     PRTEX         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XKN               8 0
     C                   MOVE      '   '         XFR               3
     C                   MOVE      '  '          XOT               2
     C                   MOVE      *BLANKS       XSD               5
     C                   MOVE      *BLANKS       FTLKF
     C*
     C     FRATFK        SETLL     FRATFRA
     C*
     C     STPRE         TAG
     C                   READ      FRATFRA                                30
     C  N30
     CAN 27FTKNR         COMP      0                                  30
     C  N30
     CANN27WSKNT         COMP      FTKNR                                30
     C  N30
     CANN27
     CAN 29WSSDF         COMP      FTFRA                              3030
     C  N30
     CANN27
     CAN 31WSSDT         COMP      FTTIL                              3737
     C  N30
     CAN 31
     CAN 37              GOTO      STPRE
     C   30XKN           IFNE      -1
     C                   EXSR      PRT02
     C                   END
     C   30              GOTO      SLPRE
     C*
     C*
     C*   SELEKTER OPPDRAGSTYPE
     C*
     C     WSOPDT        IFNE      *BLANKS
     C     FTOPDT        IFNE      WSOPDT
     C                   GOTO      STPRE
     C                   END                                                    <FTOPDT
     C                   END                                                    <WSOPDT
     C*
     C   32XDT           CABLT     FTDT          STPRE
     C   33XDT           CABGT     FTDT          STPRE
     C*
     C     *IN39         IFEQ      '1'
     C     FTFRA         CHAIN     STED2                              99
     C  N99
     CANN35ST2LK         COMP      'NO'                                   99
     C  N99
     CAN 35ST2LK         COMP      'NO'                               9999
     C   99              GOTO      STPRE
     C                   MOVE      ST2LK         FTLKF
     C     FTTIL         CHAIN     STED2                              99
     C  N99ST2LK         COMP      'NO'                               9999
     C   99              GOTO      STPRE
     C                   ELSE                                                   <*IN39
     C*
     C     FTFRA         CHAIN     STED2                              99
     C  N99
     CANN35ST2LK         COMP      'NO'                               9999
     C  N99
     CAN 35ST2LK         COMP      'NO'                                   99
     C   99              GOTO      STPRE
     C                   MOVE      ST2LK         FTLKF
     C     FTTIL         CHAIN     STED2                              99
     C  N99ST2LK         COMP      'NO'                                   99
     C   99              GOTO      STPRE
     C                   END                                                    <*IN39
     C                   MOVE      ST2LK         FTLKT
     C     WSLK          IFNE      *BLANKS                                      *LANDKODE GITT
     C     WSLK          ANDNE     FTLKF                                        *MEN ULIK FRA
     C     WSLK          ANDNE     FTLKT                                        *OG ULIK TILKODE
     C                   GOTO      STPRE
     C                   END
     C                   SETON                                        94
     C*
     C     XKN           IFNE      -1
     C     XKN           ANDNE     FTKNR
     C                   EXSR      PRT02
     C                   READP     FRATFRA                                33
     C                   READ      FRATFRA                                33
     C                   END
     C                   MOVE      FTKNR         XKN
     C                   MOVE      ST2LK         FTLKT
     C                   WRITE     WFAVTR
     C*
     C                   GOTO      STPRE
     C*
     C     SLPRE         ENDSR
     C*
     C***********************************************
     C     PRT02         BEGSR
     C***********************************************
     C                   EXSR      MOVFTZ
     C                   MOVE      *BLANKS       XSD
     C*
     C     KUND1K        CHAIN     CUNDL01                            99
     C   99              MOVE      XFEIL1        KNAVN
     C   99              MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       XADR3            30
     C  N99POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XADR3
     C                   ELSE
     C                   MOVEL     POSTNR        XADR3
     C                   MOVE      ADR3          XADR3
     C                   END
     C                   MOVE      FTKNR         XKN
     C*
     C     WFAVTK        SETLL     WFILEAVT
     C                   SETOFF                                       36
     C*
     C     STPR2         TAG
     C                   READ      WFILEAVT                               36
     C   36              GOTO      SLPR2
     C*
     C                   DELETE    WFAVTR
     C*
     C     FTFRA         CHAIN     STED2                              99
     C                   MOVE      ST2LK         XLKF
     C                   MOVEL     ST2NVN        XSTF
     C                   MOVE      ST2SOL        XSONEF
     C     FTTIL         CHAIN     STED2                              99
     C                   MOVE      ST2LK         XLKT
     C                   MOVEL     ST2NVN        XSTT
     C                   MOVE      ST2SOL        XSONET
     C*
     C     FTFRA         IFNE      XSD
     C                   MOVE      FTFRA         XSD
     C                   ADD       1             XSIDE
     C                   WRITE     EXHEAD
     C                   SETOFF                                       34
     C                   END
     C*
     C     FTSK          COMP      'S'                                    28
     C     FTKOLL        COMP      ' '                                    51
     C     FTKOLL        COMP      'M'                                    52
     C     FTKOLL        COMP      'L'                                    53
     C     FTKOLL        COMP      'V'                                    54
     C   52
     COR 53              MOVE      FTPRPR        XPRPR             4 2
     C   54              Z-ADD     1             FTPRPR
     C*
     C     FTMM          COMP      0                                      40
     C     FTMM          COMP      1                                      41
     C     FTMM          COMP      2                                      42
     C*
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXDET1
     C*
     C                   MOVE      *ZEROS        XINTT
     C                   SETOFF                                       49
     C     1             DO        12            XN                2 0
     C     FV(XN)        COMP      99999                                  50
     C   50XN            COMP      1                                      49
     C  N50XINTT         ADD       1             XINTF
     C  N50              MOVE      FV(XN)        XINTT
     C                   MOVE      FB(XN)        XFB
     C                   MOVE      FM(XN)        XFM
     C  N42FTMIN         IFGT      XFM
     C                   Z-ADD     FTMIN         XFM
     C                   END                                                    <FTMIN
     C     FTFAST        COMP      XN                                   55
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXDET2
     C   50              LEAVE
     C                   END
     C*
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXTOML
     C     FTMIN         IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C  N41              WRITE     EXMM
     C                   END
     C     FTMAX1        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXFORV
     C                   END
     C     FTMAX2        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXHENG
     C                   END
     C     FTMAX3        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     EXHEAD
     C   34              SETOFF                                       34
     C                   WRITE     EXKOMP
     C                   END
     C*
     C                   GOTO      STPR2
     C*
     C     SLPR2         TAG
     C                   EXSR      MOVZFT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRTIM         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XKN               8 0
     C                   MOVE      '   '         XFR               3
     C                   MOVE      '  '          XOT               2
     C                   MOVE      *BLANKS       XSD               5
     C                   MOVE      *BLANKS       FTLKF
     C*
     C     FRATTK        SETLL     FRATTIL
     C*
     C     STPRI         TAG
     C                   READ      FRATTIL                                30
     C  N30
     CAN 27FTKNR         COMP      0                                  30
     C  N30
     CANN27WSKNT         COMP      FTKNR                                30
     C  N30
     CANN27
     CAN 31WSSDT         COMP      FTTIL                              3030
     C  N30
     CANN27
     CAN 29WSSDF         COMP      FTFRA                              3737
     C  N30
     CAN 29
     CAN 37              GOTO      STPRI
     C   30XKN           IFNE      -1
     C                   EXSR      PRT03
     C                   END
     C   30              GOTO      SLPRI
     C*
     C*   SELEKTER OPPDRAGSTYPE
     C*
     C     WSOPDT        IFNE      *BLANKS
     C     FTOPDT        IFNE      WSOPDT
     C                   GOTO      STPRI
     C                   END                                                    <FTOPDT
     C                   END                                                    <WSOPDT
     C*
     C   32XDT           CABLT     FTDT          STPRI
     C   33XDT           CABGT     FTDT          STPRI
     C*
     C*
     C     *IN39         IFEQ      '1'
     C     FTTIL         CHAIN     STED2                              99
     C  N99ST2LK         COMP      'NO'                                   99
     C   99              GOTO      STPRI
     C                   MOVE      ST2LK         FTLKT
     C     FTFRA         CHAIN     STED2                              99
     C  N99
     CANN35ST2LK         COMP      'NO'                               9999
     C  N99
     CAN 35ST2LK         COMP      'NO'                                   99
     C   99              GOTO      STPRI
     C                   ELSE                                                   <*IN39D
     C     FTTIL         CHAIN     STED2                              99
     C  N99ST2LK         COMP      'NO'                               9999
     C   99              GOTO      STPRI
     C                   MOVE      ST2LK         FTLKT
     C     FTFRA         CHAIN     STED2                              99
     C  N99
     CANN35ST2LK         COMP      'NO'                                   99
     C  N99
     CAN 35ST2LK         COMP      'NO'                               9999
     C   99              GOTO      STPRI
     C                   END                                                    <*IN39
     C                   MOVE      ST2LK         FTLKF
     C     WSLK          IFNE      *BLANKS                                      *LANDKODE GITT
     C     WSLK          ANDNE     FTLKF                                        *MEN ULIK FRA
     C     WSLK          ANDNE     FTLKT                                        *OG ULIK TILKODE
     C                   GOTO      STPRI
     C                   END
     C                   SETON                                        94
     C*
     C     XKN           IFNE      -1
     C     XKN           ANDNE     FTKNR
     C                   EXSR      PRT03
     C                   READP     FRATTIL                                33
     C                   READ      FRATTIL                                33
     C                   END
     C                   MOVE      FTKNR         XKN
     C                   MOVE      ST2LK         FTLKF
     C                   WRITE     WFAVTR
     C*
     C                   GOTO      STPRI
     C*
     C     SLPRI         ENDSR
     C*
     C***********************************************
     C     PRT03         BEGSR
     C***********************************************
     C                   EXSR      MOVFTZ
     C                   MOVE      *BLANKS       XSD
     C*
     C     KUND1K        CHAIN     CUNDL01                            99
     C   99              MOVE      XFEIL1        KNAVN
     C   99              MOVE      *BLANKS       ADR1
     C                   MOVE      *BLANKS       XADR3            30
     C  N99POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XADR3
     C                   ELSE
     C                   MOVEL     POSTNR        XADR3
     C                   MOVE      ADR3          XADR3
     C                   END
     C*
     C     WFAV1K        SETLL     WFILEAV1
     C                   SETOFF                                       36
     C*
     C     STPR3         TAG
     C                   READ      WFILEAV1                               36
     C   36              GOTO      SLPR3
     C                   DELETE    WFAVTR1
     C*
     C     FTTIL         CHAIN     STED2                              99
     C     FTTIL         IFNE      XSD
     C                   MOVE      ST2LK         XLKT
     C                   MOVEL     ST2NVN        XSTT
     C                   MOVE      ST2SOL        XSONET
     C                   END
     C     FTFRA         CHAIN     STED2                              99
     C                   MOVE      ST2LK         XLKF
     C                   MOVEL     ST2NVN        XSTF
     C                   MOVE      ST2SOL        XSONEF
     C*
     C     FTTIL         IFNE      XSD
     C                   MOVE      FTTIL         XSD
     C                   ADD       1             XSIDE
     C                   WRITE     IMHEAD
     C                   SETOFF                                       34
     C                   END
     C*
     C     FTSK          COMP      'S'                                    28
     C     FTKOLL        COMP      ' '                                    51
     C     FTKOLL        COMP      'M'                                    52
     C     FTKOLL        COMP      'L'                                    53
     C     FTKOLL        COMP      'V'                                    54
     C   52
     COR 53              MOVE      FTPRPR        XPRPR             4 2
     C   54              Z-ADD     1             FTPRPR
     C*
     C     FTMM          COMP      0                                      40
     C     FTMM          COMP      1                                      41
     C     FTMM          COMP      2                                      42
     C*
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMDET1
     C*
     C                   MOVE      *ZEROS        XINTT
     C                   SETOFF                                       49
     C     1             DO        12            XN                2 0
     C     FV(XN)        COMP      99999                                  50
     C   50XN            COMP      1                                      49
     C  N50XINTT         ADD       1             XINTF
     C  N50              MOVE      FV(XN)        XINTT
     C                   MOVE      FB(XN)        XFB
     C                   MOVE      FM(XN)        XFM
     C  N42FTMIN         IFGT      XFM
     C                   Z-ADD     FTMIN         XFM
     C                   END                                                    <FTMIN
     C     FTFAST        COMP      XN                                   55
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMDET2
     C   50              LEAVE
     C                   END
     C*
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMTOML
     C     FTMIN         IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C  N41              WRITE     IMMM
     C                   END
     C     FTMAX1        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMFORV
     C                   END
     C     FTMAX2        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMHENG
     C                   END
     C     FTMAX3        IFNE      0
     C   34              ADD       1             XSIDE
     C   34              WRITE     IMHEAD
     C   34              SETOFF                                       34
     C                   WRITE     IMKOMP
     C                   END
     C*
     C                   GOTO      STPR3
     C*
     C     SLPR3         ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNF
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNT
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01   *
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      5
N01  C     POSNBR        ANDGE     18
N01  C     POSNBR        ANDLE     25
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNT
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     6             POSNBR
N01  C                   Z-ADD     18            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      4
N01  C     POSNBR        ANDGE     18
N01  C     POSNBR        ANDLE     25
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNF
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     5             POSNBR
N01  C                   Z-ADD     18            POSNBR
N01  C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    UAVD
     C     KODOTK        KLIST
     C                   KFLD                    YOTUNI
     C                   KFLD                    FTOPDT
     C     FRATK         KLIST
     C                   KFLD                    YKN
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C                   KFLD                    YSDF
     C                   KFLD                    YSDT
     C                   KFLD                    YAVTN
     C     FRAT1K        KLIST
     C                   KFLD                    WSKNF
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C                   KFLD                    YSDF
     C                   KFLD                    YSDT
     C                   KFLD                    YAVTN
     C     FRATFK        KLIST
     C                   KFLD                    WSKNF
     C                   KFLD                    WSSDF
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C                   KFLD                    YSDT
     C     FRATTK        KLIST
     C                   KFLD                    WSKNF
     C                   KFLD                    WSSDT
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C                   KFLD                    YSDF
     C     FRAVK         KLIST
     C                   KFLD                    XKN
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C     FRAVKN        KLIST
     C                   KFLD                    KUNDNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XKN
     C     HODEK         KLIST
     C                   KFLD                    YNET
     C                   KFLD                    UAVD
     C     WFAVTK        KLIST
     C                   KFLD                    YLKF
     C                   KFLD                    YSDF
     C                   KFLD                    YLKT
     C                   KFLD                    YSDT
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C     WFAV1K        KLIST
     C                   KFLD                    YLKT
     C                   KFLD                    YSDT
     C                   KFLD                    YLKF
     C                   KFLD                    YSDF
     C                   KFLD                    YFR
     C                   KFLD                    YOT
     C                   KFLD                    YSK
     C*
     C     *ENTRY        PLIST
     C     LASER         PARM      LASER         LASER             1
     C     STRING        PARM      STRING        STRING            5
     C     COPYA         PARM      COPYA         COPYA             2
     C                   MOVE      COPYA         COPY              2 0
     C     STRING        IFNE      *BLANKS
     C     STRING        CHAIN     KODTFM                             33
     C                   END
     C     LASER         IFEQ      'A'
     C                   SETON                                        88
     C                   END
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'OTY'         YOTUNI            3
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      '  '          YLKF              2
     C                   MOVE      '  '          YLKT              2
     C                   MOVE      '   '         YFR               3
     C                   MOVE      '  '          YOT               2
     C                   MOVE      ' '           YSK               1
     C                   MOVE      '     '       YSDF              5
     C                   MOVE      '     '       YSDT              5
     C                   Z-ADD     0             YAVTN             1 0
     C                   MOVE      *BLANKS       YNET              1
     C                   Z-ADD     0             WSDT
     C                   MOVE      *ZEROS        FB
     C                   MOVE      *ZEROS        FV
     C                   MOVE      'DIV0000'     MSGNR
     C                   MOVE      'J'           WSCMP
     C                   MOVE      'N'           WSHEAD
     C                   MOVE      *ZEROS        XINTF
     C                   MOVE      *ZEROS        XINTT
     C*
S01  C*                  Z-ADD     2             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT3            8
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR3            8 0
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C*                  EXSR      HMSG
     C*
     C                   READ      FIRM                                   99
     C*
     C                   Z-ADD     99999         FRVK12
     C*
     C                   MOVE      *BLANKS       HO
     C     KODTWK        CHAIN     KODTW                              99
     C   99              MOVE      'E'           YNET
     C   99KODTWK        CHAIN     KODTW                              99
     C   99              MOVE      'T'           YNET
     C   99KODTWK        CHAIN     KODTW                              99
     C  N99KOWHOD        IFEQ      'J'
     C     HODEK         CHAIN     HODE                               99
     C                   END
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HMSG          BEGSR
     C***********************************************
S01  C*                  MOVE      'DIV0779'     XMSGNR            7            MELDING-ID
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV0780'     XMSGNR
S01  C*                  EXSR      HMSG2
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*                  MOVE      'SPK0020'     XMSGNR
S01  C*                  EXSR      HMSG2
     C                   MOVEL     XMSG          XFEIL1           30
     C                   MOVE      'SPO0012'     XMSGNR            7
     C                   EXSR      HMSG2
     C                   MOVEL     XMSG          XFEIL3           29
     C                   MOVE      'SPS0019'     XMSGNR
     C                   MOVEL     XMSG          XFEIL4           15
     C                   MOVE      'DIV5041'     XMSGNR
     C                   EXSR      HMSG2
     C                   MOVEL     XMSG          XFEIL5           29
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HMSG2         BEGSR
     C***********************************************
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     132           XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            132
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
