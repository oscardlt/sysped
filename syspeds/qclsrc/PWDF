             PGM
             DCL        VAR(&WS) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PROG) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PROGLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PWD) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PWDF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CURPWD) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PWDL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&IN03) TYPE(*LGL) LEN(1)
             DCL        VAR(&IN24) TYPE(*LGL) LEN(1)
             DCLF       FILE(SYSPED/PWDFM) RCDFMT(BILDE01 BILDE02)
             MONMSG     MSGID(CPF0000)
             RTVJOBA    JOB(&WS)
             RTVDTAARA  DTAARA(SYSPED/PWD (1 10)) RTNVAR(&CURPWD)
             SNDRCVF    DEV(&WS) RCDFMT(BILDE01)
             IF         COND(&IN03 = '1') THEN(GOTO CMDLBL(EXIT))
             IF         COND(&IN24 = '1') THEN(GOTO CMDLBL(CHGPWD))
             IF         COND(&PWD = &CURPWD) THEN(GOTO CMDLBL(RUN))
             ELSE       CMD(GOTO CMDLBL(NOTAUT))
 RUN:        SNDPGMMSG  MSG('Riktig passord')
             DLYJOB     DLY(1)
             CALL       PGM(SYSPED/SYFILER)
             GOTO       CMDLBL(EXIT)
 CHGPWD:     SNDRCVF    DEV(&WS) RCDFMT(BILDE02)
             IF         COND((&FLD001 = &CURPWD) *AND (&FLD002 = +
                          &FLD003)) THEN(DO)
             IF         COND(&FLD002 = '          ') THEN(GOTO +
                          CMDLBL(NOTVALID))
             CHGDTAARA  DTAARA(SYSPED/PWD (1 10)) VALUE(%SST(&FLD002 +
                          1 10))
             SNDPGMMSG  MSG('Passordet er endret')
             GOTO       CMDLBL(EXIT)
 NOTVALID:   SNDPGMMSG  MSG('Blank i passord er ikke tillatt')
             GOTO       CMDLBL(EXIT)
             ENDDO
 NOTAUT:     SNDPGMMSG  MSG('Feil passord, prøv igjen !')
 EXIT:       ENDPGM
