********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 02 YBC PTF10 FEIL VED RULLE OPP OG NED
10XXX * 03 SH  PTF10 utvidet linklinjen
10XXX * 04 SH  PTF10 2 = endre arkivpost
10XXX * 05 YBC PTF10 BEVARE UDS
10XXX * 06 SH  PTF10 Bytt til turnivå
10XXX * 07 SH  PTF10 blanke turnummer
10XXX * 08 SH  PTF10 kan ikke kjøre F10 uten dokumenter
10XXX * 09 SH  PTF10 endring shipsordre
      * 10 SH  PTF10 triplevel for shipsordfre
      * 11 SH  PTF10 dato tid på Z-dokumenter
      * 12 SH  PTF10 flere parametre til neste program
      * 13 SH  PTF10 endre datologikk for søk
      *      PTF  11
11XXX * 14 SH  PTF11 NYE FELT I WORKFIILE
11XXX * 15 YBC PTF11 VIS OGSÅ OMBEREGNING
11XXX * 16 YBC PTF11 FEILRETTING PÅ ENDRING 15
11XXX * 17 SH  PTF11 Hvis ikke IP-adreesse ta bort slash
11XXX * 18 SH  PTF11 'R' REGENERER ARKIVDOKUMENT
11XXX * 19 YBC PTF11 OPSJON 4 = SLETT DOKUMENT
11099 * 20 SH  PTF11 velge hoveddokument
      * 21 SH  PTF11 legge brukerid inn på slettede scanninger
      * 22 SH  PTF11 endring av visning kostnadsbilag
      * 23 SH  PTF11 dato klokka viser i bildet / kopier posten
      * 24 SH  PTF11 descdending sortering
      * 25 SH  PTF11 hvis avd/opd ikke rettet ikke test
      * 26 SH  PTF12 skriv skilleark
      * 27 SH  PTF12 flyttet til historikk
      * 28 SH  PTF12 forbedring skille ark
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 29 YBC PTF12 HENT L?PENR FOR TIDLIGERE OMBEREGNING
12XXX * 30 SH  PTF12 fikset tekst kostnadsbilag
12XXX * 31 SH  PTF12 legge .pdf også ved arklag= blank
12XXX * 32 SH  PTF12 sjekker om dokument finnes
12XXX * 33 SH  PTF12 BYTTET arkivl11 arkivl20
12XXX * 34 SH  PTF12 advisering navn
12XXX * 35 SH  PTF12 ikke turnivå ved tur 00000000
12XXX * 36 SH  PTF12 sikre ikkwe bytte parameter
12XXX * 37 SH  PTF12 legge på pdf
12XXX * 38 jov PTF12 feil i 36 / mister arunde
12XXX * 39 YBC PTF12 Vis også godsliste på turnivå
12XXX * 40 sh  FEIL INNENLANDSTURER
12XXX * 41 sh  PTF12 feil forutsetning i PTF39 (ikke alltid ..PT) - blir gristete NÅÅ!! wrkfile??
12XXX * 42 sh  PTF12 kan også regenerere sl
12XXX * 43 sh  PTF12 FINNES IKKE I ARKIV
********************************************************************
      *
      ***********************************************************
      *** PROGRAM Som viser arkiverte dokumenter              ***
      ***********************************************************
      *
     Fkosta     IF   E           K DISK
     Flevel01   IF   E           K DISK
     Faruserf   IF   E           K DISK
     FARKEXT    IF   E           K DISK
     Fsadh      IF   E           K DISK
N29  FSADOMTH   IF   E           K DISK
     Fsaeh      IF   E           K DISK
N29  FSAEOMTH   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTURER14   IF   E           K DISK
     FDOKUF     IF   E           K DISK
     FFAK3      IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FARKEPOW   UF A E           K DISK
s04  F*RKIVL08  IF   E           K DISK
s23  F*RKIVL08  UF   E           K DISK
n23  FARKIVL08  UF A E           K DISK
s33  F*RKIVL11  IF   E           K DISK
n33  FARKIVL20  IF   E           K DISK
     F                                     RENAME(arkivr:arkivr11)
     Fgssorf    IF   E           K DISK
     FARC003FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D                SDS
     D  UUSER                254    263
N04  D                 DS
N04  D  WSUNDE                 1     10
N04  D  WSUN02                 1      2
s09  D* WSUN07                 3      9
n09  D  WSUN07                 4     10
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
n11  D                 DS
N11  D  ARDATE                 1      8  0
N11  D  ARAA                   3      4
N11  D  ARMM                   5      6
N11  D  ARDG                   7      8
n23  D                 DS
N23  D  WSDATO                 1      6  0
N23  D  WSDGA                  1      2
N23  D  WSMMA                  3      4
N23  D  WSAAA                  5      6
s23  D*                DS
s23  D* ARTIME                 1      6  0
s23  D* ARTIT                  1      2
s23  D* ARTIM                  3      4
s23  D* ARTIS                  5      6
N33  D                 DS
N33  D  ARTYPE                 1      2
N33  D  ARTYP1                 1      1
     D                 DS
     D  FADATO                 1      8  0
     D  FAAA                   3      4
     D  FAMM                   5      6
     D  FADG                   7      8
N13  D                 DS
N13  D  WSDATE                 1      8  0
N13  D  WSAA                   1      4
N13  D  WSMM                   5      6
N13  D  WSDD                   7      8
N13  D                 DS
N13  D  WSDATI                 1      6  0
N13  D  WSDDI                  1      2
N13  D  WSMMI                  3      4
N13  D  WSAAI                  5      6
     D                 DS
     D  ARUNDE                 1     10
N34  D  ARUNDE1                1      1
     D  ARUN08                 1      8
     D  ARU1T3                 1      3
     D  AR4T10                 4     10
N21  D                 DS
N21  D  XULTID                 1     14  0
N21  D  XULTM                  1      6  0
N21  D  XULDD                  7      8  0
N21  D  XULMM                  9     10  0
N21  D  XULÅÅ                 11     14  0
N21  D                 DS
N21  D  ULÅÅ                   1      4  0
N21  D  ULMM                   5      6  0
N21  D  ULDD                   7      8  0
N21  D  ULDT                   1      8  0
N05  D SAVUDS         UDS
N05  D  UDSDTA                 1   1024
     ILEVER
     I              BANKG                       SYBAGI
     I              POSTG                       SYPOGI
     C*
N05  C     *DTAARA       DEFINE    *LDA          SAVUDS
N05  C                   IN        SAVUDS
n06  C     tur           tag
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      W2date        Ydate
     C                   MOVE      W2time        Ytime
     C                   MOVE      *blanks       ylink
N41  C                   move      'N'           Runde2            1
      *_____________
      * Fyll Subfile
      *"""""""""""""
s24  C* N80KEYS          SETLL     ARKIVL08
n24  C  N80KEYS          SETGT     ARKIVL08
s33  C*  80KEYS11        SETLL     ARKIVL11
n33  C   80KEYS11        SETGT     ARKIVL20
     C     START1        TAG
S04  C* N80KEYR          READE     ARKIVL08                               94
s24  C* N80KEYR          READE(N)  ARKIVL08                               94
n24  C  N80KEYR          READPE(N) ARKIVL08                               94
     c  N82
n33  Can 80KEYs11        REAdpe    ARKIVL20                               94
s33  C*n 80KEYs11        READE     ARKIVL11                               94
     c     *in82         ifeq      '1'
s33  C*                  READ      ARKIVL11                               94
n33  C                   READP     ARKIVL20                               94
     c  N94arun08        comp      uru08                              9494
     c                   end
      *
     c     *in80         IFEQ      '1'
     c     *in81         andeq     '1'
     c     *in94         andeq     '1'
     c                   move      urunde        uru08             8
     c                   move      *blanks       wsunde
     c                   movel     uru08         wsunde
N40  C                   MOVE      '99'          WSUNDE
     c                   move      '0'           *in81
     c                   move      '1'           *in82
s33  C*    KEYs11        setll     ARKIVL11                               94
n33  C     KEYs11        setgt     ARKIVL20
s33  C*                  READ      ARKIVL11                               94
n33  C                   READP     ARKIVL20                               94
     c  N94arun08        comp      uru08                              9494
     c                   end
      *
     C     START2        TAG
      *
S15  C* N94              DO
s03  C*                  DO        7
S15  C*                  DO        5
N15  C                   DOW       *IN94 = *OFF
     C                   ADD       1             ZRECNO
     c     artype        ifeq      'go'
     c     artype        oreq      'gf'
     c     artype        oreq      'am'
     c     artype        oreq      'fx'
     c     artype        oreq      'fs'
     c                   move      *zeros        aravd
     c                   move      *zeros        aropd
     c                   end
     c                   move      'I'           IE                1
     c                   exsr      genbane
     c                   move      'E'           IE
     c                   exsr      genbane
     c     arinek        ifeq      'E'
S03  C*                  move      wsline        wslinw
n03  C                   movel     wsline        wslinw
     c                   else
s03  C*                  move      wslink        wslinw
n03  C                   movel     wslink        wslinw
     c                   end
s03  C*                  move      ARLINK        GMLINK           40
N23  C                   move      artype        gmtype            2
n03  C                   movel     ARLINK        GMLINK          152
n32  c                   exsr      testfins
     C                   WRITE     SUBFIL
     c     Next          tag
S24  C* N80KEYR          READE(N)  ARKIVL08                               94
N24  C  N80KEYR          READPE(N) ARKIVL08                               94
S04  C* N80KEYR          READE     ARKIVL08                               94
     c  n82
n33  Can 80KEYS11        READPE    ARKIVL20                               94
s33  C*n 80KEYS11        READE     ARKIVL11                               94
     c     *in82         ifeq      '1'
s33  C*                  READ      ARKIVL11                               94
n33  C                   READP     ARKIVL20                               94
     c  N94arun08        comp      uru08                              9494
     c                   end
      *
     c     *in80         IFEQ      '1'
     c     *in81         andeq     '1'
     c     *in94         andeq     '1'
     c                   move      urunde        uru08             8
     c                   move      *blanks       wsunde
     c                   movel     uru08         wsunde
N40  C                   MOVE      '99'          WSUNDE
     c                   move      '0'           *in81
     c                   move      '1'           *in82
s33  C*    KEYs11        setll     ARKIVL11                               94
n33  C     KEYs11        setgt     ARKIVL20
s33  C*                  READ      ARKIVL11                               94
n33  C                   READ      ARKIVL20                               94
     c  N94arun08        comp      uru08                              9494
     c                   end
      *
      * leser neste hvis både type og lenke er den samme
      *
N23  c  N94artype        ifeq      gmtype
     C  N94ARLINK        CABEQ     GMLINK        NEXT
N23  C                   end
     C  N94              MOVE      ARdate        Ydate
     C  N94              MOVE      ARtime        Ytime
     C  N94              MOVE      ARLINK        Ylink
S15  C* N94              END
     C                   END
N15   *
S16  C* N80              IF        WSOPD > 0
N16  C   94
N16  CANN80              IF        WSOPD > 0
N15  C                   EVAL      WSOPD = WSOPD * -1
s24  C*    KEYS          SETLL     ARKIVL08
s24  C*    KEYR          READE(N)  ARKIVL08                               94
N24  C     KEYS          SETGT     ARKIVL08
N24  C     KEYR          READPE(N) ARKIVL08                               94
N15  C     *IN94         CABEQ     *OFF          START2
N16  C                   EVAL      WSOPD = WSOPD * -1
N15  C                   ELSE
N15  C                   EVAL      WSOPD = WSOPD * -1
N15  C                   END
N15   *
N01  C* OBS!!! denne er vel litt falig dersom mer enn 7 poster
N01  C* Hvis KL: Kostnadsbilag, sjekk også L1: Direkte L1-bilag
N01  c                   move      wsunde        arunde
S02  c*    aru1t3        ifeq      'KL:'
N02  c   94aru1t3        ifeq      'KL:'
N01  c                   move      arunde        kabnr
N01  c     kostke3       chain     kosta                              33
N01  c     *in(33)       ifeq      '0'
N01  c                   movel     'L1:'         Wsunde
N01  c                   move      kabnr2        Wsunde
s33  C*    KEYS11        SETLL     ARKIVL11
s33  C*    KEYs11        READE     ARKIVL11                               94
n33  C     KEYS11        SETGT     ARKIVL20
n33  C     KEYs11        READPE    ARKIVL20                               94
N01  c  N94              goto      start2
N01  c                   end
N01  c                   end
N39   *
S41  C*  94              IF        %SUBST(URUNDEI:1:2) = 'T:'
S41  C*                            AND %SUBST(WSUNDE:9:2) <> 'PT'
S41  C*                  EVAL      WSUNDE = %SUBST(URUNDEI:3:8) + 'PT'
S41  C*    KEYS11        SETGT     ARKIVL20
S41  C*    KEYS11        READPE    ARKIVL20                               94
N41   * go/gf mm ligger med '12345678xy',der 12345678=tur / x=status /y=type T=Transp/blank=Agent
N41   * ved inndata T: kjør en ny runde og let etter det   (82 on = sammenlign med 8 første..)
N41  C   94              IF        %SUBST(URUNDEI:1:2) = 'T:'
N41  C                             AND Runde2<>'J'
N41  C                   EVAL      Runde2 = 'J'
N41  C                   EVAL      *in82  = '1'
N41  C                   EVAL      WSUNDE = %SUBST(URUNDEI:3:8) +'99'
N41  c                   movel     WSUNDE        uru08             8
N41  C     KEYS11        SETGT     ARKIVL20
N41  C                   READP     ARKIVL20                               94
N41  C  N94ARUN08        COMP      uru08                              9494
N39  c  N94              GOTO      START2
N39  C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
N15  C                   IF        ZRECNO > 1
N15  C                   EVAL      ZRECNO = 1
N15  C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       9899
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C*
     C*** FRISK OPP
S33  C*  05              GOTO      START
N33  C   05              GOTO      tur
     C*
     C*** SØK FRA
     C   08              GOTO      START6
     C*** skilleark
N26  C     *IN23         IFEQ      '1'
N26  C                   exsr      prtskill
N26  C                   GOTO      START
N26  C                   END
N    C*** F09 GÅ TIL TUR
N06  C     *IN(09)       IFEQ      '1'
N10  c     wsun02        ifeq      'SS'
N10  c                   move      wsun07        ssnr
N10  c     keyss         chain     gssorf                             33
N10  c     *in(33)       ifeq      '0'
N10  c     ortno         andne     *zeros
N10  C                   movel     ortno         UAVD
N10  C                   move      ortno         UOPD
N10  C                   MOVE      *blanks       URUNDE
N10  C                   GOTO      TUR
N10  c                   end
N10  c                   end
N25  c     hepro         ifne      0
N06  C                   Z-ADD     0             UAVD              4 0
N06  C                   Z-ADD     0             UOPD              7 0
N06  C                   MOVE      HEPRO         URUNDE           10
N06  C                   MOVEL     'T:'          URUNDE
N38  c                   move      URUNDE        URUNDEI
N06  C   09              GOTO      TUR
N25  c                   end
N06  c                   end
     C*
     C*   sende epost
     C*
     c     *in(10)       ifeq      '1'
N08  c     wsant         ifeq      0
     C                   MOVE      'SHU1298'     MSGNR
     c                   seton                                        30
n08  c                   goto      start
n08  c                   end
     c                   call      'ARC004'
n12  c                   parm                    aavd
n12  c                   parm                    aopd
n12  c                   parm                    atur
n12  c                   parm                    akun
     c                   exsr      antsr
     c                   goto      start
     c                   end
     C*
     c     *in(11)       ifeq      '1'
     c                   exsr      toemm
     c                   goto      start
     c                   end
     C*
     C*   BLA VIDERE
     C*
S15  C*  25              DO
N15  C                   IF        *IN25 AND *IN25 = *OFF
     C                   SETOFF                                       25
     C                   Z-ADD     YRECNO        ZRECNO
     c     *in(80)       ifeq      '0'
s24  C* N94KEYROL        SETLL     ARKIVL08
s24  C* N94KEYR          READE(N)  ARKIVL08                               94
n24  C  N94KEYROL        SETGT     ARKIVL08
n24  C  N94KEYR          READPE(N) ARKIVL08                               94
S04  C* N94KEYR          READE     ARKIVL08                               94
     C                   GOTO      START2
     C                   END
     c     *in(80)       ifeq      '1'
     c     *in(82)       ifeq      '1'
s33  C*                  READ      ARKIVL11                               94
n33  C                   READP     ARKIVL20                               94
     c  N94arun08        comp      uru08                              9494
     C                   GOTO      START2
     c                   end
     c                   end
N02  C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTsr
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
N04  C     ENDRET        IFEQ      'J'
N04  C                   GOTO      START
N04  C                   END
     C                   GOTO      START3
      *
      *** SØK FRA
      *
     C     START6        TAG
     C*
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   EXFMT     VAREL2
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C   12              GOTO      START3
N13  C                   MOVE      '2000'        WSAA
N13  C                   MOVE      WSAAI         WSAA
N13  C                   MOVE      WSMMI         WSMM
N13  C                   MOVE      WSDDI         WSDD
s24  C*                  MOVE      WSDATE        W2DATE
s24  C*                  MOVE      WSTIME        W2TIME
n24  C                   MOVE      WSDATE        W2DATE            8 0
n24  C                   MOVE      WSTIME        W2TIME            6 0
     C                   GOTO      START
     C*
     C     SLUTT         TAG
N05  C                   OUT       SAVUDS
N07  c                   move      *blanks       urunde
N38  c                   move      *blanks       URUNDEI
     C                   SETON                                        LR
     C                   RETURN
     C*
     C*
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
N04  C                   MOVE      ' '           ENDRET            1
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
      * SLUTT PÅ FIL
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
      * CURSOR
     C     ZRECNO        DIV       14            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
N19  C     WSTEX2        IFNE      '*SLETTET'
     C     WSNR          IFEQ      'L'
     C     WSNR          oreq      'V'
N20  C     WSNR          oreq      'H'
N20  C     WSNR          oreq      'I'
N20  C     WSNR          oreq      'J'
N20  C     WSNR          oreq      'K'
     c                   exsr      EPOSR
     C                   MOVE      ' '           WSNR
     c                   update    subfil
     C                   END
     C     WSNR          ifeq      'W'
     c                   exsr      windows
     C                   MOVE      ' '           WSNR
     c                   update    subfil
     C                   END
n04  C     WSNR          ifeq      '2'
n23  C     WSNR          oreq      '3'
n04  C                   exsr      endre
n04  C                   end
N19  C     WSNR          ifeq      '4'
N19  C                   exsr      SLETT
N19  C                   end
      *
      * regenrer arkivdokument
      *
n18  C     WSNR          ifeq      'R'
N18  C     ARTYPE        IFNE      'si'
N18  C     ARTYPE        ANDNE     'se'
N18  C     ARTYPE        ANDNE     'fa'
N42  c     ARTYPE        ANDNE     'sl'
n18  C                   MOVE      'SHU1585'     MSGNR
n18  c                   seton                                        30
n18  c                   goto      slhent2
n18  c                   end
n18  C                   exsr      regensr
n42  C                   MOVE      ' '           WSNR
n42  c                   update    subfil
n18  C                   end
N19  C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
n18  C     SLHENT2       TAG
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
n33  C                   SETOFF                                       82
     C     *ENTRY        PLIST
s36  C*                  PARM                    UAVD              4 0
s36  C*                  PARM                    UOPD              7 0
s36  C*                  PARM                    URUNDE           10
n36  C                   PARM                    UAVDINN           4 0
n36  C                   PARM                    UOPDINN           7 0
n36  C                   PARM                    URUNDEI          10
n36  C                   move      UAVDINN       UAVD              4 0
n36  C                   move      UOPDINN       UOPD              7 0
n36  C                   move      URUNDEI       URUNDE           10
N21  C                   TIME                    XULTID
N21  C                   MOVE      XULDD         ULDD
N21  C                   MOVE      XULMM         ULMM
N21  C                   MOVE      XULÅÅ         ULÅÅ
      *
     c     urunde        comp      *blanks                            8080
     C                   movel     urunde        wsru02            2
     c     wsru02        comp      'T:'                                   81
     c  N81wsru02        comp      'K:'                                   81
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      'A'           ARSTAT
     C                   MOVE      UOPD          WSOPD
     C                   MOVE      Urunde        WSunde
N14  C                   MOVE      UAVD          EPAVD
S20  C*                  MOVE      'J'           EPMAIN
n20  C                   MOVE      ' '           EPMAIN
N14  C                   MOVE      UOPD          EPOPD
     C     kostke3       KLIST
     C                   KFLD                    KABNR
     C     leveke        KLIST
     C                   kfld                    fifirm
     C                   KFLD                    KALNR
     C     keys          KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
s24  C*                  KFLD                    W2date            8 0
s24  C*                  KFLD                    W2time            6 0
     C     keys11        KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    WSunde           10
     C     keyepo        KLIST
     C                   KFLD                    UUSER
     C                   KFLD                    WSLINK
     C     keyep2        KLIST
     C                   KFLD                    UUSER
     C     keyR          KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     keygen        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
N29  C     SADOMTHK      KLIST
N29  C                   KFLD                    WSAVD
N29  C                   KFLD                    WSOPD
N29  C                   KFLD                    SIOMBN
N29  C     SAEOMTHK      KLIST
N29  C                   KFLD                    WSAVD
N29  C                   KFLD                    WSOPD
N29  C                   KFLD                    SEOMBN
     C     KEYROL        KLIST
     C                   KFLD                    ARSTAT
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    Ydate             8 0
     C                   KFLD                    Ytime             6 0
     C                   KFLD                    Ylink            40
     C     dokufk        KLIST
     C                   KFLD                    dfuni
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    WSFNR             3 0
     c                   move      'F'           dfuni             1
     C*
     C     faktke        KLIST
     C                   KFLD                    fauni             1
     C                   KFLD                    WSFANR            7 0
     C*
     C*
     C     faktkk        KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    fakunr
     C*
N34  C     arkukey       KLIST
N34  C                   KFLD                    fifirm
N34  C                   KFLD                    arkund
     C*
     C*
     C     arklagk       KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    arklag
     C*
     c     keygen        chain     headf                              33
     c                   read      firm                                   33
     c     fifirm        chain     firmarc                            33
     c  n33uuser         chain     aruserf                            39
     c                   exsr      antsr
N04  C     KEYKU2        KLIST
N04  C                   KFLD                    FIFIRM
N04  C                   KFLD                    wsKUND
N04  C     KEYUNI        KLIST
N04  C                   KFLD                    ARSTAT
N04  C                   KFLD                    ARAVD
N04  C                   KFLD                    AROPD
N04  C                   KFLD                    ARDATE
N04  C                   KFLD                    ARTIME
N04  C                   KFLD                    ARLINK
N04  C     KEYhea        KLIST
N04  C                   KFLD                    wsavd
N04  C                   KFLD                    wsopd
N04  C     KEYSS         KLIST
N04  C                   KFLD                    SSNR              7 0
      *
N13  C                   MOVE      *ZEROS        WSDATE
N13  C                   MOVE      *ZEROS        WSTIME
     C                   ENDSR
     C*
     C***********************************************
     C     genbane       BEGSR
     C***********************************************
N23   * formater dato
N23  c                   move      ARAA          WSAAA
N23  c                   move      ARMM          WSMMA
N23  c                   move      ARDG          WSDGA
     c     keyext        klist
     c                   kfld                    fifirm
     c                   kfld                    arcext
s03  c*                  move      *blanks       wbane            70
n03  c                   move      *blanks       wbane           140
     c     artype        chain     ARKTXT                             33
     C     ARKLAG        IFNE      *blanks
     c     arklagk       chain     arkext
     c                   else
     c     fifirm        chain     firmarc                            33
     c                   end
     c
     C* genererer bane for lagring
     c     IE            ifeq      'I'
     c                   move      *blanks       wstex1
     c                   move      *blanks       wstex2
     c                   end
     C                   MOVE      'N'           vise              1
     C                   MOVE      ARAVD         AAVD              4
     C                   MOVE      AROPD         AOPD              7
     C                   move      *blanks       updf
s03  c*                  movel     'http://'     updf             76
n03  c                   movel     'http://'     updf            152
     c     ie            ifeq      'I'
N39  c                   if        ARCPSI='J'
N39  c                   eval      updf = 'https://'
N39  c                   endif
n17  c     arcpad        ifne      *blanks
     C     updf          CAT       arcpad:0      updf
n17  C     updf          CAT       '/':0         updf
n17  c                   end
     c                   else
N39  c                   if        ARCPSE='J'
N39  c                   eval      updf = 'https://'
N39  c                   endif
n17  c     arcpae        ifne      *blanks
     C     updf          CAT       arcpae:0      updf
n17  C     updf          CAT       '/':0         updf
n17  c                   end
     c                   end
s17  C*    updf          CAT       '/':0         updf
     c                   movel     '/'           wbane
     c     arcane        ifne      *blanks
N27  c     arbhis        ifne      *blanks
n27  c                   eval      arcane=arbhis
N27  c                   end
     C     updf          CAT       arcane:0      updf
     C     updf          CAT       '/':0         updf
     C     wbane         CAT       arcane:0      wbane
     C     wbane         CAT       '/':0         wbane
     c                   end
     C     updf          CAT       arlink:0      updf
     C     wbane         CAT       arlink:0      wbane
N37  C     '.'           SCAN      arlink                                 33
N37  c     *in33         ifeq      '0'
s37  c*    artyp1        ifge      'a'
s37  c*    artyp1        andle     'z'
     C     '.pdf'        SCAN      updf                                   33
     C  N33'.PDF'        SCAN      updf                                   33
S33  C* N33'.'           SCAN      arlink                                 33
s31  C*    arklag        IFeq      *blanks
s31  C*    *in33         andeq     '0'
n31  C     *in33         ifeq      '0'
     C     updf          CAT       '.pdf':0      updf
     C     wbane         CAT       '.pdf':0      wbane
     C                   END
n33  C                   END
     c     ie            ifeq      'I'
     C                   movel     updf          wslink
     c     artype        chain     ARKTXT                             33
     c  n33              move      artxt         wstex1
N15  C  N33              IF        WSOPD < 0
N15  C                   MOVE      ' OMB'        WSTEX1
N15  C                   END
      * stykkgodsfraktbrev
     c     artype        ifeq      'sb'
     c                   movel     arunde        var03             3
     c                   move      var03         wsfnr
     c     dokufk        chain     dokuf                              33
     c     *in(33)       ifeq      '0'
     C                   movel     'Fb.nr:'      wstex2
     C     wstex2        CAT       df1004:1      wstex2
     C     wstex2        CAT       'Til:':1      wstex2
     C     wstex2        CAT       dfnavm:1      wstex2
     c                   end
     c                   end
N34   * advisering sjø
N34   * AVSENDERSNR.
N34   * MOTTAGERSNR.
N34   * NFY.NR.
N34   * SELGERS AGENT
N34   * KJØPER
N34   * Kundenr REDERI
N34   * KJØPERS AGENT
N34   * REDERI AGENT
n34  c     artype        ifeq      'ad'
N34  c     arkund        andne     0
n34  c                   select
n34  c     arunde1       wheneq    '1'
n34  c                   movel     'Avsendernr:' wstex2
n34  c     arunde1       wheneq    '2'
n34  c                   movel     'Mottagsnr:'  wstex2
n34  c     arunde1       wheneq    '3'
n34  c                   movel     'Notifysnr:'  wstex2
n34  c     arunde1       wheneq    '4'
n34  c                   movel     'Selgeragent:'wstex2
n34  c     arunde1       wheneq    '5'
n34  c                   movel     'Kjøpersnr:'  wstex2
n34  c     arunde1       wheneq    '6'
n34  c                   movel     'Rederi:'     wstex2
n34  c     arunde1       wheneq    '7'
n34  c                   movel     'Kjøperagent:'wstex2
n34  c     arunde1       wheneq    '8'
n34  c                   movel     'Rederiagent' wstex2
n34  c                   endsl
n34  c     arkukey       chain     CUNDL01                            33
n34  c     *in(33)       ifeq      '0'
n34  C     wstex2        CAT       knavn:1       wstex2
n34  c                   end
n34  c                   end
      *samlefaktura
     c     artype        ifeq      'fs'
     c     artype        oreq      'fx'
     c     artype        oreq      'fa'
     C                   movel     'Fanr:'       wstex2
     c                   movel     arunde        var07             7
     C     wstex2        CAT       var07:1       wstex2
     c                   move      var07         wsfanr            7 0
     c                   move      'O'           fauni
     c     faktke        chain     fak3                               33
     C     *IN33         DOWEQ     '0'
     C     FAKDA         ANDEQ     'K'
     c     faktke        READE     fak3                                   33
     C                   END
     c   33              move      'F'           fauni
     c   33faktke        chain     fak3                               33
     C     *IN33         DOWEQ     '0'
     C     FAKDA         ANDEQ     'K'
     c     faktke        READE     fak3                                   33
     C                   END
     c   33              move      'G'           fauni
     c   33faktke        chain     fak3                               33
     C     *IN33         DOWEQ     '0'
     C     FAKDA         ANDEQ     'K'
     c     faktke        READE     fak3                                   33
     C                   END
     c     *in(33)       ifeq      '0'
     C     wstex2        CAT       'dato:':1     wstex2
     C     wstex2        CAT       fadg:1        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       famm:0        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       faaa:0        wstex2
     c     faktkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
     C  N33wstex2        cat       knavn:1       wstex2
     c                   end
     c                   end
      *Godsliste
     c     artype        ifeq      'go'
     c     artype        oreq      'gf'
     C                   movel     'Turnr:'      wstex2
     c                   movel     arunde        var08             8
     c                   move      var08         tupro             8 0
     C     wstex2        CAT       arunde:1      wstex2
     c     tupro         chain     turer14                            33
     c     *in(33)       ifeq      '0'
     C     wstex2        CAT       'Fra:':1      wstex2
     C     wstex2        CAT       tusdf:1       wstex2
     C     wstex2        CAT       'Til:':1      wstex2
     C     wstex2        CAT       tusdt:1       wstex2
     c                   end
     c                   end
      * flyfraktbrev   awb/hawb
     c     artype        ifeq      'aw'
     c     artype        oreq      'am'
     C                   movel     'awb.nr:'     wstex2
     C     wstex2        CAT       hegn:1        wstex2
     C                   IF        artype = 'aw'
     C     wstex2        CAT       'Hawnr:':1    wstex2
     C     wstex2        CAT       hehawb:1      wstex2
     c                   end
     C     wstex2        CAT       'Fra:':1      wstex2
     C     wstex2        CAT       hesdf:1       wstex2
     C     wstex2        CAT       'Til:':1      wstex2
     C     wstex2        CAT       hesdt:1       wstex2
     c                   end
      * SAD import
     c     artype        ifeq      'si'
N29  C                   IF        WSOPD > 0
     c     keygen        chain     sadh                               33
N29  C                   ELSE
N29  C                   ADD       1             SIOMBN
N29  C     SADOMTHK      CHAIN     SADOMTH                            33
N29  C   33keygen        chain     sadh                               33
N29  C                   END
     c     *in(33)       ifeq      '0'
     C                   movel     'Løpenr:'     wstex2
     C     wstex2        CAT       sitle:1       wstex2
     C     wstex2        CAT       sitll:1       wstex2
     C     wstex2        CAT       sidtg:1       wstex2
     C     wstex2        CAT       'kunde:':1    wstex2
     C     wstex2        CAT       sinak:1       wstex2
     c                   end
     c                   end
      * commersial invoice
     c     artype        ifeq      'pf'
     c                   move      arunde        comm              1
     C     comm          ifeq      'Y'
     C                   movel     'Commercial'  wstex2
     C                   end
     C                   end
      * SAD eksport
     c     artype        ifeq      'se'
N29  C                   IF        WSOPD > 0
     c     keygen        chain     saeh                               33
N29  C                   ELSE
N29  C                   ADD       1             SEOMBN
N29  C     SAEOMTHK      CHAIN     SAEOMTH                            33
N29  C   33keygen        chain     saeh                               33
N29  C                   END
     c     *in(33)       ifeq      '0'
     C                   movel     'Løpenr:'     wstex2
     C     wstex2        CAT       setle:1       wstex2
     C     wstex2        CAT       setll:1       wstex2
     C     wstex2        CAT       sedtg:1       wstex2
     C     wstex2        CAT       'kunde:':1    wstex2
     C     wstex2        CAT       senas:1       wstex2
     c                   end
     c                   end
s23   * Z-DOKUMENTER SCANNET
s23  c*                  movel     artype        artyp1            1
s23  c*    artyp1        ifeq      'Z'
s23  C*    wstex2        CAT       'Date:':1     wstex2
s23  C*    wstex2        CAT       ardg:1        wstex2
s23  C*    wstex2        CAT       '.':0         wstex2
s23  C*    wstex2        CAT       armm:0        wstex2
s23  c*    wstex2        CAT       '.':0         wstex2
s23  c*    wstex2        CAT       araa:0        wstex2
s23  C*    wstex2        CAT       'Time:':1     wstex2
s23  c*    wstex2        CAT       artit:1       wstex2
s23  c*    wstex2        CAT       ':':0         wstex2
s23  c*    wstex2        CAT       artim:0       wstex2
s23  C*    wstex2        CAT       ':':0         wstex2
s23  C*    wstex2        CAT       artis:0       wstex2
s23  C*                  end
      * Kostnadsbilag
     c     aru1t3        ifeq      'KL:'
     c                   move      arunde        kabnr
     c     kostke3       chain     kosta                              33
     c     *in(33)       ifeq      '0'
n22  c                   move      *blanks       wstex2
n22  c     kabnr2        ifne      *zeros
     c                   move      kabnr2        kabnr2a           7
     C                   movel     'Bilagsnr:'   wstex2
     C     wstex2        CAT       kabnr2a:1     wstex2
N22  C                   end
N22  c                   move      kabnr2        kabnr2a           7
s30  C*                  movel     'Fakturanr:'  wstex2
n30  C     wstex2        CAT       'Fakturanr:':1wstex2
N22  C     wstex2        CAT       kafnr:1       wstex2
     C     wstex2        CAT       'Navn:':1     wstex2
     c     leveke        chain     level01                            33
     C  N33wstex2        CAT       lnavn:1       wstex2
     C   33wstex2        CAT       katxt:1       wstex2
     c                   end
     c                   end
     c                   else
     C                   movel     updf          wsline
     c                   end
      * tekst i  fritt felt kunderef skjøtes på..
     C     ARRFK         ifne      *blanks
S04  c*    IE            andeq     'I'
S04  c     IE            andeq     'E'
     C                   CAT       ',':0         wstex2
     C                   CAT       ARRFK:1       wstex2
     c                   end
     c                   endsr
     C*
     C***********************************************
     C     eposr         BEGSR
     C***********************************************
     c                   setoff                                       30
     C* skriver til epost
     c     keyepo        chain     arkepow                            33
     C  n33              MOVE      'SHU0861'     MSGNR
     c  N33              seton                                        30
     c  N33              update    arkepor
     c     *in(33)       ifeq      '1'
     c                   move      uuser         epuser
     c                   movel     wslink        eplink
     c                   movel     wsline        epline
     c                   move      wstex1        eptex1
     c                   move      wstex2        eptex2
     C                   MOVE      *BLANKS       EPBANE
N20  c                   move      'N'           epmain
     c     wsnr          ifeq      'V'
N20  c     wsnr          oreq      'H'
N20  C     WSNR          oreq      'I'
N20  C     WSNR          oreq      'J'
N20  C     WSNR          oreq      'K'
     c                   move      wbane         epbane
N20  c                   move      wsnr          epmain
N20  c     wsnr          ifeq      'V'
N20  c                   move      'N'           epmain
N20  c                   end
     c                   end
     c                   write     arkepor
     c                   add       1             wsant
N12   *
N12   * tar vare på info fra siste dokument
N12   *
N12  c                   move      aravd         aavd              4
N12  c                   move      aropd         aopd              7
N12  c                   move      arkund        akun              8
N12  c                   movel     arunde        ar2               2
N12  c     ar2           ifeq      'T:'
n12  c                   move      arunde        atur              8
n12  c                   else
n12  c                   move      hepro         atur
n12  c                   end
     c                   end
     c                   endsr
     C*
     C***********************************************
     C     antsr         BEGSR
     C***********************************************
     c                   z-add     0             wsant
     c     keyep2        setll     arkepow
     c                   setoff                                       34
     c     *in(34)       doweq     '0'
     c     keyep2        reade(N)  arkepow                                34
     c     *in(34)       ifeq      '0'
     c                   add       1             wsant
     c                   end
     c                   end
     c                   endsr
     C***********************************************
     C     toemm         BEGSR
     C***********************************************
     c                   setoff                                       34
     c     keyep2        setll     arkepow
     c     *in(34)       doweq     '0'
     c     keyep2        reade     arkepow                                34
     C*
     c     *in(34)       ifeq      '0'
     c                   delete    arkepor
     c                   end
     c                   end
     c                   z-add     0             wsant
     c                   endsr
     C***********************************************
     C     windows       BEGSR
     C***********************************************
     C                   eval      uwin=wslinw
     c                   call      'SYGE39CL'
     c                   parm                    uwin            512
     c                   endsr
N04  C***********************************************
N04  C     endre         BEGSR
N04  C***********************************************
N23  c                   move      wsnr          wsnrt             1
N04  C                   MOVE      ' '           wsnr
N04  C                   EXSR      MOVSFW
N04  C                   SETON                                        99
N04  C     STCHG         TAG
N04  C                   EXFMT     VARELI
N04  C                   SETOFF                                       309089
N04  C   12              DO
N04  C                   UPDATE    SUBFIL
N04  C                   END
N04  C  N12              EXSR      TESTB1
N04  C  N12
N04  CAN 30              GOTO      STCHG
N04  C     XLIN          IFEQ      0
N04  C                   Z-ADD     14            LINNBR
N04  C                   ELSE
N04  C                   Z-ADD     XLIN          LINNBR
N04  C                   END
N04  C*
N04  C                   ENDSR
N19   ***********************************************
N19  C     SLETT         BEGSR
N19   ***********************************************
N19  C                   MOVE      ' '           wsnr
N19  C                   SETON                                        99
N19  C                   IF        ARTYPE >= 'Z ' AND ARTYPE <= 'Z9'
N19  C                   EVAL      WSJN = 'N'
N19  C                   EXFMT     BEKREFT
N19  C                   IF        WSJN = 'J'
N19  C     KEYUNI        CHAIN     ARKIVL08                           33
N19  C                   EVAL      ARSTAT = 'S'
N21  C                   EVAL      ARUSER = UUSER
N21  c                   move      uldt          ardate
N21  c                   move      XULTM         artime
N19  C                   UPDATE    ARKIVR
N19  C                   EVAL      ARSTAT = 'A'
N19  C                   EVAL      WSTEX2 = '*SLETTET'
N19  C                   EVAL      WSLINW = *BLANKS
N19  C                   END
N19  C                   END
N19  C                   UPDATE    SUBFIL
N19   *
N19  C     XLIN          IFEQ      0
N19  C                   Z-ADD     14            LINNBR
N19  C                   ELSE
N19  C                   Z-ADD     XLIN          LINNBR
N19  C                   END
N19   *
N19  C                   ENDSR
N19   *
N04  C***********************************************
N04  C     MOVSFW        BEGSR
N04  C***********************************************
N04  C                   MOVE      ARTYPE        WSTYPE
N04  C                   MOVE      ARAVD         WSAVD
N04  C                   MOVE      AROPD         WSOPD
N04  C                   MOVE      ARUNDE        WSUNDE
N04  C                   MOVE      ARKUND        WSKUND
N04  C                   MOVE      ARRFK         WSRFK
N04  C                   SETON                                        40
N04  C                   Z-ADD     23            LINNBR
N04  C                   Z-ADD     42            POSNBR
N04  C*
N04  C                   ENDSR
N04  C*
N04  C***********************************************
N04  C     TESTB1        BEGSR
N04  C***********************************************
N04   *
N04   * tester tastet oppdragsnummer
N04   *
N04  C                   Z-ADD     22            LINNBR
N04  c                   movea     '000'         *in(70)
N04  c     wstype        chain     arktxt                             71
N04  c     *in(71)       ifeq      '1'
N04  C                   MOVE      'SHU1020'     MSGNR
N04  c                   seton                                        30
N04  C                   Z-ADD     7             POSNBR
N04  C   30              GOTO      SLTB
N04  c                   end
N04  C*
N04   *
N04   * tester tastet oppdragsnummer
N04   *
N25  C     aravd         ifne      wsavd
N25  C     aropd         orne      wsopd
N04  c     wsun02        iflt      'A '
N04  c     wsun02        orgt      'ZZ'
N04  c     keyhea        chain     headf                              70
N04  c     *in(70)       ifeq      '1'
N04  C                   MOVE      'SPO0001'     MSGNR
N04  c                   seton                                        30
N04  C                   Z-ADD     31            POSNBR
N04  C                   GOTO      SLTB
N04  C                   end
N04  C                   else
N04  C                   testn                   wsun07               33
N04  c     *in(33)       ifeq      '0'
N04  C                   MOVE      'SHU1084'     MSGNR
N04  c                   seton                                        30
N04  C                   Z-ADD     37            POSNBR
N04  C                   GOTO      SLTB
N04  c                   end
N25  c                   end
N04  c                   move      wsun07        ssnr
N04  c     wsun02        ifeq      'SS'
N04  c     keyss         chain     gssorf                             33
N04  c     *in(33)       ifeq      '1'
N04  C                   MOVE      'SHU1085'     MSGNR
N04  c                   seton                                        30
N04  C                   Z-ADD     37            POSNBR
N04  C                   GOTO      SLTB
N04  c                   end
N04  c                   end
N04  c                   end
N04  C*
N04  C*
N04   *
N04   * tester tastet kundenummer
N04   *
N04  c     wskund        ifne      *zeros
N04  c     keyku2        chain     cundl01                            72
N04  c     *in(72)       ifeq      '1'
N04  C                   MOVE      'SPK0001'     MSGNR
N04  c                   seton                                        30
N04  C                   Z-ADD     23            LINNBR
N04  C                   Z-ADD     2             POSNBR
N04  C                   GOTO      SLTB
N04  c                   end
N04  c                   end
N04  C*
N04  C*
N04  C*** OPPDATERE PÅ REGISTER OG SUBFIL
N04  C     KEYUNI        CHAIN     ARKIVL08                           33
N04  C     *IN(33)       IFEQ      '0'
N23  C     wsnrt         ifeq      '3'
N23  C                   update    arkivr
N23  C                   EXSR      MOVWSF
N23  C     kopier        ifeq      'J'
N23  C                   write     ARKIVR
N04  C                   MOVE      'J'           ENDRET
N23  C                   end
N23  c                   else
N04  C                   EXSR      MOVWSF
N04  C                   UPDATE    ARKIVR
N04  C                   MOVE      'J'           ENDRET
N23  C                   end
N04  C                   UPDATE    SUBFIL
N04  C                   END
N04  C                   WRITE     SUBCTL
N04  C*
N04  C     SLTB          ENDSR
N04  C*
N04  C***********************************************
N04  C     MOVWSF        BEGSR
N04  C***********************************************
N23   * test om noe er endret (kan kopieres)
N23  c                   move      'N'           kopier            1
N23  C     wstype        ifne      ARTYPE
N23  c     wsavd         orne      ARAVD
N23  c     WSOPD         orne      AROPD
N23  c     WSUNDE        orne      ARUNDE
N23  c     WSKUND        orne      ARKUND
N23  c     WSRFK         orne      ARRFK
N23  c                   move      'J'           kopier
N23  c                   end
N04   *
N04  C*
N04  C                   MOVE      WSTYPE        ARTYPE
N04  C                   MOVE      WSAVD         ARAVD
N04  C                   MOVE      WSOPD         AROPD
N04  C                   MOVE      WSUNDE        ARUNDE
N04  C                   MOVE      WSKUND        ARKUND
N04  C                   MOVE      WSRFK         ARRFK
N04   * SETTER STATUS FRA E=ERROR TIL  A=OK
N04  C     ARSTAT        IFEQ      'E'
N04  C                   MOVE      'A'           ARSTAT
N04  C                   END
N04   *
N04  C                   ENDSR
N04  C*
n18  C***********************************************
n18  C     REGENSR       BEGSR
n18  C***********************************************
N18  C*** OPPDATERE PÅ REGISTER OG SUBFIL
N18  C     KEYUNI        CHAIN     ARKIVL08                           33
N18  C     *IN(33)       IFEQ      '0'
N18  c                   move      ' '           arstat
N18  c                   eval      aruser=uuser
N18  C                   UPDATE    ARKIVR
N18  c                   move      'A'           arstat
N18   * fortolling import
N18  c     artype        ifeq      'si'
N18  c                   movel     'sj'          arlink
N18  C     KEYUNI        CHAIN     ARKIVL08                           33
N18  C  N33              delete    ARKIVR
N18  c                   movel     'sk'          arlink
N18  C     KEYUNI        CHAIN     ARKIVL08                           33
N18  C  N33              delete    ARKIVR
N18  C                   end
N18   * fortolling eksport
N18  c     artype        ifeq      'se'
N18  c                   movel     'sf'          arlink
N18  C     KEYUNI        CHAIN     ARKIVL08                           33
N18  C  N33              delete    ARKIVR
N18  c                   movel     'sg'          arlink
N18  C     KEYUNI        CHAIN     ARKIVL08                           33
N18  C  N33              delete    ARKIVR
N18  C                   end
n18  c                   move      'N'           nei               1
N18  c                   call      'ARC002CL'
N18  c                   parm                    artype
N18  c                   parm                    aruser
n18  c                   parm                    nei
N04  C                   MOVE      'J'           ENDRET            1
     c                   end
n18  c                   endsr
N26   ***********************************************
N26  C     PRTSKILL      BEGSR
N26   ***********************************************
N26  C
N26  C                   MOVE      '  '          SCATYP            2
N28  C     uavd          ifne      *zeros
N26  C                   MOVEL     UAVD          SCASTR11         11
N26  C                   MOVE      UOPD          SCASTR11         11
N28  C                   else
N28  C                   move      urunde        urunde8           8
N28  c                   eval      SCASTR11=urunde8
N28  c                   end
N26  C                   MOVEL     SCASTR11      SCASTR           20
N26  C                   CALL      'ARCA000CL'
N26  C                   PARM                    SCATYP
N26  C                   PARM                    SCASTR
N26  C                   ENDSR
N32   ***********************************************
N32  C     testfins      BEGSR
N32   ***********************************************
N32  C                   eval      ubanet=wbane
n32  C                   eval      nyobj=arlink
N37  C     '.'           SCAN      arlink                                 33
N37  c     *in33         ifeq      '0'
s37  c*    artyp1        ifge      'a'
s37  c*    artyp1        andle     'z'
n33  C     '.pdf'        SCAN      nyobj                                  44
N33  C  N44'.PDF'        SCAN      nyobj                                  44
n32  c  N44nyobj         CAT       '.pdf':0      nyobj
n33  C                   end
N32  c                   call      'SYGE98CL'
N32  C                   PARM                    ubanet          256
N32  C                   PARM                    nyobj            50
N32  c                   parm                    fins              1
     c     fins          comp      'N'                                    66
s43  c*  66wslinw        cat       '*SLETTET*':1 wslinw
n43  c   66wslinw        cat       '*Mangler*':1 wslinw
     c                   endsr
