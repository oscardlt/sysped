     FHEADF     IF   E           K DISK
     FZEADL02   O  A E           K DISK    RENAME(HEADFR:HEADFRZ)
     FFREETXT   IF   E           K DISK
     FZREETXT1  O  A E           K DISK    RENAME(FREETXTR:FREETRZ)
     FZTELL     UF A E           K DISK
     FFIRM      IF   E           K DISK
     FKUNKO2    IF   E           K DISK
     D                 DS
     D  WTIME                  1     14  0
     D  WTM                    1      4  0
     D  WDM                    7     10  0
     D                 DS
     D  XREFF                  1     17
     D  XAVD                   1      4
     D  XOPD                   5     11
     D  XDM                   12     15
     D  XTMH                  16     17
      * PARAMETRE I DS.
     D                 DS
     D  DSPARM                 1    256
     D  DSKN                   1      8
     D  WSUR                   9      9
     D  WSOT                  10     11
     D  WSFR                  12     14
     D  WSGM1                 15     29
     D  WSGM2                 30     44
     D  WSVS1                 45     69
     D  WSVS2                 70     94
     D  WSFK1                 95     95
     D  WSFK2                 96     96
     D  WSFK3                 97     97
     D  WSFK4                 98     98
     D  WSFK5                 99     99
     D  WSRFA                100    114
     D  DSEND                256    256
      *
      *
     C                   EXSR      INIT
      *
      *  HENT DATA
     C     OPDKEY        CHAIN     HEADF                              33
      *
     C     *IN33         IFEQ      '0'
      * VISSE FELT KAN VÆRE OVERSTYRT...
     C                   MOVE      WSUR          HEUR
     C                   MOVE      YKN           HEKNA
     C                   MOVEL     WSRFA         HERFA
     C                   MOVE      WSOT          HEOT
     C                   MOVE      WSFR          HEFR
     C                   MOVE      WSGM1         HEGM1
     C                   MOVE      WSGM2         HEGM2
     C                   MOVE      WSVS1         HEVS1
     C                   MOVE      WSVS2         HEVS2
      *
      * VISSE FELT SKAL BLANKES
     C                   MOVE      ' '           HEST
     C                   MOVE      ' '           HE01
     C                   MOVE      *ZEROS        HEAVD
     C                   MOVE      *ZEROS        HEOPD
     C                   MOVE      *ZEROS        HEPRO
     C                   Z-ADD     0             HENTF
     C                   MOVE      *ZEROS        HESTD
     C                   MOVE      *ZEROS        HEDTMP
     C                   MOVE      *ZEROS        HEDTÅP
     C                   MOVE      *ZEROS        HEDTCP
     C                   MOVE      *ZEROS        HEBELT
     C                   MOVE      *ZEROS        HEBELM
     C                   MOVE      ' '           HEKDTM
     C                   MOVE      *ZEROS        HEFBK
     C                   MOVE      *ZEROS        HEVN
     C                   MOVE      ' '           HEKDKK
     C                   MOVE      *ZEROS        HEFNGK
     C                   MOVE      *ZEROS        HEFNGS
     C                   MOVE      ' '           HETLKU
     C                   MOVE      *BLANKS       HETLE
     C                   MOVE      *BLANKS       HETLL
     C                   MOVE      *BLANKS       TRSLAG
     C                   MOVE      ' '           HEPK1
     C                   MOVE      ' '           HEPK2
     C                   MOVE      ' '           HEPK3
     C                   MOVE      ' '           HEPK4
     C                   MOVE      ' '           HEPK5
     C                   MOVE      ' '           HEPK6
     C                   MOVE      *BLANKS       HESGM
     C                   MOVE      *BLANKS       HEDTMO
     C                   MOVE      ' '           HEPK7
     C                   MOVE      ' '           HEPK8
     C                   MOVE      ' '           HEPK9
     C                   MOVE      *BLANKS       HEGNN
     C                   MOVE      XREFF         HEREFF
      *
     C     FIFIRM        CHAIN     ZTELL                              33
     C                   IF        *IN33
     C                   Z-ADD     10001         HEUNIK
     C                   Z-ADD     10002         ZUNIK
     C                   MOVE      FIFIRM        FIRMA
     C                   WRITE     ZTELLR
     C                   ELSE
     C                   Z-ADD     ZUNIK         HEUNIK
     C                   ADD       1             ZUNIK
     C                   UPDATE    ZTELLR
     C                   END
      *
     C                   MOVEL     HEKNS         KUINTN
     C     KK2K          CHAIN     KUNKO2                             34
     C     HEKNSF        IFEQ      HEKNS
     C     *IN34         IFEQ      '1'
     C                   MOVE      *ZEROS        HEKNS
     C                   MOVE      *ZEROS        HEKNSF
     C                   ELSE
     C                   MOVE      KUKUN2        HEKNS
     C                   MOVE      KUKUN2        HEKNSF
     C                   END
     C                   ELSE
     C   34              MOVE      *ZEROS        HEKNSF
     C                   MOVEL     HEKNSF        KUINTN
     C     KK2K          CHAIN     KUNKO2                             34
     C   34              MOVE      *ZEROS        HEKNSF
     C  N34              MOVE      KUKUN2        HEKNSF
     C                   END
     C                   MOVEL     HEKNK         KUINTN
     C     KK2K          CHAIN     KUNKO2                             34
     C     HEKNKF        IFEQ      HEKNK
     C     *IN34         IFEQ      '1'
     C                   MOVE      *ZEROS        HEKNK
     C                   MOVE      *ZEROS        HEKNKF
     C                   ELSE
     C                   MOVE      KUKUN2        HEKNK
     C                   MOVE      KUKUN2        HEKNKF
     C                   END
     C                   ELSE
     C   34              MOVE      *ZEROS        HEKNKF
     C                   MOVEL     HEKNSF        KUINTN
     C     KK2K          CHAIN     KUNKO2                             34
     C   34              MOVE      *ZEROS        HEKNKF
     C  N34              MOVE      KUKUN2        HEKNKF
     C                   END
     C                   MOVE      *BLANKS       HEVALS
     C                   MOVE      *BLANKS       HEVALK
     C                   MOVE      *BLANKS       HEKDFS
     C                   MOVE      *BLANKS       HEKDFK
     C                   WRITE     HEADFRZ
      *
     C     OPDKEY        SETLL     FREETXT
     C     OPDKEY        READE     FREETXT                                34
     C     *IN34         DOWEQ     '0'
     C     FRTKOD        IFEQ      WSFK1
     C     FRTKOD        OREQ      WSFK2
     C     FRTKOD        OREQ      WSFK3
     C     FRTKOD        OREQ      WSFK4
     C     FRTKOD        OREQ      WSFK5
     C                   MOVE      *BLANKS       FRTKOD
     C                   MOVE      *ZEROS        FRTAVD
     C                   MOVE      *ZEROS        FRTOPD
     C                   MOVE      HEREFF        FRREFF
     C                   MOVE      HEUNIK        FRUNIK
     C                   WRITE     FREETRZ
     C                   END
     C     OPDKEY        READE     FREETXT                                34
     C  N33              ENDDO
      *
     C                   ENDIF
      *
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *LIKE         DEFINE    HEAVD         YAVD
     C     *LIKE         DEFINE    HEOPD         YOPD
     C     OPDKEY        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     KK2K          KLIST
     C                   KFLD                    YKN
     C                   KFLD                    KUINTN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UOPD              7
     C                   PARM                    UPARM           256
      *
     C                   MOVE      UAVD          YAVD
     C                   MOVE      UOPD          YOPD
     C                   MOVE      UPARM         DSPARM
     C                   MOVE      DSKN          YKN               8 0
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
     C                   MOVE      WDM           XDM
     C                   MOVEL     WTM           XTMH
     C                   MOVE      YAVD          XAVD
     C                   MOVE      YOPD          XOPD
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
