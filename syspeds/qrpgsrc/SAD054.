********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11109 * 01 YBC PTF11 OMBEREGNING PÅ OMBEREGNING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL KOPIERE OPPDRAG TIL OMBEREGNING        ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORER 27-32 34-99
      ***********************************************************
      *
S01  F*SAEH      IF A E           K DISK
S01  F*SAEHOM    IF A E           K DISK    RENAME(SAEHR:SAEHROM)
S01  F*SAEF      IF A E           K DISK    RENAME(SADFR:SAEFR)
N01  FSAEH      UF A E           K DISK
N01  FSAEHOM    UF A E           K DISK    RENAME(SAEHR:SAEHROM)
N01  FSAEF      UF A E           K DISK    RENAME(SADFR:SAEFR)
     FSAEV      UF A E           K DISK
N01  FSAEOMT    UF A E           K DISK
N01  FSAEOMTH   UF A E           K DISK
N01  FSAEOMTF   UF A E           K DISK
N01  FSAEOMTV   UF A E           K DISK
      *
     C                   EXSR      INIT
N01   *
N01  C                   SELECT
N01  C                   WHEN      UTYPE = 'NYO'                                NY OMBEREGNING
N01  C*                  EXSR      SRNYOMBORI                                   ORIGINAL FORTOLLING
N01  C                   EXSR      SRNYOMB                                      SISTE OMBEREGNING
N01  C                   WHEN      UTYPE = 'NYS'                                ANGRE NY OMBEREGNING
N01  C                   EXSR      SRANGOMB
N01  C                   ENDSL
      *
S01  C*    SAEHK         CHAIN     SAEHOM                             33
N01  C     SAEHK         CHAIN(N)  SAEHOM                             33
     C                   SELECT
     C                   WHEN      *IN33 AND UTYPE <> 'OMS'
     C                   EVAL      SETDN = UTDN * -1
      *
S01  C*    SAEHK         CHAIN     SAEH                               33
N01  C     SAEHK         CHAIN(N)  SAEH                               33
     C                   MULT      -1            SETDN
     C                   EVAL      SEST   = ' '
     C                   EVAL      SESG   = USG
     C                   EVAL      SEMF   = *BLANKS
     C                   MOVE      WDT           SEDT
     C                   WRITE     SAEHR
     C                   WRITE     SAEHROM
      *
     C                   EVAL      SETDN = UTDN * -1
      *
     C     SAEHK         SETLL     SAEF
     C     SAEHK         READE     SAEF                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SFOPDN
     C                   WRITE     SAEFR
     C     SAEHK         READE     SAEF                                   33
     C                   ENDDO
      *
     C     SAEHK         SETLL     SAEV
     C     SAEHK         READE(N)  SAEV                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SVTDN
     C                   WRITE     SAEVR
     C     SAEHK         READE(N)  SAEV                                   33
     C                   ENDDO
      *
      * OMSTART: SLETT GAMLE OG LAGE NYE I OMBEREGNINGSOPPDRAG
     C                   WHEN      *IN33 = *OFF AND UTYPE = 'OMS'
      * SLETT GAMLE LINJE I OMBEREGNINGSOPPDRAG (SETDN < 0)
     C     SAEHK         SETLL     SAEV
     C     SAEHK         READE     SAEV                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SAEVR
     C     SAEHK         READE     SAEV                                   33
     C                   ENDDO
      * LAGE NYE LINJER
     C                   EVAL      SETDN = UTDN * -1
     C     SAEHK         SETLL     SAEV
     C     SAEHK         READE(N)  SAEV                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SVTDN
     C                   WRITE     SAEVR
     C     SAEHK         READE(N)  SAEV                                   33
     C                   ENDDO
      *
     C                   END
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     SAEHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    SETDN
N01  C     SAEHKOM       KLIST
N01  C                   KFLD                    UAVD
N01  C                   KFLD                    UTDN
N01  C     SAEHKORI      KLIST
N01  C                   KFLD                    X_SEAVD
N01  C                   KFLD                    X_SETDN
N01  C     SAEOMTK       KLIST
N01  C                   KFLD                    UAVD
N01  C                   KFLD                    UTDN
N01  C                   KFLD                    SEOMBN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG
     C                   PARM                    UTYPE             3
      *
     C     *LIKE         DEFINE    SEAVD         UAVD
     C     *LIKE         DEFINE    SETDN         UTDN
     C     *LIKE         DEFINE    SESG          USG
N01  C     *LIKE         DEFINE    SEAVD         X_SEAVD
N01  C     *LIKE         DEFINE    SETDN         X_SETDN
N01  C     *LIKE         DEFINE    SETLL         X_SETLL
N01  C     *LIKE         DEFINE    SETLE         X_SETLE
N01  C     *LIKE         DEFINE    SEDTG         X_SEDTG
N01  C     *LIKE         DEFINE    SEOMBN        X_SEOMBN
     C                   EVAL      SETDN = UTDN
N01  C                   EVAL      X_SEAVD = UAVD
N01  C                   EVAL      X_SETDN = UTDN * -1
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     SRNYOMB       BEGSR
N01   ***********************************************
N01  C                   EVAL      SEOMBN = 99
N01  C     SAEOMTK       SETLL     SAEOMT
N01  C     SAEHKOM       READPE(N) SAEOMT                                 33
N01  C                   IF        *IN33
N01  C                   EVAL      X_SEOMBN = 1
N01  C                   ELSE
N01  C                   EVAL      X_SEOMBN = SEOMBN + 1
N01  C                   END
N01  C                   CLEAR                   SAEOMTR
N01  C                   MOVE      WDT           SEDTSL
N01  C                   MOVE      WTM           SETMSL
N01   *
N01  C     SAEHKOM       CHAIN(N)  SAEHOM                             33
N01  C                   EVAL      SEOMBN = X_SEOMBN
N01  C                   WRITE     SAEOMTR
N01  C     SAEHKORI      CHAIN(N)  SAEH                               33
N01  C                   EVAL      X_SETLL  = SETLL
N01  C                   EVAL      X_SETLE  = SETLE
N01  C                   EVAL      X_SEDTG  = SEDTG
N01  C     SAEHKOM       CHAIN     SAEH                               33
N01  C                   EVAL      SEOMBN = X_SEOMBN
N01  C                   WRITE     SAEOMTHR
N01  C                   EVAL      SETLL  = X_SETLL
N01  C                   EVAL      SETLE  = X_SETLE
N01  C                   EVAL      SEDTG  = X_SEDTG
N01  C                   EVAL      SEMF   = *BLANKS
N01  C                   UPDATE    SAEHR
N01  C     SAEHKOM       SETLL     SAEF
N01  C     SAEHKOM       READE(N)  SAEF                                   33
N01  C                   EVAL      SFOMBN = X_SEOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEOMTFR
N01  C     SAEHKOM       READE(N)  SAEF                                   33
N01  C                   ENDDO
N01  C     SAEHKOM       SETLL     SAEV
N01  C     SAEHKOM       READE(N)  SAEV                                   33
N01  C                   EVAL      SVOMBN = X_SEOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEOMTVR
N01  C     SAEHKOM       READE(N)  SAEV                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SAEVR
N01   *
N01  C                   EVAL      *INLR = *ON
N01  C                   RETURN
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     SRNYOMBORI    BEGSR
N01   ***********************************************
N01  C                   EVAL      SEOMBN = 99
N01  C     SAEOMTK       SETLL     SAEOMT
N01  C     SAEHKOM       READPE(N) SAEOMT                                 33
N01  C                   IF        *IN33
N01  C                   EVAL      X_SEOMBN = 1
N01  C                   ELSE
N01  C                   EVAL      X_SEOMBN = SEOMBN + 1
N01  C                   END
N01  C                   CLEAR                   SAEOMTR
N01  C                   MOVE      WDT           SEDTSL
N01  C                   MOVE      WTM           SETMSL
N01   *
N01  C     SAEHKOM       CHAIN     SAEHOM                             33
N01  C                   EVAL      SEOMBN = X_SEOMBN
N01  C                   WRITE     SAEOMTR
N01  C                   DELETE    SAEHROM
N01  C                   CLEAR                   SAEHROM
N01  C     SAEHKOM       CHAIN     SAEH                               33
N01  C                   EVAL      SEOMBN = X_SEOMBN
N01  C                   WRITE     SAEOMTHR
N01  C                   DELETE    SAEHR
N01  C                   CLEAR                   SAEHR
N01  C     SAEHKOM       SETLL     SAEF
N01  C     SAEHKOM       READE     SAEF                                   33
N01  C                   EVAL      SFOMBN = X_SEOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEOMTFR
N01  C                   DELETE    SAEFR
N01  C     SAEHKOM       READE     SAEF                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SAEFR
N01  C     SAEHKOM       SETLL     SAEV
N01  C     SAEHKOM       READE     SAEV                                   33
N01  C                   EVAL      SVOMBN = X_SEOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEOMTVR
N01  C                   DELETE    SAEVR
N01  C     SAEHKOM       READE     SAEV                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SAEVR
N01   *
N01  C                   EVAL      UTYPE = 'OMB'
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     SRANGOMB      BEGSR
N01   ***********************************************
N01   * SJEKK OM TIDLIGERE OMBEREGNING FINNES
N01  C                   EVAL      SEOMBN = 99
N01  C     SAEOMTK       SETLL     SAEOMT
N01  C     SAEHKOM       READPE(N) SAEOMT                                 33
N01  C   33              GOTO      SLANGOMB
N01  C                   EVAL      X_SEOMBN = SEOMBN
N01   *
N01   * SLETT UFERDIG OMBEREGNING
N01  C     SAEHKOM       CHAIN     SAEHOM                             33
N01  C                   DELETE    SAEHROM
N01  C     SAEHKOM       CHAIN     SAEH                               33
N01  C                   DELETE    SAEHR
N01  C     SAEHKOM       SETLL     SAEF
N01  C     SAEHKOM       READE     SAEF                                   33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SAEFR
N01  C     SAEHKOM       READE     SAEF                                   33
N01  C                   ENDDO
N01  C     SAEHKOM       SETLL     SAEV
N01  C     SAEHKOM       READE     SAEV                                   33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SAEVR
N01  C     SAEHKOM       READE     SAEV                                   33
N01  C                   ENDDO
N01   *
N01   * FLYTT SISTE OMBEREGNING TILBAKE
N01  C                   EVAL      SEOMBN = X_SEOMBN
N01   *
N01  C     SAEOMTK       CHAIN     SAEOMT                             33
N01  C                   WRITE     SAEHROM
N01  C                   DELETE    SAEOMTR
N01  C     SAEOMTK       CHAIN     SAEOMTH                            33
N01  C                   WRITE     SAEHR
N01  C                   DELETE    SAEOMTHR
N01  C     SAEOMTK       SETLL     SAEOMTF
N01  C     SAEOMTK       READE     SAEOMTF                                33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEFR
N01  C                   DELETE    SAEOMTFR
N01  C     SAEOMTK       READE     SAEOMTF                                33
N01  C                   ENDDO
N01  C     SAEOMTK       SETLL     SAEOMTV
N01  C     SAEOMTK       READE     SAEOMTV                                33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SAEVR
N01  C                   DELETE    SAEOMTVR
N01  C     SAEOMTK       READE     SAEOMTV                                33
N01  C                   ENDDO
N01   *
N01  C     SLANGOMB      TAG
N01  C                   EVAL      *INLR = *ON
N01  C                   RETURN
N01   *
N01  C                   ENDSR
N01   *
