/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 11XXX * 01 SH  PTF12 KUNDNR I PARAMETER.....                           */
/* ********************************************************************    */
/*           PGM        PARM(&FAX &FILEN &PTIME &PDATE &KNAVN &AVD +
                          &OPD &KODE &DONAV &CVP1 &CVP2 &CVP3 &CVP4 +
                          &CVP5 &CVP6 &CVP7 &CVP8 &FBN &CVP &EPOST +
                          &EPOSTJ &EMNE)   */
             PGM        PARM(&FAX &FILEN &PTIME &PDATE &KNAVN &AVD +
                          &OPD &KODE &DONAV &CVP1 &CVP2 &CVP3 &CVP4 +
                          &CVP5 &CVP6 &CVP7 &CVP8 &FBN &CVP &EPOST +
                          &EPOSTJ &EMNE &KUNDNR)
/* N01 */    DCL        VAR(&KUNDNR) TYPE(*CHAR) LEN(8)
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(40)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BPARM) TYPE(*CHAR) LEN(425)
/*           DCL        VAR(&BPARM2) TYPE(*CHAR) LEN(536)  */
             DCL        VAR(&BPARM2) TYPE(*CHAR) LEN(544)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&KNAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FBN) TYPE(*CHAR) LEN(3)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&E) TYPE(*CHAR) LEN(1) VALUE('E')
             DCL        VAR(&DONAV) TYPE(*CHAR) LEN(12)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ATTN) TYPE(*CHAR) LEN(30)
    /* */
             DCLF       FILE(FAXSEN)

             RCVF       RCDFMT(*FILE)
    /* */
/*                         */
/*  EPOST SENDING          */
/*                         */
DMPCLPGM
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&BPARM2) VALUE(&FAX *CAT &FILEN *CAT +
                          &PTIME *CAT &PDATE *CAT &KNAVN *CAT &AVD +
                          *CAT &OPD *CAT &KODE *CAT &DONAV *CAT +
                          &CVP1 *CAT &CVP2 *CAT &CVP3 *CAT &CVP4 +
                          *CAT &CVP5 *CAT &CVP6 *CAT &CVP7 *CAT +
                          &CVP8 *CAT &FBN *CAT &CVP *CAT &EMNE *CAT +
                          &EPOST *CAT &EPOSTJ *CAT &KUNDNR)
             SBMJOB     CMD(CALL PGM(FAX025CLE) PARM(&BPARM2)) +
                          JOB(SNDTOLLDEK) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             RETURN
             ENDDO
/*                         */
/*                         */
/*  FACSIMILE SUPPORT 400  */
/*            0            */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             CHGVAR     VAR(&BPARM) VALUE(&FAX *CAT &FILEN *CAT +
                          &PTIME *CAT &PDATE *CAT &KNAVN *CAT &AVD +
                          *CAT &OPD *CAT &KODE *CAT &DONAV *CAT +
                          &CVP1 *CAT &CVP2 *CAT &CVP3 *CAT &CVP4 +
                          *CAT &CVP5 *CAT &CVP6 *CAT &CVP7 *CAT +
                          &CVP8 *CAT &FBN *CAT &CVP)
             SBMJOB     CMD(CALL PGM(FAX025CLJ) PARM(&BPARM)) +
                          JOB(SNDTOLLDEK) JOBD(*USRPRF) +
                          JOBQ(QFAX/QFAXJOBQ)
             GOTO       CMDLBL(SLUTT)
             ENDDO
/*                         */
/*  FAX400                 */
/*                         */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             CHGVAR     VAR(&ATTN) VALUE(%SST(&CVP2 1 30))
             SBMJOB     CMD(CALL PGM(FAX025CLJ2) PARM(&FAX &FILEN +
                          &PTIME &PDATE &KNAVN &AVD &OPD &FBN &KODE +
                          &DONAV &ATTN)) JOB(SNDTOLLDEK) +
                          JOBD(*USRPRF) JOBQ(SYJOBQNMAX)
             ENDDO
/*                         */
/*  BLUEFAX                */
/*                         */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             CHGVAR     VAR(&BPARM) VALUE(&FAX *CAT &FILEN *CAT +
                          &PTIME *CAT &PDATE *CAT &KNAVN *CAT &AVD +
                          *CAT &OPD *CAT &KODE *CAT &DONAV *CAT +
                          &CVP1 *CAT &CVP2 *CAT &CVP3 *CAT &CVP4 +
                          *CAT &CVP5 *CAT &CVP6 *CAT &CVP7 *CAT +
                          &CVP8 *CAT &FBN *CAT &CVP)
             SBMJOB     CMD(CALL PGM(FAX025CLJB) PARM(&BPARM)) +
                          JOB(SNDTOLLDEK) JOBD(*USRPRF) +
                          JOBQ(SYJOBQNMAX)
             ENDDO
    /* */
 SLUTT:      ENDPGM
