********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 CB  PTF12 Hentet for mange filer
     h DFTACTGRP(*NO) debug(*yes)
     flsoutput  if   f  256        disk
     fsvt203fr  o  a f  512        disk
     ‚*  Prototype for svt203r2
     d svt203r2        pr
     d lib_                                like(lib)
     ‚*  *ENTRY Interface for Main Procedure
     d svt203r2        pi
     d lib                           10

     d data            s            512
     d datf1           s             10
     d datf2           s             10
     d datf3           s             10
     d datf4           s             10
     d datf5           s             10
     d*wdt             s              8
     d wtm             s              6
     d pos             s              5u 0
     d x               s              5s 0
     d                 ds
     d datf                          10
     d  datf01                        6    overlay(datf)
     d   datf05                       2    overlay(datf01:5)
     d  datf07                        4    overlay(datf:7)
     d                 ds
     d wdt                            8
     d   wdt6                         6    overlay(wdt:3)
     ‚*  Prototype for 'SYGE15C'
     d syge15c         pr                  extpgm('SYGE15C')
     d wdt_                                like(wdt)
     d wtm_                                like(wtm)

     ilsoutput  aa  01
     i                                  1  256  file
     i                                  1    4  f4

      /free

       // Fixe søkestrenger for datotest
       syge15c ( wdt : wtm );
       datf01=wdt6;
       datf07='.xml';
       datf05='01';
       datf1=datf;
       datf05='02';
       datf2=datf;
       datf05='03';
       datf3=datf;
       datf05='04';
       datf4=datf;
       datf05='05';
       datf5=datf;

       // Userid and Password
N02    data = 'M10746-1';
       data = %trimr(data) + ' ' + 'kehts3qW';
       except awrk;

       // sendepsv 0
       data = 'sendepsv 0';
       except awrk;

       // Namefmt
       data = 'NAMEFMT 1';
       except awrk;

       // Bin
       data = 'BIN';
       except awrk;

       // CD
       data=*blanks;
       data='CD /www1/distr/tulltaxan/xml/tot';
       except awrk;
       // Get
       read lsoutput;
       dow not %eof;

         if f4 <> '.   '
           and f4 <> '..  ';

           pos = %scan (datf1 : file);
           if pos=0;
               pos = %scan (datf2 : file);
               if pos=0;
                   pos = %scan (datf3 : file);
                   if pos=0;
                       pos = %scan (datf4 : file);
                       if pos=0;
                           pos = %scan (datf5 : file);
                       endif;
                   endif;
               endif;
           endif;


           if pos > 0;
             x = x + 1;

             data = 'get' + ' ' + file + ' /' + %trim(lib) +
                    '/TDS/TTAX/tot/' + %trim(file);
             except awrk;

           endif;
         endif;

         read lsoutput;
         enddo;

       // Quit
       data = 'quit';
       except awrk;

       *inlr=*on;

      /end-free

     osvt203fr  eadd         awrk
N02  o                       data               512
