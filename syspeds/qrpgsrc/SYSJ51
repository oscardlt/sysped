      *
      ***************************************************************
      *** PROGRAM SKAL ENDRE DATO I B/L OG BOOKING                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 01 02 04 06-11 13-26                 ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-96                    ***
      ***************************************************************
      *
     FBILLOFL2  UF   E           K DISK
     FBOOKLF10  UF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FSYSJ51FM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTÅ                   1      4  0
     D  XDTM                   5      6  0
     D  XDTD                   7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  BLDTAÅ                 1      4  0
     D  BLDTAM                 5      6  0
     D  BLDTAD                 7      8  0
     D  BLDTA                  1      8  0
     D                 DS
     D  BODTÅ1                 1      4  0
     D  BODTM1                 5      6  0
     D  BODTD1                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  WSDTGD                 1      2  0
     D  WSDTGM                 3      4  0
     D  WSDTGÅ                 5      6  0
     D  WSDTG                  1      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30
     CANN04              DO
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      *BLANKS       WSBK
     C                   MOVE      *BLANKS       WSREIS
     C                   MOVE      *ZEROS        WSDT
     C                   END
     C                   EXSR      KDTFM1
     C                   EXFMT     BILDE01
     C   03              GOTO      SLUTT
     C                   EXSR      KDTFM1
     C                   MOVEA     '000'         *IN(97)
     C                   SETOFF                                       30
     C   04              DO
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBK
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      TESTB
     C   30              GOTO      START
     C*
     C                   EXSR      KDTFM2
     C     START2        TAG
     C                   EXFMT     BILDE02
     C   12              GOTO      START
     C  N05              GOTO      START2
     C                   EXSR      OPDFIL
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WSBK          CHAIN     CDBOAT                             99
     C   99              DO
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'SPB0104'     MSGNR
     C                   SETON                                        30
     C                   END
     C*
     C     WSREIS        COMP      *BLANKS                                98
     C   98
     CANN30              DO                                                     1<-B
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'SPR0101'     MSGNR
     C                   SETON                                        30
     C                   END                                                    1<-E
     C  N98              DO                                                     1<-B
     C                   Z-ADD     1             YAVD              4 0
     C     BILL2K        SETLL     BILLOFL2
     C                   SETOFF                                       33
     C     STTB1         TAG
     C                   READ      BILLOFL2                               33
     C  N33              DO                                                      2<-B
     C                   EXCEPT    OPDBL
     C     WSREIS        IFEQ      BLREIS                                         3<-B
     C     WSBK          IFEQ      BLOB                                            4<-B
     C     WSBK          OREQ      BLLB
     C                   MOVE      BLDTAD        WSDTGD
     C                   MOVE      BLDTAM        WSDTGM
     C                   MOVE      BLDTAÅ        WSDTGÅ
     C                   GOTO      STTB2
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     YAVD          IFNE      BLAVD                                          3<-B
     C                   MOVE      BLAVD         YAVD
     C     BILL2K        SETLL     BILLOFL2
     C                   END                                                      3<-E
     C                   GOTO      STTB1
     C                   END                                                     2<-E
     C                   Z-ADD     1             YAVD              4 0
     C     BOK10K        SETLL     BOOKLF10
     C                   SETOFF                                       33
     C     STTB11        TAG
     C                   READ      BOOKLF10                               33
     C  N33              DO                                                      2<-B
     C                   EXCEPT    OPDBK
     C     WSREIS        IFEQ      BOREIS                                         3<-B
     C     WSBK          IFEQ      BOOB                                            4<-B
     C     WSBK          OREQ      BOLB
     C                   MOVE      BODTD1        WSDTGD
     C                   MOVE      BODTM1        WSDTGM
     C                   MOVE      BODTÅ1        WSDTGÅ
     C                   GOTO      STTB2
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     YAVD          IFNE      BOAVD                                          3<-B
     C                   MOVE      BOAVD         YAVD
     C     BOK10K        SETLL     BOOKLF10
     C                   END                                                      3<-E
     C                   GOTO      STTB11
     C                   END                                                     2<-E
     C  N30              DO                                                      2<-B
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'SPR0103'     MSGNR
     C                   SETON                                        30
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     STTB2         TAG
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C   97
     CANN30              DO
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDFIL        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         XDTD
     C                   MOVE      WSDTM         XDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          XDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          XDTÅ
     C                   END
     C*
     C                   Z-ADD     1             YAVD              4 0
     C     BILL2K        SETLL     BILLOFL2
     C                   SETOFF                                       33
     C     STOPD1        TAG
     C                   READ      BILLOFL2                               33
     C  N33              DO                                                     1<-B
     C     WSREIS        IFEQ      BLREIS                                        2<-B
     C     WSOPD         ANDLE     BLOPD
     C     WSBK          IFEQ      BLOB                                           3<-B
     C     WSBK          OREQ      BLLB
     C                   MOVE      XDT           BLDTA
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   EXCEPT    OPDBL
     C     YAVD          IFNE      BLAVD                                         2<-B
     C                   MOVE      BLAVD         YAVD
     C     BILL2K        SETLL     BILLOFL2
     C                   END                                                     2<-E
     C                   GOTO      STOPD1
     C                   END                                                    1<-E
     C*
     C                   Z-ADD     1             YAVD              4 0
     C     BOK10K        SETLL     BOOKLF10
     C                   SETOFF                                       33
     C     STOPD2        TAG
     C                   READ      BOOKLF10                               33
     C  N33              DO                                                     1<-B
     C     WSREIS        IFEQ      BOREIS                                        2<-B
     C     WSOPD         ANDLE     BOOPD
     C     WSBK          IFEQ      BOOB                                           3<-B
     C     WSBK          OREQ      BOLB
     C                   MOVE      XDT           BODT1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   EXCEPT    OPDBK
     C     YAVD          IFNE      BOAVD                                         2<-B
     C                   MOVE      BOAVD         YAVD
     C     BOK10K        SETLL     BOOKLF10
     C                   END                                                     2<-E
     C                   GOTO      STOPD2
     C                   END                                                    1<-E
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOK10K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    WSREIS
     C     BILL2K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    WSREIS
     C*
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTG
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        BODT1
     C                   MOVE      *ZEROS        BLDTA
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM2        BEGSR
     C***********************************************
     C                   MOVE      WSDTGD        UDT1              2 0
     C                   MOVE      WSDTGM        UDT2              2 0
     C                   MOVE      WSDTGÅ        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          WSDTGD
     C                   MOVE      UDT2          WSDTGM
     C                   MOVE      UDT3          WSDTGÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     OBILLOFR   E            OPDBL
     O                       BLDTA
     OBOOKINGR  E            OPDBK
     O                       BODT1
