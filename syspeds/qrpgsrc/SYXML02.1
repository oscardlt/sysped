      *
      ***********************************************************
      *** PROGRAM SKAL SENDE XML-FAKTURA E2B                  ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-49 51-99                ***
      ***********************************************************
     FFIRM      IF   E           K DISK
     FXMLUFL1   UF   E           K DISK
     FXMLTILP   O  A E           K DISK    USROPN
     FECMSG     IF   E           K DISK
     FKODWL01   IF   E           K DISK    USROPN
     FKODTA     IF   E           K DISK    USROPN
     FKODTGE    IF   E           K DISK    USROPN
     FKODTG2    IF   E           K DISK    USROPN
     FKODTFR    IF   E           K DISK    USROPN
     FKODTOTY   IF   E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FFAIN      IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FFAK8      IF   E           K DISK    USROPN
     FFRISOK    IF   E           K DISK    USROPN
     FKODFRI    IF   E           K DISK    USROPN
     FFREETXT2  IF   E           K DISK
     FEDIC      UF A E             DISK    USROPN
     FEDIS      O  A E             DISK    USROPN
     FEDIM      O  A E             DISK    USROPN
     FEDISE     O  A E             DISK    USROPN
     D TXT             S             80    DIM(162) CTDATA PERRCD(1)
     D TXT01           S             80    DIM(2) CTDATA PERRCD(1)
     D VEDL            S             70    DIM(900)
     D                 DS
     D  XTXT05                 1      5
     D  XT05                   1      5    DIM(5)
     D                 DS
     D  XTXT40                 1     40
     D  XT40                   1     40    DIM(40)
     D                 DS
     D  XTXT801                1     80
     D  XT801                  1     80    DIM(80)
     D                 DS
     D  XTXT802                1     80
     D  XT802                  1     80    DIM(80)
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  XMBR                   1     10
     D  XMBRA                  1      1
     D  XMBRB                  2      8S 0
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  WTM                    1      6
     D  WTMH                   1      2
     D  WTMM                   3      4
     D  WTMS                   5      6
     D                 DS
     D  HEAVD                  1      4  0
     D  XXSTREKK1              5      5
     D  HEOPD                  6     10  0
     D  XXSTREKK2             11     11
     D  HESG                  12     14
     D  SYSPEDREF              1     14
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTOPÅ                1      4
     D  HEDTOPM                5      6
     D  HEDTOPD                7      8
     D                 DS
     D  FADATO                 1      8  0
     D  FADATOÅ                1      4
     D  FADATOM                5      6
     D  FADATOD                7      8
     D                 DS
     D  FADAFF                 1      8  0
     D  FADAFFÅ                1      4
     D  FADAFFM                5      6
     D  FADAFFD                7      8
     D                 DS
     D  SYKT8                  1      8
     D  SYFR02                 1      1
     D  SYKT7                  2      7
     D  SYKONT                 2      8  0
     D                 DS
     D  XMLT1                  1     44  2 DIM(11)
     D  XFMS01                 1      4  2
     D  XFMS02                 5      8  2
     D  XFMS03                 9     12  2
     D  XFMS04                13     16  2
     D  XFMS05                17     20  2
     D  XFMS06                21     24  2
     D  XFMS07                25     28  2
     D  XFMS08                29     32  2
     D  XFMS09                33     36  2
     D  XFMS10                37     40  2
     D  XFMS11                41     44  2
     D                 DS
     D  XMLT2                  1     33    DIM(11)
     D  XFMV01                 1      3
     D  XFMV02                 4      6
     D  XFMV03                 7      9
     D  XFMV04                10     12
     D  XFMV05                13     15
     D  XFMV06                16     18
     D  XFMV07                19     21
     D  XFMV08                22     24
     D  XFMV09                25     27
     D  XFMV10                28     30
     D  XFMV11                31     33
     D                 DS
     D  XMLT3                  1    143  2 DIM(11)
     D  XFMGN1                 1     13  2
     D  XFMGN2                14     26  2
     D  XFMGN3                27     39  2
     D  XFMGN4                40     52  2
     D  XFMGN5                53     65  2
     D  XFMGN6                66     78  2
     D  XFMGN7                79     91  2
     D  XFMGN8                92    104  2
     D  XFMGN9               105    117  2
     D  XFMGNA               118    130  2
     D  XFMGNB               131    143  2
     D                 DS
     D  XMLT4                  1    143  2 DIM(11)
     D  XFMGV1                 1     13  2
     D  XFMGV2                14     26  2
     D  XFMGV3                27     39  2
     D  XFMGV4                40     52  2
     D  XFMGV5                53     65  2
     D  XFMGV6                66     78  2
     D  XFMGV7                79     91  2
     D  XFMGV8                92    104  2
     D  XFMGV9               105    117  2
     D  XFMGVA               118    130  2
     D  XFMGVB               131    143  2
     D                 DS
     D  FSDOKK                 1     10
     D  DFS                    1     10    DIM(10)
     D                 DS
     D  SYRG                   1     14
     D  SYRG9                  1      9
      *
     C                   EXSR      INIT
      *
      * Teller antall fakturaer
     C     START         TAG
     C                   MOVE      *ZEROS        S0036
     C     XMLUFL1K      SETLL     XMLUFL1
     C     XMLUFL1K      READE     XMLUFL1                                50
     C   50              GOTO      SLUTT
     C                   MOVE      XFKN          XXKN              8 0
     C                   DOW       *IN50 = *OFF
     C                   IF        XFKN = XXKN
     C     ECMSGK        CHAIN     ECMSG                              33
     C                   IF        *IN33 = *OFF
     C                   ADD       1             S0036
     C                   MOVE      'A'           XFST
     C                   END
     C                   END
     C                   UPDATE    XMLUFFR
     C     XMLUFL1K      READE     XMLUFL1                                50
     C                   ENDDO
      *
     C                   EXSR      SRBYGGF
     C                   EXSR      SRSNDST
      *
     C                   MOVE      'A'           XXST
     C     XMLUFL1K      SETLL     XMLUFL1
     C     START1        TAG
     C     XMLUFL1K      READE     XMLUFL1                                50
     C                   IF        *IN50
     C                   EXSR      SRSNDSL
     C                   MOVE      ' '           XXST
     C                   GOTO      START
     C                   END
      *
     C                   EXSR      SRENVELOP
     C                   EXSR      SRINVOICE
      * Oppdate EDIM
     C                   EXSR      OPDEDIM
      * Oppdater XMLUFF
     C                   MOVE      'C'           XFST
     C                   MOVE      WDT           XFDTS
     C                   MOVE      WTM           XFTDS
     C                   UPDATE    XMLUFFR
      *
     C                   GOTO      START1
      *
     C     SLUTT         TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SRBYGGF       BEGSR
      ***********************************************
     C                   CALL      'SYXML01B'
     C                   OPEN      XMLTILP
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSNDST       BEGSR
      ***********************************************
     C                   OPEN      KODWL01
     C                   OPEN      KODTA
     C                   OPEN      KODTGE
     C                   OPEN      KODTG2
     C                   OPEN      KODTFR
     C                   OPEN      KODTOTY
     C                   OPEN      CUNDL01
     C                   OPEN      FAIN
     C                   OPEN      HEADF
     C                   OPEN      FAK8
     C                   OPEN      FRISOK
     C                   OPEN      KODFRI
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE
      *
     C     ECMSGK        CHAIN     ECMSG                              33
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
     C                   MOVE      XMBR          SEMBR
     C                   MOVE      *BLANKS       SDATA
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM
      *
     C                   EVAL      S0004 = ECIIDI
     C                   EVAL      S0010 = ECIIDC
     C                   EVAL      S0020 = SEMBR
     C                   EVAL      SSN   = CSN
     C                   EVAL      SSR   = 'S'
     C                   EVAL      SST   = 'X'
     C                   MOVE      WDT           SDT
     C                   MOVE      WTM           STM
     C                   EVAL      SLIB  = '*LIBL'
     C                   EVAL      SFILE = 'EDISE'
     C                   EVAL      SMBR  = SEMBR
     C                   EVAL      SMBRS  = 0
     C                   WRITE     EDISR
      *
     C                   MOVE      *ZEROS        XANTMSG           5 0
      *
     C                   EVAL      SDATA = TXT(001)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(002)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(003)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(004)
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT(005)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRENVELOP     BEGSR
      ***********************************************
      * Envelop start
     C                   EVAL      SDATA = TXT(007)
     C                   EXSR      TILFIL
      * InterchangeId
     C                   EVAL      SDATA = TXT(009)
     C                   CAT       SEMBR:0       SDATA
     C                   CAT       TXT(010):0    SDATA
     C                   EXSR      TILFIL
      * From
     C                   EVAL      SDATA = TXT(011)
     C                   CAT       S0004:0       SDATA
     C                   CAT       TXT(012):0    SDATA
     C                   EXSR      TILFIL
      * To
     C                   EVAL      SDATA = TXT(013)
     C                   CAT       S0010:0       SDATA
     C                   CAT       TXT(014):0    SDATA
     C                   EXSR      TILFIL
      * Date
     C                   EVAL      SDATA = TXT(015)
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       TXT(016):0    SDATA
     C                   EXSR      TILFIL
      * Time
     C                   EVAL      SDATA = TXT(017)
     C                   CAT       WTMH:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       TXT(018):0    SDATA
     C                   EXSR      TILFIL
      * Envelop slutt
     C                   EVAL      SDATA = TXT(008)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVOICE     BEGSR
      ***********************************************
     C                   MOVE      XXKN          KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
      * Invoice start
     C                   EVAL      SDATA = TXT(019)
     C                   CAT       TXT01(1):1    SDATA
     C                   EXSR      TILFIL
     C                   EVAL      SDATA = TXT01(2)
     C                   IF        SPRAAK = *BLANKS
     C                   CAT       'NO':0        SDATA
     C                   ELSE
     C                   CAT       SPRAAK:0      SDATA
     C                   END
     C                   CAT       '">':0        SDATA
     C                   EXSR      TILFIL
      * MessageNumber
     C                   EVAL      SDATA = TXT(21)
     C                   ADD       1             XANTMSG
     C                   Z-ADD     XANTMSG       ØN152
     C                   MOVE      'N'           XBELØP            1
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(22):0     SDATA
     C                   EXSR      TILFIL
      * MessageTimestamp
     C                   EVAL      SDATA = TXT(023)
     C                   CAT       WDTÅ:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTM:0        SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       WDTD:0        SDATA
     C                   CAT       'T':0         SDATA
     C                   CAT       WTMH:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMM:0        SDATA
     C                   CAT       ':':0         SDATA
     C                   CAT       WTMS:0        SDATA
     C                   CAT       '.0Z':0       SDATA
     C                   CAT       TXT(024):0    SDATA
     C                   EXSR      TILFIL
      * NumberOfLines
     C                   EVAL      SDATA = TXT(025)
     C                   Z-ADD     XFANTL        ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(026):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   MOVE      XFFN          FIFN
     C     FIFN          SETLL     FAIN
     C     FIFN          READE     FAIN                                   33
      * InvoiceHeader
     C                   EXSR      SRINVHEAD
      *
      * InvoiceDetails
     C                   IF        XFSAML = 'J'
     C                   EXSR      SRINVDETS
     C                   ELSE
     C                   EXSR      SRINVDET
     C                   END
      * InvoiceSummary
     C                   EXSR      SRINVSUM
      *
      * Invoice slutt
     C                   EVAL      SDATA = TXT(020)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVHEAD     BEGSR
      ***********************************************
     C     HEADFK        CHAIN     HEADF                              33
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C  N33              DOW       FAOPKO = 'D'
     C     FAK8K         READE     FAK8                                   33
     C  N33              ENDDO
      *
      * InvoiceHeader start
     C                   EVAL      SDATA = TXT(027)
     C                   EXSR      TILFIL
      * InvoiceType
     C                   EVAL      SDATA = TXT(029)
     C                   IF        XFFK = 'F'
     C                   CAT       '380':0       SDATA
     C                   ELSE
     C                   CAT       '381':0       SDATA
     C                   END
     C                   CAT       TXT(030):0    SDATA
     C                   EXSR      TILFIL
      * InvoiceStatus
     C                   EVAL      SDATA = TXT(031)
     C                   CAT       '9':0         SDATA
     C                   CAT       TXT(032):0    SDATA
     C                   EXSR      TILFIL
      * InvoiceNumber
     C                   EVAL      SDATA = TXT(033)
     C                   MOVEL     XFFN          XAN07             7
     C                   CAT       XAN07:0       SDATA
     C                   CAT       TXT(034):0    SDATA
     C                   EXSR      TILFIL
      * InvoiceDate
     C                   EVAL      SDATA = TXT(035)
     C                   CAT       FADATOÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADATOD:0     SDATA
     C                   CAT       TXT(036):0    SDATA
     C                   EXSR      TILFIL
      * Supplier
     C                   EVAL      SDATA = TXT(037)
     C                   EXSR      TILFIL
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   MOVE      'J'           XXLEV             1
     C                   EXSR      SRKUN1
     C                   EVAL      SDATA = TXT(038)
     C                   EXSR      TILFIL
      * Buyer
     C                   EVAL      SDATA = TXT(089)
     C                   EXSR      TILFIL
     C                   IF        HEKNK <> 0
     C                   MOVE      HEKNK         KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   IF        ((HEADK1 = ADR1) AND (HEADK2 = ADR2))
     C                   MOVE      'N'           XDELPART          1
     C                   ELSE
     C                   MOVE      'J'           XDELPART
     C                   END
     C                   ELSE
     C                   MOVE      'N'           XDELPART
     C                   MOVE      HENAK         KNAVN
     C                   MOVE      HEADK1        ADR1
     C                   MOVE      HEADK2        ADR2
     C                   MOVEL     HEADK3        XXA04             4
     C                   MOVE      XXA04         POSTNR
     C                   MOVEL     HEADK3        XXA24            24
     C                   EVAL      ADR3 = XXA24
     C                   MOVE      *BLANKS       TLF
     C                   MOVE      *BLANKS       TFAXNR
     C                   MOVE      *BLANKS       SYEPOS
     C                   END
     C                   EXSR      SRKUN2
     C                   EVAL      SDATA = TXT(090)
     C                   EXSR      TILFIL
      * Invoicee
     C                   MOVE      XXKN          KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      SDATA = TXT(091)
     C                   EXSR      TILFIL
     C                   MOVE      'N'           XXLEV             1
     C                   EXSR      SRKUN1
     C                   EVAL      SDATA = TXT(092)
     C                   EXSR      TILFIL
      * DeliveryPart
     C                   IF        XDELPART = 'J'
     C                   EVAL      SDATA = TXT(093)
     C                   EXSR      TILFIL
     C                   MOVE      HENAK         KNAVN
     C                   MOVE      HEADK1        ADR1
     C                   MOVE      HEADK2        ADR2
     C                   MOVEL     HEADK3        XXA04             4
     C                   MOVE      XXA04         POSTNR
     C                   MOVEL     HEADK3        XXA24            24
     C                   EVAL      ADR3 = XXA24
     C                   EXSR      SRKUN2
     C                   EVAL      SDATA = TXT(094)
     C                   EXSR      TILFIL
     C                   END
      * InvoiveReference
     C                   EVAL      SDATA = TXT(095)
     C                   EXSR      TILFIL
     C                   EXSR      SRINVREF
     C                   EVAL      SDATA = TXT(096)
     C                   EXSR      TILFIL
      *
     C                   IF        XFFK = 'F'
      * Payment
     C                   EVAL      SDATA = TXT(113)
     C                   EXSR      TILFIL
     C                   EXSR      SRINVPAY
     C                   EVAL      SDATA = TXT(114)
     C                   EXSR      TILFIL
      * Attachment
      *
     C                   END
      *
      * InvoiceHeader start
     C                   EVAL      SDATA = TXT(028)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRKUN1        BEGSR
      ***********************************************
      * PartyId
     C                   EVAL      SDATA = TXT(039)
     C                   Z-ADD     KUNDNR        ØN152
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(040):0    SDATA
     C                   EXSR      TILFIL
      * Name
     C                   EVAL      SDATA = TXT(043)
     C                   CAT       KNAVN:0       SDATA
     C                   CAT       TXT(044):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        ((TLF <> *BLANKS) OR (TFAXNR <> *BLANKS))
      * ContactInformation start
     C                   EVAL      SDATA = TXT(045)
     C                   EXSR      TILFIL
      * PhoneNumber
     C                   IF        TLF <> *BLANKS
     C                   EVAL      SDATA = TXT(047)
     C                   CAT       TLF:0         SDATA
     C                   CAT       TXT(048):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * FaxNumber
     C                   IF        TFAXNR <> *BLANKS
     C                   EVAL      SDATA = TXT(049)
     C                   CAT       TFAXNR:0      SDATA
     C                   CAT       TXT(050):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * EmailAddress
     C                   IF        SYEPOS <> *BLANKS
     C                   EVAL      SDATA = TXT(051)
     C                   CAT       SYEPOS:0      SDATA
     C                   CAT       TXT(052):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * WebAddress
      * ContactInformation slutt
     C                   EVAL      SDATA = TXT(046)
     C                   EXSR      TILFIL
      *
     C                   END
      * StreetAddress start
     C                   EVAL      SDATA = TXT(055)
     C                   EXSR      TILFIL
      * Address1
     C                   EVAL      SDATA = TXT(057)
     C                   CAT       ADR1:0        SDATA
     C                   CAT       TXT(058):0    SDATA
     C                   EXSR      TILFIL
      * Address2
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      SDATA = TXT(059)
     C                   CAT       ADR2:0        SDATA
     C                   CAT       TXT(060):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Postalcode
     C                   EVAL      SDATA = TXT(063)
     C                   IF        POSTNR = 0
     C                   CAT       SYPOGE:0      SDATA
     C                   ELSE
     C                   MOVE      POSTNR        XXA04
     C                   CAT       XXA04:0       SDATA
     C                   END
     C                   CAT       TXT(064):0    SDATA
     C                   EXSR      TILFIL
      * PostalDistrict
     C                   EVAL      SDATA = TXT(065)
     C                   CAT       ADR3:0        SDATA
     C                   CAT       TXT(066):0    SDATA
     C                   EXSR      TILFIL
      * CountryCode
     C                   EVAL      SDATA = TXT(067)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       'NO':0        SDATA
     C                   ELSE
     C                   CAT       SYLAND:0      SDATA
     C                   END
     C                   CAT       TXT(068):0    SDATA
     C                   EXSR      TILFIL
      * StreetAddress slutt
     C                   EVAL      SDATA = TXT(056)
     C                   EXSR      TILFIL
      *
      * ContactPerson
      *
      * OrgNumber
     C                   EVAL      SDATA = TXT(079)
     C                   CAT       SYRG:0        SDATA
     C                   CAT       TXT(080):0    SDATA
     C                   EXSR      TILFIL
      * VatId
     C                   EVAL      SDATA = TXT(081)
     C                   CAT       'MVA':0       SDATA
     C                   CAT       SYRG:0        SDATA
     C                   CAT       'NO':0        SDATA
     C                   CAT       TXT(082):0    SDATA
     C                   EXSR      TILFIL
      * Department
      *
     C                   IF        XXLEV = 'J'
      * AccountInformation start
     C                   EVAL      SDATA = TXT(083)
     C                   EXSR      TILFIL
      * AccountNumber
     C                   EVAL      SDATA = TXT(085)
     C                   CAT       XFKT:0        SDATA
     C                   CAT       TXT(086):0    SDATA
     C                   EXSR      TILFIL
      * AccountInformation slutt
     C                   EVAL      SDATA = TXT(084)
     C                   EXSR      TILFIL
      *
     C                   END
      * ProjectRef
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRKUN2        BEGSR
      ***********************************************
      * Name
     C                   EVAL      SDATA = TXT(043)
     C                   CAT       KNAVN:0       SDATA
     C                   CAT       TXT(044):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   IF        ((TLF <> *BLANKS) OR (TFAXNR <> *BLANKS))
      * ContactInformation start
     C                   EVAL      SDATA = TXT(045)
     C                   EXSR      TILFIL
      * PhoneNumber
     C                   IF        TLF <> *BLANKS
     C                   EVAL      SDATA = TXT(047)
     C                   CAT       TLF:0         SDATA
     C                   CAT       TXT(048):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * FaxNumber
     C                   IF        TFAXNR <> *BLANKS
     C                   EVAL      SDATA = TXT(049)
     C                   CAT       TFAXNR:0      SDATA
     C                   CAT       TXT(050):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * EmailAddress
     C                   IF        SYEPOS <> *BLANKS
     C                   EVAL      SDATA = TXT(051)
     C                   CAT       SYEPOS:0      SDATA
     C                   CAT       TXT(052):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * WebAddress
      * ContactInformation slutt
     C                   EVAL      SDATA = TXT(046)
     C                   EXSR      TILFIL
      *
     C                   END
      * StreetAddress start
     C                   EVAL      SDATA = TXT(055)
     C                   EXSR      TILFIL
      * Address1
     C                   EVAL      SDATA = TXT(057)
     C                   CAT       ADR1:0        SDATA
     C                   CAT       TXT(058):0    SDATA
     C                   EXSR      TILFIL
      * Address2
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      SDATA = TXT(059)
     C                   CAT       ADR2:0        SDATA
     C                   CAT       TXT(060):0    SDATA
     C                   EXSR      TILFIL
     C                   END
      * Postalcode
     C                   EVAL      SDATA = TXT(063)
     C                   IF        POSTNR = 0
     C                   CAT       SYPOGE:0      SDATA
     C                   ELSE
     C                   MOVE      POSTNR        XXA04
     C                   CAT       XXA04:0       SDATA
     C                   END
     C                   CAT       TXT(064):0    SDATA
     C                   EXSR      TILFIL
      * PostalDistrict
     C                   EVAL      SDATA = TXT(065)
     C                   CAT       ADR3:0        SDATA
     C                   CAT       TXT(066):0    SDATA
     C                   EXSR      TILFIL
      * CountryCode
     C                   EVAL      SDATA = TXT(067)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       'NO':0        SDATA
     C                   ELSE
     C                   CAT       SYLAND:0      SDATA
     C                   END
     C                   CAT       TXT(068):0    SDATA
     C                   EXSR      TILFIL
      * StreetAddress slutt
     C                   EVAL      SDATA = TXT(056)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVREF      BEGSR
      ***********************************************
      * BuyersOrderNumber
     C                   EVAL      SDATA = TXT(097)
     C                   CAT       HERFA:0       SDATA
     C                   CAT       TXT(098):0    SDATA
     C                   EXSR      TILFIL
      * BuyersOrderDate
      *
      * SuppliersOrderNumber
     C                   EVAL      SDATA = TXT(101)
     C                   CAT       SYSPEDREF:0   SDATA
     C                   CAT       TXT(102):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryTerms
     C     KODTFRK       CHAIN     KODTFR                             33
     C                   EVAL      SDATA = TXT(103)
     C                   IF        SPRAAK = ' '
     C                   EVAL      XTXT801 = KFRTTX
     C                   ELSE
     C                   EVAL      XTXT801 = KFRNTX
     C                   END
     C                   Z-ADD     38            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(104):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryTermsCode
     C                   EVAL      SDATA = TXT(105)
     C                   CAT       HEFR:0        SDATA
     C                   CAT       TXT(106):0    SDATA
     C                   EXSR      TILFIL
      * DeliveryPlace
      * DeliveryNoteNumber
      * DeliveryDate
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVPAY      BEGSR
      ***********************************************
      * DueDate
     C                   EVAL      SDATA = TXT(115)
     C                   CAT       FADAFFÅ:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFM:0     SDATA
     C                   CAT       '-':0         SDATA
     C                   CAT       FADAFFD:0     SDATA
     C                   CAT       TXT(116):0    SDATA
     C                   EXSR      TILFIL
      * Currency
     C                   EVAL      SDATA = TXT(117)
     C                   IF        VALKOD = *BLANKS
     C                   CAT       'NOK':0       SDATA
     C                   ELSE
     C                   CAT       VALKOD:0      SDATA
     C                   END
     C                   CAT       TXT(118):0    SDATA
     C                   EXSR      TILFIL
      * KidNumber
     C                   EVAL      SDATA = TXT(119)
     C                   CAT       XFKID:0       SDATA
     C                   CAT       TXT(120):0    SDATA
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVDET      BEGSR
      ***********************************************
      * InvoiceDetails start
     C                   EVAL      SDATA = TXT(123)
     C                   EXSR      TILFIL
      *
      * Freetext
     C                   EXSR      SRFRITXT
      *
      * BaseItemDetails
     C                   EXSR      SRITEMDET
      *
      * InvoiceDetails slutt
     C                   EVAL      SDATA = TXT(124)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVDETS     BEGSR
      ***********************************************
      * InvoiceDetails start
     C                   EVAL      SDATA = TXT(123)
     C                   EXSR      TILFIL
      *
     C                   DOU       *IN33
      * BaseItemDetails start
     C                   EVAL      SDATA = TXT(127)
     C                   EXSR      TILFIL
      * SubInvoice start
     C                   EVAL      SDATA = TXT(129)
     C                   EXSR      TILFIL
      *
     C                   EXSR      SRINVHEAD
     C                   EXSR      SRINVDET
      * SubInvoice slutt
     C                   EVAL      SDATA = TXT(130)
     C                   EXSR      TILFIL
      * BaseItemDetails slutt
     C                   EVAL      SDATA = TXT(128)
     C                   EXSR      TILFIL
      *
     C     FIFN          READE     FAIN                                   33
     C                   ENDDO
      *
      * InvoiceDetails slutt
     C                   EVAL      SDATA = TXT(124)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRFRITXT      BEGSR
      ***********************************************
      * Frisøkevei legges til FreeText
     C     HEADFK        SETLL     FRISOK
     C     HEADFK        READE     FRISOK                                 33
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        FSSOK <> *BLANKS                              2<-b
     C                   SORTA     DFS
     C     DFS(10)       IFNE      ' '                                            3<-B
     C                   MOVE      '0'           *IN34
     C     FASK          LOOKUP    DFS                                    34
     C                   IF        *IN34                                           4<-B
      * Frisøkevei
     C     FSKODE        CHAIN     KODFRI                             34
     C                   EVAL      SDATA = TXT(125)
     C                   EVAL      XTXT801 = KFSOTX
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       ':':0         SDATA
     C                   EVAL      XTXT801 = FSSOK
     C                   Z-ADD     45            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:1     SDATA
     C                   CAT       TXT(126):0    SDATA
     C                   EXSR      TILFIL
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     HEADFK        READE     FRISOK                                 33
     C  N33              ENDDO                                                  1<-E
      *
      *
     C     FREETK        SETLL     FREETXT2
     C     FREETK        READE     FREETXT2                               33
      *
     C                   DOW       *IN33 = *OFF                                 1<-B
     C                   IF        FRTKOD = FASK                                 2<-B
      * Fritekst
     C                   EVAL      SDATA = TXT(125)
     C                   EVAL      XTXT801 = FRTTXT
     C                   Z-ADD     80            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   CAT       TXT(126):0    SDATA
     C                   EXSR      TILFIL
     C                   END                                                     2<-E
      *
     C     FREETK        READE     FREETXT2                               33
     C  N33              ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRITEMDET     BEGSR
      ***********************************************
     C     FAK8K         SETLL     FAK8
     C     FAK8K         READE     FAK8                                   33
     C                   MOVE      *ZEROS        XXLNR             5 0
     C                   DOW       *IN33 = *OFF                                 1<-B
      * BaseItemDetails  start
     C                   EVAL      SDATA = TXT(127)
     C                   EXSR      TILFIL
      *
      * SubInvoice (vent)
      *
     C                   IF        FAOPKO <> 'D'                                 2<-B
     C                   IF        FAVAL = FICURR                                 3<-B
     C                   EVAL      XXBEL = FABELN
     C                   ELSE                                                     3
     C                   EVAL      XXBEL = FABELV
     C                   END                                                      3<-E
      * Fortegn
     C                   MOVE      ' '           XFORTEGN          1
     C                   IF        XFFK = 'F'
     C                   IF        XXBEL < 0
     C                   MOVE      '-'           XFORTEGN
     C                   Z-SUB     XXBEL         XXBEL
     C                   END
     C                   ELSE
     C                   IF        XXBEL > 0
     C                   MOVE      '-'           XFORTEGN
     C                   ELSE
     C                   Z-SUB     XXBEL         XXBEL
     C                   END
     C                   END
      * LineItemNum
     C                   ADD       1             XXLNR
     C                   EVAL      SDATA = TXT(131)
     C                   EVAL      ØN152 = XXLNR
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(132):0    SDATA
     C                   EXSR      TILFIL
      * Description
     C                   EVAL      SDATA = TXT(133)
     C                   CAT       FAVK:0        SDATA
     C                   CAT       '/':0         SDATA
     C                   EVAL      XTXT801 = FAVT
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C     KODTGEK       CHAIN     KODTGE                             33
     C     KODTG2K       CHAIN     KODTG2                             33
     C                   IF        FAVT <> *BLANKS                                3<-B
     C                   CAT       ',':0         SDATA
     C                   END                                                      3<-E
     C                   SELECT                                                   3<-B
     C                   WHEN      SPRAAK = 'E'
     C                   EVAL      XTXT801 = KGEENT
     C                   WHEN      SPRAAK = 'T'
     C                   EVAL      XTXT801 = KG2TYT
     C                   OTHER
     C                   EVAL      XTXT801 = KGENOT
     C                   ENDSL                                                    3<-E
     C                   Z-ADD     40            XN53              3 0
     C                   EXSR      KNVST
     C                   CAT       XTXT802:0     SDATA
     C                   MOVE      XAN13BLANK    SDATA
     C                   CAT       TXT(134):0    SDATA
     C                   EXSR      TILFIL
      * UnitPrice
     C                   EVAL      SDATA = TXT(135)
     C                   EVAL      ØN152 = XXBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(136):0    SDATA
     C                   EXSR      TILFIL
      * PriceType
     C                   EVAL      SDATA = TXT(137)
     C                   CAT       'AAA':0       SDATA
     C                   CAT       TXT(138):0    SDATA
     C                   EXSR      TILFIL
      * LineItemAmount
     C                   EVAL      SDATA = TXT(139)
     C                   CAT       XFORTEGN:0    SDATA
     C                   EVAL      ØN152 = XXBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(140):0    SDATA
     C                   EXSR      TILFIL
      * QuantityInvoiced
     C                   EVAL      SDATA = TXT(141)
     C                   CAT       '1':0         SDATA
     C                   CAT       TXT(142):0    SDATA
     C                   EXSR      TILFIL
      * UnitOfMeasure
     C                   EVAL      SDATA = TXT(143)
     C                   CAT       'Stk':0       SDATA
     C                   CAT       TXT(144):0    SDATA
     C                   EXSR      TILFIL
      * VatInfo start
     C                   EVAL      SDATA = TXT(145)
     C                   EXSR      TILFIL
      * VatPercent
     C                   EVAL      SDATA = TXT(147)
     C                   SELECT                                                   3<-B
     C                   WHEN      FAKDM = 'N'
     C                   EVAL      MVAAVI = 0
     C                   WHEN      FAKDM = 'J'
     C                   EVAL      MVAAVI = FITAX * 100
     C                   OTHER
     C     KODWL01K      CHAIN     KODWL01                            33
     C   33              EVAL      MVAAVI = 0
     C                   ENDSL                                                    3<-E
     C                   EVAL      ØN152 = MVAAVI
     C                   MOVE      'N'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(148):0    SDATA
     C                   EXSR      TILFIL
      * VatBaseAmount
     C                   EVAL      SDATA = TXT(149)
     C                   EVAL      ØN152 = XXBEL
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(150):0    SDATA
     C                   EXSR      TILFIL
      * VatAmount
     C                   EVAL      SDATA = TXT(151)
     C                   EVAL      XXMVA = XXBEL * MVAAVI / 100
     C                   EVAL      ØN152 = XXMVA
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(152):0    SDATA
     C                   EXSR      TILFIL
      * VatInfo slutt
     C                   EVAL      SDATA = TXT(146)
     C                   EXSR      TILFIL
      *
     C                   END                                                     2<-E
      * BaseItemDetails  slutt
     C                   EVAL      SDATA = TXT(128)
     C                   EXSR      TILFIL
      *
     C     FAK8K         READE     FAK8                                   33
     C                   ENDDO                                                  1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVSUM      BEGSR
      ***********************************************
      * InvoiceSummary start
     C                   EVAL      SDATA = TXT(153)
     C                   EXSR      TILFIL
      *
      * InvoiceTotals
     C                   EXSR      SRINVTOT
      *
      * VatTotalsInfo
     C                   EXSR      SRVATTOT
      *
      * InvoiceSummary slutt
     C                   EVAL      SDATA = TXT(154)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRINVTOT      BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        XXMVAT           13 2
     C     1             DO        11            XN01              3 0
     C                   IF        XMLT1(XN01) > 0
     C                   IF        XMLT2(XN01) = *BLANKS
     C                   EVAL      XMLT2(XN01) = FICURR
     C                   END
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT3(XN01)/100
     C                   ELSE
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT4(XN01)/100
     C                   END
     C                   END
     C                   ENDDO
     C     XFTOT         SUB       XXMVAT        XX0MVAGR         13 2
      *
      * InvoiceTotals  start
     C                   EVAL      SDATA = TXT(155)
     C                   EXSR      TILFIL
      *
      * GrossAmount (Total inkluderer MVA)
     C                   EVAL      SDATA = TXT(157)
     C                   MOVE      XFTOT         XFTOT2           13 2
     C                   IF        XFFK = 'F'
     C                   IF        XFTOT2 < 0
     C                   CAT       '-':0         SDATA
     C                   Z-SUB     XFTOT2        XFTOT2
     C                   END
     C                   ELSE
     C                   IF        XFTOT2 > 0
     C                   CAT       '-':0         SDATA
     C                   ELSE
     C                   Z-SUB     XFTOT2        XFTOT2
     C                   END
     C                   END
     C                   EVAL      ØN152 = XFTOT2
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(158):0    SDATA
     C                   EXSR      TILFIL
      *
      * VatTotalsAmount
     C                   EVAL      SDATA = TXT(159)
     C                   IF        XXMVAT < 0
     C                   Z-SUB     XXMVAT        XXMVAT
     C                   END
     C                   EVAL      ØN152 = XXMVAT
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(160):0    SDATA
     C                   EXSR      TILFIL
      *
      * NetAmount (Total uten MVA)
     C                   EVAL      SDATA = TXT(161)
     C                   EVAL      ØN152 = XFTOT2 - XXMVAT
     C                   MOVE      'J'           XBELØP
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         SDATA
     C                   CAT       TXT(162):0    SDATA
     C                   EXSR      TILFIL
      *
      * InvoiceTotals  start
     C                   EVAL      SDATA = TXT(156)
     C                   EXSR      TILFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRVATTOT      BEGSR
      ***********************************************
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRCLOSE       BEGSR
      ***********************************************
     C                   CLOSE     KODWL01
     C                   CLOSE     KODTA
     C                   CLOSE     KODTGE
     C                   CLOSE     KODTG2
     C                   CLOSE     KODTFR
     C                   CLOSE     KODTOTY
     C                   CLOSE     CUNDL01
     C                   CLOSE     FAIN
     C                   CLOSE     HEADF
     C                   CLOSE     FAK8
     C                   CLOSE     FRISOK
     C                   CLOSE     KODFRI
     C                   CLOSE     EDIC
     C                   CLOSE     EDIS
     C                   CLOSE     EDIM
     C                   CLOSE     EDISE
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSNDSL       BEGSR
      ***********************************************
     C                   EVAL      SDATA = TXT(006)
     C                   EXSR      TILFIL
      *
     C                   CLOSE     XMLTILP
     C                   EVAL      UKAT = '/SYEDIFX/EDISE/'
     C                   CAT       S0010:0       UKAT
     C                   EVAL      UFIL = UKAT
     C                   CAT       '/TEMP/':0    UFIL
     C                   CAT       SEMBR:0       UFIL
     C                   CAT       '.xml':0      UFIL
     C                   CALL      'SYXML02S'
     C                   PARM                    SEMBR
     C                   PARM                    UFIL
     C                   PARM                    UKAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDEDIM       BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = S0004
     C                   EVAL      M0010 = S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'INVXML'
     C                   MOVEL     XFFN          M0068
     C                   IF        XFFK = 'F'
     C                   MOVEL     '380'         M1001
     C                   ELSE
     C                   MOVEL     '381'         M1001
     C                   END
     C                   MOVEL     XFFN          M1004
     C                   IF        XFSAML = 'N'
     C                   MOVE      'SIN'         M1225
     C                   ELSE
     C                   MOVE      'SAM'         M1225
     C                   END
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'S'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   IF        XFSAML = 'N'
     C                   EVAL      MAVD = FIAVD
     C                   EVAL      MTDN = FIOPD
     C                   ELSE
     C                   EVAL      MAVD = 0
     C                   EVAL      MTDN = 0
     C                   END
     C                   WRITE     EDIMR
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
     C                   IF        ØN152 < 0
     C                   MOVE      '-'           XAN01             1
     C                   Z-SUB     ØN152         ØN152
     C                   ELSE
     C                   MOVE      ' '           XAN01
     C                   END
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C     XBELØP        ANDEQ     'N'                                                        I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      '.  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C     XBELØP        IFEQ      'N'
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   END
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       XXA12            12
     C     Ø12(ØX)       IFEQ      '.'
     C                   SUB       1             ØX
     C                   END
     C                   MOVEA     Ø12(ØX)       XXA12
     C                   IF        XAN01 = '-'
     C                   EVAL      ØAN = XAN01
     C                   CAT       XXA12:0       ØAN
     C                   ELSE
     C                   EVAL      ØAN = XXA12
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     TILFIL        BEGSR
      ***********************************************
     C                   WRITE     EDISER
      *
     C                   MOVE      SDATA         XTPDTA
     C                   WRITE     XMLTILPR
      *
     C                   ENDSR
      *
      ***********************************************
     C     KNVST         BEGSR
      ***********************************************
     C     XN53          SUB       4             XN54              3 0
     C     XN53          SUB       5             XN55              3 0
     C     XN53          SUB       6             XN56              3 0
     C                   Z-ADD     0             XN52              3 0
     C                   MOVE      *BLANKS       XTXT802
     C     1             DO        80            XN51              3 0
     C                   IF        (((((XT801(XN51) = '&') OR
     C                                 (XT801(XN51) = '"')) OR
     C                                 (XT801(XN51) = XAPS)) OR
     C                                 (XT801(XN51) = '<')) OR
     C                                 (XT801(XN51) = '>'))
     C                   IF        XN52 < XN53
     C                   ADD       1             XN52
     C                   SELECT
     C                   WHEN      XT801(XN51) = '&'
     C                   IF        XN51 < XN55
     C                   MOVEA     '&amp;'       XT802(XN52)
     C                   ADD       4             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '"'
     C                   IF        XN51 < 75
     C                   MOVEA     '&quot;'      XT802(XN52)
     C                   ADD       5             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = XAPS
     C                   IF        XN51 < XN56
     C                   MOVEA     '&apos;'      XT802(XN52)
     C                   ADD       5             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '>'
     C                   IF        XN51 < XN54
     C                   MOVEA     '&gt;'        XT802(XN52)
     C                   ADD       3             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   WHEN      XT801(XN51) = '<'
     C                   IF        XN51 < XN54
     C                   MOVEA     '&lt;'        XT802(XN52)
     C                   ADD       3             XN52
     C                   ELSE
     C                   SUB       1             XN52
     C                   END
     C                   ENDSL
     C                   END
     C                   ELSE
     C                   IF        XN52 < XN53
     C                   ADD       1             XN52
     C                   MOVE      XT801(XN51)   XT802(XN52)
     C                   ELSE
     C                   LEAVE
     C                   END
     C                   END
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     XMLUFL1K      KLIST
     C                   KFLD                    XXST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XXTYPE
     C     ECMSGK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XXKN
     C                   KFLD                    ECSR
     C                   KFLD                    EC0065
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     FAK8K         KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C                   KFLD                    FIFN
     C     KODWL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    MOMSTW
     C                   KFLD                    FAKDM
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    FIAVD
     C     KODTAKX       KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    XFAVD
     C     KODTGEK       KLIST
     C                   KFLD                    KGEUNI
     C                   KFLD                    FAVK
     C     KODTG2K       KLIST
     C                   KFLD                    KG2UNI
     C                   KFLD                    FAVK
     C     KODTFRK       KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    HEFR
     C     KODTOTYK      KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    HEOT
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     FREETK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    FASK
     C                   KFLD                    FIFN
     C     FRISOKK       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    XFSKODE           3
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVE      *ZEROS        XXBEL            13 2
     C                   MOVE      *ZEROS        XXMVA            13 2
     C                   MOVE      *BLANKS       XAN13BLANK       13
     C                   MOVE      ' '           XXST              1
     C                   MOVE      'E2B  '       XXTYPE            5
     C                   MOVE      'A'           KOAUNI
     C                   MOVEL     'GE'          KGEUNI
     C                   MOVEL     'G2'          KG2UNI
     C                   MOVEL     'FR'          KFRUNI
     C                   MOVEL     'OTY'         KO1UNI
     C                   MOVE      'PO '         XFSKODE
     C                   MOVEL     'S'           ECSR
     C                   MOVEL     'INVXML'      EC0065
     C                   MOVE      '/'           XXSTREKK1
     C                   MOVE      '/'           XXSTREKK2
     C                   MOVE      *BLANKS       UFIL             70
     C                   MOVE      *BLANKS       UKAT             70
     C                   BITON     '123457'      XAPS              1
     C                   BITOFF    '06'          XAPS
      *
     C                   ENDSR
      *
** TXT
<?xml version="1.0" encoding="ISO-8859-1"?>                                     001
<Interchange xmlns="http://www.e2b.no/XMLSchema"                                002
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"                           003
xsi:schemaLocation="http://www.e2b.no/XMLSchema e2b_Invoice_Interchange_V3p2.xsd004
">                                                                              005
</Interchange>                                                                  006
<Envelope>                                                                      007
</Envelope>                                                                     008
<InterchangeId>                                                                 009
</InterchangeId>                                                                010
<From>                                                                          011
</From>                                                                         012
<To>                                                                            013
</To>                                                                           014
<Date>                                                                          015
</Date>                                                                         016
<Time>                                                                          017
</Time>                                                                         018
<Invoice                                                                        019
</Invoice>                                                                      020
<MessageNumber>                                                                 021
</MessageNumber>                                                                022
<MessageTimestamp>                                                              023
</MessageTimestamp>                                                             024
<NumberOfLines>                                                                 025
</NumberOfLines>                                                                026
<InvoiceHeader>                                                                 027
</InvoiceHeader>                                                                028
<InvoiceType codetext="Invoice">                                                029
</InvoiceType>                                                                  030
<InvoiceStatus codetext="Original">                                             031
</InvoiceStatus>                                                                032
<InvoiceNumber>                                                                 033
</InvoiceNumber>                                                                034
<InvoiceDate>                                                                   035
</InvoiceDate>                                                                  036
<Supplier>                                                                      037
</Supplier>                                                                     038
<PartyId>                                                                       039
</PartyId>                                                                      040
<LocationId>                                                                    041
</LocationId>                                                                   042
<Name>                                                                          043
</Name>                                                                         044
<ContactInformation>                                                            045
</ContactInformation>                                                           046
<PhoneNumber>                                                                   047
</PhoneNumber>                                                                  048
<FaxNumber>                                                                     049
</FaxNumber>                                                                    050
<EmailAddress>                                                                  051
</EmailAddress>                                                                 052
<WebAddress>                                                                    053
</WebAddress>                                                                   054
<StreetAddress>                                                                 055
</StreetAddress>                                                                056
<Address1>                                                                      057
</Address1>                                                                     058
<Address2>                                                                      059
</Address2>                                                                     060
<Address3>                                                                      061
</Address3>                                                                     062
<Postalcode>                                                                    063
</Postalcode>                                                                   064
<PostalDistrict>                                                                065
</PostalDistrict>                                                               066
<CountryCode>                                                                   067
</CountryCode>                                                                  068
<PostalAddress>                                                                 069
</PostalAddress>                                                                070
<ContactPerson>                                                                 071
</ContactPerson>                                                                072
<Name>                                                                          073
</Name>                                                                         074
<Function>                                                                      075
</Function>                                                                     076
<Department>                                                                    077
</Department>                                                                   078
<OrgNumber>                                                                     079
</OrgNumber>                                                                    080
<VatId>                                                                         081
</VatId>                                                                        082
<AccountInformation>                                                            083
</AccountInformation>                                                           084
<AccountNumber>                                                                 085
</AccountNumber>                                                                086
<ProjectRef>                                                                    087
</ProjectRef>                                                                   088
<Buyer>                                                                         089
</Buyer>                                                                        090
<Invoicee>                                                                      091
</Invoicee>                                                                     092
<DeliveryPart>                                                                  093
</DeliveryPart>                                                                 094
<InvoiceReference>                                                              095
</InvoiceReference>                                                             096
<BuyersOrderNumber>                                                             097
</BuyersOrderNumber>                                                            098
<BuyersOrderDate>                                                               099
</BuyersOrderDate>                                                              100
<SuppliersOrderNumber>                                                          101
</SuppliersOrderNumber>                                                         102
<DeliveryTerms>                                                                 103
</DeliveryTerms>                                                                104
<DeliveryTermsCode>                                                             105
</DeliveryTermsCode>                                                            106
<DeliveryTermsPlace>                                                            107
</DeliveryTermsPlace>                                                           108
<DeliveryNoteNumber>                                                            109
</DeliveryNoteNumber>                                                           110
<DeliveryDate>                                                                  111
</DeliveryDate>                                                                 112
<Payment>                                                                       113
</Payment>                                                                      114
<DueDate>                                                                       115
</DueDate>                                                                      116
<Currency>                                                                      117
</Currency>                                                                     118
<KidNumber>                                                                     119
</KidNumber>                                                                    120
<Attachment>                                                                    121
</Attachment>                                                                   122
<InvoiceDetails>                                                                123
</InvoiceDetails>                                                               124
<FreeText>                                                                      125
</FreeText>                                                                     126
<BaseItemDetails>                                                               127
</BaseItemDetails>                                                              128
<SubInvoice>                                                                    129
</SubInvoice>                                                                   130
<LineItemNum>                                                                   131
</LineItemNum>                                                                  132
<Description>                                                                   133
</Description>                                                                  134
<UnitPrice>                                                                     135
</UnitPrice>                                                                    136
<PriceType>                                                                     137
</PriceType>                                                                    138
<LineItemAmount>                                                                139
</LineItemAmount>                                                               140
<QuantityInvoiced>                                                              141
</QuantityInvoiced>                                                             142
<UnitOfMeasure>                                                                 143
</UnitOfMeasure>                                                                144
<VatInfo>                                                                       145
</VatInfo>                                                                      146
<VatPercent>                                                                    147
</VatPercent>                                                                   148
<VatBaseAmount>                                                                 149
</VatBaseAmount>                                                                150
<VatAmount>                                                                     151
</VatAmount>                                                                    152
<InvoiceSummary>                                                                153
</InvoiceSummary>                                                               154
<InvoiceTotals>                                                                 155
</InvoiceTotals>                                                                156
<GrossAmount>                                                                   157
</GrossAmount>                                                                  158
<VatTotalsAmount>                                                               159
</VatTotalsAmount>                                                              160
<NetAmount>                                                                     161
</NetAmount>                                                                    162
** TXT01
MessageVersion="3.2" MessageOwner="e2b" MessageType="Invoice"                   001
Language="                                                                      002
