********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 ad --> ARKIVERING AV ADVISERING - SJØ
      *              bo --> ARKIVERING AV BOOKING - SJØ
      *              ss --> SAMLASTESPESIFIKASJON - SJØ
10XXX * 02 SH  PTF10 CMR EPOST
10XXX * 03 SH  PTF10 kunde må stemme på vedlegg av faktura/sad
10XXX * 04 SH  PTF10 norske og engelske tekster epostfaktura
10XXX * 05 SH  PTF10 ser om gf skal sendes med godsliste
10XXX * 06 SH  PTF10 sikre mot kostnadsbilag i fak9 ind 66
10XXX * 07 SH  PTF10 endring godsliste
10XXX * 08 SH  PTF10 arkivere kjørekvittering / arbeidsordre eksport
10XXX * 09 SH  PTF10 leser alle med K i status
10XXX * 10 SH  PTF10 coverpage økt til 80 tegn
10XXX * 11 SH  PTF10 lasteliste eksport / losseliste import
10XXX * 12 SH  PTF10 sprer transportøravregning til turer
10XXX * 13 SH  PTF10 feil statuskode transportøravregning på turrecord
10XXX * 14 SH  PTF10 hekte dokumenter på de fleste typer
10XXX * 15 SH  PTF10 endret tekst tolldokument
10XXX * 16 SH  PTF10 utvider lenke til mailingsystem  76-152
10XXX * 17 SH  PTF10 fritekst fra frie søkeveier til mail
10XXX * 18 SH  PTF10 kaller ARC002V uansett
10XXX * 19 SH  PTF10 tracking epostutsendelse
10XXX * 20 SH  PTF10 fast emnerubrikk
10027 * 21 YBC PTF10 ORDRETYPE PÅ PROFORMA FAKTURA I SHIP-SYS
10027 * 22 SH  PTF10 skille utleveringattest
      * 23 JOV PTF10 Feil test ved inngang til genfbpdf - trikser med TYPE i  PDF003CL
      * 24 SH  PTF10 @ i epost adresse gir ingen epost
      * 25 SH  PTF10 indikatorfeil ptf 06
      * 26 SH  på stykkgodsfraktbrev sjekker om vareadresse har epostadresse på seg
10172 * 27 SH  PTF10 norsk text til Track and trace
      * 28 SH  PTF10 blanke subjectfelt godsliste
      * 29 SH  PTF10 forbedring norsk/engelsk
      * 30 SH  PTF10 skiller samle/singelfaktura A/B i kode   PDF006cl
      * 31 SH  PTF10 endring sveinsk fortolling
      * 32 SH  PTF10 NYE PARAMETRE TIL EPOST
      * 33 SH  PTF10 ENDRING SAMLEFAKTURA MED HT EMA LINJER SKAL SPRES
      * 34 SH  PTF10 mindre rettingh til samlefaktura  blankser et felt mellom mailing
10XXX * 35 SH  PTF10 utelate epost på oppdragstyper
10XXX * 36 SH  PTF10 lite feil i SAD text i epostr
10263 * 37 YBC PTF10 ARKIVERE PAKKSEDDEL
10264 * 38 YBC PTF10 DATALIST ER BYTTET MED SAD61PFT
10XXX * 39 SH  PTF10 Kostnadsoverslag til arkiv
10XXX * 40 SH  PTF10 Return hvis programmet kallers uten records med status 'K'
10XXX * 41 SH  PTF10 Sende ruckattest
10XXX * 42 SH  PTF10 PARAMETER OM SAMMENSLÅES
10XXX * 43 SH  PTF10 KALL PÅ ARC009CL FLYTTET TIL SUBRUTINE EPOSTSR SLETTET LINJER DIREKTE
10XXX * 44 SH  PTF10 Eventuelle vedlegg til rykkarttest
10XXX * 45 SH  PTF10 rykkattest som vedlegg
10XXX * 46 SH  PTF10 arkiverer arbeidsliste til transp.avregning
      * 47 SH  PTF10 MERGE OGSÅ PÅ DOKUMENTNIVÅ
      * 48 SH  PTF10 FAKTURANUMMER TIL KOSTNADSOVERSLAG
      * 49 SH  PTF10 ikke spre samlefaktura på kostnadsbilag
      * 50 SH  PTF10 rette transpoortøravregning arb liste
      * 51 SH  PTF10 Sendte epost av 'te'
      * 52 SH  PTF10 endrer bane til vareliste
      * 53 SH  PTF10 skriv alle vedlegg ved samlefaktura
      * 54 SH  PTF10 skriv alle vedlegg ved samlefaktura
      * 55 SH  PTF11 Dansk fortolling
      * 56 SH  PTF11 fraktbrev tving fra evt send til seg selv
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11015 * 57 YBC PTF11 SEND XML TIL EMMA
11015 * 58 SH  PTF11 mindre rettelse til 57
11015 * 59 SH  PTF11 flytter litt på 0-kundetest i pdffb
11015 * 60 SH  PTF11 pdfsad ta vare på artype
11015 * 61 SH  PTF11 fakturanummer i emnerubrikken
11015 * 62 SH  PTF11 NYE FELT I WORKFILE ARKEPO
11041 * 63 CB  PTF11 Dansk import, extra post til annet oppdrag
11XXX * 64 YBC PTF11 OMBEREGNING ER IKKE KLAR HOS EMMA
11XXX * 65 SH  PTF11 Ametaavregning kode aa
11XXX * 66 SH  PTF11 arkiverer flyfraktlapper
11XXX * 67 SH  PTF11 rettelser pdfinv testep / OTYPE
11XXX * 68 SH  PTF11 forbesring flyfraktlapper
11XXX * 69 SH  PTF11 infoskriv som vedlegg
11XXX * 70 SH  PTF11 henter egen epostadresse  EPOS04E istedenfor EPOS04
11XXX * 71 SH  PTF11 Løsning1 faktura
11XXX * 72 SH  PTF11 tillegg kode i firmafil
********************************************************************
     H DECEDIT(',') debug(*yes)
      ***********************************************************
      *** PROGRAM for arkivering
      ***********************************************************
N41  FRUCKPU    UF   E           K DISK
N41  FKODTA     IF   E           K DISK
N67  FKODTOT2   IF   E           K DISK
N39  FCUSAPR    IF   E           K DISK
N19  FTRACKF    O  A E           K DISK
N17  FFRISOK    IF   E           K DISK
N17  FKODFRI    IF   E           K DISK
N26  FVADR1     IF   E           K DISK
     FSYPARL3   IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
     FSVIH      IF   E           K DISK
     FSVEH      IF   E           K DISK
N55  FDKIH      IF   E           K DISK
N55  FDKEH      IF   E           K DISK
     FARUSERL1  IF   E           K DISK
     FTRAVH3    IF   E           K DISK
N12  FTRAVH6    IF   E           K DISK
N12  F                                     RENAME(TRAVHR:TRAVHR2)
     FTRUV      IF   E           K DISK
     FSVXV      IF   E           K DISK    PREFIX(SVX_)
     FDOKUF     IF   E           K DISK
     FDOKEC     IF   E           K DISK
     FDOKECe    IF   E           K DISK
     FTRAVV6    IF   E           K DISK
     Fcundl01   IF   E           K DISK
N49  FFAK8      IF   E           K DISK
N49  F                                     RENAME(faktr:faktr8)
     FFAK9      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FARKEPO    UF A E           K DISK
     FARKTXT    IF   E           K DISK
     FTURER14   IF   E           K DISK
     FCUNDC03   IF   E           K DISK
     FFain      IF   E           K DISK
     Fhead14    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD14r)
     Fhead19    IF   E           K DISK
     F                                     RENAME(HEADFR:HEAD19r)
     Fheadf     IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVL01  UF A E           K DISK
     FARKIVL02  UF   E           K DISK
     F                                     RENAME(arkivr:arkivr2)
     D                SDS
     D  UUSR                 254    263
n35  D                 DS
n35  D  av                     1     80  0
n35  D                                     DIM(20)
n35  D  CAVD                   1     80
n35   *
n35  D                 DS
n35  D  OTY                    1     10
n35  D                                     DIM(5)
n35  D  COPD                   1     10
      *
N41  D                 DS
N41  D  SIGN                   1     15
N41  D  TLAGER                 5      9
     D                 DS
     D  FADATO                 1      8  0
     D  FAAA                   3      4
     D  FAMM                   5      6
     D  FADG                   7      8
N51  D                 DS
N51  D  ARDATE                 1      8  0
N51  D  AAR                    1      4
N51  D  MND                    5      6
N51  D  DAG                    7      8
N17  D                 DS
N17  D  DFS                    1     10    DIM(10)
N17  D  FSDOKK                 1     10
N17  D                 DS
N17  D  DFRT                   1    210    DIM(3)
N19  D                 DS
N19  D  XULTID                 1     14  0
N19  D  XULTM                  1      6  0
N19  D  XULDD                  7      8  0
N19  D  XULMM                  9     10  0
N19  D  XULÅÅ                 11     14  0
N19  D                 DS
N19  D  ULÅÅ                   1      4  0
N19  D  ULMM                   5      6  0
N19  D  ULDD                   7      8  0
N19  D  ULDT                   1      8  0
     D                 DS
     D  avdopd                 1     11
     D  aravd                  1      4  0
     D  aropd                  5     11  0
     D                 DS
     D  ag                     1    800  0
     D                                     DIM(100)
     D                 DS
     D  hegn                   1     15
     D  hegn11                 5     15
     D                 DS
     D  V                      1     60
     D                                     DIM(30)
     D  arkved                 1     60
     D  V01                    1      2
     D  V02                    3      4
     D  V03                    5      6
     D  V04                    7      8
     D  V05                    9     10
     D  V06                   11     12
     D  V07                   13     14
     D  V08                   15     16
     D  V09                   17     18
     D  V10                   19     20
     D  V11                   21     22
     D  V12                   23     24
     D  V13                   25     26
     D  V14                   27     28
     D  V15                   29     30
     D  V16                   31     32
     D  V17                   33     34
     D  V18                   35     36
     D  V19                   37     38
     D  V20                   39     40
     D  V21                   41     42
     D  V22                   43     44
     D  V23                   45     46
     D  V24                   47     48
     D  V25                   49     50
     D  V26                   51     52
     D  V27                   53     54
     D  V28                   55     56
     D  V29                   57     58
     D  V30                   59     60
N51  D vedleggnc       C                   CONST('NCTS er sendt -
N51  D                                     som PDF-vedlegg')
     D vedlegglm       C                   CONST('Mottaksrapport er sendt -
     D                                     som PDF-vedlegg')
     D vedlegglm2      C                   CONST('Mottaksrapport er sendt -
     D                                     fra:')
     D vedleggf        C                   CONST('Fakturaen er sendt -
     D                                     som PDF-vedlegg')
     D vedlegga        C                   CONST('Avregning er sendt -
     D                                     som PDF-vedlegg')
     D vedleggg        C                   CONST('Godsliste er sendt -
     D                                     som PDF-vedlegg')
     D vedleggt        C                   CONST('Tolldeklarasjon er sendt -
     D                                     som PDF-vedlegg')
N22  D vedleggu        C                   CONST('Utleveringsattest er sendt -
N22  D                                     som PDF-vedlegg')
     D vedleggs        C                   CONST('Fraktbrevet er sendt -
     D                                     som PDF-vedlegg')
     D vedleggaw       C                   CONST('Flyfraktbrev er sendt -
     D                                     som PDF-vedlegg')
N02  D vedleggcmr      C                   CONST('CMR er sendt -
N02  D                                     som PDF-vedlegg')
n08  D vedleggkk       C                   CONST('Meldeseddel er sendt -
n08  D                                     som PDF-vedlegg')
n39  D vedleggko       C                   CONST('Kostnadsoverslag er sendt -
n39  D                                     som PDF-vedlegg')
n11  D vedleggla       C                   CONST('Lasteliste er sendt -
n11  D                                     som PDF-vedlegg')
n11  D vedlegglo       C                   CONST('Losseliste er sendt -
n11  D                                     som PDF-vedlegg')
n08  D vedleggaen      C                   CONST('Arbeidsordre er sendt -
n08  D                                     som PDF-vedlegg')
N51  D trykknc         C                   CONST('Trykk på link for å -
N51  D                                     se på NCTS')
     D trykklm         C                   CONST('Trykk på link for å -
     D                                     se på Mottaksrapport')
     D trykkf          C                   CONST('Trykk på link for å -
     D                                     se på faktura')
     D trykka          C                   CONST('Trykk på link for å -
     D                                     se på avregning')
     D trykkg          C                   CONST('Trykk på link for å -
     D                                     se på godsliste')
     D trykkt          C                   CONST('Trykk på link for å -
     D                                     se på Tolldeklarasjon')
N22  D trykku          C                   CONST('Trykk på link for å -
N22  D                                     se på Utleveringsattest')
N02  D trykkcmr        C                   CONST('Trykk på link for å -
N02  D                                     se på Fraktbrevet')
     D trykkaw         C                   CONST('Trykk på link for å -
     D                                     se på flyfraktbrev')
     D trykks          C                   CONST('Trykk på link for å -
     D                                     se på CMR')
n08  D trykkkk         C                   CONST('Trykk på link for å -
n08  D                                     se på Meldeseddel')
n39  D trykkko         C                   CONST('Trykk på link for å -
n39  D                                     se på Kostnadsoverslag')
n11  D trykkla         C                   CONST('Trykk på link for å -
n11  D                                     se på Lasteliste')
n11  D trykklo         C                   CONST('Trykk på link for å -
n11  D                                     se på Losseliste')
n08  D trykkaen        C                   CONST('Trykk på link for å -
n08  D                                     se på Arbeidsordre')
N04  D vedlegglme      C                   CONST('Receivereport is sent -
N04  D                                     as PDF-attachment')
N51  D vedleggnce      C                   CONST('NCTS is sendt -
N51  D                                     from:')
N04  D vedlegglm2e     C                   CONST('Receivereport is sendt -
N04  D                                     from:')
N04  D vedleggfe       C                   CONST('Invoice is sent as -
N04  D                                     PDF-attachment')
N04  D vedleggae       C                   CONST('Avregning er sendt -
N04  D                                     som PDF-vedlegg')
N04  D vedleggge       C                   CONST('Waybill is sent as -
N04  D                                     PDF-attachment')
N22  D vedleggue       C                   CONST('Deliverycertificate is sent -
N22  D                                     as PDF-attachment')
N04  D vedleggte       C                   CONST('Cust.clearance is sent -
N04  D                                     as PDF-attachment')
N04  D vedleggse       C                   CONST('Waybill is sent as -
N04  D                                     PDF-attachment')
N04  D vedleggawe      C                   CONST('Airwaybill is sent as -
N04  D                                     PDF-attachment')
N04  D vedleggcmre     C                   CONST('CMR is sent -
N04  D                                     as PDF-attachment')
N08  D vedleggkke      C                   CONST('Arrivalnote is sent as -
N08  D                                     PDF-attachment')
N39  D vedleggkoe      C                   CONST('Cost budget is sent as -
N39  D                                     PDF-attachment')
N11  D vedlegglae      C                   CONST('Loadinglist is sent as -
N11  D                                     PDF-attachment')
N11  D vedleggloe      C                   CONST('Unloadinglist is sent as -
N11  D                                     PDF-attachment')
N08  D vedleggaee      C                   CONST('Workorder is sent as -
N08  D                                     PDF-attachment')
N51  D trykknce        C                   CONST('Press link to open -
N51  D                                     NCTS')
N04  D trykklme        C                   CONST('Press link to open -
N04  D                                     receivereport')
N04  D trykkfe         C                   CONST('Press link to open -
N04  D                                     invoice')
N04  D trykkae         C                   CONST('Press link to open -
N04  D                                     invoice')
N04  D trykkge         C                   CONST('Press link to open -
N04  D                                     waybill')
N04  D trykkte         C                   CONST('Press link to open -
N04  D                                     cust.clearanse')
N22  D trykkue         C                   CONST('Press link to open -
N22  D                                     Delivery.certificate')
N04  D trykkcmre       C                   CONST('Press link to open -
N04  D                                     waybill')
N04  D trykkawe        C                   CONST('Press link to open -
N04  D                                     Airwaybill')
N04  D trykkse         C                   CONST('Press link to open -
N04  D                                     CMR')
N08  D trykkkke        C                   CONST('Press link to open -
N08  D                                     Arrivalnote')
N39  D trykkkoe        C                   CONST('Press link to open -
N39  D                                     Cost budget')
N11  D trykklae        C                   CONST('Press link to open -
N11  D                                     Loadinglist')
N11  D trykkloe        C                   CONST('Press link to open -
N11  D                                     Unloadinglist')
N08  D trykkaee        C                   CONST('Press link to open -
N08  D                                     Workorder')
     D                 DS
     D  UPARM2                 1     64
     D  UKJED                  1      8
     D  UPNR                   9     16
     D  UMRNR                 17     21
     D  UOPT                  22     22
     D  UKOPI                 23     23
N37  D  UPSDL                 24     30
N01  D                UDS
N01  D  UPARM1                 1   1024
N01  D  USG1                   1      3
N01  D  USD1                   4      8
N01  D  UDTIN1                 9     14
N01  D  UMN1                  15     31
N01  D  UDTSIN1               32     37
N01  D  UARKIV              1024   1024
      *
     c                   exsr      init
      *
     c     stny          tag
     c     key           chain     arkivl01                           34
N40  c     *in34         ifeq      '0'
      *
      * oppdater ARSTAT med 'X'
     c  N34              move      'X'           arstat
     c  N34              except    updark
N32  C                   MOVE      ARAVD         AAVD
N32  C                   MOVE      AROPD         AOPD
N32  C                   MOVE      ARKUND        AKUN              8
N32  c     keyhea        chain     headf                              44
N32  c                   move      *zeros        atur
N32  C  N44              MOVE      HEPRO         ATUR              8
N32  c     artype        ifeq      'go'
N32  C     ARTYPE        OREQ      'la'
N32  C     ARTYPE        OREQ      'lo'
N32  C                   movel     arunde        ATUR
N32  C                   end
N17   *
N17   * skjekker om frie søkeveier ved epost
N17   *
N17  c     artype        chain     arktxt                             33
N17  c  N33arksnd        ifeq      'J'
N17  c                   exsr      frisr
N17  c                   end
      * ny chain for senere oppdatering
     c  N34keya02        chain     arkivl02                           34
     c                   add       1             runde             5 0
     c**n34runde         comp      5                                  34
     c     *in34         ifeq      '0'
      *
      *mottaksrapport lagersystem
      *
     c     artype        ifeq      'lm'
     c                   exsr      pdflm
     c                   end
N37   *
N37   * Pakkseddel lagersystem
N37   *
N37  C                   IF        ARTYPE = 'ps'
N37  C                   EXSR      PDFPS
N37  C                   END
      *
      *faktura singel
      *
     c     artype        ifeq      'fa'
      * xfri=x betyr at annen bestilling kjører avbryt jobb
     c                   move      arunde        xxunde           10
     c                   exsr      pdfinv
      *
      *hent arkivpost
      *
     c                   move      arlink        xxlink           40
     c     fins1         ifeq      'J'
     c                   move      xxlink        arlink
     c                   Move      'A'           arSTAT
     c                   update    arkivr2
     c                   else
s06  c*    fafakt        chain     fak9                               34
n06  c     fafakt        setll     fak9
n06  c                   setoff                                       66
n06  c     les9n         tag
n06  c     fafakt        reade     fak9                                   66
n06  c     *in66         ifeq      '0'
n06  c     fakda         cabeq     'K'           les9n
n06  c                   end
     c                   Move      'E'           arSTAT
     c   34              move      'N'           arstat
     c                   update    arkivr2
     c                   end
     c                   seton                                        lr
     c                   return
     c                   end
      *
      *ferje faktura
      *
     c     artype        ifeq      'ff'
     c                   exsr      pdfff
     c                   end
      *
      *transportøravregning
      *
     c     artype        ifeq      'ta'
     c                   exsr      pdftran
     c                   end
      *
      *proformafaktura
      *
     c     artype        ifeq      'pf'
     c                   exsr      pdfpf
     c                   end
      *
      *Invoice basis
      *
     c     artype        ifeq      'ib'
     c                   exsr      pdfib
     c                   end
      *
      *Invoice basis
      *
     c     artype        ifeq      'te'
     c                   exsr      pdfte
     c                   end
      * SVENSK NCTS EXPORT
      *
     C                   IF        ARTYPE = 'ne'
     C                   EXSR      PDFNE
     C                   END
      *
      *samlefaktura
      *skriver alle refer til arkivfil
      *
     c     artype        ifeq      'fs'
     c                   delete    arkivr2
     c                   exsr      pdfinvs
     c                   end
      *
      *Ametaavregning
      *
     c     artype        ifeq      'aa'
     c                   delete    arkivr2
     c                   exsr      pdfame
     c                   end
      *
      *CMR
      *
     c     artype        ifeq      'cm'
     c                   exsr      pdfcmr
     c                   end
      *
      *stykkgodsfraktbrev
      *
     c     artype        ifeq      'sb'
     c                   exsr      pdffb
     c                   end
      *
      *sad import/eksport
      *
     c     artype        ifeq      'si'
     c     artype        oreq      'se'
     c                   exsr      pdfsad
     c                   end
N66   *
N66   *AWB FLYFRAKTBREV merkelapper
N66   *
N66  c     artype        ifeq      'al'
N66  c                   exsr      pdfawbl
N66  c                   end
N71   *
N71   *AWB FLYFRAKTBREV merkelapper
N71   *
N71  c     artype        ifeq      'lf'
N71  c                   exsr      pdfl1fa
N71  c                   end
      *
      *AWB FLYFRAKTBREV SINGEL
      *
     c     artype        ifeq      'aw'
     c                   exsr      pdfawb
     c                   end
      *
      *AWB FLYFRAKTBREV SINGEL
      *
     c     artype        ifeq      'am'
     c                   delete    arkivr2
     c                   exsr      pdfawbm
     c                   end
      *
      *Godsliste for land
     c     artype        ifeq      'go'
      * tur må ha oppdrag
     C                   MOVEL     ARUNDE        TUPRO             8 0
     c     tupro         chain     head14                             33
     c     *in33         ifeq      '1'
     c                   delete    arkivr2
     c                   goto      stny
     c                   end
     c                   exsr      pdfgods
     c                   end
n11   *Lasteliste for land
n11  c     artype        ifeq      'la'
n11   * tur må ha oppdrag
n11  C                   MOVEL     ARUNDE        TUPRO             8 0
n11  c     tupro         chain     head14                             33
n11  c     *in33         ifeq      '1'
n11  c                   delete    arkivr2
n11  c                   goto      stny
n11  c                   end
n11  c                   exsr      pdflast
n11  c                   end
n11   *Losseliste for land import
n11  c     artype        ifeq      'lo'
n11   * tur må ha oppdrag
n11  C                   MOVEL     ARUNDE        TUPRO             8 0
n11  c     tupro         chain     head14                             33
n11  c     *in33         ifeq      '1'
n11  c                   delete    arkivr2
n11  c                   goto      stny
n11  c                   end
n11  c                   exsr      pdfloss
n11  c                   end
      *
      * MANIFEST FLY
     c     artype        ifeq      'mf'
     c                   delete    arkivr2
     c                   exsr      pdfman
     c                   end
N01   *
N01   * ADVISERING SJØ
N01   *
N01  C                   IF        ARTYPE = 'ad'
N01  C                   EXSR      PDFAD
N01  C                   END
N01   *
N01   * BOOKING SJØ
N01   *
N01  C                   IF        ARTYPE = 'bo'
N01  C                   EXSR      PDFBO
N01  C                   END
N01   *
N01   * SAMLASTSPESIFIKASJON SJØ
N01   *
N01  C                   IF        ARTYPE = 'ss'
N01  C                   EXSR      PDFSS
N01  C                   END
      *
      * svensk fortolling import
     c     artype        ifeq      'SI'
     c     artype        oreq      'SE'
     c     artype        oreq      'S1'
     c     artype        oreq      'S2'
     c     artype        oreq      'S3'
     c     artype        oreq      'S4'
     c                   exsr      pdfsve
     c                   end
N55   * dansk fortolling import
N55  c     artype        ifeq      'DI'
N55  c     artype        oreq      'DE'
N55  c     artype        oreq      'D1'
N55  c     artype        oreq      'D2'
N55  c     artype        oreq      'D3'
N55  c     artype        oreq      'D4'
N55  c                   exsr      pdfden
N55  c                   end
      * svensk utlæmningssedel
     c     artype        ifeq      'UT'
     c                   exsr      pdfutl
     c                   end
      *
n08   *
n08   * kjørekvittering
n08   *
n08  c     artype        ifeq      'kk'
n08  c                   exsr      pdfkk
n08  c                   end
      *
n39   *
n39   * kostnadsoverslag
n39   *
n39  c     artype        ifeq      'ko'
n39  c                   exsr      pdfko
n39  c                   end
n08   *
n08   * Arbeidsordre
n08   *
n08  c     artype        ifeq      'ae'
n08  c                   exsr      pdfae
n08  c                   end
      *
      * oppdaterer hvis ikke spesiallogikk på dokumentet
      *
     c     artype        ifne      'fs'
N65  c     artype        andne     'aa'
     c     artype        andne     'am'
     c     artype        andne     'te'
     c     artype        andne     'ne'
     c     artype        andne     'mf'
     c     artype        andne     'fa'
N01  c     artype        andne     'ss'
N57  c     artype        andne     'si'
N57  c     artype        andne     'se'
     c                   Move      'A'           arSTAT
     c                   except    updark2
     c                   end
     c                   end
N40  c                   end
     c     slutt         tag
     c                   seton                                        lr
     c                   return
      *
     C***********************************************
     C     PDFCMR        BEGSR
     C***********************************************
      * CMR fraktbrev
      *
      * tester om norsk eller utenlandsk variant
      *
     c                   move      'NO'          cmrlan            2
     C     FILAND        COMP      *BLANKS                            2727
     C   27FILAND        COMP      'NO'                               2727
     c   27              move      'EU'          cmrlan
     c* ordner start av linken med forståelig info
     c*
N02  c     keyhea        chain     headf                              33
     c     keyhea        chain     dokec                              33
     c   33keyhea        chain     dokece                             33
     c     *in33         ifeq      '0'
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     c*    dcsnr         ifne      *blanks
     C*    arlink        CAT       dcsnr:0       arlink
     c*                  else
     C     arlink        CAT       avdopd:0      arlink
     c*                  end
     c                   exsr      genbane
     C                   CALL      'PDF004CL'
     C                   PARM                    AAVD
     C                   PARM                    AOPD
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    cmrlan
     C                   PARM                    ARCINF
     C*
     c                   end
      *
N02  c     artype        chain     ARKTXT                             33
N02   *
N02   * skal kunde ha mail
N02   *
N02  c     arkund        ifeq      0
N02  c                   z-add     hekna         arkund
N02  c                   end
N02  c  N33arkund        ifne      0
N02  c                   z-add     arkund        tuknt
N02  C     ARKSND        IFEQ      'J'
N02  C     cmrtag        tag
N02  C                   MOVE      ARTXT         MAIL16           16
N02  C                   MOVEL     '*'           MAIL16
N02  c                   movel     MAIL16        mail30           30
N02  c                   moveL     artxt         wstex1           30
N02  c                   setoff                                       44
N02  c     mailk         setll     cundc03
N02  c     *in(44)       doweq     '0'
N02  c     mailk         reade     cundc03                                44
N02  c     *in(44)       ifeq      '0'
N02  C     KU0CMR        TAG
N02  c                   move      *blanks       eplink
N02  c                   move      *blanks       epline
N02  c                   move      *blanks       epbane
N02   *
N02   * slett eventuellt gamle poster
N02   *
N02  c                   exsr      delark
N02  c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N02  C     DCSNR         IFNE      *BLANKS
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C                   movel     'Shipmentno:' wstex2
N04  c                   else
N02  C                   movel     'Sendingsnr:' wstex2
N04  c                   end
N02  C     wstex2        CAT       DCSNR:1       wstex2
N02  C                   END
s04  c**   mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C  N33wstex2        cat       'To:':1       wstex2
N04  c                   else
N02  C  N33wstex2        cat       'Til:':1      wstex2
N04  c                   end
N02  C  N33wstex2        cat       knavn:1       wstex2
N02  c                   move      uusr          epuser
N02  c                   movel     uhttpi        eplink
N02  c                   movel     uhttpe        epline
N02  C     CLIVE         IFEQ      'V'
N02  c                   eval      EPBANE = UBANE
N02  C                   END
N02   *
N02   * skjekk om mailbruker  er intern
N02   *
N02  C                   MOVE      'E'           inteks
N02  C     CEMAIL        CHAIN     ARUSERL1                           33
N02  C  N33arinek        ifeq      'I'
N02  C                   MOVE      'I'           inteks
N02  c                   end
N02  c                   moveL     wstex1        eptex1
N02  c                   move      wstex2        eptex2
N02  c                   write     arkepor
N02  C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C                   movel     'CMR from'    wscvp1
n04  c                   else
N02  C                   movel     'CMR fra'     wscvp1
n04  c                   end
N02  C     wscvp1        cat       fift:1        wscvp1
N02  C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C                   movel     trykkcmre     wscvp2
n04  c                   else
N02  C                   movel     trykkcmr      wscvp2
n04  c                   end
N02  C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  c                   movel     vedleggcmre   wscvp2
N04  c                   else
N02  c                   movel     vedleggcmr    wscvp2
N04  c                   end
N02  C                   end
s18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
N02  c                   end
N02  c                   end
      *
N02   *  tester også fortollingsagent
N02  c     hekna         ifne      tuknt
N02  c     hekna         andne     *zeros
N02  c                   move      hekna         tuknt
N02  c                   goto      cmrtag
N02  c                   end
N02   *
N02   * eventuelt mail til seg selv   skjekk dette
N02   * gjøres kun 1 gang når kunde er ulik 0
N02   *
N02  c     tuknt         ifne      0
N02  c                   z-add     0             tuknt
N02  c     mailk         chain     cundc03                            33
N02  C     *IN33         IFEQ      '0'
N02  c     CEMAIL        ifeq      *blanks
N02  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N02  C                   PARM                    UUSR
N02  C                   PARM                    DIRENA            8
N02  C                   PARM                    DIREAD            8
N02  C                   PARM                    INTADR           70
N02  C                   EVAL      CEMAIL=INTADR
N02  C                   END
N02  C                   GOTO      KU0CMR
N02  C                   END
N02  C                   END
N02  c                   end
N02  c                   end
N02  C                   ENDSR
N02  C*
     C***********************************************
     C     PDFPF         BEGSR
     C***********************************************
      * Proforma faktura
      *
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   move      arunde        ucomm             1
N21  C                   MOVE      FINSSPE       UORDTYP           1
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     c                   exsr      genbane
     C                   CALL      'PDF011CL'
     C                   PARM                    Avdopd
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     C                   PARM                    ARCINF
     c                   parm                    ucomm
N21  C                   PARM                    UORDTYP
     C*
      *
     C                   ENDSR
     C***********************************************
     C     PDFIB         BEGSR
     C***********************************************
      * Proforma faktura
      *
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     c                   exsr      genbane
     C                   CALL      'PDF012CL'
     C                   PARM                    Avdopd
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     C                   PARM                    ARCINF
     C*
      *
     C                   ENDSR
     C***********************************************
     C     PDFTE         BEGSR
     C***********************************************
      * Transittering eksport
      *
     c     truvk         klist
     c                   kfld                    aravdi
     c                   kfld                    aropdi
     c                   move      aravd         aravdi            4 0
     c                   move      aropd         aropdi            7 0
n52   *
n52   * fikser bane til vareliste = UBANEV
n52   *
n52  c                   move      *blanks       arlink
n52  c                   movel     'tf'          arlink
n52  C                   move      *blanks       ubanev           50
n52  C     arlink        CAT       aar:0         arlink
n52  C     arlink        CAT       avdopd:0      arlink
n52  c                   exsr      genbane
n52  c                   move      *blanks       ubanev           50
n52  c                   movel     ubane         ubanev
n52  c                   move      *blanks       uhttpiv         152
n52  c                   movel     uhttpi        uhttpiv
n52  c                   move      *blanks       uhttpev         152
n52  c                   movel     uhttpe        uhttpev
n52  c                   movel     arlink        arlinkv          40
      *
     c* ordner start av linken med forståelig info  HOVEDARK
     c*
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     C                   MOVE      ARUNDE        TRETYP            1
     C                   MOVEl     ARUNDE        thPRO             8
     C                   MOVE      thpro         thPROn            8 0
     C                   z-add     thpron        hePRO
     c                   exsr      genbane
n52  c                   move      arlink        arlinkh          40
s52   *
s52   * fikser bane til vareliste = UBANEV
s52   *
s52  c*                  move      arlink        arlinkv          40
s52  c*                  movel     'tf'          arlinkv
s52  C*                  move      *blanks       ubanev           50
s52  C*                  movel     ubanesta      ubanev
s52  C*    ubanev        CAT       arlinkv:0     ubanev
s52  C*    ubanev        CAT       '.pdf':0      ubanev
      *
      *
     C                   CALL      'PDF013CL'
     C                   PARM                    ARAVD
     C                   PARM                    AROPD
     C                   PARM                    TRETYP
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    varel             1
     c                   parm                    ubanev
     C                   PARM                    ARCINF
     C*
     c                   Move      'A'           arSTAT
     c                   except    updark2
     c     varel         ifeq      'J'
     c                   move      'tf'          artype
s52  c*                  movel     'tf'          arlink
n52  c                   movel     arlinkv       arlink
     c                   write     arkivr
      *tilbakestill
     c                   move      'te'          artype
s52  c*                  movel     'te'          arlink
n52  c                   movel     arlinkh       arlink
     c                   end
      *
      * hvis flere oppdrag inngår legges disse i arkivp
      *
      *oppdaterer mot alle eventuelle headingrecord
      *
     c                   setoff                                       35
     c     truvk         setll     truv
     c     *in35         doweq     '0'
     c     lesnyte       tag
     c     truvk         reade     truv                                   35
     c     *in35         ifeq      '0'
      *ikke skriv doble record
     c     tvavd2        ifeq      aravdi
     c     tvtdn2        andeq     aropdi
     c                   goto      lesnyte
     c                   end
      *ikke skriv 0 record
     c     tvavd2        ifeq      0
     c     tvtdn2        oreq      0
     c                   goto      lesnyte
     c                   end
     C                   MOVE      tvavd2        ARAVD
     C                   MOVE      tvtdn2        AROPD
     c                   move      'A'           arstat
     c                   write     arkivr
     c                   end
     c                   end
      *
      *oppdaterer vareliste  mot alle headingrecord
     c     varel         ifeq      'J'
s52  c*                  movel     'tf'          arlink
n52  c                   eval      arlink=arlinkv
     c                   move      'tf'          artype
      *
     c                   setoff                                       35
     c     truvk         setll     truv
     c     *in35         doweq     '0'
     c     lesnytev      tag
     c     truvk         reade     truv                                   35
     c     *in35         ifeq      '0'
      *ikke skriv doble record
     c     tvavd2        ifeq      aravdi
     c     tvtdn2        andeq     aropdi
     c                   goto      lesnytev
     c                   end
      *ikke skriv 0 record
     c     tvavd2        ifeq      0
     c     tvtdn2        oreq      0
     c                   goto      lesnytev
     c                   end
     C                   MOVE      tvavd2        ARAVD
     C                   MOVE      tvtdn2        AROPD
     c                   move      'A'           arstat
     c                   write     arkivr
     c                   end
     c                   end
      *tilbakestill
     c                   move      'te'          artype
s52  c*                  movel     'te'          arlink
n52  c                   movel     arlinkh       arlink
     c                   end
N51   *
N51   *
N51  c     artype        chain     ARKTXT                             33
N51   *
N51   * SKAL skal ha en mail
N51   *
N51  c                   z-add     arkund        tuknt
N51  C     ARKSND        IFEQ      'J'
N51  C     tuknt         andne     0
N51  C                   MOVE      ARTXT         MAIL16           16
N51  C                   MOVEL     '*'           MAIL16
N51  c                   movel     MAIL16        mail30           30
N51  c                   setoff                                       44
N51  c     mailk         setll     cundc03
N51  c     *in(44)       doweq     '0'
N51  c     nestete       tag
N51  c     mailk         reade     cundc03                                44
N51  c     *in44         ifeq      '0'
N51  c                   exsr      testep
N51  c   33              goto      nestete
N51  c     ku0tet        tag
N51  c                   move      *blanks       eplink
N51  c                   move      *blanks       epline
N51  c                   move      *blanks       epbane
N51  c* slett eventuellt gamle poster
N51  c                   exsr      delark
N51  c                   move      *blanks       wstex2
N51  c                   move      *blanks       wstex1
N51  c     mailkk        CHAIN     CUNDL01                            33
N51  C                   movel     'NCTS:'       wstex2
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  C     wstex2        CAT       thpro:1       wstex2
N51  C     wstex2        CAT       'Date':1      wstex2
N51  c                   else
N51  C     wstex2        CAT       afak:1        wstex2
N51  C     wstex2        CAT       'Dato':1      wstex2
N51  c                   end
N51  C     wstex2        CAT       DAG:1         wstex2
N51  C     wstex2        CAT       '.':0         wstex2
N51  C     wstex2        CAT       MND:0         wstex2
N51  C     wstex2        CAT       '.':0         wstex2
N51  C     wstex2        CAT       AAR:0         wstex2
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  C  N33wstex2        cat       'To:':1       wstex2
N51  c                   else
N51  C  N33wstex2        cat       'Til:':1      wstex2
N51  c                   end
N51  C  N33wstex2        cat       knavn:1       wstex2
N51  c                   move      uusr          epuser
N51  c                   move      *blanks       eplink
N51  c                   move      *blanks       epline
N51  C                   MOVE      *BLANKS       EPBANE
N51  c                   movel     uhttpi        eplink
N51  c                   movel     uhttpe        epline
N51  C     CLIVE         IFEQ      'V'
N51  c                   eval      EPBANE = UBANE
N51  C                   END
N51   * skjekk om mailbruker  er intern
N51  C                   MOVE      'E'           inteks
N51  C     CEMAIL        CHAIN     ARUSERL1                           33
N51  C  N33arinek        ifeq      'I'
N51  C                   MOVE      'I'           inteks
N51  c                   end
N51  c                   movel     wstex1        eptex1
N51  c                   move      wstex2        eptex2
N51  c                   write     arkepor
N51   *
N51   *Vareliste
N51   *
N51  c     Varel         ifeq      'J'
N51   *
N51   * skjekk om mailbruker  er intern
N51   *
s52  c*                  movel     uhttpis       eplink
s52  c*                  movel     uhttpes       epline
n52  c                   movel     uhttpiv       eplink
n52  c                   movel     uhttpev       epline
N51  C     CLIVE         IFEQ      'V'
s52  c*                  eval      EPBANE = UBANES
n52  c                   eval      EPBANE = UBANEV
N51  C                   END
N51  C                   MOVE      'E'           inteks
N51  C     CEMAIL        CHAIN     ARUSERL1                           33
N51  C  N33arinek        ifeq      'I'
N51  C                   MOVE      'I'           inteks
N51  c                   end
N51  c                   move      *blanks       wstex1           30
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  c                   moveL     'Goodslist'   wste13           13
N51  c                   else
N51  c                   moveL     'Vareliste'   wste13           13
N51  c                   end
N51  c                   moveL     wste13        wstex1           30
N51  c                   movel     wstex1        eptex1
N51  c                   move      wstex2        eptex2
N51  c                   write     arkepor
N51  c                   end
N51  C                   move      *blanks       wscvp1
N51  C                   movel     'NCTS '       wscvp1
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  C     wscvp1        cat       'from':1      wscvp1
N51  c                   else
N51  C     wscvp1        cat       'fra':1       wscvp1
N51  c                   end
N51  C     wscvp1        cat       fift:1        wscvp1
N51  C                   move      *blanks       wscvp2
N51  C     CLIVE         IFNE      'V'
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  C                   movel     trykknce      wscvp2
N51  c                   else
N51  C                   movel     trykknc       wscvp2
N51  c                   end
N51  C                   else
N51  C     spraak        ifeq      'E'
N51  c     spraak        oreq      'T'
N51  c                   movel     vedleggnce    wscvp2
N51  c                   else
N51  c                   movel     vedleggnc     wscvp2
N51  c                   end
N51  C                   end
N51   *
      * sender epost
      *
N51  C                   EXSR      EPOSTSR
N51  C                   CLEAR                   trackfr
N51  C                   eval      tttext='emailed NCTS to:'
N51  C                   movel     CEMAIL        CEMA50           50
N51  C     tttext        cat       CEMA50:1      tttext
N51  C                   move      CCOMPN        tttext
N51  C                   eval      tttexl='Epost av NCTS til:'
N51  C     tttexl        cat       CEMA50:1      tttexl
N51  C                   move      CCOMPN        tttexl
N51  c                   movel     'N:'          ttdepo
N51  C                   move      THPRO         ttdepo
N51  C                   EXSR      TTSRNC
N51  c                   end
     c                   end
N51  c                   end
N51   *
N51   * eventuelt mail til seg selv   skjekk dette
N51   * gjøres kun 1 gang når kunde er ulik 0
N51   *
N51  c     tuknt         ifne      0
N51  c                   z-add     0             tuknt
N51  c     mailk         chain     cundc03                            33
N51  C     *IN33         IFEQ      '0'
N51  c     CEMAIL        ifeq      *blanks
N51  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N51  C                   PARM                    UUSR
N51  C                   PARM                    DIRENA            8
N51  C                   PARM                    DIREAD            8
N51  C                   PARM                    INTADR           70
N51  C                   EVAL      CEMAIL=INTADR
N51  C                   END
N51  C                   GOTO      KU0TET
N51  C                   END
N51  c                   end
      *
     C                   ENDSR
     C*
     C***********************************************
     C     PDFNE         BEGSR
     C***********************************************
      * SVENSK NCTS EXPORT
      *
     C     SVXVK         klist
     C                   kfld                    xaravdi
     C                   kfld                    xaropdi
     C                   move      aravd         xaravdi           4 0
     C                   move      aropd         xaropdi           7 0
      * ordner start av linken med forståelig info
      *
     C                   move      *blanks       arlink
     C                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     C                   MOVE      ARUNDE        TRETYP            1
     C                   MOVEl     ARUNDE        thPRO             8
     C                   MOVE      thpro         thPROn            8 0
     C                   z-add     thpron        hePRO
     C                   exsr      genbane
      *
      * fikser bane til vareliste = UBANEV
      *
     C                   move      arlink        arlinkv          40
     C                   movel     'nv'          arlinkv
     C                   move      *blanks       ubanev           50
     C                   movel     ubanesta      ubanev
     C     ubanev        CAT       arlinkv:0     ubanev
     C     ubanev        CAT       '.pdf':0      ubanev
     C                   move      aravd         xaravdA           4
     C                   move      aropd         xaropdA           7
     C                   CALL      'PDF018CL'
     C                   PARM                    XARAVDA
     C                   PARM                    XAROPDA
     C                   PARM                    TRETYP
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     C                   parm                    varel             1
     C                   parm                    ubanev
     C                   PARM                    ARCINF
      *
     C                   Move      'A'           arSTAT
     c                   except    updark2
     C     varel         ifeq      'J'
     C                   move      'nv'          artype
     C                   movel     'nv'          arlink
     C                   write     arkivr
      *tilbakestill
     C                   move      'ne'          artype
     C                   movel     'ne'          arlink
     C                   end
      *
      * hvis flere oppdrag inngår legges disse i arkivp
      *
     c*                  dump
      *oppdaterer mot alle eventuelle headingrecord
      *
     C                   setoff                                       35
     C     SVXVK         SETLL     SVXV
     C     *in35         doweq     '0'
     C     STPDFNE       TAG
     C     SVXVK         READE     SVXV                                   35
     C     *in35         ifeq      '0'
      *ikke skriv doble record
     c     tvavd2        ifeq      aravdi
     c     SVX_tvtdn2    andeq     aropdi
     c                   goto      STPDFNE
     c                   end
      *ikke skriv 0 record
     c     tvavd2        ifeq      0
     c     SVX_tvtdn2    oreq      0
     c                   goto      STPDFNE
     c                   end
     C                   MOVE      Tvavd2        ARAVD
     C                   MOVE      SVX_tvtdn2    AROPD
     c                   move      'A'           arstat
     c                   write     arkivr
     C                   end
     C                   end
      *
      *oppdaterer vareliste  mot alle headingrecord
     C     varel         ifeq      'J'
     C                   movel     'nv'          arlink
     C                   move      'nv'          artype
      *
     C                   setoff                                       35
     C     SVXVK         SETLL     SVXV
     C     *in35         doweq     '0'
     C     STPDFNE2      TAG
     C     SVXVK         READE     SVXV                                   35
     C     *in35         ifeq      '0'
      *ikke skriv doble record
     C     tvavd2        ifeq      aravdi
     C     SVX_tvtdn2    andeq     aropdi
     C                   goto      STPDFNE2
     C                   end
      *ikke skriv 0 record
     C     tvavd2        ifeq      0
     C     SVX_tvtdn2    oreq      0
     C                   goto      STPDFNE2
     C                   end
     C                   MOVE      tvavd2        ARAVD
     C                   MOVE      SVX_tvtdn2    AROPD
     C                   move      'A'           arstat
     C                   write     arkivr
     C                   end
     C                   end
      *tilbakestill
     C                   move      'ne'          artype
     C                   movel     'ne'          arlink
     C                   end
      *
     C                   ENDSR
      *
     C***********************************************
     C     PDFAWB        BEGSR
     C***********************************************
      * AWB flyfraktbrev
     c     keyhea        chain     headf                              33
     c     *in33         ifeq      '0'
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     c                   movel     arunde        uulope            3
     C     arlink        CAT       aar:0         arlink
     c     hegn11        ifne      *blanks
     c     hegn11        andne     *zeros
     C     arlink        CAT       hegn11:0      arlink
     c                   else
     C     arlink        CAT       avdopd:0      arlink
     c                   end
     c                   exsr      genbane
     C                   CALL      'PDF007CL'
     C                   PARM                    AAVD
     C                   PARM                    AOPD
     C                   PARM                    uulope
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
      *
     c     artype        chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
     c  N33arkund        ifne      0
     c                   z-add     arkund        tuknt
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     C     KU0AWB        TAG
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     c                   move      *blanks       epbane
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'AWB-number:' wstex2
n04  c                   else
     C                   movel     'AWB-nummer:' wstex2
n04  c                   end
     C     wstex2        CAT       hegn11:1      wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C  N33wstex2        cat       'From:':1     wstex2
n04  c                   else
     C  N33wstex2        cat       'Fra:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Airwaybill'  wscvp1
     C     wscvp1        cat       'from:':0     wscvp1
n04  c                   else
     C                   movel     'Flyfraktbrev'wscvp1
     C     wscvp1        cat       'fra:':0      wscvp1
N04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkawe      wscvp2
n04  c                   else
     C                   movel     trykkaw       wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggawe    wscvp2
n04  c                   else
     c                   movel     vedleggaw     wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   end
     c                   end
      * eventuelt mail til seg selv
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0AWB
     C                   END
     C                   END
     c                   end
     c                   end
     c                   end
     C*
     C                   ENDSR
N66  C***********************************************
N66  C     PDFAWBL       BEGSR
N66  C***********************************************
N66  C                   MOVEL     *blanks       uuSAM             6
N66   * AWB flyfraktbrev
N66  c     keyhea        chain     headf                              33
N66  c     *in33         ifeq      '0'
N68  c                   movel     hesaml        uusam
N66  c                   move      *blanks       arlink
N66  c                   movel     artype        arlink
N66  c                   movel     arunde        uulope            3
N66  C     arlink        CAT       aar:0         arlink
N66  c     hegn11        ifne      *blanks
N66  c     hegn11        andne     *zeros
N66  C     arlink        CAT       hegn11:0      arlink
N66  c                   else
N66  C     arlink        CAT       avdopd:0      arlink
N66  c                   end
N66  c                   exsr      genbane
N66  C                   CALL      'PDF034CL'
N66  C                   PARM                    AAVD
N66  C                   PARM                    AOPD
N66  C                   PARM                    uulope
N66  C                   PARM                    uusam
N66  C                   PARM                    uhttpi
N66  C                   PARM                    ubane
N66  c                   parm                    vise
N66  c                   parm                    arcinf
N66   *
N66  c     artype        chain     ARKTXT                             33
N66   *
N66   * skal kunde ha mail
N66   *
N66  c  N33arkund        ifne      0
N66  c                   z-add     arkund        tuknt
N66  C     ARKSND        IFEQ      'J'
N66  C                   MOVE      ARTXT         MAIL16           16
N66  C                   MOVEL     '*'           MAIL16
N66  c                   movel     MAIL16        mail30           30
N66  c                   moveL     artxt         wstex1           30
N66  c                   setoff                                       44
N66  c     mailk         setll     cundc03
N66  c     *in(44)       doweq     '0'
N66  c     mailk         reade     cundc03                                44
N66  c     *in(44)       ifeq      '0'
N66  C     KU0AWBL       TAG
N66  c                   move      *blanks       eplink
N66  c                   move      *blanks       epline
N66  c                   move      *blanks       epbane
N66   *
N66   * slett eventuellt gamle poster
N66   *
N66  c                   exsr      delark
N66  c                   move      *blanks       wstex2
N66  c     mailkk        CHAIN     CUNDL01                            33
N66  C     spraak        ifeq      'E'
N66  c     spraak        oreq      'T'
N66  C                   movel     'AWB-number:' wstex2
N66  c                   else
N66  C                   movel     'AWB-nummer:' wstex2
N66  c                   end
N66  C     wstex2        CAT       hegn11:1      wstex2
N66  c*    mailkk        CHAIN     CUNDL01                            33
N66  C     spraak        ifeq      'E'
N66  c     spraak        oreq      'T'
N66  C  N33wstex2        cat       'From:':1     wstex2
N66  c                   else
N66  C  N33wstex2        cat       'Fra:':1      wstex2
N66  c                   end
N66  C  N33wstex2        cat       knavn:1       wstex2
N66  c                   move      uusr          epuser
N66  c                   movel     uhttpi        eplink
N66  c                   movel     uhttpe        epline
N66  C     CLIVE         IFEQ      'V'
N66  c                   eval      EPBANE = UBANE
N66  C                   END
N66   *
N66   * skjekk om mailbruker  er intern
N66   *
N66  C                   MOVE      'E'           inteks
N66  C     CEMAIL        CHAIN     ARUSERL1                           33
N66  C  N33arinek        ifeq      'I'
N66  C                   MOVE      'I'           inteks
N66  c                   end
N66  c                   moveL     wstex1        eptex1
N66  c                   move      wstex2        eptex2
N66  c                   write     arkepor
N66  C                   move      *blanks       wscvp1
N66  C     spraak        ifeq      'E'
N66  c     spraak        oreq      'T'
N66  C                   movel     'Airwaybill'  wscvp1
N66  C     wscvp1        cat       'from:':0     wscvp1
N66  c                   else
N66  C                   movel     'Flyfraktbrev'wscvp1
N66  C     wscvp1        cat       'fra:':0      wscvp1
N66  c                   end
N66  C     wscvp1        cat       fift:1        wscvp1
N66  C     CLIVE         IFNE      'V'
N66  C     spraak        ifeq      'E'
N66  c     spraak        oreq      'T'
N66  C                   movel     trykkawe      wscvp2
N66  c                   else
N66  C                   movel     trykkaw       wscvp2
N66  c                   end
N66  C                   else
N66  C     spraak        ifeq      'E'
N66  c     spraak        oreq      'T'
N66  c                   movel     vedleggawe    wscvp2
N66  c                   else
N66  c                   movel     vedleggaw     wscvp2
N66  c                   end
N66  C                   end
N66  C                   EXSR      EPOSTSR
N66  c                   end
N66  c                   end
N66   * eventuelt mail til seg selv
N66  c     tuknt         ifne      0
N66  c                   z-add     0             tuknt
N66  c     mailk         chain     cundc03                            33
N66  C     *IN33         IFEQ      '0'
N66  c     CEMAIL        ifeq      *blanks
N66  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N66  C                   PARM                    UUSR
N66  C                   PARM                    DIRENA            8
N66  C                   PARM                    DIREAD            8
N66  C                   PARM                    INTADR           70
N66  C                   EVAL      CEMAIL=INTADR
N66  C                   END
N66  C                   GOTO      KU0AWBL
N66  C                   END
N66  C                   END
N66  c                   end
N66  c                   end
N66  c                   end
N66  C*
N66  C                   ENDSR
N66  C***********************************************
N71  C     PDFL1FA       BEGSR
N71  C***********************************************
N71   * L1 fakturaer
N71  c                   movel     arunde        l1fanr            7
N71  c                   move      *blanks       arlink
N71  c                   movel     artype        arlink
N71  C     arlink        CAT       aar:0         arlink
N71  C     arlink        CAT       l1fanr:0      arlink
N71  c                   exsr      genbane
N71  C                   CALL      'PDF035CL'
N71  C                   PARM                    L1fanr
N71  C                   PARM                    uhttpi
N71  C                   PARM                    ubane
N71  c                   parm                    vise
N71  c                   parm                    arcinf
N71   *
N71  c     artype        chain     ARKTXT                             33
N71   *
N71   * skal kunde ha mail
N71   *
N71  c  N33arkund        ifne      0
N71  c                   z-add     arkund        tuknt
N71  C     ARKSND        IFEQ      'J'
N71  C                   MOVE      ARTXT         MAIL16           16
N71  C                   MOVEL     '*'           MAIL16
N71  c                   movel     MAIL16        mail30           30
N71  c                   moveL     artxt         wstex1           30
N71  c                   setoff                                       44
N71  c     mailk         setll     cundc03
N71  c     *in(44)       doweq     '0'
N71  c     mailk         reade     cundc03                                44
N71  c     *in(44)       ifeq      '0'
N71  C     KU0L1FA       TAG
N71  c                   move      *blanks       eplink
N71  c                   move      *blanks       epline
N71  c                   move      *blanks       epbane
N71   *
N71   * slett eventuellt gamle poster
N71   *
N71  c                   exsr      delark
N71  c                   move      *blanks       wstex2
N71  c     mailkk        CHAIN     CUNDL01                            33
N71  C     spraak        ifeq      'E'
N71  c     spraak        oreq      'T'
N71  C                   movel     'fakturanr:'  wstex2
N71  c                   else
N71  C                   movel     'Fakturanr:'  wstex2
N71  c                   end
N71  C     wstex2        CAT       l1fanr:1      wstex2
N71  c*    mailkk        CHAIN     CUNDL01                            33
N71  C     spraak        ifeq      'E'
N71  c     spraak        oreq      'T'
N71  C  N33wstex2        cat       'From:':1     wstex2
N71  c                   else
N71  C  N33wstex2        cat       'Fra:':1      wstex2
N71  c                   end
N71  C  N33wstex2        cat       fift:1        wstex2
N71  c                   move      uusr          epuser
N71  c                   movel     uhttpi        eplink
N71  c                   movel     uhttpe        epline
N71  C     CLIVE         IFEQ      'V'
N71  c                   eval      EPBANE = UBANE
N71  C                   END
N71   *
N71   * skjekk om mailbruker  er intern
N71   *
N71  C                   MOVE      'E'           inteks
N71  C     CEMAIL        CHAIN     ARUSERL1                           33
N71  C  N33arinek        ifeq      'I'
N71  C                   MOVE      'I'           inteks
N71  c                   end
N71  c                   moveL     wstex1        eptex1
N71  c                   move      wstex2        eptex2
N71  c                   write     arkepor
N71  C                   move      *blanks       wscvp1
N71  C     spraak        ifeq      'E'
N71  c     spraak        oreq      'T'
N71  C                   movel     'Invoice'     wscvp1
N71  C     wscvp1        cat       'from:':1     wscvp1
N71  c                   else
N71  C                   movel     'Faktura:'    wscvp1
N71  C     wscvp1        cat       'fra:':1      wscvp1
N71  c                   end
N71  C     wscvp1        cat       fift:1        wscvp1
N71  C     CLIVE         IFNE      'V'
N71  C     spraak        ifeq      'E'
N71  c     spraak        oreq      'T'
N71  C                   movel     trykkfe       wscvp2
N71  c                   else
N71  C                   movel     trykkf        wscvp2
N71  c                   end
N71  C                   else
N71  C     spraak        ifeq      'E'
N71  c     spraak        oreq      'T'
N71  c                   movel     vedleggfe     wscvp2
N71  c                   else
N71  c                   movel     vedleggf      wscvp2
N71  c                   end
N71  C                   end
N71  C                   EXSR      EPOSTSR
N71  c                   end
N71  c                   end
N71   * eventuelt mail til seg selv
N71  c     tuknt         ifne      0
N71  c                   z-add     0             tuknt
N71  c     mailk         chain     cundc03                            33
N71  C     *IN33         IFEQ      '0'
N71  c     CEMAIL        ifeq      *blanks
N71  C                   MOVE      *BLANKS       INTADR
N71  C*                  CALL      'EPOS04'
N71  C                   CALL      'EPOS04E'
N71  C                   PARM                    UUSR
N71  C                   PARM                    DIRENA            8
N71  C                   PARM                    DIREAD            8
N71  C                   PARM                    INTADR           70
N71  C                   EVAL      CEMAIL=INTADR
N71  C                   END
N71  C                   GOTO      KU0L1FA
N71  C                   END
N71  C                   END
N71  c                   end
N71  c                   end
N71  C*
N71  C                   ENDSR
N71  C*
     C***********************************************
     C     PDFAWBM       BEGSR
     C***********************************************
      * samlast fly
     c                   Move      'A'           arSTAT
     C                   MOVEL     ARUNDE        samlnr            6
     c                   movel     samlnr        saml1             3
     c                   move      samlnr        saml2             3
     c                   move      aravd         xxavd             4
     c                   setoff                                       35
     c                   move      aravd         xxavd             4
     C                   MOVE      *zeros        ARAVD
     C                   MOVE      *zeros        AROPD
      *
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       samlnr:0      arlink
     c                   exsr      genbane
      *
     C                   CALL      'PDF008CL'
     C                   PARM                    XXavd
     C                   PARM                    saml1
     C                   PARM                    saml2
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
     C*
      *
      * skriver 1 record pr oppdrag ved Master samlast
      *
     c     samlnr        setll     head19
     c     *in35         doweq     '0'
     c     samlnr        reade     head19                                 35
     c     *in35         ifeq      '0'
     C                   MOVE      HEAVD         ARAVD
     C                   MOVE      HEOPD         AROPD
     c                   write     arkivr
     c                   end
     c                   end
      *
     C                   ENDSR
     C*
     C*
n08  C***********************************************
n08  C     PDFKK         BEGSR
n08  C***********************************************
n08   * kjørekvittering
n08  c     keyhea        chain     headf                              33
n08  c     *in33         ifeq      '0'
n08  c                   move      *blanks       arlink
n08  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
n08  c                   movel     arunde        uulope            3
n08  C     arlink        CAT       aar:0         arlink
n08  C     arlink        CAT       avdopd:0      arlink
n08  c                   exsr      genbane
n08  C                   CALL      'PDF026CL'
n08  C                   PARM                    AAVD
n08  C                   PARM                    AOPD
n08  C                   PARM                    uhttpi
n08  C                   PARM                    ubane
n08  c                   parm                    vise
n08  c                   parm                    arcinf
n08   *
n08  c     artype        chain     ARKTXT                             33
n08   *
n08   * skal kunde ha mail
n08   *
n08  c  N33arkund        ifne      0
n08  c                   z-add     arkund        tuknt
n08  C     ARKSND        IFEQ      'J'
n08  C                   MOVE      ARTXT         MAIL16           16
n08  C                   MOVEL     '*'           MAIL16
n08  c                   movel     MAIL16        mail30           30
n08  c                   moveL     artxt         wstex1           30
n08  c                   setoff                                       44
n08  c     mailk         setll     cundc03
n08  c     *in(44)       doweq     '0'
n08  c     mailk         reade     cundc03                                44
n08  c     *in(44)       ifeq      '0'
n08  C     KU0KK         TAG
n08  c                   move      *blanks       eplink
n08  c                   move      *blanks       epline
n08  c                   move      *blanks       epbane
n08   *
n08   * slett eventuellt gamle poster
n08   *
n08  c                   exsr      delark
n08  c                   move      *blanks       wstex2
n08  c     mailkk        CHAIN     CUNDL01                            33
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     'Order:'      wstex2
n08  c                   else
n08  C                   movel     'Ordre:'      wstex2
n08  c                   end
n08  C     wstex2        CAT       aavd:1        wstex2
n08  C     wstex2        CAT       '/':0         wstex2
n08  C     wstex2        CAT       aopd:1        wstex2
n08  c*    mailkk        CHAIN     CUNDL01                            33
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C     wstex2        cat       'From:':1     wstex2
n08  c                   else
n08  C     wstex2        cat       'Fra:':1      wstex2
n08  c                   end
n08  C     wstex2        cat       FIFT:1        wstex2
n08  c                   move      uusr          epuser
n08  c                   movel     uhttpi        eplink
n08  c                   movel     uhttpe        epline
n08  C     CLIVE         IFEQ      'V'
n08  c                   eval      EPBANE = UBANE
n08  C                   END
n08   *
n08   * skjekk om mailbruker  er intern
n08   *
n08  C                   MOVE      'E'           inteks
n08  C     CEMAIL        CHAIN     ARUSERL1                           33
n08  C  N33arinek        ifeq      'I'
n08  C                   MOVE      'I'           inteks
n08  c                   end
n08  c                   moveL     wstex1        eptex1
n08  c                   move      wstex2        eptex2
n08  c                   write     arkepor
n08  C                   move      *blanks       wscvp1
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     'Arrivalnote' wscvp1
n08  C     wscvp1        cat       'from:':1     wscvp1
n08  c                   else
n08  C                   movel     'Meldeseddel' wscvp1
n08  C     wscvp1        cat       'fra:':1      wscvp1
n08  c                   end
n08  C     wscvp1        cat       fift:1        wscvp1
n08  C     CLIVE         IFNE      'V'
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     trykkkke      wscvp2
n08  c                   else
n08  C                   movel     trykkkk       wscvp2
n08  c                   end
n08  C                   else
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  c                   movel     vedleggkke    wscvp2
n08  c                   else
n08  c                   movel     vedleggkk     wscvp2
n08  c                   end
n08  C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
n08  c                   end
n08  c                   end
n08   * eventuelt mail til seg selv
n08  c     tuknt         ifne      0
n08  c                   z-add     0             tuknt
n08  c     mailk         chain     cundc03                            33
n08  C     *IN33         IFEQ      '0'
n08  c     CEMAIL        ifeq      *blanks
n08  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
n08  C                   PARM                    UUSR
n08  C                   PARM                    DIRENA            8
n08  C                   PARM                    DIREAD            8
n08  C                   PARM                    INTADR           70
n08  C                   EVAL      CEMAIL=INTADR
n08  C                   END
n08  C                   GOTO      KU0KK
n08  C                   END
n08  C                   END
n08  c                   end
n08  c                   end
n08  c                   end
n08  C*
n08  C                   ENDSR
n08  C*
n39  C**************0********************************
n39  C     PDFKO         BEGSR
n39  C***********************************************
n39   * kostnadsoverslag
n39  c     keyhea        chain     headf                              33
n39  c     *in33         ifeq      '0'
n39  c                   move      *blanks       arlink
n39  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
n39  c                   movel     arunde        uulope            3
N39  C                   MOVE      ARKUND        AKUN              8
N39  C     KUNKEY        CHAIN     CUNDL01                            33
n39  C     VALKOD        IFEQ      FICURR
n39  C                   MOVE      *BLANKS       SAVAL             3
n39  C                   ELSE
n39  C                   MOVE      VALKOD        SAVAL
n39  C                   END
N39  C                   MOVE      'A'           ANTKOK
N39  C                   TIME                    XULTID
N39  C                   MOVE      XULDD         ULDD
N39  C                   MOVE      XULMM         ULMM
N39  C                   MOVE      XULÅÅ         ULÅÅ
N39  C                   MOVE      ULDT          ULDT6
N39  C                   MOVE      *ZEROS        ULDNUL            6
N39  C                   MOVE      *ZEROS        YYFAKT
N48  C                   MOVEL     ARUNDE        YYFAKT
N39  C     ARKUND        CHAIN     CUSAPR                             33
n39  C     arlink        CAT       aar:0         arlink
n39  C     arlink        CAT       avdopd:0      arlink
n39  c                   exsr      genbane
n39  C                   CALL      'PDF031CL'
n39  C                   PARM                    AKUN
n39  C                   PARM                    AAVD
N39  C                   PARM                    AOPD
N39  C                   PARM                    YYFAKT            7
N39  C                   PARM                    SAVAL
N39  C                   PARM                    ANTKOK            1
N39  C                   PARM                    CPKOHE
n39  C                   PARM                    ULDT6             6
n39  C                   PARM                    ULDNUL
n39  C                   PARM                    CPKO
n39  C                   PARM                    uhttpi
n39  C                   PARM                    ubane
n39  c                   parm                    vise
n39  c                   parm                    arcinf
n39   *
n39  c     artype        chain     ARKTXT                             33
n39   *
n39   * skal kunde ha mail
n39   *
n39  c  N33arkund        ifne      0
n39  c                   z-add     arkund        tuknt
n39  C     ARKSND        IFEQ      'J'
n39  C                   MOVE      ARTXT         MAIL16           16
n39  C                   MOVEL     '*'           MAIL16
n39  c                   movel     MAIL16        mail30           30
n39  c                   moveL     artxt         wstex1           30
n39  c                   setoff                                       44
n39  c     mailk         setll     cundc03
n39  c     *in(44)       doweq     '0'
n39  c     mailk         reade     cundc03                                44
n39  c     *in(44)       ifeq      '0'
n39  C     KU0KO         TAG
n39  c                   move      *blanks       eplink
n39  c                   move      *blanks       epline
n39  c                   move      *blanks       epbane
n39   *
n39   * slett eventuellt gamle poster
n39   *
n39  c                   exsr      delark
n39  c                   move      *blanks       wstex2
n39  c     mailkk        CHAIN     CUNDL01                            33
n39  C     spraak        ifeq      'E'
n39  c     spraak        oreq      'T'
n39  C                   movel     'Order:'      wstex2
n39  c                   else
n39  C                   movel     'Ordre:'      wstex2
n39  c                   end
n39  C     wstex2        CAT       aavd:1        wstex2
n39  C     wstex2        CAT       '/':0         wstex2
n39  C     wstex2        CAT       aopd:1        wstex2
n39  c*    mailkk        CHAIN     CUNDL01                            33
n39  C     spraak        ifeq      'E'
n39  c     spraak        oreq      'T'
n39  C     wstex2        cat       'From:':1     wstex2
n39  c                   else
n39  C     wstex2        cat       'Fra:':1      wstex2
n39  c                   end
n39  C     wstex2        cat       FIFT:1        wstex2
n39  c                   move      uusr          epuser
n39  c                   movel     uhttpi        eplink
n39  c                   movel     uhttpe        epline
n39  C     CLIVE         IFEQ      'V'
n39  c                   eval      EPBANE = UBANE
n39  C                   END
n39   *
n39   * skjekk om mailbruker  er intern
n39   *
n39  C                   MOVE      'E'           inteks
n39  C     CEMAIL        CHAIN     ARUSERL1                           33
n39  C  N33arinek        ifeq      'I'
n39  C                   MOVE      'I'           inteks
n39  c                   end
n39  c                   moveL     wstex1        eptex1
n39  c                   move      wstex2        eptex2
n39  c                   write     arkepor
n39  C                   move      *blanks       wscvp1
n39  C     spraak        ifeq      'E'
n39  c     spraak        oreq      'T'
n39  C                   movel     'Costbudget'  wscvp1
n39  C     wscvp1        cat       'from:':1     wscvp1
n39  c                   else
n39  C                   movel     'Kostoverslag'wscvp1
n39  C     wscvp1        cat       'fra:':1      wscvp1
n39  c                   end
n39  C     wscvp1        cat       fift:1        wscvp1
n39  C     CLIVE         IFNE      'V'
n39  C     spraak        ifeq      'E'
n39  c     spraak        oreq      'T'
n39  C                   movel     trykkkoe      wscvp2
n39  c                   else
n39  C                   movel     trykkko       wscvp2
n39  c                   end
n39  C                   else
n39  C     spraak        ifeq      'E'
n39  c     spraak        oreq      'T'
n39  c                   movel     vedleggkoe    wscvp2
n39  c                   else
n39  c                   movel     vedleggko     wscvp2
n39  c                   end
n39  C                   end
N43  C                   EXSR      EPOSTSR
n39  C                   CLEAR                   trackfr
n39  C                   eval      tttext='emailed Costbudget:'
n39  C                   movel     CEMAIL        CEMA50           50
n39  C     tttext        cat       CEMA50:1      tttext
n39  C                   move      CCOMPN        tttext
n39  C                   eval      tttexl='Epost av kost.overslag:'
n39  C     tttexl        cat       CEMA50:1      tttexl
n39  C                   move      CCOMPN        tttexl
n39  c                   movel     'KOS'         ttdepo
n39  C                   EXSR      TTSR
n39  c                   end
n39  c                   end
n39   * eventuelt mail til seg selv
n39  c     tuknt         ifne      0
n39  c                   z-add     0             tuknt
n39  c     mailk         chain     cundc03                            33
n39  C     *IN33         IFEQ      '0'
n39  c     CEMAIL        ifeq      *blanks
n39  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
n39  C                   PARM                    UUSR
n39  C                   PARM                    DIRENA            8
n39  C                   PARM                    DIREAD            8
n39  C                   PARM                    INTADR           70
n39  C                   EVAL      CEMAIL=INTADR
n39  C                   END
n39  C                   GOTO      KU0KO
n39  C                   END
n39  C                   END
n39  c                   end
n39  c                   end
n39  c                   end
n39  C*
n39  C                   ENDSR
n08  C*
n08  C***********************************************
n08  C     PDFAE         BEGSR
n08  C***********************************************
n08   * kjørekvittering
n08  c     keyhea        chain     headf                              33
n08  c     *in33         ifeq      '0'
n08  c                   move      *blanks       arlink
n08  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
n08  c                   movel     arunde        uulope            3
n08  C     arlink        CAT       aar:0         arlink
n08  C     arlink        CAT       avdopd:0      arlink
n08  c                   exsr      genbane
n08  C                   CALL      'PDF027CL'
n08  C                   PARM                    AAVD
n08  C                   PARM                    AOPD
n08  C                   PARM                    uhttpi
n08  C                   PARM                    ubane
n08  c                   parm                    vise
n08  c                   parm                    arcinf
n08   *
n08  c     artype        chain     ARKTXT                             33
n08   *
n08   * skal kunde ha mail
n08   *
n08  c  N33arkund        ifne      0
n08  c                   z-add     arkund        tuknt
n08  C     ARKSND        IFEQ      'J'
n08  C                   MOVE      ARTXT         MAIL16           16
n08  C                   MOVEL     '*'           MAIL16
n08  c                   movel     MAIL16        mail30           30
n08  c                   moveL     artxt         wstex1           30
n08  c                   setoff                                       44
n08  c     mailk         setll     cundc03
n08  c     *in(44)       doweq     '0'
n08  c     mailk         reade     cundc03                                44
n08  c     *in(44)       ifeq      '0'
n08  C     KU0KKAE       TAG
n08  c                   move      *blanks       eplink
n08  c                   move      *blanks       epline
n08  c                   move      *blanks       epbane
n08   *
n08   * slett eventuellt gamle poster
n08   *
n08  c                   exsr      delark
n08  c                   move      *blanks       wstex2
n08  c     mailkk        CHAIN     CUNDL01                            33
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     'Order:'      wstex2
n08  c                   else
n08  C                   movel     'Ordre:'      wstex2
n08  c                   end
n08  C     wstex2        CAT       aavd:1        wstex2
n08  C     wstex2        CAT       '/':0         wstex2
n08  C     wstex2        CAT       aopd:1        wstex2
n08  c*    mailkk        CHAIN     CUNDL01                            33
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C     wstex2        cat       'From:':1     wstex2
n08  c                   else
n08  C     wstex2        cat       'Fra:':1      wstex2
n08  c                   end
n08  C     wstex2        cat       FIFT:1        wstex2
n08  c                   move      uusr          epuser
n08  c                   movel     uhttpi        eplink
n08  c                   movel     uhttpe        epline
n08  C     CLIVE         IFEQ      'V'
n08  c                   eval      EPBANE = UBANE
n08  C                   END
n08   *
n08   * skjekk om mailbruker  er intern
n08   *
n08  C                   MOVE      'E'           inteks
n08  C     CEMAIL        CHAIN     ARUSERL1                           33
n08  C  N33arinek        ifeq      'I'
n08  C                   MOVE      'I'           inteks
n08  c                   end
n08  c                   moveL     wstex1        eptex1
n08  c                   move      wstex2        eptex2
n08  c                   write     arkepor
n08  C                   move      *blanks       wscvp1
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     'Workorder'   wscvp1
n08  C     wscvp1        cat       'from:':1     wscvp1
n08  c                   else
n08  C                   movel     'Arbeidsordre'wscvp1
n08  C     wscvp1        cat       'fra:':1      wscvp1
n08  c                   end
n08  C     wscvp1        cat       fift:1        wscvp1
n08  C     CLIVE         IFNE      'V'
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  C                   movel     trykkaee      wscvp2
n08  c                   else
n08  C                   movel     trykkaen      wscvp2
n08  c                   end
n08  C                   else
n08  C     spraak        ifeq      'E'
n08  c     spraak        oreq      'T'
n08  c                   movel     vedleggaee    wscvp2
n08  c                   else
n08  c                   movel     vedleggaen    wscvp2
n08  c                   end
n08  C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
n08  c                   end
n08  c                   end
n08   * eventuelt mail til seg selv
n08  c     tuknt         ifne      0
n08  c                   z-add     0             tuknt
n08  c     mailk         chain     cundc03                            33
n08  C     *IN33         IFEQ      '0'
n08  c     CEMAIL        ifeq      *blanks
n08  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
n08  C                   PARM                    UUSR
n08  C                   PARM                    DIRENA            8
n08  C                   PARM                    DIREAD            8
n08  C                   PARM                    INTADR           70
n08  C                   EVAL      CEMAIL=INTADR
n08  C                   END
n08  C                   GOTO      KU0KKAE
n08  C                   END
n08  C                   END
n08  c                   end
n08  c                   end
n08  c                   end
n08  C*
n08  C                   ENDSR
n08  C*
     C***********************************************
     C     PDFINV        BEGSR
     C***********************************************
N67  C     KEYOTY        KLIST
N67  C                   KFLD                    OTYKO             3
N67  C                   KFLD                    HEOT
N67  C                   MOVE      'O2Y'         OTYKO
N67  c     keyhea        chain     headf                              44
     C                   MOVEL     ARUNDE        AFAK              7
     C                   MOVEL     ARUNDE        fafakt
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       afak:0        arlink
     c                   move      'J'           fins1             1
     c                   move      'N'           fins2             1
     C*
     C     faktkk        KLIST
     C                   KFLD                    fifirm
     C                   KFLD                    fakunr
     C*
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
      *
      * Singel faktura til arkiv
      *
     C                   exsr      genbane
n30  C                   move      'A'           sinsam            1
     C                   CALL      'PDF006CL'
     C                   PARM                    AAVD
     C                   PARM                    AFAK
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    fins1
     c                   parm                    ubanes
     c                   parm                    fins2
     C                   PARM                    ARCINF
n30  c                   parm                    sinsam
      *
      * faktura må finnes
      *
     C     fins1         ifeq      'J'
      *
      * skal kunde ha mail
      *
s06  c*    fafakt        chain     fak9                               33
n06  c     fafakt        setll     fak9
n06  c                   setoff                                       66
n06  c     les9nb        tag
n06  c     fafakt        reade     fak9                                   66
n06  c     *in66         ifeq      '0'
n06  c     fakda         cabeq     'K'           les9nb
n06  c                   end
s25  c*    *in(33)       ifeq      '0'
n25  c     *in(66)       ifeq      '0'
     c                   z-add     fakunr        tuknt
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
S29  c*                  moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
n35  c     nestec        tag
     c     mailk         reade     cundc03                                44
n35  c     *in44         ifeq      '0'
n35  c                   exsr      testep
n35  c   33              goto      nestec
n35  c                   end
     c     *in(44)       ifeq      '0'
     C     KU0FAK        TAG
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     c                   move      *blanks       epbane
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Invoiceno:'  wstex2
n04  C     wstex2        CAT       afak:1        wstex2
n04  C     wstex2        CAT       'Invoiceda':1 wstex2
n04  C     wstex2        CAT       'te:':0       wstex2
n04  c                   else
     C                   movel     'Fakturanr:'  wstex2
     C     wstex2        CAT       afak:1        wstex2
     C     wstex2        CAT       'fakturada':1 wstex2
     C     wstex2        CAT       'to:':0       wstex2
n04  c                   end
     C     wstex2        CAT       fadg:1        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       famm:0        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       faaa:0        wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
N29  C  N33spraak        ifeq      'E'
N29  c     spraak        oreq      'T'
     C     wstex2        cat       'To:':1       wstex2
N29  C                   else
s29  C* N33wstex2        cat       'Til:':1      wstex2
N29  C     wstex2        cat       'Til:':1      wstex2
N29  C                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
s29  C*                  movel     'Faktura fra:'wscvp1
n29  C                   movel     'Invoice from'wscvp1
n29  C     wscvp1        CAT       ':':0         wscvp1
n04  c                   else
N67  c     KEYOTY        chain     KODTOT2                            33
N67  C     KO2NTX        ifeq      *blanks
     C                   movel     'Faktura fra:'wscvp1
N67  c                   else
N67  c                   eval      wscvp1=KO2NTX
N67  C     wscvp1        cat       'fra:':1      wscvp1
N67  c                   end
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
n61  C     wscvp1        cat       '#':1         wscvp1
n61  C     wscvp1        CAT       afak:0        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkfe       wscvp2
n04  c                   else
     C                   movel     trykkf        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggfe     wscvp2
n04  c                   else
     c                   movel     vedleggf      wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
N19  C                   CLEAR                   trackfr
N19  C                   eval      tttext='emailed invoice to:'
N19  C                   movel     CEMAIL        CEMA50           50
N19  C     tttext        cat       CEMA50:1      tttext
N19  C                   move      CCOMPN        tttext
N27  C                   eval      tttexl='Epost av faktura til:'
N27  C     tttexl        cat       CEMA50:1      tttexl
N27  C                   move      CCOMPN        tttexl
N19  c                   movel     'INV'         ttdepo
N19  C                   move      FAFAKT        ttdepo
N19  C                   EXSR      TTSR
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
n67  c                   exsr      testep
n67  c   33              goto      utpdfi
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0FAK
     C                   END
     C                   END
     c                   end
     c                   end
     c                   end
     c                   end
S67  C*                  ENDSR
N67  C     UTPDFI        ENDSR
     C***********************************************
     C     PDFFF         BEGSR
     C***********************************************
     C                   movel     arunde        afak              7
     C                   MOVEl     '0'           fffak             8
     C                   MOVE      afak          fffak
     C                   MOVEL     ARUNDE        fafakt
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     c                   move      aar           ffaar             2
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       afak:0        arlink
     C*
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
      *
      * Singel faktura til arkiv
      *
     C                   exsr      genbane
     C                   CALL      'PDF015CL'
     C                   PARM                    fffak
     C                   PARM                    AAVD
     C                   PARM                    ffaar
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     C                   PARM                    ARCINF
     C*
     c                   end
     C                   ENDSR
     C***********************************************
     C     PDFINVS       BEGSR
     C***********************************************
      *
      * samlefaktura
     c                   move      aravd         xxavd
     c                   move      'J'           fins1             1
     c                   move      'J'           fins2             1
     c                   Move      'A'           arSTAT
     C                   MOVEL     ARUNDE        fifn
     C                   MOVEL     ARUNDE        AFAK              7
     C                   MOVEL     ARUNDE        fafakt
     c                   move      'A'           arstat
      * skal arkivering skje
      *
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
     c                   setoff                                       35
     c     fifn          chain     fain                               33
     c     xxavd         ifeq      *zeros
     c                   move      fiavd         xxavd             4
     c                   end
      *****************************************************************************
      * genererer bane til spesifikasjon
      *****************************************************************************
     C                   MOVE      *zeros        ARAVD
     C                   MOVE      *zeros        AROPD
      *
      * ordner start av linken med forståelig info
      *
     c                   move      *blanks       arlink
     c                   movel     'fx'          arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       afak:0        arlink
      *
     c                   exsr      genbane
     c                   move      *blanks       ubanes           50
     c                   movel     ubane         ubanes
s16  c*                  move      *blanks       uhttpis          76
n16  c                   move      *blanks       uhttpis         152
     c                   movel     uhttpi        uhttpis
s16  c*                  move      *blanks       uhttpes          76
n16  c                   move      *blanks       uhttpes         152
     c                   movel     uhttpe        uhttpes
     c                   movel     arlink        arlinks          40
      *
      * genererer bane til selve fakturaen
      *
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   movel     'fs'          arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       afak:0        arlink
      *
     c                   exsr      genbane
     c                   movel     arlink        arlinkf          40
      *
n30  C                   move      'C'           sinsam            1
     C                   CALL      'PDF006CL'
     C                   PARM                    XXavd
     C                   PARM                    AFAK
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    fins1
     c                   parm                    ubanes
     c                   parm                    fins2
     C                   PARM                    ARCINF
N30  C                   PARM                    SINSAM
     C*
      *
      * skriver 1 record pr oppdrag ved samlefaktura
      *
     c     fifn          setll     fain
     c     *in35         doweq     '0'
     c     fifn          reade     fain                                   35
     c     *in35         ifeq      '0'
N49  C     FAK8K2        KLIST
N49  C                   KFLD                    FIAVD
N49  C                   KFLD                    FIOPD
N49  C                   KFLD                    FIFN
N49  C     FAK8K2        CHAIN     FAK8                               33
Nsh  C     FAKDA         IFNE      'K'
Nsh  C     *IN33         OREQ      '1'
     C                   MOVE      FIAVD         ARAVD
     C                   MOVE      FIOPD         AROPD
      * faktura fins
     c     fins1         ifeq      'J'
     c                   move      'fs'          ARTYPE
     c                   movel     arlinkf       arlink
     c                   write     arkivr
     c                   end
      * egen record hvis spesifikasjon
      * ved spesifikasjon skrives record
     c     fins2         ifeq      'J'
     c                   move      'fx'          ARTYPE
     c                   movel     arlinks       arlink
     c                   write     arkivr
     c                   move      'fs'          ARTYPE
     c                   end
N49  c                   end
     c                   end
     c                   end
      *
      * skal kunde ha mail av samlefaktura
      *
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
      *
      * SKAL skal ha en mail
      *
     c     fafakt        ifne      gmfakt
     c                   z-add     fafakt        gmfakt            7 0
s06  c*    fafakt        chain     fak9                               33
n06  c     fafakt        setll     fak9
n06  c                   setoff                                       66
n06  c     les9nc        tag
n06  c     fafakt        reade     fak9                                   66
n06  c     *in66         ifeq      '0'
n06  c     fakda         cabeq     'K'           les9nc
n06  c                   end
s25  c*    *in(33)       ifeq      '0'
n25  c     *in(66)       ifeq      '0'
     c                   z-add     fakunr        tuknt
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
s29  c*                  moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
n35  c     nestecs       tag
     c     mailk         reade     cundc03                                44
n35  c     *in44         ifeq      '0'
n35  c                   exsr      testep
n35  c   33              goto      nestecs
n35  c                   end
     c     *in(44)       ifeq      '0'
     c     ku0faks       tag
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     c                   move      *blanks       epbane
     c* slett eventuellt gamle poster
     c                   exsr      delark
     c                   move      *blanks       wstex2
N34  c                   move      *blanks       wstex1
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
     C                   movel     'Invoiceno:'  wstex2
     C     wstex2        CAT       afak:1        wstex2
     C     wstex2        CAT       'Invoiceda':1 wstex2
     C     wstex2        CAT       'te:':0       wstex2
n04  c                   else
     C                   movel     'Fakturanr:'  wstex2
     C     wstex2        CAT       afak:1        wstex2
     C     wstex2        CAT       'fakturada':1 wstex2
     C     wstex2        CAT       'to:':0       wstex2
n04  c                   end
     C     wstex2        CAT       fadg:1        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       famm:0        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       faaa:0        wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     C                   MOVE      *BLANKS       EPBANE
     c     fins1         ifeq      'J'
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      * skjekk om mailbruker  er intern
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   movel     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     c                   end
      *
      *spesifikasjon
      *
     c     fins2         ifeq      'J'
      *
      * skjekk om mailbruker  er intern
      *
     c                   movel     uhttpis       eplink
     c                   movel     uhttpes       epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANES
     C                   END
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c     fins1         ifeq      'J'
     c                   move      *blanks       wstex1           30
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   moveL     'Spesificatio'wste13           13
n04  c                   move      'n'           wste13
n04  c                   else
     c                   moveL     'Spesifikasjo'wste13           13
     c                   move      'n'           wste13
n04  c                   end
     c                   moveL     wste13        wstex1           30
     c                   end
     c                   movel     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     c                   end
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Invoice from'wscvp1
n04  C     wscvp1        cat       ':':0         wscvp1
n04  c                   else
     C                   movel     'Faktura fra:'wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
n61  C     wscvp1        cat       '#':1         wscvp1
n61  C     wscvp1        CAT       afak:0        wscvp1
     C                   move      *blanks       wscvp2
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkfe       wscvp2
n04  c                   else
     C                   movel     trykkf        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggfe     wscvp2
n04  c                   else
     c                   movel     vedleggf      wscvp2
n04  c                   end
     C                   end
      *
      * vedlegg FRA alle oppdrag
      *
s18  C*    ARKVED        IFNE      *BLANKS
     c                   setoff                                       35
     c     fifn          setll     fain
     c     *in35         doweq     '0'
     c     fifn          reade     fain                                   35
     c     *in35         ifeq      '0'
     C                   MOVE      FIAVD         Aavd
     C                   MOVE      FIOPD         aopd
N53  C                   CALL      'ARC002V'
N53  C                   PARM                    ARTYPE
N53  C                   PARM                    Aavd
N53  C                   PARM                    Aopd
N53  C                   PARM                    ARKVED
N53  C                   PARM                    CLIVE
N53  C                   PARM                    arinek
N53  C                   PARM                    tuknt
     C                   END
     C                   END
N53  C                   move      'N'           k002v             1
N43  C                   EXSR      EPOSTSR
N19  C                   CLEAR                   trackfr
N19  C                   eval      tttext='emailed invoice to:'
N19  C                   movel     CEMAIL        CEMA50           50
N19  C     tttext        cat       CEMA50:1      tttext
N19  C                   move      CCOMPN        tttext
N27  C                   eval      tttexl='Epost av faktura til:'
N27  C     tttexl        cat       CEMA50:1      tttexl
N27  C                   move      CCOMPN        tttexl
N19  c                   movel     'INV'         ttdepo
N19  C                   move      FAFAKT        ttdepo
S33  C*                  EXSR      TTSR
N33  C                   EXSR      TTSRSA
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0FAKS
     C                   END
     C                   END
     c                   end
     c                   end
     c                   end
     c                   end
     c                   end
     C                   ENDSR
     C*
N65  C***********************************************
N65  C     PDFAME        BEGSR
N65  C***********************************************
N65   *
N65   * Ametaavregning
N65  c                   move      aravd         xxavd
N65  c                   Move      'A'           arSTAT
N65  C                   MOVEL     ARUNDE        fifn
N65  C                   MOVEL     ARUNDE        AFAK              7
N65  C                   MOVEL     ARUNDE        fafakt
N65  c                   move      'A'           arstat
N65   *
N65  C     keyam         klist
N65  c                   kfld                    fiavd
N65  c                   kfld                    fiopd
N65   *
N65  c     fifn          chain     fain                               33
N65  C     keyam         chain     headf                              33
N65   * skal arkivering skje
N65   *
N65  c     artype        chain     ARKTXT                             33
N65  c                   setoff                                       35
N65  c     xxavd         ifeq      *zeros
N65  c                   move      fiavd         xxavd             4
N65  c                   end
N65   *****************************************************************************
N65   * genererer bane til fakturabilag
N65   *****************************************************************************
N65  C                   MOVE      *zeros        ARAVD
N65  C                   MOVE      *zeros        AROPD
N65   *
N65   * ordner start av linken med forståelig info
N65   *
N65  c                   move      *blanks       arlink
N65  c                   movel     'ab'          arlink
N65  C     arlink        CAT       aar:0         arlink
N65  C     arlink        CAT       afak:0        arlink
N65   *
N65  c                   exsr      genbane
N65  c                   move      *blanks       ubanes           50
N65  c                   movel     ubane         ubanes
N65  c                   move      *blanks       uhttpis         152
N65  c                   movel     uhttpi        uhttpis
N65  c                   move      *blanks       uhttpes         152
N65  c                   movel     uhttpe        uhttpes
N65  c                   movel     arlink        arlinks          40
N65   *
N65   * genererer bane til selve fakturaen
N65   *
N65  c* ordner start av linken med forståelig info
N65  c*
N65  c                   move      *blanks       arlink
N65  c                   movel     'aa'          arlink
N65  C     arlink        CAT       aar:0         arlink
N65  C     arlink        CAT       afak:0        arlink
N65   *
N65  c                   exsr      genbane
N65  c                   movel     arlink        arlinkf          40
N65   *
N65  C                   CALL      'PDF033CL'
N65  C                   PARM                    hepro
N65  C                   PARM                    arkund
N65  C                   PARM                    uhttpi
N65  C                   PARM                    ubane
N65  c                   parm                    ubanes
N65  C                   PARM                    ARCINF
N65  C                   PARM                    XXAVD
N65  C                   PARM                    AFAK
N65  C*
N65   *
N65   * skriver 1 record pr oppdrag ved samlefaktura
N65   *
N65  c     fifn          setll     fain
N65  c     *in35         doweq     '0'
N65  c     fifn          reade     fain                                   35
N65  c     *in35         ifeq      '0'
N65  C     FAK8K2        CHAIN     FAK8                               33
N65  C     FAKDA         IFNE      'K'
N65  C     *IN33         OREQ      '1'
N65  C                   MOVE      FIAVD         ARAVD
N65  C                   MOVE      FIOPD         AROPD
N65   * AMETAARKET aa
N65  c                   move      'aa'          ARTYPE
N65  c                   movel     arlinkf       arlink
N65  c                   write     arkivr
N65   * FAKTURA ab                   n
N65  c                   move      'ab'          ARTYPE
N65  c                   movel     arlinks       arlink
N65  c                   write     arkivr
N65  c                   move      'aa'          ARTYPE
N65  c                   end
N65  c                   end
N65  c                   end
N65   *
N65   * skal kunde ha mail av samlefaktura
N65   *
N65  c     artype        chain     ARKTXT                             33
N65  C  N33ARKJN         IFEQ      'J'
N65   *
N65   * SKAL skal ha en mail
N65   *
N65  c     fafakt        ifne      gmfakt
N65  c                   z-add     fafakt        gmfakt            7 0
N65  c     fafakt        setll     fak9
N65  c                   setoff                                       66
N65  c     les9ncA       tag
N65  c     fafakt        reade     fak9                                   66
N65  c     *in66         ifeq      '0'
N65  c     fakda         cabeq     'K'           les9ncA
N65  c                   end
N65  c     *in(66)       ifeq      '0'
N65  c                   z-add     fakunr        tuknt
N65  C     ARKSND        IFEQ      'J'
N65  C                   MOVE      ARTXT         MAIL16           16
N65  C                   MOVEL     '*'           MAIL16
N65  c                   movel     MAIL16        mail30           30
N65  c                   setoff                                       44
N65  c     mailk         setll     cundc03
N65  c     *in(44)       doweq     '0'
N65  c     nestecsA      tag
N65  c     mailk         reade     cundc03                                44
N65  c     *in44         ifeq      '0'
N65  c                   exsr      testep
N65  c   33              goto      nestecsA
N65  c                   end
N65  c     *in(44)       ifeq      '0'
N65  c     ku0faksA      tag
N65  c                   move      *blanks       eplink
N65  c                   move      *blanks       epline
N65  c                   move      *blanks       epbane
N65  c* slett eventuellt gamle poster
N65  c                   exsr      delark
N65  c                   move      *blanks       wstex2
N65  c                   move      *blanks       wstex1
N65  c     mailkk        CHAIN     CUNDL01                            33
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  C                   movel     'Invoiceno:'  wstex2
N65  C     wstex2        CAT       afak:1        wstex2
N65  C     wstex2        CAT       'Invoiceda':1 wstex2
N65  C     wstex2        CAT       'te:':0       wstex2
N65  c                   else
N65  C                   movel     'Fakturanr:'  wstex2
N65  C     wstex2        CAT       afak:1        wstex2
N65  C     wstex2        CAT       'fakturada':1 wstex2
N65  C     wstex2        CAT       'to:':0       wstex2
N65  c                   end
N65  C     wstex2        CAT       fadg:1        wstex2
N65  C     wstex2        CAT       '.':0         wstex2
N65  C     wstex2        CAT       famm:0        wstex2
N65  C     wstex2        CAT       '.':0         wstex2
N65  C     wstex2        CAT       faaa:0        wstex2
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  C  N33wstex2        cat       'To:':1       wstex2
N65  c                   else
N65  C  N33wstex2        cat       'Til:':1      wstex2
N65  c                   end
N65  C  N33wstex2        cat       knavn:1       wstex2
N65  c                   move      uusr          epuser
N65  c                   move      *blanks       eplink
N65  c                   move      *blanks       epline
N65  C                   MOVE      *BLANKS       EPBANE
N65  c     fins1         ifeq      'J'
N65  c                   movel     uhttpi        eplink
N65  c                   movel     uhttpe        epline
N65  C     CLIVE         IFEQ      'V'
N65  c                   eval      EPBANE = UBANE
N65  C                   END
N65   * skjekk om mailbruker  er intern
N65  C                   MOVE      'E'           inteks
N65  C     CEMAIL        CHAIN     ARUSERL1                           33
N65  C  N33arinek        ifeq      'I'
N65  C                   MOVE      'I'           inteks
N65  c                   end
N65  c                   movel     wstex1        eptex1
N65  c                   move      wstex2        eptex2
N65  c                   write     arkepor
N65  c                   end
N65   *
N65   *spesifikasjon
N65   *
N65  c     fins2         ifeq      'J'
N65   *
N65   * skjekk om mailbruker  er intern
N65   *
N65  c                   movel     uhttpis       eplink
N65  c                   movel     uhttpes       epline
N65  C     CLIVE         IFEQ      'V'
N65  c                   eval      EPBANE = UBANES
N65  C                   END
N65  C                   MOVE      'E'           inteks
N65  C     CEMAIL        CHAIN     ARUSERL1                           33
N65  C  N33arinek        ifeq      'I'
N65  C                   MOVE      'I'           inteks
N65  c                   end
N65  c     fins1         ifeq      'J'
N65  c                   move      *blanks       wstex1           30
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  c                   moveL     'Spesificatio'wste13           13
N65  c                   move      'n'           wste13
N65  c                   else
N65  c                   moveL     'Spesifikasjo'wste13           13
N65  c                   move      'n'           wste13
N65  c                   end
N65  c                   moveL     wste13        wstex1           30
N65  c                   end
N65  c                   movel     wstex1        eptex1
N65  c                   move      wstex2        eptex2
N65  c                   write     arkepor
N65  c                   end
N65  C                   move      *blanks       wscvp1
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  C                   movel     'Invoice from'wscvp1
N65  C     wscvp1        cat       ':':0         wscvp1
N65  c                   else
N65  C                   movel     'Faktura fra:'wscvp1
N65  c                   end
N65  C     wscvp1        cat       fift:1        wscvp1
N65  C     wscvp1        cat       '#':1         wscvp1
N65  C     wscvp1        CAT       afak:0        wscvp1
N65  C                   move      *blanks       wscvp2
N65  C     CLIVE         IFNE      'V'
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  C                   movel     trykkfe       wscvp2
N65  c                   else
N65  C                   movel     trykkf        wscvp2
N65  c                   end
N65  C                   else
N65  C     spraak        ifeq      'E'
N65  c     spraak        oreq      'T'
N65  c                   movel     vedleggfe     wscvp2
N65  c                   else
N65  c                   movel     vedleggf      wscvp2
N65  c                   end
N65  C                   end
N65   *
N65   * vedlegg FRA alle oppdrag
N65   *
N65  C*    ARKVED        IFNE      *BLANKS
N65  c                   setoff                                       35
N65  c     fifn          setll     fain
N65  c     *in35         doweq     '0'
N65  c     fifn          reade     fain                                   35
N65  c     *in35         ifeq      '0'
N65  C                   MOVE      FIAVD         Aavd
N65  C                   MOVE      FIOPD         aopd
N65  C                   CALL      'ARC002V'
N65  C                   PARM                    ARTYPE
N65  C                   PARM                    Aavd
N65  C                   PARM                    Aopd
N65  C                   PARM                    ARKVED
N65  C                   PARM                    CLIVE
N65  C                   PARM                    arinek
N65  C                   PARM                    tuknt
N65  C                   END
N65  C                   END
N65  C                   move      'N'           k002v             1
N65  C                   EXSR      EPOSTSR
N65  C                   CLEAR                   trackfr
N65  C                   eval      tttext='emailed invoice to:'
N65  C                   movel     CEMAIL        CEMA50           50
N65  C     tttext        cat       CEMA50:1      tttext
N65  C                   move      CCOMPN        tttext
N65  C                   eval      tttexl='Epost av faktura til:'
N65  C     tttexl        cat       CEMA50:1      tttexl
N65  C                   move      CCOMPN        tttexl
N65  c                   movel     'INV'         ttdepo
N65  C                   move      FAFAKT        ttdepo
N65  C*                  EXSR      TTSR
N65  C                   EXSR      TTSRSA
N65  c                   end
N65  c                   end
N65   *
N65   * eventuelt mail til seg selv   skjekk dette
N65   * gjøres kun 1 gang når kunde er ulik 0
N65   *
N65  c     tuknt         ifne      0
N65  c                   z-add     0             tuknt
N65  c     mailk         chain     cundc03                            33
N65  C     *IN33         IFEQ      '0'
N65  c     CEMAIL        ifeq      *blanks
N65  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N65  C                   PARM                    UUSR
N65  C                   PARM                    DIRENA            8
N65  C                   PARM                    DIREAD            8
N65  C                   PARM                    INTADR           70
N65  C                   EVAL      CEMAIL=INTADR
N65  C                   END
N65  C                   GOTO      KU0FAKSA
N65  C                   END
N65  C                   END
N65  c                   end
N65  c                   end
N65  c                   end
N65  c                   end
N65  C                   ENDSR
     C*
     C***********************************************
     C     PDFLM         BEGSR
     C***********************************************
      * lager mottaksrapport
      *
     c* ordner start av linken med forståelig info
     c*
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     c                   z-add     arkund        fakunr
     c                   z-add     arkund        tuknt
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       arunde:0      arlink
     C*
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
      *
      * Mottaksrapport til arkiv
      *
     C                   exsr      genbane
      *
     C                   MOVE      'J'           ukopi
     c                   movel     arunde        umrnr
     c                   move      arkund        upnr
     c                   move      'E'           uopt
     c                   move      *zeros        ukjed
     c                   move      uparm2        uuparm           64
     C                   CALL      'PDF014CL'
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     C                   PARM                    ARCINF
     C                   PARM                    UPARM2
     C*
      *
      * skal kunde ha mail
      *
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     c     ku0lm         tag
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     c                   move      *blanks       epbane
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C                   movel     'Reportno:'   wstex2
N04  C                   else
     C                   movel     'Rapportnr:'  wstex2
n04  c                   end
     C     wstex2        CAT       arunde:1      wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     vedlegglm2e   wscvp1
n04  c                   else
     C                   movel     vedlegglm2    wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykklme      wscvp2
n04  c                   else
     C                   movel     trykklm       wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedlegglme    wscvp2
n04  c                   else
     c                   movel     vedlegglm     wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   end
     c                   end
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0LM
     C                   END
     C                   END
     c                   end
     c                   end
     C                   ENDSR
N37   ***********************************************
N37  C     PDFPS         BEGSR
N37  C***********************************************
N37   * Logistikk pakkseddel
N37   *
N37   * ordner start av linken med forståelig info
N37   *
N37  c                   move      *blanks       arlink
N37  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
N37  c                   z-add     arkund        fakunr
N37  c                   z-add     arkund        tuknt
N37  C     arlink        CAT       aar:0         arlink
N37  C     arlink        CAT       arunde:0      arlink
N37   *
N37  c     artype        chain     ARKTXT                             33
N37  C  N33ARKJN         IFEQ      'J'
N37   *
N37   * Pakkseddel til arkiv
N37   *
N37  C                   exsr      genbane
N37   *
N37  C                   MOVE      'J'           ukopi
N37  c                   movel     arunde        upsdl
N37  c                   move      arkund        upnr
N37  c                   move      'E'           uopt
N37  c                   move      *zeros        ukjed
N37  c                   move      uparm2        uuparm           64
N37  C                   CALL      'PDF014CL'
N37  C                   PARM                    uhttpi
N37  C                   PARM                    ubane
N37  C                   PARM                    ARCINF
N37  C                   PARM                    UPARM2
N37   *
N37   * skal kunde ha mail
N37   *
N37  C     ARKSND        IFEQ      'J'
N37  C                   MOVE      ARTXT         MAIL16           16
N37  C                   MOVEL     '*'           MAIL16
N37  c                   movel     MAIL16        mail30           30
N37  c                   moveL     artxt         wstex1           30
N37  c                   setoff                                       44
N37  c     mailk         setll     cundc03
N37  c     *in(44)       doweq     '0'
N37  c     mailk         reade     cundc03                                44
N37  c     *in(44)       ifeq      '0'
N37  c     KU0PS         tag
N37  c                   move      *blanks       eplink
N37  c                   move      *blanks       epline
N37  c                   move      *blanks       epbane
N37   *
N37   * slett eventuellt gamle poster
N37   *
N37  c                   exsr      delark
N37  c                   move      *blanks       wstex2
N37  c     mailkk        CHAIN     CUNDL01                            33
N37  C     spraak        ifeq      'E'
N37  c     spraak        oreq      'T'
N37  C                   movel     'Reportno:'   wstex2
N37  C                   else
N37  C                   movel     'Rapportnr:'  wstex2
N37  c                   end
N37  C     wstex2        CAT       arunde:1      wstex2
N37  C     spraak        ifeq      'E'
N37  c     spraak        oreq      'T'
N37  C  N33wstex2        cat       'To:':1       wstex2
N37  c                   else
N37  C  N33wstex2        cat       'Til:':1      wstex2
N37  c                   end
N37  C  N33wstex2        cat       knavn:1       wstex2
N37  c                   move      uusr          epuser
N37  c                   movel     uhttpi        eplink
N37  c                   movel     uhttpe        epline
N37  C     CLIVE         IFEQ      'V'
N37  c                   eval      EPBANE = UBANE
N37  C                   END
N37   *
N37   * skjekk om mailbruker  er intern
N37   *
N37  C                   MOVE      'E'           inteks
N37  C     CEMAIL        CHAIN     ARUSERL1                           33
N37  C  N33arinek        ifeq      'I'
N37  C                   MOVE      'I'           inteks
N37  c                   end
N37  c                   moveL     wstex1        eptex1
N37  c                   move      wstex2        eptex2
N37  c                   write     arkepor
N37  C                   move      *blanks       wscvp1
N37  C     spraak        ifeq      'E'
N37  c     spraak        oreq      'T'
N37  C                   movel     vedlegglm2e   wscvp1
N37  c                   else
N37  C                   movel     vedlegglm2    wscvp1
N37  c                   end
N37  C     wscvp1        cat       fift:1        wscvp1
N37  C     CLIVE         IFNE      'V'
N37  C     spraak        ifeq      'E'
N37  c     spraak        oreq      'T'
N37  C                   movel     trykklme      wscvp2
N37  c                   else
N37  C                   movel     trykklm       wscvp2
N37  c                   end
N37  C                   else
N37  C     spraak        ifeq      'E'
N37  c     spraak        oreq      'T'
N37  c                   movel     vedlegglme    wscvp2
N37  c                   else
N37  c                   movel     vedlegglm     wscvp2
N37  c                   end
N37  C                   end
N43  C                   EXSR      EPOSTSR
N37  c                   end
N37  c                   end
N37  c     tuknt         ifne      0
N37  c                   z-add     0             tuknt
N37  c     mailk         chain     cundc03                            33
N37  C     *IN33         IFEQ      '0'
N37  c     CEMAIL        ifeq      *blanks
N37  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N37  C                   PARM                    UUSR
N37  C                   PARM                    DIRENA            8
N37  C                   PARM                    DIREAD            8
N37  C                   PARM                    INTADR           70
N37  C                   EVAL      CEMAIL=INTADR
N37  C                   END
N37  C                   GOTO      KU0PS
N37  C                   END
N37  C                   END
N37  c                   end
N37  c                   end
N37   *
N37  C                   ENDSR
N37   *
     C***********************************************
     C     PDFGODS       BEGSR
     C***********************************************
      * Godsliste
      *
      *
      * SKAL GODSLISTE ARKIVERES
      *
      * sjekker om fraktbrevene skal lagres/sendes
N05  c                   move      'N'           gfjn              1
N05  c                   move      'N'           gfsnd             1
N05  c                   move      'gf'          artype
N07  c                   move      arkund        gokund            8 0
N05  c     artype        chain     arktxt                             33
N05  C  N33              move      arkjn         gfjn
N05  C  N33              move      arksnd        gfsnd
N05  c                   move      'go'          artype
      *
     C                   MOVEL     ARUNDE        TUPRO             8 0
     C                   MOVE      *BLANKS       ATUR10A          10
     C                   MOVE      *BLANKS       ATUR10T          10
     c     artype        chain     ARKTXT                             33
      *
     C  N33ARKJN         IFEQ      'J'
      *
     c                   move      'N'           vise              1
     c                   move      'T'           abeljn            1
     c                   move      'N'           adrjn             1
     c                   move      '1'           uin03             1
     c     tupro         chain     turer14                            13
     c                   Movel     'GODSLIST'    PRTNA            10
     C                   MOVE      tuavd         xxavd             4
     C                   MOVEL     ARUNDE        Atur              8
     C                   MOVEL     ARUNDE        Atur9             9
     C                   MOVEL     ATUR9         ATUR10T          10
     C     ATUR10T       CAT       'T':0         ATUR10T
     C                   MOVEL     ATUR9         ATUR10A          10
     C     ATUR10A       CAT       'A':0         ATUR10A
      *
      * ordner start av linken med forståelig info
      * først eventuellt mot transportør
      *
     c                   exsr      gengods
     c                   move      *blanks       arlinktra
     c                   movel     arlink        arlinktra        40
     c                   move      ubane         ubanegotr        50
     c
      *
      *
      * skriver 1 record pr opppdrag
      * Finn samtidig ut om det er agent(er) turen
      * og om fraktbrev finnes
      *
     c                   exsr      skrivtur
      *
      * tester om agenter finnes på godslista
      * lager i så fall pdf
      *
     c     ag(1)         ifne      *zeros
     c                   move      'A'           abeljn            1
     c                   exsr      gengods
     c                   move      *blanks       arlinkage
     c                   movel     arlink        arlinkage        40
     c                   move      ubane         ubanegoag        50
     c                   end
      *
      *
      *
      * produserer samleliste  fraktbrev PDF hvis finnes
      *
     c     fbfins        ifeq      'J'
n23  c*    gfjn          andeq     'j'
n23  c     gfjn          andeq     'J'
     c                   exsr      genfbpdf
     c                   end
      *
      * skal Transportør ha mail
      *
     c     mailk         klist
     c                   kfld                    fifirm
     c                   kfld                    mail30
     c                   kfld                    tuknt
     c     mailkk        klist
     c                   kfld                    fifirm
     c                   kfld                    tuknt
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
      *
      * godsliste til transportør
      *
s07  c*                  z-add     arkund        tuknt
n07  c                   z-add     gokund        tuknt
     c                   move      'T'           gotype            1
     c                   exsr      godsmail
      *
      * Mail til agent?
      *
     c     1             do        99            nr                2 0
     c     ag(nr)        ifne      *zeros
N07  c     ag(nr)        andne     gokund
     c                   move      'A'           gotype            1
     c                   z-add     ag(nr)        tuknt
     c                   exsr      skrivtur2
     c                   exsr      godsmail
     c                   else
     c                   goto      utag
     c                   end
     c                   end
     c     utag          tag
      *
      *
     c                   end
     c                   end
     c*
     C                   ENDSR
N11  C***********************************************
N11  C     PDFLAST       BEGSR
N11  C***********************************************
N11   * Lasteliste
N11  c     artype        chain     ARKTXT                             33
N11  c                   move      *blanks       arlink
N11  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
N11  C                   MOVEL     ARUNDE        TUPRO             8 0
N11  c     tupro         chain     turer14                            33
N11  c     *in33         ifeq      '0'
N11  c                   movel     tupro         atur
N11  c                   movel     tuavd         aavd
N11  C     arlink        CAT       aar:0         arlink
N11  C     arlink        CAT       arunde:0      arlink
N11  c                   exsr      genbane
N11  C                   CALL      'PDF028CL'
N11  C                   PARM                    AAVD
N11  C                   PARM                    ATUR
N11  C                   PARM                    uhttpi
N11  C                   PARM                    ubane
N11  c                   parm                    vise
N11  c                   parm                    arcinf
N11   * sprer utover enkeltoppdragene
N11  c                   setoff                                       35
N11   *
N11  c     tupro         setll     head14
N11  c     *in35         doweq     '0'
N11  c     tupro         reade     head14                                 35
N11  c     *in35         ifeq      '0'
N11  C                   MOVE      heAVD         ARAVD
N11  C                   MOVE      heOPD         AROPD
N11  c                   move      'A'           arstat
N11  c                   write     arkivr
N11  c                   end
N11  c                   end
N11   *
N11   * skal kunde ha mail
N11   *
N11  c                   z-add     arkund        tuknt
N11  C     ARKSND        IFEQ      'J'
N11  C                   MOVE      ARTXT         MAIL16           16
N11  C                   MOVEL     '*'           MAIL16
N11  c                   movel     MAIL16        mail30           30
N11  c                   moveL     artxt         wstex1           30
N11  c                   setoff                                       44
     c     tuknt         cabeq     0             testlameg
N11  c     mailk         setll     cundc03
N11  c     *in(44)       doweq     '0'
N11  c     mailk         reade     cundc03                                44
N11  c     *in(44)       ifeq      '0'
N11  C     KU0LA         TAG
N11  c                   move      *blanks       eplink
N11  c                   move      *blanks       epline
N11  c                   move      *blanks       epbane
N11   *
N11   * slett eventuellt gamle poster
N11   *
N11  c                   exsr      delark
N11  c                   move      *blanks       wstex2
N11  c     mailkk        CHAIN     CUNDL01                            33
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C                   movel     'Trip:'       wstex2
N11  c                   else
N11  C                   movel     'Tur:'        wstex2
N11  c                   end
N11  C     wstex2        CAT       atur:1        wstex2
N11  c*    mailkk        CHAIN     CUNDL01                            33
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C     wstex2        cat       'From:':1     wstex2
N11  c                   else
N11  C     wstex2        cat       'Fra:':1      wstex2
N11  c                   end
N11  C     wstex2        cat       FIFT:1        wstex2
N11  c                   move      uusr          epuser
N11  c                   movel     uhttpi        eplink
N11  c                   movel     uhttpe        epline
N11  C     CLIVE         IFEQ      'V'
N11  c                   eval      EPBANE = UBANE
N11  C                   END
N11   *
N11   * skjekk om mailbruker  er intern
N11   *
N11  C                   MOVE      'E'           inteks
N11  C     CEMAIL        CHAIN     ARUSERL1                           33
N11  C  N33arinek        ifeq      'I'
N11  C                   MOVE      'I'           inteks
N11  c                   end
N11  c                   moveL     wstex1        eptex1
N11  c                   move      wstex2        eptex2
N11  c                   write     arkepor
N11  C                   move      *blanks       wscvp1
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C                   movel     'Loadinglist' wscvp1
N11  C     wscvp1        cat       'from:':1     wscvp1
N11  c                   else
N11  C                   movel     'Lasteliste'  wscvp1
N11  C     wscvp1        cat       'fra:':1      wscvp1
N11  c                   end
N11  C     wscvp1        cat       fift:1        wscvp1
N11  C     CLIVE         IFNE      'V'
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C                   movel     trykklae      wscvp2
N11  c                   else
N11  C                   movel     trykkla       wscvp2
N11  c                   end
N11  C                   else
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  c                   movel     vedlegglae    wscvp2
N11  c                   else
N11  c                   movel     vedleggla     wscvp2
N11  c                   end
N11  C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
N11  c                   end
N11  c                   end
N11   * eventuelt mail til seg selv
N11  c     tuknt         ifne      0
N11  c                   z-add     0             tuknt
     c     testlameg     tag
N11  c     mailk         chain     cundc03                            33
N11  C     *IN33         IFEQ      '0'
N11  c     CEMAIL        ifeq      *blanks
N11  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N11  C                   PARM                    UUSR
N11  C                   PARM                    DIRENA            8
N11  C                   PARM                    DIREAD            8
N11  C                   PARM                    INTADR           70
N11  C                   EVAL      CEMAIL=INTADR
N11  C                   END
N11  C                   GOTO      KU0LA
N11  C                   END
N11  C                   END
N11  c                   end
N11  c                   end
N11  C                   ENDSR
N11  C***********************************************
N11  C     PDFLOSS       BEGSR
N11  C***********************************************
N11   * Losseliste
N11  c     artype        chain     ARKTXT                             33
N11  c                   move      *blanks       arlink
N11  c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
N11  C                   MOVEL     ARUNDE        TUPRO             8 0
N11  c                   movel     hepro         atur
N11  c                   movel     heavd         aavd
N11  C     arlink        CAT       aar:0         arlink
N11  C     arlink        CAT       arunde:0      arlink
N11  c                   exsr      genbane
N11  C                   CALL      'PDF029CL'
N11  C                   PARM                    AAVD
N11  C                   PARM                    ATUR
N11  C                   PARM                    uhttpi
N11  C                   PARM                    ubane
N11  c                   parm                    vise
N11  c                   parm                    arcinf
N11   * sprer utover enkeltoppdragene
N11  c                   setoff                                       35
N11   *
N11  c     hepro         setll     head14
N11  c     *in35         doweq     '0'
N11  c     hepro         reade     head14                                 35
N11  c     *in35         ifeq      '0'
N11  C                   MOVE      heAVD         ARAVD
N11  C                   MOVE      heOPD         AROPD
N11  c                   move      'A'           arstat
N11  c                   write     arkivr
N11  c                   end
N11  c                   end
N11   *
N11   * skal kunde ha mail
N11   *
N11  c                   z-add     arkund        tuknt
N11  C     ARKSND        IFEQ      'J'
N11  C                   MOVE      ARTXT         MAIL16           16
N11  C                   MOVEL     '*'           MAIL16
N11  c                   movel     MAIL16        mail30           30
N11  c                   moveL     artxt         wstex1           30
N11  c                   setoff                                       44
N11  c     tuknt         cabeq     0             testlomeg
N11  c     mailk         setll     cundc03
N11  c     *in(44)       doweq     '0'
N11  c     mailk         reade     cundc03                                44
N11  c     *in(44)       ifeq      '0'
N11  C     KU0LO         TAG
N11  c                   move      *blanks       eplink
N11  c                   move      *blanks       epline
N11  c                   move      *blanks       epbane
N11   *
N11   * slett eventuellt gamle poster
N11   *
N11  c                   exsr      delark
N11  c                   move      *blanks       wstex2
N11  c     mailkk        CHAIN     CUNDL01                            33
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C                   movel     'Trip:'       wstex2
N11  c                   else
N11  C                   movel     'Tur:'        wstex2
N11  c                   end
N11  C     wstex2        CAT       atur:1        wstex2
N11  c*    mailkk        CHAIN     CUNDL01                            33
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C     wstex2        cat       'From:':1     wstex2
N11  c                   else
N11  C     wstex2        cat       'Fra:':1      wstex2
N11  c                   end
N11  C     wstex2        cat       FIFT:1        wstex2
N11  c                   move      uusr          epuser
N11  c                   movel     uhttpi        eplink
N11  c                   movel     uhttpe        epline
N11  C     CLIVE         IFEQ      'V'
N11  c                   eval      EPBANE = UBANE
N11  C                   END
N11   *
N11   * skjekk om mailbruker  er intern
N11   *
N11  C                   MOVE      'E'           inteks
N11  C     CEMAIL        CHAIN     ARUSERL1                           33
N11  C  N33arinek        ifeq      'I'
N11  C                   MOVE      'I'           inteks
N11  c                   end
N11  c                   moveL     wstex1        eptex1
N11  c                   move      wstex2        eptex2
N11  c                   write     arkepor
N11  C                   move      *blanks       wscvp1
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  c                   eval      wscvp1='Unloadinglist'
N11  C     wscvp1        cat       'from:':1     wscvp1
N11  c                   else
N11  C                   movel     'Losseliste'  wscvp1
N11  C     wscvp1        cat       'fra:':1      wscvp1
N11  c                   end
N11  C     wscvp1        cat       fift:1        wscvp1
N11  C     CLIVE         IFNE      'V'
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  C                   movel     trykkloe      wscvp2
N11  c                   else
N11  C                   movel     trykklo       wscvp2
N11  c                   end
N11  C                   else
N11  C     spraak        ifeq      'E'
N11  c     spraak        oreq      'T'
N11  c                   movel     vedleggloe    wscvp2
N11  c                   else
N11  c                   movel     vedlegglo     wscvp2
N11  c                   end
N11  C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
N11  c                   end
N11  c                   end
N11   * eventuelt mail til seg selv
N11  c     tuknt         ifne      0
     c     testlomeg     tag
N11  c                   z-add     0             tuknt
N11  c     mailk         chain     cundc03                            33
N11  C     *IN33         IFEQ      '0'
N11  c     CEMAIL        ifeq      *blanks
N11  C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
N11  C                   PARM                    UUSR
N11  C                   PARM                    DIRENA            8
N11  C                   PARM                    DIREAD            8
N11  C                   PARM                    INTADR           70
N11  C                   EVAL      CEMAIL=INTADR
N11  C                   END
N11  C                   GOTO      KU0LO
N11  C                   END
N11  C                   END
N11  c                   end
N11  C                   ENDSR
     C***********************************************
     C     PDFMAN        BEGSR
     C***********************************************
      * manifest fly
     c*
     c                   Move      'A'           arSTAT
     C                   MOVEL     ARUNDE        samlnr            6
     c                   movel     samlnr        saml1             3
     c                   move      samlnr        saml2             3
     c                   move      aravd         xxavd             4
     c                   setoff                                       35
     c                   move      aravd         xxavd             4
     C                   MOVE      *zeros        ARAVD
     C                   MOVE      *zeros        AROPD
      *
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       samlnr:0      arlink
     c                   exsr      genbane
      *
     C                   CALL      'PDF016CL'
     C                   PARM                    XXavd
     C                   PARM                    saml1
     C                   PARM                    saml2
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
     C*
      *
      * skriver 1 record pr oppdrag ved Master samlast
      *
     c     samlnr        setll     head19
     c     *in35         doweq     '0'
     c     samlnr        reade     head19                                 35
     c     *in35         ifeq      '0'
     C                   MOVE      HEAVD         ARAVD
     C                   MOVE      HEOPD         AROPD
     c                   write     arkivr
     c                   end
     c                   end
      *
     C                   ENDSR
     C***********************************************
     C     PDFSVE        BEGSR
     C***********************************************
      * SVENSK sad EKSPORT
     c     artype        ifeq      'SE'
     C                   MOVE      'E'           TDTYP             1
     c                   z-add     aropd         aropds
     c     keysve        chain     sveh                               33
     c  n33              move      SVEH_SYSG     signat            3
     c                   end
     c     artype        ifeq      'SI'
     C                   MOVE      'I'           TDTYP             1
     c                   z-add     aropd         aropds
     c     keysve        chain     svih                               33
     c  n33              move      SVIH_SYSG     signat            3
     c                   end
     c     artype        ifeq      'S1'
     c                   z-add     aropd         aropds
     c     keysve        chain     svih                               33
     c  n33              move      SVIH_SYSG     signat            3
     C                   MOVE      '1'           TDTYP             1
     c                   end
     c     artype        ifeq      'S2'
     c                   z-add     aropd         aropds
     c     keysve        chain     svih                               33
     c  n33              move      SVIH_SYSG     signat            3
     C                   MOVE      '2'           TDTYP             1
     c                   end
     c     artype        ifeq      'S3'
     c                   z-add     aropd         aropds
     c     keysve        chain     sveh                               33
     c  n33              move      SVEH_SYSG     signat            3
     C                   MOVE      '3'           TDTYP             1
     c                   end
     c     artype        ifeq      'S4'
     c                   z-add     aropd         aropds
     c     keysve        chain     sveh                               33
     c  n33              move      SVEH_SYSG     signat            3
     C                   MOVE      '4'           TDTYP             1
     c                   end
      * svensk import
     c*
     c                   Move      'A'           arSTAT
s31  C*                  MOVE      ARUNDE        sveopd            7
n31  C                   MOVE      AROPD         sveopd            7
     c                   move      aravd         xxavd             4
     c                   setoff                                       35
      *
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       xxavd:0       arlink
     C     arlink        CAT       sveopd:0      arlink
     c                   exsr      genbane
      *
     C                   CALL      'PDF017CL'
     C                   PARM                    XXavd
     C                   PARM                    sveopd
     C                   PARM                    TDTYP
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
     C*
      *
      * HENT VERDIER
      *
     c     artype        chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c                   move      arkund        tuknt
     c                   move      arkund        fakunr
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
N24  c     lesn02        tag
     c     mailk         reade     cundc03                                44
n35  c     *in44         ifeq      '0'
n35  c                   exsr      testep
n35  c   33              goto      lesn02
n35  c                   end
     c     *in(44)       ifeq      '0'
n24  c     cemail        ifeq      '@'
n24  c                   goto      lesn02
n24  c                   end
     c     ku0sve        tag
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Cust. cleara'wstex2
n04  C     wstex2        CAT       'nse':0       wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C                   movel     'Tolldeklaras'wstex2
     C     wstex2        CAT       'jon':0       wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
      *
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'cust cleara:'wscvp1
n04  C     wscvp1        cat       'nce from:':0 wscvp1
n04  c                   else
     C                   movel     'Tolldeklara:'wscvp1
     C     wscvp1        cat       'jon fra:':0  wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkfe       wscvp2
n04  c                   else
     C                   movel     trykkf        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggfe     wscvp2
n04  c                   else
     c                   movel     vedleggf      wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
     C                   movel     'Ref:'        wscvp3
     C     wscvp3        cat       aavd:1        wscvp3
     C     wscvp3        cat       '/':0         wscvp3
     C     wscvp3        cat       aopd:0        wscvp3
N43  C                   EXSR      EPOSTSR
     C                   END
     C                   END
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     c                   move      *blanks       SYUSER
     c                   movel     signat        SYVRDA
     C     UsrKey        Chain     SYPARL3                            33
     c   33              goto      UTSVE
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0SVE
     C                   END
     C                   END
     C                   END
      *
     c     utsve         tag
      *
     C                   ENDSR
N55  C***********************************************
     C     PDFDEN        BEGSR
     C***********************************************
      * Dansk import/Export
     c     artype        ifeq      'DE'
     C                   MOVE      'E'           TDTYP             1
     c                   z-add     aropd         aropdd
     c     keydan        chain     dkeh                               33
     c  n33              move      DKEH_SYSG     signat            3
     c                   end
     c     artype        ifeq      'DI'
     C                   MOVE      'I'           TDTYP             1
     c                   z-add     aropd         aropdd
     c     keydan        chain     dkih                               33
     c  n33              move      DKIH_SYSG     signat            3
     c                   end
     c     artype        ifeq      'D1'
     c                   z-add     aropd         aropdd
     c     keydan        chain     dkih                               33
     c  n33              move      DKIH_SYSG     signat            3
     C                   MOVE      '1'           TDTYP             1
     c                   end
     c     artype        ifeq      'D2'
     c                   z-add     aropd         aropdd
     c     keydan        chain     dkih                               33
     c  n33              move      DKIH_SYSG     signat            3
     C                   MOVE      '2'           TDTYP             1
     c                   end
     c     artype        ifeq      'D3'
     c                   z-add     aropd         aropdd
     c     keydan        chain     DKIH                               33
     c  n33              move      DKIH_SYSG     signat            3
     C                   MOVE      '3'           TDTYP             1
     c                   end
     c     artype        ifeq      'D4'
     c                   z-add     aropd         aropdd
     c     keydan        chain     dkeh                               33
     c  n33              move      DKEH_SYSG     signat            3
     C                   MOVE      '4'           TDTYP             1
     c                   end
      * danks import
     c*
     c                   Move      'A'           arSTAT
     C                   MOVE      AROPD         danopd            7
     c                   move      aravd         xxavd             4
     c                   setoff                                       35
      *
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       xxavd:0       arlink
     C     arlink        CAT       danopd:0      arlink
     c                   exsr      genbane
      *
     C                   CALL      'PDF032CL'
     C                   PARM                    XXavd
     C                   PARM                    danopd
     C                   PARM                    TDTYP
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
     C*
N63   * Skal det skrives ref til extra sysped-oppdrag import ?
N63  C     ARTYPE        IFEQ      'DI'
N63  C     ARTYPE        OREQ      'D1'
N63  C     ARTYPE        OREQ      'D2'
N63  C     ARTYPE        OREQ      'D3'
N63  C     ARTYPE        OREQ      'D4'
N63  C                   EXSR      PDFDEN2
N63  C                   ENDIF
      *
      * HENT VERDIER
      *
     c     artype        chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c                   move      arkund        tuknt
     c                   move      arkund        fakunr
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
N24  c     lesnD2        tag
     c     mailk         reade     cundc03                                44
n35  c     *in44         ifeq      '0'
n35  c                   exsr      testep
n35  c   33              goto      lesnD2
n35  c                   end
     c     *in(44)       ifeq      '0'
n24  c     cemail        ifeq      '@'
n24  c                   goto      lesnD2
n24  c                   end
     c     ku0dan        tag
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Cust. cleara'wstex2
n04  C     wstex2        CAT       'nse':0       wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C                   movel     'Tolldeklaras'wstex2
     C     wstex2        CAT       'jon':0       wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
      *
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'cust cleara:'wscvp1
n04  C     wscvp1        cat       'nce from:':0 wscvp1
n04  c                   else
     C                   movel     'Tolldeklara:'wscvp1
     C     wscvp1        cat       'jon fra:':0  wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkfe       wscvp2
n04  c                   else
     C                   movel     trykkf        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggfe     wscvp2
n04  c                   else
     c                   movel     vedleggf      wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
     C                   movel     'Ref:'        wscvp3
     C     wscvp3        cat       aavd:1        wscvp3
     C     wscvp3        cat       '/':0         wscvp3
     C     wscvp3        cat       aopd:0        wscvp3
N43  C                   EXSR      EPOSTSR
     C                   END
     C                   END
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     c                   move      *blanks       SYUSER
     c                   movel     signat        SYVRDA
     C     UsrKey        Chain     SYPARL3                            33
     c   33              goto      UTDAN
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0DAN
     C                   END
     C                   END
     C                   END
      *
     c     utdan         tag
      *
     C                   ENDSR
N63  C***********************************************
N63  C     PDFDEN2       BEGSR
N63  C***********************************************
N63  C     *LIKE         DEFINE    ARAVD         XAVDN
N63  C     *LIKE         DEFINE    AROPD         XOPDN
N63  C     *LIKE         DEFINE    FSKODE        WSKODE
N63  C                   MOVEL     '*CR'         WSKODE
N63  C     FRIKEY        KLIST
N63  C                   KFLD                    DKIH_SYAV
N63  C                   KFLD                    DKIH_SYOP
N63  C                   KFLD                    WSKODE
N63   * Finnes extern referanse ?
N63   * og er den et syspedoppdrag i egen database ?
N63   * Skriv da i tillegg til arkiv med en referansen
N63  C     FRIKEY        CHAIN     FRISOK                             91
N63  C     *IN91         CABEQ     *ON           PDFDEN29
N63   * Er dette avd + opd ?   Kan skrives 4/10168  eller 0004/0010168
N63  C     '/'           SCAN      FSSOK         WP                2 0
N63  C     WP            IFLE      1
N63  C     WP            ORGT      5
N63  C                   GOTO      PDFDEN29
N63  C                   ENDIF
N63   * Hent avd
N63  C                   SUB       1             WP
N63  C     WP            SUBST     FSSOK:1       XAVD              4
N63  C                   Z-ADD     0             XAVDN
N63   /free
N63     monitor                              ;
N63        xavdn = %dec(xavd:4:0)            ;
N63     on-error 105                         ;
N63     endmon                               ;
N63   /end-free
N63   * Hent opd
N63  C                   ADD       2             WP
N63  C     ' '           SCAN      FSSOK         WQ                2 0
N63  C                   SUB       1             WQ
N63  C     WQ            SUB       WP            WR                2 0
N63  C                   ADD       1             WR
N63  C     WR            SUBST     FSSOK:WP      XOPD              7
N63  C                   Z-ADD     0             XOPDN
N63   /free
N63     monitor                              ;
N63        xopdn = %dec(xopd:7:0)            ;
N63     on-error 105                         ;
N63     endmon                               ;
N63   /end-free
N63   * Skriv til ARKIVP
N63  C                   MOVE      XAVDN         ARAVD
N63  C                   MOVE      XOPDN         AROPD
N63  C                   WRITE     ARKIVR
N63
N63  C     PDFDEN29      TAG
N63  C                   ENDSR
     C***********************************************
     C     PDFUTL        BEGSR
     C***********************************************
      * Utlæmningssedel
     c*
     c                   Move      'A'           arSTAT
     C                   MOVE      ARUNDE        TULLID           10
     c                   setoff                                       35
      *
     c                   move      *blanks       arlink
     c                   movel     artype        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       tullid:0      arlink
     c                   exsr      genbane
      *
     C                   CALL      'PDF019CL'
     C                   PARM                    TULLID
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     c                   parm                    arcinf
     C*
      *
      * HENT VERDIER
      *
     c     artype        chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c                   move      arkund        tuknt
     c                   move      arkund        fakunr
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     C     KU0UTL        TAG
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Delivery not'wstex2
n04  C     wstex2        CAT       'e':0         wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C                   movel     'Utlæmningsse'wstex2
     C     wstex2        CAT       'del':0       wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
      *
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Delivery no:'wscvp1
n04  C     wscvp1        cat       'te from:':0  wscvp1
n04  c                   else
     C                   movel     'Utlæmningss:'wscvp1
     C     wscvp1        cat       'edel fra:':0 wscvp1
     C     wscvp1        cat       fift:1        wscvp1
n04  c                   end
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkfe       wscvp2
n04  c                   else
     C                   movel     trykkf        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggfe     wscvp2
n04  c                   else
     c                   movel     vedleggf      wscvp2
n04  c                   end
     C                   end
     C                   movel     'Ref:'        wscvp3
     C     wscvp3        cat       aavd:1        wscvp3
     C     wscvp3        cat       '/':0         wscvp3
     C     wscvp3        cat       aopd:0        wscvp3
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     C                   END
     C                   END
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ANDNE     *blanks
     C                   GOTO      KU0UTL
     C                   END
     C                   END
     C                   END
      *
      *
     C                   ENDSR
N01   ***********************************************
N01  C     PDFAD         BEGSR
N01   ***********************************************
N01   * Advisering SJØ
N01   *
N01   * ordner start av linken med forståelig info
N01   *
s51  c*                  MOVEL     ARDATE        AAR               4
N01  C                   EVAL      ARLINK = ARTYPE + AAR + AVDOPD + ARUNDE
N01  C                   EXSR      GENBANE
N01  C                   MOVE      ARAVD         UAVD              4
N01  C                   MOVE      AROPD         UOPD              7
N01  C                   MOVEL     ARUNDE        UNR               1
N01  C                   CALL      'PDF020CL'
N01  C                   PARM                    UAVD
N01  C                   PARM                    UOPD
N01  C                   PARM                    UNR
N01  C                   PARM                    UBANE
N01  C                   PARM                    ARCINF
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     PDFBO         BEGSR
N01   ***********************************************
N01   * Booking SJØ
N01   *
N01   * ordner start av linken med forståelig info
N01   *
s51  c*                  MOVEL     ARDATE        AAR               4
N01  C                   EVAL      ARLINK = ARTYPE + AAR + AVDOPD + ARUNDE
N01  C                   EXSR      GENBANE
N01  C                   MOVE      ARAVD         UAVD              4
N01  C                   MOVE      AROPD         UOPD              7
N01  C                   SELECT
N01  C                   WHEN      ARUNDE = 'OS'
N01  C                   MOVE      '1'           UNR               1
N01  C                   MOVEL     'PDF021CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'LO'
N01  C                   MOVE      '2'           UNR
N01  C                   MOVEL     'PDF021CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'TR'
N01  C                   MOVE      '3'           UNR
N01  C                   MOVEL     'PDF021CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'DE'
N01  C                   MOVE      '4'           UNR
N01  C                   MOVEL     'PDF021CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'TE'
N01  C                   MOVE      '5'           UNR
N01  C                   MOVEL     'PDF021CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'BB'
N01  C                   MOVE      '6'           UNR
N01  C                   MOVEL     'PDF022CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'LS'
N01  C                   MOVE      '7'           UNR
N01  C                   MOVEL     'PDF023CL'    XPGM             10
N01  C                   WHEN      ARUNDE = 'FM'
N01  C                   MOVE      '8'           UNR
N01  C                   MOVEL     'PDF024CL'    XPGM             10
N01  C                   ENDSL
N01  C                   CALL      XPGM
N01  C                   PARM                    UAVD
N01  C                   PARM                    UOPD
N01  C                   PARM                    UNR
N01  C                   PARM                    UBANE
N01  C                   PARM                    ARCINF
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     PDFSS         BEGSR
N01   ***********************************************
N01   * Samlastspesifikasjon SJØ
N01   *
N01   * ordner start av linken med forståelig info
N01   *
s51  c*                  MOVEL     ARDATE        AAR               4
N01  C                   EVAL      ARLINK = ARTYPE + AAR + %TRIM(USG1)
N01  C                             + %TRIM(USD1) + ARUNDE
N01  C                   EXSR      GENBANE
N01  C                   CALL      'PDF025CL'
N01  C                   PARM                    UPARM1
N01  C                   PARM                    UBANE
N01  C                   PARM                    ARCINF
N01   *
N01   * OPPDATER ARKIVPOSTER
N01  C                   Move      'A'           arSTAT
N01  C                   except    updark2
N01  C                   MOVE      ARLINK        XARLINK          40
N01  C     key           READE     arkivl01                               33
N01  C                   DOW       *IN33 = *OFF
N01  C                   Move      'A'           arSTAT
N01  C                   MOVE      XARLINK       ARLINK
N01  C                   UPDATE    ARKIVR
N01  C     key           READE     arkivl01                               33
N01  C                   ENDDO
N01   *
N01  C                   ENDSR
N01   *
     C*****************************************************************
     c     gengods       begsr
     c*****************************************************************
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       atur9:0       arlink
     C     arlink        CAT       abeljn:0      arlink
      *
     c                   exsr      genbane
      *
      *
      *genererer PDF til selve godslista
      *
     C                   CALL      'PDF009CL'
     c                   parm                    uin03
     c                   parm                    xxavd
     c                   parm                    atur
     c                   parm                    abeljn
     c                   parm                    adrjn
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     C                   PARM                    ARCINF
     c                   endsr
     C*
     c**********************************************************************
     c     skrivtur      begsr
     c**********************************************************************
     c                   move      arunde        arundeg          10
     c                   move      'N'           fbfins            1
      *
      * tømm array med agenter
      *
     c                   MOVEa     *ZEROS        ag
     c                   z-add     0             nra               2 0
     c                   setoff                                       35
      *
     c     tupro         setll     head14
     c     *in35         doweq     '0'
     c     tupro         reade     head14                                 35
     c     *in35         ifeq      '0'
     C                   z-add     1             ARFFBN
     C     KEYDOK2       CHAIN     DOKUF                              33
     c  N33              move      'J'           fbfins
     C                   MOVE      heAVD         ARAVD
     C                   MOVE      heOPD         AROPD
     c                   move      'A'           arstat
     c                   move      atur10t       arunde
     c                   write     arkivr
      *
      * legger benyttede agenter i array
      *
     C     hekna         ifne      *zeros
     C     hekna         lookup    ag                                     33
     c     *in(33)       ifeq      '0'
     c                   add       1             nra
     c                   move      hekna         ag(nra)
     c                   end
     c                   end
      *
     c                   end
     c                   end
     c                   move      arundeg       arunde
     c                   endsr
     c**********************************************************************
     c     skrivtur2     begsr
     c**********************************************************************
      * skriv agentrecords til loggfil på de oppdrag som er på agent
      *
     c     keytua        klist
     c                   kfld                    tupro
     c                   kfld                    tuknt
     c                   setoff                                       35
     c                   move      arunde        arundeg          10
      *
     c     keytua        setll     head14
     c     *in35         doweq     '0'
     c     keytua        reade     head14                                 35
     c     *in35         ifeq      '0'
     C                   MOVE      heAVD         ARAVD
     C                   MOVE      heOPD         AROPD
     c                   move      'A'           arstat
     c                   move      atur10a       arunde
     c                   move      tuknt         arkund
     c                   write     arkivr
     c                   end
     c                   end
     c                   move      arundeg       arunde
     c                   endsr
     C*
     C***********************************************
     C     godsmail      BEGSR
     C***********************************************
      *
      * sende godsliste på mail
      *
     C                   MOVE      *BLANKS       WSTEX1
     c                   setoff                                       3344
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     C     KU0GOD        TAG
      *
      *Godsliste
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex1           30
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N04  C                   movel     'Waybill     'wstex1
n04  c                   move      *blanks       wstex2
n04  C                   movel     'Tripno:'     wstex2           60
n04  C     wstex2        CAT       ATUR:1        wstex2
n04  C     wstex2        CAT       'From:':1     wstex2
n04  C     wstex2        CAT       tusdf:1       wstex2
n04  C     wstex2        CAT       'To:':1       wstex2
n04  c                   else
     C                   movel     'Godsliste   'wstex1
     c                   move      *blanks       wstex2
     C                   movel     'Turnr:'      wstex2           60
     C     wstex2        CAT       ATUR:1        wstex2
     C     wstex2        CAT       'Fra:':1      wstex2
     C     wstex2        CAT       tusdf:1       wstex2
     C     wstex2        CAT       'Til:':1      wstex2
n04  c                   end
     C     wstex2        CAT       tusdt:1       wstex2
     c                   move      uusr          epuser
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     C                   MOVE      'E'           INTEKS
     C     CEMAIL        CHAIN     ARUSERL1                           35
     C  N35arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
      *
      * lager http for interne   brukere
      *
     C                   move      *blanks       uhttpi
      *
     c                   movel     uhttpista     uhttpi
      *
      * test transportør / agent
      *
     c     gotype        ifeq      'T'
     C     uhttpi        CAT       arlinktra:0   uhttpi
     c                   else
     C     uhttpi        CAT       arlinkage:0   uhttpi
     c                   end
     C     uhttpi        CAT       '.pdf':0      uhttpi
      * lager http for eksterne  brukere
     C                   move      *blanks       uhttpe
     c                   movel     uhttpesta     uhttpe
      *
      * test transportør / agent
      *
     c     gotype        ifeq      'T'
     C     uhttpe        CAT       arlinktra:0   uhttpe
     c                   else
     C     uhttpe        CAT       arlinkage:0   uhttpe
     c                   end
     C     uhttpe        CAT       '.pdf':0      uhttpe
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c     gotype        ifeq      'T'
     c                   eval      EPBANE = ubanegotr
     c                   else
     c                   eval      EPBANE = ubanegoag
     c                   end
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
N28  c                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Waybill from'wscvp1
n04  c                   else
     C                   movel     'Godsliste fr'wscvp1
     C     wscvp1        cat       'a:':0        wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkge       wscvp2
n04  c                   else
     C                   movel     trykkg        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggge     wscvp2
n04  c                   else
     c                   movel     vedleggg      wscvp2
n04  c                   end
     C                   end
     c                   write     arkepor
      *
      * legg til link samlet fraktbrev pdf
      *
     c     fbfins        ifeq      'J'
n05  c     gfjn          andeq     'J'
n05  c     gfsnd         andeq     'J'
     c                   exsr      addfbre
     c                   end
      *
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0GOD
     C                   END
     C                   END
     c                   endsr
     C***********************************************
     C     delark        BEGSR
     C***********************************************
     c                   move      *blanks       epbane
     c                   move      '0'           *in(39)
     c     uusr          setll     arkepo
     c     *in(39)       doweq     '0'
     c     uusr          reade     arkepo                                 39
     c     *in(39)       ifeq      '0'
     c                   delete    arkepor
     c                   end
     c                   end
     c                   endsr
      *stykkgods fraktbrev
     C*
     C***********************************************
     C     PDFFB         BEGSR
     C***********************************************
     C     KEYDOK        KLIST
     C                   KFLD                    ARFB              1
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
     C                   KFLD                    ARFFBN
     C                   MOVEL     ARUNDE        ARFFBN            3 0
     C                   MOVE      'F'           ARFB
     C     KEYDOK        CHAIN     DOKUF                              33
      *
      * ordner start av linken med forståelig info
      *
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C  N33arlink        CAT       DF1004:0      arlink
      *
      *stykkgods fraktbrev
     C                   MOVEL     ARUNDE        AFBN              3
     C                   MOVEL     ARUNDE        AFT04             4
     C                   MOVE      AFT04         Afrto             1
     c                   exsr      genbane
     C                   CALL      'PDF003CL'
     C                   PARM                    AAVD
     C                   PARM                    AOPD
     C                   PARM                    AFBN
     c                   parm                    Afrto
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     C                   PARM                    ARCINF
     C*
     c     artype        chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
      * dummy hvis null for å følge syklus
N56  c     arkund        ifeq      0
N56  c                   z-add     99999999      arkund
N56  c                   end
s56  c* N33arkund        ifne      0
     c                   z-add     arkund        tuknt
s56  C*    ARKSND        IFEQ      'J'
N56  C  N33ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     C     KU0FB         TAG
     c                   move      *blanks       eplink
     c                   move      *blanks       epline
     c                   move      *blanks       epbane
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
     c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Shipmentno:' wstex2
n04  C     wstex2        CAT       df1004:1      wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C                   movel     'Sendingsnr:' wstex2
     C     wstex2        CAT       df1004:1      wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
s26  C* N33wstex2        cat       'Til:':1      wstex2
n26  C     wstex2        cat       'Til:':1      wstex2
n04  c                   end
s26  C* N33wstex2        cat       knavn:1       wstex2
n26  C     wstex2        cat       DFNAVM:1      wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Waybill from'wscvp1
n04  C     wscvp1        cat       ':':0         wscvp1
n04  c                   else
     C                   movel     'Fraktbrev fr'wscvp1
     C     wscvp1        cat       'a:':0        wscvp1
n04  c                   end
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkse       wscvp2
n04  c                   else
     C                   movel     trykks        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggse     wscvp2
n04  c                   else
     c                   movel     vedleggs      wscvp2
n04  c                   end
     C                   end
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    UUSR
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0FB
     C                   END
     C                   END
N26   *
N26   * eventuelt mail til varemottaker
N26   * gjøres kun 1 gang når sndfbv= ' '
N26   *
N26  c     mailkkv       klist
N26  c                   kfld                    fifirm
N26  c                   kfld                    arkund
N26  c                   kfld                    DFNAVM
N26  c                   kfld                    DFAD1M
N26  c
N26  c     sndfbv        ifeq      ' '
N26  c                   move      'J'           sndfbv            1
N26  c                   z-add     0             tuknt
N26  c     mailkkv       chain     VADR1                              33
N26  C     *IN33         IFEQ      '0'
N26  c     VAMAIL        andne     *blanks
N26  C                   EVAL      CEMAIL=VAMAIL
N26  C                   EVAL      CLIVE='V'
N26  C                   GOTO      KU0FB
N26  C                   END
N26  C                   END
s56  c*                  end
n59  c                   end
     C                   ENDSR
     C***********************************************
     C     PDFSad        BEGSR
     C***********************************************
N60  c                   move      artype        artygm            2
      *sad import
     c     artype        ifeq      'si'
     C                   MOVE      'I'           TDTYP             1
     c     keyhea        chain     sadh                               33
     c  n33              move      sisg          signat            3
     c                   end
      *sad EKSPORT
     c     artype        ifeq      'se'
     c     keyhea        chain     saeh                               33
     c  n33              move      sesg          signat            3
     C                   MOVE      'E'           TDTYP             1
     c                   end
     C
      * SAD import/eksport
      *
      * ordner start av linken med forståelig info
      *
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
      *
     c                   exsr      genbane
     C                   CALL      'PDF001CL'
     C                   PARM                    AAVD
     C                   PARM                    Aopd
     C                   PARM                    TDTYP
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     C                   PARM                    vise
     c                   parm                    finst             1
     c                   parm                    finsd             1
     c                   PARM                    ARCINF
     c                   move      arlink        arlinkft         40
     c                   move      artype        artypeft          2
     c                   movel     ubane         ubaneft          50
s16  c*                  move      *blanks       uhttpift         76
n16  c                   move      *blanks       uhttpift        152
     c                   movel     uhttpi        uhttpift
s16  c*                  move      *blanks       uhttpeft         76
n16  c                   move      *blanks       uhttpeft        152
     c                   movel     uhttpe        uhttpeft
      *tilleggsark
     c     finst         ifeq      'J'
     c     tdtyp         ifeq      'I'
     C                   MOVE      'sj'          artype
     c                   else
     C                   MOVE      'sf'          artype
     c                   end
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
     c                   Move      'A'           arSTAT
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     c                   exsr      genbane
     c                   movel     ubane         ubanet
s16  c*                  move      *blanks       uhttpit          76
n16  c                   move      *blanks       uhttpit         152
     c                   movel     uhttpi        uhttpit
s16  c*                  move      *blanks       uhttpet          76
n16  c                   move      *blanks       uhttpet         152
     c                   movel     uhttpe        uhttpet
     c                   write     arkivr
     c                   end
      *
      * dataliste
      *
     c     finsd         ifeq      'J'
     c     tdtyp         ifeq      'I'
     C                   MOVE      'sk'          artype
     c                   else
     C                   MOVE      'sg'          artype
     c                   end
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
     c                   Move      'A'           arSTAT
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       avdopd:0      arlink
     c                   exsr      genbane
     c                   movel     ubane         ubaned
s16  c*                  move      *blanks       uhttpid          76
n16  c                   move      *blanks       uhttpid         152
     c                   movel     uhttpi        uhttpid
s16  c*                  move      *blanks       uhttped          76
n16  c                   move      *blanks       uhttped         152
     c                   movel     uhttpe        uhttped
     c                   write     arkivr
     c                   end
     c     finsd         ifeq      'J'
     c     finst         oreq      'J'
N38  C                   IF        TDTYP = 'I'
N38  C                   EVAL      ULISTNV = 'SAD61PFT'
N38  C                   ELSE
N38  C                   EVAL      ULISTNV = 'SAD52PFT'
N38  C                   END
     C                   CALL      'PDF001CL2'
     C                   PARM                    ubanet           50
     C                   PARM                    ubaned           50
     c                   parm                    finst             1
     c                   parm                    finsd             1
     c                   PARM                    ARCINF
N38  c                   PARM                    ULISTNV          10
     c                   end
      *
      * HENT VERDIER
      *
     c     artypeft      chain     ARKTXT                             33
      *
      * skal kunde ha mail
      *
n57  c                   Move      'A'           arSTAT
n58  c                   move      arlink        arlinkta         40
n58  c                   move      arlinkft      arlink
n57  c                   except    updark2
n58  c                   move      arlinkta      arlink
      *
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c                   move      arkund        tuknt
     c                   move      arkund        fakunr
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
N24  c     lesn01        tag
     c     mailk         reade     cundc03                                44
n35  c     *in44         ifeq      '0'
n35  c                   exsr      testep
n35  c   33              goto      lesn01
n35  c                   end
     c     *in(44)       ifeq      '0'
n24  c     cemail        ifeq      '@'
n24  c                   goto      lesn01
n24  c                   end
     c     ku0sad        tag
      *
      * sende XML til EMMA
N57   *
N57  C                   IF        CLIVE = 'X'
N57  C                   IF        ARTYPE = 'si'
N57  C                   EVAL      TDTYP = 'I'
N57  C                   ELSE
N57  C                   EVAL      TDTYP = 'E'
N57  C                   END
N58  C                   IF        AROPD > 0
N57  C                   CALL      'PDF001CL3'
N57  C                   PARM                    AAVD
N57  C                   PARM                    AOPD
N57  C                   PARM                    TDTYP
N58  C                   END
N57  c                   GOTO      LESN01
N57  C                   END
N57   *
      *
      * slett eventuellt gamle poster
      *
     c                   exsr      delark
     c                   move      *blanks       wstex2
N04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Cust.clearan'wstex2
n04  C     wstex2        CAT       'ce':0        wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
s04  c                   else
     C                   movel     'Tolldeklaras'wstex2
     C     wstex2        CAT       'jon':0       wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
s04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      uusr          epuser
     c                   movel     uhttpift      eplink
     c                   movel     uhttpeft      epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANEFT
     C                   END
      *
      * skjekk om mailbruker  er intern
      *
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
      *
      * tilleggsark
      *
     c     finst         ifeq      'J'
      *
      * skjekk om mailbruker  er intern
      *
     c                   movel     uhttpit       eplink
     c                   movel     uhttpet       epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANET
     C                   END
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     c     fins1         ifeq      'J'
     c                   move      *blanks       wstex1           30
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   moveL     'Spesificatio'wste13           13
n04  c                   move      'n'           wste13
n04  c                   else
     c                   moveL     'Spesifikasjo'wste13           13
     c                   move      'n'           wste13
n04  c                   end
     c                   moveL     wste13        wstex1           30
     c                   end
     c                   movel     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     c                   end
      *
      * dataliste
      *
     c     finsd         ifeq      'J'
      *
      * skjekk om mailbruker  er intern
      *
     c                   movel     uhttpid       eplink
     c                   movel     uhttped       epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANED
     C                   END
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
S36  c*    fins1         ifeq      'J'
N36  c     finsd         ifeq      'J'
     c                   move      *blanks       wstex1           30
n36  c                   move      *blanks       wstex2
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   moveL     'Spesificatio'wste13           13
n04  c                   move      'n'           wste13
n04  c                   else
     c                   moveL     'Spesifikasjo'wste13           13
     c                   move      'n'           wste13
n04  c                   end
     c                   moveL     wste13        wstex1           30
     c                   end
     c                   movel     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
     c                   end
      *
      * coverpage
      *
     C                   move      *blanks       wscvp1
N15  C                   eval      wscvp1='Tolldokument:'
s15  C*    spraak        ifeq      'E'
s15  c*    spraak        oreq      'T'
s15  C*                  movel     'Cust.clearan'wscvp1
s15  C*    wscvp1        cat       'ce fra:':0   wscvp1
s15  c*                  else
s15  C*                  movel     'Tolldeklaras'wscvp1
s15  C*    wscvp1        cat       'jon fra:':0  wscvp1
s15  c*                  end
s15  C*    wscvp1        cat       fift:1        wscvp1
KN   C     TDTYP         IFEQ      'I'
n15  C     wscvp1        cat       SITLE:1       wscvp1
n15  C     wscvp1        cat       SITLL:0       wscvp1
n15  c                   else
n15  C     wscvp1        cat       SETLE:1       wscvp1
n15  C     wscvp1        cat       SETLL:0       wscvp1
n15  c                   end
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N22  c     SIMF          ifne      'DUA'
n04  C                   movel     trykkte       wscvp2
N22  c                   else
n22  c                   movel     trykkue       wscvp2
N22  c                   end
n04  c                   else
N22  c     SIMF          ifne      'DUA'
     C                   movel     trykkt        wscvp2
N22  c                   else
n22  c                   movel     trykku        wscvp2
N22  c                   end
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
N22  c     SIMF          ifne      'DUA'
n04  c                   movel     vedleggte     wscvp2
N22  c                   else
n22  c                   movel     vedleggue     wscvp2
N22  c                   end
n04  c                   else
N22  c     SIMF          ifne      'DUA'
     c                   movel     vedleggt      wscvp2
N22  c                   else
n22  c                   movel     vedleggu      wscvp2
N22  c                   end
n04  c                   end
     C                   end
     C                   movel     'Ref:'        wscvp3
     C     wscvp3        cat       aavd:1        wscvp3
     C     wscvp3        cat       '/':0         wscvp3
     C     wscvp3        cat       aopd:0        wscvp3
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   eval      wscvp3 = '.'
N19  C                   eval      tttext='emailed custdec to:'
N19  C                   movel     CEMAIL        CEMA50           50
N19  C     tttext        cat       CEMA50:1      tttext
N19  C                   move      CCOMPN        tttext
N27  C                   eval      tttexl='epost av tolldekl. til:'
N27  C     tttexl        cat       CEMA50:1      tttexl
N27  C                   move      CCOMPN        tttexl
N19  C                   EXSR      TTSR
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ifeq      *blanks
     c                   move      *blanks       SYUSER
     c                   movel     signat        SYVRDA
     C     UsrKey        Chain     SYPARL3                            33
     c   33              goto      UTSAD
     C                   MOVE      *BLANKS       INTADR
S70  C*                  CALL      'EPOS04'
N70  C                   CALL      'EPOS04E'
     C                   PARM                    SYUSER
     C                   PARM                    DIRENA            8
     C                   PARM                    DIREAD            8
     C                   PARM                    INTADR           70
     C                   EVAL      CEMAIL=INTADR
     C                   END
     C                   GOTO      KU0SAD
     C                   END
     C                   END
     C                   END
     c     utsad         tag
      *
      * tilbakestiller verdier
      *
     c                   move      artypeft      artype
     c                   move      arlinkft      arlink
     C*
N41   *ryckattest import
N41   *
N41  c     keysypa       klist
N41  c                   kfld                    sypaid
N41  c                   kfld                    syvrdn
N41   *
N41  c     tdtyp         ifeq      'I'
n41  c                   move      'RYCUT'       sypaid
n41  c                   testn                   tlager               33
n41  c     *in33         ifeq      '1'
n41  c                   setoff                                       33
n41  c                   move      tlager        tlagern           5 0
N41  C                   z-add     tlagern       syvrdn
n41  c     keyhea        chain(n)  ruckpu                             33
n41  c     *in33         ifeq      '0'
n41  c     keyhea        setll     ruckpu
n41  c     *in33         doweq     '0'
n41  c     keyhea        reade     ruckpu                                 33
n41  c  n33              exsr      rucksr
n41  c                   end
n41  c                   end
n41  c                   end
n41  c                   end
N60  c                   move      artygm        artype
     C                   ENDSR
     C*
     C***********************************************
     C     genbane       BEGSR
     C***********************************************
      * genererer bane for lagring
      *
      * henter  randomverdi
      *
     C                   call      'ARCRAN'
     C                   parm                    arli10           10
     C     arlink        cat       arli10:0      arlink
      *
     C                   MOVE      'N'           vise              1
     C                   MOVE      ARAVD         AAVD              4
     C                   MOVE      AROPD         AOPD              7
N62  C                   MOVE      'J'           EPMAIN
N62  C                   MOVE      ARAVD         EPAVD
N62  C                   MOVE      AROPD         EPOP              7
      *
      * lager http for interne brukere
      *
     C                   move      *blanks       uhttpi
s16  c*                  movel     uhttpista     uhttpi           76
n16  c                   movel     uhttpista     uhttpi          152
     C     uhttpi        CAT       arlink:0      uhttpi
     C     uhttpi        CAT       '.pdf':0      uhttpi
      * lager http for interne brukere
s16  C*                  move      *blanks       uhttpe           76
n16  C                   move      *blanks       uhttpe          152
     c                   movel     uhttpesta     uhttpe
     C     uhttpe        CAT       arlink:0      uhttpe
     C     uhttpe        CAT       '.pdf':0      uhttpe
      *
      * lager bane til IFS
      *
     C                   move      *blanks       ubane            50
     C                   movel     ubanesta      ubane
     C     ubane         CAT       arlink:0      ubane
     C     ubane         CAT       '.pdf':0      ubane
     c                   endsr
     C***********************************************
     C     PDFTRAN       BEGSR
     C***********************************************
     C*
     C     TRH3KE        KLIST
     C                   KFLD                    XXST              1
     C                   KFLD                    NFAK
     C*
     C     TRV6KE        KLIST
     C                   KFLD                    NFAK
     C*
     C                   MOVE      'F'           XXST
     C                   z-add     0             ntrans            8 0
     c                   move      *zeros        traavd            4
      *
     C*
n46  c                   move      'tb'          ARTYPE
n46  c     artype        chain     ARKTXT                             33
n46  c  N33arkjn         ifeq      'J'
n46  c                   move      'J'           arkvedl           1
n46  c                   end
n46  c                   move      'ta'          XXTYPE
     c     artype        chain     ARKTXT                             33
     C  N33ARKJN         IFEQ      'J'
     C                   MOVEL     ARUNDE        AFAK
     C                   MOVEL     ARUNDE        NFAK              7 0
     c                   move      ardate        fadato
     c                   move      'N'           finsspe
     C     TRH3KE        CHAIN     TRAVH3                             72
     C  N72              z-add     thtnr         ntrans            8 0
     c  N72              move      thtavd        traavd            4
     C   72              MOVE      'O'           XXST
     C   72TRH3KE        CHAIN     TRAVH3                             72
     C  N72              z-add     thtnr         ntrans
     c  N72              move      thtavd        traavd
     C     *IN(72)       IFEQ      '1'
     C     TRV6KE        CHAIN     TRAVV6                             72
     C  N72              Z-ADD     TVTUNR        NTRANS
     C  N72              move      TVoavd        traavd
     C                   END
      *
      * transportør 0 er feil -  går da ut av rutinen
      *
     c     ntrans        ifeq      0
     c                   goto      utta
     c                   end
      * ordner start av linken med forståelig info til arbeidsliste
N46  c     arkvedl       ifeq      'J'
N46  c                   move      *blanks       arlink
N50  c                   move      'tb'          artype
N46  c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
N46  C     arlink        CAT       aar:0         arlink
N46  C     arlink        CAT       AFAK:0        arlink
N46  C                   exsr      genbane
N46  c                   move      ubane         ubanea           50
N46  c                   move      arlink        arlinka          40
N50  c                   move      'A'           arstat
N50  c                   write     arkivr
N46  c                   move      'ta'          artype
N46  c                   end
      * lagrer avregning
      *
      * ordner start av linken med forståelig info til avregning
      *
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       AFAK:0        arlink
      *
     C                   exsr      genbane
     C                   CALL      'PDF010CL'
     C                   PARM                    NFAK
     C                   PARM                    Ntrans
     C                   PARM                    traavd
     C                   PARM                    uhttpi
     C                   PARM                    ubane
n46  C                   PARM                    ubanea
     c                   parm                    vise
     c                   parm                    arcinf
     c                   parm                    arkvedl
     c                   end
      *
      * sprer utover turene på avregning
      *
N12  c                   setoff                                       35
N12  c     nfak          setll     travh6
N12  C     *in35         doweq     '0'
N12  c     nfak          reade     travh6                                 35
N12  c     *in35         ifeq      '0'
N12  c     thtunr        andne     0
N12  c                   movel     'T:'          arunde
N12  c                   move      thtunr        arunde
N13  c                   move      'A'           arstat
N12  c                   write     arkivr
      * Også vedlegget
N46  c     arkvedl       ifeq      'J'
N46  c                   move      arlink        arlinkg          40
N46  c                   move      arlinka       arlink
N50  c                   move      'tb'          artype
N46  c                   write     arkivr
N50  c                   move      'ta'          artype
N46  c                   move      arlinkg       arlink
N46  c                   end
N12  c                   end
N12  C                   enddo
      *
      * skal kunde ha mail
      *
     c                   z-add     arkund        tuknt
     C     ARKSND        IFEQ      'J'
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
n50  c     artype        chain     ARKTXT                             33
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         setll     cundc03
     c     *in(44)       doweq     '0'
     c     mailk         reade     cundc03                                44
     c     *in(44)       ifeq      '0'
     C     KU0TRA        TAG
      *
     c* slett eventuellt gamle poster
     c                   exsr      delark
     c                   move      *blanks       wstex2
n04  c     mailkk        CHAIN     CUNDL01                            33
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Inv:'        wstex2
n04  C     wstex2        CAT       afak:1        wstex2
n04  C     wstex2        CAT       'date:':1     wstex2
n04  C     wstex2        CAT       fadg:1        wstex2
n04  C     wstex2        CAT       '.':0         wstex2
n04  C     wstex2        CAT       famm:0        wstex2
n04  C     wstex2        CAT       '.':0         wstex2
n04  C     wstex2        CAT       faaa:0        wstex2
n04  C  N33wstex2        cat       'To:':1       wstex2
n04  c                   else
     C                   movel     'Fakt:'       wstex2
     C     wstex2        CAT       afak:1        wstex2
     C     wstex2        CAT       'dato:':1     wstex2
     C     wstex2        CAT       fadg:1        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       famm:0        wstex2
     C     wstex2        CAT       '.':0         wstex2
     C     wstex2        CAT       faaa:0        wstex2
s04  c*    mailkk        CHAIN     CUNDL01                            33
     C  N33wstex2        cat       'Til:':1      wstex2
n04  c                   end
     C  N33wstex2        cat       knavn:1       wstex2
     c                   move      *blanks       epuser
     c                   movel     uusr          epuser
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
      * skjekk om mailbruker  er intern
     C                   MOVE      'E'           inteks
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C  N33arinek        ifeq      'I'
     C                   MOVE      'I'           inteks
     c                   end
     C                   move      *blanks       wscvp1
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     'Transporter 'wscv24           24
n04  C                   move      'balance from'wscv24           24
n04  c                   else
     C                   movel     'Transportøra'wscv24           24
     C                   move      'vregning fra'wscv24           24
n04  c                   end
     c                   movel     wscv24        wscvp1
     C     wscvp1        cat       fift:1        wscvp1
     C     CLIVE         IFNE      'V'
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  C                   movel     trykkae       wscvp2
n04  c                   else
     C                   movel     trykka        wscvp2
n04  c                   end
     C                   else
N04  C     spraak        ifeq      'E'
N04  c     spraak        oreq      'T'
n04  c                   movel     vedleggae     wscvp2
n04  c                   else
     c                   movel     vedlegga      wscvp2
n04  c                   end
     C                   end
     c                   moveL     wstex1        eptex1
     c                   move      wstex2        eptex2
     c                   write     arkepor
S18  C*    ARKVED        IFNE      *BLANKS
N43  C                   EXSR      EPOSTSR
     c                   end
     c                   end
      *
      * eventuelt mail til seg selv   skjekk dette
      * gjøres kun 1 gang når kunde er ulik 0
      *
     c     tuknt         ifne      0
     c                   z-add     0             tuknt
     c     mailk         chain     cundc03                            33
     C     *IN33         IFEQ      '0'
     c     CEMAIL        ANDNE     *blanks
     C                   GOTO      KU0TRA
     C                   END
     C                   END
     c                   end
     c     utta          endsr
      *
     C***********************************************
     C     init          BEGSR
     C***********************************************
     C*
     C     *ENTRY        PLIST
     c                   parm                    utype             2
     c                   parm                    UUSER            10
     c                   parm                    finsspe           1
     c                   move      utype         xxtype            2
     c                   move      uUSER         xxUSER           10
     C                   MOVE      'N'           vise              1
      *
N39  C     KUNKEY        KLIST
N39  C                   KFLD                    FIFIRM
N39  C                   KFLD                    ARKUND
     C     KEYDOK2       KLIST
     C                   KFLD                    ARFB
     C                   KFLD                    heAVD
     C                   KFLD                    heOPD
     C                   KFLD                    ARFFBN
     C                   MOVE      'F'           ARFB
      *
     C     KEYHEA        KLIST
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
      *
      *
     C     KEYSVE        KLIST
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPDS            7 0
N55  C     KEYDAN        KLIST
N55  C                   KFLD                    ARAVD
N55  C                   KFLD                    AROPDD            7 0
      *
     c     key           klist
     c                   kfld                    XXSTAT            1
     c                   kfld                    xxUSER
     c                   kfld                    xxtype
N09  C                   move      'K'           xxstat
     C*
     c     keya02        klist
     c                   kfld                    YYSTAT
     c                   kfld                    ARAVD
     c                   kfld                    AROPD
     c                   kfld                    ARTYPE
     c                   kfld                    ARUNDE
     c                   move      'X'           yystat            1
     C*
     C     USRKEY        KLIST
     C                   KFLD                    SYPAID
     C                   KFLD                    SYVRDA
     C                   move      'USRID'       SYPAID
      *
     c                   read      firm                                   33
     c                   read      firmarc                                33
     c     *in33         ifeq      '1'
     c                   seton                                        lr
     c                   return
     c                   end
N72  c     arinf         chain     arktxt                             33
N72  c  N33              move      arsban        infban           50
      *
      * med vennlig hilsen
      *
     c                   movel     '.'           wscvp3
n17  c                   movel     '.'           wscvp4
n17  c                   movel     '.'           wscvp5
n17  c                   movel     '.'           wscvp6
s17  c*                  movel     'Med vennlig 'wscvp4
s17  C*    wscvp4        CAT       'hilsen':1    wscvp4
s17  C*                  movel     fift          wscvp5
s29  c*                  movel     'Med vennlig 'wscvp7
s29  C*    wscvp7        CAT       'hilsen':1    wscvp7
n29  c                   movel     'Med vennlig 'wscvp7n          40
n29  C     wscvp7n       CAT       'hilsen':1    wscvp7n
n29  c                   movel     'Regards     'wscvp7e          40
N17  C                   movel     fift          wscvp8
     c*
     c*
     c*
     C* lager starten på http og IFS-bane  intern ekstern
     c*
     c*
      * lager http for interne brukere
      *
      * intern
      *
s16  C*                  move      *blanks       uhttpista        76
n16  C                   move      *blanks       uhttpista       152
     c                   movel     'http://'     uhttpista
     C     uhttpista     CAT       arcpad:0      uhttpista
     C     uhttpista     CAT       '/':0         uhttpista
     C     uhttpista     CAT       arcane:0      uhttpista
     C     uhttpista     CAT       '/':0         uhttpista
      *
      * ekstern
      *
s16  C*                  move      *blanks       uhttpesta        76
n16  C                   move      *blanks       uhttpesta       152
     c                   movel     'http://'     uhttpesta
     C     uhttpesta     CAT       arcpae:0      uhttpesta
     C     uhttpesta     CAT       '/':0         uhttpesta
     C     uhttpesta     CAT       arcane:0      uhttpesta
     C     uhttpesta     CAT       '/':0         uhttpesta
      *
      * lager bane til IFS
      *
     C                   movel     '/'           ubanesta         70
     C     ubanesta      CAT       arcane:0      ubanesta
     C     ubanesta      CAT       '/':0         ubanesta
     c                   endsr
     C***********************************************
     C     genfbpdf      BEGSR
     C***********************************************
      *
      *
     c                   move      'gf'          artype            2
     c                   move      arlink        arlinkg          40
      *
      * arlink kommer fra godsnummer   byttes bare til 'gf'
      *
      *
      * ordner start av linken med forståelig info
      *
     c                   move      *blanks       arlink
     c                   movel     ARTYPE        arlink
s51  c*                  movel     ardate        aar               4
     C     arlink        CAT       aar:0         arlink
     C     arlink        CAT       atur9:0       arlink
      *
      *
      *stykkgods fraktbrev på hel tur
      *
S23  C*                  MOVE      'F'           Afrto             1
N23   * Trikser med kode for å fortelle at det er PDF003cl på GODSL./TUR-nivå
N23  C                   MOVE      'G'           Afrto             1
     c                   exsr      genbane
     C                   MOVE      atur          Afbn
     C                   MOVEl     atur          Aopd
     C                   MOVE      'F'           ARFB
     C                   CALL      'PDF003CL'
     C                   PARM                    AAVD
     C                   PARM                    AOPD
     C                   PARM                    AFBN
     c                   parm                    Afrto
     C                   PARM                    uhttpi
     C                   PARM                    ubane
     c                   parm                    vise
     C                   PARM                    ARCINF
     C                   move      'A'           arstat
     c                   move      *zeros        aravd
     c                   move      *zeros        aropd
     C                   write     arkivr
      *
     c                   move      arlink        arlinkfb         40
     c                   move      'go'          artype            2
     c                   move      arlinkg       arlink           40
     C*
     c                   endsr
     C***********************************************
     C     addfbre       BEGSR
     C***********************************************
     c                   move      *blanks       wstex1
     c                   move      *blanks       wstex2
     C                   movel     'Fraktbrevene'wstex1
     c* skriver til mailfil
     C                   movel     'til turnr:'  wstex2
     C     wstex2        cat       atur:1        wstex2
     c                   move      uusr          epuser
      * lager http for interne   brukere
     C                   move      *blanks       uhttpi
     c                   movel     uhttpista     uhttpi
     C     uhttpi        CAT       arlinkfb:0    uhttpi
     C     uhttpi        CAT       '.pdf':0      uhttpi
      * lager http for eksterne  brukere
     C                   move      *blanks       uhttpe
     c                   movel     uhttpesta     uhttpe
     C     uhttpe        CAT       arlinkfb:0    uhttpe
     C     uhttpe        CAT       '.pdf':0      uhttpe
      *
     c                   movel     uhttpi        eplink
     c                   movel     uhttpe        epline
     c                   movel     wstex1        eptex1
     c                   move      wstex2        eptex2
     C     CLIVE         IFEQ      'V'
     c                   eval      EPBANE = UBANE
     C                   END
     c                   write     arkepor
     c                   endsr
N17   ***************************************************************
N17  C     frisr         begsr
N17   ***************************************************************
N17  c                   z-add     1             nr                2 0
N17   *
N17   * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE E=Epost)
N17   *
N17  C     KEYHEA        SETLL     FRISOK
N17  C     KEYHEA        READE     FRISOK                                 33
N17  C     *IN33         DOWEQ     '0'
N17  C                   SORTA     DFS
N17  C     DFS(10)       IFNE      ' '
N17  C     'E'           LOOKUP    DFS                                    33
N17  C     *IN33         IFEQ      '1'
N17  C     FSKODE        CHAIN     KODFRI                             33
N17  C     *IN33         IFEQ      '0'
N17  C                   MOVEL     KFSOTX        DFRT(NR)
N17  c     DFRT(NR)      cat       ':':0         DFRT(NR)
N17  c     DFRT(NR)      cat       FSSOK:0       DFRT(NR)
N17  C                   ADD       1             NR
N17  C                   END
N17  C                   END
N17  C                   END
N17  C*
N17  C     KEYHEA        READE     FRISOK                                 33
N17  C  N33NR            COMP      3                                  33
N17  C                   END
N17  C     DFRT(1)       IFNE      *blanks
N17  C                   MOVEL     DFRT(1)       wscvp4
N17  C                   END
N17  C     DFRT(2)       IFNE      *blanks
N17  C                   MOVEL     DFRT(2)       wscvp5
N17  C                   END
N17  C     DFRT(3)       IFNE      *blanks
N17  C                   MOVEL     DFRT(3)       wscvp6
N17  C                   END
N17  C                   ENDSR
      *
N19  C***********************************************
N19  C     TTSR          BEGSR
N19  C***********************************************
N19   * OPPDRAG OPPRETTET (POST I FIL TRACKF)
N19  C                   MOVE      ARAVD         TTAVD
N19  C                   MOVE      AROPD         TTOPD
N19  C                   TIME                    XULTID
N19  C                   MOVE      XULDD         ULDD
N19  C                   MOVE      XULMM         ULMM
N19  C                   MOVE      XULÅÅ         ULÅÅ
N19  C                   MOVE      'EMA'         TTACTI
N19  C                   MOVE      ULDT          TTDATE
N19  C                   MOVE      XULTM         TTTIME
N19  C                   MOVE      TTDATE        TTDATL
N19  C                   MOVE      TTTIME        TTTIML
N19  C                   MOVE      UUSR          TTUSER
N19  C                   MOVEL     KNAVN         TTNAME
N19  C                   WRITE     TRACKFR
N19  C                   ENDSR
N33  C***********************************************
N33  C     TTSRSA        BEGSR
N33  C***********************************************
N33   * samlefaktura sperer EMA linjen
N33   *
N33   *
N33  c                   setoff                                       35
N33  c     fifn          setll     fain
N33  c     *in35         doweq     '0'
N33  c     fifn          reade     fain                                   35
N33  c     *in35         ifeq      '0'
N33  C                   MOVE      FIAVD         ARAVD
N33  C                   MOVE      FIOPD         AROPD
N33  c                   EXSR      TTSR
N33  c                   end
N33  c                   end
N33  C                   ENDSR
N51  C***********************************************
N51  C     TTSRNC        BEGSR
N51  C***********************************************
n51  c* NCTS  sprer EMA linjer
N51  c                   setoff                                       35
N51  c     truvk         setll     truv
N51  c     *in35         doweq     '0'
N51  c     lesnytte      tag
N51  c     truvk         reade     truv                                   35
N51  c     *in35         ifeq      '0'
n51   *ikke skriv doble record
N51  c     tvavd2        ifeq      aravdi
N51  c     tvtdn2        andeq     aropdi
N51  c                   goto      lesnytte
N51  c                   end
N51   *ikke skriv 0 record
N51  c     tvavd2        ifeq      0
N51  c     tvtdn2        oreq      0
n51  c                   goto      lesnytte
N51  c                   end
N51  C                   MOVE      tvavd2        ARAVD
N51  C                   MOVE      tvtdn2        AROPD
N51  c                   exsr      ttsr
N51  c                   end
N51  c                   end
N51   *
N51  C                   ENDSR
N35  C*******************************************************
N35  C     TESTEP        BEGSR
N35  C*******************************************************
n35  c                   setoff                                       33
n35   *
n35   * utelate epost i visse tilfelle
n35   *
n35  c     testny        tag
n35   *
n35   * tester oppdragstype
n35   *
n35  c     copd          ifne      *blanks
N35  C     heot          LOOKUP    oty                                    34
N35  c     copdio        ifeq      'I'
N35  c  N34              seton                                        33
n35  c                   end
n35  c     copdio        ifeq      'O'
n35  c   34              seton                                        33
n35  c                   end
n35  c                   end
n35   *
n35   * tester avdeling
n35   *
N35  C     cavd          ifne      *zeros
s54  C*    heavd         LOOKUP    av                                     34
n54  C     aravd         LOOKUP    av                                     34
N35  c     cavdio        ifeq      'I'
n35  c  N34              seton                                        33
n35  c                   end
n35  c     cavdio        ifeq      'O'
n35  c   34              seton                                        33
n35  c                   end
n35  c                   end
n35  c                   endsr
N41  C*******************************************************
N41  C     RUCKSR        BEGSR
N41  C*******************************************************
N41  C     KEYFRI        KLIST
N41  C                   KFLD                    SIAVD
N41  C                   KFLD                    SITDN
N41  C                   Kfld                    fskode
N41  C                   move      '*CR'         fskode
N41  C     KEYKOA        KLIST
N41  C                   KFLD                    KOAUNI
N41  C                   KFLD                    SIAVD
N41  c                   move      'A'           KOAUNI
N41  C     KEYKOA        CHAIN     KODTA                              34
N41  C     *in34         ifeq      '0'
N41  C                   MOVE      KOAKNR        ARKUND
N41  C     KUNKEY        CHAIN     CUNDL01                            34
N41  C     *in34         ifeq      '0'
N41   * epostadresse
N41  C                   eval      cemail=ruepost
N41   * emne
N41  c                   eval      wscvp1='Rykkattest fra:'
N41  c     wscvp1        cat       fift:1        wscvp1
N41  c     wscvp1        cat       'ID-nr:':1    wscvp1
N41  c     wscvp1        cat       syrg:1        wscvp1
N41   * linje 2
N41  c                   eval      wscvp2='Vårt oppdrag:'
N41  c     wscvp2        cat       aavd:1        wscvp2
N41  C     wscvp2        cat       '/':0         wscvp2
N41  c     wscvp2        cat       aopd:0        wscvp2
N41  C     KEYFRI        chain     frisok                             34
N41  c     *in34         ifeq      '0'
N41  c     wscvp2        cat       '/':0         wscvp2
N41  c     wscvp2        cat       fssok:0       wscvp2
n41  c                   end
n41  c     wscvp2        cat       '/':0         wscvp2
N41  c     wscvp2        cat       sisg:0        wscvp2
N41   * linje 3
N41  c                   eval      wscvp3='Deres Godsnr:'
N41  c     wscvp3        cat       sign:1        wscvp3
N41  c     wscvp3        cat       '/':0         wscvp3
N41  c     wscvp3        cat       sipos:1       wscvp3
N41   * linje 4
N41  c                   eval      wscvp4='Eks.sted/Løpenr:'
N41  c     wscvp4        cat       sitle:1       wscvp4
N41  c     wscvp4        cat       '/':0         wscvp4
N41  c     wscvp4        cat       sitll:0       wscvp4
N41   * linje 5
N41  c                   eval      wscvp5='Antall kolli: '
N41  C                             +%trim(%editc(SINTK:'Z'))
N41   * linje 6
N41  c                   eval      wscvp6='Avsender'
N41  c     wscvp6        cat       sinas:1       wscvp6
N41  c     wscvp6        cat       'Land':1      wscvp6
N41  c     wscvp6        cat       silka:1       wscvp6
N41   *
N41   * linje 7
N41  c                   eval      wscvp7='Mottaker'
N41  c     wscvp7        cat       sinak:1       wscvp7
N41   *
N41   * linje 8
N41  c                   move      *blanks       wscvp8
N41  c                   eval      wscvp8='Vår saksbehandler:'
N41  c     wscvp8        cat       sitarf:1      wscvp8
N44   *evrt legge på dokument
N44  c                   move      'ry'          artype
N45  c                   move      'V'           clive
N44  c     artype        chain     arktxt                             33
N44  C     arkved        ifne      *blanks
N44  C                   CALL      'ARC002V'
N44  C                   PARM                    ARTYPE
N44  C                   PARM                    Aavd
N44  C                   PARM                    Aopd
N44  C                   PARM                    ARKVED
N44  C                   PARM                    CLIVE
N44  C                   PARM                    arinek
N44  C                   PARM                    tuknt
N44  c                   end
N41  c                   call      'ARC009CL'
N41  c                   parm                    CEMAIL
N41  c                   parm                    wscvp1           80
N41  c                   parm                    wscvp2           40
N41  c                   parm                    wscvp3           40
N41  c                   parm                    wscvp4           40
N41  C                   parm                    wscvp5           40
N41  C                   parm                    wscvp6           40
N41  C                   parm                    wscvp7           40
N41  C                   parm                    wscvp8           40
N41  C                   parm                    inteks            1
N41  C                   PARM                    AAVD
N41  C                   PARM                    AOPD
N41  C                   PARM                    ATUR
N41  C                   PARM                    AKUN
N43  C                   PARM                    FIRMRG
N41  C                   eval      tttext='Email Rykkattest:'
N41  C                   movel     CEMAIL        CEMA50           50
N41  C     tttext        cat       CEMA50:1      tttext
N41  C                   move      CCOMPN        tttext
N41  C                   eval      tttexl='Epost Rykkattest:'
N41  C     tttexl        cat       CEMA50:1      tttexl
N41  C                   move      CCOMPN        tttexl
N41  c                   movel     SITLL         ttdepo
N41  C                   EXSR      TTSR
N19  C                   MOVE      ULDT          RUDATO
N19  C                   MOVE      XULTM         RUTID
N41  C                   UPDATE    RUCKPUR
N41  C                   end
N41  C                   end
N41  C                   endsr
N43  C*******************************************************
N43  C     EPOSTSR       BEGSR
N43  C*******************************************************
N53  C     K002V         IFNE      'N'
N43  C                   CALL      'ARC002V'
N43  C                   PARM                    ARTYPE
N43  C                   PARM                    Aavd
N43  C                   PARM                    Aopd
N43  C                   PARM                    ARKVED
N43  C                   PARM                    CLIVE
N43  C                   PARM                    arinek
N43  C                   PARM                    tuknt
N43  C                   END
N43  C*                  END
N69   * vedlegg generelt
N69   *
N69  c     arvedl        ifne      *blanks
N72  c                   eval      eplink = 'http://'
N72  C     eplink        CAT       arcpad:0      eplink
N72  C     eplink        CAT       '/':0         eplink
N72  C     eplink        CAT       infban:0      eplink
N72  C     eplink        CAT       '/':0         eplink
s72  c*                  eval      eplink =uhttpista
N69  C     eplink        CAT       arvedl:0      eplink
N72  C                   move      *blanks       uhttpesta       152
N72  c                   eval      epline = 'http://'
N72  C     epline        CAT       arcpae:0      epline
N72  C     epline        CAT       '/':0         epline
N72  C     epline        CAT       infban:0      epline
N72  C     epline        CAT       '/':0         epline
s72  c*                  eval      epline =uhttpesta
N69  C     epline        CAT       arvedl:0      epline
n72  C                   eval      epbane = '/'
n72  C     epbane        CAT       infban:0      epbane
n72  C     epbane        CAT       '/':0         epbane
s72  c*                  eval      EPBANE = UBANESTA
N69  C     epbane        CAT       arvedl:0      epbane
N69  C                   EVAL      EPMAIN = 'V'
N69  C                   move      *blanks       eptex1
N69  C                   move      *blanks       eptex2
N69  C                   write     arkepor
N69  C                   END
N69   *
N43  c     cemne         ifne      *blanks
N43  c                   move      cemne         wscvp1
N43  c                   end
N43  C                   MOVE      wscvp7n       wscvp7
N43  C     spraak        ifeq      'E'
N43  c     spraak        oreq      'T'
N43  C                   MOVE      wscvp7e       wscvp7
N43  c                   end
N43  C                   MOVE      ARCMRG        FIRMRG            1
N47  C     ARMRG         IFNE      ' '
N47  C                   MOVE      ARMRG         FIRMRG
N47  C                   END
N43  C     CMERGE        IFNE      ' '
N43  C                   MOVE      CMERGE        FIRMRG
N43  C                   END
N43  c                   call      'ARC009CL'
N43  c                   parm                    CEMAIL
N43  c*                  parm                    wscvp1           40
N43  c                   parm                    wscvp1           80
N43  c                   parm                    wscvp2           40
N43  c                   parm                    wscvp3           40
N43  c                   parm                    wscvp4           40
N43  C                   parm                    wscvp5           40
N43  C                   parm                    wscvp6           40
N43  C                   parm                    wscvp7           40
N43  C                   parm                    wscvp8           40
N43  C                   parm                    inteks            1
N43  C                   PARM                    AAVD
N43  C                   PARM                    AOPD
N43  C                   PARM                    ATUR
N43  C                   PARM                    AKUN
N43  C                   PARM                    FIRMRG
N43  C                   ENDSR
     O*                                                                   D150
     OARKIVR    E            UPDARK
     O                       ARSTAT
     O                       ARLINK
     OARKIVR2   E            UPDARK2
     O                       ARSTAT
     O                       ARLINK
