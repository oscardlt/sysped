********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10024 * 02 YBC PTF10 FORHOLD BRUTTO/NETTO VEKT
10XXX * 03 YBC PTF10 IKKE HENT VAREBESKRIVELSE FRA TARIFF-REG FOR TILLEGGSLINJE
10XXX * 04 YBC PTF10 VED ENDRING KAN MAN FJERNE FF-AVGIFT
10318 * 05 YBC PTF10 VEKT ER ENDRET FRA 5.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11016 * 06 YBC PTF11 OMBEREGNING
11XXX * 07 YBC PTF11 IKKE HENT VAREBESKRIVELSE FRA SOKTARI
11XXX * 08 YBC PTF11 GODTA TIDLIGST TARIFF NÅR OPPRINNELIG TARIFF ER SLETTET
      *              VED OMBEREGNING
11138 * 09 YBC PTF11 VIS STATUS PÅ FEILMELDING FRA TVINN.
11176 * 10 YBC PTF11 TILLEGGSLINJER MED SAMME POST
11186 * 11 YBC PTF11 VIS TOTAL VEKT OG SUM AV LINJEVEKT
********************************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
N02  FSAEHTL    IF   E           K DISK
     FSAEV      UF A E           K DISK
     FSAEV4     IF   E           K DISK    RENAME(SAEVR:SAEV4R)
     FSADAVGE   IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTSE    IF   E           K DISK
     FKODTSC    IF   E           K DISK
     FTARI      UF   E           K DISK
S07  F*SOKTARI2  IF   E           K DISK
     FSAD052FU  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UUR                   12     12
     D  UWS                   13     22
     D  UTVIN                 23     23
      *** UIN28 = '1' -> PROSEDYRE = 0, 20, 80 (UTGÅR 04.2000!!)
     D  UIN28                 24     24
      *** UIN34 = '1' -> SENDES PÅ TVINN
     D  UIN34                 25     25
      *** UIN36 = '1' -> I SAD400
     D  UIN36                 26     26
     D  UBEL1                 28     40  2
     D  UVKB                  41     49  0
     D  UDP                   50     51  0
     D  UKNK                  52     59  0
     D  UTST                  60     60  0
     D  UPRE                  61     61
     D  UZUNIK                62     70  0
     D  UZREFF                71     87
     D  W2VSUM                88    100  2
     D  W2DIFF               101    113  2
     D  ULI                  114    118  0
     D  UNYZF                119    119
     D  USEDT                121    128  0
      * OBS! HUSK INITIERE ALLE FELTER PÅ SAD052
N11  D  W2VKB                129    141  3
N11  D  W2VDIF               142    154  3
S11  D* UPARM1                 1    128
N11  D  UPARM1                 1    512
     D                 DS
     D  UPARM2                 1    512
     D  UTFLAG                 1      1  0
     D  UTVLI                  2      6  0
     D  UTTOP1                 7     23
     D  UTCRE1                24     26
      * ledig 27 - 54
     D  UF11                  55     55
     D  UF21                  56     56
     D  UIN37                 57     57
     D  UIN39                 58     58
     D  UIN60                 59     59
     D  XXPRE                 60     60
S05  D* UTTOP2                61     77
S05  D* UTCRE2                78     80
S05  D* UTTOP3                81     97
S05  D* UTCRE3                98    100
S05  D* UTTOP4               101    117
S05  D* UTCRE4               118    120
S05  D* UTTOP5               121    137
S05  D* UTCRE5               138    140
N05  D  UTTOP2                61     77
N05  D  UTCRE2                78     80
N05  D  UTTOP3                81     97
N05  D  UTCRE3                98    100
N05  D  UTTOP4               101    117
N05  D  UTCRE4               118    120
N05  D  UTTOP5               121    137
N05  D  UTCRE5               138    140
     D                 DS
S22  D* W2FT01                 1     17
S22  D* W2FT02                18     34
S22  D* W2FT03                35     51
S22  D* W2FT04                52     68
S22  D* W2FT05                69     85
S22  D* W2FT06                86    102
S22  D* W2FT07               103    119
S22  D* VFT                    1    136    DIM(8)
N22  D  W2FT01                 1     28
N22  D  W2FT02                29     56
N22  D  W2FT03                57     84
N22  D  W2FT04                85    112
N22  D  W2FT05               113    140
N22  D  W2FT06               141    168
N22  D  W2FT07               169    196
N22  D  VFT                    1    308    DIM(11)
     D                 DS
     D  W2NT01                 1      6  0
     D  W2NT02                 7     12  0
     D  W2NT03                13     18  0
     D  W2NT04                19     24  0
     D  W2NT05                25     30  0
     D  W2NT06                31     36  0
     D  W2NT07                37     42  0
S22  D* VNT                    1     48  0 DIM(8)
N22  D  VNT                    1     66  0 DIM(11)
     D                 DS
     D  W2EH01                 1      4
     D  W2EH02                 5      8
     D  W2EH03                 9     12
     D  W2EH04                13     16
     D  W2EH05                17     20
     D  W2EH06                21     24
     D  W2EH07                25     28
S22  D* VEH                    1     32    DIM(8)
N22  D  VEH                    1     44    DIM(11)
     D                 DS
S05  D* W2VT01                 1     15
S05  D* W2VT02                16     30
S05  D* W2VT03                31     45
S05  D* W2VT04                46     60
S05  D* W2VT05                61     75
S05  D* W2VT06                76     90
S05  D* W2VT07                91    105
S05  D* VVT                    1    120
S05  D*                                    DIM(8)
N05  D  W2VT01                 1     30
N05  D  W2VT02                31     60
N05  D  W2VT03                61     90
N05  D  W2VT04                91    120
N05  D  W2VT05               121    150
N05  D* W2VT06               151    180
N05  D* W2VT07               181    210
N05  D  VVT                    1    330    DIM(11)
     D                 DS
     D  W2TOP1                 1     17
     D  W2TOP2                18     34
     D  W2TOP3                35     51
     D  W2TOP4                52     68
     D  W2TOP5                69     85
N05  D  W2TOP6                86    102
N05  D  W2TOP7               103    119
N05  D  W2TOP8               120    136
N05  D  W2TOP9               137    153
N05  D  W2TOP10              154    170
S05  D* TOP                    1    136    DIM(8)
N05  D  TOP                    1    187    DIM(11)
     D                 DS
     D  W2CRE1                 1      3
     D  W2CRE2                 4      6
     D  W2CRE3                 7      9
     D  W2CRE4                10     12
     D  W2CRE5                13     15
N05  D  W2CRE6                16     18
N05  D  W2CRE7                19     21
N05  D  W2CRE8                22     24
N05  D  W2CRE9                25     27
N05  D  W2CRE10               28     30
S05  D* TCR                    1     24    DIM(8)
N05  D  TCR                    1     33    DIM(11)
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
     D  SVNT01                 1      6  0
     D  SVNT02                 7     12  0
     D  SVNT03                13     18  0
     D  SVNT04                19     24  0
     D  SVNT05                25     30  0
     D  SVNT06                31     36  0
     D  SVNT07                37     42  0
     D  SVNT                   1     48  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)
      *
     C                   EXSR      INIT
      *
     C                   MOVE      *ZEROS        XXLN              5 0
     C     START0        TAG
     C     XENDRE        IFEQ      'J'
     C                   EXSR      HENTSV
N04  C                   MOVE      'J'           XENDRING          1
     C                   ELSE
     C                   EXSR      MOVB2
N04  C                   MOVE      'N'           XENDRING
     C                   END
      *
     C     START         TAG
     C  N30
     CANN04              Z-ADD     5             LINNBR
     C  N30
     CANN04              Z-ADD     2             POSNBR
     C                   EXFMT     BILDE
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '000000'      *IN(86)
     C                   MOVE      '0'           *IN(30)
      *
     C   12              GOTO      SLUTT
      *
     C   11              MOVE      'J'           UF11
     C   21              MOVE      'J'           UF21
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
      *** F9  ---> SETTE IND. 39 PÅ/AV FOR Å MERKERE KALKULATOR PÅ/AV
     C*** F15 ---> SETTE IND. 37 PÅ/AV FOR Å AUTOKOPIERE TILLEGGSOPPL.
     C   09
     COR 15              DO
     C                   EXSR      SETIND
     C                   GOTO      START
     C                   END
      *
     C   25              DO
     C                   ADD       1             XXLN
     C     SAEVK4        SETLL     SAEV4
     C     SAEHK         READE     SAEV4                                  33
     C                   IF        *IN33
     C                   SUB       1             XXLN
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      SVLI          UTVLI
     C                   MOVE      SVLN          XXLN
     C                   MOVE      'J'           XENDRE
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   END
      *
     C   26              DO
     C                   SUB       1             XXLN
     C     SAEVK4        SETGT     SAEV4
     C     SAEHK         READPE    SAEV4                                  33
     C                   IF        *IN33
     C                   ADD       1             XXLN
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      SVLN          XXLN
     C     SAEVK4        SETLL     SAEV4
     C     SAEHK         READE     SAEV4                                  33
     C                   MOVE      SVLI          UTVLI
     C                   MOVE      'J'           XENDRE
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   END
      *
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
N04  C                   MOVE      'J'           XENDRING          1
     C  N05XENDRE        CABEQ     'N'           START
      *
     C                   EXSR      OPDSAD
     C                   MOVE      'J'           XNY               1
     C     UBEL1         SUB       W2VSUM        W2DIFF
N11  C     UVKB          SUB       W2VKB         W2VDIF
     C     W2DIFF        CABEQ     0             SLUTT
     C     XENDRE        IFEQ      'N'
     C                   EXSR      MOVB2
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     XNY           IFEQ      'J'
     C                   Z-ADD     9             UTFLAG
     C                   ELSE
     C                   Z-ADD     1             UTFLAG
     C                   END
     C                   MOVE      UPARM1        UPAR11
     C                   MOVE      UPARM2        UPAR21
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     SETIND        BEGSR
     C***********************************************
      *
      *** F9  ---> KALKULATOR PÅ/AV. BEHOLD FELLESOPPLYSNIGER PÅ LINJE
      ***          TOLLVERDI, BRUTTO- OG NETTO-VEKT SKAL REGISTRERES
      *            BENYTT INDIKATOR 39   39 PÅ -> KALKULATOR PÅ
     C     *IN09         IFEQ      '1'
     C     *IN39         IFEQ      '1'
     C                   MOVE      '0'           *IN39
     C                   ELSE
     C                   MOVE      '1'           *IN39
     C                   END
     C                   END
      *
      *** F15 ---> AUTO KOPIERING AV TILLEGGS OPPLYSNIGER
      *            BENYTT INDIKATOR 37   37 PÅ -> AUTO KOPIERING
     C     *IN15         IFEQ      '1'
     C     *IN37         IFEQ      '1'
     C                   MOVE      '0'           *IN37
     C                   ELSE
     C                   MOVE      '1'           *IN37
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
      *
      *** XSTK = 'J' ---> KREVE Å GI MENGDE.
     C                   MOVE      ' '           XSTK              1
      *** TESTE OM INNTASTET TARIFFNR. ER RIKTIG.
     C                   TESTN                   W2VNTI               33
     C   33              MOVE      W2VNTI        W2VNT
     C  N33              MOVE      '99999999'    W2VNT
     C     W2VNTI        IFEQ      *BLANKS
     C                   MOVE      *ZEROS        W2VNT
     C                   END
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   98
N08  C                   MOVE      'N'           XTARIFFOK         1
N08  C  N98              IF        UTDN < 0
N08  C                   MOVE      'J'           XTARIFFOK
N08  C                   END
     C     *IN98         DOWEQ     '0'
     C     TADATO        IFLE      USEDT
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      USEDT
N01  C     TADTS         ANDGE     USEDT
     C                   LEAVE
     C                   ELSE
     C                   UPDATE    TARIR
     C                   END
     C     TARIK         READPE    TARI                                   98
     C  N98              ENDDO
N08  C   98              IF        UTDN < 0 AND XTARIFFOK = 'J'
N08  C                   EVAL      *IN98 = *OFF
N08  C                   END
     C  N98
     CAN 13VVT(1)        IFNE      *BLANKS
S05  C*                  MOVE      VVT(1)        TAALFA
N05  C                   EVAL      TAALFA = VVT(1)
     C                   END
     C  N98              UPDATE    TARIR
      *
     C  N98W2AVT         IFEQ      ' '
N04  C     XENDRING      ANDNE     'J'
     C     W2VNT         SETLL     SADAVGE
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         DOWEQ     '0'
     C     AGDTF         IFLE      USEDT
     C     AGDTT         ANDGT     USEDT
     C                   LEAVE
     C                   END
     C     W2VNT         READE     SADAVGE                                33
     C  N33              ENDDO
     C  N33              MOVE      'X'           W2AVT
     C                   END
     C  N98              MOVE      TASTK         XSTK
     C   98              SETON                                        30
      *
      *** TEST OPPRINNELSESFYLKE (/LAND HVIS UTENLANSKE TRANSIT VARER)
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C     W2FYL         CHAIN     KODTSE                             99
     C   99
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'YBC0120'     MSGNR
     C                   END
     C                   ELSE
     C     KODS2K        CHAIN     KODTS2                             99
     C   99
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'JOV1017'     MSGNR
     C                   END
     C                   END
      *
      *** F11/21-> BEREGNE VEKT ETTER ANDEL AV BRUTTO VEKT. ANDELNØKKEL
      ***          ER TOLLVERDI/FAKTURASUM.
     C     UF11          IFEQ      'J'
     C     UF21          OREQ      'J'
     C     W2BELT        IFEQ      0
     C     UBEL1         OREQ      0
     C  N30              DO
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      'SPV0017'     MSGNR
     C                   END
     C                   ELSE
     C     W2BELT        DIV(H)    UBEL1         XWORK            16 5
     C     XWORK         MULT(H)   UVKB          W2VKTB                 3333
     C   33              Z-ADD     1             W2VKTB
S02  C*    W2VKTB        MULT(H)   0,9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C                   END
      *
      *** TEST VEKT
     C  N30W2VKTB        IFLE      0
     C     W2VKTN        IFLE      0
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'SPV0016'     MSGNR
     C                   ELSE
     C     W2VKTN        MULT(H)   1,1           W2VKTB
     C                   END
     C                   ELSE
     C     W2VKTN        IFEQ      0
S02  C*    W2VKTB        MULT(H)   0,9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C     W2VKTB        IFLT      W2VKTN
     C                   SETON                                        3097
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     28            POSNBR
     C                   MOVE      'JOV1095'     MSGNR
     C                   END
     C                   END
      *
     C     XSTK          IFEQ      'J'
     C     W2NTM         ANDEQ     0
     C                   SETON                                        9630
     C                   END
      *
     C  N30W2AVT         IFEQ      'X'                                          1<-B
     C     W2AVTP        IFEQ      0                                             2<-B
     C     W2AVTS        OREQ      *BLANKS
     C                   MOVE      *BLANKS       XAGSKV            3
     C                   MOVE      *ZEROS        XAGSAT            5 3
     C     W2VNT         SETLL     SADAVGE
     C     LESSAT        TAG
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         IFEQ      '0'                                            3<-B
     C     AGDTF         IFGT      USEDT                                           4<-B
     C     AGDTT         ORLE      USEDT
     C                   GOTO      LESSAT
     C                   END                                                       4<-E
     C     AGAKTK        IFNE      'I'                                             4<-B
     C     AGKD          ANDEQ     XXPRE
     C     XAGSAT        IFEQ      0                                                5<-B
     C                   MOVE      AGSKV         XAGSKV
     C                   MOVE      AGSATS        XAGSAT
     C                   ELSE                                                       5
     C                   MOVE      *BLANKS       XAGSKV
     C                   MOVE      *ZEROS        XAGSAT
     C                   CALL      'SAD052D'
     C     W2VNT         PARM      W2VNT         UVNTS             8 0
     C                   PARM                    XAGSKV
     C                   PARM                    XAGSAT
     C                   PARM                    XXPRE
     C                   PARM      USEDT         USEDT2            8 0
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   GOTO      LESSAT
     C                   END                                                      3<-E
     C     XAGSAT        IFNE      0                                              3<-B
     C                   MOVE      XAGSAT        W2AVTP
     C                   MOVE      XAGSKV        W2AVTS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *** 37 PÅ AUTODUP
     C   37W2TOP1        IFEQ      *BLANKS
     C                   MOVEL     UTTOP1        W2TOP1
     C                   MOVE      UTCRE1        W2CRE1
     C                   MOVEL     UTTOP2        W2TOP2
     C                   MOVE      UTCRE2        W2CRE2
     C                   MOVEL     UTTOP3        W2TOP3
     C                   MOVE      UTCRE3        W2CRE3
     C                   MOVEL     UTTOP4        W2TOP4
     C                   MOVE      UTCRE4        W2CRE4
     C                   MOVEL     UTTOP5        W2TOP5
     C                   MOVE      UTCRE5        W2CRE5
     C                   END
      *
      *** TEST KODE FOR DOKUMENT/SERTIFIKAT
     C     *IN34         IFEQ      '1'                                          1<-B
S05  C*    1             DO        5             XN                1 0           2<-B
N05  C     1             DO        10            XN                3 0           2<-B
     C     TCR(XN)       IFNE      *BLANKS                                        3<-B
     C     TCR(XN)       CHAIN     KODTSC                             33
     C     *IN33         IFEQ      '1'                                             4<-B
      * INNTASTET KODE ER UGYLDIG
     C     XN            MULT      2             X2                3 0
     C     96            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   ELSE                                                      4
     C     TOP(XN)       IFEQ      *BLANKS                                          5<-B
      * TEKSTEN ER IKKE OPPGITT
     C     XN            MULT      2             X2                3 0
     C     97            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C  N30TOP(XN)       IFNE      *BLANKS                                        3<-B
     C     TCR(XN)       ANDEQ     *BLANKS
      * KODE ER IKKE OPPGITT
     C     XN            MULT      2             X2                3 0
     C     96            SUB       X2            X2
     C                   MOVE      '1'           *IN(X2)
     C                   SETON                                        30
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
N05  C   76              Z-ADD     19            LINNBR
N05  C   76              Z-ADD     70            POSNBR
N05  C   76              MOVE      'SPC0006'     MSGNR
N05  C   77              Z-ADD     19            LINNBR
N05  C   77              Z-ADD     46            POSNBR
N05  C   77              MOVE      'DIV1954'     MSGNR
N05  C   78              Z-ADD     19            LINNBR
N05  C   78              Z-ADD     30            POSNBR
N05  C   78              MOVE      'SPC0006'     MSGNR
N05  C   79              Z-ADD     19            LINNBR
N05  C   79              Z-ADD     6             POSNBR
N05  C   79              MOVE      'DIV1954'     MSGNR
N05  C   80              Z-ADD     18            LINNBR
N05  C   80              Z-ADD     70            POSNBR
N05  C   80              MOVE      'SPC0006'     MSGNR
N05  C   81              Z-ADD     18            LINNBR
N05  C   81              Z-ADD     46            POSNBR
N05  C   81              MOVE      'DIV1954'     MSGNR
N05  C   82              Z-ADD     18            LINNBR
N05  C   82              Z-ADD     30            POSNBR
N05  C   82              MOVE      'SPC0006'     MSGNR
N05  C   83              Z-ADD     18            LINNBR
N05  C   83              Z-ADD     6             POSNBR
N05  C   83              MOVE      'DIV1954'     MSGNR
N05  C   84              Z-ADD     17            LINNBR
N05  C   84              Z-ADD     70            POSNBR
N05  C   84              MOVE      'SPC0006'     MSGNR
N05  C   85              Z-ADD     17            LINNBR
N05  C   85              Z-ADD     46            POSNBR
N05  C   85              MOVE      'DIV1954'     MSGNR
E05  C   86              Z-ADD     17            LINNBR
E05  C   86              Z-ADD     30            POSNBR
     C   86              MOVE      'SPC0006'     MSGNR
E05  C   87              Z-ADD     17            LINNBR
E05  C   87              Z-ADD     6             POSNBR
     C   87              MOVE      'DIV1954'     MSGNR
E05  C   88              Z-ADD     16            LINNBR
E05  C   88              Z-ADD     70            POSNBR
     C   88              MOVE      'SPC0006'     MSGNR
E05  C   89              Z-ADD     16            LINNBR
E05  C   89              Z-ADD     46            POSNBR
     C   89              MOVE      'DIV1954'     MSGNR
E05  C   90              Z-ADD     16            LINNBR
E05  C   90              Z-ADD     30            POSNBR
     C   90              MOVE      'SPC0006'     MSGNR
E05  C   91              Z-ADD     16            LINNBR
E05  C   91              Z-ADD     6             POSNBR
     C   91              MOVE      'DIV1954'     MSGNR
E05  C   92              Z-ADD     15            LINNBR
E05  C   92              Z-ADD     70            POSNBR
     C   92              MOVE      'SPC0006'     MSGNR
E05  C   93              Z-ADD     15            LINNBR
E05  C   93              Z-ADD     46            POSNBR
     C   93              MOVE      'DIV1954'     MSGNR
     C   94              Z-ADD     15            LINNBR
     C   94              Z-ADD     30            POSNBR
     C   94              MOVE      'SPC0006'     MSGNR
     C   95              Z-ADD     15            LINNBR
     C   95              Z-ADD     6             POSNBR
     C   95              MOVE      'DIV1954'     MSGNR
     C   96
     CANN97
     CANN99              Z-ADD     5             LINNBR
     C   96
     CANN97
     CANN99              Z-ADD     50            POSNBR
     C   96
     CANN97
     CANN99              MOVE      'SPN0016'     MSGNR
     C   98
     CANN99              Z-ADD     5             LINNBR
     C   98
     CANN99              Z-ADD     5             POSNBR
     C   98
     CANN99              MOVE      'SPT0033'     MSGNR
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENTSV        BEGSR
     C***********************************************
      *
     C     SAEVK         CHAIN(N)  SAEV                               33
     C     *IN33         IFEQ      '0'                                          1<-B
N06  C                   MOVE      SVNYL         XSVNYL            1
N06  C                   EVAL      *IN28 = *OFF
N06  C                   IF        UTDN < 0 AND SVNYL = ' '
N06  C                   EVAL      *IN28 = *ON
N06  C                   END
     C                   MOVE      SVLN          XXLN              5 0
     C                   MOVE      SVVNT         W2VNT
     C                   MOVE      SVVNT         W2VNTI
     C                   MOVE      SVFYL         W2FYL
     C                   MOVE      SVBELT        W2BELT
     C                   MOVE      SVVKTB        W2VKTB
     C                   MOVE      SVVKTN        W2VKTN
S05  C*                  IF        SVNTM < 0
S05  C*                  EVAL      W2NTM = SVNTM * -100
S05  C*                  ELSE
     C                   EVAL      W2NTM = SVNTM
S05  C*                  END
     C                   MOVE      SVAVT         W2AVT
     C                   MOVE      SVAVTS        W2AVTS
     C                   MOVE      SVAVTP        W2AVTP
     C                   MOVEA     SVFT          VFT
     C                   MOVEA     SVNT          VNT
     C                   MOVEA     SVEH          VEH
     C                   MOVEA     SVVT          VVT
     C                   MOVEA     SVTOP         TOP
     C                   END                                                    1<-E
      *
      * DET FINNES FLERE LINJER ENN FULL MODULS TILLATER.
     C     SLHENT        TAG
     C     UTFLAG        IFEQ      5
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDSAD        BEGSR
     C***********************************************
      *
      * OPPDATER HOVEDLINJE
     C     XENDRE        IFEQ      'J'
     C     SAEVK         CHAIN     SAEV                               33
     C                   ELSE
     C                   MOVE      '1'           *IN33
     C                   END
     C                   Z-ADD     1             XN
     C                   EXSR      MOVWSV
      * INITIERER ANTALL TILLLEGGSLINJER
     C     *LIKE         DEFINE    SVREFL        XREFL
     C                   MOVE      *ZEROS        XREFL
     C                   MOVE      *ZEROS        SVREFL
     C     *IN33         IFEQ      '1'
N06  C                   EVAL      SVNYL = XSVNYL
N02  C                   MOVE      SVLI          SVLN
     C                   WRITE     SAEVR
     C                   ELSE
     C                   UPDATE    SAEVR
     C                   END
     C                   MOVE      SVLI          XLI               5 0
N02  C                   MOVE      SVLN          XXLN              5 0
     C     W2TOP1        IFNE      *BLANKS
     C                   MOVEL     W2TOP1        UTTOP1
     C                   END
     C     W2CRE1        IFNE      *BLANKS
     C                   MOVE      W2CRE1        UTCRE1
     C                   END
     C     W2TOP2        IFNE      *BLANKS
     C                   MOVEL     W2TOP2        UTTOP2
     C                   END
     C     W2CRE2        IFNE      *BLANKS
     C                   MOVE      W2CRE2        UTCRE2
     C                   END
     C     W2TOP3        IFNE      *BLANKS
     C                   MOVEL     W2TOP3        UTTOP3
     C                   END
     C     W2CRE3        IFNE      *BLANKS
     C                   MOVE      W2CRE3        UTCRE3
     C                   END
     C     W2TOP4        IFNE      *BLANKS
     C                   MOVEL     W2TOP4        UTTOP4
     C                   END
     C     W2CRE4        IFNE      *BLANKS
     C                   MOVE      W2CRE4        UTCRE4
     C                   END
     C     W2TOP5        IFNE      *BLANKS
     C                   MOVEL     W2TOP5        UTTOP5
     C                   END
     C     W2CRE5        IFNE      *BLANKS
     C                   MOVE      W2CRE5        UTCRE5
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWSV        BEGSR
     C***********************************************
     C     *IN33         IFEQ      '1'
     C                   CLEAR                   SAEVR
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UTDN          SVTDN
     C                   ADD       1             ULI
     C                   MOVE      ULI           SVLI
     C                   END
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UTDN          SVTDN
     C   21
     COR 22              MOVE      'B'           SV01
     C  N21
     CANN22              MOVE      ' '           SV01
     C                   MOVE      W2VNT         SVVNT
     C                   MOVE      W2FYL         SVFYL
     C                   MOVE      W2AVT         SVAVT
     C                   MOVE      W2AVTS        SVAVTS
     C                   MOVE      W2AVTP        SVAVTP
     C     XN            IFEQ      1
     C                   SUB       SVBELT        W2VSUM
     C                   ADD       W2BELT        W2VSUM
N11  C                   SUB       SVVKTB        W2VKB
N11  C                   ADD       W2VKTB        W2VKB
     C                   MOVE      W2BELT        SVBELT
     C                   MOVE      W2VKTB        SVVKTB
     C                   MOVE      W2VKTN        SVVKTN
S05  C*                  IF        W2NTM > 9999999
S05  C*                  EVAL      SVNTM = W2NTM / 100 * -1
S05  C*                  ELSE
     C                   MOVE      W2NTM         SVNTM
S05  C*                  END
     C                   ELSE
     C                   MOVE      *ZEROS        SVBELT
     C                   MOVE      *ZEROS        SVVKTB
     C                   MOVE      *ZEROS        SVVKTN
     C                   MOVE      *ZEROS        SVNTM
     C                   END
     C                   MOVEA     VFT(XN)       SVFT
     C                   MOVEA     VNT(XN)       SVNT
     C                   MOVEA     VEH(XN)       SVEH
     C                   MOVEA     VVT(XN)       SVVT
     C     SVVT01        IFEQ      *BLANKS
N03  C     XN            ANDEQ     1
S05  C*                  MOVE      TAALFA        SVVT
S07  C*    SVVNT         CHAIN     SOKTARI2                           34
S07  C* N34              EVAL      SVVT = BESKR1
S07  C*  34              EVAL      SVVT = TAALFA
S07  C                   EVAL      SVVT01 = TAALFA
     C                   MOVE      *BLANKS       TAALFA
     C                   ELSE
     C     SVVT01        IFEQ      TAALFA
     C                   MOVE      *BLANKS       TAALFA
     C                   END
     C                   END
     C                   MOVEA     TOP           SVTOP
     C                   MOVEA     TCR           SVTCR
N09  C                   MOVE      ' '           SVERR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
N06  C                   EVAL      *IN28 = *OFF
N06  C                   IF        UTDN < 0
N06  C                   EVAL      XSVNYL = 'J'
N06  C                   ELSE
N06  C                   EVAL      XSVNYL = ' '
N06  C                   END
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *BLANKS       W2VNTI
     C                   MOVE      *BLANKS       W2FYL
     C                   MOVE      *BLANKS       W2AVT
     C                   MOVE      *ZEROS        W2AVTP
     C                   MOVE      *BLANKS       W2AVTS
      *
     C     W2DIFF        IFGT      0
     C                   Z-ADD     W2DIFF        W2BELT
     C                   ELSE
     C                   MOVE      *ZEROS        W2BELT
     C                   END
     C                   MOVE      *ZEROS        W2VKTB
     C                   MOVE      *ZEROS        W2VKTN
     C                   MOVE      *ZEROS        W2NTM
     C                   MOVE      *BLANKS       VFT
     C                   MOVE      *ZEROS        VNT
     C                   MOVE      *BLANKS       VEH
     C                   MOVE      *BLANKS       VVT
     C  N37              MOVE      *BLANKS       TOP
     C  N37              MOVE      *BLANKS       TCR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     3
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C                   CALL      'SAD052H'
     C                   PARM                    W2FYL
     C                   ELSE
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    W2FYL
     C                   PARM                    USPED
     C                   END
     C                   Z-ADD     5             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     12
     C                   CALL      'SAD062A'
     C                   PARM                    W2VNTI
     C*    USEDT         PARM                    USEDT2            8 0
     C                   PARM      USEDT         USEDT2            8 0
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     68
     C     POSNBR        ANDLE     70
     C                   MOVE      'FF'          UAVGKD            2
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    UAVGKD
     C                   PARM                    W2AVTS
     C                   PARM                    UMOD
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFGE      15
     C     LINNBR        ANDLE     19
S05  C*    POSNBR        ANDGE     30
N05  C     POSNBR        IFGE      30
     C     POSNBR        ANDLE     32
N05  C     POSNBR        ORGE      70
N05  C     POSNBR        ANDLE     72
S05  C*    LINNBR        SUB       14            XN
N05  C                   EVAL      XN = (LINNBR - 15) * 2 + 1
N05  C                   IF        POSNBR >= 70 AND POSNBR <= 72
N05  C                   EVAL      XN = XN + 1
N05  C                   END
     C                   MOVE      TCR(XN)       UCREF             3
     C                   MOVE      'N'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    UCREF
     C                   PARM                    UIMP
     C                   MOVE      UCREF         TCR(XN)
S05  C*    LINNBR        IFLT      19
S05  C*                  ADD       1             LINNBR
S05  C*                  Z-ADD     6             POSNBR
S05  C*                  END
N05  C                   SELECT
N05  C                   WHEN      POSNBR >= 30 AND POSNBR <= 32
N05  C                   Z-ADD     46            POSNBR
N05  C                   OTHER
N05  C                   Z-ADD     6             POSNBR
N05  C                   IF        LINNBR < 19
N05  C                   ADD       1             LINNBR
N05  C                   END
N05  C                   ENDSL
     C                   GOTO      SLSØK
N05  C                   END
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SAEHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SAEVK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    UTVLI
     C     SAEVK4        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    XXLN
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    W2FYL
     C     TARIK         KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C     TARIKM        KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
      *
     C     *ENTRY        PLIST
S11  C*    UPARM1        PARM                    UPAR11          128
N11  C     UPARM1        PARM                    UPAR11          512
     C     UPARM2        PARM                    UPAR21          512
      *
     C                   OPEN      SAD052FU
     C                   CLEAR                   BILDE
     C                   MOVE      UPAR11        UPARM1
     C                   MOVE      UPAR21        UPARM2
     C     UTVLI         IFGT      0
     C                   MOVE      'J'           XENDRE            1
     C                   MOVE      '1'           *IN27
     C                   ELSE
     C                   MOVE      'N'           XENDRE
     C                   MOVE      '0'           *IN27
     C                   END
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      *BLANKS       X2TAR             3
     C                   MOVE      'N'           XNY               1
      *
     C                   MOVE      'DIV1954'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     78            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT1            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1955'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     78            XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT2            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
      *
     C                   MOVE      UIN34         *IN34
     C                   MOVE      UIN37         *IN37
     C                   MOVE      UIN39         *IN39
      * IN60 PÅ --> SJØ-DEKLARASJON
     C                   MOVE      UIN60         *IN60
N02  C     SAEHK         CHAIN     SAEHTL                             33
N02  C   33              Z-ADD     0.9           SEFVK
      *
     C                   ENDSR
      *
