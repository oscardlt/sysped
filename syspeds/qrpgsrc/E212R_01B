     FEDIS      UF   E           K DISK
     FEUNB      UF   E           K DISK
     FEDIMC     UF   E           K DISK
     FEUNH      UF   E           K DISK
     FEDIJ2     IF   E           K DISK
     FEDII      IF   E           K DISK
     FECMSG1    IF   E           K DISK
     FEALI01B   IF   E           K DISK
     FECNT01B   IF   E           K DISK
     FECOD01B   IF   E           K DISK
     FECOM01B   IF   E           K DISK
     FECPS01B   IF   E           K DISK
     FECTA01B   IF   E           K DISK
     FECUX01B   IF   E           K DISK
     FEDGS01B   IF   E           K DISK
     FEDLM01B   IF   E           K DISK
     FEDTM01B   IF   E           K DISK
     FEEQA01B   IF   E           K DISK
     FEEQD01B   IF   E           K DISK
     FEFTX01B   IF   E           K DISK
     FEGIN01B   IF   E           K DISK
     FEGIR01B   IF   E           K DISK
     FEHAN01B   IF   E           K DISK
     FEIMD01B   IF   E           K DISK
     FELIN01B   IF   E           K DISK
     FELOC01B   IF   E           K DISK
     FEMEA01B   IF   E           K DISK
     FEMOA01B   IF   E           K DISK
     FENAD01B   IF   E           K DISK
     FEPAC01B   IF   E           K DISK
     FEPCD01B   IF   E           K DISK
     FEPCI01B   IF   E           K DISK
     FEPIA01B   IF   E           K DISK
     FEQTY01B   IF   E           K DISK
     FEQVR01B   IF   E           K DISK
     FERFF01B   IF   E           K DISK
     FESEL01B   IF   E           K DISK
     FESGP01B   IF   E           K DISK
     FETDT01B   IF   E           K DISK
     FETMD01B   IF   E           K DISK
     FETOD01B   IF   E           K DISK
     FEDISE     O  A E             DISK
     D A               S              1    DIM(70)
     D B               S              1    DIM(80)
     D TABA            S              1    DIM(32) CTDATA PERRCD(1) ASCEND
     D TABB            S              1    DIM(32) ALT(TABA)
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)
      *____________
      * DS for Dato
      *""""""""""""
     D                 DS
     D  WTIME                  1     14  0
     D  WTM                    1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  WDT                    1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
     D                 DS
     D  WUMN                   1      9  0
     D  ZGN0                  10     11  0
     D  ZGN1                  12     13  0
     D  ZGN2                  14     15  0
     D  ZGN3                  16     17  0
     D  ZGN4                  18     19  0
     D  ZGN5                  20     21  0
     D  ZGN6                  22     23  0
     D  ZGN7                  24     25  0
     D  ZGN8                  26     27  0
     D  ZREPB0                28     31  0
     D  ZREPC0                32     35  0
     D  ZREPD0                36     39  0
     D  ZREPE0                40     43  0
     D  ZREPF0                44     47  0
     D  ZREPG0                48     51  0
     D  ZREPH0                52     55  0
     D  ZREPI0                56     59  0
     D  ZREPC1                60     63  0
     D  ZREPD1                64     67  0
     D  ZREPE1                68     71  0
     D  ZREPF1                72     75  0
     D  ZREPG1                76     79  0
     D  ZREPH1                80     83  0
     D  ZREPI1                84     87  0
     D  ZREPD2                88     91  0
     D  ZREPE2                92     95  0
     D  ZREPF2                96     99  0
     D  ZREPG2               100    103  0
     D  ZREPH2               104    107  0
     D  ZREPI2               108    111  0
     D  ZREPE3               112    115  0
     D  ZREPF3               116    119  0
     D  ZREPG3               120    123  0
     D  ZREPH3               124    127  0
     D  ZREPI3               128    131  0
     D  ZREPF4               132    135  0
     D  ZREPG4               136    139  0
     D  ZREPH4               140    143  0
     D  ZREPI4               144    147  0
     D  ZREPG5               148    151  0
     D  ZREPH5               152    155  0
     D  ZREPI5               156    159  0
     D  ZREPH6               160    163  0
     D  ZREPI6               164    167  0
     D  ZREPI7               168    171  0
     IEDIMR
     I              MMN                         TVIMMN
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRC
     C                   EXSR      SRD
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  ALI GROUP:00                                       ALI00 /
      *////////////////////////////////////////////////////////////
     C     ALI00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EALI01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EALI01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      ALI
      *
     C     KEYMS0        READE     EALI01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  ALI GROUP:17                                       ALI17 /
      *////////////////////////////////////////////////////////////
     C     ALI17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EALI01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EALI01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      ALI
      *
     C     KEYMS2        READE     EALI01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CNT GROUP:00                                       CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ECNT01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNT01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      CNT
      *
     C     KEYMS0        READE     ECNT01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  COD GROUP:16                                       COD16 /
      *////////////////////////////////////////////////////////////
     C     COD16         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     16            ZGN3
     C     KEYMS3        SETLL     ECOD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ECOD01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      COD
     C                   Z-ADD     CREP0         ZREPE0
     C                   Z-ADD     CREP1         ZREPE1
     C                   Z-ADD     CREP2         ZREPE2
     C                   Z-ADD     CREP3         ZREPE3
     C                   EXSR      MEA16
     C                   EXSR      QTY16
     C                   EXSR      PCD16
      *
     C     KEYMS3        READE     ECOD01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  COM GROUP:04                                       COM04 /
      *////////////////////////////////////////////////////////////
     C     COM04         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     4             ZGN2
     C     KEYMS2        SETLL     ECOM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ECOM01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      COM
      *
     C     KEYMS2        READE     ECOM01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CPS GROUP:10                                       CPS10 /
      *////////////////////////////////////////////////////////////
     C     CPS10         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     10            ZGN0
     C     KEYMS0        SETLL     ECPS01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECPS01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      CPS
     C                   Z-ADD     CREP0         ZREPB0
     C                   EXSR      FTX10
     C                   EXSR      QVR10
     C                   EXSR      PAC11
     C                   EXSR      LIN17
      *
     C     KEYMS0        READE     ECPS01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:04                                       CTA04 /
      *////////////////////////////////////////////////////////////
     C     CTA04         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     4             ZGN1
     C     KEYMS1        SETLL     ECTA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ECTA01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      CTA
     C                   Z-ADD     CREP0         ZREPC0
     C                   Z-ADD     CREP1         ZREPC1
     C                   EXSR      COM04
      *
     C     KEYMS1        READE     ECTA01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CTA GROUP:18                                       CTA18 /
      *////////////////////////////////////////////////////////////
     C     CTA18         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     18            ZGN3
     C     KEYMS3        SETLL     ECTA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ECTA01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      CTA
      *
     C     KEYMS3        READE     ECTA01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  CUX GROUP:00                                       CUX00 /
      *////////////////////////////////////////////////////////////
     C     CUX00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ECUX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECUX01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      CUX
      *
     C     KEYMS0        READE     ECUX01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DGS GROUP:19                                       DGS19 /
      *////////////////////////////////////////////////////////////
     C     DGS19         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     19            ZGN2
     C     KEYMS2        SETLL     EDGS01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDGS01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DGS
     C                   Z-ADD     DREP0         ZREPD0
     C                   Z-ADD     DREP1         ZREPD1
     C                   Z-ADD     DREP2         ZREPD2
     C                   EXSR      QTY19
     C                   EXSR      FTX19
      *
     C     KEYMS2        READE     EDGS01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DLM GROUP:15                                       DLM15 /
      *////////////////////////////////////////////////////////////
     C     DLM15         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     15            ZGN4
     C     KEYMS4        SETLL     EDLM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EDLM01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      DLM
      *
     C     KEYMS4        READE     EDLM01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DLM GROUP:17                                       DLM17 /
      *////////////////////////////////////////////////////////////
     C     DLM17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EDLM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDLM01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DLM
      *
     C     KEYMS2        READE     EDLM01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DLM GROUP:23                                       DLM23 /
      *////////////////////////////////////////////////////////////
     C     DLM23         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     23            ZGN4
     C     KEYMS4        SETLL     EDLM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EDLM01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      DLM
      *
     C     KEYMS4        READE     EDLM01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:00                                       DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EDTM01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS0        READE     EDTM01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:01                                       DTM01 /
      *////////////////////////////////////////////////////////////
     C     DTM01         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     1             ZGN1
     C     KEYMS1        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS1        READE     EDTM01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:03                                       DTM03 /
      *////////////////////////////////////////////////////////////
     C     DTM03         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     3             ZGN2
     C     KEYMS2        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS2        READE     EDTM01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:07                                       DTM07 /
      *////////////////////////////////////////////////////////////
     C     DTM07         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     7             ZGN2
     C     KEYMS2        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS2        READE     EDTM01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:13                                       DTM13 /
      *////////////////////////////////////////////////////////////
     C     DTM13         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     13            ZGN3
     C     KEYMS3        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:14                                       DTM14 /
      *////////////////////////////////////////////////////////////
     C     DTM14         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     14            ZGN4
     C     KEYMS4        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EDTM01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS4        READE     EDTM01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:17                                       DTM17 /
      *////////////////////////////////////////////////////////////
     C     DTM17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS2        READE     EDTM01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:18                                       DTM18 /
      *////////////////////////////////////////////////////////////
     C     DTM18         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     18            ZGN3
     C     KEYMS3        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:20                                       DTM20 /
      *////////////////////////////////////////////////////////////
     C     DTM20         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     20            ZGN3
     C     KEYMS3        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:22                                       DTM22 /
      *////////////////////////////////////////////////////////////
     C     DTM22         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     22            ZGN3
     C     KEYMS3        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  DTM GROUP:25                                       DTM25 /
      *////////////////////////////////////////////////////////////
     C     DTM25         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     25            ZGN3
     C     KEYMS3        SETLL     EDTM01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EDTM01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      DTM
      *
     C     KEYMS3        READE     EDTM01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQA GROUP:08                                       EQA08 /
      *////////////////////////////////////////////////////////////
     C     EQA08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     EEQA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EEQA01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      EQA
      *
     C     KEYMS1        READE     EEQA01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  EQD GROUP:08                                       EQD08 /
      *////////////////////////////////////////////////////////////
     C     EQD08         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     8             ZGN0
     C     KEYMS0        SETLL     EEQD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EEQD01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      EQD
     C                   Z-ADD     EREP0         ZREPB0
     C                   EXSR      MEA08
     C                   EXSR      SEL08
     C                   EXSR      EQA08
     C                   EXSR      HAN09
      *
     C     KEYMS0        READE     EEQD01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:05                                       FTX05 /
      *////////////////////////////////////////////////////////////
     C     FTX05         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     5             ZGN1
     C     KEYMS1        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS1        READE     EFTX01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:09                                       FTX09 /
      *////////////////////////////////////////////////////////////
     C     FTX09         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     9             ZGN2
     C     KEYMS2        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EFTX01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS2        READE     EFTX01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:10                                       FTX10 /
      *////////////////////////////////////////////////////////////
     C     FTX10         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     10            ZGN1
     C     KEYMS1        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS1        READE     EFTX01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:12                                       FTX12 /
      *////////////////////////////////////////////////////////////
     C     FTX12         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     12            ZGN3
     C     KEYMS3        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS3        READE     EFTX01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:17                                       FTX17 /
      *////////////////////////////////////////////////////////////
     C     FTX17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EFTX01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS2        READE     EFTX01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:19                                       FTX19 /
      *////////////////////////////////////////////////////////////
     C     FTX19         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     19            ZGN3
     C     KEYMS3        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS3        READE     EFTX01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  FTX GROUP:24                                       FTX24 /
      *////////////////////////////////////////////////////////////
     C     FTX24         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     24            ZGN4
     C     KEYMS4        SETLL     EFTX01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EFTX01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      FTX
      *
     C     KEYMS4        READE     EFTX01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIN GROUP:15                                       GIN15 /
      *////////////////////////////////////////////////////////////
     C     GIN15         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     15            ZGN3
     C     KEYMS3        SETLL     EGIN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EGIN01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      GIN
     C                   Z-ADD     GREP0         ZREPE0
     C                   Z-ADD     GREP1         ZREPE1
     C                   Z-ADD     GREP2         ZREPE2
     C                   Z-ADD     GREP3         ZREPE3
     C                   EXSR      DLM15
      *
     C     KEYMS3        READE     EGIN01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIN GROUP:17                                       GIN17 /
      *////////////////////////////////////////////////////////////
     C     GIN17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EGIN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EGIN01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      GIN
      *
     C     KEYMS2        READE     EGIN01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIN GROUP:23                                       GIN23 /
      *////////////////////////////////////////////////////////////
     C     GIN23         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     23            ZGN3
     C     KEYMS3        SETLL     EGIN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EGIN01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      GIN
     C                   Z-ADD     GREP0         ZREPE0
     C                   Z-ADD     GREP1         ZREPE1
     C                   Z-ADD     GREP2         ZREPE2
     C                   Z-ADD     GREP3         ZREPE3
     C                   EXSR      DLM23
      *
     C     KEYMS3        READE     EGIN01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIN GROUP:24                                       GIN24 /
      *////////////////////////////////////////////////////////////
     C     GIN24         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     24            ZGN4
     C     KEYMS4        SETLL     EGIN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EGIN01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      GIN
      *
     C     KEYMS4        READE     EGIN01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIR GROUP:14                                       GIR14 /
      *////////////////////////////////////////////////////////////
     C     GIR14         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     14            ZGN3
     C     KEYMS3        SETLL     EGIR01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EGIR01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      GIR
     C                   Z-ADD     GREP0         ZREPE0
     C                   Z-ADD     GREP1         ZREPE1
     C                   Z-ADD     GREP2         ZREPE2
     C                   Z-ADD     GREP3         ZREPE3
     C                   EXSR      DTM14
      *
     C     KEYMS3        READE     EGIR01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  GIR GROUP:17                                       GIR17 /
      *////////////////////////////////////////////////////////////
     C     GIR17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EGIR01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EGIR01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      GIR
      *
     C     KEYMS2        READE     EGIR01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  HAN GROUP:09                                       HAN09 /
      *////////////////////////////////////////////////////////////
     C     HAN09         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     9             ZGN1
     C     KEYMS1        SETLL     EHAN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EHAN01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      HAN
     C                   Z-ADD     HREP0         ZREPC0
     C                   Z-ADD     HREP1         ZREPC1
     C                   EXSR      FTX09
      *
     C     KEYMS1        READE     EHAN01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  HAN GROUP:12                                       HAN12 /
      *////////////////////////////////////////////////////////////
     C     HAN12         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     12            ZGN2
     C     KEYMS2        SETLL     EHAN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EHAN01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      HAN
     C                   Z-ADD     HREP0         ZREPD0
     C                   Z-ADD     HREP1         ZREPD1
     C                   Z-ADD     HREP2         ZREPD2
     C                   EXSR      FTX12
      *
     C     KEYMS2        READE     EHAN01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  HAN GROUP:17                                       HAN17 /
      *////////////////////////////////////////////////////////////
     C     HAN17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EHAN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EHAN01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      HAN
      *
     C     KEYMS2        READE     EHAN01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  HAN GROUP:24                                       HAN24 /
      *////////////////////////////////////////////////////////////
     C     HAN24         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     24            ZGN3
     C     KEYMS3        SETLL     EHAN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EHAN01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      HAN
     C                   Z-ADD     HREP0         ZREPE0
     C                   Z-ADD     HREP1         ZREPE1
     C                   Z-ADD     HREP2         ZREPE2
     C                   Z-ADD     HREP3         ZREPE3
     C                   EXSR      FTX24
     C                   EXSR      GIN24
      *
     C     KEYMS3        READE     EHAN01B                                54
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  IMD GROUP:17                                       IMD17 /
      *////////////////////////////////////////////////////////////
     C     IMD17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EIMD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EIMD01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      IMD
      *
     C     KEYMS2        READE     EIMD01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LIN GROUP:17                                       LIN17 /
      *////////////////////////////////////////////////////////////
     C     LIN17         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     17            ZGN1
     C     KEYMS1        SETLL     ELIN01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELIN01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LIN
     C                   Z-ADD     LREP0         ZREPC0
     C                   Z-ADD     LREP1         ZREPC1
     C                   EXSR      PIA17
     C                   EXSR      IMD17
     C                   EXSR      MEA17
     C                   EXSR      QTY17
     C                   EXSR      ALI17
     C                   EXSR      GIN17
     C                   EXSR      GIR17
     C                   EXSR      DLM17
     C                   EXSR      DTM17
     C                   EXSR      NAD17
     C                   EXSR      TDT17
     C                   EXSR      TMD17
     C                   EXSR      HAN17
     C                   EXSR      FTX17
     C                   EXSR      MOA17
     C                   EXSR      RFF18
     C                   EXSR      DGS19
     C                   EXSR      LOC20
     C                   EXSR      SGP21
     C                   EXSR      PCI22
     C                   EXSR      QVR25
      *
     C     KEYMS1        READE     ELIN01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:02                                       LOC02 /
      *////////////////////////////////////////////////////////////
     C     LOC02         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     2             ZGN1
     C     KEYMS1        SETLL     ELOC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS1        READE     ELOC01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:05                                       LOC05 /
      *////////////////////////////////////////////////////////////
     C     LOC05         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     5             ZGN1
     C     KEYMS1        SETLL     ELOC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS1        READE     ELOC01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:07                                       LOC07 /
      *////////////////////////////////////////////////////////////
     C     LOC07         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     7             ZGN1
     C     KEYMS1        SETLL     ELOC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      LOC
     C                   Z-ADD     LREP0         ZREPC0
     C                   Z-ADD     LREP1         ZREPC1
     C                   EXSR      DTM07
      *
     C     KEYMS1        READE     ELOC01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:11                                       LOC11 /
      *////////////////////////////////////////////////////////////
     C     LOC11         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     11            ZGN2
     C     KEYMS2        SETLL     ELOC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      LOC
      *
     C     KEYMS2        READE     ELOC01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LOC GROUP:20                                       LOC20 /
      *////////////////////////////////////////////////////////////
     C     LOC20         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     20            ZGN2
     C     KEYMS2        SETLL     ELOC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      LOC
     C                   Z-ADD     LREP0         ZREPD0
     C                   Z-ADD     LREP1         ZREPD1
     C                   Z-ADD     LREP2         ZREPD2
     C                   EXSR      NAD20
     C                   EXSR      DTM20
     C                   EXSR      QTY20
      *
     C     KEYMS2        READE     ELOC01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:00                                       MEA00 /
      *////////////////////////////////////////////////////////////
     C     MEA00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EMEA01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS0        READE     EMEA01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:08                                       MEA08 /
      *////////////////////////////////////////////////////////////
     C     MEA08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMEA01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS1        READE     EMEA01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:11                                       MEA11 /
      *////////////////////////////////////////////////////////////
     C     MEA11         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     11            ZGN2
     C     KEYMS2        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMEA01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS2        READE     EMEA01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:16                                       MEA16 /
      *////////////////////////////////////////////////////////////
     C     MEA16         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     16            ZGN4
     C     KEYMS4        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EMEA01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS4        READE     EMEA01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:17                                       MEA17 /
      *////////////////////////////////////////////////////////////
     C     MEA17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMEA01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS2        READE     EMEA01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MEA GROUP:22                                       MEA22 /
      *////////////////////////////////////////////////////////////
     C     MEA22         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     22            ZGN3
     C     KEYMS3        SETLL     EMEA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EMEA01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      MEA
      *
     C     KEYMS3        READE     EMEA01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MOA GROUP:00                                       MOA00 /
      *////////////////////////////////////////////////////////////
     C     MOA00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EMOA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EMOA01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      MOA
      *
     C     KEYMS0        READE     EMOA01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  MOA GROUP:17                                       MOA17 /
      *////////////////////////////////////////////////////////////
     C     MOA17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EMOA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMOA01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      MOA
      *
     C     KEYMS2        READE     EMOA01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:02                                       NAD02 /
      *////////////////////////////////////////////////////////////
     C     NAD02         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     2             ZGN0
     C     KEYMS0        SETLL     ENAD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ENAD01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      NAD
     C                   Z-ADD     NREP0         ZREPB0
     C                   EXSR      LOC02
     C                   EXSR      RFF03
     C                   EXSR      CTA04
      *
     C     KEYMS0        READE     ENAD01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:17                                       NAD17 /
      *////////////////////////////////////////////////////////////
     C     NAD17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     ENAD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ENAD01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      NAD
      *
     C     KEYMS2        READE     ENAD01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:18                                       NAD18 /
      *////////////////////////////////////////////////////////////
     C     NAD18         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     18            ZGN3
     C     KEYMS3        SETLL     ENAD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ENAD01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      NAD
      *
     C     KEYMS3        READE     ENAD01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  NAD GROUP:20                                       NAD20 /
      *////////////////////////////////////////////////////////////
     C     NAD20         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     20            ZGN3
     C     KEYMS3        SETLL     ENAD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ENAD01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      NAD
      *
     C     KEYMS3        READE     ENAD01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PAC GROUP:11                                       PAC11 /
      *////////////////////////////////////////////////////////////
     C     PAC11         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     11            ZGN1
     C     KEYMS1        SETLL     EPAC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EPAC01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      PAC
     C                   Z-ADD     PREP0         ZREPC0
     C                   Z-ADD     PREP1         ZREPC1
     C                   EXSR      MEA11
     C                   EXSR      QTY11
     C                   EXSR      HAN12
     C                   EXSR      PCI13
      *
     C     KEYMS1        READE     EPAC01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PAC GROUP:17                                       PAC17 /
      *////////////////////////////////////////////////////////////
     C     PAC17         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     15            ZGN3
     C     KEYMS3        SETLL     EPAC01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EPAC01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      PAC
     C                   Z-ADD     PREP0         ZREPE0
     C                   Z-ADD     PREP1         ZREPE1
     C                   Z-ADD     PREP2         ZREPE2
     C                   Z-ADD     PREP3         ZREPE3
     C                   EXSR      GIN17
     C                   EXSR      DTM17
      *
     C     KEYMS3        READE     EPAC01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCD GROUP:06                                       PCD06 /
      *////////////////////////////////////////////////////////////
     C     PCD06         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     6             ZGN1
     C     KEYMS1        SETLL     EPCD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EPCD01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      PCD
      *
     C     KEYMS1        READE     EPCD01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCD GROUP:16                                       PCD16 /
      *////////////////////////////////////////////////////////////
     C     PCD16         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     16            ZGN4
     C     KEYMS4        SETLL     EPCD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EPCD01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      PCD
      *
     C     KEYMS4        READE     EPCD01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCI GROUP:13                                       PCI13 /
      *////////////////////////////////////////////////////////////
     C     PCI13         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     13            ZGN2
     C     KEYMS2        SETLL     EPCI01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPCI01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      PCI
     C                   Z-ADD     PREP0         ZREPD0
     C                   Z-ADD     PREP1         ZREPD1
     C                   Z-ADD     PREP2         ZREPD2
     C                   EXSR      RFF13
     C                   EXSR      DTM13
     C                   EXSR      GIR14
     C                   EXSR      GIN15
     C                   EXSR      COD16
      *
     C     KEYMS2        READE     EPCI01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PCI GROUP:22                                       PCI22 /
      *////////////////////////////////////////////////////////////
     C     PCI22         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     22            ZGN2
     C     KEYMS2        SETLL     EPCI01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPCI01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      PCI
     C                   Z-ADD     PREP0         ZREPD0
     C                   Z-ADD     PREP1         ZREPD1
     C                   Z-ADD     PREP2         ZREPD2
     C                   EXSR      DTM22
     C                   EXSR      MEA22
     C                   EXSR      QTY22
     C                   EXSR      GIN23
     C                   EXSR      HAN24
      *
     C     KEYMS2        READE     EPCI01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  PIA GROUP:17                                       PIA17 /
      *////////////////////////////////////////////////////////////
     C     PIA17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EPIA01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EPIA01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      PIA
      *
     C     KEYMS2        READE     EPIA01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:11                                       QTY11 /
      *////////////////////////////////////////////////////////////
     C     QTY11         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     11            ZGN2
     C     KEYMS2        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EQTY01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS2        READE     EQTY01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:16                                       QTY16 /
      *////////////////////////////////////////////////////////////
     C     QTY16         BEGSR
     C                   MOVE      '0'           *IN55
     C                   Z-ADD     16            ZGN4
     C     KEYMS4        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS4        READE     EQTY01B                                55
     C     *IN55         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS4        READE     EQTY01B                                55
     C  N55              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:17                                       QTY17 /
      *////////////////////////////////////////////////////////////
     C     QTY17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EQTY01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS2        READE     EQTY01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:19                                       QTY19 /
      *////////////////////////////////////////////////////////////
     C     QTY19         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     19            ZGN3
     C     KEYMS3        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EQTY01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS3        READE     EQTY01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:20                                       QTY20 /
      *////////////////////////////////////////////////////////////
     C     QTY20         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     20            ZGN3
     C     KEYMS3        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EQTY01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS3        READE     EQTY01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:21                                       QTY21 /
      *////////////////////////////////////////////////////////////
     C     QTY21         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     21            ZGN3
     C     KEYMS3        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EQTY01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS3        READE     EQTY01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QTY GROUP:22                                       QTY22 /
      *////////////////////////////////////////////////////////////
     C     QTY22         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     22            ZGN3
     C     KEYMS3        SETLL     EQTY01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EQTY01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      QTY
      *
     C     KEYMS3        READE     EQTY01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QVR GROUP:10                                       QVR10 /
      *////////////////////////////////////////////////////////////
     C     QVR10         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     10            ZGN1
     C     KEYMS1        SETLL     EQVR01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EQVR01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      QVR
      *
     C     KEYMS1        READE     EQVR01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  QVR GROUP:25                                       QVR25 /
      *////////////////////////////////////////////////////////////
     C     QVR25         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     25            ZGN2
     C     KEYMS2        SETLL     EQVR01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EQVR01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      QVR
     C                   Z-ADD     QREP0         ZREPD0
     C                   Z-ADD     QREP1         ZREPD1
     C                   Z-ADD     QREP2         ZREPD2
     C                   EXSR      DTM25
      *
     C     KEYMS2        READE     EQVR01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:01                                       RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     1             ZGN0
     C     KEYMS0        SETLL     ERFF01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ERFF01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPB0
     C                   EXSR      DTM01
      *
     C     KEYMS0        READE     ERFF01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:03                                       RFF03 /
      *////////////////////////////////////////////////////////////
     C     RFF03         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     3             ZGN1
     C     KEYMS1        SETLL     ERFF01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPC0
     C                   Z-ADD     RREP1         ZREPC1
     C                   EXSR      DTM03
      *
     C     KEYMS1        READE     ERFF01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:13                                       RFF13 /
      *////////////////////////////////////////////////////////////
     C     RFF13         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     13            ZGN3
     C     KEYMS3        SETLL     ERFF01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     ERFF01B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   EXSR      RFF
      *
     C     KEYMS1        READE     ERFF01B                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  RFF GROUP:18                                       RFF18 /
      *////////////////////////////////////////////////////////////
     C     RFF18         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     16            ZGN2
     C     KEYMS2        SETLL     ERFF01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ERFF01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      RFF
     C                   Z-ADD     RREP0         ZREPD0
     C                   Z-ADD     RREP1         ZREPD1
     C                   Z-ADD     RREP2         ZREPD2
     C                   EXSR      NAD18
     C                   EXSR      CTA18
     C                   EXSR      DTM18
      *
     C     KEYMS2        READE     ERFF01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SEL GROUP:08                                       SEL08 /
      *////////////////////////////////////////////////////////////
     C     SEL08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     ESEL01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ESEL01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      SEL
      *
     C     KEYMS1        READE     ESEL01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  SGP GROUP:21                                       SGP21 /
      *////////////////////////////////////////////////////////////
     C     SGP21         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     21            ZGN2
     C     KEYMS2        SETLL     ESGP01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ESGP01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      SGP
     C                   Z-ADD     SREP0         ZREPD0
     C                   Z-ADD     SREP1         ZREPD1
     C                   Z-ADD     SREP2         ZREPD2
     C                   EXSR      QTY21
      *
     C     KEYMS2        READE     ESGP01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *__________________
      * Define workfields
      *""""""""""""""""""
     C     *LIKE         DEFINE    SSN           WSN
     C     *LIKE         DEFINE    S0036         W0036
     C     *LIKE         DEFINE    JCLFE         WCLFE
     C                   MOVE      *BLANKS       WCLFE
     C     *LIKE         DEFINE    MST           WST
     C                   MOVE      '+'           WST
     C     *LIKE         DEFINE    MVEN          WVEN
     C                   MOVE      *BLANKS       WVEN
     C     *LIKE         DEFINE    UIN           WUIN
     C     *LIKE         DEFINE    INNETW        WNNETW
     C     *LIKE         DEFINE    SSR           WSR
     C                   MOVE      'S'           WSR
     C                   MOVE      '0'           ECFLAG            1
     C                   MOVE      *BLANKS       W0004            35
     C                   MOVE      *BLANKS       W0010            35
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   Z-ADD     0             W0074             6 0
     C                   Z-ADD     0             AX                2 0
     C                   Z-ADD     1             BX                2 0
     C                   Z-ADD     0             AXV               2 0
     C                   Z-ADD     0             AXH               2 0
     C                   MOVE      'R'           WDIR              1
     C                   MOVE      *BLANKS       WCHAR             1
     C                   MOVE      'Y'           WCHART            1
     C                   MOVE      *BLANKS       WCONT             5
     C                   BITON     '123457'      WAPSTR            1
     C                   BITOFF    '06'          WAPSTR
     C                   MOVE      '0'           *IN39
     C                   MOVE      '1'           *IN32
     C     *LIKE         DEFINE    UMN           ZMN
      *____________
      * Define keys
      *""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    WSN
     C     KEYUNB        KLIST
     C                   KFLD                    WUIN
     C     KEYUNH        KLIST
     C                   KFLD                    WUMN
     C     KEYB          KLIST
     C                   KFLD                    SSR
     C                   KFLD                    WST
     C                   KFLD                    WVEN
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    S0035
     C     KEYC          KLIST
     C                   KFLD                    S0004
     C                   KFLD                    S0010
     C                   KFLD                    WCLFE
     C     KEYMS0        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
     C     KEYMS3        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN3
     C                   KFLD                    ZREPD0
     C                   KFLD                    ZREPD1
     C                   KFLD                    ZREPD2
     C     KEYMS4        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN4
     C                   KFLD                    ZREPE0
     C                   KFLD                    ZREPE1
     C                   KFLD                    ZREPE2
     C                   KFLD                    ZREPE3
     C     KEYMS5        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN5
     C                   KFLD                    ZREPF0
     C                   KFLD                    ZREPF1
     C                   KFLD                    ZREPF2
     C                   KFLD                    ZREPF3
     C                   KFLD                    ZREPF4
     C     KEYMS6        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN6
     C                   KFLD                    ZREPG0
     C                   KFLD                    ZREPG1
     C                   KFLD                    ZREPG2
     C                   KFLD                    ZREPG3
     C                   KFLD                    ZREPG4
     C                   KFLD                    ZREPG5
     C     KEYMS7        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN7
     C                   KFLD                    ZREPH0
     C                   KFLD                    ZREPH1
     C                   KFLD                    ZREPH2
     C                   KFLD                    ZREPH3
     C                   KFLD                    ZREPH4
     C                   KFLD                    ZREPH5
     C                   KFLD                    ZREPH6
     C     KEYMS8        KLIST
     C                   KFLD                    WUMN
     C                   KFLD                    ZGN8
     C                   KFLD                    ZREPI0
     C                   KFLD                    ZREPI1
     C                   KFLD                    ZREPI2
     C                   KFLD                    ZREPI3
     C                   KFLD                    ZREPI4
     C                   KFLD                    ZREPI5
     C                   KFLD                    ZREPI6
     C                   KFLD                    ZREPI7
     C     KEYMSG        KLIST
     C                   KFLD                    WSR
     C                   KFLD                    U0065
     C                   KFLD                    U0054
     C                   KFLD                    M0010
     C                   KFLD                    M0004
      *__________________________
      * Retreive System Date/Time
      *""""""""""""""""""""""""""
     C                   TIME                    WTIME
     C                   Z-ADD     WÅÅ           WÅ
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
      *_________________
      * Input parameters
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C     WSN           PARM                    WSN
     C                   Z-ADD     WSN           WUIN
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start of file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      *___________________________________
      * Get data from interchange log file
      *"""""""""""""""""""""""""""""""""""
     C     KEYA          CHAIN     EDIS                               81
     C     KEYUNB        CHAIN     EUNB                               81
     C                   Z-ADD     0             W0036
     C                   MOVEL     U0004         W0004
     C                   MOVEL     U0010         W0010
     C     W0010         CHAIN     EDII                               20
     C                   MOVEL     INNETW        WNNETW
      *_________________
      * Move member name
      *"""""""""""""""""
     C                   EVAL      SEMBR=SMBR
     C                   SELECT
      *___________________
      * Create JCL for NIT
      *"""""""""""""""""""
     C     WNNETW        WHENEQ    '1'
      *
     C                   MOVE      'F'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   ENDSL
      *________________
      * Add UNB-segment
      *""""""""""""""""
     C                   EXSR      UNB
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Read message log                                     SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR
     C     KEYB          CHAIN     EDIMC                              8182
     C                   Z-ADD     TVIMMN        WUMN
     C     *IN81         DOWEQ     '0'
     C  N81
     CANN82KEYUNH        CHAIN     EUNH                               8384
     C     *IN83         IFEQ      '0'
     C     M0065         ANDEQ     'DESADV'
     C                   Z-ADD     SSN           MSN
     C                   MOVE      'A'           MST
     C                   Z-ADD     WDT           MDT
     C                   Z-ADD     WTM           MTM
     C                   ADD       1             W0036
     C                   EXSR      SRCA
     C                   Z-ADD     WUIN          UIN
     C                   UPDATE    EDIMR
     C                   UPDATE    UNHR
      * Oppslag i ECMSG for å se om det skal sendes en og en melding
      * eller akumuleres opp på vanlig måte.
     C     ECFLAG        IFEQ      '0'
     C     KEYMSG        CHAIN     ECMSG1                             90
     C     *IN90         IFEQ      *ON
     C                   MOVE      *BLANK        ECSEND
     C                   ENDIF
     C                   MOVE      '1'           ECFLAG
      * Forlater løkken hvis det skal sendes en og en melding.
     C     ECSEND        IFNE      *BLANKS
     C                   LEAVE
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDIF
     C     KEYB          READE     EDIMC                                8281
     C                   Z-ADD     TVIMMN        WUMN
     C  N81              END
     C                   ENDSR
      */////////////////////////////////////////////////////////////
      * Add segments                                           SRCA
      */////////////////////////////////////////////////////////////
     C     SRCA          BEGSR
     C                   EXSR      UNH
     C                   EXSR      BGM
      *
     C                   EXSR      DTM00
     C                   EXSR      ALI00
     C                   EXSR      MEA00
     C                   EXSR      MOA00
     C                   EXSR      CUX00
     C                   EXSR      RFF01
     C                   EXSR      NAD02
     C                   EXSR      TOD05
     C                   EXSR      TDT06
     C                   EXSR      EQD08
     C                   EXSR      CPS10
     C                   EXSR      CNT00
      *
     C                   EXSR      UNT
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  End of interchange                                   SRD /
      *////////////////////////////////////////////////////////////
     C     SRD           BEGSR
     C                   Z-ADD     W0036         S0036
     C                   MOVE      W0036         U0036
      *____________________
      * Interchange trailer
      *""""""""""""""""""""
     C                   EXSR      UNZ
      *____________________________
      * Update interchange log file
      *""""""""""""""""""""""""""""
     C                   MOVE      'A'           SST
     C                   UPDATE    EDISR
     C                   UPDATE    UNBR
      *___________________
      * Create JCL for NIT
      *"""""""""""""""""""
     C     WNNETW        IFEQ      '1'
     C                   MOVE      'E'           WCLFE
     C     KEYC          CHAIN     EDIJ2                              81
     C     *IN81         DOWEQ     '0'
     C                   MOVE      JCLC          SDATA
     C                   WRITE     EDISER
     C     KEYC          READE     EDIJ2                                  81
     C  N81              END
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify numerical fields                        SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * MOve correct value into Alfa 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'
     C                   MOVE      ØA152H        ØA12
     C                   ELSE
     C                   MOVEL     ØA152X        ØA12
     C                   MOVE      ',  '         ØA12
     C                   MOVE      ØA152D        ØA12
     C                   END
      * Scan from left and find first num over 0
     C     1             DO        11            ØX
     C     Ø12(ØX)       IFNE      '0'
     C                   GOTO      SRNE1
     C                   END
     C                   END
     C     SRNE1         TAG
      * Leftjustify to a new field
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left              SRÅ
      *////////////////////////////////////////////////////////////
     C     SRÅ           BEGSR
      *_______________
      * Find positions
      *""""""""""""""""
      * Find first non-0 position
     C     WDIR          IFEQ      'L'
     C     AXV           DO        AXH           AXV
     C     A(AXV)        COMP      '0'                                  8383
     C   83              END
      * Find last non-blank position                                     I
     C                   ELSE
      *                                                                  I
     C     SRÅ01         TAG
      *                                                                  I
     C     AXH           IFGT      AXV
     C     A(AXH)        IFEQ      *BLANKS
     C                   SUB       1             AXH
     C                   GOTO      SRÅ01
     C                   END
     C                   END
     C                   END
     C                   MOVE      'R'           WDIR
      *________________________________________________
      * Read input string and place it in output string
      *""""""""""""""""""""""""""""""""""""""""""""""""
     C     AXV           DO        AXH           AXV
     C                   MOVE      A(AXV)        WCHAR
      * If invalid character (' + : ?) then replace with 'Ø'             I
     C     WCHART        IFEQ      'Y'
     C     WDIR          IFEQ      'R'
     C     WCHAR         IFEQ      ';'
     C                   MOVE      ':'           WCHAR
     C                   ENDIF
     C     WCHAR         COMP      WAPSTR                                 83
     C  N83WCHAR         COMP      '+'                                    83
     C  N83WCHAR         COMP      ':'                                    83
     C  N83WCHAR         COMP      '?'                                    83
     C   83              EXSR      SRÅA
     C                   END
     C                   END
      * Convert character                                                I
     C     WCHAR         LOOKUP    TABA          TABB                     83
     C     *IN83         IFEQ      '1'
     C                   MOVE      TABB          WCHAR
     C                   ENDIF
      * Move to output string                                            I
     C                   MOVE      WCHAR         B(BX)
     C                   ADD       1             BX
      * If arrayindex for output array is over 80 Then add a record      I
     C     BX            IFGT      80
     C                   MOVEA     B             SDATA
     C                   WRITE     EDISER
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       B
     C                   END
      *                                                                  I
     C                   END
      *
     C                   MOVE      'Y'           WCHART
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR for replace control characters                      SRÅA
      *////////////////////////////////////////////////////////////
     C     SRÅA          BEGSR
      * Move '?' before the character
     C                   MOVE      '?'           B(BX)
     C                   ADD       1             BX
     C     BX            IFGT      80
     C                   MOVEA     B             SDATA
     C                   WRITE     EDISER
     C                   Z-ADD     1             BX
     C                   MOVE      *BLANKS       B
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TDT GROUP:06                                       TDT06 /
      *////////////////////////////////////////////////////////////
     C     TDT06         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     6             ZGN0
     C     KEYMS0        SETLL     ETDT01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETDT01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      TDT
     C                   Z-ADD     TREP0         ZREPB0
     C                   EXSR      PCD06
     C                   EXSR      TMD06
     C                   EXSR      LOC07
      *
     C     KEYMS0        READE     ETDT01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TDT GROUP:17                                       TDT17 /
      *////////////////////////////////////////////////////////////
     C     TDT17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     ETDT01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETDT01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TDT
      *
     C     KEYMS2        READE     ETDT01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TMD GROUP:06                                       TMD06 /
      *////////////////////////////////////////////////////////////
     C     TMD06         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     6             ZGN1
     C     KEYMS1        SETLL     ETMD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETMD01B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   EXSR      TMD
      *
     C     KEYMS1        READE     ETMD01B                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TMD GROUP:17                                       TMD17 /
      *////////////////////////////////////////////////////////////
     C     TMD17         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     17            ZGN2
     C     KEYMS2        SETLL     ETMD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ETMD01B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   EXSR      TMD
      *
     C     KEYMS2        READE     ETMD01B                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  TOD GROUP:05                                       TOD05 /
      *////////////////////////////////////////////////////////////
     C     TOD05         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     5             ZGN0
     C     KEYMS0        SETLL     ETOD01B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETOD01B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      TOD
     C                   Z-ADD     TREP0         ZREPB0
     C                   EXSR      LOC05
     C                   EXSR      FTX05
      *
     C     KEYMS0        READE     ETOD01B                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      /COPY QEDSRC,BGM_O_01B
      /COPY QEDSRC,ALI_O_01B
      /COPY QEDSRC,CNT_O_01B
      /COPY QEDSRC,COD_O_01B
      /COPY QEDSRC,COM_O_01B
      /COPY QEDSRC,CPS_O_01B
      /COPY QEDSRC,CTA_O_01B
      /COPY QEDSRC,CUX_O_01B
      /COPY QEDSRC,DGS_O_01B
      /COPY QEDSRC,DLM_O_01B
      /COPY QEDSRC,DTM_O_01B
      /COPY QEDSRC,EQA_O_01B
      /COPY QEDSRC,EQD_O_01B
      /COPY QEDSRC,FTX_O_01B
      /COPY QEDSRC,GIN_O_01B
      /COPY QEDSRC,GIR_O_01B
      /COPY QEDSRC,HAN_O_01B
      /COPY QEDSRC,IMD_O_01B
      /COPY QEDSRC,LIN_O_01B
      /COPY QEDSRC,LOC_O_01B
      /COPY QEDSRC,MEA_O_01B
      /COPY QEDSRC,MOA_O_01B
      /COPY QEDSRC,NAD_O_01B
      /COPY QEDSRC,PAC_O_01B
      /COPY QEDSRC,PCD_O_01B
      /COPY QEDSRC,PCI_O_01B
      /COPY QEDSRC,PIA_O_01B
      /COPY QEDSRC,QTY_O_01B
      /COPY QEDSRC,QVR_O_01B
      /COPY QEDSRC,RFF_O_01B
      /COPY QEDSRC,SEL_O_01B
      /COPY QEDSRC,SGP_O_01B
      /COPY QEDSRC,TDT_O_01B
      /COPY QEDSRC,TMD_O_01B
      /COPY QEDSRC,TOD_O_01B
      /COPY QEDSRC,UNB_O
      /COPY QEDSRC,UNH_O
      /COPY QEDSRC,UNT_O
      /COPY QEDSRC,UNZ_O
** TABA/TABB
ÅA
øO
ÆE
ØO
aA
bB
cC
dD
eE
fF
gG
hH
iI
jJ
kK
lL
mM
nN
oO
pP
qQ
rR
sS
tT
uU
vV
wW
xX
yY
zZ
æE
åA
