********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Behandle Interne/eksterne KolliIDs, Original/Kopi likt
10XXX * 02 JOV PTF10 Kolli XX AV YY,Nå EN streng(mer enn 99 ok) SRNE1 /SRCENT benytytte ikke
10179 * 03 jov PTF10 Print fra oppdrag/innland(dokuf mangler) hent send-nr fra HEADF
10179 * 04 jov PTF10 DIGIT / SIGN I DFPNLS
      *%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 05 JOV PTF11 IKKE forsøk å chaine DOKUF mm når layout er HZ - booking Z-filer
10XXX * 06 JOV PTF11 halvfabrikata - merke ufortollet gods DERSOM....
10XXX * 07 JOV PTF11 ta hensyn til evt avvikende adresse i CMR     ..
      *%%%%%%%%%
10XXX * 08 SH  PTF12 kun 1 lapp  parameter klid
10XXX * 09 JOV PTF12 Alvorlig feil ved type HZ=web booking (sg2 m/varelinjer)
10XXX * 10 JOV PTF12 Endring PTF 08 - loop gjennom  alle for å ta vare på xx av yy
10XXX * 11 SH  PTF12 fjerne oppdatering ved kopi
10XXX * 12 JOV PTF12 liten tekstjiustering - PTF06
********************************************************************
      *
     H FTRANS
     FDOKUF     IF   E           K DISK
     FDOKUFE    IF   E           K DISK
N07  FDOKEC     IF   E           K DISK
N07  FCUNDL01   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FFIRFB     UF   E           K DISK
     FDOKUFM    UF A E           K DISK
     FZOKUFM1   UF A E           K DISK
     F                                     RENAME(dokufmr:zokufmr)
     FZEADL02   UF   E           K DISK
     F                                     RENAME(headfr:zeadfr)
     FKODFRI    IF   E           K DISK
     FFRISOK    IF A E           K DISK
     FZRISOL01  IF A E           K DISK
     F                                     RENAME(frisokr:zrisokr)
     FGSSORF    IF   E           K DISK
     FGSSORL21  IF   E           K DISK
     F                                     RENAME(gssorfr:gssorf21R)
     FGSSPOF    IF   E           K DISK
     FGSSRFF    IF   E           K DISK
     FVADR      IF   E           K DISK
     FGSSOLF    UF   E           K DISK
     FKODTLK    IF   E           K DISK
     FZBARC     O    F  132        PRINTER OFLIND(*INOF)
     F                                     USROPN
S02  D*A4              S              1    DIM(4)                               Input string
S02  D*B4              S              1    DIM(4)                               Output string
S02  D*Æ               S              1    DIM(20)                              Input string
S02  D*Å               S              1    DIM(20)                              Output string
     D                 DS
     D  DATA                   1    132
     D  DATA1                  4    132
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS            10
     D BBOX1           C                   CONST('720,160,80')
     D SENDTXT         C                   CONST('Sendings-ID/Consignment')
     D KOLIDTXT        C                   CONST('Kolli-ID/Licence plate')
     D TRANTXT         C                   CONST('Transportør/Carrier')
     D PRODTXT         C                   CONST('Produkt/Product')
     D*BARPAR          C                   CONST('N,220,N,N,Y,N')
     D BARPAR          C                   CONST('N,250,N,N,Y,N')
     D                 DS
S02   *
      * Gør om antall kolli
S02  D* LANUMA                 1      4  0
S02  D*                DS
S02  D* ØN151                  1     15  1
S02  D* ØA151H                 1     14
S02  D* ØA151X                 5     14
S02  D* ØA151D                15     15
S02  D*                DS
S02  D* ØA12                   1     12
S02  D* Ø12                    1     12
S02  D*                                    DIM(12)                              Num edit
     D                 DS
     D  WRK                    1      4  0
     D                 DS
     D  WPCN                   1      4  0
     D  WPCA                   1      4
     D  WPCB                   2      4
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
     D                 DS
     D  WS1004                 1     35
     D  WSSNDA                 1      2
     D  WSSNDB                 3      7
     D  WSSNDC                 8     17
     D  WSSNDI                 1     17
     D                 DS
     D  OpprDs                 1     17
     D  OpprTx                 1      3
     D  TRAVD0                 4      7  0
     D  OpprSt1                8      8
     D  TROPD0                 9     15  0
     D                 DS
     D                 DS
     D  DF1004                 1     35
     D  DF1004A               17     17
     D  DF100416               1     16
     D                 DS
     D  KOID                   1     18
     D  DSIDPK                 1      1
     D  DSIDLA                 2      3
     D  DSIDLE                 4      8
     D  DSIDNR                 9     18
      * Norsk GS1-nr skal være (00+) 18 lang - 18 blank eller 19 ikke blank er FEIL
     D                 DS
     D  FMMRK1                 1     35
     D    FMMRK18_18          18     18
     D    FMMRK19_19          19     19
     D                 DS
     D  KLKNVN                 1     30
     D  DsLkNr                28     30
     D                 DS
     D  WTIME                  1     14  0
     D  WTID                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D  WTIDA                  1      2
     D  WTIDB                  3      4
     D  WDDA                   7      8
     D  WMMA                   9     10
     D  WÅÅA                  11     14
      * Input Parameter
     C     *ENTRY        PLIST
     C                   PARM                    WFIRM             2
     C                   PARM                    WMLAYO            2
     C                   PARM                    WFAVD
     C                   PARM                    WFOPD
     C                   PARM                    WFFBNR
     C                   PARM                    uukopi            1
N08  C                   PARM                    uklid            35
      * 77 ON = FRA WEB-LØSNING, SKAL SKRIVES UT VIA HTML
      * WW - ordinært knyttet til gitt fraktbrev, W2=Frie lapper..
     C     WMLAYO        COMP      'WW'                                   77
     C  N77WMLAYO        COMP      'W2'                                   77
     C  N77WMLAYO        COMP      'HZ'                                   77
      * Open Printerfile
     C                   OPEN      ZBARC                                55
     C                   MOVE      'N'           EXTRA             1
      * Execute init routine only once
     C                   EXSR      SRINIT
      * Juster ALT xx dots til venstre (60 dots er ca 1 cm til venstre)
      * (Forenkler kundetilpasning)
     C                   MOVE      '0  '         LSDOTS            3
      *
     C     WMLAYO        IFNE      'W2'
N05  C     WMLAYO        Ifne      'HZ'
     C     DOKKEY        CHAIN     DOKUF                              55
     c                   move      *blanks       TLFnr            15
     C     DOKUFEKEY     CHAIN     DOKUFE                             33
     c     *in33         ifeq      '0'
     c                   movel     FE_C3148D     TLFnr                          Sms
     c     TLFnr         ifeq      *blanks
     c                   movel     FE_C3148B     TLFnr                          Mob
     c                   end
     c     TLFnr         ifeq      *blanks
     c                   movel     FE_C3148A     TLFnr                          tlf
     c                   end
     c                   end
     C     HEAKEY        CHAIN     HEADF                              33
     C                   MOVE      ' '           EXPORT            1
     c     HEUR          ifeq      'B'
     c     HEUR          oreq      'D'
     C                   MOVE      'J'           EXPORT
     C                   ENDIF
     c     heur          IFEQ      'H'
     C     HETRI         ANDNE     'NO'
     C                   MOVE      'J'           EXPORT
     C                   ENDIF
      * DERSOM DUP AV.. hent evt Gnr/turnr/oppr.avsender fra "moroppdrag"
     C                   Move      *BLANKS       DUAavs           25
     C                   Move      *BLANKS       DUAGn            15
     C                   Move      *Blanks       DUATur            8
     C     *in33         IFEQ      *OFF
     C     TROPD0        andne     *zeros
     C     DUAKEY        CHAIN     HEADF                              33
     C     *in33         IFEQ      *OFF
     C                   Move      HENAS         DUAavs
     C                   Move      HEGN          DUAGn
     C     Hepro         ifne      *zeros
     C                   Move      HEPRO         DUATur
     C                   end
     C                   end
     C     HEAKEY        CHAIN     HEADF                              33
     C                   end
N05  C                   endif
      * Basert på headf eller ZEADF - fyll DF..-variable med HE..-data
     c     WMLAYO        IFeq      'HE'
     c     WMLAYO        OREQ      'HZ'
     c                   EXSR      GetHead
     c                   end
S10  c*    uklid         ifeq      *blanks
     C                   EXSR      SRINKOID
S10  C*                  end
     c                   else
     C* KODE W2 - "Løse lapper" knyttet til skipssystem ("på fabrikk")
     C     WFOPD         CHAIN     GSSORF                             55
     C                   Z-ADD     ORCLI         DFNTLA
     C                   MOVEL     ORSNM         DFNAVS
     C                   MOVEL     ORBCD         DFNAVM
      * Kolli-ID som skal benyttes finnes alt i GSSOLF
     c                   end
      * EDI ventekode telle som utlev.forbehold
     c     DFVEN         Ifne      ' '
     c     HEFT1A        ifeq      *blanks                                      Ikke utlev.forb.h.
     c     HEKFT1        orne      *blanks                                      eller er utkvittert
     c                   eval      HEFT1a='Ventekode '
     c                             +DFVEN+' på fr.br'
     c                   eval      HEKFT1=' '
     c                   endif
     c                   endif
      *
n06  C                   move      'N'           UFORTOLLET        1
n06  C*                  if        %subst(HENAS:1:5)='KUEHN'
n06  C*                  move      'J'           UFORTOLLET
n06  C*                  endif
      *
      * Loop number of pieces
s10  c*    uklid         IFNE      *BLANKS
s10  C*                  Z-ADD     1             dfntla
s10  C*                  END
     C                   Z-ADD     1             WPCN
     C     WPCN          DO        DFNTLA        WPCN
      *
      * Execute Label Init
S10   * flyttet lenger ned (slik at det ikke utføres ved goto NextID)
s10   * Send Default Instructions  (flyttet fra sr0001/sr0001K)
s10  C*                  MOVE      *BLANKS       DATA
s10  C*                  MOVEL     DFLT          DATA
s10  C*                  EXCEPT    ZBARCA
s10   * Start of Text bit (^XA)
s10  C*                  MOVE      *BLANKS       DATA
s10  C*                  MOVEL     WXA           DATA
s10  C*                  EXCEPT    ZBARCA
      *
     C     WMLAYO        IFNE      'W2'
      * sjekk alltid først om en eksisterende Kll-id skal gjenbrukes
      * (SR0001K kaller SR0001 hvis  NY id skal tildeles)
     c                   EXSR      SR0001K
N10  c                   if        uklid <> *blanks and
N10  c                             KOID <> uklid
N10  c                   goto      NextID
N10  c                   endif
     c                   end
N10   * Send Default Instructions  (flyttet fra sr0001/sr0001K)
N10  C                   MOVE      *BLANKS       DATA
N10  C                   MOVEL     DFLT          DATA
N10  C                   EXCEPT    ZBARCA
N10   * Start of Text bit (^XA)
N10  C                   MOVE      *BLANKS       DATA
N10  C                   MOVEL     WXA           DATA
N10  C                   EXCEPT    ZBARCA
      * Execute Label top Text
     C                   EXSR      SR0010
      * Execute Label Lines vert/hor
     C                   EXSR      SR0005
      * Execute Shipper Name/address 1
     C                   EXSR      SR0080
      * Execute Shipper Name/address 2
     C     DFAD1S        IFNE      *BLANKS
     C                   EXSR      SR0090
     C                   ENDIF
      * Execute Shipper Name/address 4
     C     DFAD3S        IFNE      *BLANKS
     C                   EXSR      SR0105
     C                   ENDIF
      * Execute Consignee Name/address 1
     C                   EXSR      SR0110
     C     wmlayo        Ifne      'W2'
      * Execute Consignee Name/address 2
     C                   EXSR      SR0120
      * Execute Consignee Name/address 3
     C                   EXSR      SR0125
      * Execute Pieces in Consignment
     C     EXTRA         IFEQ      'N'
     C                   EXSR      SR0050
     C                   end
      * Strekkode - Sendingsnr EAN 128
     C                   EXSR      SR0190
     c                   end
      * Strekkode - til postnummer
     C                   EXSR      SR0040
      * Strekkode - Kolliid
     C                   EXSR      SR0290
      * Execute End Label Format
     C                   EXSR      SREND
      * KUTTER SPOOLFILE I MAX 10 LABELS (MEN IKKE VED WEB..)
     C     *IN77         IFEQ      *OFF
     C     WPCN          DIV       10            XWPCN             3 0
     C                   MVR                     XWPCN
     C                   IF        XWPCN = 0
     C                   CLOSE     ZBARC                                55
     C                   OPEN      ZBARC                                55
     C                   END
     C                   END
      *
N10  C     NextID        tag
     C                   ENDDO
      * Close Prinerfile
     C                   CLOSE     ZBARC                                55
      * End Program
     C                   seton                                        LR
     C                   RETURN
      *_____________________________________________________
      * Hent data fra HEADF / ZEADF
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     GetHead       BEGSR
     C     WMlayo        IFEQ      'HZ'
      * Heunik = 9 lang.
     c                   Movel     WFAVD         TMP11            11
     c                   Move      WFOPD         TMP11
     c                   Move      Tmp11         HEUNIK
     C     HEUNIK        CHAIN     ZEADL02                            33
     C     *in33         ifeq      '0'
     c                   move      'P'           HEPK3
     C                   update    zeadfr
     c                   end
     c                   end
      * merkelapper lagres på fraktbrev 1
     c                   z-add     1             DFFBNR
      *
     c                   MOVE      ' '           DFST
     c                   select
     c     heur          wheneq    'B'
     c                   MOVE      'U'           DFST
     c     heur          wheneq    'H'
     C     HETRI         IFNE      'NO'
     c                   MOVE      'U'           DFST
     c                   end
     c                   endsl
N07   * export / CMR finnes - evt avvikende lev.adresse derfra
N07  C     HEAKEY        CHAIN     DOKEC                              33
N07  C     *in33         ifeq      *off
N07  C     FfKey         CHAIN     CUNDL01                            33        Fraktfører = transp
N07  C  N33              movel     KNAVN         CMRTRAN          30
N07  C     DCNAL         ifne      *blanks
N07  c                   move      DCNAL         HENAK
N07  c                   move      DCADL1        HEADK1
N07  c                   move      DCADL2        HEADK2
N07  c                   move      DCADL3        HEADK3
N07  C                   endif
N07  C                   endif
      * Flytt HE-felt inn i DF felt..
     C                   MOVE      'F'           DFRI
     C                   MOVE      HEavd         DFavd
     C                   MOVE      HEopd         DFopd
     C                   MOVE      HESG          DFSG
     C                   MOVEL     HENAS         DFNAVS
     C                   MOVEL     HEADS1        DFAD1S
     C                   MOVEL     HEADS2        DFAD2S
S04  C*                  MOVEL     HEADS3        DFPNLS
N04  C                   MOVEL     HEADS3        TMPPUL            4
N04  C                   TESTN                   TMPPUL               34
N04  C     *IN34         IFEQ      '1'
N04  C                   MOVE      TMPPUL        DFPNLS
N04  C                   end
     C                   MOVE      HEADS3        DFAD3S25         25
     C                   MOVEL     DFAD3s25      DFAD3S
     C                   MOVEL     HENAK         DFNAVM
     C                   MOVEL     HEADK1        DFAD1M
     C                   MOVEL     HEADK2        DFAD2M
     C                   MOVEL     HEADK3        DFAD3M
     C     DFST          IFEQ      'U'
      * scan finner første blank for å skille Postnr /sted
     C                   MOVE      HETRI         DFLKM
     C                   MOVE      HETRI         DFLKL
     C     ' '           SCAN      HEADK3        pos               2 0    33
     c     pos           ifgt      3
     c     pos           andlt     10
     C                   EVAL      DFPNUM      = %SUBST(HEADK3:1:pos-1)
     C                   EVAL      DFAD3M      = %SUBST(HEADK3:pos+1)
     C                   MOVE      DFPNUM        DFPNUL
     C                   end
     C                   else
     C                   MOVE      *ZEROS        DFPOUL                          UTL.POSTNR
     C                   MOVEL     HEADK3        TMPPUL            4
     C                   TESTN                   TMPPUL               34
     C     *IN34         IFEQ      '1'
     C                   MOVE      TMPPUL        DFPOUL                          UTL.POSTNR
     C                   end
     C                   end
     C                   Z-ADD     HENT          DFNTLA
     C                   Z-ADD     HENT          DFNT
     C                   MOVEL     HEGM1         DFGM
     C                   MOVEL     HEGM2         DFGM2
      * sendingsnr - hent fra FRISOK - finnes ikke / skap...
     c     wmlayo        IFEQ      'HZ'
      * På ZEADF
     c     HEUNIK        setll     Zrisol01
     c     HEUNIK        Reade     Zrisol01                               33
     c     *in33         doweq     '0'
     c     FSKODE        IFEQ      'IFB'
     c                   movel     FSSOK         DF1004
     c                   goto      FbnrOK
     c                   end
     c     HEUNIK        Reade     Zrisol01                               33
     c                   end
     c                   else
      * På HEADF
N03   * innland..
N03  c                   IF        Heur='H' and HXSNDN<>*blanks
N03  c                   IF        %subst(HXSNDN:20:1)<>*blanks
N03  c                   eval      DF1004= %subst(HXSNDN:4:17)
N03  c                   else
N03  c                   eval      DF1004=HXSNDN
N03  c                   endif
N03  c                   goto      FbnrOK
N03  c                   endif
     C     FRISOKKEY     CHAIN     FRISOK                             33
     c     *IN33         IFEQ      '0'
     c                   movel     FSSOK         DF1004
     c                   goto      FbnrOK
     c                   end
     c                   end
      * Fant ikke nummer - tildel..
      * TAR HENSYN KUN TIL EAN...
     C     WFIRM         CHAIN     FIRFB                              33
     C     *IN33         IFEQ      '0'
     C     FIRECN        IFNE      *ZEROS
     C                   ADD       1             FIRECN
     C                   MOVE      FISNLA        WSSNDA
     C                   MOVE      FISNLE        WSSNDB
     C                   MOVEL     FIRECN        WSSNDC
     C                   END
     C                   UPDATE    FIRFBR
     C                   MOVE      *ZEROS        UAN22            22
     C                   MOVE      WSSNDI        UAN22
     C                   CALL      'SYGE08'
     C                   PARM                    UAN22
     C                   MOVE      UAN22         WSSNDI
     C                   MOVEL     WS1004        DF1004
     C                   END
      *
     c                   move      HEAVD         FSAVD
     c                   move      HEOPD         FSOPD
     c                   move      'IFB'         FSKODE
     C                   MOVEL     DF1004        FSSOK
     c                   move      HEDTOP        FSDTOP
     c                   move      *BLANKS       FSDOKK
     C     FSKODE        CHAIN     KODFRI                             33
     c                   IF        *IN33
     c                   MOVE      *BLANKS       FSDOKK
     c                   ELSE
     c                   MOVE      KFSODK        FSDOKK
     c                   END
     c     wmlayo        IFEQ      'HZ'
     c                   move      HEUNIK        FSUNIK
     c                   move      HEREFF        FSREFF
     C                   write     ZRISOKR
     C                   else
     C                   write     FRISOKR
     C                   end
      *
     c     FbnrOK        tag
      *
     C                   endsr
      *_____________________________________________________
      * Execute Label Init
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      *
     C                   MOVE      *ZEROS        FMLONR
     C                   MOVE      *BLANKS       KOID
      * Hent kolli-id
     C     WFIRM         CHAIN     FIRFB                              33
     C                   ADD       1             FIIDNR
     C                   UPDATE    FIRFBR
     C                   MOVE      '3'           DSIDPK
     C                   MOVE      FIIDLA        DSIDLA
     C                   MOVE      FIIDLE        DSIDLE
     C                   MOVEL     FIIDNR        DSIDNR
     C                   MOVE      *ZEROS        UAN22            22
     C                   MOVE      KOID          UAN22
     C                   CALL      'SYGE08'
     C                   PARM                    UAN22
     C                   MOVE      UAN22         KOID
     C                   ADD       1             FMMKNR
     C                   eval      FMMRK1    =   KOID
     C                   MOVE      'I'           FMST
     C                   clear                   FMITER
     C                   clear                   FMUTER
     C                   clear                   FMLEVE
     C                   clear                   FMLEDI
     C                   clear                   FMVKT
     C                   clear                   FMVOL
     C                   clear                   FMLM
     C                   clear                   FMLEN
     C                   clear                   FMBRD
     C                   clear                   FMHOY
     C                   clear                   FMPAID
     C                   clear                   FMITDT
     C                   clear                   FMITTM
     C                   clear                   FMITUS
     C                   clear                   FMUTDT
     C                   clear                   FMUTTM
     C                   clear                   FMUTUS
     C                   clear                   FMPODT
     C                   clear                   FMPOTM
     C                   clear                   FMPOUS
     C     WMLAYO        IFNE      'HZ'
     C                   WRITE     DOKUFMR
     C                   ELSE
     C                   MOVE      HEUNIK        FMUNIK
     C                   MOVE      HEREFF        FMREFF
     C                   WRITE     ZOKUFMR
     C                   END
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Label Init copyprint
      ********************************************************
     C     SR0001K       BEGSR
      ********************************************************
      * SJEKK OM GAMMEL KOLLI ID NR XX (WPCN) FINNES SOM SKAL GJENBRUKES
      *
      ** Les og finn intern/ekstern med løpenr som samsvarer xx AV Tot
n09   ** (fra web booking - alltid tildel nye)
     C                   MOVE      *BLANKS       KOID
n09  c     wmlayo        IFNE      'HZ'
     c                   move      *zeros        LnrIE             4 0
     c                   move      *zeros        FMMKNR
s10  c*    uklid         ifne      *blanks
s10  c*                  movel     uklid         koid
s10  c*                  z-add     1             LnrIE
s10  c*                  z-add     1             DFNTLA
s10  c*                  else
     C     DOKUFMKEY     SETLL     DOKUFM
     C     DOKUFMKEY     READE(N)  DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C     FMST          ifeq      'I'
     C     FMST          oreq      'E'
     c                   add       1             LnrIE
     c     LnrIE         ifeq      wpcn
     C                   MOVEL     FMMRK1        KOID
     C                   endif
     C                   endif
     C     DOKUFMKEY     READE(N)  DOKUFM                                 33
     C                   END
N09  C                   endif
      * Hvis ikke finner kolliid på posisjonen HENT NY (FØRSTE KJØRING ELLER ANTALL ØKT..)
     C     KOID          IFEQ      *blanks
     C                   exsr      sr0001
     C                   ENDIF
S10  C*                  ENDIF
     C                   ENDSR
      *____________________________________________________
      * Execute Label Lines Hor/Vert
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0005        BEGSR
      * First  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,150'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Second horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '1,345'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Third  horiz. line
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '1,640'       DATA1
     C                   MOVEL     '1,632'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Line to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WGB           DATA
     C                   MOVEL     '650,0,6'     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Label top Text
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C     LSDOTS        IFNE      '0  '
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     LSDOTS        DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      * Transportørnavn - Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,360'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     TRANTXT       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Transportørnavn - data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,380'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAT         DATA1
     C     EXPORT        IFEQ      'J'
N07  c                   if        CMRTRAN <> *blanks
N07  c                   eval      Data1 =%trim(Data1)+CMRTRAN
N07  c                   else
     c                   eval      Data1 =%trim(Data1)+' (Henting)'
N07  c                   endif
     c                   ENDIF
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Utlev.forbehold??  - REV IMAGE(må lage svart box først) på tvers ute til høyre
     C     HEFT1A        IFNE      *blanks                                       UTLforbehold
     C     HEKFT1        ANDEQ     *blanks                                       IKKE KVITTE
      * svart box:GBw,h,t(width,hight,thick(thick mer enn 1/2 av lengste dim w/h=helsvart))
      *                  (kan også sette en dim=0 og bruke kun thicknes for å definere svart boks)
     C                   eval      Data = '^FO657,50^GB0,575,82^FS'
     C                   EXCEPT    ZBARCA
      * ^Afo,h,w' f=font(0=scalable),o=orienN=norm,R=90%(I=180/B=270),w=height,w=width
     C                   eval      Data = '^FO660,60^A0R,75,75'                  FO=x/y A0=font h,w
     C                             + '^FR^FD'+%trim(HEFT1A)+'^FS'
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Tollpass?? - Data
      * (WW-ships-system/WEB,basert på en "trip" = ett oppdrag f.brev.)
      * (W2-ships-system/WEB,basert på en EN PO = "løse Kolli-merkel)
     C     wmlayo        Ifne      'WW'
     C     wmlayo        AndNe     'W2'
      * Tollpass?? - Data
     C     DFTOLL        IFNE      *ZEROS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '400,380'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'TOLLPASS!'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      * Produktkode
     C     DFPROK        IFNE      *BLANKS
     C                   MOVEL     DFPROK        WFKOD
     C     KOKEY         CHAIN     KOFAST                             56
     C     *IN56         IFEQ      *OFF
      *
     C     DFPROK        IFEQ      'TG91 '
     C                   exsr      EXPRESS10
     C                   end
      * ved Mypack skrives PRODOKT   bak transportør
     c     DFPROK        ifne      'TG9M'
      * Produktkode - Ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,420'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     PRODTXT       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * Produktkode - Data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,440'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KFTXT         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA

     c                   else
      * Produktkode - Data  - MYPACK skrives bak transportør
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,380'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KFTXT         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     c                   endif
     C                   ENDIF
     C                   ENDIF
     c* Ufortollet gods ...
N06  C     UFORTOLLET    IFEQ      'J'
N06   * Data Position
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFO           DATA
N06  C                   MOVEL     '18,380'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Font
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WA0           DATA
N06  C                   MOVEL     ',64,75'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Text to be printed
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFD           DATA
N06  C                   EVAL      DATA1 = 'UFORTOLLET GODS!'
N06  C                   EXCEPT    ZBARCA
N06   * Field Separator instruction (^FS)
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFS           DATA
N06  C                   EXCEPT    ZBARCA
N06   * Data Position
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFO           DATA
N06  C                   MOVEL     '18,435'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Font
N06  C                   MOVE      *BLANKS       DATA
n06  C                   MOVEL     WA0           DATA
n06  C                   MOVEL     ',30,35'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Text to be printed
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFD           DATA
N06  C                   EVAL      DATA1='Må ikke disponeres før fortolling'
s12  C*                  EVAL      DATA1=%tRIM(DATA1)+' foreligger,'
N12  C                                  +' foreligger,'
N06  C                   EXCEPT    ZBARCA
N06   * Field Separator instruction (^FS)
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFS           DATA
N06  C                   EXCEPT    ZBARCA
N06   * Data Position
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFO           DATA
N06  C                   MOVEL     '18,462'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Font
N06  C                   MOVE      *BLANKS       DATA
n06  C                   MOVEL     WA0           DATA
n06  C                   MOVEL     ',30,35'      DATA1
N06  C                   EXCEPT    ZBARCA
N06   * Text to be printed
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFD           DATA
s12  C*                  EVAL      DATA1='jf tollforskriften § 4-30-11'
N12  C                   EVAL      DATA1='jf Tollforskriften § 4-30-11(1)'
N06  C                   EXCEPT    ZBARCA
N06   * Field Separator instruction (^FS)
N06  C                   MOVE      *BLANKS       DATA
N06  C                   MOVEL     WFS           DATA
N06  C                   EXCEPT    ZBARCA
N06  C                   ENDIF
N06   *
N06   *
      *Godsmerking - ledetekst
     C     DFGM          IFNE      *BLANKS
     C     DFGM          ANDNE     'ADR'
     C     DFGM          ANDNE     'ADRESSE'
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,500'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Merke/Marks' DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Godsmerking - data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,500'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     DFGM          DATA1
     C     DATA1         CAT       DFGM2:1       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      *  Fra WEB - shipssystem . PO-nbr. + Post code + Area Code
     C                   else
     C                   EXSR      GetNextSS
     c     AntSS         IFNE      *ZEROS
     C                   EXSR      PRTNextSS
     c                   end
     C                   end
      *
     C     wmlayo        Ifne      'W2'
     C     wmlayo        IFne      'HZ'
      * ved Mypack skrives PROD bak transp.  og midtfeltet brukes for mottaker
     c     DFPROK        ifeq      'TG9M'
     c                   exsr      MYPMott
     c                   end
      * Senders ref. -ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,540'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Senders ref' DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Senders ref. -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,540'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFOPD         AOPD              7
     C                   MOVEL     DFFBNR        AFBNR             3
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     DFAVD         DATA1
     C     DATA1         CAT       '/':1         DATA1
     C     DATA1         CAT       AOPD:1        DATA1
     C     DATA1         CAT       '/':1         DATA1
     C     DATA1         CAT       AFBNR:1       DATA1
     C     DATA1         CAT       '/':1         DATA1
     C     DATA1         CAT       DFSG:1        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   end
      * Data Position - A-ref
     C     HERFA         IFNE      *BLANKS
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,520'     DATA1
     C                   EXCEPT    ZBARCA
      * Fon
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'A-ref'       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * A-ref. -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,540'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     HERFA         DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      * Evt peker til bestillende oppdrag VED DUP
     C     TRopd0        IFNE      *zeros
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,570'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   movel     OpprDS        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   end
      *
     C                   END
      *
     C                   ENDSR
      *_____________________________________________________
      * Merk ekspress10 i høyre hjørne
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     express10     BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '470,60'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',60,60'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'EXPRESS10'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *_____________________________________________________
      * Execute Pieces in Consignment
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0050        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '18,580'      DATA1
     C                   MOVEL     '18,600'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Kolli'       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - kollinummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,580'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
S02   *
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFD           DATA
S02  C*                  Z-ADD     WPCN          LANUMA
S02  C*                  MOVE      LANUMA        CHAR4             4
S02  C*                  MOVEA     CHAR4         A4
S02  C*                  Z-ADD     1             X                 1 0
S02  C*                  Z-ADD     1             Y                 1 0
S02  C*                  MOVEA     *BLANKS       B4
S02  C*    A4(X)         DOWEQ     '0'
S02  C*    X             ANDLT     4
S02  C*                  ADD       1             X
S02  C*                  ENDDO
S02  C*    X             DOWLE     4
S02  C*                  MOVEA     A4(X)         B4(Y)
S02  C*                  ADD       1             X
S02  C*                  ADD       1             Y
S02  C*                  ENDDO
S02  C*                  MOVEA     B4            DATA1
S02  C*                  MOVEA     B4            B4FELT            4
S02  C*                  MOVE      *BLANKS       DATA1
S02  C*                  MOVEL     B4FELT        DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Field Separator instruction (^FS)
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFS           DATA
S02  C*                  EXCEPT    ZBARCA
S02   * Tekst - av
S02   * Data Position
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFO           DATA
S02  C*                  MOVEL     '280,580'     DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Font
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WA0           DATA
S02  C*                  MOVEL     ',64,75'      DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Text
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFD           DATA
S02  C*                  MOVE      *BLANKS       DATA1
S02  C*                  MOVEL     'AV'          DATA1
S02  C*                  MOVE      '.'           DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Field Separator instruction (^FS)
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFS           DATA
S02  C*                  EXCEPT    ZBARCA
S02   * Variabel - Tot. ant. kolli
S02   * Data Position
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFO           DATA
S02  C*                  MOVEL     '370,580'     DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Font
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WA0           DATA
S02  C*                  MOVEL     ',64,75'      DATA1
S02  C*                  EXCEPT    ZBARCA
S02   * Text
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFD           DATA
S02  C*                  Z-ADD     DFNTLA        LANUMA
S02  C*                  MOVE      LANUMA        CHAR4             4
S02  C*                  MOVEA     CHAR4         A4
S02  C*                  Z-ADD     1             X                 1 0
S02  C*                  Z-ADD     1             Y                 1 0
S02  C*                  MOVEA     *BLANKS       B4
S02  C*    A4(X)         DOWEQ     '0'
S02  C*    X             ANDLT     4
S02  C*                  ADD       1             X
S02  C*                  ENDDO
S02  C*    X             DOWLE     4
S02  C*                  MOVEA     A4(X)         B4(Y)
S02  C*                  ADD       1             X
S02  C*                  ADD       1             Y
S02  C*                  ENDDO
S02  C*                  MOVEA     B4            B4FELT            4
S02  C*                  MOVE      *BLANKS       DATA1
S02  C*                  MOVEL     B4FELT        DATA1
N02  C                   MOVE      *BLANKS       DATA
N02  C                   MOVEL     WFD           DATA
N02  C                   eval      DATA1 = %trim(%editc(WPCN:'Z'))
N02  c                             +' AV '+%trim(%editc(DFNTLA:'Z'))
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0080        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,40'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Fra/from'    DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA

      * Ledetekst - 2
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '300,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Utskr. dato' DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Dato - klokkeslett
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '450,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     WDDA          DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WMMA:0        DATA1
     C     DATA1         CAT       '/':0         DATA1
     C     DATA1         CAT       WÅÅA:0        DATA1
     C     DATA1         CAT       WTIDA:2       DATA1
     C     DATA1         CAT       ':':0         DATA1
     C     DATA1         CAT       WTIDB:0       DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      **
      * Senders Navn
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,60'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAVS        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Tollpass?? - Data
     C     DFTOLL        IFNE      *ZEROS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '400,60'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'TOLLPASS!'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0090        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,90'       DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFAD1S        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Shipper Name/address 4
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0105        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,120'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',30,35'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFPNLS        DATA1
     C     DATA1         CAT       DFAD3S:1      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Opprinnelig avs (v Dup av...)
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRDUA         BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '420,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   eval      DATA1='Oppr. avsender'
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '420,60'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAVS        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Tollpass?? - Data
     C     DFTOLL        IFNE      *ZEROS
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '400,60'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',64,75'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'TOLLPASS!'   DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDIF
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 1
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0110        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,170'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,190'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C     DFNAVL        IFNE      *BLANKS
     C     EXPORT        ANDNE     'J'
     C                   MOVEL     DFNAVL        DATA1
     C                   ELSE
     C                   MOVEL     DFNAVM        DATA1
     C                   ENDIF
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 2
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0120        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,240'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C     DFST          IFEQ      'U'
     C     DFST          OREQ      'V'
     C                   MOVEL     ',35,40'      DATA1
     C                   END
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C     DFNAVL        IFNE      *BLANKS
     C     EXPORT        ANDNE     'J'
     C                   MOVEL     DFAD1L        DATA1
     C                   ELSE
     C                   MOVEL     DFAD1M        DATA1
     C                   ENDIF
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Execute Consignee Name/address 3
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0125        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,290'      DATA1
     C     DFST          IFEQ      'U'
     C     DFST          OREQ      'V'
     C                   MOVEL     '18,270'      DATA1
     C                   END
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',50,50'      DATA1
     C     DFST          IFEQ      'U'
     C     DFST          OREQ      'V'
     C                   MOVEL     ',35,40'      DATA1
     C                   END
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C     DFNAVL        IFNE      *BLANKS
     C     EXPORT        ANDNE     'J'
     C                   MOVEL     DFPOUL        XXAD3L           35
     C                   MOVE      DFADUL        XXAD3L
     C                   MOVEL     XXAD3L        DATA1
     C                   ELSE
     C                   MOVEL     DFAD3M        DATA1
     C                   ENDIF
      * VED UTENLANDSK. ER  3.LINJA ADRESSE 2
     C     DFST          IFEQ      'U'
     C     DFST          OREQ      'V'
     C     DFNAVL        IFNE      *BLANKS
     C                   MOVEL     DFAD2L        DATA1
     C                   ELSE
     C                   MOVEL     DFAD2M        DATA1
     C                   END
     C                   END
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * VED UTENLANDSK. ER DET 4 LINJER. 4 LINJ = POSTNR STED LK
     C     DFST          IFEQ      'U'
     C     DFST          OREQ      'V'
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,310'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',35,40'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C     DFNAVL        IFNE      *BLANKS
     C     DFPNUL        CAT       DFADUL:1      DATA1
     C                   CAT       DFLKL:2       DATA1
     C                   ELSE
     C     DFPNUM        CAT       DFAD3M:1      DATA1
     C                   CAT       DFLKM:2       DATA1
     C                   ENDIF
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
     C                   ENDSR
      *____________________________________________________
      * Strekkode SEND.NR
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0190        BEGSR
      * Send.nr ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '18,660'      DATA1
     C                   MOVEL     '18,640'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     SENDTXT       DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Send.nr data
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '70,680'      DATA1
     C                   MOVEL     '70,660'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE  (1 parameter er bredde)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>8401'     DATA1
     C     DATA1         CAT       DF1004:0      DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,915'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(401)'       DATA1
     C     DATA1         CAT       DF1004:0      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *_____________________________________________________
      * Til postnummer
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0040        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '18,965'      DATA1
     C                   MOVEL     '18,945'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Til/to'      DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Print Destination Code
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C*                  MOVEL     '70,985'      DATA1
     C                   MOVEL     '70,962'      DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   MOVE      DFPOUL        XXPOUL            4
     C                   move      *blanks       xxlkpn           12
     C                   Eval      XXLKPN = '578'+XXPOUL
     C     DFLKL         IFNE      *blanks
     c     LKKEY         Chain     KODTLK                             33
     c     *in33         Ifeq      *off
     c     DsLKnr        ANDGE     '000'
     c     DsLKnr        ANDLE     '999'
     C                   Eval      XXLKPN = DsLKnr+DFPNUL
     c                   end
     c                   end
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>8421'     DATA1
     C     DATA1         CAT       XXLKPN:0      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1215'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed (421)= internasj. nr / 578= Norge
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   Eval      DATA1 = '(421)'+XXLKPN
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *____________________________________________________
      * Strekkode KOLLI ID
      *""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0290        BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,1250'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     KOLIDTXT      DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      *DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '70,1267'     DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE SIZE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WBY           DATA
     C                   MOVEL     '4,2:1,20'    DATA1
     C                   EXCEPT    ZBARCA
      *BARCODE
     C                   MOVE      *BLANKS       DATA
     C*                  MOVEL     WB2           DATA
     C                   MOVEL     WBC           DATA
     C                   MOVEL     BARPAR        DATA1
     C                   EXCEPT    ZBARCA
      * xxxxxxxxxxxxxxr instruction (^FR)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFR           DATA
     C                   EXCEPT    ZBARCA
      *DATA TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '>;>800'      DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   EXCEPT    ZBARCA
      *END OF TEXT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Skriv underteksten manuelt for editeringskontroll
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '80,1520'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',40,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     '(00)'        DATA1
     C     DATA1         CAT       KOID:0        DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
S02   *
S02   *_____________________________________________________
S02   * Leftjustify num.fields
S02   *"""""""""""""""""""""""""""""""""""""""""""""""""""""
S02  C*    SRNE1         BEGSR
S02   * Move correct value into alpha 12-field
S02  C*                  MOVE      *ZEROS        ØA12
S02  C*    ØA151D        IFEQ      '0'                                          <-------------I
S02  C*    ØADEC         ANDEQ     'N'                                          <-------------I
S02  C*                  MOVE      ØA151H        ØA12                                         I
S02  C*                  ELSE                                                   <-------------I
S02  C*                  MOVEL     ØA151X        ØA12                                         I
S02  C*                  MOVE      '. '          ØA12                                         I
S02  C*                  MOVE      ØA151D        ØA12                                         I
S02  C*                  END                                                    <-------------I
S02   * search from left and find first sign over 0
S02  C*    1             DO        11            ØX                             <-------------I
S02  C*    Ø12(ØX)       IFNE      '0'                                           <-----------II
S02  C*                  LEAVE                                                               II
S02  C*                  END                                                     <-----------II
S02  C*                  END                                                    <-------------I
S02   * Leftjustify to a new field
S02  C*                  MOVE      *BLANKS       ØAN
S02  C*                  MOVEA     Ø12(ØX)       ØAN
S02   * Reset decimal indicator
S02  C*                  MOVE      'N'           ØADEC
S02   *
S02  C*                  ENDSR
S02   *_____________________________________________________
S02   * Center text
S02   *"""""""""""""""""""""""""""""""""""""""""""""""""""""
S02  C*    SRCENT        BEGSR
S02  C*                  MOVEA     *BLANKS       Å
S02   * Find rightmost character of input
S02  C*    SRB1          TAG
S02  C*    ÆX            CABEQ     0             CENT99
S02  C*    Æ(ÆX)         IFEQ      *BLANKS
S02  C*                  SUB       1             ÆX
S02  C*                  GOTO      SRB1
S02  C*                  ENDIF
S02   * Sub from the rightmost counter
S02   * This is only valid if formtype A0 us used because blank
S02   * caracters uses less space in grafic mode.
S02  C*    DATA3         IFEQ      '^A0'
S02  C*                  SELECT
S02  C*    ÆX            WHENLT    19
S02  C*    ÆX            ANDGE     15
S02  C*                  SUB       2             ÆX
S02  C*    ÆX            WHENLT    14
S02  C*    ÆX            ANDGE     10
S02  C*                  SUB       4             ÆX
S02  C*    ÆX            WHENLT    9
S02  C*    ÆX            ANDGE     5
S02  C*                  SUB       6             ÆX
S02  C*    ÆX            WHENLT    4
S02  C*                  SUB       8             ÆX
S02  C*                  ENDSL
S02  C*                  ENDIF
S02   * Calculate left positions of output
S02  C*    18            SUB       ÆX            ÆX
S02  C*    ÆX            IFGE      2
S02  C*    ÆX            DIV       2             ÆX
S02  C*                  ADD       1             ÆX
S02  C*                  ELSE
S02  C*                  Z-ADD     1             ÆX
S02  C*                  ENDIF
S02   * Move input to output arrary
S02  C*                  MOVEA     Æ             Å(ÆX)
S02   *
S02  C*    CENT99        ENDSR
      *_____________________________________________________
      * Initialise subroutine, set character set
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WB3               3            B3
     C                   MOVE      'B3'          WB3               3            B3
      *
     C                   MOVEL     WA            WBC               3            B2
     C                   MOVE      'BC'          WBC               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WFR               3            FR
     C                   MOVE      'FR'          WFR               3            FR
      *
     C                   MOVEL     WA            WLS               3            XZ
     C                   MOVE      'LS'          WLS               3            XZ
      *
     C                   Z-ADD     0             ØX                3 0          Index for Ø
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   MOVE      'N'           ØADEC             1            Decimal Indicator
     C                   Z-ADD     0             ÆX                3 0
      * Define workfields
     C     *LIKE         DEFINE    DFRI          WFRI
     C     *LIKE         DEFINE    DFAVD         WFAVD
     C     *LIKE         DEFINE    DFOPD         WFOPD
     C     *LIKE         DEFINE    DFFBNR        WFFBNR
     C     *LIKE         DEFINE    KFTYP         WFTYP
     C     *LIKE         DEFINE    KFKOD         WFKOD
     C                   MOVEL     'F'           WFRI
     C                   MOVEL     'FRBREVPRO'   WFTYP
     C     DOKKEY        KLIST
     C                   KFLD                    WFRI
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C                   KFLD                    WFFBNR
     C     DOKUFEKEY     KLIST
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C                   KFLD                    WFFBNR
     C                   KFLD                    WE_N3035
     C     *LIKE         DEFINE    FE_N3035      WE_N3035
     C                   EVAL      WE_N3035='CN '
     C     KOKEY         KLIST
     C                   KFLD                    WFTYP
     C                   KFLD                    WFKOD
     C     LKKEY         KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    DFLKL
     C                   MOVEL     'LK '         KLKUNI
     C     DOKUFMKEY     KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C     DOKUFMKE2     KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     c                   KFLD                    FMMKNR
     C     HEAKEY        KLIST
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C     DUAKEY        KLIST
     C                   KFLD                    TRAVD0
     C                   KFLD                    TROPD0
     C     FRISOKKEY     KLIST
     C                   KFLD                    WFAVD
     C                   KFLD                    WFOPD
     C                   KFLD                    XXSOK
     C                   move      'IFB'         XXSOK             3
     C     GSSOLKey      KLIST
     C                   KFLD                    ORONO
     C                   KFLD                    OLLNO
     C     VadrKey       KLIST
     C                   KFLD                    WFIRM
     C                   KFLD                    ORCNO
     C                   KFLD                    VADRNR
N07  C     FFKEY         KLIST
N07  C                   KFLD                    WFIRM
N07  C                   KFLD                    DCKNFF
     C     WMLAYO        IFEQ      'WW'
     C                   MOVEL     WFAVD         TRIP
     C                   MOVE      WFOPD         TRIP             11 0
     C     TRIP          SETLL     GSSORL21
     C                   END
      *
      * Opprinnelse - i DFBref
     C                   MOVEL     'Op:'         OpprTx
     C                   MOVE      *zeros        TRAVD0
     C                   MOVEL     '/'           OpprSt1
     C                   MOVE      *zeros        TROPD0
      *
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to INIT Colli_ID handling
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINKOID      BEGSR
      * Sjekk evt tidligere tildelte kolli-IDs
     C                   MOVE      DFRI          FMRI
     C                   MOVE      DFAVD         FMAVD
     C                   MOVE      DFOPD         FMOPD
     C                   MOVE      DFFBNR        FMFBNR
     C                   MOVE      *ZEROS        FMLINR
      * MERK UGYLDIGE,(ELLER ANTALL HØYERE ENN FRAKTBREVETS..) MED =O=ORIGINAL
     c                   move      *zeros        LnrIE             4 0
      *
     c     wmlayo        IFNE      'HZ'
     C     DOKUFMKEY     SETLL     DOKUFM
     C     DOKUFMKEY     READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
      * feil format ??
     C     FMST          ifeq      'E'
     C     FMMRK18_18    ifeq      ' '
     C     FMMRK19_19    orne      ' '
     C                   move      'O'           FMST                           O=Original/Ompakket
     c                   endif
     c                   endif
      * for mange kolli-IDs finnes (antall er redusert i fraktbrevet)
     C     FMST          IFEQ      'E'
     C     FMST          OREQ      'I'
     C                   ADD       1             LnrIE
     C     LNRIE         ifgt      DFNTLA
N11  C     uklid         andeq     *blanks
     C                   move      'O'           FMST                           O=Original/Ompakket
     c                   endif
     C                   ENDIF
     C                   UPDATE    DOKUFMR
     C     DOKUFMKEY     READE     DOKUFM                                 33
     C                   END
      *
     C                   else
      * Type HZ = fra WEB oppdragsbooking (slett/tildel nye alltid...)
N09   * etter at webbooking fikk varelinjer kan det også ligge vanlig godsmerke i ZOKUFM
N09   * a) IKKE slett godsmerke b) reinitier KEYs
     C     HEUNIK        SETLL     ZOKUFM1
     C     HEUNIK        READE     ZOKUFM1                                33
     C     *IN33         DOWEQ     '0'
N09  C     FMST          IFEQ      'E'
N09  C     FMST          OREQ      'I'
     C                   DELETE    ZOKUFMR
N09  C                   endif
     C     HEUNIK        READE     ZOKUFM1                                33
     C                   END
N09   * Re-Initier KEY  + løpenr
N09  C                   MOVE      DFRI          FMRI
N09  C                   MOVE      DFAVD         FMAVD
N09  C                   MOVE      DFOPD         FMOPD
N09  C                   MOVE      DFFBNR        FMFBNR
N09  C                   MOVE      *ZEROS        FMLINR
N09  c                   move      *zeros        FMMKNR
     C                   endif
      *
     C                   ENDSR
      *_____________________________________________________
      * Subroutine to end Label Format
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C     LSDOTS        IFNE      '0  '
      * LS LABEL SHIFT (VENSTRE MARG)  (^LS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WLS           DATA
     C                   MOVEL     0             DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    ZBARCA
     C                   ENDSR
      *
      *_____________________________________________________
      * ved WEB / shipssystem, hent neste ORD / PO
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     GetNextSS     BEGSR
      * Denne rutine kalles KUN ved layout WW (alle PO's på trip/fr.br)
      * eller W2 (skriv "frie" labels for EN PO, ennå ikke på trip/fbr)
      *
     C     AntSS         IFEQ      AvSS
      * Neste PO/ordre  på trippen
     C     WMLAYO        IFEQ      'WW'
     c     TRIP          reade     GSSORL21                               33
     C                   ELSE
     C                   MOVE      *OFF          *IN33
     C                   END
     c     *in33         IFEQ      *ON
     c                   Move      *zeros        AntSS
     c                   Move      *zeros        AvSS
     c                   else
     c                   z-add     1             AntSS             4 0
     c                   z-add     ORCLI         AvSS              4 0
      * Hent Customer PO samt  internal (fabrikkens) PO.
     C     ORONO         CHAIN     GSSPOF                             33
     C   33              MOVE      *BLANKS       POCONO
     C     ORONO         SETLL     GSSRFF
     C     ORONO         READE     GSSRFF                                 33
     C     *IN33         DOWEQ     '0'
     C     RFKD          IFEQ      'CPO'
     C                   LEAVE
     C                   ENDIF
     C     ORONO         READE     GSSRFF                                 33
     C  N33              ENDDO
     C   33              MOVE      *BLANKS       RFREF
      * Areacode = 2 førset av siste FT
     c                   movel     ORFT4         AREACODE          2
      * Hent Navn/adr (postCode.)  sluttkunde via Båtkode..
     C                   Move      ORBCD         TSTNUM            4
     C                   TESTN                   TSTNUM               33
     c     *in33         IFEQ      *ON
     c                   move      tstnum        VADRNR
     C     VADRKey       CHAIN     VADR                               33
     c   33              Move      *blanks       POSTCODE         10
     c  N33              MoveL     VADRN3        POSTCODE
     c  N33              MoveL     VALAND        POSTCTRY          2
     C     *IN33         IFEQ      *OFF
     C     WMLAYO        ANDEQ     'W2'
     C     POSTCTRY      ANDNE     '  '
     c                   MoveL     VADRN3        DFPNUL
     c                   MoveL     VALAND        DFLKL
     c                   end
     c                   end
      *
     c                   end                                                    End READE ....
     c                   else
      * Neste kolli på samme PO...
     c                   Add       1             AntSS
     c                   end
      *
      * Oppdater EAN kolli-ID på PO-ens kolli-post.
      * (Når det er original knyttet til Shipssyst-trip/fraktbr.(fra FABR))
     c     UUKOPI        Ifne      'J'
     c     AntSS         Andne     *zeros
     c                   z-add     AntSS         OLLNO
     C     GSSOLKey      CHAIN     GSSOLF                             33
     c     *in33         IFEQ      *OFF
     c                   move      ORTNO         OLTNO
     c                   move      ORPOS1        OLSTD
     c                   Eval      OLMN  = '00'+KOID
     c                   update    GSSOLFR
     c                   end
     C                   end
      *
      * Normal trip/fraktbrev UT FRA HUB (da skal kolli-ID finens fra før)
      * har forprogrammet lagt ut også dokufm (basert på ID i GSSOLF)
      * Kjøres som ren kopi.
      *
      * Hent EAN-nr fra GSSOLF når det er "Fri merkelapp" fra SS-ordre
      * (Da finnes ikke DOKUF/DOKUFM) - Kjøres som KOPI.
     C     WMLAYO        IFEQ      'W2'
     c     AntSS         Andne     *zeros
     c                   z-add     AntSS         OLLNO
     C     GSSOLKey      CHAIN(N)  GSSOLF                             33
     c     *in33         IFEQ      *OFF
     c                   movel     OLMN          olmn20           20
     c                   move      OLMN20        KOID
     c                   end
     c                   end
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * ved WEB / shipssystem, Print PO-referanset
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     PrtNextSS     BEGSR
      * Inern/ekstern PO ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,430'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Int./Ext. PO'DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * PO-S         -data
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,430'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * data to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     RFREF         DATA1
     C     DATA1         CAT       '/':1         DATA1
     C     DATA1         CAT       POCONO:1      DATA1
     C                   EXCEPT    ZBARCA
      *
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C     WMLAYO        IFNE      'W2'
      * Kolli nr XX Of YY... (INNEN P/O)
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '600,430'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Cl'          DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Variabel - kollinummer
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '640,430'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * Text
S02   *
S02  C*                  MOVE      *BLANKS       DATA
S02  C*                  MOVEL     WFD           DATA
S02  C*                  Z-ADD     AntSS         LANUMA
S02  C*                  MOVE      LANUMA        CHAR4             4
S02  C*                  MOVEA     CHAR4         A4
S02  C*                  Z-ADD     1             X                 1 0
S02  C*                  Z-ADD     1             Y                 1 0
S02  C*                  MOVEA     *BLANKS       B4
S02  C*    A4(X)         DOWEQ     '0'
S02  C*    X             ANDLT     4
S02  C*                  ADD       1             X
S02  C*                  ENDDO
S02  C*    X             DOWLE     4
S02  C*                  MOVEA     A4(X)         B4(Y)
S02  C*                  ADD       1             X
S02  C*                  ADD       1             Y
S02  C*                  ENDDO
S02  C*                  MOVEA     B4            B4FELT            4
S02  C*                  MOVE      *BLANKS       DATA1
S02  C*                  MOVEL     B4FELT        DATA1
S02  C*    DATA1         CAT       'Of':1        DATA1
S02  C*                  Z-ADD     AvSS          LANUMA
S02  C*                  MOVE      LANUMA        CHAR4             4
S02  C*                  MOVEA     CHAR4         A4
S02  C*                  Z-ADD     1             X                 1 0
S02  C*                  Z-ADD     1             Y                 1 0
S02  C*                  MOVEA     *BLANKS       B4
S02  C*    A4(X)         DOWEQ     '0'
S02  C*    X             ANDLT     4
S02  C*                  ADD       1             X
S02  C*                  ENDDO
S02  C*    X             DOWLE     4
S02  C*                  MOVEA     A4(X)         B4(Y)
S02  C*                  ADD       1             X
S02  C*                  ADD       1             Y
S02  C*                  ENDDO
S02  C*                  MOVEA     B4            B4FELT            4
S02  C*    DATA1         CAT       B4FELT:1      DATA1
N02  C                   MOVE      *BLANKS       DATA
N02  C                   MOVEL     WFD           DATA
N02  C                   eval      DATA1 = %trim(%editc(AntSS:'Z'))
N02  c                             +' of '+%trim(%editc(AvSS:'Z'))
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
     C                   END
      *
      * End Cust. Post Code ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,470'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Final Cust. 'DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '200,470'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'P.Code '     DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '280,470'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * data to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C*                  MOVEL     POSTCODE      DATA1
     c                   eval      DATA1 = POSTCODE+' '+POSTCTRY
     C                   EXCEPT    ZBARCA
      *
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
      * Area Code: ledetekst
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '520,470'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Area Code '  DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '640,470'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',40,30'      DATA1
     C                   EXCEPT    ZBARCA
      * data to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVE      *BLANKS       DATA1
     C                   MOVEL     AREACODE      DATA1
     C                   EXCEPT    ZBARCA
      *
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR

      *_____________________________________________________
      * Execute MyPack Mottaker navn / adresse.
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     MYPMott       BEGSR
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,420'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WAD           DATA
     C                   MOVEL     ',24,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     'Mottaker'    DATA1
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,440'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',20,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     DFNAVM        DATA1
     c     TLFnr         ifne      *blanks
     c                   eval      Data1 =%trim(data1)
     c                             + '         Tlf: ' + TLFnr
     c                   end
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      * adr 1
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '18,460'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     ',20,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C*                  MOVEL     DFAD1M        DATA1
     c                   eval      DATA1 = %trim(DFAD1m)+ ',   '
     c                             + DFAD3M
     C                   MOVE      '.'           DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
     OZBARC     E            ZBARCA
     O                       DATA
** TABELL FOR OVERSETTELSE TIL Æ,Ø,Å FOR ZEBRA STRIPE PRINTERE
ZBARC     9E7B
ZBARC     E07C
ZBARC     9F5B
ZBARC     9CC0
ZBARC     BB6A
ZBARC     47D0
