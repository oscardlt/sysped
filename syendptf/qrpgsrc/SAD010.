********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO
10037 * 02 YBC PTF10 BEREGNINGSMÅTE PÅ HVER SATS
10262 * 03 YBC PTF10 SATS ER UTVIDERT TIL 7.2, INGEN MERKING
      *              ENDRING 02 ER FJERNET
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11020 * 04 YBC PTF11 FLERE NYE LAND OG REGIONER
11XXX * 05 YBC PTF11 TEST SLUTT-DATO FEIL
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 06 YBC PTF12 Test på dato
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE TOLLTARIFFEN                 ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 28 29 32 34-39 41-83 90 95-97       ***
      **************************************************************
      *
     Fsysthlp   IF   E             DISK
     FTARI      UF A E           K DISK
     FTARIL02   IF   E           K DISK
     F                                     RENAME(TARIR:TARI2R)
     FSAD010FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D KT              S              1    DIM(6) CTDATA PERRCD(6)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  XVNT                   1      8
     D  VN                     1      8
     D                                     DIM(8)
     D                 DS
     D  W2TANR                 1      8  0
     D  VN2                    1      8  0
     D                                     DIM(8)
     D                 DS
     D  TAALFA                 1     15
     D  XDLT                   1      7
     D                 DS
     D  TADATO                 1      8  0
     D  TADTÅ                  1      4  0
     D  TADTM                  5      6  0
     D  TADTD                  7      8  0
     D                 DS
     D  WXDATO                 1      6  0
     D  WXDTD                  1      2  0
     D  WXDTM                  3      4  0
     D  WXDTÅ                  5      6  0
     D                 DS
     D  WSDATO                 1      6  0
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D                 DS
     D  XSDATO                 1      8  0
     D  XSDTÅ                  1      4  0
     D  XSDTM                  5      6  0
     D  XSDTD                  7      8  0
N01  D                 DS
N01  D  TADTS                  1      8  0
N01  D  TADTSÅ                 1      4  0
N01  D  TADTSM                 5      6  0
N01  D  TADTSD                 7      8  0
N01  D                 DS
N01  D  WXDTS                  1      6  0
N01  D  WXDTSD                 1      2  0
N01  D  WXDTSM                 3      4  0
N01  D  WXDTSÅ                 5      6  0
N01  D                 DS
N01  D  WSDTS                  1      6  0
N01  D  WSDTSD                 1      2  0
N01  D  WSDTSM                 3      4  0
N01  D  WSDTSÅ                 5      6  0
N01  D                 DS
N01  D  XSDTS                  1      8  0
N01  D  XSDTSÅ                 1      4  0
N01  D  XSDTSM                 5      6  0
N01  D  XSDTSD                 7      8  0
     D                 DS
     D  TADTR                  1      8  0
     D  TADTRÅ                 1      4  0
     D  TADTRM                 5      6  0
     D  TADTRD                 7      8  0
     D                 DS
     D  WXDTR                  1      6  0
     D  WXDTRD                 1      2  0
     D  WXDTRM                 3      4  0
     D  WXDTRÅ                 5      6  0
     D                 DS
     D  WSDTR                  1      6  0
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        YTANR             8 0
     C                   MOVE      *ZEROS        YDATO             8 0
     C                   MOVE      *ZEROS        YDTR              8 0
     C                   MOVE      *BLANKS       YORDK             1
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C   31TARIK1        SETLL     TARI
     C  N31TARI2K        SETLL     TARIL02
     C     START1        TAG
     C   31              READ(N)   TARI                                   94
     C  N31              READ      TARIL02                                94
     C  N94              MOVE      TATANR        YTANR
     C  N94              MOVE      TADATO        YDATO
     C  N94              MOVE      TADTR         YDTR
     C  N94              MOVE      TAORDK        YORDK
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        9
     C                   MOVE      TADTÅ         WXDTÅ
     C                   MOVE      TADTM         WXDTM
     C                   MOVE      TADTD         WXDTD
N01  C                   MOVE      TADTSÅ        WXDTSÅ
N01  C                   MOVE      TADTSM        WXDTSM
N01  C                   MOVE      TADTSD        WXDTSD
     C                   MOVE      TADTRÅ        WXDTRÅ
     C                   MOVE      TADTRM        WXDTRM
     C                   MOVE      TADTRD        WXDTRD
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C   31              READ(N)   TARI                                   94
     C  N31              READ      TARIL02                                94
     C  N94              MOVE      TATANR        YTANR
     C  N94              MOVE      TADATO        YDATO
     C  N94              MOVE      TADTR         YDTR
     C  N94              MOVE      TAORDK        YORDK
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     c   01              do
     c                   movel     'sad0101'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      start3
     c                   end
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     c   01              do
     c                   movel     'sad0102'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START3
     c                   end
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       989930
     C*
     C   03
     COR 12              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE NY
     C   06              DO
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      *ZEROS        WSTANR
     C                   MOVE      *ZEROS        WSDTR
     C                   GOTO      START5
     C                   END
     C*** SOEK FRA
     C   08              GOTO      START6
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94TARIK2        CHAIN(N)  TARI                               94
     C  N94              DOW       ((TADTR <> YDTR) OR (TAORDK <> YORDK))
     C     TARIK2        READE(N)  TARI                                   94
     C  N94              ENDDO
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C   27WSNR          IFEQ      '1'
     C                   GOTO      SLUTT
     C                   END
     C  N27WSNR          IFEQ      '3'
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   MOVE      '0'           *IN40
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     21            POSNBR
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C                   GOTO      START5
     C                   END
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
     C*
     C*** LAGE NY
     C     START5        TAG
     C                   EXFMT     VARELI
     c   01              do
     c                   movel     'sad0103'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START5
     c                   end
S01  C*                  MOVEA     '00000000'    *IN(83)
N01  C                   MOVEA     '000000000'   *IN(82)
     C                   SETOFF                                       30
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C  N12              EXSR      OPDTAR
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C                   GOTO      START3
     C*
     C*** SOEK TARIFF
     C     START6        TAG
     C                   MOVE      *ZEROS        W2TANR
     C                   EXFMT     SOKTAR
     c   01              do
     c                   movel     'sad0101'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START6
     c                   end
     C   12              GOTO      START3
     C     W2ALFA        COMP      *BLANKS                                31
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSDATO        IFEQ      0
     C                   MOVE      *ZEROS        XSDATO
     C                   ELSE
     C                   MOVE      WSDTD         XSDTD
     C                   MOVE      WSDTM         XSDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          XSDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          XSDTÅ
     C                   END
     C                   END
      *
     C     *IN40         IFEQ      '0'
     C                   MOVE      WSDTD         XDAG              2 0
     C                   MOVE      WSDTM         XMND              2 0
     C                   MOVE      WSDTÅ         XÅR               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDAG
     C                   PARM                    XMND
     C                   PARM                    XÅR
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVE      '1'           *IN83
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     MSGNR
     C                   GOTO      SLTB
     C                   END
     C*
     C*** TEST TARIFFNR.
     C     WSTANR        COMP      0                                    8989
     C   89              SETON                                        30
     C   89              MOVE      'SPT0038'     MSGNR
     C  N89              DO
     C     TARIK         CHAIN(N)  TARI                               33
     C  N33              SETON                                        8930
     C  N33              MOVE      'SPT0039'     MSGNR
     C                   END
     C                   END
N01   * TEST SLUTTDATO
N01  C                   IF        WSDTS = 0
N01  C                   MOVE      *ZEROS        XSDTS
N01  C                   ELSE
N01  C                   MOVE      WSDTSD        XSDTSD
N01  C                   MOVE      WSDTSM        XSDTSM
N01  C                   IF        WSDTSÅ > 50
N01  C     WSDTSÅ        ADD       1900          XSDTSÅ
N01  C                   ELSE
N01  C     WSDTSÅ        ADD       2000          XSDTSÅ
N01  C                   END
N01   *
N01  C                   MOVE      WSDTSD        XDAG              2 0
N01  C                   MOVE      WSDTSM        XMND              2 0
N01  C                   MOVE      WSDTSÅ        XÅR               2 0
N01  C                   CALL      'TESTDATO'
N01  C                   PARM                    XDAG
N01  C                   PARM                    XMND
N01  C                   PARM                    XÅR
N01  C                   PARM                    UFLAGG            1 0
S05  C*                  IF        ((XSDTS > XIDAG) OR (XSDTS < XSDATO))
N05  C                   IF        ((XSDTS < XIDAG) OR (XSDTS < XSDATO))
N01  C                   Z-ADD     1             UFLAGG
N01  C                   END
N01  C     UFLAGG        IFEQ      1
N01  C                   MOVE      '1'           *IN82
N01  C                   MOVE      '1'           *IN30
N06  C                   IF        ((XSDTS < XIDAG) OR (XSDTS < XSDATO))
N06  C                   MOVE      'YBC2024'     MSGNR
N06  C                   ELSE
N01  C                   MOVE      'SPD0001'     MSGNR
N06  C                   END
N01  C                   GOTO      SLTB
N01  C                   END
N01  C                   END
     C*
     C*** TEST ORDINAER
     C                   SETOFF                                       33
     C     WSORDK        LOOKUP    KT                                     33
     C  N33              SETON                                        88
     C  N88WSORDK        COMP      ' '                                3333
     C  N88
     CAN 33WSORDK        COMP      'F'                                3333
     C  N88
     CAN 33WSORDB        COMP      0                                    8888
     C   88
     CANN30              MOVE      'SPK0043'     MSGNR
     C   88              SETON                                        30
     C*
     C*** TEST EFTA
     C*                  SETOFF                                       33
     C* N87
     C*N 33WSEFTB        COMP      0                                    8787
     C*  87
     C*NN30              MOVE      'SPK0043'     MSGNR
     C*  87              SETON                                        30
     C*
     C*** TEST EF
     C*                  SETOFF                                       33
     C* N86
     C*N 33WSEFB         COMP      0                                    8686
     C*  86
     C*NN30              MOVE      'SPK0043'     MSGNR
     C*  86              SETON                                        30
     C*
     C     WSSTK         COMP      ' '                                8585
     C   85WSSTK         COMP      'J'                                8585
     C   85
     CANN30              MOVE      'SPS0042'     MSGNR
     C   85              SETON                                        30
     C*
     C     WSALFA        COMP      *BLANKS                                84
     C   84
     CANN30              MOVE      'SPA0027'     MSGNR
     C   84              SETON                                        30
      *
      *
     C     SLTB          TAG
     C   83              Z-ADD     25            LINNBR
     C   30
     CANN83              Z-ADD     17            LINNBR
N01  C   82              Z-ADD     26            LINNBR
N01  C   82              Z-ADD     73            POSNBR
     C   83              Z-ADD     73            POSNBR
     C   84              Z-ADD     64            POSNBR
     C   85              Z-ADD     57            POSNBR
     C*  86              Z-ADD     45            POSNBR
     C*  87              Z-ADD     33            POSNBR
     C   88              Z-ADD     30            POSNBR
     C   89              Z-ADD     10            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     2             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       6             LINNBR
     C                   MVR                     LINNBR
     C     LINNBR        MULT      2             XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C   27WSNR          IFEQ      '1'
     C                   MOVE      TATANR        UVNT
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C   98              GOTO      SLHENT
     C                   EXSR      CHGTAR
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '3'
     C     XDLT          COMP      '*DELETE'                              98
     C   98              MOVE      ' '           WSNR
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C  N98              EXSR      MOVTAW
     C                   GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C   98              GOTO      SLHENT
     C                   EXSR      DLTTAR
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '9'
     C                   EVAL      WSNR=*BLANKS
     C     XDLT          COMP      '*DELETE'                              98
     C   98              EVAL      MSGNR='DIV0012'
     C   98              EVAL      *IN30=*ON
     C   98              GOTO      SLHENT
     C                   EXSR      TARIC
     C                   ENDIF
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTTAR        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   MOVE      TATANR        WSTANR
     C                   MOVE      TADATO        XSDATO
     C                   EXFMT     VAREL3
     c   01              do
     c                   movel     'sad0105'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      START5
     c                   end
     C  N12              DO
     C     TARIK         CHAIN     TARI                               33
     C  N33              DELETE    TARIR
     C                   EXSR      MOVB1
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGTAR        BEGSR
     C***********************************************
     C                   EXSR      MOVTAW
     C                   SETON                                        99
     C     STCHG         TAG
     C                   EXFMT     VARELI
     c   01              do
     c                   movel     'sad0103'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      STCHG
     c                   end
S01  C*                  MOVEA     '00000000'    *IN(83)
N01  C                   MOVEA     '000000000'   *IN(82)
     C                   SETOFF                                       30
     C   12              DO
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C  N12              EXSR      OPDTAR
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDTAR        BEGSR
     C***********************************************
     C     TARIK         CHAIN     TARI                               33
     C                   EXSR      MOVWTA
     C  N33              UPDATE    TARIR
     C   33              WRITE     TARIR
     C   33              MOVE      TADTÅ         WXDTÅ
     C   33              MOVE      TADTM         WXDTM
     C   33              MOVE      TADTD         WXDTD
N01  C                   MOVE      TADTSÅ        WXDTSÅ
N01  C                   MOVE      TADTSM        WXDTSM
N01  C                   MOVE      TADTSD        WXDTSD
     C*
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   EXSR      MOVB2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVTAW        BEGSR
     C***********************************************
     C                   MOVE      TATANR        WSTANR
     C                   MOVE      TAORDK        WSORDK
     C                   MOVE      TAORDB        WSORDB
     C                   MOVE      TAEFTB        WSEFTB
     C                   MOVE      TAEFTK        WSEFTK
     C                   MOVE      TAEFB         WSEFB
     C                   MOVE      TAEFK         WSEFK
     C                   MOVE      TATXT         WSTXT
     C                   MOVE      TASTK         WSSTK
     C                   MOVE      TAALFA        WSALFA
     C                   MOVE      TAENHE        WSENHE
     C                   MOVE      TAKAPA        WSKAPA
     C                   MOVE      TAREST        WSREST
     C                   MOVE      TAKAP         WSKAP
     C                   MOVE      TAEØSB        WSEØSB
     C                   MOVE      TATSJB        WSTSJB
     C                   MOVE      TATYRB        WSTYRB
     C                   MOVE      TAISRB        WSISRB
     C                   MOVE      TAELLB        WSELLB
     C                   MOVE      TABULB        WSBULB
     C                   MOVE      TAPOLB        WSPOLB
     C                   MOVE      TAROMB        WSROMB
     C                   MOVE      TAUNGB        WSUNGB
     C                   MOVE      TASLOB        WSSLOB
     C                   MOVE      TAMULB        WSMULB
     C                   MOVE      TAOULB        WSOULB
     C                   MOVE      TAGRLB        WSGRLB
     C                   MOVE      TAFÆRB        WSFÆRB
     C                   MOVE      TAISTB        WSISTB
     C                   MOVE      TAMARB        WSMARB
     C                   MOVE      TAMEXB        WSMEXB
     C                   MOVE      TAVGAB        WSVGAB
     C                   MOVE      TAN01B        WSN01B
     C                   MOVE      TAN02B        WSN02B
     C                   MOVE      TAN03B        WSN03B
     C                   MOVE      TAN04B        WSN04B
N04  C                   MOVE      TAN05B        WSN05B
N04  C                   MOVE      TAN06B        WSN06B
N04  C                   MOVE      TAN07B        WSN07B
N04  C                   MOVE      TAN08B        WSN08B
N04  C                   MOVE      TAN09B        WSN09B
N04  C                   MOVE      TAN10B        WSN10B
N04  C                   MOVE      TAN11B        WSN11B
N04  C                   MOVE      TAN12B        WSN12B
N04  C                   MOVE      TAN13B        WSN13B
N04  C                   MOVE      TAN14B        WSN14B
N04  C                   MOVE      TAN15B        WSN15B
     C                   MOVE      TADTD         WSDTD
     C                   MOVE      TADTM         WSDTM
     C                   MOVE      TADTÅ         WSDTÅ
N01  C                   MOVE      TADTSD        WSDTSD
N01  C                   MOVE      TADTSM        WSDTSM
N01  C                   MOVE      TADTSÅ        WSDTSÅ
     C                   MOVE      TADTRD        WSDTRD
     C                   MOVE      TADTRM        WSDTRM
     C                   MOVE      TADTRÅ        WSDTRÅ
      *
     C                   EVAL      WSEØSK = TAEØSK
     C                   EVAL      WSTSJK = TATSJK
     C                   EVAL      WSTYRK = TATYRK
     C                   EVAL      WSISRK = TAISRK
     C                   EVAL      WSELLK = TAELLK
     C                   EVAL      WSBULK = TABULK
     C                   EVAL      WSPOLK = TAPOLK
     C                   EVAL      WSROMK = TAROMK
     C                   EVAL      WSUNGK = TAUNGK
     C                   EVAL      WSSLOK = TASLOK
     C                   EVAL      WSMULK = TAMULK
     C                   EVAL      WSOULK = TAOULK
     C                   EVAL      WSGRLK = TAGRLK
     C                   EVAL      WSFÆRK = TAFÆRK
     C                   EVAL      WSISTK = TAISTK
     C                   EVAL      WSMARK = TAMARK
     C                   EVAL      WSMEXK = TAMEXK
     C                   EVAL      WSVGAK = TAVGAK
     C                   EVAL      WSN01K = TAN01K
     C                   EVAL      WSN02K = TAN02K
     C                   EVAL      WSN03K = TAN03K
     C                   EVAL      WSN04K = TAN04K
N04  C                   EVAL      WSN05K = TAN05K
N04  C                   EVAL      WSN06K = TAN06K
N04  C                   EVAL      WSN07K = TAN07K
N04  C                   EVAL      WSN08K = TAN08K
N04  C                   EVAL      WSN09K = TAN09K
N04  C                   EVAL      WSN10K = TAN10K
N04  C                   EVAL      WSN11K = TAN11K
N04  C                   EVAL      WSN12K = TAN12K
N04  C                   EVAL      WSN13K = TAN13K
N04  C                   EVAL      WSN14K = TAN14K
N04  C                   EVAL      WSN15K = TAN15K
      *
     C                   SETON                                        40
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     21            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWTA        BEGSR
     C***********************************************
     C                   MOVE      WSTANR        TATANR
     C                   MOVEL     WSTANR        TAKAPN
     C                   MOVE      WSORDK        TAORDK
     C                   MOVE      WSORDB        TAORDB
     C                   MOVE      WSEFTB        TAEFTB
     C                   MOVE      WSEFTK        TAEFTK
     C                   MOVE      WSEFB         TAEFB
     C                   MOVE      WSEFK         TAEFK
     C                   MOVE      WSSTK         TASTK
     C                   MOVE      WSALFA        TAALFA
     C                   MOVE      WSENHE        TAENHE
     C                   MOVE      WSKAPA        TAKAPA
     C                   MOVE      WSTXT         TATXT
     C                   MOVE      WSREST        TAREST
     C                   MOVE      WSKAP         TAKAP
     C                   MOVE      WSEØSB        TAEØSB
     C                   MOVE      WSTSJB        TATSJB
     C                   MOVE      WSTYRB        TATYRB
     C                   MOVE      WSISRB        TAISRB
     C                   MOVE      WSELLB        TAELLB
     C                   MOVE      WSBULB        TABULB
     C                   MOVE      WSPOLB        TAPOLB
     C                   MOVE      WSROMB        TAROMB
     C                   MOVE      WSUNGB        TAUNGB
     C                   MOVE      WSSLOB        TASLOB
     C                   MOVE      WSMULB        TAMULB
     C                   MOVE      WSOULB        TAOULB
     C                   MOVE      WSGRLB        TAGRLB
     C                   MOVE      WSFÆRB        TAFÆRB
     C                   MOVE      WSISTB        TAISTB
     C                   MOVE      WSMARB        TAMARB
     C                   MOVE      WSMEXB        TAMEXB
     C                   MOVE      WSVGAB        TAVGAB
     C                   MOVE      WSN01B        TAN01B
     C                   MOVE      WSN02B        TAN02B
     C                   MOVE      WSN03B        TAN03B
     C                   MOVE      WSN04B        TAN04B
N04  C                   MOVE      WSN05B        TAN05B
N04  C                   MOVE      WSN06B        TAN06B
N04  C                   MOVE      WSN07B        TAN07B
N04  C                   MOVE      WSN08B        TAN08B
N04  C                   MOVE      WSN09B        TAN09B
N04  C                   MOVE      WSN10B        TAN10B
N04  C                   MOVE      WSN11B        TAN11B
N04  C                   MOVE      WSN12B        TAN12B
N04  C                   MOVE      WSN13B        TAN13B
N04  C                   MOVE      WSN14B        TAN14B
N04  C                   MOVE      WSN15B        TAN15B
      *
     C                   EVAL      TAEØSK = WSEØSK
     C                   EVAL      TATSJK = WSTSJK
     C                   EVAL      TATYRK = WSTYRK
     C                   EVAL      TAISRK = WSISRK
     C                   EVAL      TAELLK = WSELLK
     C                   EVAL      TABULK = WSBULK
     C                   EVAL      TAPOLK = WSPOLK
     C                   EVAL      TAROMK = WSROMK
     C                   EVAL      TAUNGK = WSUNGK
     C                   EVAL      TASLOK = WSSLOK
     C                   EVAL      TAMULK = WSMULK
     C                   EVAL      TAOULK = WSOULK
     C                   EVAL      TAGRLK = WSGRLK
     C                   EVAL      TAFÆRK = WSFÆRK
     C                   EVAL      TAISTK = WSISTK
     C                   EVAL      TAMARK = WSMARK
     C                   EVAL      TAMEXK = WSMEXK
     C                   EVAL      TAVGAK = WSVGAK
     C                   EVAL      TAN01K = WSN01K
     C                   EVAL      TAN02K = WSN02K
     C                   EVAL      TAN03K = WSN03K
     C                   EVAL      TAN04K = WSN04K
N04  C                   EVAL      TAN05K = WSN05K
N04  C                   EVAL      TAN06K = WSN06K
N04  C                   EVAL      TAN07K = WSN07K
N04  C                   EVAL      TAN08K = WSN08K
N04  C                   EVAL      TAN09K = WSN09K
N04  C                   EVAL      TAN10K = WSN10K
N04  C                   EVAL      TAN11K = WSN11K
N04  C                   EVAL      TAN12K = WSN12K
N04  C                   EVAL      TAN13K = WSN13K
N04  C                   EVAL      TAN14K = WSN14K
N04  C                   EVAL      TAN15K = WSN15K
      *
N01  C                   MOVE      XSDTSD        TADTSD
N01  C                   MOVE      XSDTSM        TADTSM
N01  C                   MOVE      XSDTSÅ        TADTSÅ
     C                   MOVE      XSDTD         TADTD
     C                   MOVE      XSDTM         TADTM
     C                   MOVE      XSDTÅ         TADTÅ
     C                   IF        *IN33
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           TADTR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        TATANR
     C                   MOVE      *BLANKS       TAALFA
     C                   MOVE      '*DELETE'     XDLT
     C                   MOVE      *BLANKS       TAORDK
     C                   MOVE      *ZEROS        TAORDB
     C                   MOVE      *BLANKS       TAEFTK
     C                   MOVE      *ZEROS        TAEFTB
     C                   MOVE      *BLANKS       TAEFK
     C                   MOVE      *ZEROS        TAEFB
     C                   MOVE      *BLANKS       TASTK
     C                   MOVE      *BLANKS       TAKAP
     C                   MOVE      *BLANKS       TAENHE
     C                   MOVE      *BLANKS       TATXT
     C                   MOVE      *ZEROS        TAEØSB
     C                   MOVE      *BLANKS       TAEØSK
     C                   MOVE      *ZEROS        TATSJB
     C                   MOVE      *BLANKS       TATSJK
     C                   MOVE      *ZEROS        TATYRB
     C                   MOVE      *BLANKS       TATYRK
     C                   MOVE      *ZEROS        TAISRB
     C                   MOVE      *BLANKS       TAISRK
     C                   MOVE      *ZEROS        TAELLB
     C                   MOVE      *BLANKS       TAELLK
     C                   MOVE      *ZEROS        TABULB
     C                   MOVE      *BLANKS       TABULK
     C                   MOVE      *ZEROS        TAPOLB
     C                   MOVE      *BLANKS       TAPOLK
     C                   MOVE      *ZEROS        TAROMB
     C                   MOVE      *BLANKS       TAROMK
     C                   MOVE      *ZEROS        TAUNGB
     C                   MOVE      *BLANKS       TAUNGK
     C                   MOVE      *ZEROS        TASLOB
     C                   MOVE      *BLANKS       TASLOK
     C                   MOVE      *ZEROS        TAMULB
     C                   MOVE      *BLANKS       TAMULK
     C                   MOVE      *ZEROS        TAOULB
     C                   MOVE      *BLANKS       TAOULK
     C                   MOVE      *ZEROS        TAGRLB
     C                   MOVE      *BLANKS       TAGRLK
     C                   MOVE      *ZEROS        TAFÆRB
     C                   MOVE      *BLANKS       TAFÆRK
     C                   MOVE      *ZEROS        TAISTB
     C                   MOVE      *BLANKS       TAISTK
     C                   MOVE      *ZEROS        TAMARB
     C                   MOVE      *BLANKS       TAMARK
     C                   MOVE      *ZEROS        TAMEXB
     C                   MOVE      *BLANKS       TAMEXK
     C                   MOVE      *ZEROS        TAVGAB
     C                   MOVE      *BLANKS       TAVGAK
     C                   MOVE      *ZEROS        TAN01B
     C                   MOVE      *BLANKS       TAN01K
     C                   MOVE      *ZEROS        TAN02B
     C                   MOVE      *BLANKS       TAN02K
     C                   MOVE      *ZEROS        TAN03B
     C                   MOVE      *BLANKS       TAN03K
     C                   MOVE      *ZEROS        TAN04B
     C                   MOVE      *BLANKS       TAN04K
N04  C                   MOVE      *ZEROS        TAN05B
N04  C                   MOVE      *BLANKS       TAN05K
N04  C                   MOVE      *ZEROS        TAN06B
N04  C                   MOVE      *BLANKS       TAN06K
N04  C                   MOVE      *ZEROS        TAN07B
N04  C                   MOVE      *BLANKS       TAN07K
N04  C                   MOVE      *ZEROS        TAN08B
N04  C                   MOVE      *BLANKS       TAN08K
N04  C                   MOVE      *ZEROS        TAN09B
N04  C                   MOVE      *BLANKS       TAN09K
N04  C                   MOVE      *ZEROS        TAN10B
N04  C                   MOVE      *BLANKS       TAN10K
N04  C                   MOVE      *ZEROS        TAN11B
N04  C                   MOVE      *BLANKS       TAN11K
N04  C                   MOVE      *ZEROS        TAN12B
N04  C                   MOVE      *BLANKS       TAN12K
N04  C                   MOVE      *ZEROS        TAN13B
N04  C                   MOVE      *BLANKS       TAN13K
N04  C                   MOVE      *ZEROS        TAN14B
N04  C                   MOVE      *BLANKS       TAN14K
N04  C                   MOVE      *ZEROS        TAN15B
N04  C                   MOVE      *BLANKS       TAN15K
     C                   MOVE      *ZEROS        TADATO
N01  C                   MOVE      *ZEROS        TADTS
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *ZEROS        WSTANR
     C                   MOVE      *BLANKS       WSORDK
     C                   MOVE      *ZEROS        WSORDB
     C                   MOVE      *ZEROS        WSEFTB
     C                   MOVE      *BLANKS       WSEFTK
     C                   MOVE      *ZEROS        WSEFB
     C                   MOVE      *BLANKS       WSEFK
     C                   MOVE      *BLANKS       WSSTK
     C                   MOVE      *BLANKS       WSALFA
     C                   MOVE      *BLANKS       WSENHE
     C                   MOVE      *BLANKS       WSKAPA
     C                   MOVE      *BLANKS       WSTXT
     C                   MOVE      *BLANKS       WSREST
     C                   MOVE      *BLANKS       WSKAP
     C                   MOVE      *ZEROS        WSEØSB
     C                   MOVE      *BLANKS       WSEØSK
     C                   MOVE      *ZEROS        WSTSJB
     C                   MOVE      *BLANKS       WSTSJK
     C                   MOVE      *ZEROS        WSTYRB
     C                   MOVE      *BLANKS       WSTYRK
     C                   MOVE      *ZEROS        WSISRB
     C                   MOVE      *BLANKS       WSISRK
     C                   MOVE      *ZEROS        WSELLB
     C                   MOVE      *BLANKS       WSELLK
     C                   MOVE      *ZEROS        WSBULB
     C                   MOVE      *BLANKS       WSBULK
     C                   MOVE      *ZEROS        WSPOLB
     C                   MOVE      *BLANKS       WSPOLK
     C                   MOVE      *ZEROS        WSROMB
     C                   MOVE      *BLANKS       WSROMK
     C                   MOVE      *ZEROS        WSUNGB
     C                   MOVE      *BLANKS       WSUNGK
     C                   MOVE      *ZEROS        WSSLOB
     C                   MOVE      *BLANKS       WSSLOK
     C                   MOVE      *ZEROS        WSMULB
     C                   MOVE      *BLANKS       WSMULK
     C                   MOVE      *ZEROS        WSOULB
     C                   MOVE      *BLANKS       WSOULK
     C                   MOVE      *ZEROS        WSGRLB
     C                   MOVE      *BLANKS       WSGRLK
     C                   MOVE      *ZEROS        WSFÆRB
     C                   MOVE      *BLANKS       WSFÆRK
     C                   MOVE      *ZEROS        WSISTB
     C                   MOVE      *BLANKS       WSISTK
     C                   MOVE      *ZEROS        WSMARB
     C                   MOVE      *BLANKS       WSMARK
     C                   MOVE      *ZEROS        WSMEXB
     C                   MOVE      *BLANKS       WSMEXK
     C                   MOVE      *ZEROS        WSVGAB
     C                   MOVE      *BLANKS       WSVGAK
     C                   MOVE      *ZEROS        WSN01B
     C                   MOVE      *BLANKS       WSN01K
     C                   MOVE      *ZEROS        WSN02B
     C                   MOVE      *BLANKS       WSN02K
     C                   MOVE      *ZEROS        WSN03B
     C                   MOVE      *BLANKS       WSN03K
     C                   MOVE      *ZEROS        WSN04B
     C                   MOVE      *BLANKS       WSN04K
N04  C                   MOVE      *ZEROS        WSN05B
N04  C                   MOVE      *BLANKS       WSN05K
N04  C                   MOVE      *ZEROS        WSN06B
N04  C                   MOVE      *BLANKS       WSN06K
N04  C                   MOVE      *ZEROS        WSN07B
N04  C                   MOVE      *BLANKS       WSN07K
N04  C                   MOVE      *ZEROS        WSN08B
N04  C                   MOVE      *BLANKS       WSN08K
N04  C                   MOVE      *ZEROS        WSN09B
N04  C                   MOVE      *BLANKS       WSN09K
N04  C                   MOVE      *ZEROS        WSN10B
N04  C                   MOVE      *BLANKS       WSN10K
N04  C                   MOVE      *ZEROS        WSN11B
N04  C                   MOVE      *BLANKS       WSN11K
N04  C                   MOVE      *ZEROS        WSN12B
N04  C                   MOVE      *BLANKS       WSN12K
N04  C                   MOVE      *ZEROS        WSN13B
N04  C                   MOVE      *BLANKS       WSN13K
N04  C                   MOVE      *ZEROS        WSN14B
N04  C                   MOVE      *BLANKS       WSN14K
N04  C                   MOVE      *ZEROS        WSN15B
N04  C                   MOVE      *BLANKS       WSN15K
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     TARIK         KLIST
     C                   KFLD                    WSTANR
     C                   KFLD                    YTAR
     C                   KFLD                    XSDATO
     C     TARIK1        KLIST
     C                   KFLD                    W2TANR
     C                   KFLD                    YTAR
     C     TARIK2        KLIST
     C                   KFLD                    YTANR
     C                   KFLD                    YTAR
     C                   KFLD                    YDATO
     C     TARI2K        KLIST
     C                   KFLD                    W2ALFA
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPLUKK            1
     C                   PARM                    UVNT              8
     C     UPLUKK        COMP      'J'                                    27
     C*
     C     hlp01         tag
     C                   MOVE      *ZEROS        WSDATO
     C                   MOVE      *ZEROS        WXDATO
N01  C                   MOVE      *ZEROS        WSDTS
N01  C                   MOVE      *ZEROS        WXDTS
     C                   MOVE      *ZEROS        W2TANR
     C                   MOVE      *BLANKS       YTAR              3
     C     UVNT          IFEQ      *BLANKS
     C                   WRITE     NYWRK
     C                   EXFMT     SOKTAR
     c   01              do
     c                   movel     'sad0101'     hlpna             8
     c                   exsr      helpsr
     C                   GOTO      hlp01
     c                   end
     C                   ELSE
     C                   MOVE      UVNT          XVNT
     C     1             DO        8             XN                1 0
     C     VN(XN)        IFNE      ' '
     C                   MOVE      VN(XN)        VN2(XN)
     C                   END
     C                   END
     C                   END
     C     W2ALFA        COMP      *BLANKS                                31
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      WDT           XIDAG             8 0
     C*
     C                   ENDSR
     C*
      *______________________________________________
     C     TARIC         BEGSR
      *""""""""""""""""""""""""""""""""""""""""""""""
     C     TARICSTR      TAG
     C                   CALL      'TARIEUR'
     C                   PARM                    TATANR
     C                   UPDATE    SUBFIL
     C                   ENDSR
     C***********************************************
     C     HELPSR        BEGSR
     C***********************************************
     c
     c                   move      *blanks       pcocmd           70
     c     1             chain     systhlp                            33
     c     *in(33)       ifeq      '0'
      *
      * intern
     c                   movel     'http://'     pcocmd
     C     pcocmd        CAT       systip:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       systba:0      pcocmd
     C     pcocmd        CAT       '/':0         pcocmd
     C     pcocmd        CAT       hlpna:0       pcocmd
     C     pcocmd        CAT       '.htm':0      pcocmd
      *
     c                   call      'SYGE34CL'
     c                   parm                    pcocmd
     c                   end
     C                   ENDSR
**
 AFPVW
