***** **************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12353 * 01 CB  PTF12 Ved forenklet=N - Ikke krav til AUTOR og fjernet
      * 01 CB  validering av avgangstollsted i avdelingsdef (NCTSESTD)
********************************************************************
MRK02 * !!! CONTAINER/SEALS ER FLYTTET TIL ITEM
      ************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE NCTS-EKSP. AVD. DEFAULT    ***
      ************************************************************
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTS2    IF   E           K DISK
     F*KODTS4    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FSADTRTB   IF   E           K DISK
     FEDII      IF   E           K DISK
     FNCTSESTD  UF A E           K DISK
     FTRKODL01  IF   E           K DISK
     FTRUGH     IF   E           K DISK
     FTRUGD     IF   E           K DISK
     FNCTS003D  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D AD              s             30
     D XAN02           s              2A
     D XAN02_1         s              2A
     D XAN02_2         s              2A
     D XAN02_3         s              2A
     D XAN02_4         s              2A
     D XAN02_5         s              2A
     D XAN02_6         s              2A
     D XAN02_7         s              2A
     D XAN02_8         s              2A
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  THDTÅ                  1      4  0
     D  THDTM                  5      6  0
     D  THDTD                  7      8  0
     D  THDT                   1      8  0
     D                 DS
     D  WSCDTD                 1      2  0
     D  WSCDTM                 3      4  0
     D  WSCDTA                 5      6  0
     D  WSCDT                  1      6  0
     D                 DS
     D  THCDTC                 1      2  0
     D  THCDTA                 3      4  0
     D  THCDTM                 5      6  0
     D  THCDTD                 7      8  0
     D  THCDT                  1      8  0
     D                 DS
     D  WSCNA                  1     22
     D  WSCNA1                 1     12
     D  WSCNA2                13     22
     D                 DS
     D  WSCANR                 1     17
     D  WSCANR1                1      6
     D  WSCANR2                7     12
     D                 DS
     D  WSEMC                  1     50
     D  WSEMC_40               1     40
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
     C                   IF        MODE = 'E'
     C                   MOVE      UAVD          WSAAVD
     C                   GOTO      STARTB
     C                   END
      *
     C     START         TAG
     C                   EXFMT     NC003D01
     C   03              GOTO      SLUTT
     C     STARTB        TAG
     C     KODTAK        CHAIN     KODTA                              99
     C  N99              IF        MODE = 'N'
      * VED "LAGE NY" SKAL AVDELINGSDEFAULT IKKE FINNES.
     C     WSAAVD        CHAIN(N)  NCTSESTD                           33
     C  N33              EVAL      *IN99 = *ON
     C                   END
     C   99              GOTO      START
     C                   EXSR      HENT
      *
     C     START2        TAG
     C                   EXFMT     NC003D02
     C                   MOVEA     '0000000'     *IN(93)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C                   EXSR      TESTB2
     C   30              GOTO      START2
      *
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     10            POSNBR
     C     START3        TAG
     C                   EXFMT     NC003D03
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '000000000000'*IN(76)
     C                   MOVEA     '000000000000'*IN(64)
     C                   MOVEA     '000000000000'*IN(52)
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      START3
     C                   END
     C   12              GOTO      START2
      *
     C                   EXSR      TESTB3
     C   30              GOTO      START3
     C                   EXSR      OPDTRS
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     WSAAVD        CHAIN(N)  NCTSESTD                           33
     C     *IN33         IFEQ      '1'
     C                   EXSR      MOVEB
     C                   ELSE
     C                   EXSR      MOVEW
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSNTTD        IFEQ      0
     C                   Z-ADD     1             WSNTTD
     C                   END
     C     WSNTLL        IFEQ      0
     C                   Z-ADD     1             WSNTLL
     C                   END
     C     WSFMLL        IFNE      'N'
     C                   MOVE      'J'           WSFMLL
     C                   END
      *
     C     WSTDN         COMP      0                                    9898
     C   98
     CANN30              MOVE      'SPT0023'     MSGNR
     C   98              SETON                                        30
      *
     C     W0004         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN95
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C     W0010         CHAIN     EDII                               51
     C     *IN51         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN94
     C                   MOVE      'SPN0001'     MSGNR
     C                   ENDIF
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB3        BEGSR
     C***********************************************
      * Deklarsjonstype
     C                   IF        WSDK <>*BLANKS
     C                   MOVE      '031'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDK          YKODE
     C     TRK01K        CHAIN     TRKODL01                           99
     C   99              MOVE      'YBC0809'     MSGNR
     C   99              EVAL      *IN30 = *ON
     C                   END
      * Kode til autorisasjon
N01  C                   IF        WSENKL='J'
     C     WSATYP        COMP      *BLANKS                                98
     C  N30              IF        *IN98
     C                   MOVE      'YBC2129'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
      * Autorisasjonsreferanse
     C     WSAREF        COMP      *BLANKS                                97
     C  N30              IF        *IN97
     C                   MOVE      'YBC2130'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
      * Avgangs tollsted
     C                   IF        WSCATS <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSCATS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           96
     C   96
     CANN30              MOVE      'YBC1768'     MSGNR
     C   96              EVAL      *IN30 = *ON
     C                   END
N01  C                   ENDIF
      * Bestemmelse tollsted
     C                   IF        WSTSB <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSB         YKODE
     C     TRK01K        CHAIN     TRKODL01                           95
     C   95
     CANN30              MOVE      'YBC1768'     MSGNR
     C   95              EVAL      *IN30 = *ON
     C                   END
      * Tollsteder i rute
     C                   IF        WSTSD1 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD1        YKODE
     C     TRK01K        CHAIN     TRKODL01                           94
     C   94
     CANN30              MOVE      'YBC1768'     MSGNR
     C   94              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSTSD2 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD2        YKODE
     C     TRK01K        CHAIN     TRKODL01                           93
     C   93
     CANN30              MOVE      'YBC1768'     MSGNR
     C   93              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSTSD3 <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTSD3        YKODE
     C     TRK01K        CHAIN     TRKODL01                           92
     C   92
     CANN30              MOVE      'YBC1768'     MSGNR
     C   92              EVAL      *IN30 = *ON
     C                   END
      *
     C*                  IF        WSTSD4 <> *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSD4        YKODE
     C*    TRK01K        CHAIN     TRKODL01                           91
     C*  91
     C*NN30              MOVE      'YBC1768'     MSGNR
     C*  91              EVAL      *IN30 = *ON
     C*                  END
      *
     C*                  IF        WSTSD5 <> *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSD5        YKODE
     C*    TRK01K        CHAIN     TRKODL01                           90
     C*  90
     C*NN30              MOVE      'YBC1768'     MSGNR
     C*  90              EVAL      *IN30 = *ON
     C*                  END
      *
     C*                  IF        WSTSD6 <> *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSD6        YKODE
     C*    TRK01K        CHAIN     TRKODL01                           89
     C*  89
     C*NN30              MOVE      'YBC1768'     MSGNR
     C*  89              EVAL      *IN30 = *ON
     C*                  END
      *
     C*                  IF        WSTSD7 <> *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSD7        YKODE
     C*    TRK01K        CHAIN     TRKODL01                           88
     C*  88
     C*NN30              MOVE      'YBC1768'     MSGNR
     C*  88              EVAL      *IN30 = *ON
     C*                  END
      *
     C*                  IF        WSTSD8 <> *BLANKS
     C*                  MOVE      '106'         YUNIK
     C*                  MOVE      *BLANKS       YKODE
     C*                  MOVEL     WSTSD8        YKODE
     C*    TRK01K        CHAIN     TRKODL01                           87
     C*  87
     C*NN30              MOVE      'YBC1768'     MSGNR
     C*  87              EVAL      *IN30 = *ON
     C*                  END
      * Nødprosedyre nummerserie
     C     WSNPNS        CHAIN     SADTRTB                            91
     C  N30              IF        *IN91
     C                   MOVE      'YBC1934'     MSGNR
     C                   SETON                                        30
     C                   END
      * Holder
     C                   IF        WSKNH <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNH
     C     CUND1K        CHAIN     CUNDL01                            86
     C                   IF        *IN86                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 4
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINH = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINH = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINH = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINH = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAH  = KNAVN
     C                   EVAL      WSAD1H = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNH  = *BLANKS
     C                   MOVEL     POSTNR        WSPNH
     C                   ELSE                                                     3
     C                   EVAL      WSPNH  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSH  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKH  = SYLAND
     C                   END                                                      3<-E
     C                   IF        WSCPH = *BLANKS                                3<-B
     C                   EVAL      WSCPH  = KPERS
     C                   END                                                      3<-E
     C                   IF        WSTLH = *BLANKS                                3<-B
     C                   EVAL      WSTLH  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEMH = *BLANKS                                3<-B
     C                   EVAL      WSEMH  = SYEPOS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN86 = *OFF                                 1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINH:1:2)
     C     KODS2K        CHAIN     KODTS2                             86
     C                   IF        *IN86 AND *IN30 = *OFF
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END                                                    1<-E
      *
     C                   IF        WSLKH <> *BLANKS
     C                   MOVE      WSLKH         KS2LK
     C     KODS2K        CHAIN     KODTS2                             85
     C   85
     CANN30              MOVE      'SPL0001'     MSGNR
     C   85              EVAL      *IN30 = *ON
     C                   END
      * Representative
     C                   IF        WSKNA <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNA
     C     CUND1K        CHAIN     CUNDL01                            84
     C                   IF        *IN84                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINA = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINA = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINA = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINA = EORI
     C                   ENDSL                                                     4<-E
     C                   IF        WSCPA = *BLANKS                                 4<-B
     C                   EVAL      WSCPA  = KPERS
     C                   END                                                       4<-E
     C                   IF        WSTLA = *BLANKS                                 4<-B
     C                   EVAL      WSTLA  = TLF
     C                   END                                                       4<-E
     C                   IF        WSEMA = *BLANKS                                 4<-B
     C                   EVAL      WSEMA  = SYEPOS
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * Representative ID
     C*    WSTINA        COMP      *BLANKS                                83
     C* N30              IF        *IN83
     C*                  MOVE      'YBC2131'     MSGNR
     C*                  EVAL      *IN30 = *ON
     C*                  END
      * Garantiref
     C                   IF        WSGFT1 <> *BLANKS
     C                   IF        ((WSGKD <= '1') OR (WSGKD >= '6'))
     C     WSGFT1        CHAIN     TRUGH                              82
     C                   IF        *IN67
     C   82              MOVE      'YBC1900'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   ELSE
     C*                  EVAL      WSGKD  = TGGTY
     C                   MOVE      TGGTY         WSGKD
     C                   EVAL      WSGVK  = TGGVK
     C                   END
     C                   END
     C                   ELSE
     C                   EVAL      TGGBL  = 0
     C                   END
      * Adgangskode
     C                   IF        WSGADK <> *BLANKS
     C                   IF        ((WSGKD <= '1') OR (WSGKD >= '6'))
     C                   IF        WSGFT1 = *BLANKS
     C                   MOVE      '105'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSGADK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           81
     C                   ELSE
     C     WSGADK        COMP      TGAKNY                             8181
     C   81TRUGDK        CHAIN     TRUGD                              81
     C                   END
     C   81
     CANN30              MOVE      'YBC0811'     MSGNR
     C   81              SETON                                        30
     C                   END
     C                   END
      * Garanti prosent eller beløp
     C                   SELECT
     C                   WHEN      WSGBL = 0 AND WSGPR = 0
     C                   MOVE      '1'           *IN66
     C  N30              MOVE      'YBC2020'     MSGNR
     C                   WHEN      WSGBL > 0 AND WSGPR > 0
     C                   MOVE      '1'           *IN66
     C  N30              MOVE      'YBC2021'     MSGNR
     C                   WHEN      ((WSGKD <= '1') OR (WSGKD >= '6'))
     C     WSGPR         COMP      0                                      80
     C   80
     CANN30              MOVE      'YBC1909'     MSGNR
     C                   OTHER
     C     WSGBL         COMP      1000                                 80
     C   80
     CANN30              MOVE      'YBC1912'     MSGNR
     C                   ENDSL
     C   80              EVAL      *IN30 = *ON
      * Valutakode til garanti
     C                   IF        WSGVK <> *BLANKS
     C     WSGVK         CHAIN     KODTVAL2                           79
     C   79
     CANN30              MOVE      'SPV0001'     MSGNR
     C   79              EVAL      *IN30 = *ON
     C                   END
      * Avsenderland
     C                   IF        WSALK <> *BLANKS
     C                   MOVE      WSALK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             78
     C   78
     CANN30              MOVE      'SPL0001'     MSGNR
     C   78              EVAL      *IN30 = *ON
     C                   END
      * Bestemmelsesland
     C                   IF        WSBLK <> *BLANKS
     C                   MOVE      WSBLK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             77
     C   77
     CANN30              MOVE      'SPL0001'     MSGNR
     C   77              EVAL      *IN30 = *ON
     C                   END
      * Carrier
     C                   IF        WSKNC <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNH
     C     CUND1K        CHAIN     CUNDL01                            76
     C                   IF        *IN76                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 11
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINC = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINC = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINC = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINC = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAC  = KNAVN
     C                   IF        WSTLC = *BLANKS                                3<-B
     C                   EVAL      WSTLC  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEMC = *BLANKS                                3<-B
     C                   EVAL      WSEMC  = SYEPOS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN76 = *OFF AND WSTINC <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINC:1:2)
     C     KODS2K        CHAIN     KODTS2                             76
     C                   IF        *IN76 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 11
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      * Avsender
     C                   IF        WSKNS <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNS
     C     CUND1K        CHAIN     CUNDL01                            75
     C                   IF        *IN75                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 12
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINS = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINS = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINS = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINS = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAS  = KNAVN
     C                   EVAL      WSAD1S = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNS  = *BLANKS
     C                   MOVEL     POSTNR        WSPNS
     C                   ELSE                                                     3
     C                   EVAL      WSPNS  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSS  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKS  = SYLAND
     C                   END                                                      3<-E
     C                   IF        WSCPS = *BLANKS                                3<-B
     C                   EVAL      WSCPS  = KPERS
     C                   END                                                      3<-E
     C                   IF        WSTLS = *BLANKS                                3<-B
     C                   EVAL      WSTLS  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEMS = *BLANKS                                3<-B
     C                   EVAL      WSEMS  = SYEPOS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN75 = *OFF AND WSTINS <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINS:1:2)
     C     KODS2K        CHAIN     KODTS2                             75
     C                   IF        *IN75 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 12
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        WSLKS <> *BLANKS
     C                   MOVE      WSLKS         KS2LK
     C     KODS2K        CHAIN     KODTS2                             74
     C   74
     CANN30              MOVE      'SPL0001'     MSGNR
     C   74              EVAL      *IN30 = *ON
     C                   END
      * Mottaker
     C                   IF        WSKNK <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNK
     C     CUND1K        CHAIN     CUNDL01                            73
     C                   IF        *IN73                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C  N30              EVAL      LINNBR = 15
     C  N30              EVAL      POSNBR = 12
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINK = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINK = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINK = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINK = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSNAK  = KNAVN
     C                   EVAL      WSAD1K = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNK  = *BLANKS
     C                   MOVEL     POSTNR        WSPNK
     C                   ELSE                                                     3
     C                   EVAL      WSPNK  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSK  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKK  = SYLAND
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        *IN73 = *OFF AND WSTINK <> *BLANKS           1<-B
     C                   EVAL      KS2LK = %SUBST(WSTINK:1:2)
     C     KODS2K        CHAIN     KODTS2                             73
     C                   IF        *IN73 AND *IN30 = *OFF                        2<-B
     C                   EVAL      LINNBR = 15
     C                   EVAL      POSNBR = 21
     C                   MOVE      'YBC2289'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        WSLKK <> *BLANKS
     C                   MOVE      WSLKK         KS2LK
     C     KODS2K        CHAIN     KODTS2                             72
     C   72
     CANN30              MOVE      'SPL0001'     MSGNR
     C   72              EVAL      *IN30 = *ON
     C                   END
      * Tollsted
     C                   IF        WSLGTS <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSLGTS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           71
     C   71
     CANN30              MOVE      'YBC1768'     MSGNR
     C   71              EVAL      *IN30 = *ON
     C                   END
      * Økonomi
     C                   IF        WSKNE <> 0                                   1<-B
     C                   EVAL      KUNDNR = WSKNK
     C     CUND1K        CHAIN     CUNDL01                            70
     C                   IF        *IN70                                         2<-B
     C  N30              EVAL      MSGNR  = 'SPK0001'
     C                   EVAL      *IN30 = *ON
     C                   ELSE                                                    2
     C                   IF        WSTINE = *BLANKS                               3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      EORI = *BLANKS                                  4
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))     5<-B
     C                   IF        SYLAND = *BLANKS                                  6<-B
     C                   EVAL      WSTINE = 'NO' + SYFOR9
     C                   ELSE                                                        6
     C                   EVAL      WSTINE = SYLAND + SYFOR9
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   OTHER                                                     4
     C                   EVAL      WSTINE = EORI
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   EVAL      WSADE1 = ADR1
     C                   IF        SYPOGE = *BLANKS                               3<-B
     C                   EVAL      WSPNE  = *BLANKS
     C                   MOVEL     POSTNR        WSPNE
     C                   ELSE                                                     3
     C                   EVAL      WSPNE  = SYPOGE
     C                   END                                                      3<-E
     C                   EVAL      WSPSE  = ADR3
     C                   IF        SYLAND <> *BLANKS                              3<-B
     C                   EVAL      WSLKE  = SYLAND
     C                   END                                                      3<-E
     C                   IF        WSCPE = *BLANKS                                3<-B
     C                   EVAL      WSCPE  = KPERS
     C                   END                                                      3<-E
     C                   IF        WSTLE = *BLANKS                                3<-B
     C                   EVAL      WSTLE  = TLF
     C                   END                                                      3<-E
     C                   IF        WSEME = *BLANKS                                3<-B
     C                   EVAL      WSEME  = SYEPOS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   IF        WSLKE2 <> *BLANKS
     C                   MOVE      WSLKE2        KS2LK
     C     KODS2K        CHAIN     KODTS2                             69
     C   69
     CANN30              MOVE      'SPL0001'     MSGNR
     C   69              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSLKE <> *BLANKS
     C                   MOVE      WSLKE         KS2LK
     C     KODS2K        CHAIN     KODTS2                             68
     C   68
     CANN30              MOVE      'SPL0001'     MSGNR
     C   68              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSTRM <> 0
     C*    KODS4K        CHAIN     KODTS4                             67
     C                   MOVE      '750'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTRM         YKODE
     C     TRK01K        CHAIN     TRKODL01                           67
     C   67
     CANN30              MOVE      'YBC2261'     MSGNR
     C   67              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSTALK <> *BLANKS
     C                   MOVE      WSTALK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             66
     C   66
     CANN30              MOVE      'SPL0001'     MSGNR
     C   66              EVAL      *IN30 = *ON
     C                   END
      * Landkode 1 i rute
     C                   IF        WSLKR1 <> *BLANKS
     C                   MOVE      WSLKR1        KS2LK
     C     KODS2K        CHAIN     KODTS2                             65
     C   65
     CANN30              MOVE      'SPL0001'     MSGNR
     C   65              EVAL      *IN30 = *ON
     C                   END
      * Landkode 2 i rute
     C                   IF        WSLKR2 <> *BLANKS
     C                   MOVE      WSLKR2        KS2LK
     C     KODS2K        CHAIN     KODTS2                             64
     C   64
     CANN30              MOVE      'SPL0001'     MSGNR
     C   64              EVAL      *IN30 = *ON
     C                   END
      * Landkode 3 i rute
     C                   IF        WSLKR3 <> *BLANKS
     C                   MOVE      WSLKR3        KS2LK
     C     KODS2K        CHAIN     KODTS2                             63
     C   63
     CANN30              MOVE      'SPL0001'     MSGNR
     C   63              EVAL      *IN30 = *ON
     C                   END
      * Landkode 4 i rute
     C                   IF        WSLKR4 <> *BLANKS
     C                   MOVE      WSLKR4        KS2LK
     C     KODS2K        CHAIN     KODTS2                             62
     C   62
     CANN30              MOVE      'SPL0001'     MSGNR
     C   62              EVAL      *IN30 = *ON
     C                   END
      * Landkode 5 i rute
     C                   IF        WSLKR5 <> *BLANKS
     C                   MOVE      WSLKR5        KS2LK
     C     KODS2K        CHAIN     KODTS2                             61
     C   61
     CANN30              MOVE      'SPL0001'     MSGNR
     C   61              EVAL      *IN30 = *ON
     C                   END
      * Landkode 6 i rute
     C                   IF        WSLKR6 <> *BLANKS
     C                   MOVE      WSLKR6        KS2LK
     C     KODS2K        CHAIN     KODTS2                             60
     C   60
     CANN30              MOVE      'SPL0001'     MSGNR
     C   60              EVAL      *IN30 = *ON
     C                   END
      * Tollsted grense
     C                   IF        WSTGTS <> *BLANKS
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTGTS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           59
     C   59
     CANN30              MOVE      'YBC1768'     MSGNR
     C   59              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSTRMG <> 0
     C                   MOVE      '219'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTRMG        YKODE
     C     TRK01K        CHAIN     TRKODL01                           58
     C   58
     CANN30              MOVE      'YBC2261'     MSGNR
     C   58              EVAL      *IN30 = *ON
     C                   END
      * Tollsted grense, landkode
     C                   IF        WSTGLK <> *BLANKS
     C                   MOVE      WSTGLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             57
     C   57
     CANN30              MOVE      'SPL0001'     MSGNR
     C   57              EVAL      *IN30 = *ON
     C                   END
      * Lastested, landkode
     C                   IF        WSLSLK <> *BLANKS
     C                   MOVE      WSLSLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             56
     C   56
     CANN30              MOVE      'SPL0001'     MSGNR
     C   56              EVAL      *IN30 = *ON
     C                   END
      * Lossested, landkode
     C                   IF        WSLOLK <> *BLANKS
     C                   MOVE      WSLOLK        KS2LK
     C     KODS2K        CHAIN     KODTS2                             55
     C   55
     CANN30              MOVE      'SPL0001'     MSGNR
     C   55              EVAL      *IN30 = *ON
     C                   END
      *
     C                   IF        WSDKR <> *BLANKS
     C                   MOVE      '047'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDKR         YKODE
     C     TRK01K        CHAIN     TRKODL01                           54
     C   54
     CANN30              MOVE      'YBC0854'     MSGNR
     C   54              EVAL      *IN30 = *ON
     C                   END
      * Språkkode
     C*                  IF        WSSKFD <> *BLANKS
     C*                  MOVE      '012'         YUNIK
     C*                  EVAL      YKODE = WSSKFD
     C*    TRK01K        CHAIN     TRKODL01                           54
     C*  54
     C*NN30              MOVE      'YBC0810'     MSGNR
     C*  54              EVAL      *IN30 = *ON
     C*                  END
      *
     C     WSDST         COMP      *BLANKS                                53
     C                   IF        *IN53
     C  N30              MOVE      'SPK0001'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C   53              Z-ADD     25            LINNBR
     C   53              Z-ADD     57            POSNBR
     C   54              Z-ADD     25            LINNBR
     C   54              Z-ADD     13            POSNBR
     C   55              Z-ADD     24            LINNBR
     C   55              Z-ADD     89            POSNBR
     C   56              Z-ADD     24            LINNBR
     C   56              Z-ADD     26            POSNBR
     C   57              Z-ADD     23            LINNBR
     C   57              Z-ADD     84            POSNBR
     C   58              Z-ADD     23            LINNBR
     C   58              Z-ADD     39            POSNBR
     C   59              Z-ADD     23            LINNBR
     C   59              Z-ADD     25            POSNBR
     C   60              Z-ADD     22            LINNBR
     C   60              Z-ADD     90            POSNBR
     C   61              Z-ADD     22            LINNBR
     C   61              Z-ADD     87            POSNBR
     C   62              Z-ADD     22            LINNBR
     C   62              Z-ADD     84            POSNBR
     C   63              Z-ADD     22            LINNBR
     C   63              Z-ADD     81            POSNBR
     C   64              Z-ADD     22            LINNBR
     C   64              Z-ADD     78            POSNBR
     C   65              Z-ADD     22            LINNBR
     C   65              Z-ADD     75            POSNBR
     C   66              Z-ADD     22            LINNBR
     C   66              Z-ADD     65            POSNBR
     C   67              Z-ADD     22            LINNBR
     C   67              Z-ADD     12            POSNBR
     C   68              Z-ADD     20            LINNBR
     C   68              Z-ADD     122           POSNBR
     C   69              Z-ADD     19            LINNBR
     C   69              Z-ADD     81            POSNBR
     C   70              Z-ADD     19            LINNBR
     C   70              Z-ADD     12            POSNBR
     C   71              Z-ADD     18            LINNBR
     C   71              Z-ADD     87            POSNBR
     C   72              Z-ADD     16            LINNBR
     C   72              Z-ADD     122           POSNBR
     C*  73              Z-ADD     15            LINNBR
     C*  73              Z-ADD     12            POSNBR
     C   74              Z-ADD     13            LINNBR
     C   74              Z-ADD     122           POSNBR
     C*  75              Z-ADD     12            LINNBR
     C*  75              Z-ADD     12            POSNBR
     C*  76              Z-ADD     11            LINNBR
     C*  76              Z-ADD     12            POSNBR
     C   77              Z-ADD     10            LINNBR
     C   77              Z-ADD     23            POSNBR
     C   78              Z-ADD     10            LINNBR
     C   78              Z-ADD     12            POSNBR
     C   79              Z-ADD     9             LINNBR
     C   79              Z-ADD     123           POSNBR
     C   80              Z-ADD     9             LINNBR
     C   80              Z-ADD     91            POSNBR
     C   81              Z-ADD     9             LINNBR
     C   81              Z-ADD     75            POSNBR
     C   82              Z-ADD     9             LINNBR
     C   82              Z-ADD     14            POSNBR
     C   83              Z-ADD     7             LINNBR
     C   83              Z-ADD     21            POSNBR
     C   84              Z-ADD     7             LINNBR
     C   84              Z-ADD     12            POSNBR
     C   85              Z-ADD     5             LINNBR
     C   85              Z-ADD     122           POSNBR
     C*  86              Z-ADD     4             LINNBR
     C*  86              Z-ADD     12            POSNBR
     C   91              Z-ADD     4             LINNBR
     C   91              Z-ADD     117           POSNBR
     C*  87              Z-ADD     3             LINNBR
     C*  87              Z-ADD     109           POSNBR
     C*  88              Z-ADD     3             LINNBR
     C*  88              Z-ADD     100           POSNBR
     C*  89              Z-ADD     3             LINNBR
     C*  89              Z-ADD     91            POSNBR
     C*  90              Z-ADD     3             LINNBR
     C*  90              Z-ADD     82            POSNBR
     C*  91              Z-ADD     3             LINNBR
     C*  91              Z-ADD     73            POSNBR
     C   92              Z-ADD     3             LINNBR
     C   92              Z-ADD     64            POSNBR
     C   93              Z-ADD     3             LINNBR
     C   93              Z-ADD     55            POSNBR
     C   94              Z-ADD     3             LINNBR
     C   94              Z-ADD     46            POSNBR
     C   95              Z-ADD     3             LINNBR
     C   95              Z-ADD     29            POSNBR
     C   96              Z-ADD     3             LINNBR
     C   96              Z-ADD     16            POSNBR
     C   97              Z-ADD     2             LINNBR
     C   97              Z-ADD     31            POSNBR
     C   98              Z-ADD     2             LINNBR
     C   98              Z-ADD     26            POSNBR
     C   99              Z-ADD     2             LINNBR
     C   99              Z-ADD     10            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEW         BEGSR
     C***********************************************
     C                   EVAL      WSTDN  = THTDN
     C                   MOVE      THDTD         WSDTD
     C                   MOVE      THDTM         WSDTM
     C                   MOVE      THDTÅ         WSDTÅ
     C                   EVAL      WSENKL = THENKL
     C                   EVAL      WSNTTD = THNTTD
     C                   EVAL      WSNTLL = THNTLL
     C                   EVAL      WSFMLL = THFMLL
     C*                  EVAL      WSNPNS = THNPNS
     C                   EVAL      WSDK   = THDK
     C                   EVAL      WSDKT  = THDKT
     C                   EVAL      WSATYP = THATYP
     C                   EVAL      WSAREF = THAREF
     C                   EVAL      WSCATS = THCATS
     C                   EVAL      WSTSB  = THTSB
     C                   EVAL      WSTSD1 = THTSD1
     C                   EVAL      WSTSD2 = THTSD2
     C                   EVAL      WSTSD3 = THTSD3
     C*                  EVAL      WSTSD4 = THTSD4
     C*                  EVAL      WSTSD5 = THTSD5
     C*                  EVAL      WSTSD6 = THTSD6
     C*                  EVAL      WSTSD7 = THTSD7
     C*                  EVAL      WSTSD8 = THTSD8
     C                   EVAL      WSCNA  = THCNA
     C                   EVAL      WSCANR = THCANR
     C                   EVAL      WSCDTD = THCDTD
     C                   EVAL      WSCDTM = THCDTM
     C                   EVAL      WSCDTA = THCDTA
     C                   EVAL      WSNPNS = THNPNS
     C                   EVAL      WSKNH  = THKNH
     C                   EVAL      WSTINH = THTINH
     C                   EVAL      WSTIRH = THTIRH
     C                   EVAL      WSNAH  = THNAH
     C                   EVAL      WSAD1H = THAD1H
     C                   EVAL      WSPNH  = THPNH
     C                   EVAL      WSPSH  = THPSH
     C                   EVAL      WSLKH  = THLKH
     C                   EVAL      WSCPH  = THCPH
     C                   EVAL      WSTLH  = THTLH
     C                   EVAL      WSEMH  = THEMH
     C                   EVAL      WSKNA  = THKNA
     C                   EVAL      WSTINA = THTINA
     C                   EVAL      WSSTA  = THSTA
     C                   EVAL      WSCPA  = THCPA
     C                   EVAL      WSTLA  = THTLA
     C                   EVAL      WSEMA  = THEMA
     C                   EVAL      WSGKD  = THGKD
     C                   EVAL      WSGFT1 = THGFT1
     C                   EVAL      WSGFT2 = THGFT2
     C                   EVAL      WSGADK = THGADK
     C                   EVAL      WSGPR  = THGPR
     C                   EVAL      WSGBL  = THGBL
     C                   EVAL      WSGVK  = THGVK
     C                   EVAL      WSALK  = THALK
     C                   EVAL      WSBLK  = THBLK
     C                   EVAL      WSKDC  = THKDC
     C                   EVAL      WSTMIN = THTMIN
     C                   EVAL      WSTMGR = THTMGR
     C                   EVAL      WSUCR  = THUCR
     C                   EVAL      WSKNC  = THKNC
     C                   EVAL      WSTINC = THTINC
     C                   EVAL      WSNAC  = THNAC
     C                   EVAL      WSTLC  = THTLC
     C                   EVAL      WSEMC  = THEMC
     C                   EVAL      WSKNS  = THKNS
     C                   EVAL      WSTINS = THTINS
     C                   EVAL      WSNAS  = THNAS
     C                   EVAL      WSAD1S = THAD1S
     C                   EVAL      WSPNS  = THPNS
     C                   EVAL      WSPSS  = THPSS
     C                   EVAL      WSLKS  = THLKS
     C                   EVAL      WSCPS  = THCPS
     C                   EVAL      WSTLS  = THTLS
     C                   EVAL      WSEMS  = THEMS
     C                   EVAL      WSKNK  = THKNK
     C                   EVAL      WSTINK = THTINK
     C                   EVAL      WSNAK  = THNAK
     C                   EVAL      WSAD1K = THAD1K
     C                   EVAL      WSPNK  = THPNK
     C                   EVAL      WSPSK  = THPSK
     C                   EVAL      WSLKK  = THLKK
     C                   EVAL      WSROLE = THROLE
     C                   EVAL      WSIDR  = THIDR
MRK02C*                  EVAL      WSCNR  = THCNR
MRK02C*                  EVAL      WSDANT = THDANT
MRK02C*                  EVAL      WSDFKD = THDFKD
MRK02C*                  EVAL      WSGINR = THGINR
     C                   EVAL      WSLGTY = THLGTY
     C                   EVAL      WSLGID = THLGID
     C                   EVAL      WSLGAU = THLGAU
     C                   EVAL      WSLGAI = THLGAI
     C                   EVAL      WSLGUN = THLGUN
     C                   EVAL      WSLGTS = THLGTS
     C                   EVAL      WSLGLA = THLGLA
     C                   EVAL      WSLGLO = THLGLO
     C                   EVAL      WSKNE  = THKNE
     C                   EVAL      WSTINE = THTINE
     C                   EVAL      WSADE1 = THADE1
     C                   EVAL      WSPNE  = THPNE
     C                   EVAL      WSPSE  = THPSE
     C                   EVAL      WSLKE  = THLKE
     C                   EVAL      WSCPE  = THCPE
     C                   EVAL      WSTLE  = THTLE
     C                   EVAL      WSEME  = THEME
     C                   EVAL      WSADE2 = THADE2
     C                   EVAL      WSPNE2 = THPNE2
     C                   EVAL      WSLKE2 = THLKE2
     C                   EVAL      WSTRM  = THTRM
     C                   EVAL      WSTAID = THTAID
     C                   EVAL      WSTALK = THTALK
     C                   EVAL      WSLKR1 = THLKR1
     C                   EVAL      WSLKR2 = THLKR2
     C                   EVAL      WSLKR3 = THLKR3
     C                   EVAL      WSLKR4 = THLKR4
     C                   EVAL      WSLKR5 = THLKR5
     C                   EVAL      WSLKR6 = THLKR6
     C                   EVAL      WSTGTS = THTGTS
     C                   EVAL      WSTRMG = THTRMG
     C                   EVAL      WSTGID = THTGID
     C                   EVAL      WSTGLK = THTGLK
     C                   EVAL      WSTGCN = THTGCN
     C                   EVAL      WSLSUN = THLSUN
     C                   EVAL      WSLSLK = THLSLK
     C                   EVAL      WSLSNA = THLSNA
     C                   EVAL      WSLOUN = THLOUN
     C                   EVAL      WSLOLK = THLOLK
     C                   EVAL      WSLONA = THLONA
     C                   EVAL      WSDKR  = THDKR
     C                   EVAL      WSDDT  = THDDT
     C*                  EVAL      WSSKFD = THSKFD
     C                   EVAL      WSDST  = THDST
     C                   EVAL      WSTRCH = THTRCH
      *
     C                   MOVE      S0004         W0004
     C                   MOVE      S0010         W0010
     C                   MOVE      S0035         W0035
     C                   MOVE      THEKST        WSEKST
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVEB         BEGSR
     C***********************************************
     C                   EVAL      WSTDN  = 0
     C                   EVAL      WSDT   = 0
     C                   EVAL      WSENKL = 'N'
     C                   EVAL      WSDK   = *BLANKS
     C                   EVAL      WSDKT  = *BLANKS
     C                   EVAL      WSATYP = *BLANKS
     C                   EVAL      WSAREF = *BLANKS
     C                   EVAL      WSCATS = *BLANKS
     C                   EVAL      WSTSB  = *BLANKS
     C                   EVAL      WSTSD1 = *BLANKS
     C                   EVAL      WSTSD2 = *BLANKS
     C                   EVAL      WSTSD3 = *BLANKS
     C*                  EVAL      WSTSD4 = *BLANKS
     C*                  EVAL      WSTSD5 = *BLANKS
     C*                  EVAL      WSTSD6 = *BLANKS
     C*                  EVAL      WSTSD7 = *BLANKS
     C*                  EVAL      WSTSD8 = *BLANKS
     C                   EVAL      WSCNA  = *BLANKS
     C                   EVAL      WSCANR = *BLANKS
     C                   EVAL      WSCDT  = 0
     C                   EVAL      WSNPNS = *BLANKS
     C                   EVAL      WSKNH  = 0
     C                   EVAL      WSTINH = *BLANKS
     C                   EVAL      WSTIRH = *BLANKS
     C                   EVAL      WSNAH  = *BLANKS
     C                   EVAL      WSAD1H = *BLANKS
     C                   EVAL      WSPNH  = *BLANKS
     C                   EVAL      WSPSH  = *BLANKS
     C                   EVAL      WSLKH  = *BLANKS
     C                   EVAL      WSCPH  = *BLANKS
     C                   EVAL      WSTLH  = *BLANKS
     C                   EVAL      WSEMH  = *BLANKS
     C                   EVAL      WSKNA  = 0
     C                   EVAL      WSTINA = *BLANKS
     C                   EVAL      WSSTA  = 0
     C                   EVAL      WSCPA  = *BLANKS
     C                   EVAL      WSTLA  = *BLANKS
     C                   EVAL      WSEMA  = *BLANKS
     C                   EVAL      WSGKD  = '0'
     C                   EVAL      WSGFT1 = *BLANKS
     C                   EVAL      WSGFT2 = *BLANKS
     C                   EVAL      WSGADK = *BLANKS
     C                   EVAL      WSGPR  = 0
     C                   EVAL      WSGBL  = 0
     C                   EVAL      WSGVK  = *BLANKS
     C                   EVAL      WSALK  = *BLANKS
     C                   EVAL      WSBLK  = *BLANKS
     C                   EVAL      WSKDC  = '0'
     C                   EVAL      WSTMIN = 0
     C                   EVAL      WSTMGR = 0
     C                   EVAL      WSUCR  = *BLANKS
     C                   EVAL      WSKNC  = 0
     C                   EVAL      WSTINC = *BLANKS
     C                   EVAL      WSNAC  = *BLANKS
     C                   EVAL      WSTLC  = *BLANKS
     C                   EVAL      WSEMC  = *BLANKS
     C                   EVAL      WSKNS  = 0
     C                   EVAL      WSTINS = *BLANKS
     C                   EVAL      WSNAS  = *BLANKS
     C                   EVAL      WSAD1S = *BLANKS
     C                   EVAL      WSPNS  = *BLANKS
     C                   EVAL      WSPSS  = *BLANKS
     C                   EVAL      WSLKS  = *BLANKS
     C                   EVAL      WSCPS  = *BLANKS
     C                   EVAL      WSTLS  = *BLANKS
     C                   EVAL      WSEMS  = *BLANKS
     C                   EVAL      WSKNK  = 0
     C                   EVAL      WSTINK = *BLANKS
     C                   EVAL      WSNAK  = *BLANKS
     C                   EVAL      WSAD1K = *BLANKS
     C                   EVAL      WSPNK  = *BLANKS
     C                   EVAL      WSPSK  = *BLANKS
     C                   EVAL      WSLKK  = *BLANKS
     C                   EVAL      WSROLE = *BLANKS
     C                   EVAL      WSIDR  = *BLANKS
MRK02C*                  EVAL      WSCNR  = *BLANKS
MRK02C*                  EVAL      WSDANT = 0
MRK02C*                  EVAL      WSDFKD = *BLANKS
MRK02C*                  EVAL      WSGINR = 0
     C                   EVAL      WSLGTY = *BLANKS
     C                   EVAL      WSLGID = *BLANKS
     C                   EVAL      WSLGAU = *BLANKS
     C                   EVAL      WSLGAI = *BLANKS
     C                   EVAL      WSLGUN = *BLANKS
     C                   EVAL      WSLGTS = *BLANKS
     C                   EVAL      WSLGLA = *BLANKS
     C                   EVAL      WSLGLO = *BLANKS
     C                   EVAL      WSKNE  = 0
     C                   EVAL      WSTINE = *BLANKS
     C                   EVAL      WSADE1 = *BLANKS
     C                   EVAL      WSPNE  = *BLANKS
     C                   EVAL      WSPSE  = *BLANKS
     C                   EVAL      WSLKE  = *BLANKS
     C                   EVAL      WSCPE  = *BLANKS
     C                   EVAL      WSTLE  = *BLANKS
     C                   EVAL      WSEME  = *BLANKS
     C                   EVAL      WSADE2 = *BLANKS
     C                   EVAL      WSPNE2 = *BLANKS
     C                   EVAL      WSLKE2 = *BLANKS
     C                   EVAL      WSTRM  = 0
     C                   EVAL      WSTAID = *BLANKS
     C                   EVAL      WSTALK = *BLANKS
     C                   EVAL      WSLKR1 = *BLANKS
     C                   EVAL      WSLKR2 = *BLANKS
     C                   EVAL      WSLKR3 = *BLANKS
     C                   EVAL      WSLKR4 = *BLANKS
     C                   EVAL      WSLKR5 = *BLANKS
     C                   EVAL      WSLKR6 = *BLANKS
     C                   EVAL      WSTGTS = *BLANKS
     C                   EVAL      WSTRMG = 0
     C                   EVAL      WSTGID = *BLANKS
     C                   EVAL      WSTGLK = *BLANKS
     C                   EVAL      WSTGCN = *BLANKS
     C                   EVAL      WSLSUN = *BLANKS
     C                   EVAL      WSLSLK = *BLANKS
     C                   EVAL      WSLSNA = *BLANKS
     C                   EVAL      WSLOUN = *BLANKS
     C                   EVAL      WSLOLK = *BLANKS
     C                   EVAL      WSLONA = *BLANKS
     C                   EVAL      WSDKR  = *BLANKS
     C                   EVAL      WSDDT  = 0
     C*                  EVAL      WSSKFD = *BLANKS
     C                   EVAL      WSDST  = *BLANKS
     C                   EVAL      WSTRCH = *BLANKS
      *
     C                   Z-ADD     1             WSNTTD
     C                   Z-ADD     1             WSNTLL
     C                   MOVE      'J'           WSFMLL
     C*                  MOVE      *BLANKS       WSNPNS
     C                   MOVE      *BLANKS       W0004
     C                   MOVE      *BLANKS       W0010
     C                   MOVE      *BLANKS       W0035
     C                   MOVE      *BLANKS       WSEKST
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDTRS        BEGSR
     C***********************************************
     C     WSAAVD        CHAIN     NCTSESTD                           33
     C                   EXSR      MOVETR
     C   33              WRITE     NCTSESTDR
     C  N33              UPDATE    NCTSESTDR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVETR        BEGSR
     C***********************************************
     C                   EVAL      THAVD  = WSAAVD
     C                   EVAL      THTDN  = WSTDN
     C                   EVAL      THDT   = 20000000
     C                             + UYEAR * 10000 + UMONTH * 100 + UDAY
     C                   EVAL      THENKL = WSENKL
     C                   EVAL      THNTTD = WSNTTD
     C                   EVAL      THNTLL = WSNTLL
     C                   EVAL      THFMLL = WSFMLL
     C*                  EVAL      THNPNS = WSNPNS
     C                   EVAL      THDK   = WSDK
     C                   EVAL      THDKT  = WSDKT
     C                   EVAL      THATYP = WSATYP
     C                   EVAL      THAREF = WSAREF
     C                   EVAL      THCATS = WSCATS
     C                   EVAL      THTSB  = WSTSB
     C                   EVAL      THTSD1 = WSTSD1
     C                   EVAL      THTSD2 = WSTSD2
     C                   EVAL      THTSD3 = WSTSD3
     C*                  EVAL      THTSD4 = WSTSD4
     C*                  EVAL      THTSD5 = WSTSD5
     C*                  EVAL      THTSD6 = WSTSD6
     C*                  EVAL      THTSD7 = WSTSD7
     C*                  EVAL      THTSD8 = WSTSD8
     C                   EVAL      THTSDE = *BLANKS
     C                   EVAL      THTSDE2 = *BLANKS
     C                   EVAL      THCNA  = WSCNA
     C                   EVAL      THCANR = WSCANR
     C                   IF        WSCDT = 0
     C                   MOVE      *ZEROS        THCDT
     C                   ELSE
     C                   IF        WSCDTA > 50
     C                   Z-ADD     19            THCDTC
     C                   ELSE
     C                   Z-ADD     20            THCDTC
     C                   END
     C                   MOVE      WSCDTA        THCDTA
     C                   MOVE      WSCDTM        THCDTM
     C                   MOVE      WSCDTD        THCDTD
     C                   END
     C                   EVAL      THNPNS = WSNPNS
     C                   EVAL      THKNH  = WSKNH
     C                   EVAL      THTINH = WSTINH
     C                   EVAL      THTIRH = WSTIRH
     C                   EVAL      THNAH  = WSNAH
     C                   EVAL      THAD1H = WSAD1H
     C                   EVAL      THPNH  = WSPNH
     C                   EVAL      THPSH  = WSPSH
     C                   EVAL      THLKH  = WSLKH
     C                   EVAL      THCPH  = WSCPH
     C                   EVAL      THTLH  = WSTLH
     C                   EVAL      THEMH  = WSEMH
     C                   EVAL      THKNA  = WSKNA
     C                   EVAL      THTINA = WSTINA
     C                   EVAL      THSTA  = WSSTA
     C                   EVAL      THCPA  = WSCPA
     C                   EVAL      THTLA  = WSTLA
     C                   EVAL      THEMA  = WSEMA
     C                   EVAL      THGKD  = WSGKD
     C                   EVAL      THGFT1 = WSGFT1
     C                   EVAL      THGFT2 = WSGFT2
     C                   EVAL      THGADK = WSGADK
     C                   EVAL      THGPR  = WSGPR
     C                   EVAL      THGBL  = WSGBL
     C                   EVAL      THGVK  = WSGVK
     C                   EVAL      THALK  = WSALK
     C                   EVAL      THBLK  = WSBLK
     C                   EVAL      THKDC  = WSKDC
     C                   EVAL      THTMIN = WSTMIN
     C                   EVAL      THTMGR = WSTMGR
     C                   EVAL      THUCR  = WSUCR
     C                   EVAL      THKNC  = WSKNC
     C                   EVAL      THTINC = WSTINC
     C                   EVAL      THNAC  = WSNAC
     C                   EVAL      THTLC  = WSTLC
     C                   EVAL      THEMC  = WSEMC
     C                   EVAL      THKNS  = WSKNS
     C                   EVAL      THTINS = WSTINS
     C                   EVAL      THNAS  = WSNAS
     C                   EVAL      THAD1S = WSAD1S
     C                   EVAL      THPNS  = WSPNS
     C                   EVAL      THPSS  = WSPSS
     C                   EVAL      THLKS  = WSLKS
     C                   EVAL      THCPS  = WSCPS
     C                   EVAL      THTLS  = WSTLS
     C                   EVAL      THEMS  = WSEMS
     C                   EVAL      THKNK  = WSKNK
     C                   EVAL      THTINK = WSTINK
     C                   EVAL      THNAK  = WSNAK
     C                   EVAL      THAD1K = WSAD1K
     C                   EVAL      THPNK  = WSPNK
     C                   EVAL      THPSK  = WSPSK
     C                   EVAL      THLKK  = WSLKK
     C                   EVAL      THROLE = WSROLE
     C                   EVAL      THIDR  = WSIDR
MRK02C*                  EVAL      THCNR  = WSCNR
MRK02C*                  EVAL      THDANT = WSDANT
MRK02C*                  EVAL      THDFKD = WSDFKD
MRK02C*                  EVAL      THGINR = WSGINR
     C                   EVAL      THLGTY = WSLGTY
     C                   EVAL      THLGID = WSLGID
     C                   EVAL      THLGAU = WSLGAU
     C                   EVAL      THLGAI = WSLGAI
     C                   EVAL      THLGUN = WSLGUN
     C                   EVAL      THLGTS = WSLGTS
     C                   EVAL      THLGLA = WSLGLA
     C                   EVAL      THLGLO = WSLGLO
     C                   EVAL      THKNE  = WSKNE
     C                   EVAL      THTINE = WSTINE
     C                   EVAL      THADE1 = WSADE1
     C                   EVAL      THPNE  = WSPNE
     C                   EVAL      THPSE  = WSPSE
     C                   EVAL      THLKE  = WSLKE
     C                   EVAL      THCPE  = WSCPE
     C                   EVAL      THTLE  = WSTLE
     C                   EVAL      THEME  = WSEME
     C                   EVAL      THADE2 = WSADE2
     C                   EVAL      THPNE2 = WSPNE2
     C                   EVAL      THLKE2 = WSLKE2
     C                   EVAL      THTRM  = WSTRM
     C                   EVAL      THTAID = WSTAID
     C                   EVAL      THTALK = WSTALK
     C                   EVAL      THLKR1 = WSLKR1
     C                   EVAL      THLKR2 = WSLKR2
     C                   EVAL      THLKR3 = WSLKR3
     C                   EVAL      THLKR4 = WSLKR4
     C                   EVAL      THLKR5 = WSLKR5
     C                   EVAL      THLKR6 = WSLKR6
     C                   EVAL      THTGTS = WSTGTS
     C                   EVAL      THTRMG = WSTRMG
     C                   EVAL      THTGID = WSTGID
     C                   EVAL      THTGLK = WSTGLK
     C                   EVAL      THTGCN = WSTGCN
     C                   EVAL      THLSUN = WSLSUN
     C                   EVAL      THLSLK = WSLSLK
     C                   EVAL      THLSNA = WSLSNA
     C                   EVAL      THLOUN = WSLOUN
     C                   EVAL      THLOLK = WSLOLK
     C                   EVAL      THLONA = WSLONA
     C                   EVAL      THDKR  = WSDKR
     C                   EVAL      THDDT  = WSDDT
     C*                  EVAL      THSKFD = WSSKFD
     C                   EVAL      THDST  = WSDST
     C                   EVAL      THTRCH = WSTRCH
      *
     C                   MOVE      W0004         S0004
     C                   MOVE      W0010         S0010
     C                   MOVE      W0035         S0035
     C                   MOVE      WSEKST        THEKST
      *
     C                   ENDSR
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
      * DEKLARASJONSTYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     14
     C                   MOVE      '031'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDK          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSDK
     C                   Z-ADD     17            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
      * DEKLARASJONSTYPE TILLEGG
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     17
     C                   MOVE      '942'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSDKT         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSDKT
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
      * AUTORISATION TYPE
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     29
     C                   MOVE      '235'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSATYP        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSATYP
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVGANGSTOLLSTED
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     16
     C     POSNBR        ANDLE     23
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSCATS        UKODE
     C                   MOVE      'AVG'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSCATS
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * BESTEMMELSESTEDS TOLLSTED
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     36
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSB         UKODE
     C                   MOVE      'ANK'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSB
     C                   Z-ADD     46            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-1
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     53
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD1        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD1
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-2
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     62
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD2        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD2
     C                   Z-ADD     64            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-3
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     64
     C     POSNBR        ANDLE     71
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTSD3        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTSD3
     C                   Z-ADD     73            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TRANSIT-4
     C*    LINNBR        IFEQ      3
     C*    POSNBR        ANDGE     73
     C*    POSNBR        ANDLE     80
     C*                  MOVE      '106'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSTSD4        UKODE
     C*                  MOVE      'TRS'         UTYPE             3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE
     C*                  MOVEL     UKODE         WSTSD4
     C*                  Z-ADD     82            POSNBR
     C*                  GOTO      SLSOK
     C*                  END
      * TOLLSTED TRANSIT-5
     C*    LINNBR        IFEQ      3
     C*    POSNBR        ANDGE     82
     C*    POSNBR        ANDLE     89
     C*                  MOVE      '106'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSTSD5        UKODE
     C*                  MOVE      'TRS'         UTYPE             3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE
     C*                  MOVEL     UKODE         WSTSD5
     C*                  Z-ADD     91            POSNBR
     C*                  GOTO      SLSOK
     C*                  END
      * TOLLSTED TRANSIT-6
     C*    LINNBR        IFEQ      3
     C*    POSNBR        ANDGE     91
     C*    POSNBR        ANDLE     98
     C*                  MOVE      '106'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSTSD6        UKODE
     C*                  MOVE      'TRS'         UTYPE             3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE
     C*                  MOVEL     UKODE         WSTSD6
     C*                  Z-ADD     100           POSNBR
     C*                  GOTO      SLSOK
     C*                  END
      * TOLLSTED TRANSIT-7
     C*    LINNBR        IFEQ      3
     C*    POSNBR        ANDGE     100
     C*    POSNBR        ANDLE     107
     C*                  MOVE      '106'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSTSD7        UKODE
     C*                  MOVE      'TRS'         UTYPE             3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE
     C*                  MOVEL     UKODE         WSTSD7
     C*                  Z-ADD     109           POSNBR
     C*                  GOTO      SLSOK
     C*                  END
      * TOLLSTED TRANSIT-8
     C*    LINNBR        IFEQ      3
     C*    POSNBR        ANDGE     109
     C*    POSNBR        ANDLE     116
     C*                  MOVE      '106'         UUNIK
     C*                  MOVE      *BLANKS       UKODE
     C*                  MOVEL     WSTSD8        UKODE
     C*                  MOVE      'TRS'         UTYPE             3
     C*                  CALL      'TR002R'
     C*                  PARM                    UUNIK
     C*                  PARM                    UKODE
     C*                  PARM                    UTYPE
     C*                  MOVEL     UKODE         WSTSD8
     C*                  Z-ADD     4             LINNBR
     C*                  Z-ADD     12            POSNBR
     C*                  GOTO      SLSOK
     C*                  END
      * Betalingsmåte
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     127
     C     POSNBR        ANDLE     127
     C                   MOVE      '116'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTRCH        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTRCH
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOLDER
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNH
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     46            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOLDERS LANDKODE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKH
     C                   PARM                    USPED
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * HOVEDANSVARLIGNR
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNA
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Garanti type
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDEQ     12
     C                   MOVE      '251'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGKD         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGKD
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADGANGSKODE FOR GARANTI
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     78
     C                   IF        WSGFT1 <> *BLANKS
     C                   CALL      'TR034R'
     C                   PARM                    WSGFT1
     C                   PARM                    WSGADK
     C                   ELSE
     C                   MOVE      '105'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSGADK        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSGADK
     C                   END
     C                   Z-ADD     91            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Valutakode til garanti
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     123
     C     POSNBR        ANDLE     125
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           UDT               8 0
     C                   CALL      'SAD061F'
     C                   PARM                    WSGVK
     C                   PARM                    UDT
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVSENDERSLANDKODE
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C                   CALL      'SYFI10L'
     C                   PARM                    WSALK
     C                   PARM                    USPED
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * BESTEMMELESLANDKODE
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     23
     C     POSNBR        ANDLE     24
     C                   CALL      'SYFI10L'
     C                   PARM                    WSBLK
     C                   PARM                    USPED
     C                   Z-ADD     35            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Inland mode of transport
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     57
     C     POSNBR        ANDLE     57
     C                   MOVE      '218'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTMIN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTMIN
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * Mode of transport at the border
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     59
     C     POSNBR        ANDLE     59
     C                   MOVE      '218'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTMGR        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTMGR
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORTØR
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNC
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * AVSENDERSNR
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *søk vareadresse avsender
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     46
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNS
     C                   PARM                    WSNAS
     C                   PARM                    WSAD1S
     C                   PARM                    WSAD2S           30
     C                   PARM                    WSAD3S           30
     C                   PARM                    WSLKS
     C                   PARM                    UADRNR            5
     C     wsnas         IFNE      *blanks
     c                   move      wsad3S        ad
     c     ' '           scan      ad            f                 2 0
     c     f             ifgt      9
     c                   eval      wspss=wsad3s
     c                   else
     c                   eval      wspns = %SUBST(ad:1:f-1)
     c                   eval      wspss = %SUBST(ad:f+1:30-f-1)
     c                   move      '.'           wspss
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   END
     C                   END
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL AVSENDER
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKS
     C                   PARM                    USPED
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * MOTTAKERSNR
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNK
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *søk vareadresse mottager
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     17
     C     POSNBR        ANDLE     46
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNK
     C                   PARM                    WSNAK
     C                   PARM                    WSAD1K
     C                   PARM                    WSAD2K           30
     C                   PARM                    WSAD3K           30
     C                   PARM                    WSLKK
     C                   PARM                    UADRNR            5
     C     wsnaK         IFNE      *blanks
     c                   move      wsad3K        ad
     c     ' '           scan      ad            f                 2 0
     c     f             ifgt      9
     c                   eval      wspsK=wsad3k
     c                   else
     c                   eval      wspnk = %SUBST(ad:1:f-1)
     c                   eval      wspsk = %SUBST(ad:f+1:30-f-1)
     c                   move      '.'           wspsk
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   END
     C                   END
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKK
     C                   PARM                    USPED
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADDITIONAL SUPPLY CHAIN ACTOR: Role
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     14
     C                   MOVE      '704'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSROLE        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSROLE
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: Type of location
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     9
     C     POSNBR        ANDLE     9
     C                   MOVE      '347'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGTY
     C                   Z-ADD     13            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: Qualifier of identification
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     13
     C                   MOVE      '326'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGID        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGID
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LOCATION OF GOODS: UN LOCODE
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     66
     C     POSNBR        ANDLE     82
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLGUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLGUN
     C                   Z-ADD     87            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TIL TILLEGGS UN
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     87
     C     POSNBR        ANDLE     94
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSLGTS        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSLGTS
     C                   Z-ADD     96            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ØKONOMI
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     19
     C                   MOVE      *BLANKS       USOKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNE
     C                   PARM                    FIFIRM
     C                   PARM                    USOKKN
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     12            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL ØKONOMI HUSNR
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     81
     C     POSNBR        ANDLE     82
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE2
     C                   PARM                    USPED
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     48            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL ØKONOMI GATEADRESSE
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     122
     C     POSNBR        ANDLE     123
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKE
     C                   PARM                    USPED
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORTTYPE
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     13
     C*                  CALL      'SAD061I'
     C*                  PARM                    WSTRM
     C                   MOVE      '750'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTRM         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTRM
     C                   Z-ADD     31            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AVGANG
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     66
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTALK
     C                   PARM                    USPED
     C                   Z-ADD     75            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 1
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     75
     C     POSNBR        ANDLE     76
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR1
     C                   PARM                    USPED
     C                   Z-ADD     78            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 2
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     78
     C     POSNBR        ANDLE     79
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR2
     C                   PARM                    USPED
     C                   Z-ADD     81            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 3
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     81
     C     POSNBR        ANDLE     82
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR3
     C                   PARM                    USPED
     C                   Z-ADD     84            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 4
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     84
     C     POSNBR        ANDLE     85
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR4
     C                   PARM                    USPED
     C                   Z-ADD     87            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 5
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     87
     C     POSNBR        ANDLE     88
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR5
     C                   PARM                    USPED
     C                   Z-ADD     90            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * RUTE: LANDKODE 6
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     90
     C     POSNBR        ANDLE     91
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR6
     C                   PARM                    USPED
     C                   Z-ADD     23            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TIL AKTIV GRENSE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     32
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTGTS        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTGTS
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TOLLSTED TIL AKTIV GRENSE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     32
     C                   MOVE      '106'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTGTS        UKODE
     C                   MOVE      'TRS'         UTYPE             3
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTGTS
     C                   Z-ADD     39            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORT type
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     39
     C     POSNBR        ANDLE     40
     C                   MOVE      '219'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSTRMG        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE
     C                   MOVEL     UKODE         WSTRMG
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL TRANSPORTMIDDEL VED AKTIV GRENSE
     C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     84
     C     POSNBR        ANDLE     85
     C                   CALL      'SYFI10L'
     C                   PARM                    WSTGLK
     C                   PARM                    USPED
     C                   Z-ADD     94            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * PLACE OF LOADING
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     8
     C     POSNBR        ANDLE     24
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLSUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLSUN
     C                   Z-ADD     26            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL LASTESTED
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     26
     C     POSNBR        ANDLE     27
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLSLK
     C                   PARM                    USPED
     C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * PLACE OF UNLOADING
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     71
     C     POSNBR        ANDLE     87
     C                   MOVE      '244'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSLOUN        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSLOUN
     C                   Z-ADD     89            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * LANDKODE TIL LOSSESTED
     C     LINNBR        IFEQ      24
     C     POSNBR        ANDGE     89
     C     POSNBR        ANDLE     90
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLOLK
     C                   PARM                    USPED
     C                   Z-ADD     92            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    MODE              1
      *
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSAAVD
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODS2K        KLIST
     C                   KFLD                    KS2UNI
     C                   KFLD                    KS2LK
     C*    KODS4K        KLIST
     C*                  KFLD                    KS4UNI
     C*                  KFLD                    WSTRM
     C     TRUGDK        KLIST
     C                   KFLD                    WSGFT1
     C                   KFLD                    WSGADK
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
      *
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVEL     'S2'          KS2UNI
     C*                  MOVEL     'S4'          KS4UNI
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      'N'           USPED             1
     C                   MOVE      *BLANKS       WSEMC
     C                   MOVE      *BLANKS       WSCANR
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   30
      *
     C                   ENDSR
      *
