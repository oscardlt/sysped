      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED LAGERLOKASJONS-ID          ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-49 51-88    ***
      ***                    95-97                            ***
      ***********************************************************
     FGSSLCFOP  UF A E           K DISK
     FGSSLCF    IF   E           K DISK
     F                                     RENAME(GSSLCFR:GSSLCFR0)
     FGSSBIF    IF   E           K DISK
     FGSS071D   CF   E             WORKSTN
     F                                     SFILE(GSS071DA:ZRECNO)
     F                                     INFDS(FBAREA)
     FLISTE     O    F   36        PRINTER OFLIND(*INOF)
     F                                     USROPN
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  DATA                   1     36
     D  DATA1                  4     36
     D  DATA3                  1      3
     D UCMD            DS          1024
     D                 DS
     D XCMD01          C                   CONST('OVRPRTF -
     D                                     FILE(LISTE) -
     D                                     OUTQ(')
     D XCMD02          C                   CONST('PAGESIZE(73 132) -
     D                                     CPI(10) -
     D                                     OVRFLW(73)')
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH00,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS            13
     D XLCID           C                   CONST('LOKASJONS-ID:')
     D                 DS
     D  XPRE                   1      3
     D  LCSTD                  4      8
     D  LCLC                   9     28
     D  XLOKID                 1     28
      *
     C                   EXSR      INIT
      *
     C     START0        TAG
     C                   EXFMT     GSS071DH
     C                   MOVE      '0'           *IN99
     C                   MOVE      '0'           *IN30
      *
     C   03              GOTO      SLUTT
     C     WSPRT         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN99
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1811'     MSGNR
     C                   GOTO      START0
     C                   END
      *
      * OVERSTYRE PRINTERFIL
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD01        CAT       WSPRT:0       UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD02:1      UCMD
     C                   CALL      'QCMDEXC'                            55
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     GSS071DB
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      W2STD         YSTD              5
     C                   MOVE      W2LC          YLC              20
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     GLCK1         SETLL     GSSLCF
     C     START1        TAG
     C                   READ      GSSLCF                                 94
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        16
     C                   ADD       1             ZRECNO
     C                   WRITE     GSS071DA
     C                   READ      GSSLCF                                 94
     C  N94              MOVE      LCSTD         XSTD              5
     C  N94              MOVE      LCLC          XLC              20
     C  N94              MOVE      LCST          XST               1
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     GSS071DG
     C                   ELSE
     C                   WRITE     GSS071DB
     C                   EXFMT     GSS071DC
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      ***
      *
     C                   SETOFF                                       9830
      *** AVSLUTT
     C   03              GOTO      SLUTT
      *** FRISK OPP
     C   05              GOTO      START
      *** LAGE NY
     C   06              DO
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   EXSR      MOVB2
     C                   GOTO      START5
     C                   END
      *** SØK FRA
     C   08              GOTO      START6
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      XSTD          LCSTD
     C                   MOVE      XLC           LCLC
     C                   MOVE      XST           LCST
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
      *
      *** LAGE NY
     C     START5        TAG
     C                   EXFMT     GSS071DD
     C                   MOVEA     '00'          *IN(89)
     C                   MOVE      '0'           *IN30
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** SØK FRA
     C     START6        TAG
     C                   EXFMT     GSS071DE
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSSTD         COMP      *BLANKS                                90
     C   90              MOVE      'YBC1812'     MSGNR
     C   90              MOVE      '1'           *IN30
     C  N90GLCKEY        CHAIN(N)  GSSLCFOP                           33
     C  N90
     CANN33              DO
     C                   MOVE      'YBC1813'     MSGNR
     C                   SETON                                        3090
     C                   END
     C   90              Z-ADD     22            LINNBR
     C   90              Z-ADD     5             POSNBR
      *
     C     WSLC          COMP      *BLANKS                                89
     C   89
     CANN30              MOVE      'YBC1814'     MSGNR
     C   89
     CANN30              Z-ADD     22            LINNBR
     C   89
     CANN30              Z-ADD     11            POSNBR
     C   89              SETON                                        30
      *
     C   30              GOTO      SLTB1
      *
      *** OPPDATERE PÅ REGISTER OG SUBFIL
     C     GLCKEY        CHAIN     GSSLCFOP                           33
     C                   EXSR      MOVWLC
     C                   WRITE     GSSLCFR
     C                   EXSR      PRTLC
      *
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     GSS071DA
     C                   WRITE     GSS071DB
     C                   EXSR      MOVB2
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     GSS071DA                               98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       16            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     LCSTD         COMP      '*DEL '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      DLTLC
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '6'
     C                   MOVE      ' '           WSNR
     C     LCSTD         COMP      '*DEL '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      PRTLC
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'GSS0009'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTLC         BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   EXFMT     GSS071DF
     C  N12              DO
     C     GLCK2         CHAIN     GSSLCFOP                           33
     C  N33              DELETE    GSSLCFR
     C                   EXSR      MOVB1
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    GSS071DA
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTLC         BEGSR
     C***********************************************
      * OPEN PRINTERFILE
     C                   OPEN      LISTE                                55
      * EXECUTE INIT ROUTINE ONLY ONCE
     C                   EXSR      SRINIT
      *
      * EXECUTE LABEL INIT
     C                   EXSR      SR0001
      * EXECUTE LOCATION-ID
     C                   EXSR      SR0010
      * EXECUTE LOCATION-ID AS BAR CODES
     C                   EXSR      SR0060
      * EXECUTE END LABEL FORMAT
     C                   EXSR      SREND
      *
      * CLOSE PRINERFILE
     C                   CLOSE     LISTE                                55
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWLC        BEGSR
     C***********************************************
     C                   MOVE      WSSTD         LCSTD
     C                   MOVE      WSLC          LCLC
     C                   MOVE      'P'           LCST
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      '*DEL '       LCSTD
     C                   MOVE      *BLANKS       LCLC
     C                   MOVE      ' '           LCST
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *BLANKS       WSLC
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     GLCKEY        KLIST
     C                   KFLD                    WSSTD
     C                   KFLD                    WSLC
     C     GLCK1         KLIST
     C                   KFLD                    YSTD
     C                   KFLD                    YLC
     C     GLCK2         KLIST
     C                   KFLD                    LCSTD
     C                   KFLD                    LCLC
      *
     C     *ENTRY        PLIST
     C                   PARM                    UUSR             10
      *
     C     UUSR          CHAIN     GSSBIF                             33
     C                   MOVE      BIPRTM        WSPRT
      *
     C                   ENDSR
      *
      *_____________________________________________________
      * INITIALISE SUBROUTINE, SET CHARACTER SET
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
     C                   MOVE      *ON           *IN50
      *
     C                   BITOFF    '02'          WA                1            DEC 5E
     C                   BITON     '134567'      WA                             DEC 5E
      *
     C                   MOVEL     WA            WA0               3            A0
     C                   MOVE      'A0'          WA0               3            A0
      *
     C                   MOVEL     WA            WAA               3            AA
     C                   MOVE      'AA'          WAA               3            AA
      *
     C                   MOVEL     WA            WAD               3            AD
     C                   MOVE      'AD'          WAD               3            AD
      *
     C                   MOVEL     WA            WAE               3            AE
     C                   MOVE      'AE'          WAE               3            AE
      *
     C                   MOVEL     WA            WAP               3            AP
     C                   MOVE      'AP'          WAP               3            AP
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVEL     WA            WB2               3            B2
     C                   MOVE      'B2'          WB2               3            B2
      *
     C                   MOVEL     WA            WXA               3            XA
     C                   MOVE      'XA'          WXA               3            XA
      *
     C                   MOVEL     WA            WCF               3            CF
     C                   MOVE      'CF'          WCF               3            CF
      *
     C                   MOVEL     WA            WCI               3            CI
     C                   MOVE      'CI'          WCI               3            CI
      *
     C                   MOVEL     WA            WXZ               3            XZ
     C                   MOVE      'XZ'          WXZ               3            XZ
      *
     C                   MOVEL     WA            WFO               3            FO
     C                   MOVE      'FO'          WFO               3            FO
      *
     C                   MOVEL     WA            WFD               3            FD
     C                   MOVE      'FD'          WFD               3            FD
      *
     C                   MOVEL     WA            WFS               3            FS
     C                   MOVE      'FS'          WFS               3            FS
      *
     C                   MOVEL     WA            WGB               3            GB
     C                   MOVE      'GB'          WGB               3            GB
      *
     C                   MOVEL     WA            WLH               3            LH
     C                   MOVE      'LH'          WLH               3            LH
      *
     C                   MOVEL     WA            WFW               3            FW
     C                   MOVE      'FW'          WFW               3            FW
      *
     C                   MOVEL     WA            WBY               3            BY
     C                   MOVE      'BY'          WBY               3            BY
      *
     C                   MOVE      *BLANKS       MSGVAR            7            MESSAGE VARIABEL
     C                   MOVE      '999'         XPRE
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LABEL INIT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0001        BEGSR
      * SEND DEFAULT INSTRUCTIONS
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LOCATION-ID
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0010        BEGSR
      * START OF TEXT BIT (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXA           DATA
     C                   EXCEPT    LISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XLCID         DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      * START OF TEXT BIT (^XA)
      *                    MOVE *BLANKS   DATA
      *                    MOVELWXA       DATA
      *                    EXCPTLISTEA
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '540,720'     DATA1
     C                   EXCEPT    LISTEA
      * FONT
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WA0           DATA
     C                   MOVEL     'R,70,50'     DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     LCSTD         DATA1
     C                   CAT       LCLC:1        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * EXECUTE LOCATION-ID AS BARCODE
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR0060        BEGSR
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFO           DATA
     C                   MOVEL     '150,300'     DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE FIELD DEFAULT)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^BY'         DATA
     C*                    MOVEL'3,3:1,15'DATA1
     C                   MOVEL     '4,4:1,15'    DATA1
     C                   EXCEPT    LISTEA
      * FONT (SELECTING BARCODE INTERLEAVED 2 OF 5)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^B3'         DATA
     C*                    MOVEL'R,N,90,Y'DATA1
     C                   MOVEL     'R,N,120,'    DATA1
     C                   CAT       'Y':0         DATA1
     C                   EXCEPT    LISTEA
      * TEXT TO BE PRINTED AS BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFD           DATA
     C                   MOVEL     XLOKID        DATA1
     C                   EXCEPT    LISTEA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WFS           DATA
     C                   EXCEPT    LISTEA
      *
     C                   ENDSR
      *_____________________________________________________
      * SUBROUTINE TO END LABEL FORMAT
      *"""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SREND         BEGSR
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     WXZ           DATA
     C                   EXCEPT    LISTEA
     C                   ENDSR
      *
     OLISTE     E            LISTEA
     O                       DATA
