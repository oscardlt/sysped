********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 sh  PTF10 div gamle ptf'er + div
10XXX * 02 sh  PTF10 innført vedlegg avvik
10XXX * 03 sh  PTF10 fast emnerubrikk
10XXX * 04 sh  PTF10 avdelinger
10XXX * 05 sh  PTF10 oppdragstyper
10XXX * 06 sh  PTF10 utvide bilde ved godkujent ny + søking
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 08 sh  PTF11 finpuss bildeframvisning             g
11XXX * 09 YBC PTF11 VIS ULIKE LEDERTEKST VED ULIKE BRUK
11XXX * 10 sh  PTF11 cavd tømt i init
11XXX * 11 sh  PTF11 tester funksjon
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12015 * 12 YBC PTF12 Auto registrering av utv.id og std.melding
12016 * 13 YBC PTF12 Ikke tøm skjermbilde ved utvidet modul
12016 * 14 SH  PTF12 unntak advis til PTF 11
12016 * 15 SH  PTF12 teste epostadresse
12XXX * 16 SH  PTF12 epostadresse må slutte med a-z eller A-Z
12XXX * 17 SH  PTF12 ikke teste epostadresse ved EHF / B2B
12XXX * 18 SH  PTF12 ikke teste epostadresse ved EHF / B2B
12XXX * 19 SH  PTF12 ikke æ ø å i mauiladresse
12XXX * 20 SH  PTF12 ikke , i epostadressen
12197 * 21 YBC PTF12 Proteria er på samme måte som EMMA
XXXXX * 22 SH  PTF12 må ha . et sted etter @
********************************************************************
""""" *   VEDLIKEHOLD AV KUNDES KONTAKTPERSON/FUNKSJON             *
""""" *   OBS! Programmet er primitivt - returnerer hvis 0 records *
""""" *        Derfor: Kallende prog ansvarlig for at minst en     *
""""" *                record finnes (evt av filtrert type)        *
********************************************************************
N06  FKOFAST    IF   E           K DISK
N11  FKOFASTL1  IF   E           K DISK    RENAME(KOFASTR:KOFASTR2)
N02  FARKTXTL1  IF   E           K DISK
N02  FARKVEDK   UF A E           K DISK
     FCUNDC     UF A E             DISK    INFDS(CUNDS)
     FCUNDC01   IF   E           K DISK    INFDS(CUNDS1)
     F                                     RENAME(CUNDCR:CUNDCR1)
N09  FCUNDC02   IF   E           K DISK    RENAME(CUNDCR:CUNDCR2)
N09  F                                     PREFIX(C2_)
     FCUNDL01   IF   E           K DISK
N12  FEDII      IF   E           K DISK
N12  FECMSG     IF   E           K DISK
     FVCUNDCD   CF   E             WORKSTN SFILE(VCUNDCD4:ZRECNO)
     F                                     INFDS(FBAREA)
     D TXT             S             15    DIM(1) CTDATA PERRCD(1)
N16  D                 DS
N16  D  CEMAIL                 1     70
N16  D  CE                     1     70
N16  D                                     DIM(70)
N18  D                 DS
N18  D  CEMAILN                1     70
N18  D  CEN                    1     70
N18  D                                     DIM(70)
     D CUNDS           DS
     D  RRNP                 397    400B 0
     D CUNDS1          DS
     D  RRNP1                397    400B 0
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
      *
N11  D                 DS
N11  D  CTYPE                  1     30
N11  D  CTYPE1                 1      1
N12  D  CTYPE7                 1      7
N11  D  CTYPE29                2     30
N01  D                 DS
N01  D  SFTYPH                 1     44
N01  D  SFYPE                  1     28
N01  D  SFHONE                30     44
N02  D                 DS
N02  D  V                      1     60
N02  D                                     DIM(30)
N02  D  AVKVED                 1     60
N02  D  V01                    1      2
N02  D  V02                    3      4
N02  D  V03                    5      6
N02  D  V04                    7      8
N02  D  V05                    9     10
N02  D  V06                   11     12
N02  D  V07                   13     14
N02  D  V08                   15     16
N02  D  V09                   17     18
N02  D  V10                   19     20
N02  D  V11                   21     22
N02  D  V12                   23     24
N02  D  V13                   25     26
N02  D  V14                   27     28
N02  D  V15                   29     30
N02  D  V16                   31     32
N02  D  V17                   33     34
N02  D  V18                   35     36
N02  D  V19                   37     38
N02  D  V20                   39     40
N02  D  V21                   41     42
N02  D  V22                   43     44
N02  D  V23                   45     46
N02  D  V24                   47     48
N02  D  V25                   49     50
N02  D  V26                   51     52
N02  D  V27                   53     54
N02  D  V28                   55     56
N02  D  V29                   57     58
N02  D  V30                   59     60
N02  D                 DS
N02  D  w                      1     60
N02  D                                     DIM(30)
N02  D  WSKVED                 1     60
N02  D  W01                    1      2
N02  D  W02                    3      4
N02  D  W03                    5      6
N02  D  W04                    7      8
N02  D  W05                    9     10
N02  D  W06                   11     12
N02  D  W07                   13     14
N02  D  W08                   15     16
N02  D  W09                   17     18
N02  D  W10                   19     20
N02  D  W11                   21     22
N02  D  W12                   23     24
N02  D  W13                   25     26
N02  D  W14                   27     28
N02  D  W15                   29     30
N02  D  W16                   31     32
N02  D  W17                   33     34
N02  D  W18                   35     36
N02  D  W19                   37     38
N02  D  W20                   39     40
N02  D  W21                   41     42
N02  D  W22                   43     44
N02  D  W23                   45     46
N02  D  W24                   47     48
N02  D  W25                   49     50
N02  D  W26                   51     52
N02  D  W27                   53     54
N02  D  W28                   55     56
N02  D  W29                   57     58
N02  D  W30                   59     60
N02   *
N04  D                 DS
N04  D  a                      1     80
N04  D                                     DIM(20)
N04  D  CAVD                   1     80
N04  D  AVD001                 1      4  0
N04  D  AVD002                 5      8  0
N04  D  AVD003                 9     12  0
N04  D  AVD004                13     16  0
N04  D  AVD005                17     20  0
N04  D  AVD006                21     24  0
N04  D  AVD007                25     28  0
N04  D  AVD008                29     32  0
N04  D  AVD009                33     36  0
N04  D  AVD010                37     40  0
N04  D  AVD011                41     44  0
N04  D  AVD012                45     48  0
N04  D  AVD013                49     52  0
N04  D  AVD014                53     56  0
N04  D  AVD015                57     60  0
N04  D  AVD016                61     64  0
N04  D  AVD017                65     68  0
N04  D  AVD018                69     72  0
N04  D  AVD019                73     76  0
N04  D  AVD020                77     80  0
N04   *
N05  D                 DS
S09  D* CO                     1     60
S09  D*                                    DIM(5)
N09  D  CO                     1     10    DIM(5)
N05  D  COPD                   1     10
N05  D  COPD01                 1      2
N05  D  COPD02                 3      4
N05  D  COPD03                 5      6
N05  D  COPD04                 7      8
N05  D  COPD05                 9     10
      *
     C                   EXSR      INIT
      *______________
      * Clear Subfile
      *""""""""""""""
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     VCUNDCD5
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fill Subfile
      *"""""""""""""
     C     CUNKY1        SETLL     CUNDC01                            77
      *
     C     START1        TAG
     C                   DO        13
     C     NEXT          TAG
     C     CUNKY1        READE     CUNDC01                                94
     C     *IN94         IFEQ      '0'
     C   55KUNFUN        CABNE     CTYPE         NEXT
     C                   MOVE      RRNP1         SFRRN
     C                   MOVE      CCONTA        SFONTA
     c     SFONTA        ifeq      *blank
     C                   eval      SFONTA = 'Kpers mm. mangler! 2=Endre..'
     C                   end
N01   * vis funk / tlf / email / mob / fax avhengig av F7 / F9-mode
N01  C                   MOVE      *blanks       SFTYPH
N01  c     TlfTMF        Ifeq      'M'
N01  C                   MOVEL     CMOBIL        CPHONE
N01  C                   end
N01  c     TlfTMF        Ifeq      'F'
N01  C                   MOVEL     CFAX          CPHONE
N01  C                   end
N01  C                   MOVEL     CTYPE         SFYPE
N01  c     EpoJN         Ifeq      'J'
N01  C                   MOVEL     CEMAIL        SFTYPH
N01  c     SFHONE        Ifeq      *blanks                                      KUN hvis plass
N01  C                   MOVEL     CPHONE        SFHONE
N01  C                   end
N01  C                   else
     C                   MOVEL     CPHONE        SFHONE
N01  C                   end
     C                   ADD       1             ZRECNO
     C                   Z-ADD     ZRECNO        CURS1
N01  C                   MOVEL     CTYPE         USOKK16          16
N01  C                   MOVE      USOKK16       USOKK15
N01  C     ARKKEY        CHAIN     ARKTXTL1                           33
N01  C  N33              MOVE      ARTYPE        AVTYPE
N01  C   33              MOVE      '**'          AVTYPE
     C                   WRITE     VCUNDCD4
     C                   END                                                    <*IN94
     C  N94              ENDDO
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     YRECNO        IFGT      0
     C     YRECNO        SUB       1             ZRECNO
     C     ZRECNO        DIV       13            ZRECNO
     C     ZRECNO        MULT      13            ZRECNO
     C                   ADD       1             ZRECNO
     c                   else
     c*                  seton                                        LR
     c*                  return
     c                   goto      start5
     C                   ENDIF
      *________________
      * Display Subfile
      *""""""""""""""""
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C                   MOVE      '0'           *IN31
     C                   WRITE     VCUNDCD5
     C                   Z-ADD     WSSUBN        XRECNO
     C                   EXFMT     VCUNDCD3
     C                   READ      VCUNDCD5                               66
      *
     C     FKEYS         TAG
      *
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      *
     C                   SETOFF                                       999830
      *** F3=Exit
     C     *IN03         IFEQ      '1'
     C                   GOTO      ENDPGM
     C                   END                                                    <*IN03
      *** F5=Refresh
     C     *IN05         IFEQ      '1'
     C                   CLEAR                   SFONTA
     C                   CLEAR                   SFYPE
     C                   CLEAR                   SFHONE
     C                   GOTO      START
     C                   END                                                    <*IN05
     c
N01  C     *IN07         IFEQ      '1'
N01  c     EpoJN         Ifeq      'J'
N01  c                   Move      'N'           EpoJN
N01  c                   eval      F7Txt  = 'F7=Email ad.'
N01  c                   eval      FunTxt = 'Funksjon'
N01  c                   else
N01  c                   Move      'J'           EpoJN
N01  c                   eval      F7Txt  = 'F7=Funksjon.'
N01  c                   eval      FunTxt = 'Epost adresse'
N01  c                   end
N01  C                   CLEAR                   SFONTA
N01  C                   CLEAR                   SFYPE
N01  C                   CLEAR                   SFHONE
N01  C                   GOTO      START
N01  C                   END                                                    <*IN05
N01   *
N01  C     *IN09         IFEQ      '1'
N01  c                   select
N01  c     TlfTMF        WhenEq    'T'
N01  c                   Move      'M'           TlfTMF
N01  c                   eval      TlfTxt = 'Mobil nr'
N01  c                   eval      F9Txt  = 'F9=Fax no.'
N01  c     TlfTMF        WhenEq    'M'
N01  c                   Move      'F'           TlfTMF
N01  c                   eval      TlfTxt = 'Fax nr'
N01  c                   eval      F9Txt  = 'F9=Tel no.'
N01  C                   other
N01  c                   Move      'T'           TlfTMF
N01  c                   eval      TlfTxt = 'Telefon'
N01  c                   eval      F9Txt  = 'F9=Mob no.'
N01  c                   endsl
N01  C                   CLEAR                   SFONTA
N01  C                   CLEAR                   SFYPE
N01  C                   CLEAR                   SFHONE
N01  C                   GOTO      START
N01  C                   END                                                    <*IN05
      *** F6=New record
     C     *IN06         IFEQ      '1'
N06  C                   seton                                        78
N06  c                   move      '**'          avtype
     C                   MOVEL     'Lage ny '    WMODE
     C                   EXSR      CLRSCR
     c                   movel     KUNFUN        CTYPE
     C                   MOVE      '0'           *IN40
N12  C                   MOVE      '0'           *IN88
N09  C                   EVAL      XCCOMPN = 0
     C                   GOTO      START5
     C                   END                                                    <*IN06
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C                   CLEAR                   SFONTA
     C                   CLEAR                   SFYPE
     C                   CLEAR                   SFHONE
     C                   GOTO      START
     C                   END                                                    <*IN12
      *** Roll
     C     *IN25         IFEQ      '1'
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      '0'           *IN25
     C     START4        TAG
     C     *IN94         IFEQ      '0'
     C                   GOTO      START1
     C                   END                                                    <*IN94
     C                   END                                                    <*IN25
      *** Get options from screen
     C     ZRECNO        IFNE      0
     C                   EXSR      GETOPT
      *** No option selected
     C     *IN97         IFEQ      '1'
     C                   EXFMT     VCUNDCD3
     C                   READ      VCUNDCD5                               66
     C                   MOVE      '0'           *IN97
     C                   GOTO      FKEYS
     C                   END                                                    <*IN12
      *** F3=Exit
     C     *IN03         IFEQ      '1'
     C                   GOTO      ENDPGM
     C                   END                                                    <*IN03
     C                   END                                                    <ZRECNO
     C     *IN98         IFEQ      '1'
     C     XRECNO        ANDNE     0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END                                                    <*IN98
     C                   GOTO      START3
      *** New record
     C     START5        TAG
     c                   move      *blanks       cconta
     c                   move      *blanks       cphone
     c                   move      *blanks       cmobil
     c                   move      *blanks       cfax
     c                   move      *blanks       cemail
     c   55              movel     kunfun        ctype
s06  C*                  seton                                        78
s06  c*                  move      '**'          avtype
N02  C                   MOVE      *BLANKS       WSKVED
N06  c     start5b       tag
N09   *
N09  C                   EVAL      *IN27 = *ON
N09  C     CCONTA        COMP      'EMMA-XML'                             28
N21  C  N28CCONTA        COMP      'PROTERIA-XML'                         28
N09  C  N28CLIVE         COMP      'X'                                    28
N09  C   28              EVAL      *IN27 = *OFF
N09   *
     C                   EXFMT     VCUNDCD1
N09  C     WSCLOC        DIV       256           LINNBR            3 0
N09  C                   MVR                     POSNBR            3 0
      *
      * søking
      *
N06  C   04              do
N09  C                   SELECT
      * funksjon
N09  C                   WHEN      LINNBR = 8
     c                   move      *blanks       kfkod
N06  C                   CALL      'SYFAKDA'
N06  C                   PARM                    KFTYP            10
N06  C                   PARM                    UUPDAT            1
M06  C                   PARM                    KFKOD             5
n06  c     keyko         chain     kofast                             34
n06  c     *in34         ifeq      '0'
N08  c                   setoff                                       78
N08  C                   MOVE      'J'           UTV               1
N08  C                   MOVEl     KFKOD         ARTYPE
N06  c                   movel     kftxt         utxt15           15
n06  c                   move      utxt15        utxt16           16
n06  c                   movel     '*'           utxt16
n06  c                   eval      ctype=utxt16
N06  c                   endif
      * vedlegg
N09  C                   WHEN      *IN78 = *OFF AND (LINNBR = 18 OR LINNBR = 19)
N09  C                   EXSR      SOKVEDL
N09  C                   WHEN      *IN78 = *OFF AND LINNBR = 22
      * OPPDRAGSTYPER
N09  C                   EXSR      SOKOT
N09  C                   ENDSL
n06  c                   goto      start5b
N06  c                   enddo
      * SLUTT SØK
N06  C                   MOVE      'J'           UTV               1
N06  C   78              MOVE      'N'           UTV
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   MOVE      '0'           *IN30
      *** F3=Exit
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
N09  C     *IN12         CABEQ     *ON           START3
     c                   goto      endpgm
S09  C*                  EXSR      CLRSCR
S09  C*                  MOVEA     '00000'       *IN(61)
S09  C*                  MOVE      '0'           *IN(67)
     C                   ELSE
N06  C     CTYPE         IFNE      *BLANKS
N06  C                   MOVEL     CTYPE         USOKK16          16
N06  C                   MOVE      USOKK16       USOKK15
N06  C     ARKKEY        CHAIN     ARKTXTL1                           78
N06  C  N33              MOVE      ARTYPE        AVTYPE
N06  C   33              MOVE      '**'          AVTYPE
N06  C  N78UTV           IFEQ      'N'
S13  C*                  GOTO      START5
N13  C                   IF        CCONTA = 'EMMA-XML'
N21  C                             OR CCONTA = 'PROTERIA-XML'
N13  C                   EVAL      CLIVE  = 'X'
N13  C                   END
N13  C                   IF        CPHONE = 'EHF' AND CFAX = *BLANKS
N13  C                   EVAL      CFAX = SYRG
N13  C                   END
N13  C                   EVAL      LINNBR = 16
N13  C                   EVAL      POSNBR = 27
N13  C                   GOTO      START5B
N06  C                   END
N06  C                   END
N09   *
N09  C                   IF        CCONTA = 'EMMA-XML' OR CLIVE = 'X'
N21  C                             OR CCONTA = 'PROTERIA-XML'
N21  C                   IF        CCONTA <> 'PROTERIA-XML'
N09  C                   EVAL      CCONTA = 'EMMA-XML'
N21  C                   END
N09  C                   EVAL      CLIVE  = 'X'
N09  C                   EVAL      CMERGE = ' '
N09  C                   IF        CPHONE = *BLANKS OR CMOBIL = *BLANKS
N09  C     CUNDC02K      CHAIN     CUNDC02                            33
N09  C                   IF        *IN33 = *OFF
N09  C                   EVAL      XCCOMPN = C2_CCOMPN
N09  C                   EVAL      CTYPE  = '*SAD'
N09  C                   EVAL      CPHONE = C2_CPHONE
N09  C                   EVAL      CMOBIL = C2_CMOBIL
N09  C                   EVAL      CFAX   = C2_CFAX
N09  C                   EVAL      CEMAIL = C2_CEMAIL
N09  C                   EVAL      LINNBR = 8
N09  C                   EVAL      POSNBR = 32
N09  C                   EVAL      *IN78  = *OFF
N09  C                   EVAL      *IN88  = *OFF
N09  C                   GOTO      START5B
N09  C                   END
N09  C                   END
N09  C                   END
N09   *
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
S12  C*                  GOTO      START5
N12  C                   GOTO      START5B
     C                   END                                                    <*IN30
      * HVIS BYTTET FRA IKKE UTVIDET TIL UTVIDET VIS BILDE EN GANG TIL
     C                   END
N13  C                   EVAL      LINNBR = 7
N13  C                   EVAL      POSNBR = 27
     C                   GOTO      START3
      *
     C     ENDPGM        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C*          N40 = NEW
     C*           40 = CHANGE
     C***********************************************
     C                   EXSR      TSTSCR
     C     *IN30         IFEQ      '1'
     C                   GOTO      ENDTST
     C                   END                                                    <*IN30
     C     *IN40         IFEQ      '1'
     C                   UPDATE    CUNDCR                               38
     C                   ELSE
     C                   MOVEL     ÆFIRMA        CFIRMA
     C                   Z-ADD     ÆCOMPN        CCOMPN
     C                   WRITE     CUNDCR
N09   *
N09  C                   IF        CLIVE = 'X' AND WSKVED = *BLANKS
N09  C     ARKVEDKK2     CHAIN(N)  ARKVEDK                            33
N09  C  N33              EVAL      WSKVED = AVKVED
N09  C                   END
N09   *
     C                   END                                                    <*IN40
N12   *
N12  C                   SELECT
N12  C                   WHEN      CCONTA = 'EMMA-XML'
N21  C                             OR CCONTA = 'PROTERIA-XML'
N12   * SJEKK OM AVSENDER OG MOTTAKER PÅ XML-EMMA ER REGISTRERT
N12   * EGEN UTV.ID
N12  C                   EVAL      INID = CMOBIL
N12  C     INID          CHAIN     EDII                               33
N12   * EMMA UTV.ID
N12  C  N33              EVAL      INID = CFAX
N12  C  N33INID          CHAIN     EDII                               33
N12  C   33              CALL      'EDI50R'
N12  C                   WHEN      CPHONE = 'E2B'
N12   * SJEKK OM AVSENDER OG MOTTAKER PÅ E2B
N12  C                   EVAL      INID = CMOBIL
N12  C     INID          CHAIN     EDII                               33
N12  C  N33              EVAL      ECIIDI = INID
N12  C  N33              EVAL      INID = CFAX
N12  C  N33INID          CHAIN     EDII                               33
N12  C  N33              EVAL      ECIIDI = INID
N12  C                   IF        *IN33
N12  C                   CALL      'EDI50R'
N12  C                   CALL      'E003R'
N12  C                   ELSE
N12  C     ECMSGK        CHAIN     ECMSG                              33
N12  C   33              CALL      'E003R'
N12  C                   END
N12  C                   WHEN      CPHONE = 'EHF'
N12   * SJEKK OM AVSENDER OG MOTTAKER PÅ EHF
N12  C                   EVAL      INID = CMOBIL
N12  C     INID          CHAIN     EDII                               33
N12  C  N33              EVAL      ECIIDI = INID
N12  C  N33              EVAL      INID = CFAX
N12  C  N33INID          CHAIN     EDII                               33
N12  C  N33              EVAL      ECIIDI = INID
N12  C                   IF        *IN33
N12  C                   CALL      'EDI50R'
N12  C                   CALL      'E003R'
N12  C                   ELSE
N12  C     ECMSGK        CHAIN     ECMSG                              33
N12  C   33              CALL      'E003R'
N12  C                   END
N12  C                   ENDSL
      *
      * OPPDATERER VEDLEGG DOKUMENTKODE
      *
N02  C     AVTYPE        IFNE      '**'
N02  C     VEDKEY        CHAIN     ARKVEDK                            33
N02  C     WSKVED        IFEQ      *BLANKS
N02  C  N33              DELETE    ARKVEDKR
N02  C                   ELSE
N02  C                   MOVE      WSKVED        AVKVED
N02  C  N33              UPDATE    ARKVEDKR
N02  C   33              MOVE      CCOMPN        AVKUND
N02  C   33              WRITE     ARKVEDKR
N02  C                   END
N02  C                   END
     C*
     C*
     C                   MOVE      CCONTA        SFONTA
     C                   MOVEL     CTYPE         SFYPE
     C                   MOVEL     CPHONE        SFHONE
     C     *IN40         IFEQ      '1'
     C                   UPDATE    VCUNDCD4
     C                   ELSE
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      RRNP          SFRRN
     C                   WRITE     VCUNDCD4
     C                   END                                                    <*IN40
N06  C                   MOVEL     CTYPE         USOKK16          16
N06  C                   MOVE      USOKK16       USOKK15
N06  C     ARKKEY        CHAIN     ARKTXTL1                           78
N06  C  N33              MOVE      ARTYPE        AVTYPE
N06  C   33              MOVE      '**'          AVTYPE
     C                   EXSR      CLRSCR
      *
     C     ENDTST        ENDSR
      ***********************************************************
     C     TSTSCR        BEGSR
      ***********************************************************
N11  C                   MOVE      '0'           *IN55
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C*
     C     CCONTA        IFEQ      *BLANKS
     C                   MOVE      'CBA0130'     MSGNR
     C                   MOVE      '1'           *IN61
     C                   MOVE      '1'           *IN30
N09  C                   EVAL      LINNBR = 7
N09  C                   EVAL      POSNBR = 27
     C                   GOTO      TSTEND
     C                   END                                                    <CCONTA
     C*
      * TEST FUJNKSJON
      *
N11  C     CTYPE1        IFEQ      '*'
N14  C     CTYPE7        andne     '*ADVIS*'
N11  C                   EVAL      KFTXT=CTYPE29
N11  C     KEYKO2        CHAIN     KOFASTL1                           55
N11  C     *IN55         IFEQ      '1'
N11  C                   MOVE      'SHU1674'     MSGNR
N11  C                   MOVE      '1'           *IN30
N11  C                   EVAL      LINNBR = 8
N11  C                   EVAL      POSNBR = 27
N11  C                   GOTO      TSTEND
N11  C                   END                                                    <CCONTA
N11  C                   END                                                    <CCONTA
N15   * tester epostadressse
N17  C                   IF        CPHONE <> 'EHF' AND CPHONE <> 'E2B'
N17  c                             and clive <> 'X'
N15  C     CTYPE1        IFEQ      '*'
N15  C     CEMAIL        IFEQ      *BLANKS
N15  C                   MOVE      'SHU1128'     MSGNR
N15  C                   MOVE      '1'           *IN62
N15  C                   MOVE      '1'           *IN30
N15  C                   EVAL      LINNBR = 13
N15  C                   EVAL      POSNBR = 6
N15  C                   GOTO      TSTEND
N15  C                   ELSE
s18  C*    '@'           SCAN      CEMAIL                                 63
n18  C     '@'           SCAN      CEMAIL        nr                2 0    63
N18   * ikke 2 @ i en epostadresse
N18  c                   move      *blanks       cemailn          70
N18  C   63nr            add       1             nrn               2 0
N18  C   63              movea     ce(nrn)       cen
N18  c   63'@'           SCAN      CEMAILN                                64
N18  c     *in64         ifeq      '1'
N18  C                   SETON                                        3062
N18  C                   MOVE      'SHU1906'     MSGNR
N18  C                   z-add     8             LINNBR
N18  C                   z-add     10            POSNBR
N18  C                   GOTO      TSTEND
n18  C                   endif
N29   * må ha . etter @
N29  C   63              movea     ce(nrn)       cen
N29  c   63'.'           SCAN      CEMAILN                                64
N29  c     *in64         ifeq      '0'
N29  C                   SETON                                        3062
N29  C                   MOVE      'SHU2031'     MSGNR
N29  C                   z-add     13            LINNBR
N29  C                   z-add     27            POSNBR
N29  C                   GOTO      TSTEND
n29  C                   endif
N15  C  N63'*'           SCAN      CEMAIL                                 63
N15  C  N63'Ø'           SCAN      CEMAIL                                 63
N15  c                   setoff                                       64
N15  c   63'mailto:'     SCAN      cemail                                 64
N15  c   64              setoff                                       63
N15  C   63';'           SCAN      cemail                                 64
N15  c   64              setoff                                       63
N20  C   63','           SCAN      cemail                                 64
N20  c   64              setoff                                       63
N19  C   63'æ'           SCAN      cemail                                 64
N19  c   64              setoff                                       63
N19  C   63'ø'           SCAN      cemail                                 64
N19  c   64              setoff                                       63
N19  C   63'å'           SCAN      cemail                                 64
N19  c   64              setoff                                       63
N16  c     *in63         ifeq      '1'
N16  c                   z-add     70            nr                2 0
N16  c                   do        70
N16  c     CE(nr)        ifne      ' '
N16   *
N16  c     CE(nr)        IFGE      'a'
N16  c     CE(nr)        andle     'z'
N16  c                   goto      ok
N16  c                   end
N16  c     CE(nr)        IFGE      'A'
N16  c     CE(nr)        andle     'Z'
N16  c                   goto      ok
N16  c                   end
N16  C                   SETON                                        3062
N16  C                   MOVE      'SHU1905'     MSGNR
N16  C                   z-add     8             LINNBR
N16  C                   z-add     10            POSNBR
N16  C                   GOTO      TSTEND
N16  C                   endif
N16  c                   sub       1             nr
N16  C                   enddo
N16  C                   END
N15  c     *in(63)       ifeq      '0'
N15  C                   SETON                                        3062
N15  C                   MOVE      'SHU1128'     MSGNR
N15  C                   z-add     13            LINNBR
N15  C                   z-add     6             POSNBR
N15  C                   GOTO      TSTEND
N15  C                   END
N15  C                   END                                                    <CCONTA
N15  C                   END                                                    <CCONTA
N17  C                   END                                                    <CCONTA
N15  C*
N16  c     ok            tag
     C*
     C     TSTEND        ENDSR
     C*
      ***********************************************
     C     GETOPT        BEGSR
      ***********************************************
     C                   Z-ADD     0             OPTNBR            2 0
     C                   SETOFF                                       919299
     C                   MOVE      '1'           *IN97
     C     *IN98         DOWEQ     '0'
     C                   READC     VCUNDCD4                               98
     C     *IN98         IFEQ      '1'
     C     *IN99         IFEQ      '1'
     C                   MOVE      '0'           *IN98
     C                   END                                                    <*IN99
     C                   GOTO      ENDGET
     C                   END                                                    <*IN98
     C                   MOVE      '0'           *IN97
     C                   Z-ADD     CURS1         ZRECNO
      *** 1=PICK
     C     WSNR          IFEQ      '1 '
     C     WSNR          OREQ      ' 1'
     C     WSNR          OREQ      '01'
     C     WSNR          OREQ      'E '
     C     WSNR          OREQ      'F '
     C     WSNR          OREQ      ' E'
     C     WSNR          OREQ      ' F'
     C                   MOVE      SFRRN         URRN
     C                   MOVE      SFONTA        UCONTA
     C     WSNR          IFEQ      'E '
     C     WSNR          OREQ      ' E'
     C                   MOVE      'E'           UEMFA
     C                   END
     C     WSNR          IFEQ      'F '
     C     WSNR          OREQ      ' F'
     C                   MOVE      'F'           UEMFA
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C                   END                                                    <SFYPE
      *** 2=Change
     C     WSNR          IFEQ      '2 '
     C     WSNR          OREQ      ' 2'
     C     WSNR          OREQ      '02'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Endre   '    WMODE
     C     SFYPE         IFEQ      TXT(1)
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFYPE
     C                   MOVE      '1'           *IN40
     C                   EXSR      CHGST
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   MOVE      '0'           *IN40
     C                   END                                                    <WSNR=2
      *** 3=Copy
     C     WSNR          IFEQ      '3 '
     C     WSNR          OREQ      ' 3'
     C     WSNR          OREQ      '03'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Kopier  '    WMODE
     C     SFYPE         IFEQ      TXT(1)
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFYPE
     C                   EXSR      CPYST
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   END                                                    <WSNR=3
      *** 4=Delete
     C     WSNR          IFEQ      '4 '
     C     WSNR          OREQ      ' 4'
     C     WSNR          OREQ      '04'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Slett   '    WMODE
     C     SFYPE         IFEQ      TXT(1)
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFYPE
     C                   EXSR      DLTST
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   END                                                    <WSNR=4
      *** 5=Display
     C     WSNR          IFEQ      '5 '
     C     WSNR          OREQ      ' 5'
     C     WSNR          OREQ      '05'
     C                   ADD       1             OPTNBR
     C                   MOVE      ' '           WSNR
     C                   MOVEL     'Vise    '    WMODE
     C     SFYPE         IFEQ      TXT(1)
     C                   MOVE      'CBA0120'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      ENDGET
     C                   END                                                    <SFYPE
     C     SFRRN         CHAIN(N)  CUNDC                              77
     C                   MOVE      '1'           *IN88
N09   *
N09  C                   EVAL      *IN27 = *ON
N09  C     CCONTA        COMP      'EMMA-XML'                             28
N21  C  N28CCONTA        COMP      'PROTERIA-XML'                         28
N09  C  N28CLIVE         COMP      'X'                                    28
N09  C   28              EVAL      *IN27 = *OFF
N09   *
     C                   EXFMT     VCUNDCD1
      *** F12=Cancel
     C     *IN12         IFEQ      '1'
     C                   UPDATE    VCUNDCD4
     C                   GOTO      ENDGET
     C                   END                                                    <*IN12
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   MOVE      '0'           *IN88
     C                   UPDATE    VCUNDCD4
     C                   END                                                    <WSNR=5
     C                   ENDDO
      *
     C     ENDGET        TAG
      *
     C                   ENDSR
      ***********************************************
     C     CHGST         BEGSR
      ***********************************************
     C     SFRRN         CHAIN     CUNDC                              77
     C                   MOVE      '1'           *IN99
N02  C                   MOVE      *BLANKS       WSKVED
N06  C                   MOVEL     CTYPE         USOKK16          16
N06  C                   MOVE      USOKK16       USOKK15
N06  C     ARKKEY        CHAIN     ARKTXTL1                           33
N06  C  N33              MOVE      ARTYPE        AVTYPE
N06  C   33              MOVE      '**'          AVTYPE
N06  c     avtype        comp      '**'                                   78
N06  C     VEDKEY        CHAIN     ARKVEDK                            33
N06  C  N33              MOVE      AVKVED        WSKVED
N09  C                   EVAL      LINNBR = 7
N09  C                   EVAL      POSNBR = 27
N12  C                   MOVE      '0'           *IN88
     C     STCHG         TAG
N09   *
N09  C                   EVAL      *IN27 = *ON
N09  C     CCONTA        COMP      'EMMA-XML'                             28
N21  C  N28CCONTA        COMP      'PROTERIA-XML'                         28
N09  C  N28CLIVE         COMP      'X'                                    28
N09  C   28              EVAL      *IN27 = *OFF
N09   *
     C                   EXFMT     VCUNDCD1
N09  C     WSCLOC        DIV       256           LINNBR            3 0
N09  C                   MVR                     POSNBR            3 0
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
N06  C   04              do
N09  C                   SELECT
N09  C                   WHEN      LINNBR = 8
     c                   move      *blanks       kfkod
N06  C                   CALL      'SYFAKDA'
N06  C                   PARM                    KFTYP            10
N06  C                   PARM                    UUPDAT            1
M06  C                   PARM                    KFKOD             5
n06  c     keyko         chain     kofast                             34
n06  c     *in34         ifeq      '0'
N08  c                   setoff                                       78
N08  C                   MOVE      'J'           UTV               1
N08  C                   MOVEl     KFKOD         ARTYPE
N06  c                   movel     kftxt         utxt15           15
n06  c                   move      utxt15        utxt16           16
n06  c                   movel     '*'           utxt16
n06  c                   eval      ctype=utxt16
N06  c                   endif
N09  C                   WHEN      *IN78 = *OFF AND (LINNBR = 18 OR LINNBR = 19)
N09  C                   EXSR      SOKVEDL
N09  C                   WHEN      *IN78 = *OFF AND LINNBR = 22
N09  C                   EXSR      SOKOT
N09  C                   ENDSL
n06  c                   goto      stchg
N06  c                   enddo
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
     C                   UPDATE    VCUNDCD4
     C                   GOTO      CHGEND
     C                   END                                                    <*IN12
N09   *
N09  C                   IF        CCONTA = 'EMMA-XML' OR CLIVE = 'X'
N21  C                             OR CCONTA = 'PROTERIA-XML'
N21  C                   IF        CCONTA <> 'PROTERIA-XML'
N09  C                   EVAL      CCONTA = 'EMMA-XML'
N21  C                   END
N09  C                   EVAL      CLIVE  = 'X'
N09  C                   EVAL      CMERGE = ' '
N09  C                   IF        CPHONE = *BLANKS OR CMOBIL = *BLANKS
N09  C     CUNDC02K      CHAIN     CUNDC02                            33
N09  C                   IF        *IN33 = *OFF
N09  C                   EVAL      CTYPE  = '*SAD'
N09  C                   EVAL      CPHONE = C2_CPHONE
N09  C                   EVAL      CMOBIL = C2_CMOBIL
N09  C                   EVAL      CFAX   = C2_CFAX
N09  C                   EVAL      CEMAIL = C2_CEMAIL
N09  C                   EVAL      LINNBR = 8
N09  C                   EVAL      POSNBR = 32
N09  C                   EVAL      *IN78  = *OFF
N09  C                   EVAL      *IN88  = *OFF
N09  C                   GOTO      STCHG
N09  C                   END
N09  C                   END
N09  C                   END
N09   *
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      STCHG
     C                   END                                                    <*IN30
      *
     C     CHGEND        TAG
     C                   ENDSR
     C*
      ***********************************************
     C     CPYST         BEGSR
      ***********************************************
     C     SFRRN         CHAIN(N)  CUNDC                              77
     C                   MOVE      '1'           *IN99
     C                   UPDATE    VCUNDCD4
N09  C                   EVAL      LINNBR = 7
N09  C                   EVAL      POSNBR = 27
     C     STCPY         TAG
N09   *
N09  C                   EVAL      *IN27 = *ON
N09  C     CCONTA        COMP      'EMMA-XML'                             28
N21  C  N28CCONTA        COMP      'PROTERIA-XML'                         28
N09  C  N28CLIVE         COMP      'X'                                    28
N09  C   28              EVAL      *IN27 = *OFF
N09   *
     C                   EXFMT     VCUNDCD1
N09  C     WSCLOC        DIV       256           LINNBR            3 0
N09  C                   MVR                     POSNBR            3 0
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C     *IN12         IFEQ      '1'
     C     *IN03         OREQ      '1'
     C                   EXSR      CLRSCR
     C                   MOVEA     '00000'       *IN(61)
     C                   MOVE      '0'           *IN(67)
     C                   GOTO      CPYEND
     C                   END                                                    <*IN12
N09  C   04              do
N09  C                   SELECT
N09  C                   WHEN      LINNBR = 8
N09  c                   move      *blanks       kfkod
N09  C                   CALL      'SYFAKDA'
N09  C                   PARM                    KFTYP            10
N09  C                   PARM                    UUPDAT            1
N09  C                   PARM                    KFKOD             5
N09  c     keyko         chain     kofast                             34
N09  c     *in34         ifeq      '0'
N09  c                   setoff                                       78
N09  C                   MOVE      'J'           UTV               1
N09  C                   MOVEl     KFKOD         ARTYPE
N09  c                   movel     kftxt         utxt15           15
N09  c                   move      utxt15        utxt16           16
N09  c                   movel     '*'           utxt16
N09  c                   eval      ctype=utxt16
N09  c                   endif
N09  C                   WHEN      *IN78 = *OFF AND (LINNBR = 18 OR LINNBR = 19)
N09  C                   EXSR      SOKVEDL
N09  C                   WHEN      *IN78 = *OFF AND LINNBR = 22
N09  C                   EXSR      SOKOT
N09  C                   ENDSL
N09  C                   GOTO      STCPY
N09  C                   ENDDO
N09   *
N09  C                   IF        CCONTA = 'EMMA-XML' OR CLIVE = 'X'
N21  C                             OR CCONTA = 'PROTERIA-XML'
N21  C                   IF        CCONTA <> 'PROTERIA-XML'
N09  C                   EVAL      CCONTA = 'EMMA-XML'
N21  C                   END
N09  C                   EVAL      CLIVE  = 'X'
N09  C                   EVAL      CMERGE = ' '
N09  C                   IF        CPHONE = *BLANKS OR CMOBIL = *BLANKS
N09  C     CUNDC02K      CHAIN     CUNDC02                            33
N09  C                   IF        *IN33 = *OFF
N09  C                   EVAL      CTYPE  = '*SAD'
N09  C                   EVAL      CPHONE = C2_CPHONE
N09  C                   EVAL      CMOBIL = C2_CMOBIL
N09  C                   EVAL      CFAX   = C2_CFAX
N09  C                   EVAL      CEMAIL = C2_CEMAIL
N09  C                   EVAL      LINNBR = 8
N09  C                   EVAL      POSNBR = 32
N09  C                   EVAL      *IN78  = *OFF
N09  C                   EVAL      *IN88  = *OFF
N09  C                   GOTO      STCPY
N09  C                   END
N09  C                   END
N09  C                   END
N09   *
     C                   MOVE      '0'           *IN40
     C                   EXSR      TESTB1
     C     *IN30         IFEQ      '1'
     C                   GOTO      STCPY
     C                   END                                                    <*IN30
      *
     C     CPYEND        TAG
     C                   ENDSR
     C*
      ***********************************************
     C     DLTST         BEGSR
      ***********************************************
     C                   MOVE      '1'           *IN99
     C                   MOVEA     '11'          *IN(88)
     C     SFRRN         CHAIN     CUNDC                              77
N09   *
N09  C                   EVAL      *IN27 = *ON
N09  C     CCONTA        COMP      'EMMA-XML'                             28
N21  C  N28CCONTA        COMP      'PROTERIA-XML'                         28
N09  C  N28CLIVE         COMP      'X'                                    28
N09  C   28              EVAL      *IN27 = *OFF
N09   *
     C                   EXFMT     VCUNDCD1
     C                   MOVEA     '00'          *IN(88)
     C     *IN11         IFEQ      '1'
     C     *IN77         IFEQ      '0'
     C                   DELETE    CUNDCR
     C                   END                                                    <*IN77
     C                   MOVE      CCONTA        SFONTA
     C                   MOVEL     TXT(1)        SFYPE
     C                   END                                                    <*IN11
     C                   UPDATE    VCUNDCD4
      *
     C                   ENDSR
      ***********************************************
     C     CLRSCR        BEGSR
      ***********************************************
N01  C                   MOVE      *BLANKS       CFAX
N01  C                   MOVE      *BLANKS       Clive
N01  C                   MOVE      *BLANKS       CPRINT
n03  C                   MOVE      *BLANKS       CEMNE
n04  C                   MOVE      *ZEROS        CAVD
n05  C                   MOVE      *blanks       COPD
     C                   MOVE      '0'           *IN40
     C                   CLEAR                   CCONTA
     C                   CLEAR                   CTYPE
     C                   CLEAR                   CMOBIL
     C                   CLEAR                   CEMAIL
n04  c                   move      *zeros        cavd
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *LIKE         DEFINE    CFIRMA        ÆFIRMA
     C     *LIKE         DEFINE    CCOMPN        ÆCOMPN
N09  C     *LIKE         DEFINE    CCOMPN        XCCOMPN
     C     *ENTRY        PLIST
     C                   PARM                    ÆFIRMA
     C                   PARM                    WCOMPN
     C                   PARM                    URRN             10 0
     C                   PARM                    UEMFA             1
     C                   PARM                    UCONTA           30
     C                   Z-ADD     WCOMPN        ÆCOMPN
     C                   movel     UCONTA        TST1              1
     C     TST1          ifeq      '*'
     C                   MOVE      *ON           *IN55
     C                   move      UCONTA        KUNFUN
     C                   move      *blanks       UCONTA
     C                   end
     C     ARKKEY        KLIST
     C                   KFLD                    USOKK15          15
      *--------------------------------------------------------------
      * DEFINE KEY FOR CUNDC01
      *--------------------------------------------------------------
N06  C     KEYKO         KLIST
N06  C                   KFLD                    KFTYP
N06  C                   KFLD                    KFKOD
N11  C     KEYKO2        KLIST
N11  C                   KFLD                    KFTYP
N11  C                   KFLD                    KFTXT
N11  C                   MOVEL     'FUNKSJON'    KFTYP
N02  C     VEDKEY        KLIST
N02  C                   KFLD                    AVFIRM            2
N02  C                   KFLD                    CCOMPN
N02  C                   KFLD                    AVTYPE            2
N02  C                   MOVE      ÆFIRMA        AVFIRM
     C     CUNKY1        KLIST
     C                   KFLD                    ÆFIRMA
     C                   KFLD                    ÆCOMPN
N09  C     ARKVEDKK2     KLIST
N09  C                   KFLD                    AVFIRM
N09  C                   KFLD                    XCCOMPN
N09  C                   KFLD                    AVTYPE
N09  C     CUNDC02K      KLIST
N09  C                   KFLD                    ÆFIRMA
N09  C                   KFLD                    CCONTA
N12  C     ECMSGK        KLIST
N12  C                   KFLD                    ÆFIRMA
N12  C                   KFLD                    ÆCOMPN
N12  C                   KFLD                    ECSR
N12  C                   KFLD                    EC0065
N12  C                   EVAL      ECSR   = 'S'
N12  C                   EVAL      EC0065 = 'INVXML'
      *
     C     CUNKY1        CHAIN     CUNDL01                            51
      *
     C                   CLEAR                   SFONTA
     C                   MOVE      '1'           *IN50
      *
N01  c                   Move      'N'           EpoJN             1
N01  c                   eval      F7Txt  = 'F7=Email ad.'
N01  c                   eval      FunTxt = 'Funksjon'
N01  c                   Move      'T'           TlfTMF            1
N01  c                   eval      F9Txt  = 'F9=Mob no.  '
N01  c                   eval      TlfTxt = 'Telefon'
      *
n10  c                   move      *zeros        cavd
     C                   ENDSR
      *
N09   ***********************************************
N09  C     SOKVEDL       BEGSR
N09   ***********************************************
N09  C     POSNBR        CABLT     6             SLSOKVEDL
N09  C     POSNBR        CABGT     49            SLSOKVEDL
N09  C                   MOVE      *ZEROS        XNR               3 0
N09  C                   EVAL      XNR = (POSNBR - 6) / 3
N09  C                   EVAL      XNR = XNR + 1
N09   *
N09  C                   IF        LINNBR = 19
N09  C                   EVAL      XNR = XNR + 15
N09  C                   END
N09  C                   EVAL      UTYP = 'FUNKSJON'
N09  c                   EVAL      UKOD = W(XNR)
N09  C                   CALL      'SYFAKDA'
N09  C                   PARM                    UTYP             10
N09  C                   PARM                    UUPDAT            1
N09  C                   PARM                    UKOD              5
N09  c                   IF        UKOD <> *BLANKS
N09  c                   EVAL      W(XNR) = UKOD
N09  c                   END
N09  C                   SELECT
N09  C                   WHEN      XNR = 15
N09  C                   EVAL      LINNBR = 19
N09  C                   EVAL      POSNBR = 6
N09  C                   WHEN      XNR < 30
N09  C                   EVAL      POSNBR = POSNBR + 3
N09  C                   ENDSL
N09   *
N09  C     SLSOKVEDL     ENDSR
N09   *
N09   ***********************************************
N09  C     SOKOT         BEGSR
N09   ***********************************************
N09  C     POSNBR        CABLT     27            SLSOKOT
N09  C     POSNBR        CABGT     48            SLSOKOT
N09  C                   EVAL      XNR = (POSNBR - 27) / 5
N09  C                   EVAL      XNR = XNR + 1
N09   *
N09  c                   EVAL      UOT = CO(XNR)
N09  C                   CALL      'SYFI10C'
N09  C                   PARM                    UOT               2
N09  c                   IF        UOT <> *BLANKS
N09  c                   EVAL      CO(XNR) = UOT
N09  c                   END
N09  C                   IF        XNR < 5
N09  C                   EVAL      POSNBR = POSNBR + 5
N09  C                   END
N09   *
N09  C     SLSOKOT       ENDSR
N09   *
**
*** SLETTET ***
