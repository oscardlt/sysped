********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 YBC PTF10 PARAMETER VED KALL PÅ SYSJ56CL
********************************************************************
      *
      *****************************************************************
      *** PROGRAM SKAL BESTEMME OM Å SKRIVE UT DOKUMENTER TIL BOOK. ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01-03 05-11 13-26                      ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-83                      ***
      *****************************************************************
      *
     FBOOKING   UF   E           K DISK
     FFIRM      IF   E           K DISK
     FKODTP     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYSJ50FB  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSUTO                  1      1
     D  WSUTL                  2      2
     D  WSUTT                  3      3
     D  WSUTP                  4      4
     D  WSUTE                  5      5
     D  BT                     1      5
     D                                     DIM(5)
     D                 DS
     D  BODTOÅ                 1      4  0
     D  BODTOM                 5      6  0
     D  BODTOD                 7      8  0
     D  BODTO                  1      8  0
     D                 DS
     D  WSDTOD                 1      2  0
     D  WSDTOM                 3      4  0
     D  WSDTOÅ                 5      6  0
     D  WSDTO                  1      6  0
     D                 DS
     D  BODTLÅ                 1      4  0
     D  BODTLM                 5      6  0
     D  BODTLD                 7      8  0
     D  BODTL                  1      8  0
     D                 DS
     D  WSDTLD                 1      2  0
     D  WSDTLM                 3      4  0
     D  WSDTLÅ                 5      6  0
     D  WSDTL                  1      6  0
     D                 DS
     D  BODTTÅ                 1      4  0
     D  BODTTM                 5      6  0
     D  BODTTD                 7      8  0
     D  BODTT                  1      8  0
     D                 DS
     D  WSDTTD                 1      2  0
     D  WSDTTM                 3      4  0
     D  WSDTTÅ                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  BODTPÅ                 1      4  0
     D  BODTPM                 5      6  0
     D  BODTPD                 7      8  0
     D  BODTP                  1      8  0
     D                 DS
     D  WSDTPD                 1      2  0
     D  WSDTPM                 3      4  0
     D  WSDTPÅ                 5      6  0
     D  WSDTP                  1      6  0
     D                 DS
     D  BODTEÅ                 1      4  0
     D  BODTEM                 5      6  0
     D  BODTED                 7      8  0
     D  BODTE                  1      8  0
     D                 DS
     D  WSDTED                 1      2  0
     D  WSDTEM                 3      4  0
     D  WSDTEÅ                 5      6  0
     D  WSDTE                  1      6  0
     D                 DS
     D  BODTSÅ                 1      4  0
     D  BODTSM                 5      6  0
     D  BODTSD                 7      8  0
     D  BODTS                  1      8  0
     D                 DS
     D  WSDTSD                 1      2  0
     D  WSDTSM                 3      4  0
     D  WSDTSÅ                 5      6  0
     D  WSDTS                  1      6  0
     D                 DS
     D  BODTAÅ                 1      4  0
     D  BODTAM                 5      6  0
     D  BODTAD                 7      8  0
     D  BODTA                  1      8  0
     D                 DS
     D  WSDTAD                 1      2  0
     D  WSDTAM                 3      4  0
     D  WSDTAÅ                 5      6  0
     D  WSDTA                  1      6  0
     D                 DS
     D  BODTBÅ                 1      4  0
     D  BODTBM                 5      6  0
     D  BODTBD                 7      8  0
     D  BODTBB                 1      8  0
     D                 DS
     D  WSDTBD                 1      2  0
     D  WSDTBM                 3      4  0
     D  WSDTBÅ                 5      6  0
     D  WSDTBB                 1      6  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30
     CANN04              Z-ADD     8             LINNBR
     C  N30
     CANN04              Z-ADD     16            POSNBR
     C                   EXFMT     BILDE
     C                   SETOFF                                       30
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C*
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C*
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              DO
     C                   MOVE      WSKNTO        BOKNTO
     C                   MOVE      WSKNCO        BOKNCO
     C                   MOVE      WSKNFO        BOKNFO
     C                   MOVE      WSTFXO        BOTFXO
     C                   MOVE      WSKNTL        BOKNTL
     C                   MOVE      WSKNCL        BOKNCL
     C                   MOVE      WSKNFL        BOKNFL
     C                   MOVE      WSTFXL        BOTFXL
     C                   MOVE      WSKNTT        BOKNTT
     C                   MOVE      WSKNCT        BOKNCT
     C                   MOVE      WSKNFT        BOKNFT
     C                   MOVE      WSTFXT        BOTFXT
     C                   MOVE      WSKNTP        BOKNTP
     C                   MOVE      WSKNCP        BOKNCP
     C                   MOVE      WSKNFP        BOKNFP
     C                   MOVE      WSTFXP        BOTFXP
     C                   MOVE      WSKNTE        BOKNTE
     C                   MOVE      WSKNCE        BOKNCE
     C                   MOVE      WSKNFE        BOKNFE
     C                   MOVE      WSTFXE        BOTFXE
     C                   MOVE      WSKNBB        BOKNBB
     C                   MOVE      WSTFBB        BOTFBB
     C                   UPDATE    BOOKINGR
     C                   END
     C*
     C     WSUTO         IFEQ      'J'
     C     WSUTL         OREQ      'J'
     C     WSUTT         OREQ      'J'
     C     WSUTP         OREQ      'J'
     C     WSUTE         OREQ      'J'
     C                   Z-ADD     29            YPLNR             3 0
     C     KODTPK        CHAIN     KODTP                              33
     C  N33              MOVE      KOPNVN        UPRT29           10
     C  N33              MOVE      KOPTY         UPT29            10
     C     UPRT29        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT29
     C                   END
     C     UPT29         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT29
     C                   END
     C                   CALL      'SYSJ56CL'
S02  C*                  PARM                    WSOPD
N02  C                   PARM      WSOPD         UOPDF             7 0
     C                   PARM      WSOPD         UOPDT             7 0
     C                   PARM                    BT
     C                   PARM                    UPRT29
     C                   PARM                    UPT29
     C                   PARM                    WSJBQ
     C                   END
      *
     C     WSUTBB        IFEQ      'J'
     C                   Z-ADD     29            YPLNR             3 0
     C     KODTPK        CHAIN     KODTP                              33
     C  N33              MOVE      KOPNVN        UPRT29           10
     C  N33              MOVE      KOPTY         UPT29            10
     C     UPRT29        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT29
     C                   END
     C     UPT29         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT29
     C                   END
     C                   CALL      'SYSJ69CL'
     C                   PARM                    WSOPD
     C                   PARM      WSOPD         UOPDT
     C                   PARM                    UPRT29
     C                   PARM                    UPT29
     C                   PARM                    WSJBQ
     C                   END
     C*
     C     WSUTA         IFEQ      'J'
     C                   Z-ADD     37            YPLNR             3 0
     C     KODTPK        CHAIN     KODTP                              33
     C  N33              MOVE      KOPNVN        UPRT37           10
     C  N33              MOVE      KOPTY         UPT37            10
     C     UPRT37        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT37
     C                   END
     C     UPT37         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT37
     C                   END
     C                   CALL      'SYSJ65CL'
     C                   PARM                    WSOPD
     C                   PARM      WSOPD         UOPDT
     C                   PARM                    UPRT37
     C                   PARM                    UPT37
     C                   PARM                    WSJBQ
     C                   END
     C*
     C     WSUTF         IFEQ      'J'
     C                   Z-ADD     18            YPLNR             3 0
     C     KODTPK        CHAIN     KODTP                              33
     C  N33              MOVE      KOPNVN        UPRT18           10
     C  N33              MOVE      KOPTY         UPT18            10
     C     UPRT18        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT18
     C                   END
     C     UPT18         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT18
     C                   END
     C                   CALL      'SYSJ26CL'
     C                   PARM                    WSOPD
     C                   PARM      WSOPD         UOPDT
     C                   PARM                    UPRT18
     C                   PARM                    UPT18
     C                   PARM                    WSJBQ
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C     WSKNTO        IFNE      0                                            1<-B
     C                   MOVE      WSKNTO        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            99
     C   99              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNCO        IFNE      0                                            1<-B
     C                   MOVE      WSKNCO        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            98
     C   98              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNFO        IFNE      0                                            1<-B
     C                   MOVE      WSKNFO        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            97
     C   97              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNTL        IFNE      0                                            1<-B
     C                   MOVE      WSKNTL        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            96
     C   96              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNCL        IFNE      0                                            1<-B
     C                   MOVE      WSKNCL        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            95
     C   95              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNFL        IFNE      0                                            1<-B
     C                   MOVE      WSKNFL        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            94
     C   94              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNTT        IFNE      0                                            1<-B
     C                   MOVE      WSKNTT        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            93
     C   93              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNCT        IFNE      0                                            1<-B
     C                   MOVE      WSKNCT        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            92
     C   92              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNFT        IFNE      0                                            1<-B
     C                   MOVE      WSKNFT        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            91
     C   91              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNTP        IFNE      0                                            1<-B
     C                   MOVE      WSKNTP        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            90
     C   90              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNCP        IFNE      0                                            1<-B
     C                   MOVE      WSKNCP        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            89
     C   89              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNFP        IFNE      0                                            1<-B
     C                   MOVE      WSKNFP        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            88
     C   88              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNTE        IFNE      0                                            1<-B
     C                   MOVE      WSKNTE        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            87
     C   87              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNCE        IFNE      0                                            1<-B
     C                   MOVE      WSKNCE        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            86
     C   86              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNFE        IFNE      0                                            1<-B
     C                   MOVE      WSKNFE        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            85
     C   85              SETON                                        30
     C                   END                                                    1<-E
     C*
     C     WSKNBB        IFNE      0                                            1<-B
     C                   MOVE      WSKNBB        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            84
     C   84              SETON                                        30
     C                   END                                                    1<-E
     C*
     C   30              EXSR      SETCUR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SETCUR        BEGSR
     C***********************************************
     C                   MOVE      'SPK0124'     MSGNR
     C   84
     COR 85
     COR 88
     COR 91
     COR 94
     COR 97              Z-ADD     38            POSNBR
     C   86
     COR 89
     COR 92
     COR 95
     COR 98              Z-ADD     29            POSNBR
     C   87
     COR 90
     COR 93
     COR 96
     COR 99              Z-ADD     20            POSNBR
     C*
     C   84              Z-ADD     13            LINNBR
     C   85
     COR 86
     COR 87              Z-ADD     12            LINNBR
     C   88
     COR 89
     COR 90              Z-ADD     11            LINNBR
     C   91
     COR 92
     COR 93              Z-ADD     10            LINNBR
     C   94
     COR 95
     COR 96              Z-ADD     9             LINNBR
     C   97
     COR 98
     COR 99              Z-ADD     8             LINNBR
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    SØKKUN        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    FIFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    SOKNR1
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    SOKNR2
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    SOKNR3
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
S01  C*                  Z-ADD     0             UFLAGG
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     20
N01  C     POSNBR        ANDLE     27
S01  C*    POSNBR        ANDLE     45
S01  C*                  MOVE      WSKNTO        SOKNR1            8 0
S01  C*                  MOVE      WSKNCO        SOKNR2            8 0
S01  C*                  MOVE      WSKNFO        SOKNR3            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNTO
S01  C*                  MOVE      SOKNR2        WSKNCO
S01  C*                  MOVE      SOKNR3        WSKNFO
S01  C*                  Z-ADD     52            POSNBR
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNTO
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01  C*
N01  C     LINNBR        IFEQ      8
N01  C     POSNBR        ANDGE     29
N01  C     POSNBR        ANDLE     36
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNCO
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
N01  C*
N01  C     LINNBR        IFEQ      8
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFO
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     52            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     20
N01  C     POSNBR        ANDLE     27
S01  C*    POSNBR        ANDLE     45
S01  C*                  MOVE      WSKNTL        SOKNR1            8 0
S01  C*                  MOVE      WSKNCL        SOKNR2            8 0
S01  C*                  MOVE      WSKNFL        SOKNR3            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNTL
S01  C*                  MOVE      SOKNR2        WSKNCL
S01  C*                  MOVE      SOKNR3        WSKNFL
S01  C*                  Z-ADD     52            POSNBR
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNTL
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01   *
N01  C     LINNBR        IFEQ      9
N01  C     POSNBR        ANDGE     29
N01  C     POSNBR        ANDLE     36
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNCL
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      9
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFL
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     52            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     20
N01  C     POSNBR        ANDLE     27
S01  C*    POSNBR        ANDLE     45
S01  C*                  MOVE      WSKNTT        SOKNR1            8 0
S01  C*                  MOVE      WSKNCT        SOKNR2            8 0
S01  C*                  MOVE      WSKNFT        SOKNR3            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNTT
S01  C*                  MOVE      SOKNR2        WSKNCT
S01  C*                  MOVE      SOKNR3        WSKNFT
S01  C*                  Z-ADD     52            POSNBR
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNTT
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01   *
N01  C     LINNBR        IFEQ      10
N01  C     POSNBR        ANDGE     29
N01  C     POSNBR        ANDLE     36
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNCT
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      10
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFT
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     52            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     20
N01  C     POSNBR        ANDLE     27
S01  C*    POSNBR        ANDLE     45
S01  C*                  MOVE      WSKNTP        SOKNR1            8 0
S01  C*                  MOVE      WSKNCP        SOKNR2            8 0
S01  C*                  MOVE      WSKNFP        SOKNR3            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNTP
S01  C*                  MOVE      SOKNR2        WSKNCP
S01  C*                  MOVE      SOKNR3        WSKNFP
S01  C*                  Z-ADD     52            POSNBR
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNTP
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     29
N01  C     POSNBR        ANDLE     36
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNCP
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      11
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFP
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     52            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     20
N01  C     POSNBR        ANDLE     27
S01  C*    POSNBR        ANDLE     45
S01  C*                  MOVE      WSKNTE        SOKNR1            8 0
S01  C*                  MOVE      WSKNCE        SOKNR2            8 0
S01  C*                  MOVE      WSKNFE        SOKNR3            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNTE
S01  C*                  MOVE      SOKNR2        WSKNCE
S01  C*                  MOVE      SOKNR3        WSKNFE
S01  C*                  Z-ADD     52            POSNBR
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNTE
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     29            POSNBR
     C                   GOTO      SLSØK
     C                   END
N01   *
N01  C     LINNBR        IFEQ      12
N01  C     POSNBR        ANDGE     29
N01  C     POSNBR        ANDLE     36
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNCE
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     38            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      12
N01  C     POSNBR        ANDGE     38
N01  C     POSNBR        ANDLE     45
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFE
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     52            POSNBR
N01  C                   GOTO      SLSØK
N01  C                   END
     C*
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     20
     C     POSNBR        ANDLE     27
S01  C*                  Z-ADD     1             SOANTK
S01  C*                  MOVE      WSKNBB        SOKNR1            8 0
S01  C*                  EXSR      SØKKUN
S01  C*                  MOVE      SOKNR1        WSKNBB
S01  C*                  Z-ADD     3             SOANTK
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNBB
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
     C                   Z-ADD     52            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     BOOKK         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI
     C                   KFLD                    UAVD
     C                   KFLD                    YPLNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C                   Z-ADD     0             UFLAGG
     C*
     C                   MOVE      'P'           YPUNI             1
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C*
     C                   MOVE      *BLANKS       BT
     C                   MOVE      *ZEROS        WSDTO
     C                   MOVE      *ZEROS        BODTO
     C                   MOVE      *ZEROS        WSDTL
     C                   MOVE      *ZEROS        BODTL
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        BODTT
     C                   MOVE      *ZEROS        WSDTP
     C                   MOVE      *ZEROS        BODTP
     C                   MOVE      *ZEROS        WSDTE
     C                   MOVE      *ZEROS        BODTE
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        BODTS
     C                   MOVE      *ZEROS        WSDTA
     C                   MOVE      *ZEROS        BODTA
     C                   MOVE      *ZEROS        WSDTBB
     C                   MOVE      *ZEROS        BODTBB
     C                   MOVE      'J'           WSUTO
     C                   MOVE      'N'           WSUTL
     C                   MOVE      'N'           WSUTT
     C                   MOVE      'N'           WSUTP
     C                   MOVE      'N'           WSUTE
     C                   MOVE      'N'           WSUTA
     C                   MOVE      'N'           WSUTF
     C                   MOVE      'N'           WSUTBB
     C                   MOVE      'N'           WSJBQ
     C*
S01  C*                  MOVE      'DIV3125'     XMSGNR            7            MELDING-ID
S01  C*                  Z-ADD     3             XLEVEL            1 0          NIVÅ
S01  C*                  Z-ADD     0             XRETUR            1 0          RETURKODE
S01  C*                  Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT1            8
S01  C*                  MOVE      'DIV3126'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT2            8
S01  C*                  MOVE      'DIV3127'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  EXSR      HENTMS
S01  C*                  MOVEL     XMSG          SOTXT3            8
     C*
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   SETOFF                                       33
     C                   READ      FIRM                                   33
     C*
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UOPD          WSOPD
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              DO
     C                   MOVE      BOKNTO        WSKNTO
     C                   MOVE      BOKNCO        WSKNCO
     C                   MOVE      BOKNFO        WSKNFO
     C                   MOVE      BOTFXO        WSTFXO
     C                   MOVE      BOKNTL        WSKNTL
     C                   MOVE      BOKNCL        WSKNCL
     C                   MOVE      BOKNFL        WSKNFL
     C                   MOVE      BOTFXL        WSTFXL
     C                   MOVE      BOKNTT        WSKNTT
     C                   MOVE      BOKNCT        WSKNCT
     C                   MOVE      BOKNFT        WSKNFT
     C                   MOVE      BOTFXT        WSTFXT
     C                   MOVE      BOKNTP        WSKNTP
     C                   MOVE      BOKNCP        WSKNCP
     C                   MOVE      BOKNFP        WSKNFP
     C                   MOVE      BOTFXP        WSTFXP
     C                   MOVE      BOKNTE        WSKNTE
     C                   MOVE      BOKNCE        WSKNCE
     C                   MOVE      BOKNFE        WSKNFE
     C                   MOVE      BOTFXE        WSTFXE
     C                   MOVE      BOKNBB        WSKNBB
     C                   MOVE      BOTFBB        WSTFBB
     C                   UPDATE    BOOKINGR
     C                   EXSR      KDTFMT
     C                   END
     C*
     C                   ENDSR
     C*
S01  C***********************************************
S01  C*    HENTMS        BEGSR
S01  C***********************************************
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    XMSG             62
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*
S01  C*                  ENDSR
S01  C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BODTOD        UDT1              2 0
     C                   MOVE      BODTOM        UDT2              2 0
     C                   MOVE      BODTOÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTOD
     C                   MOVE      UDT2          WSDTOM
     C                   MOVE      UDT3          WSDTOÅ
     C*
     C                   MOVE      BODTLD        UDT1              2 0
     C                   MOVE      BODTLM        UDT2              2 0
     C                   MOVE      BODTLÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTLD
     C                   MOVE      UDT2          WSDTLM
     C                   MOVE      UDT3          WSDTLÅ
     C*
     C                   MOVE      BODTTD        UDT1              2 0
     C                   MOVE      BODTTM        UDT2              2 0
     C                   MOVE      BODTTÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTTD
     C                   MOVE      UDT2          WSDTTM
     C                   MOVE      UDT3          WSDTTÅ
     C*
     C                   MOVE      BODTPD        UDT1              2 0
     C                   MOVE      BODTPM        UDT2              2 0
     C                   MOVE      BODTPÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTPD
     C                   MOVE      UDT2          WSDTPM
     C                   MOVE      UDT3          WSDTPÅ
     C*
     C                   MOVE      BODTED        UDT1              2 0
     C                   MOVE      BODTEM        UDT2              2 0
     C                   MOVE      BODTEÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTED
     C                   MOVE      UDT2          WSDTEM
     C                   MOVE      UDT3          WSDTEÅ
     C*
     C                   MOVE      BODTSD        UDT1              2 0
     C                   MOVE      BODTSM        UDT2              2 0
     C                   MOVE      BODTSÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTSD
     C                   MOVE      UDT2          WSDTSM
     C                   MOVE      UDT3          WSDTSÅ
     C*
     C                   MOVE      BODTAD        UDT1              2 0
     C                   MOVE      BODTAM        UDT2              2 0
     C                   MOVE      BODTAÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTAD
     C                   MOVE      UDT2          WSDTAM
     C                   MOVE      UDT3          WSDTAÅ
     C*
     C                   MOVE      BODTBD        UDT1              2 0
     C                   MOVE      BODTBM        UDT2              2 0
     C                   MOVE      BODTBÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTBD
     C                   MOVE      UDT2          WSDTBM
     C                   MOVE      UDT3          WSDTBÅ
     C*
     C                   ENDSR
     C*
