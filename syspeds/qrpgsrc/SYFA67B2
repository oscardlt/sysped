********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 endring
********************************************************************
      * LEGGER UT OLJE OG/ELLER VALTILLEG (HVIS KODE ULIK BLANK)
      * PÅ ALLE KUNDER SOM HAR GITTE GEBYRKODER (F.EKS FRA) I AVTALEN
*OBS  * Linjer med *OBS  i margen vil være kundespesifike!!!
     FPRIK2     UF A E           K DISK
s01  F*RLK      O  A E             DISK
*OBS C                   MOVE      '   '         OILGEB            3            OLJETILLEGG
*OBS C                   MOVE      'CAI'         VALGEB            3            VALUTATILLEG
      *
     C     KEY           KLIST
     C                   KFLD                    GMKNR
     C                   KFLD                    GMAVTN
     C                   KFLD                    GMLNR
     C     *LIKE         DEFINE    PKKNR         GMKNR
     C     *LIKE         DEFINE    PKAVTN        GMAVTN
     C     *LIKE         DEFINE    PKLNR         GMLNR
      *
     C     '00000001'    SETLL     PRIK2
     C                   READ      PRIK2                                  33
     C     *IN33         DOWEQ     '0'
*OBS C     PKGEBY        IFEQ      'SEA'
*OBS C     PKGEBY        OREQ      'SJI'
     C     PKAVTT        IFEQ      'T'
     C     PKAVTT        OREQ      'P'
     C     PKAVTT        OREQ      'B'
     C                   EXSR      ADDGEB
     C                   END
     C                   END
     C                   READ      PRIK2                                  33
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
      ***************************************
     C     ADDGEB        BEGSR
      ***************************************
      * FINN HØYESTE LNR PÅ DENNE AVTALE, LEGG TIL 1
     C                   MOVE      PKKNR         GMKNR
     C                   MOVE      PKAVTN        GMAVTN
     C                   Z-ADD     9999          GMLNR
     C     KEY           SETLL     PRIK2
     C                   READP     PRIK2                                  34
     C  N34              Z-ADD     PKLNR         GMLNR
     C   34              MOVE      *ZEROS        GMLNR
      * INITIER FASTE FELT..
     C                   CLEAR                   PRIKR
     C                   MOVE      GMKNR         PKKNR
     C                   MOVE      GMAVTN        PKAVTN
     C                   MOVE      'P'           PKAVTT
     C                   MOVE      *ZEROS        PKINT
*OBS C                   MOVE      '1'           PKTNR
*OBS C                   MOVE      'N'           PKMVA
     C                   Z-ADD     GMLNR         PKLNR
      * FØRST OLJE-TILLEGG (DIESELTILLEG / BAF)
     C     OILGEB        CABEQ     *BLANKS       VALTAG
     C                   ADD       1             PKLNR
     C                   MOVE      OILGEB        PKGEBY
     C                   MOVE      'NOK'         PKFVAL
     C                   Z-ADD     8.0           PKBELØ
     C                   WRITE     PRIKR
      *
     C     VALTAG        TAG
      * SÅ VALUTATILLEGG OMIT IN,PK,BD,LK,US,JP
     C     VALGEB        CABEQ     *BLANKS       ENDTAG
     C                   ADD       1             PKLNR
     C                   MOVE      VALGEB        PKGEBY
     C                   MOVE      'NOK'         PKFVAL
*OBS
*OBS C                   Z-ADD     6.2           PKBELØ
*OBS C                   MOVE      'I'           PKFRIO
*OBS C                   MOVE      'FOB'         PKFR01
*OBS C                   MOVE      'EXW'         PKFR02
*OBS C                   MOVE      'O'           PKOTIO
*OBS C                   MOVE      'I1'          PKOT01
*OBS C                   MOVE      'I2'          PKOT02
*OBS C                   MOVE      'O'           PKLKIO
*OBS C                   MOVE      'IN'          PKLK01
     C                   WRITE     PRIKR
      *
s01  C*                  CLEAR                   PRLKR
s01  C*                  MOVE      PKKNR         BPKKNR
s01  C*                  MOVE      PKAVTN        BPKAVT
s01  C*                  MOVE      PKLNR         BPKLNR
*OBS C                   MOVE      'PK'          PKLK02
*OBS C                   MOVE      'BD'          PKLK03
*OBS C                   MOVE      'LK'          PKLK04
*OBS C                   MOVE      'US'          PKLK05
*OBS C                   MOVE      'JP'          PKLK06
s01  C*                  WRITE     PRLKR
*OBS  *
*OBS  * SÅ VALUTATILLEGG FOR JP
*OBS C                   ADD       1             PKLNR
*OBS C                   Z-ADD     6.2           PKBELØ
*OBS C                   MOVE      'I'           PKLKIO
*OBS C                   MOVE      'JP'          PKLK01
*OBS C                   WRITE     PRIKR
*OBS  *
*OBS  *
*OBS  * SÅ VALUTATILLEGG FOR RESTEN
*OBS C                   ADD       1             PKLNR
*OBS C                   Z-ADD     7.38          PKBELØ
*OBS C                   MOVE      'I'           PKLKIO
*OBS C                   MOVE      'IN'          PKLK01
*OBS C                   WRITE     PRIKR
*OBS  *
*OBS C*                  CLEAR                   PRLKR
*OBS C*                  MOVE      PKKNR         BPKKNR
*OBS C*                  MOVE      PKAVTN        BPKAVT
*OBS C*                  MOVE      PKLNR         BPKLNR
*OBS C*                  MOVE      'PK'          PKLK02
*OBS C*                  MOVE      'BD'          PKLK03
*OBS C*                  MOVE      'LK'          PKLK04
*OBS C*                  WRITE     PRLKR
      *
      *
     C     ENDTAG        TAG
      * SETT KEY FORBI DENNE KUNDE/AVTNR
     C                   Z-ADD     9999          GMLNR
     C     KEY           SETLL     PRIK2
      *
     C                   ENDSR
      *
