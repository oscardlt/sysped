/* ENDRET EPOSTSRC TIL Å LIGGE I QTEMPO */
             PGM        PARM(&QUSER &QNBR &QJOB &SPOOL &SPLN &EPOST +
                          &EPOST2 &EPOST3 &EPOST4 &EPOST5 &EMNE +
                          &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 &CVP6 &CVP7 +
                          &CVP8 &PDF)
             DCL        VAR(&BANET) TYPE(*CHAR) LEN(20)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(80)
             DCL        VAR(&BANEH) TYPE(*CHAR) LEN(80)
             DCL        VAR(&SPLN) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&SPLA) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SPLN6) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&MANAUT) TYPE(*CHAR) LEN(1) VALUE('V')
             DCL        VAR(&RPLNA) TYPE(*CHAR) LEN(8) +
                          VALUE('*CURRENT')
             DCL        VAR(&RPLAD) TYPE(*CHAR) LEN(8)
             DCL        VAR(&UUUNIK) TYPE(*CHAR) LEN(9)
             DCL        VAR(&MELD1) TYPE(*CHAR) LEN(256)
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(1) /* DISTLISTE */
             DCL        VAR(&MELD1) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD2) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD3) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD4) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD5) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD6) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MELD) TYPE(*CHAR) LEN(1536)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(11) /* Unikkode */
             DCL        VAR(&TIL) TYPE(*CHAR) LEN(30)
             DCL        VAR(&JOBN) TYPE(*CHAR) LEN(6)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOST2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOST3) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOST4) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOST5) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOSTF) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOST7) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO01) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO02) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO03) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO04) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO05) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO06) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO07) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO08) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO09) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO10) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO11) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO12) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO13) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO14) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO15) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO16) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO17) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO18) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO19) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO20) TYPE(*CHAR) LEN(70)
             DCL        VAR(&SPOOL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMNE) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&PDF) TYPE(*CHAR) LEN(4)
             DCL        VAR(&TIL50) TYPE(*CHAR) LEN(50)
             DCL        VAR(&LOG50) TYPE(*CHAR) LEN(50)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10) VALUE(QTEMP)
 RTVTIME:    RTVJOBA    NBR(&JOBN)
/*                           */
/* HENTER BANE TIL DOKUMENT  */
/*                           */
             CHGVAR     VAR(&SPLA) VALUE(&SPLN)
             CHGVAR     VAR(&SPLN6) VALUE(&SPLN)
             CALL       PGM(MAIL07R) PARM(&SPOOL &QNBR &QUSER &QJOB +
                          &SPLA &BANE &BANEH &BANET)
/*                           */
             CALL       PGM(MAIL09CL) PARM(&BANET)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             DSPJOBLOG  OUTPUT(*PRINT)
             CALL       PGM(MAILINFCL) PARM(&SPOOL &QNBR &QUSER &QJOB +
                          &BANE &SPLN6)
             RMVLIBLE   LIB(MMAIL)
VID:         CHGVAR     VAR(&RPLNA) VALUE(&QUSER)
             RTVNETA    SYSNAME(&RPLAD)
/*                      */
/* HENT REPLYADRESSE    */
/*                      */
/*                      */
             CALL       PGM(EPOS04) PARM(&QUSER &RPLNA &RPLAD &EPOST7)
             CHGVAR     VAR(&EPOSTF) VALUE(&EPOST7)
/*                      */
/*                      */
/* LEGGER UT COVERPAGE  */
/* I SOURCE             */
/*                      */
/*           RTVDTAARA  DTAARA(FIRMDT (141 10)) RTNVAR(&LIB)  */
             CRTDUPOBJ  OBJ(EPOSTSRC) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(EPOSTSRC)
             MONMSG     MSGID(CPF0000)
             ADDPFM     FILE(QTEMP/EPOSTSRC) MBR(&QUSER)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(QTEMP/EPOSTSRC) MBR(&QUSER)
             OVRDBF     FILE(EPOSTSRC) TOFILE(QTEMP/EPOSTSRC) +
                          MBR(&QUSER)
             CHGVAR     VAR(&LOG50) VALUE(&EPOST)
             CALL       PGM(MAIL08R) PARM(&CVP1 &CVP2 &CVP3 &CVP4 +
                          &CVP5 &CVP6 &CVP7 &CVP8 &BANEH  &EMNE &LOG50 +
                          &MANAUT &UUUNIK)
/* LAG SNDDST I QTEMP   */
/*                      */
             DLTF       FILE(QTEMP/SNDDST)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(EPOST80) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) NEWOBJ(SNDDST)
/*                                     */
/* PRØVER Å LAGRE SPOOLFILE            */
/*                                     */
             OVRDBF     FILE(EPOST80) TOFILE(QTEMP/SNDDST)
             CALL       PGM(EPMM02) PARM(&UUUNIK)
/*                                     */
/* UTEN DISTRIBUSJONSLISTE             */
/*                                     */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             CHGVAR     VAR(&DIST) VALUE(%SST(&EPOST 1 1))
             CHGVAR     VAR(&DISTL) VALUE(%SST(&EPOST 2 6))
             IF         COND(&DIST *NE '*') THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPOST)
/* VED 5 MOTTAKERE */
             IF         COND(&EPOST5 *NE '*NONE                    ') +
                          THEN(DO)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO +
                          &EPOST2/&EPOST2/*TO &EPOST3/&EPOST3/*TO +
                          &EPOST4/&EPOST4/*TO &EPOST5/&EPOST5/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
             RMVLIBLE   LIB(MMAIL)
             RETURN
                          ENDDO
/* VED 4 MOTTAKERE */
             IF         COND(&EPOST4 *NE '*NONE                    ') +
                          THEN(DO)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO +
                          &EPOST2/&EPOST2/*TO &EPOST3/&EPOST3/*TO +
                          &EPOST4/&EPOST4/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
             RMVLIBLE   LIB(MMAIL)
             RETURN
                          ENDDO
/* VED 3 MOTTAKERE */
             IF         COND(&EPOST3 *NE '*NONE                    ') +
                          THEN(DO)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO +
                          &EPOST2/&EPOST2/*TO &EPOST3/&EPOST3/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
             RMVLIBLE   LIB(MMAIL)
             RETURN
                          ENDDO
/* VED 2 MOTTAKERE */
             IF         COND(&EPOST2 *NE '*NONE                    ') +
                          THEN(DO)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO +
                          &EPOST2/&EPOST2/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
             RMVLIBLE   LIB(MMAIL)
             RETURN
                          ENDDO
/* VED 2 MOTTAKERE */
             IF         COND(&TIL50  *NE '                         ') +
                          THEN(DO)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
             RMVLIBLE   LIB(MMAIL)
             RETURN
                          ENDDO
             ENDDO
/*                      */
/*                                       */
/*                                     */
/*  SENDING VED DISTRIBUSJONSLISTE     */
/*                                     */
             CALL       PGM(EPODIS) PARM(&DISTL &EPO01 &EPO02 &EPO03 +
                          &EPO04 &EPO05 &EPO06 &EPO07 &EPO08 &EPO09 +
                          &EPO10 &EPO11 &EPO12 &EPO13 &EPO14 &EPO15 +
                          &EPO16 &EPO17 &EPO18 &EPO19 &EPO20)
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO01 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO01)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO02 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO02)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO03 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO03)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO04 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO04)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO05 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO05)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO06 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO06)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO07 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO07)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO08 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO08)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO09 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO09)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO10 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO10)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO11 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO11)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO12 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO12)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO13 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO13)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO14 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO14)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO15 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO15)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO16 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO16)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO17 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO17)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO18 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO18)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO19 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO19)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
/*                                     */
/*  SENDING TIL MOTTAGER               */
/*                                     */
             IF         COND(&EPO20 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&TIL50) VALUE(&EPO20)
             EMLSTMF    SUBJECT(&EMNE) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&TIL50/&TIL50/*TO) +
                          STMF(&BANE) MSGM(&LIB/EPOSTSRC/&QUSER)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             ENDPGM
/*                      */
