/* LISTEHØYDE FRA 66 TIL 70   */
             PGM        PARM(&AVD &TUR &STMF &BANE &VISE &INFOP)
    /* */
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10) +
                          VALUE('SYFI48P ')
             DCL        VAR(&ATYPE) TYPE(*CHAR) LEN(2) VALUE('lo')
             DCL        VAR(&FINS) TYPE(*CHAR) LEN(1) VALUE('N')
             DCL        VAR(&AUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&DRAWER) TYPE(*CHAR) LEN(7)
             DCL        VAR(&DRAWUT) TYPE(*CHAR) LEN(11)
             DCL        VAR(&COPIES)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&PNAVN)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&LOGO)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&STAA) TYPE(*DEC) LEN(3 0) VALUE(011)
             DCL        VAR(&LPI2) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&LASER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&LPP) TYPE(*DEC) LEN(3 0) VALUE(72)
             DCL        VAR(&OF) TYPE(*DEC) LEN(3 0) VALUE(64)
             DCL        VAR(&ALLE) TYPE(*CHAR) LEN(3) /* ALLE */
             DCL        VAR(&IN03) TYPE(*LGL) LEN(1) VALUE('1') /* +
                          Hvis &in03 på, skal losseliste  være +
                          stående. */
             DCL        VAR(&IN04) TYPE(*LGL) LEN(1) VALUE('0') /* +
                          Hvis &in04 på, skal printetype være 4224. */
             DCL        VAR(&PRT1) TYPE(*CHAR) LEN(10) /* Printernavn +
                          til stående losseliste. */
             DCL        VAR(&PT1) TYPE(*CHAR) LEN(10) /* Papirtype +
                          til stående losseliste. */
             DCL        VAR(&PRT2) TYPE(*CHAR) LEN(10) /* Printernavn +
                          til liggende losseliste. */
             DCL        VAR(&PT2) TYPE(*CHAR) LEN(10) /* Papirtype +
                          til liggende losseliste. */
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) /* Antall +
                          utskrifter. */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TIME) TYPE(*CHAR) LEN(6)
             DCL        VAR(&EDS) TYPE(*CHAR) LEN(39)
/*N01*/      DCL        VAR(&TUR) TYPE(*CHAR) LEN(8)
/*N01*/      DCL        VAR(&SUM) TYPE(*CHAR) LEN(1)
    /* */
             RTVJOBA    JOB(&QJOB) USER(&AUSER) NBR(&QNBR)
    /* */
VIDERE:      CHGDTAARA  DTAARA(*LDA (15 4)) VALUE(&AVD)
             CHGDTAARA  DTAARA(*LDA (22 8)) VALUE(&TUR)
             CHGDTAARA  DTAARA(*LDA (64 6)) VALUE('510101')
             CHGDTAARA  DTAARA(*LDA (231 3)) VALUE('000')
             CHGDTAARA  DTAARA(*LDA (961 1)) VALUE('N')

    /* */
    /* ----------------------------------------------------------- */
/*N01*/      RTVDTAARA  DTAARA(*LDA (22   8)) RTNVAR(&TUR)
/*N01*/      RTVDTAARA  DTAARA(*LDA (80   1)) RTNVAR(&SUM)
             RTVDTAARA  DTAARA(*LDA (821 10)) RTNVAR(&PRT1)
             RTVDTAARA  DTAARA(*LDA (831 10)) RTNVAR(&PT1)
             RTVDTAARA  DTAARA(*LDA (841 10)) RTNVAR(&PRT2)
             RTVDTAARA  DTAARA(*LDA (851 10)) RTNVAR(&PT2)
             RTVDTAARA  DTAARA(*LDA (993 3)) RTNVAR(&ALLE)
    /* ----------------------------------------------------------- */
    /* SKRIVER UT LOSSELISTE */
    /* ----------------------------------------------------------- */
             RTVDTAARA  DTAARA(*LDA (15 4)) RTNVAR(&AVD)
             CALL       PGM(GETPRN) PARM(&AVD &STAA &PNAVN &FORM +
                          &LASER &LPI2 &DRAWER &COPIES &LOGO &DRAWUT)
             CHGVAR     VAR(&LASER) VALUE('A')
             CHGVAR     VAR(&LPP) VALUE('070')
             CHGVAR     VAR(&OF) VALUE('060')
    /**************************************/
    /* START FOR PDF DOKUMENTER      */
    /**************************************/
    /* ----------------------------------------------------------- */
    /* ORDNER PRINTER FOR LOSSELISTE STÅENDE  PDF  */
    /* ----------------------------------------------------------- */

             IF         COND(&INFOP = 'D') THEN(DO)
             OVRPRTF    FILE(SYFI48P) DEVTYPE(*AFPDS) PAGESIZE(&LPP +
                          120) CPI(15) OVRFLW(&OF) +
                          FRONTOVL(&LOGO) OUTQ(OUTMAIL) +
                          FORMTYPE(&PT1) +
                          TOSTMF(&BANE) WSCST(*PDF)
             ENDDO
             IF         COND(&INFOP *NE 'D') THEN(DO)
             OVRPRTF    FILE(SYFI48P) DEVTYPE(*AFPDS) PAGESIZE(&LPP +
                          120) CPI(15) OVRFLW(&OF) +
                          FRONTOVL(&LOGO) OUTQ(OUTMAIL) +
                          FORMTYPE(&PT1)
             ENDDO
    /* ----------------------------------------------------------- */
    /* */
    /* ----------------------------------------------------------- */
    /* SKRIVER UT LOSSELISTE */
             OVRMSGF    MSGF(QUSERMSG) TOMSGF(SYMSGF)
             RTVJOBA    NBR(&TIME)
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &TIME)
             RMVM       FILE(ASSAM) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(ASSAM) MBR(&UNIK)
             OVRDBF     FILE(ASSAM) TOFILE(ASSAM) MBR(&UNIK)
             CALL       PGM(SYFI48) PARM(&PRANT &IN03 &IN04 &LASER &EDS)
UT:          RMVM       FILE(ASSAM) MBR(&UNIK)
             IF         COND(&INFOP = 'D') THEN(RETURN)
    /* */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE          */
/* UTEN INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILEN) JOB(&QNBR/&AUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
/*                                       */
/* LAGER PDF OG LEGGER I MAPPE           */
/* MED  INFOPRINT                        */
/*                                       */
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &AUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
    /* */

 SLUTT:      ENDPGM
