      *__________________________________________________________
      * SYSTEMA A/S
      *
      * LESER OPPDRAG OG ADDERER POSTER TIL PROSJEKTREG
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     FHEAD1     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FPROSL01   IF A E           K DISK
     FSYSRL01   UF   E           K DISK
     D                 DS
     D  TEKST                  1     30
     D  HEGN                   1     15
     D  XEDTD                 17     18  0
     D  XEDTM                 19     20  0
     D  XEDTÅ                 21     22  0
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     C*--------------------------------------------------------------
     C* DEFINERER NØKKEL TIL KODE-TEKST-FIL
     C*--------------------------------------------------------------
     C     *LIKE         DEFINE    KOVUNI        WRKUNI
     C     *LIKE         DEFINE    KOVAVD        WRKAVD
     C     KODTKE        KLIST
     C                   KFLD                    WRKUNI
     C                   KFLD                    WRKAVD
     C*--------------------------------------------------------------
     C* DEFINERER NØKKEL TIL HEAD1
     C*--------------------------------------------------------------
     C     *LIKE         DEFINE    HEST          WRST
     C     HEA1KE        KLIST
     C                   KFLD                    KOVAVD
     C                   KFLD                    WRST
     C*--------------------------------------------------------------
     C* DEFINERER NØKKEL TIL SYSRL01
     C*--------------------------------------------------------------
     C     *LIKE         DEFINE    FIRMA         XFIRMA
     C     *LIKE         DEFINE    REGNAV        XREGNA
     C     SYSRKE        KLIST
     C                   KFLD                    XFIRMA
     C                   KFLD                    XREGNA
     C*--------------------------------------------------------------
     C*--------------------------------------------------------------
     C* DEFINERER NØKKEL TIL PROSJEKTREGISTER
     C*--------------------------------------------------------------
     C     PROKEY        KLIST
     C                   KFLD                    KOVFIR
     C                   KFLD                    HEPRO
     C*--------------------------------------------------------------
     C* HVIS ALLE GEBYR HAR KODE 'N' I PROSJ.REGNSKAP HOPP UT.....
     C* (DA BETYR J I PROSJ. PÅ AVD.NIVÅ KUN AT TURNR MÅ TASTES PÅ OPD)
     C     *LOVAL        SETLL     KODTGE
     C                   READ      KODTGE                                 33
     C     *IN33         DOWEQ     '0'
     C     KGEPR         IFNE      'N'
     C                   GOTO      PROSOK
     C                   END
     C                   READ      KODTGE                                 33
     C                   END
     C* ALLE VAR "N" - HOPP UT
     C                   GOTO      SLUTT
     C*
     C* GEBYR MED "J" (ELLER BLANK) I PROSJ FANTES-OPPDATER HVIS AVD...
     C     PROSOK        TAG
     C*
     C**** FINNER ALLE AVDELINGER PÅ ØNSKET FIRMA OG GÅR I LØKKE
     C*
     C                   MOVE      'V'           WRKUNI
     C                   MOVE      *ZEROS        WRKAVD
     C     KODTKE        SETLL     KODTV
     C*
     C     STAFIR        TAG
     C                   SETOFF                                       33
     C                   READ      KODTV                                  33
     C   33              GOTO      SLUTT
     C*
     C* KJØRER AVDELING PROSJEKTREGNSKAP ????
     C*
     C     KOVPRO        IFNE      'J'
     C                   GOTO      STAFIR
     C                   END
     C*
     C*
     C* AVDELING FUNNET LESER FØRST DE MED STATUS = ' '
     C*
     C                   MOVE      ' '           WRST
     C     HEA1KE        SETLL     HEAD1
     C                   SETOFF                                       31
     C*
     C     STAR          TAG
     C     HEA1KE        READE     HEAD1                                  31
     C  N31              EXSR      HOVED
     C  N31              GOTO      STAR
     C*
     C*
     C* LESER DERETTER STATUS = H
     C*
     C                   MOVE      'H'           WRST
     C     HEA1KE        SETLL     HEAD1
     C                   SETOFF                                       31
     C*
     C     STAR2         TAG
     C     HEA1KE        READE     HEAD1                                  31
     C  N31              EXSR      HOVED
     C  N31              GOTO      STAR2
     C*
     C*
     C* LESER DERETTER STATUS = G
     C*
     C*** RETTET JOV ***   MOVE 'F'       WRST
     C                   MOVE      'G'           WRST
     C     HEA1KE        SETLL     HEAD1
     C                   SETOFF                                       31
     C*
     C     STAR3         TAG
     C     HEA1KE        READE     HEAD1                                  31
     C  N31              EXSR      HOVED
     C  N31              GOTO      STAR3
     C*
     C                   GOTO      STAFIR
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      ******************************************
     C     HOVED         BEGSR
      ******************************************
     C                   MOVE      HEDTD         XEDTD
     C                   MOVE      HEDTM         XEDTM
     C                   MOVE      HEDTÅ         XEDTÅ
     C     HEUR          IFEQ      'H'
     C                   MOVE      TRRUND        HEPRO
     C                   END
     C     HEPRO         IFNE      *ZEROS
      * OPPRETTER NYTT PROSJEKT HVIS IKKE FINNES FRA FØR
     C     PROKEY        CHAIN     PROSL01                            33
     C  N33              GOTO      EHOVED
     C                   MOVE      'A'           AKTKOD
     C                   Z-ADD     99999         JOURNR
     C                   MOVE      KOVFIR        FIRMA
     C                   Z-ADD     HEPRO         PROSNR
     C                   MOVEL     TEKST         PROSNA
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          STDAAR
     C                   ELSE
     C     UYEAR         ADD       2000          STDAAR
     C                   END
     C                   MOVE      UMONTH        STDMND
     C                   MOVE      UDAY          STDDAG
     C                   MOVE      *ZEROS        SLDAAR
     C                   MOVE      *ZEROS        SLDMND
     C                   MOVE      *ZEROS        SLDDAG
     C                   MOVE      *ZEROS        BUDP
     C                   MOVE      *ZEROS        SALDOP
     C                   MOVE      *BLANKS       STOPP
     C                   MOVE      *BLANKS       PRGRUP
     C                   MOVE      KOVAVD        KSTED
     C                   WRITE     PROSR
     C* OPPDATERER ANTALL BRUKTE POSTER FOR PROS
     C*
     C                   MOVE      KOVFIR        XFIRMA
     C                   MOVE      'PROSF '      XREGNA
     C     SYSRKE        CHAIN     SYSRL01                            30
     C  N30              ADD       1             ANTBRU
     C  N30              UPDATE    SYSRR
     C*
     C                   END
     C     EHOVED        ENDSR
