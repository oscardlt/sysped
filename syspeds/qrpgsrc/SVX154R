********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 VAREBESKRIVELSE ER ENDRET
10XXX * 02 YBC PTF10 GODTA KORTERE TARIFFNR
      *              SISTE SIFRE I TVVNT = ANTALL INNGÅENDE SIFRE
10172 * 03 SH  PTF10 norsk text til Track and trace
10311 * 04 YBC PTF10 DOKUMENTKODE ER ENDRET FRA 3A TIL 4A
10312 * 05 YBC PTF10 OPPDATER LENGDE PÅ EN DEL FELTER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 06 YBC PTF10 RETT FEIL I ENDRING 02
********************************************************************
      *****************************************************************
      *** PROGRAM SKAL KONVERTERE INNGÅENDE EDI-FACT FIL            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01-26                                  ***
      *** LEDIGE INDIKATORER 27-32 34-97                            ***
      *****************************************************************
     FGODSHF    O  A E           K DISK
     FFIRM      IF   E           K DISK
     FEDIRE     IF   E           K DISK
     FSYPROD    IF   E           K DISK
     FGODSJL05  UF A E           K DISK
     FTRACKF    O  A E           K DISK
     FSVNH      UF   E           K DISK
     FSVNV      IF   E           K DISK
     FSVNH05    IF   E           K DISK
     F                                     RENAME(SVNHR:SVNHR05)
     FSVNHFS    UF A E           K DISK
     FSVNL      UF A E           K DISK
     FSVNLCN    UF A E           K DISK
     FSVNLDK    UF A E           K DISK
     FSVNLMN    UF A E           K DISK
     FSVNLKL    UF A E           K DISK
N01  FSVNLVT    UF A E           K DISK
     FSVXKODL01 IF   E           K DISK
     FEDIM2     IF   E           K DISK
     F                                     RENAME(EDIMR:EDIMR2)
     FEDIM4     IF   E           K DISK    RENAME(EDIMR:EDIMR4)
     F                                     PREFIX(M4_)
     FEDIC      UF   E             DISK
     FTVINF     O  A E             DISK
     FEDIM      O  A E             DISK
     FEDIS      O  A E             DISK
     FEDIM6     IF   E           K DISK    PREFIX(M6_)
     F                                     RENAME(EDIMR:EDIMR6)
     FEDIS4     IF   E           K DISK    PREFIX(S4_)
     F                                     RENAME(EDISR:EDISR4)
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZUSER                254    263
     D FT              S             70    DIM(900)
     D S1              S             20    DIM(99)
     D S2              S              2    DIM(99)
     D C1              S             17    DIM(99)
S04  D*D1              S              3    DIM(99)
N04  D D1              S              4    DIM(99)
     D D2              S             35    DIM(99)
N05  D D2L             S              3  0 DIM(99)
     D D3              S              2    DIM(99)
     D D4              S             26    DIM(99)
N05  D D4L             S              3  0 DIM(99)
     D D5              S              2    DIM(99)
     D M1              S             42    DIM(99)
N05  D M1L             S              3  0 DIM(99)
     D M2              S              2    DIM(99)
     D M4              S              3  0 DIM(99)
     D K1              S              2    DIM(99)
     D K2              S              5  0 DIM(99)
     D K3              S              5  0 DIM(99)
N01  D V1              S             70    DIM(99)
N05  D V1L             S              3  0 DIM(99)
     D                 DS
     D XTXT01          C                   CONST('Transittering -
     D                                     avsluttet normalt')
     D XTXT02          C                   CONST('Frigivelsesdato -
     D                                           :')
     D XTXT03          C                   CONST('Fremleggelses -
     D                                     tollsted:')
     D XTXT04          C                   CONST('MRN-nummer      -
     D                                           :')
     D XTXT05          C                   CONST('GODS-nummer     -
     D                                           :')
     D                 DS
     D  FE                     1    256
     D                                     DIM(256)
     D  FELT                   1    256
     D                 DS
     D  AA                     1     80
     D                                     DIM(80)
     D  AADS                   1     80
     D                 DS
     D  AB                     1     80
     D                                     DIM(80)
     D  ABDS                   1     80
     D                 DS
     D  XTRDT                  1      8  0
     D  XTRDTÅ                 1      4
     D  XTRDTM                 5      6
     D  XTRDTD                 7      8
     D                 DS
     D  W0068                  1     16  0
     D  W0068A                 1      8  0
     D  W0068B                 9     14  0
     D                 DS
     D  Æ0068                  1     24
     D  Æ00683                 9     24
     D                 DS
     D  XCREF                  1     11
     D  XCAVD                  1      4  0
     D  XCOPD                  5     11  0
     D                 DS
     D  GOCCÅÅ                 1      4  0
     D  GOCC                   1      2  0
     D  GOÅR                   3      4  0
     D                 DS
     D  WMBR                   1     10
     D  WMBRA                  1      1
     D  WMBRB                  2     10S 0
     IEDIMR2
     I              M0004                       X0004
     I              M0010                       X0010
     I              M0035                       X0035
     I              M0062                       X0062
     I              M0065                       X0065
     I              M0068                       X0068
     I              M0068A                      X0068A
     I              M0068B                      X0068B
     I              M0068C                      X0068C
     I              M0068D                      X0068D
     I              M0068E                      X0068E
     I              M0068F                      X0068F
     I              M1001                       X1001
     I              M1004                       X1004
     I              M1225                       X1225
     I              M2005B                      X2005B
     I              M3039D                      X3039D
     I              M3039E                      X3039E
     I              M5004D                      X5004D
     I              M1N07                       X1N07
     I              M1N08                       X1N08
     I              M9N01                       X9N01
     I              MSN                         XSN
     I              MMN                         XMN
     I              MSR                         XSR
     I              MST                         XST
     I              MDT                         XDT
     I              MTM                         XTM
     I              MVEN                        XVEN
      *___________
      * HODELOGIKK
      *"""""""""""
     C                   EXSR      SRINIT
     C     SEGSTA        TAG
     C  NLR              EXSR      GETSEG
     C   LR              GOTO      SLUTT
     C                   SELECT
     C                   WHEN      SEGNAM = 'UNB'
     C                   EXSR      SRUNB
     C                   WHEN      SEGNAM = 'UNH'
     C                   IF        XFERDIG <> 'J'
     C                   EXSR      SRUNH
     C                   END
     C                   WHEN      SEGNAM = 'UNZ'
     C                   EXSR      SRUNZ
     C                   ENDSL
     C                   IF        SEGNAM = 'UNT'
     C                   MOVE      'J'           XFERDIG           1
     C                   END
     C                   GOTO      SEGSTA
     C     SLUTT         TAG
      *__________________________________________________________
      * SR for initiering                                  SRINIT
      *""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRINIT        BEGSR
      * DEFINERE INTERVARIABLER
     C     *LIKE         DEFINE    TIDK          XIDK
     C     *LIKE         DEFINE    TIALK         XIALK
     C     *LIKE         DEFINE    TIBLK         XIBLK
     C     *LIKE         DEFINE    TICATS        XICATS
     C     *LIKE         DEFINE    TITSB         XITSB
     C     *LIKE         DEFINE    TITRNR        XITRNR
     C     *LIKE         DEFINE    TIKDC         XIKDC
     C     *LIKE         DEFINE    TICTL         XICTL
     C     *LIKE         DEFINE    TIVKB         XIVKB
     C     *LIKE         DEFINE    TITAID        XITAID
     C     *LIKE         DEFINE    TITALK        XITALK
     C     *LIKE         DEFINE    TITASK        XITASK
     C     *LIKE         DEFINE    TITINA        XITINA
     C     *LIKE         DEFINE    TITINS        XITINS
     C     *LIKE         DEFINE    TITINK        XITINK
     C     *LIKE         DEFINE    TINAA         XINAA
     C     *LIKE         DEFINE    TINAS         XINAS
     C     *LIKE         DEFINE    TINAK         XINAK
     C     *LIKE         DEFINE    TIADA1        XIADA1
     C     *LIKE         DEFINE    TIADS1        XIADS1
     C     *LIKE         DEFINE    TIADK1        XIADK1
     C     *LIKE         DEFINE    TIPSA         XIPSA
     C     *LIKE         DEFINE    TIPSS         XIPSS
     C     *LIKE         DEFINE    TIPSK         XIPSK
     C     *LIKE         DEFINE    TISKA         XISKA
     C     *LIKE         DEFINE    TISKS         XISKS
     C     *LIKE         DEFINE    TISKK         XISKK
     C     *LIKE         DEFINE    TIPNA         XIPNA
     C     *LIKE         DEFINE    TIPNS         XIPNS
     C     *LIKE         DEFINE    TIPNK         XIPNK
     C     *LIKE         DEFINE    TILKA         XILKA
     C     *LIKE         DEFINE    TILKS         XILKS
     C     *LIKE         DEFINE    TILKK         XILKK
     C     *LIKE         DEFINE    TILSTL        XILSTL
     C     *LIKE         DEFINE    TIVPOS        XIVPOS
     C     *LIKE         DEFINE    TINTK         XINTK
     C     *LIKE         DEFINE    TINTK         XVNT
     C     *LIKE         DEFINE    TIDANT        XIDANT
     C     *LIKE         DEFINE    TITRDT        XITRDT
      *
     C                   READ      FIRM                                   33
     C* HENTE DAGENS DATO OG TID
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO             8
     C                   PARM                    WTID              6
     C* Parametre fra CL= fil/library/member for fil som behandles
     C     *ENTRY        PLIST
     C                   PARM                    SLIB
     C                   PARM                    SFILE
     C                   PARM                    SMBR
     C                   PARM                    WS               10            (=TVINR)
     C* Returnerer J i OK dersom data er konvertert, N dersom ikke.
     C                   PARM                    OK                1
      * DEFINER NØKKELFELT FOR SVNH
     C     SVNKEY        KLIST
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
      * DEFINER NØKKELFELT FOR SVXKODL01
     C     SVXKODK       KLIST
     C                   KFLD                    TKUNIK
     C                   KFLD                    TKKODE
      * DEFINER NØKKELFELT FOR SVXKODL01
     C     SVXKD2K       KLIST
     C                   KFLD                    T2UNIK
     C                   KFLD                    TKKODE
      * DEFINER NØKKELFELT FOR EDIM2
     C     KEYM2         KLIST
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
     C                   KFLD                    X0068A
     C     KEYM21        KLIST
     C                   KFLD                    TIAVD
     C                   KFLD                    TITDN
     C     KEYM4         KLIST
     C                   KFLD                    M4_MSR
     C                   KFLD                    MAVD
     C                   KFLD                    MTDN
     C     GODS5K        KLIST
     C                   KFLD                    GOGN
     C                   KFLD                    GOTRNR
     C     GODS5KB       KLIST
     C                   KFLD                    GOGN
      * INIT AV ARBEIDSFELT
     C                   MOVE      'N'           OK                             UNB--> J    elt.
     C                   MOVE      *ZEROS        TITDN
     C                   MOVE      *ZEROS        NUMVRD           15 0          Gener. num felt.
     C                   MOVE      *ZEROS        NUTEGN            1 0          "TEGN" numerisk rep.
     C                   MOVE      *BLANKS       SEGNAM            3            Segment navn
     C* De meldingstyper vi mottar i dag inneholder IKKE omberegning
     C                   MOVE      *ZEROS        M0068D                         Dek.dato.OMB/TDENR)
     C                   MOVE      *ZEROS        M0068E                         Dek.sekv.OMB/TDENR)
     C                   MOVE      *ZEROS        M0068F                         Dek.vers.OMB/TDENR)
     C* Enkelte felt i loggen benyttes ikke ved recieve
     C                   MOVE      *ZEROS        M2005B                         Ønsk.be.dat./TDENR)
     C                   MOVE      *ZEROS        M3039D                         Dek.referan./TDENR)
     C                   MOVE      *ZEROS        M3039E                         Eksp.enhet  /TDENR)
     C                   MOVE      *ZEROS        M5004D                         Depositum   /TDENR)
     C                   MOVE      *ZEROS        M9N01                          Eksp.priori./TDENR)
     C                   MOVE      *BLANKS       M1N08                          Meld.id.korr/TDENR)
     C                   MOVE      *BLANKS       MVEN                           Ventekode   /TDENR)
     C                   MOVE      'S'           M4_MSR
     C* Enkelte felt er faste ved recieve
     C                   MOVE      'R'           SSR                            Send/rec.sen
     C                   MOVE      'C'           SST                            Status sendi
     C                   MOVE      WDATO         SDT                            Dato inn sen
     C                   MOVE      WTID          STM                            Tid inn  sen
     C                   MOVE      'R'           MSR                            Send/rec.mel/TDENR)
     C                   MOVE      'C'           MST                            Status meld./TDENR)
     C                   MOVE      WDATO         MDT                            Dato inn mel
     C                   MOVE      WTID          MTM                            Tid inn  mel
     C                   MOVE      '023'         TKUNIK                         Unikkode for kodereg
     C                   MOVE      '149'         T2UNIK            3            Unikkode for kodereg
     C* Datafelt AB i EDIRE (80 lang) går rett inn i array AB ved READ
     C* TN=81 soerger for automatisk overflyt array AB->AA ved kall av GETCH
      * HVIS NETTVERK=KOMMUNEDATA ER FØRSTE RECORD=3 (VED ORIGINAL)
      * DA ER FØRSTE KARAKTER 'ø' I LINJE 1 (LINJE 2 ER BLANK)
      * VED RETRANSMITT FÅR VI IKKE INN "RUSK I LINJE" 1 OG 2
     C     SMBR          SETLL     EDIRE
     C     SMBR          READE     EDIRE                                  LR
     C   LR              GOTO      ENDINI
     C                   MOVE      RDATA         ABDS
     C     AB(1)         IFEQ      'ø'
     C     1             DO        2
     C     SMBR          READE     EDIRE                                  LR
     C   LR              GOTO      ENDINI
     C                   END
     C                   END
     C*
     C                   MOVE      RDATA         ABDS
     C                   Z-ADD     81            TN                2 0
     C                   MOVE      'NO '         EOF               3             * FLAGG FOR EOF
     C                   MOVE      ' '           TEGN              1
     C                   MOVE      ' '           LOKAHE            1
     C*
     C* Spesielt reserverte tegn defineres her med både grafisk verdi og
     C* med en logisk verdi. Den grafiske verdien testes det mot i rutinen
     C* som henter tegn. Finner denne rutinen at at tegnet er ment som en
     C* spesialverdi (ikke ? foran), byttes tegnet med tilsvarende LOGISK VERDI
     C* (De logiske verdiene er ikke lesbre tegn,og vil aldri forekomme i den
     C* innkommende datastroemmen). '?' når brukt som opphevelse foran annet
     C* spesialtegn vil bli "spist" av henterutinen (GETCH) og en vil derfor
     C* kunne betrakte spoersmålstegn som grafisk tegn i resten av programmet.
     C*
     C* Ved andre standarder for spesialtegn er det bare å bytte verdiene til
     C* de GRAFISKE tegnene her. (Programmet arbeider da med riktige verdier).
     C                   MOVE      '?'           GRASPØ            1
     C                   MOVE      '+'           GRAPLU            1
     C                   MOVE      ':'           GRAKOL            1
     C                   BITON     '123457'      GRAAPP            1
     C                   BITOFF    '06'          GRAAPP
     C* Logiske verdier for spesialtegn
     C* LOGAPP = slutt på segmentet. I NODI er tegnet "'".
     C                   MOVE      X'EB'         LOGAPP            1
     C* HVIS KOMMUNEDATA, INITIERE MED LOGAPP (GÅ RETT PÅ UNB)
     C                   MOVE      LOGAPP        TEGN
     C* LOGPLU = sparasjonstegn for Tag/dataelement. I NODI er tegnet "+".
     C                   MOVE      X'EE'         LOGPLU            1
     C* LOGKOL = sparasjonstegn for delelement. I NODI er tegnet ":".
     C                   MOVE      X'ED'         LOGKOL            1
     C* LOGBLA = utenlandske måten å vise blank.
     C                   BITON     '01234567'    LOGBLA            1
     C*
     C     ENDINI        ENDSR
     C*__________________________________________________________
     C* SR for å hente UNBdata - (NodiID.)                 SRUNB
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRUNB         BEGSR
     C* Når UNB-segm er funnet sett 'J' i OK-param.(retur til CL-prog)
     C                   MOVE      'J'           OK                             UNB-->OK=J  elt.
     C* Sendingsnr fra fil
     C                   EVAL      WMBR=SMBR
     C                   EVAL      SSN=WMBRB
     C*
     C* Står nå på + i     'UNB+   -  nå foelger: UNOC:3+
     C                   DO        7
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C                   END
     C* TEGN er nå '+' forran Avsenders Nodi-ID
     C                   MOVE      *BLANKS       FE
     C     1             DO        35            NR                3 0
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB001
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB001        TAG
     C                   MOVEL     FELT          S0004                          Avsenders NODI-ID
      *
     C                   MOVE      *BLANKS       UM0007            4
     C                   MOVE      *BLANKS       UM0008           14
     C                   IF        TEGN = LOGKOL
     C                   MOVE      *BLANKS       FE
     C     1             DO        5             NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB0011
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB0011       TAG
     C                   MOVEL     FELT          UM0007
     C                   IF        TEGN = LOGKOL
     C                   MOVE      *BLANKS       FE
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB0012
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB0012       TAG
     C                   MOVEL     FELT          UM0008
     C                   END
     C                   END
     C* Possisjoner til '+' forran mottagers Nodi-ID
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C                   END
     C* Hent mottakers Nodi-ID
     C                   MOVE      *BLANKS       FE
     C     1             DO        35            NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB002
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB002        TAG
     C                   MOVEL     FELT          S0010                          Mottakers NODI-ID
      *
     C                   MOVE      *BLANKS       UA0007            4
     C                   MOVE      *BLANKS       UA0008           14
     C                   IF        TEGN = LOGKOL
     C                   MOVE      *BLANKS       FE
     C     1             DO        5             NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB0021
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB0021       TAG
     C                   MOVEL     FELT          UA0007
     C                   IF        TEGN = LOGKOL
     C                   MOVE      *BLANKS       FE
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C     TEGN          OREQ      LOGKOL
     C                   GOTO      UNB0022
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB0022       TAG
     C                   MOVEL     FELT          UA0008
     C                   END
     C                   END
     C* Possisjoner til '+' forran dato tidsfelt (mandatory)
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C                   END
     C* Possisjoner til '+' forran sendingsref (mandatory)
     C     TEGN          DOUEQ     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C                   END
     C* Hent sendingsreferanse
     C                   MOVE      *BLANKS       FE
     C     1             DO        256           NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C                   GOTO      UNB010
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB010        TAG
     C                   MOVEL     FELT          S0020                          Meldingsref.DI-ID
      * Hent RECIPIENT REFERECE
     C                   MOVE      *BLANKS       FE
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU
     C     TEGN          OREQ      LOGAPP
     C                   GOTO      UNB011
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNB011        TAG
     C                   MOVEL     FELT          U0022            14
     C* Tegn er nå enten ' for segmentslutt eller + for neste felt
     C* Er testindikator satt ?? (ikke oppgitt eller '1' når oppgitt)
     C                   MOVE      ' '           S0035                          Testindikat.
     C* Spis 4 felt -i det sjette finnes evt testindikator.
     C* Treffes LOGAPP før fem felt er spist er testindikator ikke satt
     C                   DO        4                                            I
     C     TEGN          IFEQ      LOGAPP                                       ii
     C                   GOTO      ENDUNB
     C                   END                                                    ii
     C     1             DO        256           NR                             II
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C     TEGN          IFEQ      LOGPLU                                       III
     C     TEGN          OREQ      LOGAPP
     C                   GOTO      UNB020
     C                   END                                                    III
     C                   END                                                    II
     C     UNB020        TAG
     C                   END                                                    I
     C*
     C* Tegn er + foran testind.(el. ' -seg.slutt etter Ident kom.avt.)
     C*
     C     TEGN          IFEQ      LOGPLU                                       III
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNB
     C                   MOVE      TEGN          S0035                          Testindikato
     C                   END
      *
     C     ENDUNB        ENDSR
      *
     C*__________________________________________________________
     C* SR for å hente UNZdata(oppdatere sendingslogg)     SRUNZ
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRUNZ         BEGSR
     C* TEGN er nå '+' forran Antall meldinger i sendingen(numerisk)
     C                   MOVE      *ZEROS        NUMVRD
     C     1             DO        7             NR                             *max 7 foer '+'
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNZ
     C     TEGN          IFEQ      LOGPLU
     C                   GOTO      UNZT01
     C                   END
     C     TEGN          IFLT      '0'
     C     TEGN          ORGT      '9'
     C                   GOTO      UNZT01
     C                   END
     C                   MULT      10            NUMVRD
     C                   MOVE      TEGN          NUTEGN
     C                   ADD       NUTEGN        NUMVRD
     C                   END
     C     UNZT01        TAG
     C                   Z-ADD     NUMVRD        S0036
     C*
     C* Oppdater sendingsloggen
     C                   WRITE     EDISR
     C*
     C     ENDUNZ        ENDSR
     C*__________________________________________________________
     C* SR for å hente neste tegn i datastroem             GETCH
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     GETCH         BEGSR
     C* Rutinen henter "TEGN" fra array AA. Ved slutten av AA "toemmes" AB inn
     C* i AA. (AB benyttes kun for alltid å kunne ha "lookahead-tegn" - LOKAHE)
     C* LR settes når en ved "Toemming" finner at AB-arrayet er tomt.
     C*
     C* "?" spises av SR når "?" kun varsler grafisk betydning av spesialtegn.
     C*Når tegn ved utgang av SR er ',+ eller :  er betydningen av ind. 98 :
     C*    98 ON -> kun grafisk betydning (uforandret)
     C*    98 OFF-> spesialtegn (Bytt tegn mot ikke lesbar logisk verdi LOG???)
     C                   SETOFF                                           98
     C     STACH         TAG
     C* Må ny record hentes inn i array AA (fra AB)?????
     C     TN            IFEQ      81
     C     EOF           IFEQ      'YES'
     C                   SETON                                            LR
     C                   GOTO      ENDCH
     C                   END
     C                   MOVE      ABDS          AADS
     C  N99SMBR          READE     EDIRE                                  99     *HENT NY TIL AB
     C  N99              MOVE      RDATA         ABDS
     C   99              MOVE      *BLANKS       ABDS
     C   99              MOVE      'YES'         EOF                             * FLAGG FOR EOF
     C                   Z-ADD     1             TN                              * Tegn-index-nr
     C                   END
     C* Hent det tegn som TN peker på - Tegnet etter er "Lookahead"
     C                   MOVE      AA(TN)        TEGN
     C                   ADD       1             TN
     C     TN            IFLE      80
     C                   MOVE      AA(TN)        LOKAHE            1
     C                   ELSE
     C                   MOVE      AB(1)         LOKAHE
     C                   END
     C* Dersom TEGN er "?" og LOKAHE er spes.tegn - "spis" spoersmålstegnet
     C* Når 98 er on her betyr det at "?" foran spesialtegn alt er "spist"
     C*        evt. nytt "?" er da grafisk tegn - LOKAHE skal da IKKE testes.
     C  N98TEGN          IFEQ      GRASPØ
     C     LOKAHE        COMP      GRAAPP                                 98
     C  N98LOKAHE        COMP      GRAPLU                                 98
     C  N98LOKAHE        COMP      GRAKOL                                 98
     C  N98LOKAHE        COMP      GRASPØ                                 98
     C   98              GOTO      STACH
     C                   END
     C* Ved N98 og ',+ eller : i TEGN betyr det at det IKKE var opphevelsestegn
     C* foran. Vi har med andre ord et LOGISK SPESIALTEN INNE
     C  N98TEGN          IFEQ      GRAAPP
     C                   MOVE      LOGAPP        TEGN
     C                   ELSE
     C     TEGN          IFEQ      GRAPLU
     C                   MOVE      LOGPLU        TEGN
     C                   ELSE
     C     TEGN          IFEQ      GRAKOL
     C                   MOVE      LOGKOL        TEGN
     C                   ELSE
     C     TEGN          IFEQ      LOGBLA
     C                   MOVE      ' '           TEGN
     C                   END
     C                   END
     C                   END
     C                   END
     C*
     C     ENDCH         ENDSR
     C*__________________________________________________________
     C* SR for å hente neste Segment                       GETSEG
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     GETSEG        BEGSR
     C* "Spis tegn" til appostrof er lest
     C     TEGN          DOWNE     LOGAPP
     C                   EXSR      GETCH
     C   LR              GOTO      ENDSEG
     C                   END
     C* Har nå lest appostrof - de 3 neste vil være SEGMENTNAVN
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                3 0
     C                   EXSR      GETCH
     C   LR              GOTO      ENDSEG
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C                   MOVEL     FELT          SEGNAM
     C* La TEGN være '+' etter segmentnavnet ved utgang av SR
     C                   EXSR      GETCH
     C* Segmentnavn returneres nå i variabel 'SEGNAM'
     C     ENDSEG        ENDSR
     C*__________________________________________________________
     C* SR for å behandle UNH-segmentet                    SRUNH
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRUNH         BEGSR
     C* Felt fra sendingsloggen - som også legge på meldingsnivå
     C                   MOVE      SSN           MSN                            Sendingsnr
     C                   MOVEL     S0004         M0004                          Nodiid-avs.
     C                   MOVEL     S0010         M0010                          Nodiid-mot.
     C                   MOVE      'STI'         M1001                          Meldingsnavn
     C* Om hele sendingen er test- da er den enkelte melding også test
     C     S0035         IFEQ      '1'
     C                   MOVE      '1'           M0035                          Test-indik.
     C                   END
     C* Hente meldingsnr fra fil (EDIC) og legge det inn MMN
     C     1             CHAIN     EDIC                               33
     C  N33              ADD       1             CMN
     C  N33              UPDATE    EDICR
     C  N33              MOVE      CMN           MMN                            Nr. i meld-
     C   33              Z-ADD     1             MMN                            ingsloggen
     C*                                                                ngde)
     C* Egen referanse inneholder SVNKEY+sign                          ngde)
     C* Her bør vi for IBM-nettet heller lese I EDIM for å finne key  ngde)
     C* via avsendt. (samme dato/sekv/med S i Send/Recieve-kode)       ngde)
     C* maxlengde i NODI for ref er 14-senest innen 15. steg skal + påtreffes.
     C                   MOVE      *BLANKS       FE
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNH
     C     TEGN          IFEQ      LOGPLU
     C                   GOTO      UNH010
     C                   END
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     UNH010        TAG
     C                   MOVEL     FELT          M0062
      *
     C* Hent meldings-ID (fra tollvesenet)  inn i felt M0065
     C                   MOVE      *BLANKS       FE
     C     1             DO        6             NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNH
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C                   MOVEL     FELT          M0065
      *
      * Les forbi :D:96B:UN:
     C     1             DO        4
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNH
     C                   END
     C                   END
      *
      * Les meldingstype (=CCxxxA)
     C                   EXSR      GETCH                                        Les forbi C
     C                   EXSR      GETCH                                        Les forbi C
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNH
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C                   MOVEL     FELT          M1N07
      *
     C                   IF        M1N07 = '917'
     C                   EXSR      SR917
     C                   GOTO      ENDUNH
     C                   END
      *
     C* Hent BGM-segment for meldingstype
     C     SEGNAM        DOWNE     'BGM'
     C     SEGNAM        ANDNE     'UCI'
     C                   EXSR      GETSEG
     C   LR              GOTO      ENDUNH
     C                   END
      *
      * SEGNAM = UCI --> TJENESTEMELING  CONTROLL
     C     SEGNAM        IFEQ      'UCI'
     C                   EXSR      SRCTL
     C                   GOTO      ENDUNH
     C                   END
      *
     C                   MOVE      *BLANKS       XTRNR            18
     C                   MOVE      *ZEROS        XTRDT
     C                   MOVE      *ZEROS        XVNT
      *
     C     M1N07         IFEQ      '043'
      * Les status (T1, T2, ...)
     C                   MOVE      *BLANKS       FE
     C     1             DO        3
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL
     C                   EXSR      GETCH
     C   LR              GOTO      ENDUNH
     C     TEGN          CABEQ     LOGPLU        BGM010
     C                   ENDDO
     C                   ENDDO
     C     1             DO        6             NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGPLU        BGM010
     C     TEGN          CABEQ     LOGAPP        ENDUNH
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO
     C     BGM010        TAG
     C                   MOVEL     FELT          XIDK
     C                   ELSE
      * Les forbi '+'
     C                   EXSR      GETCH
     C                   END
      * Les MRN
     C                   MOVE      *BLANKS       FE
     C     1             DO        20            NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGAPP        BGM020
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     BGM020        TAG
     C                   MOVEL     FELT          XTRNR
      *
     C     XTRNR         CHAIN     SVNH05                             33
     C  N33TIST          DOWGT     'C'
     C     TIST          ANDNE     'U'                                          043
     C     TIST          ANDNE     'L'                                          044
     C     TIST          ANDNE     'H'                                          058
     C     TIST          ANDNE     'K'                                          C01
     C     TIST          ANDNE     'N'                                          C02
     C     TIST          ANDNE     'M'                                          008
      * GODTA ALLE STATUS VED IE25
     C     M1N07         IFEQ      '025'
     C                   LEAVE
     C                   END
     C     XTRNR         READE     SVNH05                                 33
     C  N33              ENDDO
     C     *IN33         CABEQ     '1'           ENDUNH
     C                   MOVE      99999999      X0068A
     C     KEYM2         SETLL     EDIM2
     C     KEYM21        READPE    EDIM2                                  33
     C     *IN33         IFEQ      '0'
     C                   MOVE      X0068         M0068
     C                   MOVE      X0068A        M0068A
     C                   MOVE      X0068B        M0068B
     C                   ELSE
     C                   MOVE      *ZEROS        MAVD
     C                   MOVE      *ZEROS        MTDN
     C                   END
     C                   MOVE      *ZEROS        XN                3 0
      *
     C     M1N07         IFEQ      '043'
     C                   EXSR      LOSSE
     C                   GOTO      ENDUNH
     C                   END
      *
     C     BGM030        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C* Hent segment for meldingstype
     C     SEGNAM        DOWNE     'DTM'
     C     SEGNAM        ANDNE     'FTX'
     C     SEGNAM        ANDNE     'LOC'
     C     SEGNAM        ANDNE     'NAD'
     C     SEGNAM        ANDNE     'UNT'
     C                   EXSR      GETSEG
     C   LR              GOTO      ENDUNH
     C                   END
      *
     C     SEGNAM        CABEQ     'FTX'         FTX010
     C     SEGNAM        CABEQ     'DTM'         DTM010
     C     SEGNAM        CABEQ     'LOC'         LOC010
     C     SEGNAM        CABEQ     'NAD'         NAD010
     C     SEGNAM        CABEQ     'UNT'         ENDUNH
      *
     C     FTX010        TAG
     C                   EXSR      SRFTX
     C   LR              GOTO      ENDUNH
     C                   GOTO      BGM030
      *
     C     DTM010        TAG
      * Hent kode til dato
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGKOL        DTM020
     C     TEGN          CABEQ     LOGPLU        BGM030
     C     TEGN          CABEQ     LOGAPP        BGM030
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     DTM020        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         IFNE      '261'
     C                   GOTO      BGM030
     C                   END
      * Hent dato
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGAPP        DTM030
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     DTM030        TAG
     C                   MOVEL     FELT          XTRDT
     C                   GOTO      BGM030
      *
     C     LOC010        TAG
      * Les kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGPLU        LOC020
     C     TEGN          CABEQ     LOGAPP        BGM030
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     LOC020        TAG
     C                   MOVEL     FELT          XKODE
     C     XKODE         IFNE      '22 '
     C                   GOTO      BGM030
     C                   END
      * Hent fremleggelsestollsted
     C                   MOVE      *BLANKS       FE
     C     1             DO        9             NR
     C                   EXSR      GETCH
     C     TEGN          CABEQ     LOGAPP        LOC030
     C   LR              GOTO      ENDUNH
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     LOC030        TAG
     C                   MOVEL     FELT          XTSSD             8
     C                   GOTO      BGM030
      *
     C     NAD010        TAG
      * Anta at det kommer inn samme opplysninger som utgående.
      * Hvis det senere viser seg ikke riktig, konverter NAD-seg. her.
     C                   GOTO      BGM030
      *
     C     ENDUNH        TAG
     C                   EXSR      OPDFIL
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å konvertere IE917                         SR917 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SR917         BEGSR
     C     SEGNAM        DOWNE     'BGM'
     C                   EXSR      GETSEG
     C   LR              GOTO      SL917
     C                   END
      * Les forbi '+'
     C                   EXSR      GETCH
      * Les MRN
     C                   MOVE      *BLANKS       FE
     C     1             DO        20            NR
     C                   EXSR      GETCH
     C                   IF        ((TEGN = LOGPLU) OR (TEGN = LOGAPP))
     C                   LEAVE
     C                   END
     C   LR              GOTO      SL917
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C                   MOVEL     FELT          XTRNR
      *
     C     XTRNR         CHAIN     SVNH05                             33
     C                   IF        *IN33 = *OFF
     C                   MOVE      99999999      X0068A
     C     KEYM2         SETLL     EDIM2
     C     KEYM21        READPE    EDIM2                                  33
     C     *IN33         IFEQ      '0'
     C                   MOVE      X0068         M0068
     C                   MOVE      X0068A        M0068A
     C                   MOVE      X0068B        M0068B
     C                   ELSE
     C                   MOVE      *ZEROS        MAVD
     C                   MOVE      *ZEROS        MTDN
     C                   END
     C                   END
      *
     C     ST9171        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C     SEGNAM        DOWNE     'FTX'
     C     SEGNAM        ANDNE     'RFF'
     C     SEGNAM        ANDNE     'UNT'
     C                   EXSR      GETSEG
     C   LR              GOTO      SL917
     C                   END
      *
     C     SEGNAM        IFEQ      'FTX'
     C                   EXSR      SRFTX
     C                   GOTO      ST9171
     C                   END
      *
     C     SEGNAM        IFEQ      'RFF'
      *
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      SL917
     C                   ENDDO
      *
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR
     C                   EXSR      GETCH
     C   LR              GOTO      SL917
     C     TEGN          CABEQ     LOGKOL        ST9171
     C     TEGN          CABEQ     LOGPLU        ST9171
     C     TEGN          CABEQ     LOGAPP        ST9171
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     FELT          CABNE     'ABO'         ST9171
      *
     C     TEGN          DOWNE     LOGKOL
     C                   EXSR      GETCH
     C   LR              GOTO      SL917
     C                   ENDDO
      *
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR
     C                   EXSR      GETCH
     C   LR              GOTO      SL917
     C     TEGN          CABEQ     LOGAPP        ST9172
     C                   MOVE      TEGN          FE(NR)
     C                   END
     C     ST9172        TAG
     C                   MOVEL     FELT          XAN10            10
      *
     C     XAN10         CHAIN     EDIS4                              33
     C  N33S4_SSN        CHAIN     EDIM6                              33
     C     *IN33         IFEQ      '0'
     C                   MOVE      M6_MAVD       TIAVD
     C                   MOVE      M6_MTDN       TITDN
     C                   MOVE      M6_MAVD       MAVD
     C                   MOVE      M6_MTDN       MTDN
     C                   MOVE      M6_M0068      M0068
     C                   MOVE      M6_M1225      M1225
     C                   MOVE      M6_M1004      M1004
     C                   MOVE      M6_M0068A     M0068A
     C                   MOVE      M6_M0068B     M0068B
     C                   MOVE      M6_M0068C     M0068C
     C                   MOVE      M6_M0068D     M0068D
     C                   MOVE      M6_M0068E     M0068E
     C                   MOVE      M6_M0068A     M0068A
     C                   ELSE
     C                   MOVE      *ZEROS        TIAVD
     C                   MOVE      *ZEROS        TITDN
     C                   MOVE      *BLANKS       M1225
     C                   END
     C                   END
      *
     C     SL917         ENDSR
     C*__________________________________________________________
     C* SR for å konvertere FTX-segment                   SRFTX /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRFTX         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C     TEGN          CABEQ     LOGPLU        FTX020
     C     TEGN          CABEQ     LOGAPP        FTX099
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     FTX020        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         IFNE      'ACD'                                        1<-B
     C     XKODE         ANDNE     'ABV'
     C     XKODE         ANDNE     'AAO'
     C     XKODE         ANDNE     'AAP'
     C     XKODE         ANDNE     'ABY'
     C     XKODE         ANDNE     'ARR'
     C     XKODE         ANDNE     'ABD'
     C                   GOTO      FTX099
     C                   END                                                    1<-E
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C                   ENDDO                                                  1<-E
      *
     C                   MOVE      *BLANKS       FE
     C     1             DO        2             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C     TEGN          CABEQ     LOGPLU        FTX030
     C     TEGN          CABEQ     LOGAPP        FTX099
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     FTX030        TAG
     C     FELT          IFNE      *BLANKS
     C                   MOVE      '049'         T2UNIK                         1<-B
     C                   MOVEL     FELT          TKKODE
     C     SVXKD2K       CHAIN     SVXKODL01                          33
     C                   ADD       1             XN
     C  N33              MOVEL     TKTXTN        FT(XN)
     C   33              MOVEL     TKKODE        FT(XN)
     C                   END                                                    1<-E
      *
     C     TEGN          IFNE      LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C                   END
      *
     C                   MOVE      *ZEROS        XNR               1 0
     C                   MOVE      *BLANKS       XAN70            70
     C     FTX040        TAG
     C                   ADD       1             XNR
     C                   MOVE      *BLANKS       FE
     C     1             DO        100           NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C     TEGN          CABEQ     LOGKOL        FTX050
     C     TEGN          CABEQ     LOGPLU        FTX050
     C     TEGN          CABEQ     LOGAPP        FTX050
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     FTX050        TAG
     C     FELT          IFNE      *BLANKS                                      1<-B
     C     XKODE         IFEQ      'AAO'                                         2<-B
     C     XNR           IFLE      3                                              3<-B
     C                   MOVEL     FELT          XAN03             3
     C                   MOVE      '149'         T2UNIK
     C                   MOVE      *BLANKS       TKKODE
     C                   MOVEL     XAN03         TKKODE
     C     SVXKD2K       CHAIN     SVXKODL01                          33
     C                   ADD       1             XN
     C     *IN33         IFEQ      '0'                                             4<-B
     C                   MOVEL     TKTXTN        FT(XN)
     C     FE(4)         IFEQ      '('                                              5<-B
     C                   CAT       'POSTNR':1    FT(XN)
     C                   CAT       FE(5):1       FT(XN)
     C                   END                                                        5<-E
     C                   ADD       1             XN
     C     XAN03         IFEQ      'TEV'                                            5<-B
     C                   MOVEL     FELT          XAN10            10
     C                   MOVE      XAN10         XAN03
     C                   MOVEL     XAN03         TKKODE
     C     SVXKD2K       CHAIN     SVXKODL01                          33
     C     *IN33         IFEQ      '0'                                               6<-B
     C                   MOVEL     TKTXTN        FT(XN)
     C     FE(11)        IFEQ      '('                                                7<-B
     C                   CAT       'POSTNR':1    FT(XN)
     C                   CAT       FE(5):1       FT(XN)
     C                   END                                                          7<-E
     C                   ADD       1             XN
     C                   END                                                         6<-E
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   MOVEL     FELT          FT(XN)
      *
      * LES TEKST
     C     FTX060        TAG
     C                   IF        TEGN <> LOGAPP
     C                   MOVE      *BLANKS       FE                                4<-B
     C     1             DO        100           NR                                 5<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX099
     C     TEGN          CABEQ     LOGKOL        FTX070
     C     TEGN          CABEQ     LOGPLU        FTX070
     C     TEGN          CABEQ     LOGAPP        FTX070
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                      5<-E
     C     FTX070        TAG
     C                   IF        FELT <> *BLANKS                                  5<-B
     C                   ADD       1             XN
     C                   MOVEL     FELT          FT(XN)
     C                   END                                                        5<-E
     C     TEGN          CABNE     LOGKOL        FTX060
     C                   END                                                       4<-E
      *
     C                   ELSE                                                     3
     C                   ADD       1             XN
     C                   MOVEL     FELT          XAN06             6
     C                   MOVEL     XAN06         XAN01             1
     C                   MOVE      XAN06         XAN05             5
     C                   MOVE      XAN06         XAN03             3
     C                   SELECT                                                    4<-B
     C     XAN01         WHENEQ    'T'
     C                   MOVEL     'TEKNISK '    FT(XN)
     C                   CAT       'REGEL:':1    FT(XN)
     C                   CAT       XAN03:1       FT(XN)
     C     XAN01         WHENEQ    'C'
     C                   MOVEL     'BETINGEL'    FT(XN)
     C                   CAT       'SE:':0       FT(XN)
     C                   CAT       XAN05:1       FT(XN)
     C     XAN01         WHENEQ    'R'
     C                   MOVEL     'REGEL:'      FT(XN)
     C                   CAT       XAN05:1       FT(XN)
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   ADD       1             XN
     C     XKODE         IFEQ      'AAP'                                          3<-B
     C                   MOVEL     'VERDI:'      FT(XN)
     C                   CAT       FELT:1        FT(XN)
     C                   ELSE                                                     3
     C                   MOVEL     FELT          FT(XN)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     TEGN          CABEQ     LOGKOL        FTX040
     C     TEGN          CABEQ     LOGPLU        FTX099
     C     TEGN          CABEQ     LOGAPP        FTX099
      *
     C     FTX099        ENDSR
     C*__________________________________________________________
     C* SR for å behandle tjenstemelding CONTRL           SRCTL /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCTL         BEGSR
     C                   MOVE      'CTL'         M1N07
     C                   MOVE      'OK '         M1225
     C                   MOVE      MMN           FMN
      * Behandle UCI-segment
     C                   EXSR      SRCTL2
      *
     C     CTL010        TAG
      *
      * Hent segment for meldingstype
     C                   EXSR      GETSEG
     C   LR              GOTO      ENDCTL
      *
     C                   SELECT
     C     SEGNAM        WHENEQ    'UCF'
     C                   EXSR      SRCTL2
     C     SEGNAM        WHENEQ    'UCM'
     C                   EXSR      SRCTL3
     C     SEGNAM        WHENEQ    'UCS'
     C                   EXSR      SRCTL4
     C     SEGNAM        WHENEQ    'UCD'
     C                   EXSR      SRCTL5
     C                   OTHER
     C                   GOTO      ENDCTL
     C                   ENDSL
     C                   GOTO      CTL010
      *
     C     ENDCTL        TAG
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å behandle UCI OG UCF                     SRCTL2 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCTL2        BEGSR
      *
      * Les referansenr
     C                   MOVE      *BLANKS       FELT
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGPLU        CTL210
     C     TEGN          CABEQ     LOGAPP        CTL299
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     CTL210        TAG
     C                   ADD       1             FLN
     C                   MOVEL     TKTXTE        F0078A
      *
      * Les forbi 3 '+'
     C     1             DO        3
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGAPP        CTL290
     C                   END
     C                   END
      * Les syntaks feil
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGPLU        CTL220
     C     TEGN          CABEQ     LOGAPP        CTL220
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL220        TAG
     C                   MOVEL     FELT          TKKODE
     C     TKKODE        CABEQ     *BLANKS       CTL290
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     TKKODE        F0077
     C  N33              MOVEL     TKTXTE        F0078B
     C     TEGN          CABEQ     LOGAPP        CTL290
      * Les forbi '+'.
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGAPP
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGAPP        CTL290
     C                   END
      *
      * Les feilkode
     C                   MOVE      *BLANKS       FELT
     C     1             DO        3             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGKOL        CTL230
     C     TEGN          CABEQ     LOGAPP        CTL230
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL230        TAG
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     TKKODE        F0078C
     C  N33              MOVE      TKTXTE        F0078C
     C     TEGN          CABEQ     LOGAPP        CTL290
      *
      * Les posisjon
     C                   MOVE      *BLANKS       FELT
     C     1             DO        6             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGKOL        CTL240
     C     TEGN          CABEQ     LOGAPP        CTL240
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL240        TAG
     C                   MOVEL     'Posisjon'    XAN16            16
     C                   MOVEL     FELT          XAN06             6
     C                   MOVE      XAN06         XAN16
     C                   MOVEL     XAN16         F0078D
     C     TEGN          CABEQ     LOGAPP        CTL290
      *
      * Les antall feiler
     C                   MOVE      *BLANKS       FELT
     C     1             DO        6             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL299
     C     TEGN          CABEQ     LOGAPP        CTL250
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL250        TAG
     C                   MOVEL     'Antall  '    XAN16            16
     C                   MOVEL     FELT          XAN06             6
     C                   MOVE      XAN06         XAN16
     C                   MOVEL     XAN16         F0078E
      *
     C     CTL290        TAG
     C                   EXSR      OPDTNF
      *
     C     CTL299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle UCM                            SRCTL3 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCTL3        BEGSR
      *
      * Les referansenr
     C                   MOVE      *BLANKS       FELT
     C     1             DO        15            NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL310
     C     TEGN          CABEQ     LOGAPP        CTL399
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     CTL310        TAG
     C                   ADD       1             FLN
     C                   MOVEL     FELT          F0078A
     C                   MOVEL     FELT          XCREF
     C                   MOVE      XCAVD         TIAVD
     C                   MOVE      XCOPD         TITDN
      *
      * Les meldings identifier
     C                   MOVE      *ZEROS        NR
     C                   MOVE      *BLANKS       FELT
     C     1             DO        50
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL330
     C     TEGN          CABEQ     LOGAPP        CTL330
     C                   ADD       1             NR
     C     TEGN          IFEQ      LOGKOL
     C                   MOVEL     ':'           FE(NR)
     C                   ELSE
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C                   END
     C     CTL330        TAG
     C                   MOVEL     FELT          F0078B
     C                   MOVEA     FE(19)        M1225
     C     TEGN          CABEQ     LOGAPP        CTL341
      *
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGAPP        CTL341
     C                   END
      *
      * Les syntaks feil
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL340
     C     TEGN          CABEQ     LOGAPP        CTL340
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL340        TAG
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     TKKODE        F0078C
     C  N33              MOVEL     TKTXTE        F0078C
     C     CTL341        TAG
     C                   EXSR      OPDTNF
     C     TEGN          CABEQ     LOGAPP        CTL399
      *
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGAPP        CTL399
     C                   END
      *
      * Les dataelement identifikasjon
     C                   MOVE      *BLANKS       FELT
     C     1             DO        3             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGKOL        CTL350
     C     TEGN          CABEQ     LOGAPP        CTL399
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL350        TAG
     C                   MOVEL     FELT          TKKODE
     C                   ADD       1             FLN
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     TKKODE        F0077
     C  N33              MOVE      TKTXTE        F0078A
      *
      * Les posisjon
     C                   MOVE      *BLANKS       FELT
     C     1             DO        6             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGKOL        CTL351
     C     TEGN          CABEQ     LOGPLU        CTL351
     C     TEGN          CABEQ     LOGAPP        CTL351
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL351        TAG
     C                   MOVEL     'Posisjon'    XAN16            16
     C                   MOVEL     FELT          XAN06             6
     C                   MOVE      XAN06         XAN16
     C                   MOVEL     XAN16         F0078B
     C     TEGN          CABEQ     LOGPLU        CTL359
     C     TEGN          CABEQ     LOGAPP        CTL359
      *
      * Les antall feiler
     C                   MOVE      *BLANKS       FELT
     C     1             DO        6
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL252
     C     TEGN          CABEQ     LOGAPP        CTL252
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL252        TAG
     C                   MOVEL     'Antall  '    XAN16            16
     C                   MOVEL     FELT          XAN06             6
     C                   MOVE      XAN06         XAN16
     C                   MOVEL     XAN16         F0078C
      *
     C     CTL359        TAG
     C                   EXSR      OPDTNF
     C     TEGN          CABEQ     LOGAPP        CTL399
      *
      * Les pakkes referansenr
     C                   MOVE      *BLANKS       FELT
     C     1             DO        36            NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL360
     C     TEGN          CABEQ     LOGAPP        CTL360
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL360        TAG
     C     FELT          IFNE      *BLANKS
     C                   ADD       1             FLN
     C                   MOVEL     FELT          F0078A
     C                   EXSR      OPDTNF
     C                   END
     C     TEGN          CABEQ     LOGAPP        CTL399
      *
      * Les referanse identifikasjon
     C     CTL370        TAG
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGKOL        CTL371
     C     TEGN          CABEQ     LOGPLU        CTL371
     C     TEGN          CABEQ     LOGAPP        CTL371
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL371        TAG
     C                   MOVEL     FELT          TKKODE
     C                   ADD       1             FLN
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     TKKODE        F0077
     C  N33              MOVE      TKTXTE        F0078A
     C     TEGN          CABEQ     LOGAPP        CTL379
      *
     C                   MOVE      *BLANKS       FELT
     C     1             DO        36            NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL399
     C     TEGN          CABEQ     LOGPLU        CTL379
     C     TEGN          CABEQ     LOGAPP        CTL379
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL379        TAG
     C                   MOVEL     FELT          F0078B
     C                   EXSR      OPDTNF
     C     TEGN          CABNE     LOGAPP        CTL370
      *
     C     CTL399        ENDSR
     C*__________________________________________________________
     C* SR for å behandle UCS                            SRCTL4 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCTL4        BEGSR
      *
      * Les segment posisjon
     C     1             DO        7             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL499
     C     TEGN          CABEQ     LOGPLU        CTL410
     C     TEGN          CABEQ     LOGAPP        CTL410
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     CTL410        TAG
     C                   ADD       1             FLN
     C                   MOVEL     'Posisjon'    XAN16            16
     C                   MOVEL     FELT          XAN06             6
     C                   MOVE      XAN06         XAN16
     C                   MOVEL     XAN16         F0078A
     C     TEGN          CABEQ     LOGAPP        CTL490
      *
      * Les syntaks feil
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL499
     C     TEGN          CABEQ     LOGAPP        CTL420
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL420        TAG
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     FELT          F0078B
     C  N33              MOVE      TKTXTE        F0078B
      *
     C     CTL490        TAG
     C                   EXSR      OPDTNF
      *
     C     CTL499        ENDSR
     C*__________________________________________________________
     C* SR for å behandle UCD                            SRCTL5 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCTL5        BEGSR
      *
      * Les syntaks feil
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL599
     C     TEGN          CABEQ     LOGPLU        CTL510
     C     TEGN          CABEQ     LOGAPP        CTL510
     C                   MOVEL     TEGN          FE(NR)
     C                   END
     C     CTL510        TAG
     C                   ADD       1             FLN
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     FELT          F0077
     C  N33              MOVEL     TKTXTE        F0078A
     C     TEGN          CABEQ     LOGAPP        CTL590
      *
      * Les data element posisjon
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL599
     C     TEGN          CABEQ     LOGKOL        CTL520
     C     TEGN          CABEQ     LOGAPP        CTL520
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL520        TAG
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     FELT          F0078B
     C  N33              MOVE      TKTXTE        F0078B
     C     TEGN          CABEQ     LOGAPP        CTL590
      *
      * Les data komponent posisjon
     C                   MOVE      *BLANKS       FELT
     C     1             DO        4             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL599
     C     TEGN          CABEQ     LOGAPP        CTL530
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL530        TAG
     C                   MOVEL     FELT          TKKODE
     C     SVXKODK       CHAIN     SVXKODL01                          33
     C                   MOVEL     FELT          F0078C
     C  N33              MOVE      TKTXTE        F0078C
     C     TEGN          CABEQ     LOGAPP        CTL590
      *
      * Les antall elementer
     C                   MOVE      *BLANKS       FELT
     C     1             DO        7             NR
     C                   EXSR      GETCH
     C   LR              GOTO      CTL599
     C     TEGN          CABEQ     LOGAPP        CTL540
     C                   MOVE      TEGN          FE(NR)
     C                   END
      *
     C     CTL540        TAG
     C                   MOVEL     FELT          F0078D
      *
     C     CTL590        TAG
     C                   EXSR      OPDTNF
      *
     C     CTL599        ENDSR
     C*__________________________________________________________
     C* Oppdater på filer                                OPDFIL /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     OPDFIL        BEGSR
      *
      * SEND KVITTERING TIL TULLVERKET
     C     KEYM4         SETGT     EDIM4
     C                   MOVE      *ZEROS        UTDN              7
     C     STLES         TAG
     C     KEYM4         READPE    EDIM4                                  33
     C  N33              SELECT
     C                   WHEN      ((M4_M1225 = '007') OR (M4_M1225 = '044'))
      * KVITTERING PÅ MOTTATT IE016 ELLER IE028 ELLER CONTRL
     C                   MOVE      MAVD          UAVD              4
     C                   MOVE      MTDN          UTDN              7
     C                   CALL      'SVX158R'
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    TISG
     C                   PARM                    M0010
     C                   PARM                    UA0007
     C                   PARM                    UA0008
     C                   PARM                    M0004
     C                   PARM                    UM0007
     C                   PARM                    UM0008
     C                   PARM                    S0020
     C                   PARM                    U0022
     C                   PARM                    S0035
     C                   PARM                    M1N07
     C                   WHEN      ((M4_M1225 = 'C02') AND
     C                               (M1N07 = 'C02'))
     C                   GOTO      STLES
     C                   WHEN      ((M4_M1225 = 'C01') AND
     C                               (M1N07 = 'C01'))
     C                   GOTO      STLES
     C                   ENDSL
      * IE08 (Avvining ankomstmelding)
     C     M1N07         IFEQ      '008'
     C     M1N07         OREQ      '058'
     C     M1N07         OREQ      'CTL'
     C     M1N07         OREQ      '917'
     C     TIAVD         ANDNE     0
     C                   MOVE      MMN           FMN
     C                   MOVE      'JA'          F4815
     C                   MOVE      M1N07         F0077
     C                   Z-ADD     1             XN
     C     XN            DOWLE     896
     C     FT(XN)        IFEQ      *BLANKS
     C                   LEAVE
     C                   ELSE
     C                   ADD       1             FLN
     C                   MOVE      FT(XN)        F0078A
     C                   ADD       1             XN
     C                   MOVE      FT(XN)        F0078B
     C                   ADD       1             XN
     C                   MOVE      FT(XN)        F0078C
     C                   ADD       1             XN
     C                   MOVE      FT(XN)        F0078D
     C                   ADD       1             XN
     C                   MOVE      FT(XN)        F0078E
     C                   ADD       1             XN
     C                   END
     C                   EXSR      OPDTNF
     C                   ENDDO
     C     SVNKEY        CHAIN     SVNH                               33
     C                   IF        *IN33
     C                   CALL      'SVX154C2'
     C                   PARM                    XTRNR
     C                   PARM                    SMBR
     C                   ELSE
     C                   MOVE      'Å'           TIST
     C                   MOVE      WS            TIWS
     C                   UPDATE    SVNHR
     C                   END
     C                   END
      * IE25 (Transittering avsluttet)
     C     M1N07         IFEQ      '025'
     C                   MOVE      MMN           FMN
     C                   MOVE      'JA'          F4815
     C                   MOVE      M1N07         F0077
     C                   Z-ADD     1             FLN
     C                   MOVEL     XTXT01        F0078A
     C                   MOVEL     XTXT02        F0078B
     C     F0078B        CAT       XTRDTÅ:1      F0078B
     C     F0078B        CAT       '.':0         F0078B
     C     F0078B        CAT       XTRDTM:0      F0078B
     C     F0078B        CAT       '.':0         F0078B
     C     F0078B        CAT       XTRDTD:0      F0078B
     C                   MOVEL     XTXT03        F0078C
     C                   CAT       XTSSD:1       F0078C
     C                   MOVEL     XTXT04        F0078D
     C                   CAT       XTRNR:1       F0078D
     C                   MOVEL     XTXT05        F0078E
     C                   CAT       TIGN:1        F0078E
     C                   EXSR      OPDTNF
     C     SVNKEY        CHAIN     SVNH                               33
     C                   MOVE      XTRDT         TIDTF
     C                   IF        NIDTL = 0
      * LASTELISTE BASERT T-DOKUMENT
     C                   MOVE      9             NIKONF
     C                   MOVE      1             NIFULF
     C                   MOVE      XTRDT         NIDTL
     C                   END
     C                   MOVE      'P'           TIST
     C                   MOVE      *BLANKS       TIWS
     C                   UPDATE    SVNHR
     C                   EXSR      TTSR
     C                   END
      * IE43 (Lossetillatelse)
     C     M1N07         IFEQ      '043'
     C     SVNKEY        CHAIN     SVNH                               33
     C                   MOVE      'L'           TIST
     C                   MOVE      XIDK          TIDK
     C                   MOVE      XIALK         TIALK
     C                   MOVE      XIBLK         TIBLK
     C                   MOVE      XICATS        TICATS
     C                   MOVE      XITSB         TITSB
     C                   MOVE      XITRDT        TITRDT
     C                   MOVE      XIKDC         TIKDC
     C                   MOVE      XICTL         TICTL
     C                   MOVE      XIVKB         TIVKB
     C                   MOVE      XITAID        TITAID
     C                   MOVE      XITALK        TITALK
     C                   MOVE      XITASK        TITASK
     C                   MOVE      XITINA        TITINA
     C                   MOVE      XINAA         TINAA
     C                   MOVE      XIADA1        TIADA1
     C                   MOVE      XIPSA         TIPSA
     C                   MOVE      XISKA         TISKA
     C                   MOVE      XIPNA         TIPNA
     C                   MOVE      XILKA         TILKA
     C                   MOVE      XITINS        TITINS
     C                   MOVE      XINAS         TINAS
     C                   MOVE      XIADS1        TIADS1
     C                   MOVE      XIPSS         TIPSS
     C                   MOVE      XISKS         TISKS
     C                   MOVE      XIPNS         TIPNS
     C                   MOVE      XILKS         TILKS
     C                   MOVE      XITINK        TITINK
     C                   MOVE      XINAK         TINAK
     C                   MOVE      XIADK1        TIADK1
     C                   MOVE      XIPSK         TIPSK
     C                   MOVE      XISKK         TISKK
     C                   MOVE      XIPNK         TIPNK
     C                   MOVE      XILKK         TILKK
     C                   MOVE      XILSTL        TILSTL
     C                   MOVE      XIVPOS        TIVPOS
     C     XINTK         IFEQ      0
     C                   Z-SUB     XVNT          TINTK
     C                   ELSE
     C                   MOVE      XINTK         TINTK
     C                   END
     C                   MOVE      XIDANT        TIDANT
     C     TIDANT        IFEQ      0
     C     SVNKEY        SETLL     SVNV
     C     SVNKEY        READE     SVNV                                   33
     C     *IN33         DOWEQ     '0'
     C     TVDANT        IFNE      0
     C                   Z-ADD     999           TIDANT
     C                   MOVE      TVDFKD        TIDFKD
     C                   MOVE      TVDFSK        TIDFSK
     C                   LEAVE
     C                   END
     C     SVNKEY        READE     SVNV                                   33
     C  N33              ENDDO
     C                   END
     C                   MOVE      TIDANT        NIDANT
     C                   MOVE      WS            TIWS
     C                   MOVE      S1(1)         TIDFKD
     C                   MOVE      S2(1)         TIDFSK
     C                   MOVE      S1(1)         NIDFKD
     C                   MOVE      S2(1)         NIDFSK
     C                   MOVE      'U'           TIST
     C                   MOVE      *BLANKS       TIWS
     C                   UPDATE    SVNHR
     C                   EXSR      TTSR
     C     2             DO        99            XN
     C     S1(XN)        IFNE      *BLANKS
     C                   MOVE      S1(XN)        TIDFKD
     C                   MOVE      S2(XN)        TIDFSK
     C                   MOVE      S1(XN)        NIDFKD
     C                   MOVE      S2(XN)        NIDFSK
     C                   WRITE     SVNHFSR
     C                   END
     C                   ENDDO
      * OPPDATER GODSJOURNAL
     C                   MOVEL     'SYGODS  '    PRODNA           15
     C     PRODNA        CHAIN     SYPROD                             33
     C  N33PRINST        IFEQ      'J'
     C                   MOVEL     TIGN          GOGN
      * hent evt bilnummer fra 1 post
     c                   move      *blanks       GOTRNR
     c                   move      *blanks       XXBILN           13
     C     GODS5K        SETLL     GODSJL05
     C     GODS5KB       READE     GODSJL05                               33
     C  N33              move      GOBILN        XXBILN
      *
     C                   MOVEL     TITRNR        GOTRNR
     C     GODS5K        CHAIN     GODSJL05                           33
     c   33              move      *blanks       gotrnr
     c   33gods5k        chain     godsjl05                           33
     C                   MOVEL     TITRNR        GOTRNR
     C     *IN33         IFEQ      '1'
     C                   CLEAR                   GODSJR
     C                   MOVEL     TITRDT        GOCCÅÅ
     C                   MOVEL     TINA          GOMOTT
     C                   MOVEL     TIGN          GOGN
     C                   MOVEL     TICATS        GOAVG
     C                   MOVEL     TIDK          XAN03             3
     C                   MOVE      XAN03         GOAVG
     C                   MOVEL     TITRNR        GOTRNR
     C                   MOVEL     TITRDT        GOTRDT
     C     xxbiln        ifne      *blanks
     C                   move      xxbiln        gobiln
     c                   else
     C                   MOVEL     TITAID        GOBILN
     C                   end
     C                   WRITE     GODSJR
     C                   MOVE      'N'           gohkod
     C                   EXSR      gohist
     C                   ELSE
     C                   MOVEL     TICATS        GOAVG
     C                   MOVEL     TIDK          XAN03
     C                   MOVE      XAN03         GOAVG
     C                   MOVEL     TITRDT        GOTRDT
     C     xxbiln        ifne      *blanks
     C                   move      xxbiln        gobiln
     c                   else
     C                   MOVEL     TITAID        GOBILN
     C                   END
     C                   UPDATE    GODSJR
     C                   MOVE      'E'           gohkod
     C                   EXSR      gohist
     C                   END
     C                   CALL      'SYTL10'
     C                   PARM                    GOGN
     C                   END
     C                   END
      *
     C     M1N07         IFNE      'CTL'
     C     M1N07         IFNE      '917'
     C                   MOVE      M1N07         M1225
     C                   END
     C                   ELSE
     C                   MOVE      99999999      X0068A
     C     KEYM2         SETLL     EDIM2
     C     KEYM21        READPE    EDIM2                                  33
     C                   MOVE      X0068         M0068
     C                   MOVE      X0068A        M0068A
     C                   MOVE      X0068B        M0068B
     C                   END
     C                   WRITE     EDIMR
      *
     C     SLOPDF        ENDSR
      ***********************************************
     C     TTSR          BEGSR
      ***********************************************
     C                   MOVE      TIAVD         TTAVD
     C                   MOVE      TITDN         TTOPD
     C                   MOVE      M1N07         TTACTI
     C                   MOVEL     'T'           TTACTI
     C                   CALL      'SYGE15C'
     C                   PARM                    WDATO             8
     C                   PARM                    WTID              6
     C                   MOVE      WDATO         TTDATE
     C                   MOVE      WTID          TTTIME
     C                   MOVEL     'SY400USR'    TTUSER
     C                   MOVE      *BLANKS       TTTEXT
n03  C                   MOVE      *BLANKS       TTTEXL
     C                   MOVEL     'TET-impo'    TTTEXT
     C                   CAT       'rt':0        TTTEXT
     C                   CAT       'MRN-nr':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TITRNR:2      TTTEXT
     C                   CAT       'Godsnr':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TIGN:2        TTTEXT
     C     M1N07         IFEQ      '043'
     C                   CAT       'Frigiv':2    TTTEXT
     C                   CAT       'elses':0     TTTEXT
     C                   CAT       'dato:':0     TTTEXT
     C                   CAT       WDATO:1       TTTEXT
     C                   ELSE
     C                   CAT       'Tr.avs':2    TTTEXT
     C                   CAT       'lutt':0      TTTEXT
     C                   CAT       'dato:':1     TTTEXT
     C                   CAT       XTRDTÅ:1      TTTEXT
     C                   CAT       XTRDTM:0      TTTEXT
     C                   CAT       XTRDTD:0      TTTEXT
     C                   END
n03  C                   move      tttext        tttexl
n03  C                   MOVE      *BLANKS       TTTEXT
     C                   MOVEL     'TET-impo'    TTTEXT
     C                   CAT       'rt':0        TTTEXT
     C                   CAT       'MRN-no':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TITRNR:2      TTTEXT
     C                   CAT       'Waybil':2    TTTEXT
     C                   CAT       ':':0         TTTEXT
     C                   CAT       TIGN:2        TTTEXT
     C     M1N07         IFEQ      '043'
     C                   CAT       'Releas':2    TTTEXT
     C                   CAT       'edate':0     TTTEXT
     C                   CAT       WDATO:1       TTTEXT
     C                   ELSE
     C                   CAT       'Tr.end':2    TTTEXT
     C                   CAT       'ed':0        TTTEXT
     C                   CAT       'date:':1     TTTEXT
     C                   CAT       XTRDTÅ:1      TTTEXT
     C                   CAT       XTRDTM:0      TTTEXT
     C                   CAT       XTRDTD:0      TTTEXT
     C                   END
     C                   WRITE     TRACKFR
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDTNF        BEGSR
     C***********************************************
     C                   WRITE     TVINFF
     C                   MOVE      *BLANKS       F0077
     C                   MOVE      *BLANKS       F0078A
     C                   MOVE      *BLANKS       F0078B
     C                   MOVE      *BLANKS       F0078C
     C                   MOVE      *BLANKS       F0078D
     C                   MOVE      *BLANKS       F0078E
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å behandle lossetillatelse                  LOSSE
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     LOSSE         BEGSR
      * TØMME GAMLE LINJE
     C     SVNKEY        SETLL     SVNL
     C     SVNKEY        READE     SVNL                                   33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLR
     C     SVNKEY        READE     SVNL                                   33
     C  N33              ENDDO
     C     SVNKEY        SETLL     SVNLCN
     C     SVNKEY        READE     SVNLCN                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLCNR
     C     SVNKEY        READE     SVNLCN                                 33
     C  N33              ENDDO
     C     SVNKEY        SETLL     SVNLDK
     C     SVNKEY        READE     SVNLDK                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLDKR
     C     SVNKEY        READE     SVNLDK                                 33
     C  N33              ENDDO
     C     SVNKEY        SETLL     SVNLMN
     C     SVNKEY        READE     SVNLMN                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLMNR
     C     SVNKEY        READE     SVNLMN                                 33
     C  N33              ENDDO
     C     SVNKEY        SETLL     SVNLCN
     C     SVNKEY        READE     SVNLCN                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLCNR
     C     SVNKEY        READE     SVNLCN                                 33
     C  N33              ENDDO
     C     SVNKEY        SETLL     SVNLKL
     C     SVNKEY        READE     SVNLKL                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNLKLR
     C     SVNKEY        READE     SVNLKL                                 33
     C  N33              ENDDO
N01  C     SVNKEY        SETLL     SVNLVT
N01  C     SVNKEY        READE     SVNLVT                                 33
N01  C     *IN33         DOWEQ     '0'
N01  C                   DELETE    SVNLVTR
N01  C     SVNKEY        READE     SVNLVT                                 33
N01  C  N33              ENDDO
     C     SVNKEY        SETLL     SVNHFS
     C     SVNKEY        READE     SVNHFS                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SVNHFSR
     C     SVNKEY        READE     SVNHFS                                 33
     C  N33              ENDDO
      *
     C                   MOVE      *BLANKS       S1
     C                   MOVE      *BLANKS       S2
     C                   MOVE      *ZEROS        S3                3 0
      *
     C     STLOS         TAG
     C                   MOVE      *BLANKS       SEGNAM
      * Hent segment for meldingstype
     C                   EXSR      GETSEG
     C   LR              GOTO      SLLOS
      *
     C     STLOS1        TAG
     C                   SELECT
     C     SEGNAM        WHENEQ    'LOC'
     C                   EXSR      SRLOC
     C     SEGNAM        WHENEQ    'DTM'
     C                   EXSR      SRDTM
     C     SEGNAM        WHENEQ    'GIS'
     C                   EXSR      SRGIS
     C     SEGNAM        WHENEQ    'MEA'
     C                   EXSR      SRMEA
     C     SEGNAM        WHENEQ    'SEL'
     C                   EXSR      SRSEL
     C     SEGNAM        WHENEQ    'TDT'
     C                   EXSR      SRTDT
     C                   GOTO      STLOS1
     C     SEGNAM        WHENEQ    'NAD'
     C                   EXSR      SRNAD
     C     SEGNAM        WHENEQ    'CST'
     C                   EXSR      SRCST
     C                   GOTO      STLOS1
     C     SEGNAM        WHENEQ    'CNT'
     C                   EXSR      SRCNT
     C     SEGNAM        WHENEQ    'UNT'
     C                   GOTO      SLLOS
     C                   ENDSL
      *
     C                   GOTO      STLOS
      *
     C     SLLOS         ENDSR
     C*__________________________________________________________
     C* SR for å behandle LOC-segment                     SRLOC /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRLOC         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC199
     C     TEGN          CABEQ     LOGPLU        LOC110
     C     TEGN          CABEQ     LOGAPP        LOC199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     LOC110        TAG
     C                   MOVEL     FELT          XKODE             3
      * Les forbi '+'
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC199
     C                   ENDDO                                                  1<-E
      *
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC199
     C     TEGN          CABEQ     LOGAPP        LOC120
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     LOC120        TAG
      *
     C     FELT          IFNE      *BLANKS
     C                   SELECT
     C     XKODE         WHENEQ    '35'
     C                   MOVEL     FELT          XIALK
     C     XKODE         WHENEQ    '36'
     C                   MOVEL     FELT          XIBLK
     C     XKODE         WHENEQ    '118'
     C                   MOVEL     FELT          XICATS
     C     XKODE         WHENEQ    '22'
     C                   MOVEL     FELT          XITSB
     C                   ENDSL
     C                   END
      *
     C     LOC199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle DTM-segment                     SRDTM /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRDTM         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DTM199
     C     TEGN          CABEQ     LOGPLU        DTM110
     C     TEGN          CABEQ     LOGAPP        DTM199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     DTM110        TAG
     C                   MOVEL     FELT          XKODE             3
      * Les deklarasjons godkjenningsdato
     C                   MOVE      *BLANKS       FE
     C     1             DO        8             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DTM199
     C     TEGN          CABEQ     LOGAPP        DTM199
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     XKODE         IFEQ      '148'
     C                   MOVEL     FELT          XITRDT
     C                   END
      *
     C     DTM199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle GIS-segment                     SRGIS /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGIS         BEGSR
      *
      * Hent kode om container sending/om fortsett lossing
     C                   MOVE      *BLANKS       FE
     C     1             DO        2             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      GIS199
     C     TEGN          CABEQ     LOGKOL        GIS110
     C     TEGN          CABEQ     LOGPLU        GIS199
     C     TEGN          CABEQ     LOGAPP        GIS199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     GIS110        TAG
     C                   MOVEL     FELT          XAN01             1
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      GIS199
     C     TEGN          CABEQ     LOGAPP        GIS199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C                   MOVEL     FELT          XKODE             3
      *
     C                   SELECT
     C     XKODE         WHENEQ    '109'
     C                   MOVEL     XAN01         XIKDC
     C     XKODE         WHENEQ    '62'
     C                   MOVEL     XAN01         XICTL
     C                   ENDSL
      *
     C     GIS199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle MEA-segment                     SRMEA /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRMEA         BEGSR
      *
      * Les forbi '++'
     C     1             DO        2                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA199
     C     TEGN          CABEQ     LOGAPP        MEA199
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Les forbi ':'
     C     TEGN          DOWNE     LOGKOL                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA199
     C     TEGN          CABEQ     LOGAPP        MEA199
     C                   ENDDO                                                  1<-E
      * Hent bruttovekt
     C                   MOVE      *ZEROS        XN113            11 3
     C                   MOVE      *ZEROS        XKOMMA            5 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA199
     C     TEGN          CABEQ     LOGAPP        MEA120
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN113
     C                   MOVE      TEGN          XN113
     C                   DIV       10            XKOMMA
     C                   ELSE
     C     TEGN          IFEQ      '.'
     C                   Z-ADD     1000          XKOMMA
     C                   END
     C                   END
     C                   ENDDO                                                  1<-E
      *
     C     MEA120        TAG
     C     XKOMMA        IFEQ      0
     C                   MULT      1000          XN113
     C                   ELSE
     C                   MULT      XKOMMA        XN113
     C                   END
     C                   Z-ADD(H)  XN113         XIVKB
      *
     C     MEA199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle SEL-segment                     SRSEL /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRSEL         BEGSR
     C                   ADD       1             S3
      * HENT STATUS
     C                   EXSR      GETCH
     C                   MOVEL     TEGN          XIDFST            1
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      SEL199
     C     TEGN          CABEQ     LOGAPP        SEL199
     C                   ENDDO                                                  1<-E
      * Les forbi ':::'
     C     1             DO        3                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      SEL199
     C     TEGN          CABEQ     LOGAPP        SEL199
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Forseglings-id
     C                   MOVE      *BLANKS       FE
     C     1             DO        21            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      SEL199
     C     TEGN          CABEQ     LOGPLU        SEL110
     C     TEGN          CABEQ     LOGAPP        SEL110
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     SEL110        TAG
     C                   MOVEL     FELT          S1(S3)
      *
     C     TEGN          CABEQ     LOGAPP        SEL199
      * Språkkode til forsegling
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      SEL199
     C     TEGN          CABEQ     LOGPLU        SEL120
     C     TEGN          CABEQ     LOGAPP        SEL120
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     SEL120        TAG
     C                   MOVEL     FELT          S2(S3)
      *
     C     SEL199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle TDT-segment                     SRTDT /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRTDT         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TDT199
     C     TEGN          CABEQ     LOGPLU        TDT110
     C     TEGN          CABEQ     LOGAPP        TDT199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     TDT110        TAG
     C                   MOVEL     FELT          XKODE             3
      * Les forbi '++++++'
     C     1             DO        6                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TDT199
     C     TEGN          CABEQ     LOGAPP        TDT199
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Les forbi ':::'
     C     1             DO        3                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TDT199
     C     TEGN          CABEQ     LOGAPP        TDT199
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Transportmiddels-id ved avgang
     C                   MOVE      *BLANKS       FE
     C     1             DO        30            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TDT199
     C     TEGN          CABEQ     LOGKOL        TDT120
     C     TEGN          CABEQ     LOGPLU        TDT120
     C     TEGN          CABEQ     LOGAPP        TDT120
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     TDT120        TAG
     C                   MOVEL     FELT          XITAID
      *
     C     TEGN          CABEQ     LOGPLU        TDT199
     C     TEGN          CABEQ     LOGAPP        TDT199
      * Transportmiddels nasjonalitet ved avgang
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TDT199
     C     TEGN          CABEQ     LOGPLU        TDT130
     C     TEGN          CABEQ     LOGAPP        TDT130
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     TDT130        TAG
     C                   MOVEL     FELT          XITALK
      *
     C     TDT199        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
     C  NLRSEGNAM        IFEQ      'TPL'
     C                   EXSR      SRTPL1
     C                   END
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å behandle TPL-segment                    SRTPL1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRTPL1        BEGSR
      * Les forbi '::::'
     C     1             DO        4                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TPL299
     C     TEGN          CABEQ     LOGAPP        TPL299
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Transportmiddels-id ved avgang språkkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TPL299
     C     TEGN          CABEQ     LOGAPP        TPL220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     TPL220        TAG
     C                   MOVEL     FELT          XITASK
      *
     C     TPL299        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å behandle NAD-segment                     SRNAD /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRNAD         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD110
     C     TEGN          CABEQ     LOGAPP        NAD199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     NAD110        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABEQ     'CPD'         NAD199
      * TIN-kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        18            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD120
     C     TEGN          CABEQ     LOGAPP        NAD120
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD120        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XITINA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XITINS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XITINK
     C                   ENDSL
      *
     C     TEGN          CABEQ     LOGAPP        NAD199
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGAPP        NAD199
     C                   ENDDO                                                  1<-E
      * Navn
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD130
     C     TEGN          CABEQ     LOGAPP        NAD130
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD130        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XINAA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XINAS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XINAK
     C                   ENDSL
      * Adresse
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD140
     C     TEGN          CABEQ     LOGAPP        NAD140
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD140        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XIADA1
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XIADS1
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XIADK1
     C                   ENDSL
      * Poststed
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD150
     C     TEGN          CABEQ     LOGAPP        NAD150
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD150        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XIPSA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XIPSS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XIPSK
     C                   ENDSL
      * Språkkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD160
     C     TEGN          CABEQ     LOGAPP        NAD160
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD160        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XISKA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XISKS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XISKK
     C                   ENDSL
      * Postnr
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD170
     C     TEGN          CABEQ     LOGAPP        NAD170
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD170        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XIPNA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XIPNS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XIPNK
     C                   ENDSL
      * Landkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD199
     C     TEGN          CABEQ     LOGPLU        NAD180
     C     TEGN          CABEQ     LOGAPP        NAD180
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD180        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'AF'
     C                   MOVEL     FELT          XILKA
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          XILKS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          XILKK
     C                   ENDSL
      *
     C     NAD199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle CNT-segment                     SRCNT /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCNT         BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      CNT199
     C     TEGN          CABEQ     LOGKOL        CNT110
     C     TEGN          CABEQ     LOGPLU        CNT199
     C     TEGN          CABEQ     LOGAPP        CNT199
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     CNT110        TAG
     C                   MOVEL     FELT          XKODE             3
      *
     C                   MOVE      *ZEROS        XN090             9 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      CNT199
     C     TEGN          CABEQ     LOGAPP        CNT120
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN090
     C                   MOVE      TEGN          XN090
     C                   END
     C                   ENDDO                                                  1<-E
      *
     C     CNT120        TAG
     C                   SELECT
     C     XKODE         WHENEQ    '13'
     C                   Z-ADD     XN090         XILSTL
     C     XKODE         WHENEQ    '5'
     C                   Z-ADD     XN090         XIVPOS
     C     XKODE         WHENEQ    '11'
     C                   Z-ADD     XN090         XINTK
     C     XKODE         WHENEQ    '16'
     C     XIDFST        ANDNE     ' '
     C                   Z-ADD     XN090         XIDANT
     C                   ENDSL
      *
     C     CNT199        ENDSR
     C*__________________________________________________________
     C* SR for å behandle CST-segment                     SRCST /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRCST         BEGSR
      *
     C     CST110        TAG
     C                   CLEAR                   SVNLR
     C                   MOVE      TIAVD         TVAVD
     C                   MOVE      TITDN         TVTDN
     C                   MOVE      *BLANKS       C1
     C                   MOVE      *ZEROS        C2                3 0
     C                   MOVE      *BLANKS       D1
     C                   MOVE      *BLANKS       D2
N05  C                   MOVE      *ZEROS        D2L
     C                   MOVE      *BLANKS       D3
     C                   MOVE      *BLANKS       D4
N05  C                   MOVE      *ZEROS        D4L
     C                   MOVE      *BLANKS       D5
     C                   MOVE      *ZEROS        D6                3 0
     C                   MOVE      *BLANKS       M1
N05  C                   MOVE      *ZEROS        M1L
     C                   MOVE      *BLANKS       M2
     C                   MOVE      *ZEROS        M3                3 0
     C                   MOVE      *BLANKS       K1
     C                   MOVE      *ZEROS        K2
     C                   MOVE      *ZEROS        K3
     C                   MOVE      *ZEROS        K4                3 0
N01  C                   MOVE      *BLANKS       V1
N05  C                   MOVE      *ZEROS        V1L
N01  C                   MOVE      *ZEROS        V2                3 0
      * Hent linjenr
     C     1             DO        6             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      CST199
     C     TEGN          CABEQ     LOGPLU        CST120
     C     TEGN          CABEQ     LOGAPP        CST197
     C                   MULT      10            TVLI
     C                   MOVE      TEGN          TVLI
     C                   END                                                    1<-E
      * Les tariffnr
     C     CST120        TAG
S06  C*                  Z-ADD     0             XANTSIF           1 0
N06  C                   Z-ADD     0             TVVNTL
     C     1             DO        7             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      CST199
     C     TEGN          CABEQ     LOGPLU        CST130
     C     TEGN          CABEQ     LOGAPP        CST130
     C                   MULT      10            TVVNT
     C                   MOVE      TEGN          TVVNT
S06  C*                  ADD       1             XANTSIF
N06  C                   ADD       1             TVVNTL
     C                   ENDDO                                                  1<-E
      *
     C     CST130        TAG
N02  C                   SELECT
S06  C*                  WHEN      XANTSIF = 1
N06  C                   WHEN      TVVNTL = 1
N02  C                   MULT      100000        TVVNT
S06  C*                  WHEN      XANTSIF = 2
N06  C                   WHEN      TVVNTL = 2
N02  C                   MULT      10000         TVVNT
S06  C*                  WHEN      XANTSIF = 3
N06  C                   WHEN      TVVNTL = 3
N02  C                   MULT      1000          TVVNT
S06  C*                  WHEN      XANTSIF = 4
N06  C                   WHEN      TVVNTL = 4
     C                   MULT      100           TVVNT
S06  C*                  WHEN      XANTSIF = 5
N06  C                   WHEN      TVVNTL = 5
N02  C                   MULT      10            TVVNT
N02  C                   ENDSL
     C     TEGN          CABEQ     LOGAPP        CST197
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      CST199
     C                   ENDDO
      * Status
     C                   MOVE      *BLANKS       FE
     C     1             DO        6             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      CST140
     C     TEGN          CABEQ     LOGPLU        CST140
     C     TEGN          CABEQ     LOGAPP        CST140
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     CST140        TAG
     C                   MOVEL     FELT          TVDK
      *
     C     CST197        TAG
     C                   MOVE      *BLANKS       SEGNAM
      * Hent segment for meldingstype
     C                   EXSR      GETSEG
     C   LR              GOTO      CST199
      *
     C     CST198        TAG
     C                   SELECT
     C     SEGNAM        WHENEQ    'FTX'
     C                   EXSR      SRFTX1
     C     SEGNAM        WHENEQ    'LOC'
     C                   EXSR      SRLOC1
     C     SEGNAM        WHENEQ    'MEA'
     C                   EXSR      SRMEA1
     C     SEGNAM        WHENEQ    'NAD'
     C                   EXSR      SRNAD1
     C     SEGNAM        WHENEQ    'PAC'
     C                   EXSR      SRPAC1
     C                   GOTO      CST198
     C     SEGNAM        WHENEQ    'RFF'
     C                   EXSR      SRRFF1
     C     SEGNAM        WHENEQ    'DOC'
     C                   EXSR      SRDOC1
     C     SEGNAM        WHENEQ    'TOD'
     C                   EXSR      SRTOD1
     C                   GOTO      CST198
     C     SEGNAM        WHENEQ    'GIR'
     C                   EXSR      SRGIR1
     C     SEGNAM        WHENEQ    'CST'
     C     SEGNAM        OREQ      'UNS'
     C                   MOVE      C1(1)         TVCNR
     C                   MOVE      D1(1)         TVDTY
     C                   MOVEL     D2(1)         TVDREF
N05  C                   MOVE      D2L(1)        TVDREFL
     C                   MOVE      D3(1)         TVDSK
     C                   MOVE      D4(1)         TVDO
N05  C                   MOVE      D4L(1)        TVDOL
     C                   MOVE      D5(1)         TVDOSK
     C                   MOVE      M1(1)         TVMN
N05  C                   MOVE      M1L(1)        TVMNL
     C                   MOVE      M2(1)         TVMNSK
     C                   MOVE      K1(1)         TVEH
     C                   MOVE      K2(1)         TVNT
     C                   MOVE      K3(1)         TVNTEH
N01  C                   MOVE      V1(1)         TVVT
N05  C                   MOVE      V1L(1)        TVVTL
     C                   MOVE      C1(1)         NVCNR
     C                   MOVE      D1(1)         NVDTY
     C                   MOVEL     D2(1)         NVDREF
     C                   MOVE      D3(1)         NVDSK
     C                   MOVE      D4(1)         NVDO
     C                   MOVE      D5(1)         NVDOSK
     C                   MOVE      M1(1)         NVMN
     C                   MOVE      M2(1)         NVMNSK
     C                   MOVE      K1(1)         NVEH
     C                   MOVE      K2(1)         NVNT
     C                   MOVE      K3(1)         NVNTEH
N01  C                   MOVE      V1(1)         NVVT
     C                   MOVE      TVVNT         NVVNT
S01  C*                  MOVEL     TVVT          NVVT
     C                   MOVE      TVVTSK        NVVTSK
     C                   MOVE      TVVKTB        NVVKTB
     C                   MOVE      TVVKTN        NVVKTN
     C                   MOVE      TVFV          NVFV
     C                   MOVE      TVFVNT        NVFVNT
     C                   ADD       TVNT          XVNT
     C                   ADD       TVNTEH        XVNT
     C                   WRITE     SVNLR
     C     2             DO        99            XN
     C     C1(XN)        IFNE      *BLANKS
     C                   MOVE      C1(XN)        TVCNR
     C                   MOVE      C1(XN)        NVCNR
     C                   WRITE     SVNLCNR
     C                   END
     C     D1(XN)        IFNE      *BLANKS
     C                   MOVE      D1(XN)        TVDTY
     C                   MOVEL     D2(XN)        TVDREF
N05  C                   MOVE      D2L(XN)       TVDREFL
     C                   MOVE      D3(XN)        TVDSK
     C                   MOVE      D4(XN)        TVDO
N05  C                   MOVE      D4L(XN)       TVDOL
     C                   MOVE      D5(XN)        TVDOSK
     C                   MOVE      D1(XN)        NVDTY
     C                   MOVEL     D2(XN)        NVDREF
     C                   MOVE      D3(XN)        NVDSK
     C                   MOVE      D4(XN)        NVDO
     C                   MOVE      D5(XN)        NVDOSK
     C                   WRITE     SVNLDKR
     C                   END
     C     M1(XN)        IFNE      *BLANKS
     C                   MOVE      M1(XN)        TVMN
N05  C                   MOVE      M1L(XN)       TVMNL
     C                   MOVE      M2(XN)        TVMNSK
     C                   MOVE      M1(XN)        NVMN
     C                   MOVE      M2(XN)        NVMNSK
     C                   MOVE      M4(XN)        TVLI2
     C                   WRITE     SVNLMNR
     C                   END
     C     K1(XN)        IFNE      *BLANKS
     C                   EVAL      TVLI2 = XN - 1
     C                   MOVE      K1(XN)        TVEH
     C                   MOVE      K2(XN)        TVNT
     C                   MOVE      K3(XN)        TVNTEH
     C                   MOVE      K1(XN)        NVEH
     C                   MOVE      K2(XN)        NVNT
     C                   MOVE      K3(XN)        NVNTEH
     C                   ADD       TVNT          XVNT
     C                   ADD       TVNTEH        XVNT
     C                   WRITE     SVNLKLR
     C                   END
N01  C     V1(XN)        IFNE      *BLANKS
N01  C                   MOVE      V1(XN)        TVVT
N05  C                   MOVE      V1L(XN)       TVVTL
N01  C                   MOVE      V1(XN)        NVVT
N01  C                   WRITE     SVNLVTR
N01  C                   END
     C                   ENDDO
     C     SEGNAM        CABEQ     'UNS'         CST199
     C                   GOTO      CST110
     C                   ENDSL
      *
     C                   GOTO      CST197
      *
     C     CST199        ENDSR
     C*__________________________________________________________
     C* SR for å konvertere FTX-segment                  SRFTX1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRFTX1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C     TEGN          CABEQ     LOGPLU        FTX210
     C     TEGN          CABEQ     LOGAPP        FTX299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     FTX210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     'AAA'         FTX299
      * Les forbi '++'
     C     1             DO        2                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Les varebeskrivelse
     C                   MOVE      *BLANKS       FE
N05  C                   MOVE      *ZEROS        XLENGDE           3 0
     C     1             DO        71            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C     TEGN          CABEQ     LOGKOL        FTX220
     C     TEGN          CABEQ     LOGPLU        FTX220
     C     TEGN          CABEQ     LOGAPP        FTX220
     C                   MOVEL     TEGN          FE(NR)
N05  C                   ADD       1             XLENGDE
     C                   ENDDO                                                  1<-E
     C     FTX220        TAG
S01  C*                  MOVE      *BLANKS       TVVT
S01  C*                  MOVEL     FELT          TVVT
N01  C                   ADD       1             V2
N01  C                   MOVEL     FELT          V1(V2)
N05  C                   MOVEL     XLENGDE       V1L(V2)
      *
S01  C*                  IF        TEGN = LOGKOL
N01  C                   DOW       TEGN = LOGKOL
     C                   MOVE      *BLANKS       FE
N05  C                   MOVE      *ZEROS        XLENGDE           3 0
     C     1             DO        71            NR
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C     TEGN          CABEQ     LOGKOL        FTX221
     C     TEGN          CABEQ     LOGPLU        FTX221
     C     TEGN          CABEQ     LOGAPP        FTX221
     C                   MOVEL     TEGN          FE(NR)
N05  C                   ADD       1             XLENGDE
     C                   ENDDO
     C     FTX221        TAG
S01  C*                  MOVEL     FELT          XAN70            70
S01  C*                  MOVE      XAN70         TVVT
N01  C                   ADD       1             V2
N01  C                   MOVEL     FELT          V1(V2)
N05  C                   MOVEL     XLENGDE       V1L(V2)
     C                   END
     C     TEGN          CABEQ     LOGAPP        FTX299
      *
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C     TEGN          CABEQ     LOGAPP        FTX299
     C                   ENDDO
      * Les språkkkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX299
     C     TEGN          CABEQ     LOGAPP        FTX230
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     FTX230        TAG
     C                   MOVEL     FELT          TVVTSK
      *
     C     FTX299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle LOC-segment                    SRLOC1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRLOC1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC299
     C     TEGN          CABEQ     LOGPLU        LOC210
     C     TEGN          CABEQ     LOGAPP        LOC299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     LOC210        TAG
     C                   MOVEL     FELT          XKODE             3
      * Les forbi '+'
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC299
     C                   ENDDO                                                  1<-E
      *
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      LOC299
     C     TEGN          CABEQ     LOGAPP        LOC220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
      *
     C     LOC220        TAG
     C     FELT          IFNE      *BLANKS
     C                   SELECT
     C     XKODE         WHENEQ    '35'
     C                   MOVEL     FELT          TVALK
     C     XKODE         WHENEQ    '36'
     C                   MOVEL     FELT          TVBLK
     C                   ENDSL
     C                   END
      *
     C     LOC299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle MEA-segment                    SRMEA1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRMEA1        BEGSR
      *
      * Les forbi '+'
     C     TEGN          DOUEQ     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA299
     C     TEGN          CABEQ     LOGAPP        MEA299
     C                   ENDDO                                                  1<-E
      * Les kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA299
     C     TEGN          CABEQ     LOGPLU        MEA210
     C     TEGN          CABEQ     LOGAPP        MEA299
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     MEA210        TAG
     C                   MOVEL     FELT          XKODE             3
      * Les forbi ':'
     C     TEGN          DOWNE     LOGKOL                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA299
     C     TEGN          CABEQ     LOGAPP        MEA299
     C                   ENDDO                                                  1<-E
      * Hent vekt
     C                   MOVE      *ZEROS        XN113            11 3
     C                   MOVE      *ZEROS        XKOMMA            5 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      MEA299
     C     TEGN          CABEQ     LOGAPP        MEA220
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN113
     C                   MOVE      TEGN          XN113
     C                   DIV       10            XKOMMA
     C                   ELSE
     C     TEGN          IFEQ      '.'
     C                   Z-ADD     1000          XKOMMA
     C                   END
     C                   END
     C                   ENDDO                                                  1<-E
      *
     C     MEA220        TAG
     C     XKOMMA        IFEQ      0
     C                   MULT      1000          XN113
     C                   ELSE
     C                   MULT      XKOMMA        XN113
     C                   END
     C                   SELECT
     C     XKODE         WHENEQ    'AAA'
     C                   Z-ADD(H)  XN113         TVVKTN
     C     XKODE         WHENEQ    'AAB'
     C                   Z-ADD(H)  XN113         TVVKTB
     C                   ENDSL
      *
     C     MEA299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle NAD-segment                    SRNAD1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRNAD1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD210
     C     TEGN          CABEQ     LOGAPP        NAD299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     NAD210        TAG
     C                   MOVEL     FELT          XKODE             3
      * TIN-kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        18            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD220
     C     TEGN          CABEQ     LOGAPP        NAD220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD220        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVTINS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVTINK
     C                   ENDSL
      *
     C     TEGN          CABEQ     LOGAPP        NAD299
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGAPP        NAD299
     C                   ENDDO                                                  1<-E
      * Navn
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD230
     C     TEGN          CABEQ     LOGAPP        NAD230
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD230        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVNAS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVNAK
     C                   ENDSL
      * Adresse
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD240
     C     TEGN          CABEQ     LOGAPP        NAD240
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD240        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVADS1
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVADK1
     C                   ENDSL
      * Poststed
     C                   MOVE      *BLANKS       FE
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD250
     C     TEGN          CABEQ     LOGAPP        NAD250
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD250        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVPSS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVPSK
     C                   ENDSL
      * Språkkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD260
     C     TEGN          CABEQ     LOGAPP        NAD260
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD260        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVSKS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVSKK
     C                   ENDSL
      * Postnr
     C                   MOVE      *BLANKS       FE
     C     1             DO        10            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD270
     C     TEGN          CABEQ     LOGAPP        NAD270
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD270        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVPNS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVPNK
     C                   ENDSL
      * Landkode
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      NAD299
     C     TEGN          CABEQ     LOGPLU        NAD280
     C     TEGN          CABEQ     LOGAPP        NAD280
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     NAD280        TAG
     C                   SELECT
     C     XKODE         WHENEQ    'CZ'
     C                   MOVEL     FELT          TVLKS
     C     XKODE         WHENEQ    'CN'
     C                   MOVEL     FELT          TVLKK
     C                   ENDSL
      *
     C     NAD299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle PAC-segment                    SRPAC1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRPAC1        BEGSR
      *
      * Les kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PAC299
     C     TEGN          CABEQ     LOGPLU        PAC210
     C     TEGN          CABEQ     LOGAPP        PAC299
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     PAC210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         IFNE      '6'
     C     XKODE         ANDNE     '006'
     C                   GOTO      PAC299
     C                   END
      * Les forbi '++'
     C     1             DO        2                                            1<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PAC299
     C     TEGN          CABEQ     LOGAPP        PAC299
     C                   ENDDO                                                   2<-E
     C                   ENDDO                                                  1<-E
      * Les enhet
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PAC299
     C     TEGN          CABEQ     LOGKOL        PAC220
     C     TEGN          CABEQ     LOGAPP        PAC220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     PAC220        TAG
     C                   ADD       1             K4
     C                   MOVEL     FELT          K1(K4)
     C     TEGN          CABEQ     LOGAPP        PAC299
      * Hent antall kolli
     C                   MOVE      *ZEROS        XN090             9 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PAC299
     C     TEGN          CABEQ     LOGKOL        PAC230
     C     TEGN          CABEQ     LOGAPP        PAC230
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN090
     C                   MOVE      TEGN          XN090
     C                   END
     C                   ENDDO                                                  1<-E
     C     PAC230        TAG
     C                   Z-ADD     XN090         K2(K4)
     C     TEGN          CABEQ     LOGAPP        PAC299
      * LES FORBI ':'
     C                   IF        TEGN = LOGKOL
     C                   EVAL      TEGN = *BLANKS
     C                   DOW       TEGN <> LOGKOL
     C                   EXSR      GETCH
     C                   ENDDO
     C                   END
      * Hent antall stykk
     C                   MOVE      *ZEROS        XN090             9 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PAC299
     C     TEGN          CABEQ     LOGAPP        PAC240
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN090
     C                   MOVE      TEGN          XN090
     C                   END
     C                   ENDDO                                                  1<-E
     C     PAC240        TAG
     C                   Z-ADD     XN090         K3(K4)
      *
     C     PAC299        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
     C  NLRSEGNAM        IFEQ      'PCI'
     C                   EXSR      SRPCI2
     C                   END
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å konvertere PCI-segment                  SRPCI2 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRPCI2        BEGSR
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PCI399
     C     TEGN          CABEQ     LOGPLU        PCI310
     C     TEGN          CABEQ     LOGAPP        PCI399
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     PCI310        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     '28'          PCI399
      * Les rubr.31 merke & nummer
     C                   MOVE      'N'           XFORTSETT         1
     C     PCI311        TAG
     C                   MOVE      *BLANKS       FE
N05  C                   MOVE      *ZEROS        XLENGDE           3 0
     C     1             DO        43            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PCI399
     C     TEGN          CABEQ     LOGKOL        PCI320
     C     TEGN          CABEQ     LOGPLU        PCI320
     C     TEGN          CABEQ     LOGAPP        PCI320
     C                   MOVEL     TEGN          FE(NR)
N05  C                   ADD       1             XLENGDE
     C                   ENDDO                                                  1<-E
     C     PCI320        TAG
     C                   IF        XFORTSETT = 'N'
     C                   ADD       1             M3
     C                   MOVEL     FELT          M1(M3)
N05  C                   MOVEL     XLENGDE       M1L(M3)
     C                   ELSE
     C                   MOVEL     FELT          XAN07             7
     C                   MOVE      XAN07         M1(M3)
N05  C                   EVAL      M1L(M3) = 7
     C                   END
     C                   IF        TEGN = LOGKOL
     C                   MOVE      'J'           XFORTSETT
     C                   GOTO      PCI311
     C                   END
     C                   EVAL      M4(M3) = K4 - 1
     C     TEGN          CABEQ     LOGKOL        PCI311
     C     TEGN          CABEQ     LOGAPP        PCI399
      * Les forbi '+'
     C     TEGN          DOWNE     LOGPLU
     C                   EXSR      GETCH
     C   LR              GOTO      PCI399
     C                   ENDDO
      * Les rubr.31 språkkode til merke & nummer
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      PCI399
     C     TEGN          CABEQ     LOGPLU        PCI330
     C     TEGN          CABEQ     LOGAPP        PCI330
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     PCI330        TAG
     C                   MOVEL     FELT          M2(M3)
      *
     C     PCI399        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å konvertere RFF-segment                  SRRFF1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRRFF1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      RFF299
     C     TEGN          CABEQ     LOGKOL        RFF210
     C     TEGN          CABEQ     LOGAPP        RFF299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     RFF210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     'AAQ'         RFF299
     C                   ADD       1             C2
      * Les containernr
     C                   MOVE      *BLANKS       FE
     C     1             DO        18            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      RFF299
     C     TEGN          CABEQ     LOGKOL        RFF220
     C     TEGN          CABEQ     LOGAPP        RFF220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     RFF220        TAG
     C                   MOVEL     FELT          C1(C2)
      *
     C     RFF299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle DOC-segment                    SRDOC1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRDOC1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGKOL        DOC210
     C     TEGN          CABEQ     LOGPLU        DOC210
     C     TEGN          CABEQ     LOGAPP        DOC299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     DOC210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     '916'         DOC299
     C                   ADD       1             D6
      *
     C     TEGN          IFEQ      LOGKOL                                       1<-B
      * Les forbi '::'
     C     1             DO        2                                             2<-B
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGKOL                                         3<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C                   ENDDO                                                    3<-E
     C                   ENDDO                                                   2<-E
      * Les rubr.44 dokumenttype
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                              2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGPLU        DOC220
     C     TEGN          CABEQ     LOGAPP        DOC220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                   2<-E
     C     DOC220        TAG
     C                   MOVEL     FELT          D1(D6)
     C     TEGN          CABEQ     LOGAPP        DOC299
     C                   END                                                    1<-E
      * Les rubr.44 dokumentref.
     C                   MOVE      *BLANKS       FE
N05  C                   MOVE      *ZEROS        XLENGDE           3 0
     C     1             DO        36            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGKOL        DOC230
     C     TEGN          CABEQ     LOGPLU        DOC230
     C     TEGN          CABEQ     LOGAPP        DOC230
     C                   MOVEL     TEGN          FE(NR)
N05  C                   ADD       1             XLENGDE
     C                   ENDDO                                                  1<-E
     C     DOC230        TAG
     C                   MOVEL     FELT          D2(D6)
N05  C                   MOVEL     XLENGDE       D2L(D6)
     C     TEGN          CABEQ     LOGPLU        DOC299
     C     TEGN          CABEQ     LOGAPP        DOC299
      * Les rubr.44 språkkode til utfylt opplysninger
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGKOL        DOC240
     C     TEGN          CABEQ     LOGPLU        DOC240
     C     TEGN          CABEQ     LOGAPP        DOC240
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     DOC240        TAG
     C                   MOVEL     FELT          D5(D6)
     C     TEGN          CABEQ     LOGPLU        DOC299
     C     TEGN          CABEQ     LOGAPP        DOC299
      * Les rubr.44 utfylt opplysninger
     C                   MOVE      *BLANKS       FE
N05  C                   MOVE      *ZEROS        XLENGDE           3 0
     C     1             DO        27            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGKOL        DOC250
     C     TEGN          CABEQ     LOGPLU        DOC250
     C     TEGN          CABEQ     LOGAPP        DOC250
     C                   MOVEL     TEGN          FE(NR)
N05  C                   ADD       1             XLENGDE
     C                   ENDDO                                                  1<-E
     C     DOC250        TAG
     C                   MOVEL     FELT          D4(D6)
N05  C                   MOVEL     XLENGDE       D4L(D6)
     C     TEGN          CABEQ     LOGPLU        DOC299
     C     TEGN          CABEQ     LOGAPP        DOC299
      * Les rubr.44 språkkode til dokument
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      DOC299
     C     TEGN          CABEQ     LOGPLU        DOC260
     C     TEGN          CABEQ     LOGAPP        DOC260
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     DOC260        TAG
     C                   MOVEL     FELT          D3(D6)
      *
     C     DOC299        ENDSR
     C*__________________________________________________________
     C* SR for å behandle TOD-segment                    SRTOD1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRTOD1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TOD299
     C     TEGN          CABEQ     LOGPLU        TOD210
     C     TEGN          CABEQ     LOGAPP        TOD298
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     TOD210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     '2'           TOD298
     C     TEGN          CABEQ     LOGAPP        TOD298
      * Les forbi '+'
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                       1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TOD299
     C                   ENDDO                                                  1<-E
      * Les rubr.44 eksport fra EU
     C                   MOVE      *BLANKS       FE
     C     1             DO        2             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TOD299
     C     TEGN          CABEQ     LOGKOL        TOD220
     C     TEGN          CABEQ     LOGPLU        TOD220
     C     TEGN          CABEQ     LOGAPP        TOD220
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     TOD220        TAG
     C                   MOVEL     FELT          TVEXKD
     C     TEGN          CABEQ     LOGPLU        TOD298
     C     TEGN          CABEQ     LOGAPP        TOD298
      * Les rubr.44 eksport fra land
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      TOD299
     C     TEGN          CABEQ     LOGPLU        TOD230
     C     TEGN          CABEQ     LOGAPP        TOD230
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     TOD230        TAG
     C                   MOVEL     FELT          TVEXLK
      *
     C     TOD298        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
     C  NLRSEGNAM        IFEQ      'FTX'
     C                   EXSR      SRFTX2
     C                   END
      *
     C     TOD299        ENDSR
     C*__________________________________________________________
     C* SR for å konvertere FTX-segment                  SRFTX2 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRFTX2        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX399
     C     TEGN          CABEQ     LOGPLU        FTX310
     C     TEGN          CABEQ     LOGAPP        FTX399
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     FTX310        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     'ACB'         FTX399
      * Les forbi '+' (TEGN INNEHOLDER '+')
     C                   MOVE      *BLANKS       TEGN
     C     TEGN          DOWNE     LOGPLU                                        2<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX399
     C                   ENDDO                                                   2<-E
      * Les rubr.44 tilleggs opplysning
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      FTX399
     C     TEGN          CABEQ     LOGPLU        FTX320
     C     TEGN          CABEQ     LOGAPP        FTX320
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     FTX320        TAG
     C                   MOVEL     FELT          TVTLO
      *
     C     FTX399        TAG
     C                   MOVE      *BLANKS       SEGNAM
     C                   EXSR      GETSEG
      *
     C                   ENDSR
     C*__________________________________________________________
     C* SR for å behandle GIR-segment                    SRGIR1 /
     C*""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
     C     SRGIR1        BEGSR
      *
      * Hent kode
     C                   MOVE      *BLANKS       FE
     C     1             DO        4             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      GIR299
     C     TEGN          CABEQ     LOGPLU        GIR210
     C     TEGN          CABEQ     LOGAPP        GIR299
     C                   MOVEL     TEGN          FE(NR)
     C                   END                                                    1<-E
     C     GIR210        TAG
     C                   MOVEL     FELT          XKODE             3
     C     XKODE         CABNE     '3'           GIR299
      * Hent mengde på følsomme vare
     C                   MOVE      *ZEROS        XN113            11 3
     C                   MOVE      *ZEROS        XKOMMA            5 0
     C     1             DO        15            NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      GIR299
     C     TEGN          CABEQ     LOGPLU        GIR220
     C     TEGN          CABEQ     LOGAPP        GIR220
     C     TEGN          IFGE      '0'
     C     TEGN          ANDLE     '9'
     C                   MULT      10            XN113
     C                   MOVE      TEGN          XN113
     C                   DIV       10            XKOMMA
     C                   ELSE
     C     TEGN          IFEQ      '.'
     C                   Z-ADD     1000          XKOMMA
     C                   END
     C                   END
     C                   ENDDO                                                  1<-E
      *
     C     GIR220        TAG
     C     XKOMMA        IFEQ      0
     C                   MULT      1000          XN113
     C                   ELSE
     C                   MULT      XKOMMA        XN113
     C                   END
     C                   Z-ADD     XN113         TVFVNT
     C     TEGN          CABEQ     LOGAPP        GIR299
      * Hent kode for følsomme vare
     C                   MOVE      *BLANKS       FE
     C     1             DO        3             NR                             1<-B
     C                   EXSR      GETCH
     C   LR              GOTO      GIR299
     C     TEGN          CABEQ     LOGAPP        GIR230
     C                   MOVEL     TEGN          FE(NR)
     C                   ENDDO                                                  1<-E
     C     GIR230        TAG
     C                   MOVEL     FELT          TVFV
      *
     C     GIR299        ENDSR
     C***********************************************
     C     gohist        BEGSR
     C***********************************************
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   movel     'SVX154R'     gohpgm
     c                   move      wdt           gohdat
     c                   move      wtm           gohtim
     c                   movel     zuser         gohusr
     c                   write     godshr
     c                   endsr
