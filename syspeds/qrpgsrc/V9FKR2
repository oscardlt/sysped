     FV9FNF     UF   E           K DISK
     FV9FKD2    CF   E             WORKSTN USROPN
     F                                     MAXDEV(*FILE)
     F                                     INFDS(FEEDBK)
     D FF              S             10    DIM(500)
     D FS              S              1    DIM(500)
     D FT              S             50    DIM(500)
     D XK              S              1    DIM(16)
     D FEEDBK          DS
     D  STATUS           *STATUS
     D                 DS
     D  FNS01                  1      1
     D  FNS02                  2      2
     D  FNS03                  3      3
     D  FNS04                  4      4
     D  FNS05                  5      5
     D  FNS06                  6      6
     D  FNS07                  7      7
     D  FNS08                  8      8
     D  FNS09                  9      9
     D  FNS10                 10     10
     D  FNS11                 11     11
     D  FNS12                 12     12
     D  FNS13                 13     13
     D  FNS14                 14     14
     D  FNS15                 15     15
     D  FNS16                 16     16
     D  XS                     1     16
     D                                     DIM(16)
     D                 DS
     D  FNF01                  1     10
     D  FNF02                 11     20
     D  FNF03                 21     30
     D  FNF04                 31     40
     D  FNF05                 41     50
     D  FNF06                 51     60
     D  FNF07                 61     70
     D  FNF08                 71     80
     D  FNF09                 81     90
     D  FNF10                 91    100
     D  FNF11                101    110
     D  FNF12                111    120
     D  FNF13                121    130
     D  FNF14                131    140
     D  FNF15                141    150
     D  FNF16                151    160
     D  XF                     1    160
     D                                     DIM(16)
     D                 DS
     D  FNT01                  1     50
     D  FNT02                 51    100
     D  FNT03                101    150
     D  FNT04                151    200
     D  FNT05                201    250
     D  FNT06                251    300
     D  FNT07                301    350
     D  FNT08                351    400
     D  FNT09                401    450
     D  FNT10                451    500
     D  FNT11                501    550
     D  FNT12                551    600
     D  FNT13                601    650
     D  FNT14                651    700
     D  FNT15                701    750
     D  FNT16                751    800
     D  XT                     1    800
     D                                     DIM(16)
      *
     C                   EXSR      INIT
      *
     C     UJOBQ         IFEQ      'J'
     C     *LOVAL        SETLL     V9FNF
     C                   READ      V9FNF                                  33
     C     *IN33         DOWEQ     '0'
     C     USAD          IFEQ      'J'
     C     FNSAD         ANDNE     'J'
     C                   GOTO      STLES
     C                   END
     C     UHIST         IFEQ      'J'
     C     FNHIST        IFEQ      'J'
     C     FNHST         ANDEQ     ' '
     C     FNHKNV        ANDEQ     'J'
     C                   EXSR      KNVF
     C                   END
     C                   ELSE
     C     FNDRIF        IFEQ      'J'
     C     FNST          ANDEQ     ' '
     C     FNKNV         ANDEQ     'J'
     C                   EXSR      KNVF
     C                   END
     C                   END
     C     STLES         TAG
     C                   READ      V9FNF                                  33
     C  N33              ENDDO
     C                   GOTO      SLUTT
     C                   END
      *
     C                   OPEN      V9FKD2
      *
     C     *LOVAL        SETLL     V9FNF
     C                   READ(N)   V9FNF                                  33
     C     *IN33         DOWEQ     '0'
     C     UHIST         IFEQ      'J'
     C     FNHIST        IFEQ      'J'
     C     FNHST         ANDEQ     ' '
     C     FNHKNV        ANDEQ     'J'
     C                   ADD       1             XN                3 0
     C                   MOVE      FNFN          FF(XN)
     C                   MOVE      FNHST         FS(XN)
     C                   MOVE      FNTXT         FT(XN)
     C                   END
     C                   ELSE
     C     FNDRIF        IFEQ      'J'
     C     FNST          ANDEQ     ' '
     C     FNKNV         ANDEQ     'J'
     C                   ADD       1             XN                3 0
     C                   MOVE      FNFN          FF(XN)
     C                   MOVE      FNST          FS(XN)
     C                   MOVE      FNTXT         FT(XN)
     C                   END
     C                   END
     C                   READ(N)   V9FNF                                  33
     C  N33              ENDDO
      *
     C                   Z-ADD     1             XN
     C     XN            DOWLT     500
      *
     C     FF(XN)        IFEQ      *BLANKS
     C                   CLOSE     V9FKD2
     C                   GOTO      SLUTT
     C                   END
      *
     C     1             DO        16            X2                3 0
     C                   MOVE      FF(XN)        XF(X2)
     C                   MOVE      FS(XN)        XS(X2)
     C                   MOVE      FT(XN)        XT(X2)
     C                   ADD       1             XN
     C                   ENDDO
     C     FF(XN)        COMP      *BLANKS                                50
      *
     C     1             DO        16            X2
     C                   WRITE     BILDE01
     C                   READ      V9FKD2                               3030
     C     XF(X2)        IFNE      *BLANKS
     C                   MOVE      XF(X2)        FNFN
     C     FNFN          CHAIN     V9FNF                              33
     C                   EXSR      KNVF
     C     UHIST         IFEQ      'J'
     C                   MOVE      FNHST         XS(X2)
     C                   ELSE
     C                   MOVE      FNST          XS(X2)
     C                   END
     C                   END
     C                   ENDDO
      *
     C                   ENDDO
      *
     C     SLUTT         TAG
     C                   IF        UHIST <> 'J'
     C                   CALL      'V9FKC92'
     C                   PARM                    UFLIB
     C                   END
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     KNVF          BEGSR
     C***********************************************
     C                   MOVE      'J'           XKNV              1
     C                   CALL      FNPGM
     C                   PARM                    FNFN
     C                   PARM                    UFLIB
     C                   PARM                    UTLIB
     C                   PARM                    UTØM
      *
     C     UHIST         IFEQ      'J'
     C                   MOVE      'J'           FNHST
     C                   MOVE      'F'           FNHKNV
     C                   ELSE
     C                   MOVE      'J'           FNST
     C                   MOVE      'F'           FNKNV
     C                   END
     C                   UPDATE    V9FNFR
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UHIST             1
     C                   PARM                    USAD              1
     C                   PARM                    UFLIB            10
     C                   PARM                    UTLIB            10
     C                   PARM                    UTØM              1
     C                   PARM                    UJOBQ             1
      *
     C                   ENDSR
      *
