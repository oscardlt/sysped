/* SENDE FRAKTBREV PÅ EMAIL       */
/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 10XXX * 01 JOV PTF10 INITIER OPPDRAGSNR PÅ UDS                          */
/* 10XXX * 02 JOV PTF10 SAMME OVL PÅ TP SOM FR-BREV /FRONTMGN(0.14 0)->0 0 */
/* 10XXX * 02 JOV PTF11 LPI(12) + SIDESTØRRELSE/OVERFLOW DOBLET SYBRINGTMS */
/*                              + SIDEBREDDE- 90->100                      */
/* ********************************************************************    */
             PGM        PARM(&BPARM)
             DCL        VAR(&PDFDIR) TYPE(*CHAR) LEN(1) VALUE('J')
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Kode = 'F', 'T'. 'F'=fraktbrev, +
                          'T'=tollpassfraktbrev  */
             DCL        VAR(&VB) TYPE(*CHAR) LEN(1) VALUE(' ') /* +
                          Hvis &VB = 'J',  VALGBILDE              +
                          til bruker. */
             DCL        VAR(&PO) TYPE(*CHAR) LEN(1) VALUE('F') /* +
                          Hvis &PO = 'J',SORT   F=FAX             */
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PRANT) TYPE(*CHAR) LEN(2) VALUE('00') +
                          /* Antall utskrifter. */
             DCL        VAR(&BPARM)    TYPE(*CHAR) LEN(536)
             DCL        VAR(&TUR) TYPE(*CHAR) LEN(8) VALUE('00000000')
             DCL        VAR(&NULL5) TYPE(*CHAR) LEN(5) VALUE('00000')
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(20)
             DCL        VAR(&PTIME) TYPE(*CHAR) LEN(8)
             DCL        VAR(&PDATE) TYPE(*CHAR) LEN(8)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(21)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10)
             DCL        VAR(&KNAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FBN) TYPE(*CHAR) LEN(3)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&DONAV) TYPE(*CHAR) LEN(12)
             DCL        VAR(&ATTN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(70)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP9) TYPE(*CHAR) LEN(40)
             DCL        VAR(&PDF) TYPE(*CHAR) LEN(4) VALUE('*YES')
             DCL        VAR(&PRTNA) TYPE(*CHAR) LEN(10) +
                          VALUE('SYFA12P')
    /* SKRIVER UT FRAKTBREVKOPI           */
    /*                                    */
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
             CHGVAR     VAR(&FAX) VALUE(%SST(&BPARM 1 21))
             CHGVAR     VAR(&FILEN) VALUE(%SST(&BPARM 22 10))
             CHGVAR     VAR(&PTIME) VALUE(%SST(&BPARM 32 8))
             CHGVAR     VAR(&PDATE) VALUE(%SST(&BPARM 40 8))
             CHGVAR     VAR(&KNAVN) VALUE(%SST(&BPARM 48 30))
             CHGVAR     VAR(&AVD) VALUE(%SST(&BPARM 78 4))
             CHGVAR     VAR(&OPD) VALUE(%SST(&BPARM 82 7))
             CHGVAR     VAR(&KODE) VALUE(%SST(&BPARM 89 1))
             CHGVAR     VAR(&DONAV) VALUE(%SST(&BPARM 90 12))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&BPARM 102 40))
             CHGVAR     VAR(&CVP2) VALUE(%SST(&BPARM 142 40))
             CHGVAR     VAR(&CVP3) VALUE(%SST(&BPARM 182 40))
             CHGVAR     VAR(&CVP4) VALUE(%SST(&BPARM 222 40))
             CHGVAR     VAR(&CVP5) VALUE(%SST(&BPARM 262 40))
             CHGVAR     VAR(&CVP6) VALUE(%SST(&BPARM 302 40))
             CHGVAR     VAR(&CVP7) VALUE(%SST(&BPARM 342 40))
             CHGVAR     VAR(&CVP8) VALUE(%SST(&BPARM 382 40))
             CHGVAR     VAR(&FBN) VALUE(%SST(&BPARM 422 3))
             CHGVAR     VAR(&ATTN) VALUE(%SST(&CVP2 1 30))
             CHGVAR     VAR(&TUR) VALUE(&FBN)
             CHGVAR     VAR(&TUR) VALUE(&NULL5 *CAT &FBN)
             CHGVAR     VAR(&EPOST) VALUE(%SST(&BPARM 466 70))

/*S01        CHGDTAARA  DTAARA(*LDA (22 9)) VALUE(&OPD *CAT &FBN) */
/*N01*/      CHGDTAARA  DTAARA(*LDA (82 11)) VALUE(&OPD *CAT &FBN)

             IF         COND(&KODE = 'F') THEN(DO)
             OVRPRTF    FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 100) LPI(12) CPI(10) +
                          FRONTMGN(0 0) OVRFLW(140) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)
                          ENDDO
/*                                                               */

             IF         COND(&KODE = 'T') THEN(DO)
/*S02        OVRPRTF    FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 100) LPI(12) CPI(10) +
                          FRONTMGN(0.14 0) OVRFLW(140) +
                          FRONTOVL(TOLLPASS 0.1) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD) */
/*N02*/      OVRPRTF    FILE(SYFA12P) DEV(FAX3812) DEVTYPE(*AFPDS) +
                          PAGESIZE(140 100) LPI(12) CPI(10) +
                          FRONTMGN(0 0) OVRFLW(140) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)
                          ENDDO
/*                                                               */
             CALL       PGM(SYFA12) PARM(&PRANT &KODE &VB &PO &PDFDIR)

/*                                                               */
/*           OVRPRTF    FILE(FAX023P) DEVTYPE(*SCS) OVRFLW(66) +
                          OUTQ(OUTMAIL) FORMTYPE(*STD)           */
/*           CALL       PGM(FAX023) PARM(&AVD &OPD &FBN &KODE &KNAVN +
                          &ATTN)     */

/*                                       */
             CALL       PGM(FAXEPMMCL) PARM(&QUSER &QNBR &QJOB &PRTNA +
                          &EPOST +
                          &CVP1 &CVP2 &CVP3 &CVP4 &CVP5 +
                          &CVP6 &CVP7 &CVP8 &CVP9 &PDF)

             CHGVAR     VAR(&FAX) VALUE(MAIL)
             CHGVAR     VAR(&KNAVN) VALUE(&EPOST)

             CALL       PGM(FAX013) PARM(&QUSER &QNBR &QJOB +
                          &FAX &DONAV &MAPPE &PTIME &PDATE &KNAVN +
                          &AVD &OPD &TUR &KODE)
    /* */
 SLUTT:      ENDPGM
