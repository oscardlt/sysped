**********************************************************************************************
      * Sjekk om det finnes  Avvikskode - Hopp ut fed første treff = NOE finnes ..           *
      ****************************************************************************************
      * Hvis kall på avd/oppdr sjekk alle kolli-ID(DOKUFM)/Underrecords(DOKUFNF.)            *
      * Hvis kall på kolli-ID - sjekk EN kolliids under-records (DOKUFN)                     *
      *                                                                                      *
      ****************************************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 JOV PTF12 Avvikskode "BILDE" flagges ikke som avvik
********************************************************************
     FDOKUFM    IF   E           K DISK
     FDOKUFN    IF   E           K DISK
     D                 DS
     D FMMRK1                  1     35
     D  WFMMRK1                1     35
     D  WFMMRK1A               1     18
N01  D                 DS
N01  D FMLEDI                  1     10
N01  D  AvvikInn               1      5
N01  D  AvvikUt                6     10
      *
     C                   exsr      Init
      *
     c                   if        UFMOPD<> *zeros
     c                   exsr      Alle
     c                   else
     c                   eval      FMMRK1 = UFMRK1
     c                   exsr      ettKolli
     c                   endif
      *
     C                   SETON                                        LR
     C                   return
      *
      ***********************************************
     c     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UFMRK1
     C                   PARM                    UFMAVD
     C                   PARM                    UFMOPD
     C                   PARM                    UFLAGG            1
     c                   move      '0'           UFLAGG
     C     *LIKE         DEFINE    FMMRK1        UFMRK1
     C     *LIKE         DEFINE    FMAVD         UFMAVD
     C     *LIKE         DEFINE    FMOPD         UFMOPD
     C     *LIKE         DEFINE    FMRI          WFMRI
     C     KEYDOK        KLIST
     C                   KFLD                    WFMRI
     C                   KFLD                    UFMAVD
     C                   KFLD                    UFMOPD
N04  C                   KFLD                    UFBNR1
N04  C                   KFLD                    ULINR0
     C                   EVAL      WFMRI='F'
N04  C                   MOVE      001           UFBNR1            3 0
N04  C                   MOVE      *ZEROS        ULINR0            2 0
      *
     C                   ENDSR
      *
      ***********************************************
     c     ALLE          BEGSR
      ***********************************************
      * FMLEDI = anmerning på hovedrecord DOKUFM  (1-5=Inn / 6-10 = Ut)
     C     KEYDOK        SETLL     DOKUFM
     C     KEYDOK        READE     DOKUFM                                 94

     C     *IN94         DOWEQ     '0'
     C                   IF        FMST='I' OR FMST='E'
      *
S01  c*                  if        FMLEDI <> *blanks
S01  c*                  move      '1'           UFLAGG
S01  c*                  else
S01  c*                  exsr      ettKolli
S01  c*                  endif
N01  c                   select
N01  c                   when      AvvikInn<>*blanks and
N01  c                             AvvikInn<>'BILDE'
N01  c                   move      '1'           UFLAGG
N01  c                   when      AvvikUt <>*blanks and
N01  c                             AvvikUt <>'BILDE'
N01  c                   move      '1'           UFLAGG
N01  c                   other
N01  c                   exsr      ettKolli
N01  c                   endsl
N01   *
     c                   if        UFLAGG = '1'
     c                   leave
     c                   endif
      *
     C                   ENDIF
     C     KEYDOK        READE     DOKUFM                                 94
     C                   ENDDO
      *
     C                   ENDSR
      *
      ***********************************************
     c     EttKolli      BEGSR
      ***********************************************
      * FMLEDI = anmerning på hovedrecord DOKUFM
     C     WFMMRK1A      SETLL     DOKUFN
     C     WFMMRK1A      READE     DOKUFN                                 94

     C     *IN94         DOWEQ     '0'
      *
S01  c*                  if        FNAVKO <> *blanks
N01  c                   if        FNAVKO <> *blanks and
N01  c                             FNAVKO <> 'BILDE'
     c                   move      '1'           UFLAGG
     c                   leave
     c                   endif
      *
     C     WFMMRK1A      READE     DOKUFN                                 94
     C                   ENDDO
      *
     C                   ENDSR
      *
