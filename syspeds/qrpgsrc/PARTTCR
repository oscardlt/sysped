     FEDIM      IF   E           K DISK
     FECOM96B   IF   E           K DISK
     FEDTM96B   IF   E           K DISK
     FEFTX96B   IF   E           K DISK
     FELOC96B   IF   E           K DISK
     FENAD96B   IF   E           K DISK
     FERFF96B   IF   E           K DISK
     FETOD96B   IF   E           K DISK
     FPARTTC    O  A E             DISK
     D A               S              1    DIM(79)
     D B               S              1    DIM(18)
      *________________________
      * DS for decimal handling
      *""""""""""""""""""""""""
     D                 DS
     D  WMN2                   1      9  0
      */////////////
      * MAIN LOGIC /
      */////////////
      *___________
      * Initiering
      *"""""""""""
     C                   EXSR      INIT
      *________
      * CONVERT
      *""""""""
     C                   EXSR      RTVD
      *
     C                   MOVE      '1'           *INLR
      *
      *////////////////////////////////////////////////////////////
      *                                                      INIT /
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
     C     KEYMS0        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
     C     KEYMS3        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN3
     C                   KFLD                    ZREPD0
     C                   KFLD                    ZREPD1
     C                   KFLD                    ZREPD2
      *
     C     *LIKE         DEFINE    NMN           ZMN
     C     *LIKE         DEFINE    NGN           ZGN0
     C     *LIKE         DEFINE    NGN           ZGN1
     C     *LIKE         DEFINE    NGN           ZGN2
     C     *LIKE         DEFINE    NGN           ZGN3
     C     *LIKE         DEFINE    NREP0         ZREPB0
     C     *LIKE         DEFINE    NREP0         ZREPC0
     C     *LIKE         DEFINE    NREP1         ZREPC1
     C     *LIKE         DEFINE    NREP0         ZREPD0
     C     *LIKE         DEFINE    NREP1         ZREPD1
     C     *LIKE         DEFINE    NREP2         ZREPD2
      * INIT WORKFIELDS
      *
     C     *ENTRY        PLIST
     C                   PARM                    WMN1              9
     C                   MOVEL     WMN1          WMN2
     C                   Z-ADD     WMN2          ZMN
      * Get msg and interchange values
     C     ZMN           CHAIN     EDIM                               51
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400     RTVD /
      *////////////////////////////////////////////////////////////
     C     RTVD          BEGSR
      *_______________________
      * READ ALL MAIN SEGMENTS
      *"""""""""""""""""""""""
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     1             ZGN0
     C     KEYMS0        SETLL     ENAD96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ENAD96B                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      RTVDB
      *
     C     KEYMS0        READE     ENAD96B                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED       RTVDB /
      *////////////////////////////////////////////////////////////
     C     RTVDB         BEGSR
      *__________________
      * INIT. DATAFELTER
      *""""""""""""""""""
     C                   CLEAR                   PARTTCR
     C                   MOVEL     N3035         N13035                           Party_Q
     C                   MOVEL     N3039         N13039                           PARTY_ID
     C                   MOVEL     N3036A        N13036A                          REF_NO')
     C                   MOVEL     N3036B        N13036B                          REF_NO_HIGHER_AUTH
     C                   MOVEL     N3036C        N13036C                          REF_NO_TAKE_OVER')
     C                   MOVEL     N3036D        N13036D                          REF_NO_MAIN_OFC')
     C                   MOVEL     N3042A        N13042                           GEO_INFO_CODE')
     C                   MOVEL     N3164         N13164                           REGION_CODE')
     C                   MOVEL     N3251         N13251                           POSTAL_CODE')
     C                   MOVEL     N3207         N13207                           COUNTRY_CODE')
      *__________________
      * READ ALL SEGMENTS
      *""""""""""""""""""
     C                   Z-ADD     NREP0         ZREPB0
     C                   EXSR      DTM01
     C                   EXSR      FTX01
     C                   EXSR      RFF01
     C                   EXSR      COM02
     C                   EXSR      TOD03
      *________________
      * WRITE TO SYSPED
      *""""""""""""""""
     C                   WRITE     PARTTCR
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * COM02                                               COM02 /
      *////////////////////////////////////////////////////////////
     C     COM02         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     2             ZGN1
     C     KEYMS1        SETLL     ECOM96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ECOM96B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     C3155         WHENEQ    'EI'
     C                   MOVEL     C3148         C23148A
     C     C3155         WHENEQ    'TE'
     C                   MOVEL     C3148         C23148B
     C     C3155         WHENEQ    'FX'
     C                   MOVEL     C3148         C23148C
     C     C3155         WHENEQ    'TL'
     C                   MOVEL     C3148         C23148D
     C     C3155         WHENEQ    'EM'
     C                   MOVEL     C3148         C23148E
     C                   ENDSL
      *
     C  N52KEYMS1        READE     ECOM96B                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM01                                               DTM01 /
      *////////////////////////////////////////////////////////////
     C     DTM01         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     1             ZGN1
     C     KEYMS1        SETLL     EDTM96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM96B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     D2380         D22380
      *
     C  N52KEYMS1        READE     EDTM96B                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM03                                               DTM03 /
      *////////////////////////////////////////////////////////////
     C     DTM03         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     3             ZGN2
     C     KEYMS2        SETLL     EDTM96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM96B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   SELECT
     C     D2005         WHENEQ    '194'
     C                   MOVEL     D2380         D32380A
     C     D2005         WHENEQ    '206'
     C                   MOVEL     D2380         D32380B
     C                   ENDSL
      *
     C  N53KEYMS2        READE     EDTM96B                                53
     C  N53              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC04                                               LOC04 /
      *////////////////////////////////////////////////////////////
     C     LOC04         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     4             ZGN2
     C     KEYMS2        SETLL     ELOC96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     ELOC96B                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   SELECT
     C     L3227         WHENEQ    '22'
     C                   SELECT
     C     L43225AA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225AA
     C                   MOVEL     L3224         L43224AA
     C                   MOVEL     L3223         L43223AB
     C                   MOVEL     L3222         L43222AB
     C     L43225BA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225BA
     C                   MOVEL     L3224         L43224BA
     C                   MOVEL     L3223         L43223BB
     C                   MOVEL     L3222         L43222BB
     C     L43225CA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225CA
     C                   MOVEL     L3224         L43224CA
     C                   MOVEL     L3223         L43223CB
     C                   MOVEL     L3222         L43222CB
     C     L43225DA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225DA
     C                   MOVEL     L3224         L43224DA
     C                   MOVEL     L3223         L43223DB
     C                   MOVEL     L3222         L43222DB
     C     L43225EA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225EA
     C                   MOVEL     L3224         L43224EA
     C                   MOVEL     L3223         L43223EB
     C                   MOVEL     L3222         L43222EB
     C     L43225FA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225FA
     C                   MOVEL     L3224         L43224FA
     C                   MOVEL     L3223         L43223FB
     C                   MOVEL     L3222         L43222FB
     C     L43225GA      WHENEQ    *BLANKS
     C                   MOVEL     L3225         L43225GA
     C                   MOVEL     L3224         L43224GA
     C                   MOVEL     L3223         L43223GB
     C                   MOVEL     L3222         L43222GB
     C                   ENDSL
     C     L3227         WHENEQ    '89'
     C                   SELECT
     C     L43224C1      WHENEQ    *BLANKS
     C                   MOVEL     L3224         L43224C1
     C     L43224C2      WHENEQ    *BLANKS
     C                   MOVEL     L3224         L43224C2
     C                   ENDSL
     C                   ENDSL
      *
     C                   Z-ADD     LREP0         ZREPD0
     C                   Z-ADD     LREP1         ZREPD1
     C                   Z-ADD     LREP2         ZREPD2
     C                   EXSR      FTX04
      *
     C  N53KEYMS2        READE     ELOC96B                                53
     C  N53              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TOD03                                               TOD03 /
      *////////////////////////////////////////////////////////////
     C     TOD03         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     3             ZGN1
     C     KEYMS1        SETLL     ETOD96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETOD96B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     T4055         WHENEQ    '1'
     C                   MOVEL     T4052A        T24052A
     C     T4055         WHENEQ    '5'
     C                   SELECT
     C     T24052B       WHENEQ    *BLANKS
     C                   MOVEL     T4052A        T24052B
     C                   MOVEL     T4052B        T24052C
     C     T24052D       WHENEQ    *BLANKS
     C                   MOVEL     T4052A        T24052D
     C                   MOVEL     T4052B        T24052E
     C                   ENDSL
     C                   ENDSL
      *
     C                   Z-ADD     TREP0         ZREPC0
     C                   Z-ADD     TREP1         ZREPC1
     C                   EXSR      DTM03
     C                   EXSR      LOC04
      *
      *
     C  N52KEYMS1        READE     ETOD96B                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF01                                               RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     1             ZGN1
     C     KEYMS1        SETLL     ERFF96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF96B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     R1154         R21154
      *
     C  N52KEYMS1        READE     ERFF96B                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * FTX01                                               FTX01 /
      *////////////////////////////////////////////////////////////
     C     FTX01         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     1             ZGN1
     C     KEYMS1        SETLL     EFTX96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX96B                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     F4451         WHENEQ    'AAI'
     C                   MOVEL     F4440A        F24440A
     C     F24440A       CAT       F4440B:0      F24440A
     C     F24440A       CAT       F4440C:0      F24440A
     C     F4451         WHENEQ    'ABS'
     C                   MOVEL     F4441         F24441A
     C                   MOVEL     F4440A        F24440B
     C                   MOVEL     F4440B        F24440C
     C                   MOVEL     F4440E        F24440D
     C     F4451         WHENEQ    'ACB'
     C                   MOVEL     F4441         F24441B
     C     F4451         WHENEQ    'ACV'
     C                   MOVEL     F4440A        F24440E
     C                   MOVEL     F4440B        F24440F
     C                   ENDSL
      *
     C     KEYMS1        READE     EFTX96B                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX04                                               FTX04 /
      *////////////////////////////////////////////////////////////
     C     FTX04         BEGSR
     C                   MOVE      '0'           *IN54
     C                   Z-ADD     4             ZGN3
     C     KEYMS3        SETLL     EFTX96B                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS3        READE     EFTX96B                                54
     C     *IN54         DOWEQ     '0'
      *
     C                   SELECT
     C     F44453A       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453A
     C                   MOVEL     F4441         F44441A
     C     F44453B       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453B
     C                   MOVEL     F4441         F44441B
     C     F44453C       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453C
     C                   MOVEL     F4441         F44441C
     C     F44453D       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453D
     C                   MOVEL     F4441         F44441D
     C     F44453E       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453E
     C                   MOVEL     F4441         F44441E
     C     F44453F       WHENEQ    *BLANKS
     C                   MOVEL     F4453         F44453F
     C                   MOVEL     F4441         F44441F
     C                   ENDSL
      *
     C     KEYMS3        READE     EFTX96B                                54
     C  N54              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
