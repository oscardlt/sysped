********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 BLANK TVDK, IKKE NUSTILL TVDK
10XXX * 02 YBC PTF10 VAREBESKRIVELSE ER ENDRET
10022 * 03 YBC PTF10 SAMPAKKET KOLLI MED FLERE VARELINJER
10XXX * 04 YBC PTF10 SISTE SIFFER I TVVNT INNEHOLDER ANTALL INNGÅENDE SIFRE
10043 * 05 YBC PTF10 SEND STYKK VED ENHETKODE = 'NF'
10250 * 06 YBC PTF10 DOKUMENTKODE ER ENDRET FRA 3A TIL 4A
10253 * 07 YBC PTF10 NY PAKKETYPE VS, BEHANLES SAMME SOM VR
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED TET-IMPORT LOSSEMERKNADER     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13 14 16-24
      *** LEDIGE INDIKATORER 28 29 34-36 47-51 57-73 95-97
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
     FTRIL      UF A E           K DISK
     FTRIL02    IF   E           K DISK
     F                                     RENAME(TRILR:TRIL02R)
     FTRILCN    UF   E           K DISK
     FTRILDK    UF   E           K DISK
     FTRILMN    UF   E           K DISK
     FTRILKL    UF   E           K DISK
N02  FTRILVT    UF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FTRFKDF    IF   E           K DISK
     FTARI      IF   E           K DISK
     FTR065D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D LI              S              5  0 DIM(200)
      *
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSVNT                  1      8  0
     D  WSVNT6                 1      6  0
S02  D*                DS
S02  D* TVVT                   1    140
S02  D* TVVT48                 1     48
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UIN27                 12     12
     D  UIN34                 13     13
     D  U1N07                 15     17
     D  UKDC                  28     28
      * OBS! HUSK INITIERE ALLE FELTER PÅ TR011R
     D  UPARM2                 1    128
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
     C                   MOVE      *ZEROS        XLI
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C  N31TRV2K         SETLL     TRIL02
     C   31TRV1K         SETLL     TRIL
     C     START1        TAG
     C  N31TRHK          READE     TRIL02                                 94
     C   31TRHK          READE(N)  TRIL                                   94
     C  N94
     CAN 31              MOVE      TVLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
     C                   MOVE      *ZEROS        XLI               5 0
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        99998
     C                   ADD       1             ZRECNO
     C                   EXSR      HENTDT
     C                   WRITE     SUBFIL
     C  N31TRHK          READE     TRIL02                                 94
     C   31TRHK          READE(N)  TRIL                                   94
     C  N94
     CAN 31              MOVE      TVLI          W3LI
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
      *
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      ***
      *
     C                   SETOFF                                       989930
      *
      *** F03 OG 27 PÅ ---> AVBRYTTE SPØRRING
     C   03
     CAN 27              MOVE      *ZEROS        UFLAGG
     C   03
     CAN 27              GOTO      SLUTT
      *** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
      *** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C   03              DO
     C                   EXSR      PRINT
      *** F12 ---> AVBRYTTE F3
     C   12              Z-ADD     4             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
      *
      *** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
      *** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
      *** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
      *** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94
     CAN 31TRVK          SETLL     TRIL
     C  N94
     CAN 31TRHK          READE(N)  TRIL                                   94
     C                   GOTO      START2
     C                   END
      *
      *** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C                   END
      *** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
      ***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
      *** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
      ***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
      *
      *** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   EXSR      MOVB2
      *
     C     START6        TAG
     C  N30WSLI          IFGT      0
     C                   EXSR      TSTOPL
     C                   END
     C                   MOVE      'NE'          WSCT
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVE      '0'           *IN74
     C                   MOVE      '0'           *IN30
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START6
     C                   END
      *
     C   12WSLI          IFGT      0
     C                   EXSR      DLTOPL
     C                   END
      *
      *** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C  N12              DO
      *** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
      *** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
      *
     C     WSLI          IFEQ      0
     C                   ADD       1             XLI
     C                   MOVE      XLI           WSLI
     C                   END
      *
      *** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDTRV
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      START6
     C                   END
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
      *** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
      *** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + STATUS       (TRUV02)
      *** 31 AV    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (TRUV)
     C     START7        TAG
     C                   MOVE      *ZEROS        W3VNT
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C     W3VNT         COMP      0                                      31
     C                   MOVE      W3LI          W3LIGM            5 0
     C                   GOTO      START
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HENTDT        BEGSR
     C***********************************************
     C     TVLI          IFGT      XLI
     C                   MOVE      TVLI          XLI               5 0
     C                   END
     C                   EXSR      HENTD2
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENTD2        BEGSR
     C***********************************************
     C                   MOVE      NVEH          X1EH              2
     C                   MOVE      NVNT          X1NT              5 0
     C                   MOVE      NVNTEH        X1NTEH            5 0
     C                   MOVE      TVEH          X2EH              2
     C                   MOVE      TVNT          X2NT              5 0
     C                   MOVE      TVNTEH        X2NTEH            5 0
     C     TV01          COMP      ' '                                4141
     C                   MOVE      NVVNT         W2VNT
     C                   MOVEL     NVVT          W2VT
     C                   MOVE      NVVKTN        W2VKTN
     C                   MOVE      NVDTY         W2DTY
     C                   MOVEL     NVDREF        W2DREF
     C                   MOVE      NVEH          W2EH
     C     NVNT          IFEQ      0
     C                   MOVE      NVNTEH        W2NTK
     C                   ELSE
     C                   MOVE      NVNT          W2NTK
     C                   END
     C     TRVK2         SETLL     TRILKL
     C     TRVK2         READE(N)  TRILKL                                 33
     C     *IN33         DOWEQ     '0'
     C     W2EH          IFNE      NVEH
     C                   MOVE      '**'          W2EH
     C                   END
     C     NVNT          IFEQ      0
     C                   ADD       NVNTEH        W2NTK
     C                   ELSE
     C     NVNT          IFNE      99999
     C                   ADD       NVNT          W2NTK
     C                   END
     C                   END
     C     TRVK2         READE(N)  TRILKL                                 33
     C  N33              END
     C                   MOVE      X1EH          NVEH
     C                   MOVE      X1NT          NVNT
     C                   MOVE      X1NTEH        NVNTEH
     C                   MOVE      X2EH          TVEH
     C                   MOVE      X2NT          TVNT
     C                   MOVE      X2NTEH        TVNTEH
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
      *
     C     WSCT          IFNE      'DI'
     C     WSCT          ANDNE     'NE'
     C     WSCT          ANDNE     'OT'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC1778'     MSGNR
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSCTSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSCTSK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           89
     C     *IN89         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSCT          IFEQ      'OT'
     C     WSCTB         ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN88
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC1772'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   TESTN                   WSVNTI               33
     C   33              MOVE      WSVNTI        WSVNT
     C  N33              MOVE      *ZEROS        WSVNT
      *
N04  C                   MOVE      TVVNT         TVVNT2            8 0
N04  C                   MOVE      '0'           TVVNT2
     C     WSVNT         IFNE      0
S04  C*    WSVNT         ANDNE     TVVNT
N04  C     WSVNT         ANDNE     TVVNT2
     C     TARIK         CHAIN     TARI                               86
     C     *IN86         IFEQ      '1'
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'SPT0033'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   ELSE
     C     WSVT          IFEQ      *BLANKS
     C                   MOVEL     TAALFA        WSVT
     C                   END
     C                   END
     C                   END
      *
     C     WSVT          COMP      *BLANKS                                85
     C     *IN85         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0840'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSVTSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSVTSK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           84
     C     *IN84         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
S02  C*                  Z-ADD     16            LINNBR
N02  C                   Z-ADD     17            LINNBR
     C                   Z-ADD     70            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSDTY         IFNE      *BLANKS
     C                   MOVE      '013'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDTY         YKODE
     C     TRK01K        CHAIN     TRKODL01                           83
     C     *IN83         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0813'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C     WSDREF        COMP      *BLANKS                                82
     C     *IN82         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'YBC0814'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSDSK         IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDSK         YKODE
     C     TRK01K        CHAIN     TRKODL01                           81
     C     *IN81         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     75            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSDOSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSDOSK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           80
     C     *IN80         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSEH          IFNE      *BLANKS
     C     WSEH          ANDNE     'NE'
N05  C     WSEH          ANDNE     'NF'
     C     WSEH          ANDNE     'VQ'
     C     WSEH          ANDNE     'VG'
     C     WSEH          ANDNE     'VL'
     C     WSEH          ANDNE     'VY'
     C     WSEH          ANDNE     'VR'
     C     WSEH          ANDNE     'VO'
N07  C     WSEH          ANDNE     'VS'
     C     WSMN          COMP      *BLANKS                                79
     C     *IN79         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0826'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     *IN79         IFEQ      '0'
     C     WSMN          ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN79
     C     *IN30         IFEQ      '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0835'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSMNSK        IFNE      *BLANKS
     C                   MOVE      '012'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSMNSK        YKODE
     C     TRK01K        CHAIN     TRKODL01                           78
     C     *IN78         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     53            POSNBR
     C                   MOVE      'YBC0810'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     UKDC          IFEQ      '1'
     C     WSCNR         COMP      *BLANKS                                77
     C     *IN77         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     61            POSNBR
     C                   MOVE      'YBC0828'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C                   MOVE      '017'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSEH          YKODE
     C     TRK01K        CHAIN     TRKODL01                           76
     C     *IN76         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   MOVE      'YBC0816'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
      *
     C  N76WSEH          IFEQ      'NE'
N05  C     WSEH          OREQ      'NF'
     C     WSEH          OREQ      'VQ'
     C     WSEH          OREQ      'VG'
     C     WSEH          OREQ      'VL'
     C     WSEH          OREQ      'VY'
     C     WSEH          OREQ      'VR'
     C     WSEH          OREQ      'VO'
N07  C     WSEH          OREQ      'VS'
     C                   MOVE      *ZEROS        WSNT
     C                   END
      *
     C     WSEH          IFNE      'NE'
N05  C     WSEH          ANDNE     'NF'
     C                   MOVE      *ZEROS        WSNTEH
     C                   END
      *
     C     WSVNT6        CHAIN     TRFKDF                             33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       WSFV
     C                   MOVE      *ZEROS        WSFVNT
     C                   ELSE
     C                   MOVE      TFKODE        WSFV
     C     WSFVNT        COMP      0                                      74
     C     *IN74         IFEQ      '1'
     C     *IN30         ANDEQ     '0'
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     55            POSNBR
     C                   MOVE      'YBC0817'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
      *** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
      *** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
      *** OPSJON 2 ---> ENDRE DETALJE LINJE.
      *** OPSJON 4 ---> SLETTE DETALJE LINJE.
      *** OPSJON 5 ---> VISE DETALJE LINJE
      *** OPSJON 9 ---> FJERNE ENDRING
      *** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGTRV
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTTRV
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISTRV
     C   12              GOTO      SLHENT
     C                   END
     C  N27WSNR          IFEQ      '9'
     C                   MOVE      ' '           WSNR
     C                   EXSR      REKTRV
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     VISTRV        BEGSR
     C***********************************************
     C                   SETON                                        99
      *
     C                   MOVE      TVLI          WSLI
     C                   MOVE      NVDTY         WSDTY
     C                   MOVE      NVDREF        WSDREF
     C                   MOVE      NVDSK         WSDSK
     C                   MOVE      NVDO          WSDO
     C                   MOVE      NVDOSK        WSDOSK
     C                   EVAL      WSMN = NVMN
     C                   MOVE      NVMNSK        WSMNSK
     C                   MOVE      NVCNR         WSCNR
     C                   MOVE      NVEH          WSEH
     C                   MOVE      NVNT          WSNT
     C                   MOVE      NVNTEH        WSNTEH
     C                   EXSR      TSTOPL
     C                   MOVE      WSDTY         NVDTY
     C                   MOVE      WSDREF        NVDREF
     C                   MOVE      WSDSK         NVDSK
     C                   MOVE      WSDO          NVDO
     C                   MOVE      WSDOSK        NVDOSK
     C                   EVAL      NVMN = WSMN
     C                   MOVE      WSMNSK        NVMNSK
     C                   MOVE      WSCNR         NVCNR
     C                   MOVE      WSEH          NVEH
     C                   MOVE      WSNT          NVNT
     C                   MOVE      WSNTEH        NVNTEH
     C     STVIS         TAG
     C                   EXFMT     VAREL3
      *
     C   15              DO
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STVIS
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTTRV        BEGSR
     C***********************************************
     C     TVVKTB        IFEQ      0
     C                   SETON                                        99
      *
     C                   MOVE      TVLI          WSLI
     C                   MOVE      NVDTY         WSDTY
     C                   MOVE      NVDREF        WSDREF
     C                   MOVE      NVDSK         WSDSK
     C                   MOVE      NVDO          WSDO
     C                   MOVE      NVDOSK        WSDOSK
     C                   EVAL      WSMN = NVMN
     C                   MOVE      NVMNSK        WSMNSK
     C                   MOVE      NVCNR         WSCNR
     C                   EXSR      TSTOPL
     C                   MOVE      WSDTY         NVDTY
     C                   MOVE      WSDREF        NVDREF
     C                   MOVE      WSDSK         NVDSK
     C                   MOVE      WSDO          NVDO
     C                   MOVE      WSDOSK        NVDOSK
     C                   EVAL      NVMN = WSMN
     C                   MOVE      WSMNSK        NVMNSK
     C                   MOVE      WSCNR         NVCNR
     C     STDLT         TAG
     C                   EXFMT     VAREL3
      *
     C     *IN15         IFEQ      '1'
     C                   MOVE      '1'           UIN27
     C                   EXSR      TILKOD
     C                   MOVE      *IN27         UIN27
     C                   GOTO      STDLT
     C                   END
      *
     C     *IN12         IFEQ      '0'
     C     TRVK          CHAIN     TRIL                               33
     C                   DELETE    TRILR
     C                   EXSR      DLTOPL
     C                   EXSR      MOVB1
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     REKTRV        BEGSR
     C***********************************************
     C     TVVKTB        IFNE      0
     C     TRVK2         CHAIN     TRIL                               33
     C                   EXSR      MOVB1
     C                   UPDATE    TRILR
     C                   EXSR      DLTOPL
     C                   MOVE      ' '           WSNR
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   WRITE     SUBCTL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGTRV        BEGSR
     C***********************************************
      *** FLYTTE DATA FRA SUBFIL TIL ARBEIDSVARIABLER
     C                   EXSR      MOVTRW
      *
     C     STCHG         TAG
     C  N30              EXSR      TSTOPL
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(83)
     C                   MOVEA     '00000000'    *IN(75)
     C                   MOVE      '0'           *IN74
     C                   MOVE      '0'           *IN30
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
      *
     C   15              DO
     C                   EXSR      TILKOD
     C                   GOTO      STCHG
     C                   END
      *
     C     *IN12         IFEQ      '1'
      *** F12 ---> AVBRYTTE ENDRING
     C                   EXSR      HENTDT
     C                   UPDATE    SUBFIL
     C                   ELSE
      *** TESTE INNTASTEDE TADA. HVIS IKKE NOE FEIL, OPPDRATERE PÅ FIL
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C                   EXSR      OPDTRV
     C                   END
      *
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     OPDTRV        BEGSR
     C***********************************************
      *** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     TRVK          CHAIN     TRIL                               33
     C  N33WSNT          IFEQ      0                                            HELMANKO
     C     WSNTEH        ANDEQ     0
N03  C     TVNT          ANDNE     0
N03  C     WSNT          OREQ      0                                            HELMANKO
N03  C     WSNTEH        ANDEQ     0
N03  C     TVNTEH        ANDNE     0
N03  C     WSNT          OREQ      0                                            HELMANKO
N03  C     WSNTEH        ANDEQ     0
N03  C     WSVKTB        ANDEQ     0
N03  C     WSVKTN        ANDEQ     0
     C     TRVK          SETLL     TRILKL
     C     TRVK          READE(N)  TRILKL                                 33
     C     *IN33         DOWEQ     '0'
     C     NVNT          CABNE     0             STOPDTRV1
     C     NVNTEH        CABNE     0             STOPDTRV1
     C     TRVK          READE(N)  TRILKL                                 33
     C  N33              ENDDO
     C                   MOVE      *ZEROS        WSVNT
     C                   MOVE      *BLANKS       WSVT
     C                   MOVE      *ZEROS        WSVKTB
     C                   MOVE      *ZEROS        WSVKTN
     C     STOPDTRV1     TAG
     C                   MOVE      *OFF          *IN33
     C                   END
      *** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWTR
     C     *IN33         IFEQ      '0'
     C                   UPDATE    TRILR
     C                   ELSE
     C                   EXSR      MOVB3
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C                   WRITE     TRILR
     C                   END
      *
     C                   EXSR      HENTDT
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TILKOD        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
N02   *
N02  C   57LINNBR        IFEQ      4
N02  C     POSNBR        ANDGE     10
N02  C     POSNBR        ANDLE     79
N02  C                   MOVE      *BLANKS       WXVT             70
N02  C                   MOVE      'DSP'         UTYPE             3
N02  C                   CALL      'TR076R'
N02  C                   PARM                    TVAVD
N02  C                   PARM                    TVTDN
N02  C                   PARM                    WSLI
N02  C                   PARM                    WXVT
N02  C                   PARM                    TVVT
N02  C                   PARM                    UTYPE
N02  C                   END
      *
     C   52LINNBR        IFGE      5
     C     LINNBR        ANDLE     6
S06  C*                  MOVE      *BLANKS       WXDTY             3
N06  C                   MOVE      *BLANKS       WXDTY             4
     C                   MOVE      *BLANKS       WXDREF           16
     C                   MOVE      *BLANKS       WXDSK             2
     C                   MOVE      *BLANKS       WXDO             26
     C                   MOVE      *BLANKS       WXDOSK            2
     C                   MOVE      '1'           UIN272            1
     C                   CALL      'TR072R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WXDTY
     C                   PARM                    WXDREF
     C                   PARM                    WXDSK
     C                   PARM                    WXDO
     C                   PARM                    WXDOSK
     C                   PARM                    TVDTY
     C                   PARM                    TVDREF
     C                   PARM                    TVDSK
     C                   PARM                    TVDO
     C                   PARM                    TVDOSK
     C                   PARM                    UIN272
     C                   END
      *
     C   53LINNBR        IFEQ      8
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     42
     C                   MOVE      *BLANKS       WXMN             17
     C                   MOVE      *BLANKS       WXMNSK            2
     C                   MOVE      '1'           UIN272            1
     C                   CALL      'TR071R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    XLI2
     C                   PARM                    WXMN
     C                   PARM                    WXMNSK
     C                   PARM                    TVMN
     C                   PARM                    TVMNSK
     C                   PARM                    UIN27
     C                   END
      *
     C   54LINNBR        IFEQ      8
     C     POSNBR        ANDGE     61
     C     POSNBR        ANDLE     77
     C                   MOVE      *BLANKS       WXCNR            17
S02  C*                  MOVE      '1'           UIN272            1
N02  C                   MOVE      'DSP'         UTYPE             3
     C                   CALL      'TR070R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WXCNR
     C                   PARM                    TVCNR
S02  C*                  PARM                    UIN272
N02  C                   PARM                    UTYPE
     C                   END
      *
     C   56LINNBR        IFEQ      9
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     35
     C                   MOVE      '1'           UIN272            1
     C                   CALL      'TR075R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WSEH
     C                   PARM                    WSNT
     C                   PARM                    WSNTEH
     C                   PARM                    WSMN
     C                   PARM                    WSMNSK
     C                   PARM                    TVEH
     C                   PARM                    TVNT
     C                   PARM                    TVMN
     C                   PARM                    TVMNSK
     C                   PARM                    UIN272
     C                   END
N02   *
N02  C     LINNBR        IFEQ      16
N02  C     POSNBR        ANDGE     10
N02  C     POSNBR        ANDLE     79
N02  C   27              MOVE      'DSP'         UTYPE             3
N02  C  N27              MOVE      'CHG'         UTYPE
N02  C                   CALL      'TR076R'
N02  C                   PARM                    TVAVD
N02  C                   PARM                    TVTDN
N02  C                   PARM                    WSLI
N02  C                   PARM                    WSVT
N02  C                   PARM                    TVVT
N02  C                   PARM                    UTYPE
N02  C                   END
      *
     C     LINNBR        IFGE      18
     C     LINNBR        ANDLE     19
     C                   CALL      'TR072R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WSDTY
     C                   PARM                    WSDREF
     C                   PARM                    WSDSK
     C                   PARM                    WSDO
     C                   PARM                    WSDOSK
     C                   PARM                    TVDTY
     C                   PARM                    TVDREF
     C                   PARM                    TVDSK
     C                   PARM                    TVDO
     C                   PARM                    TVDOSK
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     51
     C                   CALL      'TR071R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    XLI2
     C                   PARM                    WSMN
     C                   PARM                    WSMNSK
     C                   PARM                    TVMN
     C                   PARM                    TVMNSK
     C                   PARM                    UIN27
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     61
     C     POSNBR        ANDLE     77
N02  C   27              MOVE      'DSP'         UTYPE             3
N02  C  N27              MOVE      'CHG'         UTYPE
     C                   CALL      'TR070R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WSCNR
     C                   PARM                    TVCNR
S02  C*                  PARM                    UIN27
N02  C                   PARM                    UTYPE
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     35
     C                   CALL      'TR075R'
     C                   PARM                    TVAVD
     C                   PARM                    TVTDN
     C                   PARM                    WSLI
     C                   PARM                    WSEH
     C                   PARM                    WSNT
     C                   PARM                    WSNTEH
     C                   PARM                    WSMN
     C                   PARM                    WSMNSK
     C                   PARM                    TVEH
     C                   PARM                    TVNT
     C                   PARM                    TVMN
     C                   PARM                    TVMNSK
     C                   PARM                    UIN27
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVTRW        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   SETON                                        40
      *
     C                   MOVE      TVLI          WSLI
     C     NVCT          IFEQ      *BLANKS
     C                   MOVE      TVVNT         WSVNT
     C                   MOVE      TVVNT         WSVNTI
N04  C                   MOVE      '0'           WSVNT
N04  C                   MOVE      '0'           WSVNTI
S02  C*                  MOVE      TVVT48        WSVT
N02  C                   MOVE      TVVT          WSVT
     C                   MOVE      TVVTSK        WSVTSK
     C                   MOVE      TVVKTB        WSVKTB
     C                   MOVE      TVVKTN        WSVKTN
     C                   MOVE      TVCNR         WSCNR
     C                   MOVE      TVDTY         WSDTY
     C                   MOVE      TVDREF        WSDREF
     C                   MOVE      TVDSK         WSDSK
     C                   MOVE      TVDO          WSDO
     C                   MOVE      TVDOSK        WSDOSK
     C                   EVAL      WSMN = TVMN
     C                   MOVE      TVMNSK        WSMNSK
     C                   MOVE      TVEH          WSEH
     C                   MOVE      TVNT          WSNT
     C                   MOVE      TVNTEH        WSNTEH
     C                   MOVE      TVFV          WSFV
     C                   MOVE      TVFVNT        WSFVNT
     C                   MOVE      *BLANKS       WSCT
     C                   MOVE      *BLANKS       WSCTB
     C                   MOVE      *BLANKS       WSCTSK
     C                   ELSE
     C                   MOVE      NVVNT         WSVNT
     C                   MOVE      NVVNT         WSVNTI
     C                   MOVE      NVVT          WSVT
     C                   MOVE      NVVTSK        WSVTSK
     C                   MOVE      NVVKTB        WSVKTB
     C                   MOVE      NVVKTN        WSVKTN
     C                   MOVE      NVCNR         WSCNR
     C                   MOVE      NVDTY         WSDTY
     C                   MOVE      NVDREF        WSDREF
     C                   MOVE      NVDSK         WSDSK
     C                   MOVE      NVDO          WSDO
     C                   MOVE      NVDOSK        WSDOSK
     C                   EVAL      WSMN = NVMN
     C                   MOVE      NVMNSK        WSMNSK
     C                   MOVE      NVEH          WSEH
     C                   MOVE      NVNT          WSNT
     C                   MOVE      NVNTEH        WSNTEH
     C                   MOVE      NVFV          WSFV
     C                   MOVE      NVFVNT        WSFVNT
     C                   MOVE      NVCT          WSCT
     C                   MOVE      NVCTB         WSCTB
     C                   MOVE      NVCTSK        WSCTSK
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWTR        BEGSR
     C***********************************************
     C                   MOVE      'N'           TV01
     C                   MOVE      WSLI          TVLI
     C                   MOVE      WSVNT         NVVNT
     C                   MOVE      WSVT          NVVT
     C                   MOVE      WSVTSK        NVVTSK
     C                   MOVE      WSVKTB        NVVKTB
     C                   MOVE      WSVKTN        NVVKTN
     C                   MOVE      WSCNR         NVCNR
     C                   MOVE      WSDTY         NVDTY
     C                   MOVE      WSDREF        NVDREF
     C                   MOVE      WSDSK         NVDSK
     C                   MOVE      WSDO          NVDO
     C                   MOVE      WSDOSK        NVDOSK
     C                   EVAL      NVMN = WSMN
     C                   MOVE      WSMNSK        NVMNSK
     C                   MOVE      WSEH          NVEH
     C                   MOVE      WSNT          NVNT
     C                   MOVE      WSNTEH        NVNTEH
     C                   MOVE      WSFV          NVFV
     C                   MOVE      WSFVNT        NVFVNT
     C     TVVT          IFEQ      *BLANKS
     C                   MOVE      'NE'          NVCT
     C                   ELSE
     C                   MOVE      WSCT          NVCT
     C                   END
     C                   MOVE      WSCTB         NVCTB
     C                   MOVE      WSCTSK        NVCTSK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       TV01
     C                   MOVE      TVVNT         NVVNT
N04  C                   MOVE      '0'           NVVNT
S02  C*                  MOVE      TVVT48        NVVT
N02  C                   MOVE      TVVT          NVVT
     C                   MOVE      TVVTSK        NVVTSK
     C                   MOVE      TVVKTB        NVVKTB
     C                   MOVE      TVVKTN        NVVKTN
     C                   MOVE      TVCNR         NVCNR
     C                   MOVE      TVDTY         NVDTY
     C                   MOVE      TVDREF        NVDREF
     C                   MOVE      TVDSK         NVDSK
     C                   MOVE      TVDO          NVDO
     C                   MOVE      TVDOSK        NVDOSK
     C                   MOVE      TVMN          NVMN
     C                   MOVE      TVMNSK        NVMNSK
     C                   MOVE      TVEH          NVEH
     C                   MOVE      TVNT          NVNT
     C                   MOVE      TVNTEH        NVNTEH
     C                   MOVE      TVFV          NVFV
     C                   MOVE      TVFVNT        NVFVNT
     C                   MOVE      *BLANKS       NVCT
     C                   MOVE      *BLANKS       NVCTB
     C                   MOVE      *BLANKS       NVCTSK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   CLEAR                   TRILR
     C                   MOVEA     '000'         *IN(42)
     C                   MOVEA     '000'         *IN(52)
     C                   MOVE      *BLANKS       WSCT
     C                   MOVE      *BLANKS       WSCTSK
     C                   MOVE      *BLANKS       WSCTB
      *
     C                   MOVE      *ZEROS        WSLI
     C                   MOVE      *ZEROS        WSVNT
     C                   MOVE      *BLANKS       WSVNTI
     C                   MOVE      *BLANKS       WSVT
     C                   MOVE      *BLANKS       WSVTSK
     C                   MOVE      *ZEROS        WSVKTB
     C                   MOVE      *ZEROS        WSVKTN
     C                   MOVE      *BLANKS       WSCNR
     C                   MOVE      *BLANKS       WSDTY
     C                   MOVE      *BLANKS       WSDREF
     C                   MOVE      *BLANKS       WSDSK
     C                   MOVE      *BLANKS       WSDO
     C                   MOVE      *BLANKS       WSDOSK
     C                   MOVE      *BLANKS       WSMN
     C                   MOVE      *BLANKS       WSMNSK
     C                   MOVE      *BLANKS       WSEH
     C                   MOVE      *ZEROS        WSNT
     C                   MOVE      *ZEROS        WSNTEH
     C                   MOVE      *BLANKS       WSFV
     C                   MOVE      *ZEROS        WSFVNT
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB3         BEGSR
     C***********************************************
     C                   MOVE      'N'           TV01
S01  C*                  MOVE      *ZEROS        TVDK
N01  C                   MOVE      *BLANKS       TVDK
S04  C*                  MOVE      *BLANKS       TVVNT
N04  C                   MOVE      *ZEROS        TVVNT
     C                   MOVE      *BLANKS       TVVT
     C                   MOVE      *BLANKS       TVVTSK
     C                   MOVE      *ZEROS        TVVKTB
     C                   MOVE      *ZEROS        TVVKTN
     C                   MOVE      *BLANKS       TVALK
     C                   MOVE      *BLANKS       TVBLK
     C                   MOVE      *BLANKS       TVCNR
     C                   MOVE      *BLANKS       TVDTY
     C                   MOVE      *BLANKS       TVDREF
     C                   MOVE      *BLANKS       TVDSK
     C                   MOVE      *BLANKS       TVDO
     C                   MOVE      *BLANKS       TVDOSK
     C                   MOVE      *BLANKS       TVTLO
     C                   MOVE      *ZEROS        TVEXKD
     C                   MOVE      *BLANKS       TVEXLK
     C                   MOVE      *BLANKS       TVMN
     C                   MOVE      *BLANKS       TVMNSK
     C                   MOVE      *BLANKS       TVEH
     C                   MOVE      *ZEROS        TVNT
     C                   MOVE      *ZEROS        TVNTEH
     C                   MOVE      *BLANKS       TVFV
     C                   MOVE      *ZEROS        TVFVNT
     C                   MOVE      'NE'          NVCT
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C   03              Z-ADD     3             UFLAGG            1 0
      *
     C     UIN27         IFEQ      '0'
     C                   MOVE      '044'         U1N07
     C                   MOVE      '1'           UIN34
     C                   CALL      'TR063R'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C     UFLAGG        COMP      1                                      12
     C                   END
      *
     C     SLPRT         ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     17
     C                   CALL      'SAD010A'
     C                   PARM                    WSVNTI
     C                   PARM                    UIDAG
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
S02  C*    LINNBR        IFEQ      16
N02  C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     70
     C     POSNBR        ANDLE     71
     C                   MOVE      '012'         UUNIK             3
     C                   MOVE      *BLANKS       UKODE            10
     C                   MOVEL     WSVTSK        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSVTSK
S02  C*                  Z-ADD     18            LINNBR
N02  C                   Z-ADD     17            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     12
     C                   MOVE      '013'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDTY         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSDTY
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     61
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDSK         UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSDSK
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     51
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSDOSK        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSDOSK
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     10            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     53
     C     POSNBR        ANDLE     54
     C                   MOVE      '012'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSMNSK        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK             3
     C                   PARM                    UKODE            10
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSMNSK
     C                   Z-ADD     61            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     11
     C                   MOVE      '017'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVEL     WSEH          UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2            3
     C                   MOVEL     UKODE         WSEH
     C                   Z-ADD     19            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     TRHK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     TRVK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    WSLI
     C     TRVKMN        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    WSLI
     C                   KFLD                    XLI2              3 0
     C     TRV1K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LI
     C     TRVK2         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    TVLI
     C     TRV2K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3VNT
     C     TRV21         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     TARIK         KLIST
     C                   KFLD                    WSVNT
     C                   KFLD                    X2TAR
      *
     C     *ENTRY        PLIST
     C     UPARM2        PARM      UPARM2        UPARM1          128
     C                   PARM                    UFLAGG            1 0
      *
     C                   MOVE      UIN27         *IN27
     C                   MOVE      *ZEROS        XLI
      *
     C                   MOVE      *ZEROS        TVLI
     C                   MOVE      *BLANKS       X2TAR             3
     C                   MOVE      *ZEROS        WSVNT
     C                   MOVE      *ZEROS        TVVNT
     C                   MOVE      *BLANKS       TVVT
     C                   MOVE      'N'           USPED             1
     C                   MOVEA     '01'          *IN(31)
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           UIDAG             8 0
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   MOVEA     '00000'       *IN(42)
     C                   MOVEA     '00000'       *IN(52)
S06  C*                  MOVE      NVDTY         X1DTY             3
N06  C                   MOVE      NVDTY         X1DTY             4
     C                   MOVE      NVDREF        X1DREF           35
     C                   MOVE      NVDSK         X1DSK             2
     C                   MOVE      NVDO          X1DO             26
     C                   MOVE      NVDOSK        X1DOSK            2
S06  C*                  MOVE      TVDTY         X2DTY             3
N06  C                   MOVE      TVDTY         X2DTY             4
     C                   MOVE      TVDREF        X2DREF           35
     C                   MOVE      TVDSK         X2DSK             2
     C                   MOVE      TVDO          X2DO             26
     C                   MOVE      TVDOSK        X2DOSK            2
     C                   MOVE      NVMN          X1MN             42
     C                   MOVE      NVMNSK        X1MNSK            2
     C                   MOVE      TVMN          X2MN             42
     C                   MOVE      TVMNSK        X2MNSK            2
     C                   MOVE      NVCNR         X1CNR            17
     C                   MOVE      TVCNR         X2CNR            17
     C                   MOVE      NVEH          X1EH              2
     C                   MOVE      NVNT          X1NT              5 0
     C                   MOVE      NVNTEH        X1NTEH            5 0
     C                   MOVE      TVEH          X2EH              2
     C                   MOVE      TVNT          X2NT              5 0
     C                   MOVE      TVNTEH        X2NTEH            5 0
N02  C                   MOVE      NVVT          X1VT             70
N02  C                   MOVE      TVVT          X2VT             70
      *** TEST OM FLERE DOKUMENTER (RUBR. 44) FINNES
     C     TRVK          SETLL     TRILDK
     C     TRVK          READE(N)  TRILDK                                 33
     C  N42
     CORN52*IN33         DOWEQ     '0'
     C  N42NVDTY         COMP      *BLANKS                            4242
     C  N52TVDTY         COMP      *BLANKS                            5252
     C     TRVK          READE(N)  TRILDK                                 33
     C  N33              END
      *** TEST OM FLERE MERKE & NR (RUBR. 31) FINNES
     C     TRVKMN        SETLL     TRILMN
     C     TRVKMN        READE(N)  TRILMN                                 33
     C  N43
     CORN53*IN33         DOWEQ     '0'
     C  N43NVMN          COMP      *BLANKS                            4343
     C  N53TVMN          COMP      *BLANKS                            5353
     C     TRVKMN        READE(N)  TRILMN                                 33
     C  N33              END
      *** TEST OM FLERE CONTAINERNR (RUBR. 31) FINNES
     C     TRVK          SETLL     TRILCN
     C     TRVK          READE(N)  TRILCN                                 33
     C  N44
     CORN54*IN33         DOWEQ     '0'
     C  N44NVCNR         COMP      *BLANKS                            4444
     C  N54TVCNR         COMP      *BLANKS                            5454
     C     TRVK          READE(N)  TRILCN                                 33
     C  N33              END
      *** TEST OM FLERE ENHETER
     C     TRVK          SETLL     TRILKL
     C     TRVK          READE(N)  TRILKL                                 33
     C  N46
     CORN56*IN33         DOWEQ     '0'
     C  N46NVEH          COMP      *BLANKS                            4646
     C  N56TVEH          COMP      *BLANKS                            5656
     C     TRVK          READE(N)  TRILKL                                 33
     C  N33              END
N02   *** TEST OM FLERE VAREBESKRIVELSE FINNES
N02  C     TRVK          SETLL     TRILVT
N02  C     TRVK          READE(N)  TRILVT                                 33
N02  C  N47
N02  CORN57*IN33         DOWEQ     '0'
N02  C  N47NVVT          COMP      *BLANKS                            4747
N02  C  N57TVVT          COMP      *BLANKS                            5757
N02  C     TRVK          READE(N)  TRILVT                                 33
N02  C  N33              END
      *
     C                   MOVE      X1DTY         NVDTY
     C                   MOVE      X1DREF        NVDREF
     C                   MOVE      X1DSK         NVDSK
     C                   MOVE      X1DO          NVDO
     C                   MOVE      X1DOSK        NVDOSK
     C                   MOVE      X2DTY         TVDTY
     C                   MOVE      X2DREF        TVDREF
     C                   MOVE      X2DSK         TVDSK
     C                   MOVE      X2DO          TVDO
     C                   MOVE      X2DOSK        TVDOSK
     C                   MOVE      X1MN          NVMN
     C                   MOVE      X1MNSK        NVMNSK
     C                   MOVE      X2MN          TVMN
     C                   MOVE      X2MNSK        TVMNSK
     C                   MOVE      X1CNR         NVCNR
     C                   MOVE      X2CNR         TVCNR
     C                   MOVE      X1EH          NVEH
     C                   MOVE      X1NT          NVNT
     C                   MOVE      X1NTEH        NVNTEH
     C                   MOVE      X2EH          TVEH
     C                   MOVE      X2NT          TVNT
     C                   MOVE      X2NTEH        TVNTEH
N02  C                   MOVE      X1VT          NVVT
N02  C                   MOVE      X2VT          TVVT
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTOPL        BEGSR
     C***********************************************
     C     TRVK          SETLL     TRILDK
     C     TRVK          READE     TRILDK                                 33
     C     *IN33         DOWEQ     '0'
     C     TVDTY         IFEQ      *BLANKS
     C                   DELETE    TRILDKR
     C                   ELSE
     C                   MOVE      TVDTY         NVDTY
     C                   MOVE      TVDREF        NVDREF
     C                   MOVE      TVDSK         NVDSK
     C                   MOVE      TVDO          NVDO
     C                   MOVE      TVDOSK        NVDOSK
     C                   UPDATE    TRILDKR
     C                   END
     C     TRVK          READE     TRILDK                                 33
     C  N33              END
      *
     C     TRVK          SETLL     TRILMN
     C     TRVK          READE     TRILMN                                 33
     C     *IN33         DOWEQ     '0'
     C     TVMN          IFEQ      *BLANKS
     C                   DELETE    TRILMNR
     C                   ELSE
     C                   MOVE      TVMN          NVMN
     C                   MOVE      TVMNSK        NVMNSK
     C                   UPDATE    TRILMNR
     C                   END
     C     TRVK          READE     TRILMN                                 33
     C  N33              END
      *
     C     TRVK          SETLL     TRILCN
     C     TRVK          READE     TRILCN                                 33
     C     *IN33         DOWEQ     '0'
     C     TVDTY         IFEQ      *BLANKS
     C                   DELETE    TRILCNR
     C                   ELSE
     C                   MOVE      TVCNR         NVCNR
     C                   UPDATE    TRILCNR
     C                   END
     C     TRVK          READE     TRILCN                                 33
     C  N33              END
      *
      *
     C     TRVK          SETLL     TRILKL
     C     TRVK          READE     TRILKL                                 33
     C     *IN33         DOWEQ     '0'
     C     TVEH          IFEQ      *BLANKS
     C                   DELETE    TRILKLR
     C                   ELSE
     C                   MOVE      TVEH          NVEH
     C                   MOVE      TVNT          NVNT
     C                   MOVE      TVNTEH        NVNTEH
     C                   UPDATE    TRILKLR
     C                   END
     C     TRVK          READE     TRILKL                                 33
     C  N33              END
N02   *
N02  C     TRVK          SETLL     TRILVT
N02  C     TRVK          READE     TRILVT                                 33
N02  C     *IN33         DOWEQ     '0'
N02  C     TVVT          IFEQ      *BLANKS
N02  C                   DELETE    TRILVTR
N02  C                   ELSE
N02  C                   MOVE      TVVT          NVVT
N02  C                   UPDATE    TRILVTR
N02  C                   END
N02  C     TRVK          READE     TRILVT                                 33
N02  C  N33              END
      *
     C                   ENDSR
      *
