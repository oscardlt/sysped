/* DENNE LAGRER PDF AV  TRANSP.AVREGNING */
/* VEDLEGG J/N  SYTR12PH                 */
/*                         */
             PGM        PARM(&FANR &TNR &AVD &STMF &BANE &BANEA +
                          &VISE &INFOP &VEDL)
             DCL        VAR(&INFOP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PRIMAI) TYPE(*CHAR) LEN(1) VALUE('A') /* +
                          PRINT/MAIL KALL */
             DCL        VAR(&PRT) TYPE(*CHAR) LEN(10) +
                          VALUE('OUTMAIL') /* Printernavn */
             DCL        VAR(&VISE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&SPES) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FANR) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&JOB) TYPE(*CHAR) LEN(9)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILEN) TYPE(*CHAR) LEN(10) +
                          VALUE('SYTR23PF')
             DCL        VAR(&FILENA) TYPE(*CHAR) LEN(10) +
                          VALUE('SYTR12PH')
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&BANE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&BANEA) TYPE(*CHAR) LEN(50)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(152)
             DCL        VAR(&FHE) TYPE(*CHAR) LEN(1) VALUE('A') /* +
                          HEADING */
             DCL        VAR(&VEDL) TYPE(*CHAR) LEN(1) /*VEDLEGG */
             DCL        VAR(&SG) TYPE(*CHAR) LEN(3) /* SIGNATUR */
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4) /*AVD*/
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(7) +
                          VALUE('DIV0000') /*MELDING OM FORIGE UTSKRIFT*/
             DCL        VAR(&TNR) TYPE(*DEC) LEN(8 0)  /*TRANSP*/
             DCL        VAR(&PER) TYPE(*DEC) LEN(2 0) VALUE(0) /*PERMND*/
             DCL        VAR(&AAR) TYPE(*DEC) LEN(2 0) /*PERÅR    */
             DCL        VAR(&ALFA) TYPE(*CHAR) LEN(1) /*SORTERING*/
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QJOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&QNBR) TYPE(*CHAR) LEN(6)
             RTVJOBA    JOB(&QJOB) USER(&QUSER) NBR(&QNBR)
/*                                         */
/*           SKJEKK OM PDF FINNES FRA FØR  */
/*                                         */
             OVRPRTF    FILE(QSYSPRT) OUTQ(OUTMAIL)
             DSPLNK     OBJ(&BANE) OUTPUT(*PRINT) OBJTYPE(*STMF) +
                          DETAIL(*NAME) DSPOPT(*USER)
             MONMSG     MSGID(CPFA0A9) EXEC(GOTO CMDLBL(VIDERE))
             DLTSPLF    FILE(QSYSPRT) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             RETURN
    /*                                    */
    /* SKRIVER UT AVREGNINGSKOPI          */
    /*                                    */
 VIDERE:     OVRPRTF    FILE(SYTR23PF) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          80) CPI(10) OVRFLW(72) FRONTOVL(LOGOFAKT) +
                          OUTQ(OUTMAIL)
/* ARBEIDSLISTE   */
             OVRPRTF    FILE(SYTR12PH) DEVTYPE(*AFPDS) PAGESIZE(72 +
                          120) CPI(15) OVRFLW(67) PRTQLTY(*DRAFT) +
                          FRONTOVL(LOGOFAKT) OUTQ(OUTMAIL)
 /* FIKSER WORKFILE */
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &QNBR)
             RMVM       FILE(WRKTAVR) MBR(&UNIK)
             MONMSG     MSGID(CPF7310)
             ADDPFM     FILE(WRKTAVR) MBR(&UNIK)
             MONMSG     MSGID(CPF7306) EXEC(GOTO CMDLBL(SLUTT))
             OVRDBF     FILE(WRKTAVR) TOFILE(WRKTAVR) MBR(&UNIK) +
                          FRCRATIO(1)
             CALL       PGM(SYTR23) PARM(&AVD &SG &FHE &VEDL +
                          &TNR &AAR &PER &ALFA &FANR &PRIMAI)
/*                                       */
/* KALLER PROGRAMMET SOM LAGER PDF       */
/*                                       */
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANE) ORIENTAT(*V)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
             CHGVAR     VAR(&FILEN) VALUE('SYTR23PF')
             CALL       PGM(INF001CL) PARM(&FILEN &QNBR &QUSER &QJOB +
                          &BANE)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             IF         COND(&VISE = 'J') THEN(DO)
             CALL       PGM(PDF001) PARM(&STMF)
             ENDDO
             DLTSPLF    FILE(&FILEN) JOB(&QNBR/&QUSER/&QJOB) +
                          SPLNBR(*LAST)
             MONMSG     MSGID(CPF0000)
/*                                       */
/* KALLER PROGRAMMET SOM LAGER PDF       */
/* AV ARBEDSLISTEN                       */
/*                                       */
             IF         COND(&VEDL = 'J') THEN(DO)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             IF         COND(&INFOP = 'N') THEN(DO)
             CVTSPLFPDF SPLF(&FILENA) JOB(&QNBR/&QUSER/&QJOB) +
                          TOPDF(&BANEA) ORIENTAT(*V)
                          ENDDO
             IF         COND(&INFOP = 'J') THEN(DO)
             CALL       PGM(INF001CL) PARM(&FILENA &QNBR &QUSER &QJOB +
                          &BANEA)
                          ENDDO
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
                          ENDDO
 SLUTT:      ENDPGM
