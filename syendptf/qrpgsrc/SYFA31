      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE/SPØRRE FRITEKST TIL OPPD. ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07-11 13-24             ***
      *** LEDIGE INDIKATORER 31 32 35-39 41-89 95-97          ***
      *** IND. 27 PÅ = SPØRRING   27 AV = VEDLIKEHOLD         ***
      *** IND. 28 PÅ = KUN ENDRING VED VEDLIKEHOLD            ***
      *** IND. 29 PÅ = SJØ-SPEDISJON  29 AV = LAND/FLY-SPED.  ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 EGET FELT FOR LEST GODL/MERKNAD OG FOR LEST PDA-MELDING
10XXX * 02 JOV PTF10 ???
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  XXX * 03 JOV PTF11 kluss med switch mellom lest/ulest
  XXX * 04 SH  PTF12 ikke sett på LR ved U
********************************************************************
      *
     FFREETXT1  UF A E           K DISK
     FFRTIND    IF   E           K DISK
     F                                     RENAME(FREETXTR:FRTINDR)
     FKODTA     IF   E           K DISK
     FKODTFT    IF   E           K DISK
     FHEADF     IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYFA31FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D WF              S              6  0 DIM(20)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  FRTDTÅ                 1      4  0
     D  FRTDTM                 5      6  0
     D  FRTDTD                 7      8  0
     D  FRTDT                  1      8  0
     D                 DS
     D  YDTÅ                   1      4  0
     D  YDTM                   5      6  0
     D  YDTD                   7      8  0
     D  YDT                    1      8  0
     D                 DS
     D  WSTX01                 1     70
     D  WSTX02                71    140
     D  WSTX03               141    210
     D  WSTX04               211    280
     D  WSTX05               281    350
     D  WSTX06               351    420
     D  WSTX07               421    490
     D  WSTX08               491    560
     D  WSTX09               561    630
     D  WSTX10               631    700
     D  WSTX11               701    770
     D  WSTX12               771    840
     D  WSTX13               841    910
     D  WSTX14               911    980
     D  WSTX15               981   1050
     D  WSTX16              1051   1120
     D  WSTX17              1121   1190
     D  WSTX18              1191   1260
     D  WSTX19              1261   1330
     D  WSTX20              1331   1400
     D  WT                     1   1400    DIM(20) ASCEND
     D                 DS
     D  XSTX01                 1     70
     D  W2TX01                 1     37
     D  W3TX01                38     70
     D  XSTX02                71    140
     D  W2TX02                71    107
     D  W3TX02               108    140
     D  XSTX03               141    210
     D  W2TX03               141    177
     D  W3TX03               178    210
     D  XSTX04               211    280
     D  W2TX04               211    247
     D  W3TX04               248    280
     D  XSTX05               281    350
     D  W2TX05               281    317
     D  W3TX05               318    350
     D  XSTX06               351    420
     D  W2TX06               351    387
     D  W3TX06               388    420
     D  XSTX07               421    490
     D  W2TX07               421    457
     D  W3TX07               458    490
     D  XSTX08               491    560
     D  W2TX08               491    527
     D  W3TX08               528    560
     D  XSTX09               561    630
     D  W2TX09               561    597
     D  W3TX09               598    630
     D  XSTX10               631    700
     D  W2TX10               631    667
     D  W3TX10               668    700
     D  XSTX11               701    770
     D  W2TX11               701    737
     D  W3TX11               738    770
     D  XSTX12               771    840
     D  W2TX12               771    807
     D  W3TX12               808    840
     D  XSTX13               841    910
     D  W2TX13               841    877
     D  W3TX13               878    910
     D  XSTX14               911    980
     D  W2TX14               911    947
     D  W3TX14               948    980
     D  XSTX15               981   1050
     D  W2TX15               981   1017
     D  W3TX15              1018   1050
     D  XSTX16              1051   1120
     D  W2TX16              1051   1087
     D  W3TX16              1088   1120
     D  XSTX17              1121   1190
     D  W2TX17              1121   1157
     D  W3TX17              1158   1190
     D  XSTX18              1191   1260
     D  W2TX18              1191   1227
     D  W3TX18              1228   1260
     D  XSTX19              1261   1330
     D  W2TX19              1261   1297
     D  W3TX19              1298   1330
     D  XSTX20              1331   1400
     D  W2TX20              1331   1367
     D  W3TX20              1368   1400
     D  XT                     1   1400    DIM(20) ASCEND
     D                 DS
     D  WKOD01                 1      1
     D  WKOD02                 2      2
     D  WKOD03                 3      3
     D  WKOD04                 4      4
     D  WKOD05                 5      5
     D  WKOD06                 6      6
     D  WKOD07                 7      7
     D  WKOD08                 8      8
     D  WKOD09                 9      9
     D  WKOD10                10     10
     D  WKOD11                11     11
     D  WKOD12                12     12
     D  WKOD13                13     13
     D  WKOD14                14     14
     D  WKOD15                15     15
     D  WKOD16                16     16
     D  WKOD17                17     17
     D  WKOD18                18     18
     D  WKOD19                19     19
     D  WKOD20                20     20
     D  WK                     1     20    DIM(20) ASCEND
     D                 DS
     D  WKO001                 1      2
     D  WKO002                 3      4
     D  WKO003                 5      6
     D  WKO004                 7      8
     D  WKO005                 9     10
     D  WKO006                11     12
     D  WKO007                13     14
     D  WKO008                15     16
     D  WKO009                17     18
     D  WKO010                19     20
     D  WKO011                21     22
     D  WKO012                23     24
     D  WKO013                25     26
     D  WKO014                27     28
     D  WKO015                29     30
     D  WKO016                31     32
     D  WKO017                33     34
     D  WKO018                35     36
     D  WKO019                37     38
     D  WKO020                39     40
     D  WKO                    1     40    DIM(20) ASCEND
     D  WKOTST                 1     40
     C*
     C                   EXSR      INIT
     C   03              GOTO      SLUTT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        XDT               8 0
     C                   MOVE      '!'           XKOD              1
     C                   MOVE      'J'           XFØRST            1
N01  C                   MOVE      'N'           TRALIN            1
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     FRTKI         SETLL     FRTIND
     C                   SETOFF                                       94
     C     FRTKI         READE     FRTIND                                 94
     C  N27FØRSTE        IFNE      'N'
     C   94              MOVE      'J'           LAGDNÅ            1
     C   94              SETON                                        06
     C   94              GOTO      LAGE
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        51
      * 28 ON=POST PÅ DAGENS DATO FINNES - F6 IKKE TILLATT
     C  N27
     CANN28FRTDT         COMP      XUDATE                                 28
      * OPTION/DATO VISES BARE FOR HVER NY PART/DATO
     C  N94
     CANN27FRTDT         IFEQ      XDT
     C     FRTKOD        ANDEQ     XKOD
     C                   SETON                                        55
     C                   ELSE
     C                   SETOFF                                       55
     C                   END
     C                   ADD       1             ZRECNO
     C                   MOVEL     FRTTXT        WSTXT
     C                   MOVE      FRTKOD        WSKODE
     C                   MOVE      FRTDTD        WSDTD
     C                   MOVE      FRTDTM        WSDTM
     C                   MOVE      FRTDTÅ        WSDTÅ
     C                   EXSR      KDTFMT
     C                   MOVE      FRTDT         XDT               8 0
     C                   MOVE      FRTKOD        XKOD              1
S02  C* flyttet          WRITE     SUBFIL
      * TRANSPMODUL:  MARKER MED * AT GOSLISTE-KOMMENTAR ER LEST.
S01  C*    FRTKOD        IFEQ      'G'
S01  C*    LAGDNÅ        ANDNE     'J'
S01  C*                  MOVE      FRTDT         YDT
S01  C*                  MOVE      FRTLI         YLI
S01  C*    FRTK          CHAIN     FREETXT1                           34
S01  C* N34              MOVE      '.'           FRTTXT
S01  C* N34              UPDATE    FREETXTR
S01  C*                  END
N02  c*                  setoff                                       81
N03  c                   setoff                                       8182
N01  C     FRTKOD        IFEQ      'G'
N01  C     FRTLES        ANDEQ     ' '
N02  c                   seton                                        81
N01  C                   MOVE      'J'           TRALIN            1
N01  C                   MOVE      FRTDT         YDT
N01  C                   END
N03  C     FRTKOD        IFEQ      'P'
N03  C     FRTLES        ANDEQ     ' '
N03  c                   seton                                        82
N03  C                   MOVE      'J'           PDALIN            1
N03  C                   MOVE      FRTDT         YDT
N03  C                   END
      *
N02  C                   WRITE     SUBFIL
     C     UAVD          READE     FRTIND                                 94
     C  N94UOPD          COMP      FRTOPD                             9494
     C  N94              END
     C                   END
     C*
     C*
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   MOVE      'J'           LAGDNÅ            1
     C     XFØRST        IFEQ      'J'
     C     ZRECNO        ANDGT     0
     C                   Z-ADD     1             ZRECNO
     C                   MOVE      'N'           XFØRST
     C                   END
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C     XRECN2        IFNE      0
     C     XRECN2        ANDLT     YRECNO
     C                   MOVE      XRECN2        ZRECNO
     C                   END
     C                   MOVE      *ZEROS        XRECN2
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C*
     C                   SETOFF                                       999830
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
     C*** LAGE
     C     LAGE          TAG
     C   06              DO
     C                   MOVE      'N'           FØRSTE            1
     C                   Z-ADD     1             WSSIDE
     C                   MOVE      UYEAR         WSDTÅ
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          YDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          YDTÅ
     C                   END
     C                   EXSR      KDTFMT
     C  N29              MOVE      *BLANKS       WT
     C   29              MOVE      *BLANKS       XT
     C                   MOVE      *ZEROS        WF
     C                   MOVE      *BLANKS       WK
     C                   MOVE      *BLANKS       WKO
     C                   SETOFF                                       40
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START5
     C                   END
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTS
     C   03              GOTO      SLUTT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
N04  C     merkle        ifeq      'J'
N04  c                   move      'N'           merkle
N04  c                   goto      start
N04  c                   end
     C   05
     COR 12              GOTO      START
     C                   GOTO      START3
     C*
     C*** LAGE
     C     START5        TAG
     C                   MOVE      'N'           PDALIN            1
N01  C                   MOVE      'N'           TRALIN            1
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C   04              DO
      * SØK PÅ DOKUMENTKODER...
     C     POSNBR        IFEQ      2
     C                   MOVEL     'FRTKOD'      XKFTYP           10
     C                   MOVE      'N'           UUPDAT            1
     C                   MOVE      *BLANKS       XKFKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    XKFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XKFKOD
     C     LINNBR        IFGT      2
     C     LINNBR        ANDLT     23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVEL     XKFKOD        WK(SS)
     C                   END
     C                   Z-ADD     10            POSNBR
     C                   GOTO      START5
     C                   END
     C* ELLES SØK PÅ PREDEFINERTE TEKSTKODER
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   Z-ADD     0             UFLAGG
     C     LINNBR        IFGT      2
     C     LINNBR        IFLT      23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVE      WSKF          WKO(SS)
     C                   END
     C                   END
     C                   GOTO      START5
     C                   END
      *
     C                   SETOFF                                       9030
     C   10WSSIDE        IFEQ      5
     C                   GOTO      START5
     C                   ELSE
     C  N29BLAN70        LOOKUP    WT                                 33
     C   29BLAN70        LOOKUP    XT                                 33
     C   33              EXSR      TESTB1
     C   33              ADD       1             WSSIDE
     C   33              EXSR      MOVFRW
     C                   GOTO      START5
     C                   END
     C  N12              DO
     C                   EXSR      TESTB1
     C     FREE          IFEQ      'N'
     C  N03              GOTO      START
     C                   ELSE
     C                   GOTO      START5
     C                   END
     C                   END
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     4             POSNBR
     C  N03              GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      'N'           FREE              1
     C     WKOTST        IFNE      *BLANKS
     C                   MOVE      'J'           FREE
     C                   EXSR      FIXKOD
     C                   END
     C   29              MOVEA     XT            WT
     C                   Z-ADD     1             XN                2 0
     C     XN            DOWLE     20
     C     WT(XN)        IFNE      *BLANKS
     C                   GOTO      STTB1
     C                   END
     C                   ADD       1             XN
     C                   END
     C                   SETON                                        9030
     C                   MOVE      'SPT0040'     MSGNR
     C                   GOTO      SLTB1
     C*
     C     STTB1         TAG
      *
     C                   MOVE      *ZEROS        XN2
     C     WT(1)         IFEQ      *BLANKS
     C                   MOVE      ' '           WK(1)
     C                   END
     C     2             DO        20            XN
     C                   ADD       1             XN2
     C     WT(XN)        IFEQ      *BLANKS
     C     WK(XN)        ANDNE     *BLANKS
     C     WK(XN)        ANDNE     WK(XN2)
     C                   MOVE      ' '           WK(XN)
     C                   END
     C                   END
      *
     C     WSDTD         IFEQ      UDAY
     C     WSDTM         ANDEQ     UMONTH
     C     WSDTÅ         ANDEQ     UYEAR
     C                   SETON                                        28
     C                   END
     C     WSSIDE        SUB       1             YLI
     C     YLI           MULT      20            YLI
     C     WSSIDE        IFEQ      1
     C                   SETOFF                                       33
     C                   ELSE
     C                   SETON                                        33
     C                   END
     C                   Z-ADD     1             XN
     C                   ADD       1             YLI
     C     XN            DOWLE     20
     C     FRTK          CHAIN     FREETXT1                           34
     C     WT(XN)        IFEQ      *BLANKS
     C     WK(XN)        ANDEQ     *BLANKS
     C  N34              DELETE    FREETXTR
     C                   ELSE
     C                   MOVE      UAVD          FRTAVD
     C                   MOVE      UOPD          FRTOPD
     C                   MOVE      YDT           FRTDT
     C                   MOVE      YLI           FRTLI
     C                   MOVE      WT(XN)        FRTTXT
     C                   MOVE      WK(XN)        FRTKOD
     C  N34              UPDATE    FREETXTR
     C   34              MOVE      *ZEROS        FRTFAK
     C   34              WRITE     FREETXTR
     C  N33              DO
     C                   MOVEL     WT(XN)        WSTXT
     C                   MOVEL     WK(XN)        WSKODE
     C   40              UPDATE    SUBFIL
     C   40ZRECNO        CHAIN     SUBFIL                             34
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   SETON                                        33
     C                   END
     C                   END
     C                   ADD       1             XN
     C                   ADD       1             YLI
     C                   END
     C*
     C     SLTB1         ENDSR
     C*
     C***********************************************
     C     HENTS         BEGSR
     C***********************************************
N04  C                   move      'N'           merkle            1
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       17            LINNBR
     C                   MVR                     XLIN              4 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     17            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C  N27WSNR          IFEQ      '2'
     C*                    MOVE ' '       WSNR
     C                   EXSR      CHGST
     C                   MOVE      '1'           *IN05
     C                   MOVE      'N'           FØRSTE
     C                   MOVE      ZRECNO        XRECN2            4 0
     C   12              GOTO      SLHENT
     C                   END
      *
     C  N27WSNR          IFEQ      '4'
     C                   EXSR      DLTST
     C                   MOVE      '1'           *IN05
     C                   MOVE      'N'           FØRSTE
     C                   MOVE      ZRECNO        XRECN2            4 0
     C                   GOTO      SLHENT
     C                   END
      *
     C   27WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGST
     C   12              GOTO      SLHENT
     C                   END
      *
N02  C     WSNR          IFEQ      'L'
N02  C     WSNR          oreq      'U'
N02  C     WSkode        IFEQ      'G'
N03  C     WSkode        oreq      'P'
N02  C                   EXSR      LestUlest
s04  C*                  SETON                                        LR
s04  C*                  return
N04  C                   move      'J'           merkle
N02  C                   end
N02  C                   MOVE      ' '           WSNR
N02  C                   UPDATE    SUBFIL
N02  C                   END
      *
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     4             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGST         BEGSR
     C***********************************************
     C                   EXSR      KDTFMT
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          YDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          YDTÅ
     C                   END
     C*                    MOVE *BLANK    YKOD    1
     C                   EXSR      KDTFMT
     C                   SETON                                        40
     C                   Z-ADD     1             WSSIDE
     C                   EXSR      MOVFRW
     C*
     C                   SETON                                        99
     C     STCHG         TAG
     C                   EXFMT     BILDE01
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C   04              DO
     C*
      * SØK PÅ DOKUMENTKODER...
     C     POSNBR        IFEQ      2
     C                   MOVEL     'FRTKOD'      XKFTYP           10
     C                   MOVE      'N'           UUPDAT            1
     C                   MOVE      *BLANKS       XKFKOD            5
     C                   CALL      'SYFAKDA'
     C                   PARM                    XKFTYP
     C                   PARM                    UUPDAT
     C                   PARM                    XKFKOD
     C     LINNBR        IFGT      2
     C     LINNBR        ANDLT     23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVEL     XKFKOD        WK(SS)
     C                   END
     C                   Z-ADD     10            POSNBR
     C                   GOTO      START5
     C                   END
     C* ELLES SØK PÅ PREDEFINERTE TEKSTKODER
     C                   CALL      'SYFI10I'
     C                   PARM                    WSKF              2
     C                   Z-ADD     0             UFLAGG
     C     LINNBR        IFGT      2
     C     LINNBR        IFLT      23
     C     LINNBR        SUB       2             SS                2 0
     C                   MOVE      WSKF          WKO(SS)
     C                   END
     C                   END
     C                   GOTO      START5
     C                   END
     C                   SETOFF                                       9030
     C   12              GOTO      UTSRSH
     C   10WSSIDE        IFEQ      5
     C                   GOTO      STCHG
     C                   ELSE
     C     BLAN70        LOOKUP    WT                                 33
     C   33              EXSR      TESTB1
     C   33              ADD       1             WSSIDE
     C   33              EXSR      MOVFRW
     C                   GOTO      STCHG
     C                   END
     C  N27              EXSR      TESTB1
     C     FREE          IFEQ      'J'
     C                   GOTO      STCHG
     C                   END
     C   30              GOTO      STCHG
     C*
     C                   UPDATE    SUBFIL
     C     XLIN          IFEQ      0
     C                   Z-ADD     17            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C     UTSRSH        TAG
     C     PDALIN        IFEQ      'J'
     C                   Move      'L'           WSPDST
     C                   EXFMT     PDAWIN
     C     FRTK2         SETLL     FREETXT1
     C     FRTK2         READE     FREETXT1                               33
     C     *in33         doweq     '0'
     C     FRTKOD        ifeq      'P'
     C     WSPDST        ifeq      'L'
     C*                  Z-sub     9999999       FRTFAK
N01  C                   MOVE      'X'           FRTLES
     C                   else
     C                   move      *zeros        FRTFAK
N01  C                   MOVE      ' '           FRTLES
     C                   end
     C                   end
     c                   update    freetxtR
     C     FRTK2         READE     FREETXT1                               33
     C                   END
     C                   END
N01   * Melding til trannsp
N01  C     TRALIN        IFEQ      'J'
N01  C                   Move      'L'           WSTMST
N01  C                   EXFMT     TRMWIN
N01  C     FRTK2         SETLL     FREETXT1
N01  C     FRTK2         READE     FREETXT1                               33
N01  C     *in33         doweq     '0'
N01  C     FRTKOD        ifeq      'G'
N01  C     WSTMST        ifeq      'L'
N01  C                   MOVE      'X'           FRTLES
N01  C                   else
N01  C                   MOVE      ' '           FRTLES
N01  C                   end
N01  C                   end
N01  c                   update    freetxtR
N01  C     FRTK2         READE     FREETXT1                               33
N01  C                   END
N01  C                   END
     C                   ENDSR
     C*
N02  C***********************************************
N02  C     LestUlest     BEGSR
N02  C***********************************************
     C                   EXSR      KDTFMT
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          YDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          YDTÅ
     C                   END
     C                   EXSR      KDTFMT
N02  C     FRTK2         SETLL     FREETXT1
N02  C     FRTK2         READE     FREETXT1                               33
N02  C     *in33         doweq     '0'
N02  C     FRTKOD        ifeq      'G'
N03  C     FRTKOD        oreq      'P'
N02  C     WSNR          ifeq      'L'
N02  C                   MOVE      'X'           FRTLES
N02  C                   else
N02  C                   MOVE      ' '           FRTLES
N02  C                   end
N02  C                   end
N02  c                   update    freetxtR
N02  C     FRTK2         READE     FREETXT1                               33
N02  C                   END
N02  C                   ENDSR
     C***********************************************
     C     DLTST         BEGSR
     C***********************************************
     C                   MOVE      WSDTD         YDTD
     C                   MOVE      WSDTM         YDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          YDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          YDTÅ
     C                   END
     C                   SETOFF                                       34
     C                   MOVE      FRTLI         YLI
     C     FRTK          SETLL     FREETXT1
     C                   READ      FREETXT1                               34
     C  N34FRTAVD        COMP      UAVD                               3434
     C  N34FRTOPD        COMP      UOPD                               3434
     C  N34FRTDT         COMP      YDT                                3434
     C  N34FRTKOD        COMP      WSKODE                             3434
     C     *IN34         DOWEQ     '0'
     C                   DELETE    FREETXTR
     C                   READ      FREETXT1                               34
     C  N34FRTAVD        COMP      UAVD                               3434
     C  N34FRTOPD        COMP      UOPD                               3434
     C  N34FRTDT         COMP      YDT                                3434
     C  N34FRTKOD        COMP      WSKODE                             3434
     C  N34              END
     C                   ENDSR
      *
     C***********************************************
     C     MOVFRW        BEGSR
     C***********************************************
     C                   MOVE      'N'           PDALIN            1
N01  C                   MOVE      'N'           TRALIN            1
     C                   Z-ADD     2             POSNBR
     C     WSSIDE        MULT      20            XN2               3 0
     C                   MOVE      *BLANKS       WT
     C                   MOVE      *ZEROS        WF
     C                   MOVE      *BLANKS       WK
     C                   MOVE      *BLANKS       WKO
     C                   SETOFF                                       33
      *
     C     XN2           SUB       19            YLI
      *
     C     FRTK          SETLL     FREETXT1
     C     STMFW         TAG
     C     UAVD          READE     FREETXT1                               33
     C  N33              UPDATE    FREETXTR
     C  N33UOPD          COMP      FRTOPD                             3333
     C  N33YDT           COMP      FRTDT                              3333
     C  N33XN2           COMP      FRTLI                                33
     C  N33FRTLI         SUB       XN2           XN
     C  N33              ADD       20            XN
     C  N33              MOVE      FRTTXT        WT(XN)
     C  N33              MOVE      FRTFAK        WF(XN)
     C  N33              MOVE      FRTKOD        WK(XN)
     C  N33XN            ADD       3             LINNBR
     C  N33FRTKOD        IFEQ      'P'
     C                   MOVE      'J'           PDALIN            1
     C                   END
N01  C  N33FRTKOD        IFEQ      'G'
N01  C     FRTLES        ANDEQ     ' '
N01  C                   MOVE      'J'           TRALIN            1
N01  C                   END
     C  N33              GOTO      STMFW
     C     LINNBR        IFGT      22
     C                   Z-ADD     3             LINNBR
     C                   END
      *
     C   29              MOVEA     WT            XT
     C                   EXSR      TESTFA
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     OPDKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     FRTK          KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    YDT
     C                   KFLD                    YLI
     C     FRTKI         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     FRTK2         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C                   KFLD                    YDT
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      0                                  2727
     C     UAVD          IFEQ      *ZEROS
     C     STOPD         TAG
     C                   EXFMT     BILDE00
     C  N03OPDKEY        CHAIN     HEADF                              30
     C   30
     CANN03              GOTO      STOPD
     C                   END
     C*
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        YLI               2 0
     C                   MOVE      *ZEROS        YDT
     C                   MOVE      *BLANKS       BLAN70           70
      * DAGENS DATO
     C                   MOVE      UYEAR         YDTÅ
     C                   MOVE      UMONTH        YDTM
     C                   MOVE      UDAY          YDTD
     C     YDTÅ          IFGT      50
     C     YDTÅ          ADD       1900          YDTÅ
     C                   ELSE
     C     YDTÅ          ADD       2000          YDTÅ
     C                   END
     C                   MOVE      YDT           XUDATE            8 0
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        FRTDT
     C     KODTAK        CHAIN     KODTA                              33
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   29
     C     OPDKEY        CHAIN     HEADF                              29
     C     HEUR          COMP      'F'                                    29
     C  N29HEUR          COMP      'G'                                    29
     C*
     C                   ENDSR
     C*
     C************ **********************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C***********************************************
     C     FIXKOD        BEGSR
     C***********************************************
     C     KODFTK        KLIST
     C                   KFLD                    WSKF              2
     C                   KFLD                    XLN               1 0
     C                   Z-ADD     1             XN
     C*
     C     XN            DOWLT     20
     C     WKO(XN)       IFNE      '  '
     C                   MOVE      WKO(XN)       WSKF
     C                   MOVE      *BLANKS       WKO(XN)
     C*** HENTE FRITEKSTER
     C                   Z-ADD     1             XLN               1 0
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44
     CANN29              MOVEL     KFTFTX        WT(XN)
     C  N44
     CAN 29              MOVEL     KFTFTX        XT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44
     CANN29              MOVEL     KFTFTX        WT(XN)
     C  N44
     CAN 29              MOVEL     KFTFTX        XT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44
     CANN29              MOVEL     KFTFTX        WT(XN)
     C  N44
     CAN 29              MOVEL     KFTFTX        XT(XN)
     C*
     C     XN            IFLT      20
     C                   ADD       1             XN
     C                   ADD       1             XLN
     C     KODFTK        CHAIN     KODTFTR                            44
     C  N44              MOVE      KFTSK         WK(XN)
     C  N44
     CANN29              MOVEL     KFTFTX        WT(XN)
     C  N44
     CAN 29              MOVEL     KFTFTX        XT(XN)
     C                   END
     C                   END
     C                   END
     C                   END
     C                   ADD       1             XN
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     TESTFA        BEGSR
     C***********************************************
      * setter indikator også ved low - ingen merking
     C     WF(1)         COMP      *ZEROS                             5151
     C     WF(2)         COMP      *ZEROS                             5252
     C     WF(3)         COMP      *ZEROS                             5353
     C     WF(4)         COMP      *ZEROS                             5454
     C     WF(5)         COMP      *ZEROS                             5555
     C     WF(6)         COMP      *ZEROS                             5656
     C     WF(7)         COMP      *ZEROS                             5757
     C     WF(8)         COMP      *ZEROS                             5858
     C     WF(9)         COMP      *ZEROS                             5959
     C     WF(10)        COMP      *ZEROS                             6060
     C     WF(11)        COMP      *ZEROS                             6161
     C     WF(12)        COMP      *ZEROS                             6262
     C     WF(13)        COMP      *ZEROS                             6363
     C     WF(14)        COMP      *ZEROS                             6464
     C     WF(15)        COMP      *ZEROS                             6565
     C     WF(16)        COMP      *ZEROS                             6666
     C     WF(17)        COMP      *ZEROS                             6767
     C     WF(18)        COMP      *ZEROS                             6868
     C     WF(19)        COMP      *ZEROS                             6969
     C     WF(20)        COMP      *ZEROS                             7070
     C                   ENDSR
