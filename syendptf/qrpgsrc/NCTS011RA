      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED NCTS ETA og tid            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-11 13-26
      *** LEDIGE INDIKATORER 27-29 31-81 90-91
      ***        INDIKATOR   27 PÅ = SPØRRING                 ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FTRKODL01  IF   E           K DISK
     FNCTSEH    UF A E           K DISK
     FNCTS011DA CF   E             WORKSTN INFDS(FBAREA)
      *
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D                 DS
     D  WSETA1D                1      2  0
     D  WSETA1M                3      4  0
     D  WSETA1A                5      6  0
     D  WSETA1                 1      6  0
     D                 DS
     D  THETA1A                1      4  0
     D  THETA1M                5      6  0
     D  THETA1D                7      8  0
     D  THETA1                 1      8  0
     D                 DS
     D  WSETA2D                1      2  0
     D  WSETA2M                3      4  0
     D  WSETA2A                5      6  0
     D  WSETA2                 1      6  0
     D                 DS
     D  THETA2A                1      4  0
     D  THETA2M                5      6  0
     D  THETA2D                7      8  0
     D  THETA2                 1      8  0
     D                 DS
     D  WSETA3D                1      2  0
     D  WSETA3M                3      4  0
     D  WSETA3A                5      6  0
     D  WSETA3                 1      6  0
     D                 DS
     D  THETA3A                1      4  0
     D  THETA3M                5      6  0
     D  THETA3D                7      8  0
     D  THETA3                 1      8  0
     D                 DS
     D  WSETA4D                1      2  0
     D  WSETA4M                3      4  0
     D  WSETA4A                5      6  0
     D  WSETA4                 1      6  0
     D                 DS
     D  THETA4A                1      4  0
     D  THETA4M                5      6  0
     D  THETA4D                7      8  0
     D  THETA4                 1      8  0
     D                 DS
     D  WSETA5D                1      2  0
     D  WSETA5M                3      4  0
     D  WSETA5A                5      6  0
     D  WSETA5                 1      6  0
     D                 DS
     D  THETA5A                1      4  0
     D  THETA5M                5      6  0
     D  THETA5D                7      8  0
     D  THETA5                 1      8  0
     D                 DS
     D  WSETA6D                1      2  0
     D  WSETA6M                3      4  0
     D  WSETA6A                5      6  0
     D  WSETA6                 1      6  0
     D                 DS
     D  THETA6A                1      4  0
     D  THETA6M                5      6  0
     D  THETA6D                7      8  0
     D  THETA6                 1      8  0
     D                 DS
     D  WSETA7D                1      2  0
     D  WSETA7M                3      4  0
     D  WSETA7A                5      6  0
     D  WSETA7                 1      6  0
     D                 DS
     D  THETA7A                1      4  0
     D  THETA7M                5      6  0
     D  THETA7D                7      8  0
     D  THETA7                 1      8  0
     D                 DS
     D  WSETA8D                1      2  0
     D  WSETA8M                3      4  0
     D  WSETA8A                5      6  0
     D  WSETA8                 1      6  0
     D                 DS
     D  THETA8A                1      4  0
     D  THETA8M                5      6  0
     D  THETA8D                7      8  0
     D  THETA8                 1      8  0
     D                 DS
     D  WSETAT1H               1      2  0
     D  WSETAT1M               3      4  0
     D  WSETAT1                1      4  0
     D                 DS
     D  WSETAT2H               1      2  0
     D  WSETAT2M               3      4  0
     D  WSETAT2                1      4  0
     D                 DS
     D  WSETAT3H               1      2  0
     D  WSETAT3M               3      4  0
     D  WSETAT3                1      4  0
     D                 DS
     D  WSETAT4H               1      2  0
     D  WSETAT4M               3      4  0
     D  WSETAT4                1      4  0
     D                 DS
     D  WSETAT5H               1      2  0
     D  WSETAT5M               3      4  0
     D  WSETAT5                1      4  0
     D                 DS
     D  WSETAT6H               1      2  0
     D  WSETAT6M               3      4  0
     D  WSETAT6                1      4  0
     D                 DS
     D  WSETAT7H               1      2  0
     D  WSETAT7M               3      4  0
     D  WSETAT7                1      4  0
     D                 DS
     D  WSETAT8H               1      2  0
     D  WSETAT8M               3      4  0
     D  WSETAT8                1      4  0
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C  N30              IF        THTSD1 = *BLANKS
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     10            POSNBR
     C                   ELSE
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     12            POSNBR
     C                   END
     C     ST21          TAG
      *
     C                   EXFMT     NCTS011DA1
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000000000' *IN(77)
     C                   MOVE      '0'           *IN30
      *
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL TR011D01
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
     C     UTYPE         IFEQ      'DSP'
     C                   Z-ADD     0             UFLAGG
     C                   GOTO      SLUTT
     C                   END
      *
      *** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SOKDTA
     C                   GOTO      ST21
     C                   END
      *
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
     C                   EXSR      OPDNCTSEH
     C                   Z-ADD     0             UFLAGG
      *
     C     SLUTT         TAG
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     TESTB         BEGSR
      ***********************************************
      *
     C                   IF        THTSD1 = *BLANKS
     C                   MOVE      *ZEROS        WSETA1
     C                   MOVE      *ZEROS        WSETAT1
     C                   ELSE
     C                   IF        WSETA1 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA1D       UDD               2 0
     C                   PARM      WSETA1M       UMM               2 0
     C                   PARM      WSETA1A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      99
     C   99
     CANN30              MOVE      'SPD0001'     MSGNR
     C   99              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT1H >= 24 OR WSETAT1M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN89 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD2 = *BLANKS
     C                   MOVE      *ZEROS        WSETA2
     C                   MOVE      *ZEROS        WSETAT2
     C                   ELSE
     C                   IF        WSETA2 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA2D       UDD               2 0
     C                   PARM      WSETA2M       UMM               2 0
     C                   PARM      WSETA2A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      98
     C   98
     CANN30              MOVE      'SPD0001'     MSGNR
     C   98              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT2H >= 24 OR WSETAT2M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN88 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD3 = *BLANKS
     C                   MOVE      *ZEROS        WSETA3
     C                   MOVE      *ZEROS        WSETAT3
     C                   ELSE
     C                   IF        WSETA3 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA3D       UDD               2 0
     C                   PARM      WSETA3M       UMM               2 0
     C                   PARM      WSETA3A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C   97
     CANN30              MOVE      'SPD0001'     MSGNR
     C   97              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT3H >= 24 OR WSETAT3M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN87 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD4 = *BLANKS
     C                   MOVE      *ZEROS        WSETA4
     C                   MOVE      *ZEROS        WSETAT4
     C                   ELSE
     C                   IF        WSETA4 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA4D       UDD               2 0
     C                   PARM      WSETA4M       UMM               2 0
     C                   PARM      WSETA4A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      96
     C   96
     CANN30              MOVE      'SPD0001'     MSGNR
     C   96              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT4H >= 24 OR WSETAT4M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN86 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD5 = *BLANKS
     C                   MOVE      *ZEROS        WSETA5
     C                   MOVE      *ZEROS        WSETAT5
     C                   ELSE
     C                   IF        WSETA5 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA5D       UDD               2 0
     C                   PARM      WSETA5M       UMM               2 0
     C                   PARM      WSETA5A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      95
     C   95
     CANN30              MOVE      'SPD0001'     MSGNR
     C   95              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT5H >= 24 OR WSETAT5M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN85 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD6 = *BLANKS
     C                   MOVE      *ZEROS        WSETA6
     C                   MOVE      *ZEROS        WSETAT6
     C                   ELSE
     C                   IF        WSETA6 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA6D       UDD               2 0
     C                   PARM      WSETA6M       UMM               2 0
     C                   PARM      WSETA6A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      94
     C   94
     CANN30              MOVE      'SPD0001'     MSGNR
     C   94              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT6H >= 24 OR WSETAT6M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN84 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD7 = *BLANKS
     C                   MOVE      *ZEROS        WSETA7
     C                   MOVE      *ZEROS        WSETAT7
     C                   ELSE
     C                   IF        WSETA7 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA7D       UDD               2 0
     C                   PARM      WSETA7M       UMM               2 0
     C                   PARM      WSETA7A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      93
     C   93
     CANN30              MOVE      'SPD0001'     MSGNR
     C   93              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT7H >= 24 OR WSETAT7M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN83 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        THTSD8 = *BLANKS
     C                   MOVE      *ZEROS        WSETA8
     C                   MOVE      *ZEROS        WSETAT8
     C                   ELSE
     C                   IF        WSETA8 <> 0 OR THSECU > 0
     C                   CALL      'TESTDATO'
     C                   PARM      WSETA8D       UDD               2 0
     C                   PARM      WSETA8M       UMM               2 0
     C                   PARM      WSETA8A       UAA               2 0
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      92
     C   92
     CANN30              MOVE      'SPD0001'     MSGNR
     C   92              EVAL      *IN30 = *ON
      *
     C                   IF        WSETAT8H >= 24 OR WSETAT8M >= 60
     C  N30              EVAL      MSGNR = 'YBC2273'
     C                   EVAL      *IN82 = *ON
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
     C                   END
      *
     C                   IF        WSPDTY <> *BLANKS OR WSPDRF <> *BLANKS
     C                   IF        %SUBST(THDK:1:2) = 'T2'
     C                   MOVE      '178'         YUNIK
     C                   ELSE
     C                   MOVE      '214'         YUNIK
     C                   END
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSPDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           81
     C                   IF        *IN81 AND *IN30 = *OFF
     C                   MOVE      'YBC2246'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSSDTY <> *BLANKS OR WSSDRF <> *BLANKS
     C                   MOVE      '213'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSSDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           80
     C                   IF        *IN80 AND *IN30 = *OFF
     C                   MOVE      'YBC2248'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSTDTY <> *BLANKS OR WSTDRF <> *BLANKS
     C                   MOVE      '754'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSTDTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           79
     C                   IF        *IN79 AND *IN30 = *OFF
     C                   MOVE      'YBC2249'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSADTY <> *BLANKS OR WSADRF <> *BLANKS
     C                   MOVE      '380'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSADTY        YKODE
     C     TRK01K        CHAIN     TRKODL01                           78
     C                   IF        *IN78 AND *IN30 = *OFF
     C                   MOVE      'YBC2250'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSAICD <> *BLANKS OR WSAITX <> *BLANKS
     C                   MOVE      '239'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVEL     WSAICD        YKODE
     C     TRK01K        CHAIN     TRKODL01                           77
     C                   IF        *IN77 AND *IN30 = *OFF
     C                   MOVE      'YBC2251'     MSGNR
     C                   EVAL      *IN30 = *ON
     C                   END
     C                   END
      *
     C   30              EXSR      SETCUR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SETCUR        BEGSR
      ***********************************************
     C   77              Z-ADD     9             LINNBR
     C   77              Z-ADD     10            POSNBR
     C   78              Z-ADD     8             LINNBR
     C   78              Z-ADD     10            POSNBR
     C   79              Z-ADD     7             LINNBR
     C   79              Z-ADD     10            POSNBR
     C   80              Z-ADD     6             LINNBR
     C   80              Z-ADD     10            POSNBR
     C   81              Z-ADD     5             LINNBR
     C   81              Z-ADD     10            POSNBR
     C   82              Z-ADD     4             LINNBR
     C   82              Z-ADD     82            POSNBR
     C   83              Z-ADD     4             LINNBR
     C   83              Z-ADD     72            POSNBR
     C   84              Z-ADD     4             LINNBR
     C   84              Z-ADD     62            POSNBR
     C   85              Z-ADD     4             LINNBR
     C   85              Z-ADD     52            POSNBR
     C   86              Z-ADD     4             LINNBR
     C   86              Z-ADD     42            POSNBR
     C   87              Z-ADD     4             LINNBR
     C   87              Z-ADD     32            POSNBR
     C   88              Z-ADD     4             LINNBR
     C   88              Z-ADD     22            POSNBR
     C   89              Z-ADD     4             LINNBR
     C   89              Z-ADD     12            POSNBR
     C   92              Z-ADD     3             LINNBR
     C   92              Z-ADD     82            POSNBR
     C   93              Z-ADD     3             LINNBR
     C   93              Z-ADD     72            POSNBR
     C   94              Z-ADD     3             LINNBR
     C   94              Z-ADD     62            POSNBR
     C   95              Z-ADD     3             LINNBR
     C   95              Z-ADD     52            POSNBR
     C   96              Z-ADD     3             LINNBR
     C   96              Z-ADD     42            POSNBR
     C   97              Z-ADD     3             LINNBR
     C   97              Z-ADD     32            POSNBR
     C   98              Z-ADD     3             LINNBR
     C   98              Z-ADD     22            POSNBR
     C   99              Z-ADD     3             LINNBR
     C   99              Z-ADD     12            POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVW          BEGSR
      ***********************************************
     C                   MOVE      THETA1D       WSETA1D
     C                   MOVE      THETA1M       WSETA1M
     C                   MOVE      THETA1A       WSETA1A
     C                   MOVE      THETA2D       WSETA2D
     C                   MOVE      THETA2M       WSETA2M
     C                   MOVE      THETA2A       WSETA2A
     C                   MOVE      THETA3D       WSETA3D
     C                   MOVE      THETA3M       WSETA3M
     C                   MOVE      THETA3A       WSETA3A
     C                   MOVE      THETA4D       WSETA4D
     C                   MOVE      THETA4M       WSETA4M
     C                   MOVE      THETA4A       WSETA4A
     C                   MOVE      THETA5D       WSETA5D
     C                   MOVE      THETA5M       WSETA5M
     C                   MOVE      THETA5A       WSETA5A
     C                   MOVE      THETA6D       WSETA6D
     C                   MOVE      THETA6M       WSETA6M
     C                   MOVE      THETA6A       WSETA6A
     C                   MOVE      THETA7D       WSETA7D
     C                   MOVE      THETA7M       WSETA7M
     C                   MOVE      THETA7A       WSETA7A
     C                   MOVE      THETA8D       WSETA8D
     C                   MOVE      THETA8M       WSETA8M
     C                   MOVE      THETA8A       WSETA8A
     C                   MOVE      THETAT1       WSETAT1
     C                   MOVE      THETAT2       WSETAT2
     C                   MOVE      THETAT3       WSETAT3
     C                   MOVE      THETAT4       WSETAT4
     C                   MOVE      THETAT5       WSETAT5
     C                   MOVE      THETAT6       WSETAT6
     C                   MOVE      THETAT7       WSETAT7
     C                   MOVE      THETAT8       WSETAT8
      *
     C                   EVAL      WSPDTY = THPDTY
     C                   EVAL      WSPDRF = THPDRF
     C                   EVAL      WSPDIN = THPDIN
     C                   EVAL      WSSDTY = THSDTY
     C                   EVAL      WSSDRF = THSDRF
     C                   EVAL      WSSDIN = THSDIN
     C                   EVAL      WSTDTY = THTDTY
     C                   EVAL      WSTDRF = THTDRF
     C                   EVAL      WSADTY = THADTY
     C                   EVAL      WSADRF = THADRF
     C                   EVAL      WSAICD = THAICD
     C                   EVAL      WSAITX = THAITX
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVNCTSEH     BEGSR
      ***********************************************
     C                   IF        THTSD1 = *BLANKS OR WSETA1 = 0
     C                   EVAL      THETA1 = 0
     C                   EVAL      THETAT1 = 0
     C                   ELSE
     C                   EVAL      THETA1 = 20000000 + WSETA1A * 10000
     C                             + WSETA1M * 100 + WSETA1D
     C                   EVAL      THETAT1 = WSETAT1
     C                   END
      *
     C                   IF        THTSD2 = *BLANKS OR WSETA2 = 0
     C                   EVAL      THETA2 = 0
     C                   EVAL      THETAT2 = 0
     C                   ELSE
     C                   EVAL      THETA2 = 20000000 + WSETA2A * 10000
     C                             + WSETA2M * 100 + WSETA2D
     C                   EVAL      THETAT2 = WSETAT2
     C                   END
      *
     C                   IF        THTSD3 = *BLANKS OR WSETA3 = 0
     C                   EVAL      THETA3 = 0
     C                   EVAL      THETAT3 = 0
     C                   ELSE
     C                   EVAL      THETA3 = 20000000 + WSETA3A * 10000
     C                             + WSETA3M * 100 + WSETA3D
     C                   EVAL      THETAT3 = WSETAT3
     C                   END
      *
     C                   IF        THTSD4 = *BLANKS OR WSETA4 = 0
     C                   EVAL      THETA4 = 0
     C                   EVAL      THETAT4 = 0
     C                   ELSE
     C                   EVAL      THETA4 = 20000000 + WSETA4A * 10000
     C                             + WSETA4M * 100 + WSETA4D
     C                   EVAL      THETAT4 = WSETAT4
     C                   END
      *
     C                   IF        THTSD5 = *BLANKS OR WSETA5 = 0
     C                   EVAL      THETA5 = 0
     C                   EVAL      THETAT5 = 0
     C                   ELSE
     C                   EVAL      THETA5 = 20000000 + WSETA5A * 10000
     C                             + WSETA5M * 100 + WSETA5D
     C                   EVAL      THETAT5 = WSETAT5
     C                   END
      *
     C                   IF        THTSD6 = *BLANKS OR WSETA6 = 0
     C                   EVAL      THETA6 = 0
     C                   EVAL      THETAT6 = 0
     C                   ELSE
     C                   EVAL      THETA6 = 20000000 + WSETA6A * 10000
     C                             + WSETA6M * 100 + WSETA6D
     C                   EVAL      THETAT6 = WSETAT6
     C                   END
      *
     C                   IF        THTSD7 = *BLANKS OR WSETA7 = 0
     C                   EVAL      THETA7 = 0
     C                   EVAL      THETAT7 = 0
     C                   ELSE
     C                   EVAL      THETA7 = 20000000 + WSETA7A * 10000
     C                             + WSETA7M * 100 + WSETA7D
     C                   EVAL      THETAT7 = WSETAT7
     C                   END
      *
     C                   IF        THTSD8 = *BLANKS OR WSETA8 = 0
     C                   EVAL      THETA8 = 0
     C                   EVAL      THETAT8 = 0
     C                   ELSE
     C                   EVAL      THETA8 = 20000000 + WSETA8A * 10000
     C                             + WSETA8M * 100 + WSETA8D
     C                   EVAL      THETAT8 = WSETAT8
     C                   END
      *
     C                   EVAL      THPDTY = WSPDTY
     C                   EVAL      THPDRF = WSPDRF
     C                   EVAL      THPDIN = WSPDIN
     C                   EVAL      THSDTY = WSSDTY
     C                   EVAL      THSDRF = WSSDRF
     C                   EVAL      THSDIN = WSSDIN
     C                   EVAL      THTDTY = WSTDTY
     C                   EVAL      THTDRF = WSTDRF
     C                   EVAL      THADTY = WSADTY
     C                   EVAL      THADRF = WSADRF
     C                   EVAL      THAICD = WSAICD
     C                   EVAL      THAITX = WSAITX
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDNCTSEH     BEGSR
      ***********************************************
     C     NCTSEHK       CHAIN     NCTSEH                             33
     C                   EXSR      MOVNCTSEH
     C  N33              UPDATE    NCTSEHR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * PREVIOUS DOCUMENT: TYPE
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   IF        %SUBST(THDK:1:2) = 'T2'
     C                   MOVE      '178'         UUNIK
     C                   ELSE
     C                   MOVE      '214'         UUNIK
     C                   END
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSPDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK             3
     C                   PARM                    UKODE            10
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSPDTY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * SUPPORTING DOCUMENT: TYPE
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '213'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSSDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSSDTY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * TRANSPORT DOCUMENT: TYPE
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '754'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSTDTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSTDTY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADDITIONAL REFERENCE: TYPE
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     13
     C                   MOVE      '380'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSADTY        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSADTY
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSOK
     C                   END
      * ADDITIONAL INFORMATION: CODE
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     10
     C     POSNBR        ANDLE     15
     C                   MOVE      '239'         UUNIK
     C                   MOVE      *BLANKS       UKODE
     C                   MOVE      'TRS'         UTYPE2            3
     C                   MOVEL     WSAICD        UKODE
     C                   CALL      'TR002R'
     C                   PARM                    UUNIK
     C                   PARM                    UKODE
     C                   PARM                    UTYPE2
     C                   MOVEL     UKODE         WSAICD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSOK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSOK         ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     NCTSEHK       KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    THTDN
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
      *
     C     *LIKE         DEFINE    THTDN         UTDN
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     THTDN         PARM      THTDN         UTDN
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C     UTYPE         COMP      'DSP'                                  27
      *
     C     NCTSEHK       CHAIN(N)  NCTSEH                             33
     C                   EXSR      MOVW
      *
     C                   ENDSR
      *
