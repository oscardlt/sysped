     FSVIH      IF   E             DISK
     FSVIV      IF   E           K DISK
ISO  FSAEH      IF   E           K DISK
     FQ         O  A F  256        DISK
     D                 DS
     D  DATON                  1      8S 0
     D  YYMM                   3      6
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *__________________________
     C     SRA           BEGSR
      *__________________________
      * Definiere arbetsvariablar
      *""""""""""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_MOKN     UVIH_MOKN
ISO  C     *LIKE         DEFINE    SEAVD         USVAVD
ISO  C     *LIKE         DEFINE    SETDN         USVTDN
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    SVIH_SYAV
     C                   KFLD                    SVIH_SYOP
ISO  C     SADKEY        KLIST
ISO  C                   KFLD                    USVAVD
ISO  C                   KFLD                    USVTDN
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UYYMM             4
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Start av file                                        SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C                   READ      SVIH                                   51
     C     *IN51         DOWEQ     *OFF
     C                   EVAL      DATON=SVIH_SYDT
     C     YYMM          IFEQ      UYYMM
     C                   EXSR      SRBA
     C                   ENDIF
      * Læs næsta varulinje
     C                   READ      SVIH                                   51
     C  N51              ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Les varelinjer                                      SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
ISO   * Hent kundenummer og landkode
ISO  C                   EVAL      USVAVD = SVIH_SYAV
ISO  C                   EVAL      USVTDN = SVIH_SYOP
ISO  C     SADKEY        CHAIN     SAEH                               52
     C                   EVAL      *IN52=*OFF
     C     KEYA          SETLL     SVIV
     C     KEYA          READE     SVIV                                   52
     C     *IN52         DOWEQ     *OFF
     C                   EXCEPT    UT
     C     KEYA          READE     SVIV                                   52
     C  N52              ENDDO
     C                   ENDSR
     OQ         EADD         UT
ISO  O*                                           2 'DE'
ISO  O                       SELKB                2
     O                                            3 ','
     O                                            4 '1'
     O                                            5 ','
     O                       SVIV_VATA           15
     O                                           15 '  '
     O                                           14 ','
     O                                           16 '00'
     O                       SVIV_ANKV           25
     O                                           26 ','
     O                                           28 '00'
     O                       SVIV_NETO           37
     O                                           38 ','
     O                       SVIH_VAKD           41
     O                       SVIV_FABL           52
     O                                           42 ','
     O                                           52 ', '
     O                       SVIV_SYAV           55
     O                                           56 '/'
     O                       SVIV_SYOP           63
