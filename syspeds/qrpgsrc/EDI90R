     H DATEDIT(*YMD)
      ***********************************************************
      *** VISE NAD STANDARD FIL                               ***
      ***                                                     ***
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P10045* 02 JOV PTF10 F10 = til vedlikekold kunko / xref
********************************************************************
      *** INDICATORS  01 - 26 FUNCTION  / ROLL KEYS           ***
      *** INDICATORS USED                                     ***
      ***                                                     ***
      ***  03 - EXIT                                          ***
      ***  06 - CREATE NEW RECORD                             ***
      ***  10 - Vedlikehold                                   ***
      ***  12 - CANCEL                                        ***
      ***  25 - ROLL                                          ***
      ***                                                     ***
      ***  30 - GENERAL ERROR IN SCREEN                       ***
      ***  31 -         ERROR IN SCREEN                       ***
      ***  66 - READ INDICATOR FOR SUBCTL                     ***
      ***  91 - SFLDSP                                        ***
      ***  92 - SFLDSPCTL                                     ***
      ***  93 - SFLCLR                                        ***
      ***  94 - SFLEND                                        ***
      ***  98 - END OF READC SUBFILE                          ***
      ***********************************************************
      * Programmet viser alle adresseopplysninger som er registert
      * i ENADSF. Feltene mappes fortløpende etterhverandre.
      * Det sjekkes at et felt ikke går over flere linjer.
      * Dette pgm kalles fra oppdragsregistrering hvor det er aktuelt
      *
     FENADSF    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKUNKO     IF A E           K DISK
     FKUNKO2    IF   E           K DISK    RENAME(KUNKOR:KUNKOR2)
     FVADR      IF   E           K DISK
     FEDI90D    CF   E             WORKSTN
     F                                     SFILE(EDI90H30:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSCLOC2              382    383B 0
     D  WSSUBN               378    379B 0
      ***********************************************************
     D A               S              1    DIM(35)
     D B               S              1    DIM(75)
      *
      *______________________
      * Initialize subroutine
      *""""""""""""""""""""""
     C                   EXSR      INIT
      *______________
      * Clear Subfile
      *""""""""""""""
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     EDI90K40
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
      *_____________
      * Fill Subfile
      *"""""""""""""
     C     OPDKEY        SETLL     ENADSF                             77
      *
      *
     C     START1        TAG
     C     OPDKEY        READE     ENADSF                                 94
     C     *IN94         CABEQ     *ON           START2
     C     ZRECNO        IFGT      0
     C                   ADD       1             ZRECNO
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVE      *ON           *IN45
     C                   WRITE     EDI90H30
     C                   ENDIF
     C                   IF        WSKN = 0
     C                   EVAL      WSKN = NKN
     C                   END
     C     N3039         COMP      *BLANKS                                45
     C  N45              IF        WSKN <> 0
     C                   EVAL      KUINTN = N3039
     C     KUNKO2K       CHAIN     KUNKO2                             33
     C  N33              EVAL      *IN45 = *ON
     C                   END
      *
     C     N3035         CAT(P)    N3039:2       SFFELT
     C     SFFELT        CAT(P)    N1131:2       SFFELT
     C     SFFELT        CAT(P)    N3055:2       SFFELT
     C     N3124A        IFNE      *BLANKS
     C     N3124B        IFNE      *BLANKS
     C     N3124C        ORNE      *BLANKS
     C     N3124D        ORNE      *BLANKS
     C     N3124E        ORNE      *BLANKS
     C     SFFELT        CAT(P)    N3124A:2      SFFELT
     C     N3124B        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3124B        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG
     C     SFFELT        CAT(P)    N3124B:2      SFFELT
     C                   ELSE
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3124B        SFFELT
     C                   ENDIF
     C                   ENDIF                                                  <N3124B
     C     N3124C        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3124C        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG
     C     SFFELT        CAT(P)    N3124C:2      SFFELT
     C                   ELSE
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3124C        SFFELT
     C                   ENDIF
     C                   ENDIF                                                  <N3124C
     C     N3124D        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3124D        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG
     C     SFFELT        CAT(P)    N3124D:2      SFFELT
     C                   ELSE
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3124D        SFFELT
     C                   ENDIF
     C                   ENDIF                                                  <N3124D
     C     N3124E        IFNE      *BLANKS
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3124E        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG
     C     SFFELT        CAT(P)    N3124E:2      SFFELT
     C                   ELSE
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3124E        SFFELT
     C                   ENDIF
     C                   ENDIF                                                  <N3124E
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   GOTO      START1
     C                   ENDIF                                                  <N3124B
     C                   ENDIF                                                  <N3124A
      *
     C     N3036A        IFNE      *BLANKS                                      1<-B N3036A
     C     N3036B        ORNE      *BLANKS
     C     N3036C        ORNE      *BLANKS
     C     N3036A        IFNE      *BLANKS                                       2<-B N3036A
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3036A        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3036A:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3036A        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3036A
     C     N3036B        IFNE      *BLANKS                                       2<-B N3036B
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3036B        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3036B:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3036B        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3036B
     C     N3036C        IFNE      *BLANKS                                       2<-B N3036C
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3036C        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3036C:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3036C        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3036C
     C     N3042A        IFNE      *BLANKS                                       2<-B N3042A
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3042A        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3042A:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3042A        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3042A
     C     N3042B        IFNE      *BLANKS                                       2<-B N3042B
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3042B        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3042B:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3042B        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3042B
     C     N3042C        IFNE      *BLANKS                                       2<-B N3042C
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3042C        A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3042C:2      SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3042C        SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3042C
     C     N3164         IFNE      *BLANKS                                       2<-B N3164
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3164         A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3164:2       SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3164         SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3164
     C     N3229         IFNE      *BLANKS                                       2<-B N3229
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3229         A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3229:2       SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3229         SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3229
     C     N3251         IFNE      *BLANKS                                       2<-B N3251
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3251         A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3251:2       SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3251         SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3251
     C     N3207         IFNE      *BLANKS                                       2<-B N3207
     C                   MOVEA     *BLANKS       A
     C                   MOVEA     N3207         A
     C                   EXSR      TSTNY
     C                   MOVEA     *BLANKS       B
     C                   MOVEA     SFFELT        B
     C                   EXSR      TSTHAR
     C     75            SUB       HARTEG        DIFF
     C     DIFF          IFGT      NYTEG                                          3<-B
     C     SFFELT        CAT(P)    N3207:2       SFFELT
     C                   ELSE                                                     3
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   MOVE      *ON           *IN45
     C                   MOVEL     *BLANKS       SFFELT
     C                   MOVEL     N3207         SFFELT
     C                   ENDIF                                                    3<-E
     C                   ENDIF                                                   2<-E N3207
     C                   ADD       1             ZRECNO
     C                   WRITE     EDI90H30
     C                   ENDIF                                                  1<-E N3036A
     C                   GOTO      START1
      *
     C     START2        TAG
     C                   Z-ADD     ZRECNO        YRECNO            5 0
      *________________
      * Display Subfile
      *""""""""""""""""
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   MOVEA     '01'          *IN(91)
     C                   END                                                    <ZRECNO
     C                   WRITE     EDI90B20
     C                   EXFMT     EDI90K40
     C   03              GOTO      ENDPGM
     C   12              GOTO      ENDPGM
N02  C   10              DO
N02  C                   MOVE      WSKN          UKN               8 0
N02  C                   CALL      'SYFA81'
N02  C                   PARM                    UKN
N02  C                   GOTO      START
N02  C                   ENDDO
      ***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      ***
      *
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
      *
     C                   GOTO      START3
      *
     C     ENDPGM        TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      ***********************************************
     C     HENT          BEGSR
      ***********************************************
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     EDI90H30                               98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       16            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     16            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     XOPT          IFEQ      'X'
     C                   MOVE      ' '           XOPT
     C                   EXSR      SRKRYS
     C   12              GOTO      SLHENT
     C                   END
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       6             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRKRYS        BEGSR
      ***********************************************
     C     WSKN          COMP      0                                  5050
     C                   EVAL      WSKN2  = 0
     C                   EVAL      WSADRN = 0
     C                   EVAL      KUINTN = N3039
     C  N50              EVAL      LINNBR = 2
     C   50              EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 19
      *
     C     STKRYS        TAG
     C                   EXFMT     EDI90R50
     C                   MOVEA     '000'         *IN(88)
     C                   SETOFF                                       30
     C   12              GOTO      SLKRYS
      *
     C   04              DO
     C     WSCLOC2       DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   SELECT
     C                   WHEN      LINNBR = 2
     C                   EXSR      SØKUN1
     C                   WHEN      (((LINNBR = 4) AND
     C                               (POSNBR >= 19)) AND
     C                               (POSNBR <= 26))
     C                   EXSR      SØKUN2
     C                   WHEN      (((LINNBR = 4) AND
     C                               (POSNBR >= 30)) AND
     C                               (POSNBR <= 34))
     C                   EXSR      SØKVAD
     C                   ENDSL
     C                   GOTO      STKRYS
     C                   END
      *
     C   06              DO
     C                   MOVE      WSKN          UKN               8 0
     C                   CALL      'SYFA81'
     C                   PARM                    UKN
     C                   GOTO      SLKRYS
     C                   ENDDO
      *
     C                   EXSR      TESTB1
     C   30              GOTO      STKRYS
      *
      * OPPDATER KOBLING
     C                   EVAL      KUKUN1 = WSKN
     C                   EVAL      KUKUN2 = WSKN2
     C                   EVAL      KUINTN = N3039
     C                   EVAL      KUALFA = SONAVN
     C                   EVAL      KUVADR = WSADRN
     C                   WRITE     KUNKOR
     C                   MOVE      *BLANKS       N3039
      *
     C     SLKRYS        TAG
     C     N3039         COMP      *BLANKS                                45
     C                   UPDATE    EDI90H30
     C     XLIN          IFEQ      0
     C                   Z-ADD     16            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
     C     CUNDL01K1     CHAIN     CUNDL01                            90
     C                   IF        *IN90
     C                   EVAL      *IN30 = *ON
     C                   EVAL      MSGNR = 'SPK0001'
     C                   EVAL      LINNBR = 2
     C                   EVAL      POSNBR = 19
     C                   GOTO      SLTEST
     C                   END
      *
     C     KUNKO2K       CHAIN     KUNKO2                             33
     C                   IF        *IN33 = *OFF
     C                   EVAL      *IN90 = *ON
     C                   EVAL      *IN30 = *ON
     C                   EVAL      MSGNR = 'TRO0157'
     C                   EVAL      LINNBR = 2
     C                   EVAL      POSNBR = 19
     C                   GOTO      SLTEST
     C                   END
      *
     C     CUNDL01K2     CHAIN     CUNDL01                            89
     C                   IF        *IN89
     C                   EVAL      *IN30 = *ON
     C                   EVAL      MSGNR = 'SPK0001'
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 19
     C                   GOTO      SLTEST
     C                   END
      *
     C                   IF        WSADRN <> 0
     C     VADRK         CHAIN     VADR                               88
     C                   IF        *IN88
     C                   EVAL      *IN30 = *ON
     C                   EVAL      MSGNR = 'SHU0520'
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 30
     C                   GOTO      SLTEST
     C                   END
     C                   END
      *
     C     KUNKOK        CHAIN     KUNKO                              33
     C                   IF        *IN33 = *OFF
     C                   EVAL      *IN89 = *ON
     C                   EVAL      *IN30 = *ON
     C                   EVAL      MSGNR = 'TRO0157'
     C                   EVAL      LINNBR = 4
     C                   EVAL      POSNBR = 19
     C                   GOTO      SLTEST
     C                   END
      *
     C     SLTEST        ENDSR
      *
      ***********************************************
     C     SØKUN1        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   MOVE      *ZEROS        KUNDE
     C                   CALL      'SOEKKUN'
     C                   PARM                    KUNDE             8 0
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   MOVE      KUNDE         WSKN
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKUN2        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   MOVE      *ZEROS        KUNDE
     C                   CALL      'SOEKKUN'
     C                   PARM                    KUNDE             8 0
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   MOVE      KUNDE         WSKN2
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKVAD        BEGSR
      ***********************************************
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKN2
     C                   PARM                    WSNAK            30
     C                   PARM                    WSADK1           30
     C                   PARM                    WSADK2           30
     C                   PARM                    WSADK3           30
     C                   PARM                    WSLAND            2
     C                   PARM                    UADRNR            5
     C                   MOVE      UADRNR        WSADRN
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C                   Z-ADD     0             ZRECNO            4 0
     C                   Z-ADD     0             X                 3 0
     C                   Z-ADD     0             HARTEG            3 0
     C                   Z-ADD     0             NYTEG             3 0
     C                   Z-ADD     0             DIFF              3 0
     C     *ENTRY        PLIST
     C                   PARM                    WAVD
     C                   PARM                    WOPD
     C     *LIKE         DEFINE    NAVD          WAVD
     C     *LIKE         DEFINE    NOPD          WOPD
     C     OPDKEY        KLIST
     C                   KFLD                    WAVD
     C                   KFLD                    WOPD
     C     CUNDL01K1     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKN
     C     CUNDL01K2     KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKN2
     C     VADRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKN2
     C                   KFLD                    WSADRN
     C     KUNKO2K       KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    KUINTN
     C     KUNKOK        KLIST
     C                   KFLD                    WSKN
     C                   KFLD                    WSKN2
     C                   KFLD                    WSADRN
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      ***********************************************
     C     TSTNY         BEGSR
      ***********************************************
     C                   Z-ADD     35            X
     C     A(X)          DOWEQ     *BLANK
     C     X             ANDGT     1
     C                   SUB       1             X
     C                   ENDDO
     C                   Z-ADD     X             NYTEG
      *
     C                   ENDSR
      ***********************************************
     C     TSTHAR        BEGSR
      ***********************************************
     C                   Z-ADD     75            X
     C     B(X)          DOWEQ     *BLANK
     C     X             ANDGT     1
     C                   SUB       1             X
     C                   ENDDO
     C                   Z-ADD     X             HARTEG
      *
     C                   ENDSR
