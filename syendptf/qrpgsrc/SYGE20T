********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 beregner diff dager
********************************************************************
      *
      *
      **********************************************************************
      *** PROGRAM for                                                    ***
      ***                                                                ***
      ***   ADDere xx dgr til gitt dato                                  ***
      ***             Innparm=UDato1 og UDager     Utparm=Udato2         ***
      ***                                                                ***
      ***   SUBtraher xx dgr fra gitt dato                               ***
      ***             Innparm=UDato1 og UDager     Utparm=Udato2         ***
      ***                                                                ***
      ***   DIFferanse mellom to datoer i dgr.                           ***
      ***             Innparm=UDato1 og UDato2     Utparm=UDager         ***
      ***                                                                ***
      ***                                                                ***
      ***   Når UDato1 er 0 settes den til Dagens dato.                  ***
      ***                                                                ***
      **********************************************************************
     D                 DS
     DISODat                           D   datfmt(*iso)
     DISODat1                          D   datfmt(*iso)
     DISODat2                          D   datfmt(*iso)
     D                 DS
     D  NUMDat                 1      8  0
     D  NumAar                 1      4  0
     D  NumMnd                 5      6  0
     D  NumDag                 7      8  0
     D                 DS
     D  ISODatDS               1     10
     D  ISOAar                 1      4
     D  hyf1                   5      5
     D  ISOMnd                 6      7
     D  hyf2                   8      8
     D  ISODag                 9     10
      *
     c                   exsr      Init
      *
     c                   select
     c     Ufunksjon     wheneq    'ADD'
     c                   exsr      ADDDays
     c     Ufunksjon     wheneq    'SUB'
     c                   exsr      SUBDays
     c     Ufunksjon     wheneq    'DIF'
     c                   exsr      DIFDays
     c                   endsl
      *
     c                   seton                                        lr
     c                   return
      *
      *
      *
      *************************************************************
     c     Init          Begsr
      *************************************************************
     c     *entry        plist
     C                   PARM                    Ufunksjon         3
     c                   parm                    UDato1            8 0
     c                   parm                    UDato2            8 0
     c                   parm                    UDager            5 0
      *
     c                   move      '-'           hyf1
     c                   move      '-'           hyf2
      * hvis 0 i startdato, sett dagens.
     c     UDato1        ifeq      *zeros
     c                   time                    ISODat
     c                   exsr      FraISO
     c                   move      NumDat        Udato1
     c                   end
      *
     c                   endsr
      *
      *
      *************************************************************
     c     ADDDays       Begsr
      *************************************************************
     c                   move      Udato1        NUMDat            8 0
     c                   exsr      TilISO
     C                   adddur    UDager:*days  ISODat
     c                   exsr      FraISO
     c                   move      NumDat        Udato2
      *
     c                   endsr
      *
      *************************************************************
     c     SUBDays       Begsr
      *************************************************************
     c                   move      Udato1        NUMDat            8 0
     c                   exsr      TilISO
     C                   subdur    UDager:*days  ISODat
     c                   exsr      FraISO
     c                   move      NumDat        Udato2
      *
     c                   endsr
      *************************************************************
     c     DIFDays       Begsr
      *************************************************************
     c                   move      Udato1        NUMDat            8 0
     c                   exsr      TilISO
     c                   move      ISODAT        ISODAT1
     c                   move      Udato2        NUMDat            8 0
     c                   exsr      TilISO
     c                   move      ISODAT        ISODAT2
N01  C     ISODAT1       SUBDUR    ISODAT2       UDAGER:*D
      *
      *  ferdigstilles ved behov......
      *   syfa20a inneholder mye...
      *
      *
     c                   endsr
      *
      *************************************************************
     c     TilIso        Begsr
      *************************************************************
     c                   move      NUMAar        ISOAar
     c                   move      NUMMnd        ISOMnd
     c                   move      NUMDag        ISODag
     c                   move      ISODatDS      ISODat
     c                   endsr
      *
      *************************************************************
     c     FraIso        Begsr
      *************************************************************
     c                   move      ISODat        ISODatDS
     c                   move      ISOAar        NUMAar
     c                   move      ISOMnd        NUMMnd
     c                   move      ISODag        NUMDag
     c                   endsr
