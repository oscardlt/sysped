********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 JOV PTF12 *VED iNNKODE = *URL HENT URL FRA TTACTI URS
********************************************************************
     H debug(*yes)
      *
      * generere url for signaturer
      *
     FEDII      IF   E           K DISK
     FTRACKL08  IF   E           K DISK
     FDOKUFM    IF   E           K DISK
     D                 DS
     D  TXT                    1    650
     D                                     DIM(10)
     D    INPOD01              1     65
     D    INPOD02             66    130
     D    INPOD03            131    195
     D    INPOD04            196    260
     D    INPOD05            261    325
     D    INPOD06            326    390
     D    INPOD07            391    455
     D    INPOD08            456    520
     D    INPOD09            521    585
     D    INPOD10            586    650
      *
     c                   exsr      init
      *
     c                   exsr      generer
      *
     c                   seton                                        lr
     c                   return
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     c     *entry        plist
     c                   parm                    part             10
     c                   parm                    sndno            17
     c                   parm                    avd               4 0
     c                   parm                    opd               7 0
     c                   parm                    ubane           256
     c                   parm                    gifok             1
     c                   move      avd           ttavd
     c                   move      opd           ttopd
     c                   move      'URS'         ttacti
     c     key           klist
     c                   kfld                    ttavd
     c                   kfld                    ttopd
     c                   kfld                    ttacti
     c     key           chain     trackl08                           33
     c  N33              move      tttext        unik             70
     c     keyfm         klist
     c                   kfld                    kodefm            1
     c                   kfld                    ttavd
     c                   kfld                    ttopd
     c                   move      'F'           kodefm
     c     keyfm         chain     dokufm                             33
     c                   move      'J'           gifok
     C                   ENDSR
      *
      ***********************************************
     C     generer       BEGSR
      ***********************************************
     c                   eval      inid=part
     c     inid          CHAIN     EDII                               33
      *
N01  c                   if        INPOD01='*URL'
N01  c                   if        TTTEXL = TTTEXT
N01  c                   eval      ubane=TTTEXL
N01  c                   else
N01  c                   eval      ubane=%trim(TTTEXL)+%trim(TTTEXT)
N01  c                   endif
N01  c                   goto      utsr
N01  c                   endif
N01   *
     c                   eval      ubane='http://'
      *
     c     1             do        10            nr                2 0
      *
      * hent url hos motpart
      *
     c     txt(nr)       ifeq      '*wspolnk'
     c                   exsr      wspolnk
     c                   goto      utsr
     c                   end
      *
     c     txt(nr)       ifeq      '*unik'
     c     unik          ifeq      *blanks
     c                   move      'N'           gifok
     c                   seton                                        lr
     c                   return
     c                   end
     c     ubane         cat       unik:0        ubane
     c                   goto      ut
     c                   end
      *
      *
     c     txt(nr)       ifeq      '*part'
     c     ubane         cat       part:0        ubane
     c                   goto      ut
     c                   end
      *
      *
     c     txt(nr)       ifeq      '*sndno'
     c     ubane         cat       sndno:0       ubane
     c                   goto      ut
     c                   end
      *
     c     txt(nr)       ifeq      '*colno'
     c     ubane         cat       fmmrk1:0      ubane
     c                   goto      ut
     c                   end
      *
     c     txt(nr)       ifne      *blanks
     c     ubane         cat       txt(nr):0     ubane
     c                   end
      *
     c     ut            tag
     c                   enddo
      *
     C     utsr          ENDSR
      *
      ***********************************************
     C     wspolnk       BEGSR
      ***********************************************
      * hent lenke hos transportør
      *
     c                   eval      srv = txt(2)
     c                   eval      usr = 'NN'
     c                   eval      snd = sndno
     c                   call      'GETPOLNKC'
     c                   parm                    srv              30
     c                   parm                    usr              10
     c                   parm                    snd              20
     c                   parm                    polnk           512
     c                   eval      ubane = polnk
     c                   endsr
