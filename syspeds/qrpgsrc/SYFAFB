      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE         ***
      ***                   FRAKTBREV                          ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01 02 04-26                       ***
      *** LEDIGE INDIKATORER 27-97                             ***
      ************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Ved J i valbbilde blank evt J i Jobkø
10XXX * 02 SH  PTF10 Ved D i jbq skal ikke skjermbilde vises
      * %%%%%%%%%%%%%%%%%%%%%%%%%%%%
10XXX * 03 SH  PTF11 Ved D i jbq skal en IKKE goto start :=)
********************************************************************
      *
     FFIRM      IF   E           K DISK
     FKODTP     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTSF    IF   E           K DISK
s02  F*YFAFBFM  CF   E             WORKSTN
n02  FSYFAFBFM  CF   E             WORKSTN USROPN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UDT1                  30     35  0
     D*
     D*** POS 47 - 60 BRUKES AV ANDRE PROGRAMER
     D  ULG                   61     61
     D  UEKSP                 62     62
     D  UDTÅ                  64     65  0
     D  UDTM                  66     67  0
     D  UDTD                  68     69  0
V10  D  UOPD                  82     88  0
     D* XBLA1/XBLA2 ER IKKE I BRUK. HVIS TAR NOEN POSISJONER TIL BRUK
     D* HUSK Å SYNKE STØRRELSE PÅ XBLA1/XBL2
     D  XBLA1                 89    256
     D  XBLA2                257    510
     D  UPRT5                701    710
     D  UPT5                 711    720
     D  UPRT6                721    730
     D  UPT6                 731    740
     D  UPRT7                741    750
     D  UPT7                 751    760
     D  UPRT8                761    770
     D  UPT8                 771    780
     D  UPRT9                781    790
     D  UPT9                 791    800
     D  UPRT10               801    810
     D  UPT10                811    820
     D  UPRT14               881    890
     D  UPT14                891    900
     D  UPRT15               901    910
     D  UPT15                911    920
     D  UPRT67               921    930
     D  UPT67                931    940
     D  UPRT57               941    950
     D  UPT57                951    960
     D  UGN                  981    995
     I*
     C*
     C     KODTPK        KLIST
     C                   KFLD                    WSPUNI
     C                   KFLD                    WSAVD
     C                   KFLD                    WSPLNR
     C     KODTVK        KLIST
     C                   KFLD                    WSVUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    WSFUNI
     C                   KFLD                    WSSG
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UJBKØ             1
     C                   PARM                    ULG1              1             **LEDIG
     C                   PARM                    UEKSP1            1             **LEDIG
     C                   PARM                    UIN01             1
     C                   PARM                    UVB               1
     C                   PARM                    UPO               1
N02  C                   MOVE      UJBKØ         UJBKDIR           1
     C     UVB           COMP      'K'                                    70
     C   70              MOVE      UVB           WSVB
     C   70              MOVE      'K O P I '    WSKOPI
     C                   MOVE      '0'           UIN01
     C                   MOVE      ' '           UJBKØ
     C                   MOVE      ' '           UJBKØ
     C                   MOVE      'J'           WSJBKØ
     C   70              MOVE      'N'           WSJBKØ
     C*
     C                   MOVE      'P'           WSPUNI            1
     C                   MOVE      'V'           WSVUNI            1
     C                   MOVE      'SF'          WSFUNI            2
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C                   MOVE      UDAY          WSDTD
     C                   MOVE      UMONTH        WSDTM
     C                   MOVE      UYEAR         WSDTÅ
     C* BLANKE DE FELTENE SOM IKKE ER I BRUK
     C                   MOVE      *BLANKS       XBLA1
     C                   MOVE      *BLANKS       XBLA2
     C*
     C     FIFIRM        CHAIN     FIRM                               99
     C                   READ      FIRM                                   99
     C                   MOVE      FIFIRM        UFIRM
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
N02  C     UJBKDIR       IFNE      'D'
N02  C                   OPEN      SYFAFBFM
     C                   EXFMT     BILDE
N02  C                   END
     C                   EXSR      KDTFMT
     C                   SETOFF                                       309998
     C*
     C   03              MOVE      '1'           UIN01
     C   03              GOTO      SLUTT
     C*
     C     KODTVK        CHAIN     KODTV                              99
     C  N99              Z-ADD     5             WSPLNR            3 0
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT5
     C  N99              MOVE      KOPTY         UPT5
     C  N99              Z-ADD     6             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT6
     C  N99              MOVE      KOPTY         UPT6
     C  N99              Z-ADD     7             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT7
     C  N99              MOVE      KOPTY         UPT7
     C  N99              Z-ADD     8             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT8
     C  N99              MOVE      KOPTY         UPT8
     C  N99              Z-ADD     9             WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT9
     C  N99              MOVE      KOPTY         UPT9
     C  N99              Z-ADD     10            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT10
     C  N99              MOVE      KOPTY         UPT10
     C  N99              Z-ADD     14            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT14
     C  N99              MOVE      KOPTY         UPT14
     C  N99              Z-ADD     15            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT15
     C  N99              MOVE      KOPTY         UPT15
     C  N99              Z-ADD     67            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT67
     C  N99              MOVE      KOPTY         UPT67
     C  N99              Z-ADD     57            WSPLNR
     C  N99KODTPK        CHAIN     KODTP                              99
     C  N99              MOVE      KOPNVN        UPRT57
     C  N99              MOVE      KOPTY         UPT57
N03  C     UJBKDIR       IFNE      'D'
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      START
     C     WSSG          IFNE      'ALL'
     C     KODSFK        CHAIN     KODTSF                             98
     C   98              MOVE      'SPS0001'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      START
     C                   END
N03  C                   ENDIF
     C*
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSSG          USG
     C                   MOVE      WSPRO         UPRO
V10  C                   MOVE      WSOPD         UOPD
     C                   MOVE      WSGN          UGN
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   MOVE      *ZEROS        UDT1
     C  N70              MOVE      WSVB          UVB
N01  c     WSVB          ifeq      'J'
N01  c                   move      *blanks       WSJBKØ
N01  c                   endif
     C                   MOVE      WSPO          UPO
     C                   MOVE      WSJBKØ        UJBKØ
     C     WSPRT1        IFNE      *BLANKS
     C                   MOVE      WSPRT1        UPRT5
     C                   MOVE      WSPRT1        UPRT6
     C                   MOVE      WSPRT1        UPRT7
     C                   MOVE      WSPRT1        UPRT14
     C                   END
     C     WSPRT2        IFNE      *BLANKS
     C                   MOVE      WSPRT2        UPRT8
     C                   MOVE      WSPRT2        UPRT9
     C                   MOVE      WSPRT2        UPRT10
     C                   MOVE      WSPRT2        UPRT67
     C                   MOVE      WSPRT2        UPRT57
     C                   END
     C     UPRT5         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT5
     C                   END
     C     UPT5          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT5
     C                   END
     C     UPRT6         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT6
     C                   END
     C     UPT6          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT6
     C                   END
     C     UPRT7         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT7
     C                   END
     C     UPT7          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT7
     C                   END
     C     UPRT8         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT8
     C                   END
     C     UPT8          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT8
     C                   END
     C     UPRT9         IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT9
     C                   END
     C     UPT9          IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT9
     C                   END
     C     UPRT10        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT10
     C                   END
     C     UPT10         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT10
     C                   END
     C     UPRT67        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT67
     C                   END
     C     UPT67         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT67
     C                   END
     C*
     C     UPRT57        IFEQ      *BLANKS
     C                   MOVEL     'QPRINT '     UPRT57
     C                   END
     C     UPT57         IFEQ      *BLANKS
     C                   MOVEL     '*STD'        UPT57
     C                   END
     C     SLUTT         TAG
N02  C     UJBKDIR       IFNE      'D'
N02  C                   CLOSE     SYFAFBFM
N02  C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1FM            2 0
     C                   MOVE      WSDTM         UDT2FM            2 0
     C                   MOVE      WSDTÅ         UDT3FM            2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1FM
     C                   PARM                    UDT2FM
     C                   PARM                    UDT3FM
     C                   MOVE      UDT1FM        WSDTD
     C                   MOVE      UDT2FM        WSDTM
     C                   MOVE      UDT3FM        WSDTÅ
     C*
     C                   ENDSR
     C*
