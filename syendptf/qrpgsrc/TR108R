********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 YBC PTF12 Ut med transportør
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT FORHÅNDSVARSLING             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 1-26                             ***
      *** LEDIGE INDIKATORER 31 37 51-95
      ***********************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FTRUH      IF   E           K DISK
N01  FTRUHFV    IF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVL03  IF A E           K DISK
     FTR108P    O    E             PRINTER USROPN
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(TR108P) -
     D                                     TOFILE(TR108P) -
     D                                     PRTQLTY(*NLQ) -
     D                                     FNTRSL(300) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST(' DEVTYPE(')
     D XCMD31          C                   CONST('PAGESIZE(70 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(70) -
     D                                     USRDTA(')
     D XCMD41          C                   CONST(') FORMTYPE(')
     D                SDS
     D  UUSER                254    263
      *
     C                   EXSR      INIT
      *
     C                   OPEN      TR108P
     C                   EXSR      PRINT
     C                   CLOSE     TR108P
      *
     C                   IF        UTYPE <> 'E'
     C                   EXSR      ARKIVSR
     C                   IF        ARKIVER = 'J'
     C                   CALL      'ARC002CLB'
     C                   PARM                    ARTYPE
     C                   PARM                    ARUSER
     C                   END
     C                   END
      *
     C                   MOVE      '1'           *INLR
      *
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
S01  C*                  MOVEL     XHTINS        XAN09             9
S01  C*                  IF        ((XHTINS <> *BLANKS) AND (XAN09 <> *ZEROS))
S01  C*                  EVAL      XHTINS = THLKS + THTINS
S01  C*                  ELSE
S01  C*                  EVAL      XHTINS = *BLANKS
S01  C*                  END
S01  C*                  MOVEL     XHTINK        XAN09             9
S01  C*                  IF        ((XHTINK <> *BLANKS) AND (XAN09 <> *ZEROS))
S01  C*                  EVAL      XHTINK = THLKK + THTINK
S01  C*                  ELSE
S01  C*                  EVAL      XHTINK = *BLANKS
S01  C*                  END
S01  C*                  MOVEL     XHTINA        XAN09             9
S01  C*                  IF        ((XHTINA <> *BLANKS) AND (XAN09 <> *ZEROS))
S01  C*                  EVAL      XHTINA = THLKA + THTINA
S01  C*                  ELSE
S01  C*                  EVAL      XHTINA = *BLANKS
S01  C*                  END
     C                   MOVE      '106'         YUNIK
     C                   MOVE      *BLANKS       YKODE
     C                   MOVE      *BLANKS       TKTXTN
     C                   MOVEL     THCATS        YKODE
     C     TRK01K        CHAIN     TRKODL01                           34
     C                   MOVE      TKTXTN        XHCATS
      *
     C                   WRITE     TR108P1
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UAVD              4
     C                   PARM                    UTDN              7
     C                   PARM                    UTRNR            18
     C                   PARM                    UTYPE             1
      *
     C     TRHK          KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     TRK01K        KLIST
     C                   KFLD                    YUNIK             3
     C                   KFLD                    YKODE            10
     C     KODKEY        KLIST
     C                   KFLD                    KOPUNI
     C                   KFLD                    THAVD
     C                   KFLD                    KOPLNR
     C     KEYARK        KLIST
     C                   KFLD                    ARTYPE
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
      *
     C                   MOVE      UAVD          THAVD
     C                   MOVE      UTDN          THTDN
     C     TRHK          CHAIN     TRUH                               33
N01  C     TRHK          CHAIN     TRUHFV                             33
     C                   IF        UTYPE = 'E'
     C                   MOVE      'te'          ARTYPE
     C     KEYARK        CHAIN     ARKIVL03                           33
     C                   EVAL      UTRNR = ARRFK
     C                   END
      *
     C                   MOVE      'P'           KOPUNI
     C                   MOVE      'N'           ARKIVER           1
     C                   BITON     '123457'      GRAAPP            1
     C                   BITOFF    '06'          GRAAPP
     C                   Z-ADD     1024          UCMDL            15 5
      *
     C                   EXSR      OVRF
      *
     C                   ENDSR
      ***********************************************
     C     OVRF          BEGSR
      ***********************************************
     C                   Z-ADD     99            KOPLNR
     C     KODKEY        CHAIN     KODTP                              33
     C                   IF        *IN33
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   MOVE      *BLANKS       KOPTY
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     KOPFM         READE     KODTFM                                 33
     C                   ENDIF
      *
     C                   IF        UTYPE = 'E'
     C                   EVAL      KOPNVN = 'OUTMAIL'
     C                   END
      *
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMD31:1      UCMD
     C                   CAT       UUSER:0       UCMD
     C                   CAT       XCMD41:1      UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       GRAAPP:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            34
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   ENDSR
      *
      *=====================================================================
      *  Oppdater arkivfil
      *=====================================================================
     C     ARKIVSR       BEGSR
      *=====================================================================
     C                   CLEAR                   ARKIVR
     C                   MOVE      THAVD         ARAVD
     C                   MOVE      THTDN         AROPD
      *
     C     KEYARK        CHAIN     ARKIVL03                           33
     C                   IF        *IN33
     C     *LOVAL        SETLL     FIRM
     C                   READE     FIRM                                   33
     C     FIFIRM        CHAIN     FIRMARC                            33
     C                   IF        *IN33 = '0'
     C     'te'          CHAIN     ARKTXT                             33
     C                   IF        ((*IN33 = '0') AND (ARKJN = 'J'))
      *
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      'F'           ARUNDE
     C                   MOVE      UUSER         ARUSER
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      THKNS         ARKUND
     C                   EVAL      ARRFK = UTRNR
     C                   WRITE     ARKIVR
     C                   MOVE      'J'           ARKIVER           1
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
