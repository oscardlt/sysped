/* N01: SJEKK L1DAT ELLER IBMDAT */
/*  Dette er kun en MODUL (kompiler med 15) som inngår i alle prog   */
/*  og calles via CALLB som er mindre ressurskrevende enn CALL       */
/*                                                                   */
/* Sett ønsket bibl.liste utfra kode (1, 2,  3..) på userid.         */
/*   1 =  Sysped default - (ugyldig/blank mm regnes som 1 )          */
/*  2,3,4,... er tenkt for flerfirma / spesialer.                    */
/* OBS!!   Dersom en lager kundespesialer i INCGI så må alle         */
/*         prog (som kunden benytter) skapes på ny (CRTPGM....)!!!!! */
/*                                                                   */
/* Dersom kuunden har rask server, så er det mye enklere å lage      */
/* flerfirma/kundespesial ved kall på vanlig CL  INCGIxxxxx          */
/*                                                                   */
/* OBS!!! Det er selve CGI-jobben (i delsystem QHTTPSVR type BCI)    */
/*        som får biblioteksliste endret. Denne jobben server alle   */
/*        slags CGI-henvendelser. Denne teknikken kan derfor være    */
/*        "livsfarlig" hvis det også kjøres webløsninger som IKKE    */
/*        har med sysped å gjøre. Kjør IKKE i DEFAULT men i "SYSPED" */
/*                                                                   */
/* Jobbene i QHTTPSVR har i utgangspunkt *CURLIB og QGPL QTEMP !!!!! */
/*                                                                   */

             PGM  PARM(&KODE)
             DCL        VAR(&KODE) TYPE(*CHAR) LEN(1)
/*N01*/      DCL        VAR(&LIB) TYPE(*CHAR) LEN(10) VALUE('IBMDAT')
/*KODE 1 STD */
             IF         COND(&KODE = '1') THEN(DO)
             CHGLIBL    LIBL(QTEMP SYENDRE SYENDPTF SYSPEDF SYSPED +
                          IBMDAT QGPL QGDDM) CURLIB(QHTTPSVR)
             ADDLIBLE   LIB(SMALIB) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(SMALIBF) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)
             GOTO       CMDLBL(RETURN)
             ENDDO
/*KODE 2 STD MED L1DAT */
             IF         COND(&KODE = '2') THEN(DO)
             CHGLIBL    LIBL(QTEMP SYENDRE SYENDPTF SYSPEDF SYSPED +
                          L1DAT QGPL QGDDM) CURLIB(QHTTPSVR)
             ADDLIBLE   LIB(SMALIB) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(SMALIBF) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)
             GOTO       CMDLBL(RETURN)
             ENDDO
/*KODE 3*/
             IF         COND(&KODE = '3') THEN(DO)
  /*         CHGLIBL    LIBL(QTEMP XXXNDRE XXXNDPTF XXXPEDF XXXPED) +*/
  /*                      CURLIB(QHTTPSVR)                           */
  /*         MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ERROR))      */
  /*         GOTO       CMDLBL(RETURN)                               */
             ENDDO

/*... bygg på videre....*/

/* ingen gyldig kode... Sett STD med L1DAT  */
ERROR:
/*KODE 1*/
             CHGLIBL    LIBL(QTEMP SYENDRE SYENDPTF SYSPEDF SYSPED +
                          L1DAT QGPL QGDDM) CURLIB(QHTTPSVR)
/*N01*/      MONMSG     MSGID(CPF0000)
/*N01*/      CHKOBJ     OBJ(L1DAT) OBJTYPE(*LIB)
/*N01*/      MONMSG     MSGID(CPF9801) EXEC(DO)
/*N01*/      CHGLIBL    LIBL(QTEMP SYENDRE SYENDPTF SYSPEDF SYSPED +
                          IBMDAT QGPL QGDDM) CURLIB(QHTTPSVR)
/*N01*/      ENDDO
             ADDLIBLE   LIB(SMALIB) POSITION(*FIRST) /* DO */
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(SMALIBF) POSITION(*FIRST)
             MONMSG     MSGID(CPF0000)
             GOTO       CMDLBL(RETURN)

RETURN:
             RETURN
             ENDPGM
