     FSYSJ73D   CF   E             WORKSTN
     FZILLOFL2  IF   E           K DISK
     F                                     RENAME(BILLOFR:BILLOFR1)
     FZILLOF    UF   E           K DISK
     FTELL      UF   E           K DISK
     FFIRM      IF   E           K DISK
      *___________________________
      * Arrays for string handling
      *"""""""""""""""""""""""""""
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                UDS
     D  UDAVD                 15     18
     D  UDSG                  19     21
     D                 DS
     D  TXT                    1     64
     D  SOTXT1                 1      8
     D  SOTXT2                 9     16
     D  SOTXT3                17     24
     D  SOTXT4                25     32
     D  SOTXT5                33     40
     D  SOTXT6                41     48
     D  SOTXT7                49     56
     D  SOTXT8                57     64
     D                 DS
     D  WSKNR                  1      8  0
     D  WSKNA                  9     16  0
     D  WSKNM                 17     24  0
     D  WSKNN                 25     32  0
     D  WSKNSA                33     40  0
     D  WSKNK                 41     48  0
     D  WSKNKA                49     56  0
     D  WSKNRA                57     64  0
     D  KN                     1     64
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
     C                   MOVE      *ZEROS        XAVD0             4 0
     C     *ENTRY        PLIST
     C                   PARM                    ULAD3G           30
     C* Hente firmaopplysninger
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
      * Hent overskrifter
     C                   MOVE      'DIV3114'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     8             XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT1            8
     C                   MOVE      'DIV3110'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT2            8
     C                   MOVE      'DIV3159'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT3            8
     C                   MOVE      'DIV3160'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT4            8
     C                   MOVE      'DIV3194'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT5            8
     C                   MOVE      'DIV1062'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT6            8
     C                   MOVE      'DIV3196'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT7            8
     C                   MOVE      'YBC0198'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT8            8
     C                   MOVE      'DIV1064'     XMSGNR
     C                   EXSR      HENTMS
     C                   MOVEL     XMSG          SOTXT9            8
     C                   Z-ADD     8             SOANTK            1 0
     C                   MOVE      *BLANKS       TXT
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

      *___________________________________________
      * Hent første post for dette containernummer
      *"""""""""""""""""""""""""""""""""""""""""""
     C     ULAD3G        CHAIN     ZILLOFL2                           51
     C                   MOVEL     BLAD3G        ZLAD3G
     C                   Z-ADD     BLAAR         ZLAAR
     C                   Z-ADD     BLUKE         ZLUKE
     C                   Z-ADD     BLAVD         ZLAVD
     C                   MOVEL     BLSG          ZLSG
     C                   Z-ADD     BLPRO         ZLPRO
     C                   MOVEL     BLOB          ZLOB
     C                   Z-ADD     BLKNR         ZLKNR
     C                   MOVEL     BLTR          ZLTR
     C                   MOVEL     BLLSS         ZLLSS
     C                   MOVEL     BLLSH         ZLLSH
     C                   MOVEL     BLVH          ZLVH
     C                   MOVEL     BLLOH         ZLLOH
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB1          TAG

     C  N30              MOVE      'SY00000'     ZMSGNO
     C                   WRITE     SYSJ73DØ
     C                   EXFMT     SYSJ73DA

     C     *IN03         IFEQ      '0'
     C     *IN12         ANDEQ     '0'

      *____
      * Søk
      *""""
     C     *IN04         IFEQ      *ON

      * Hvilket felt ?
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      * Båt
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     31
     C                   CALL      'SYSJ11A'
     C                   PARM                    ZLOB
     C                   GOTO      SRB1
     C                   ENDIF
      * Rederi
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     36
     C                   EXSR      SØKKUN
     C                   GOTO      SRB1
     C                   ENDIF
      * TR
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   CALL      'SYSJ17A'
     C                   PARM      ZLKNR         UKNR              8 0
     C                   PARM                    ZLTR
     C     UKNR          IFNE      0
     C     ZLTR          ANDNE     *BLANKS
     C                   MOVE      UKNR          ZLKNR
     C                   END
     C                   GOTO      SRB1
     C                   ENDIF
      * LSST
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    ZLLSS
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   GOTO      SRB1
     C                   ENDIF
      * LASTH
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    ZLLSH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   GOTO      SRB1
     C                   ENDIF
      * VIAH
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    ZLVH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   GOTO      SRB1
     C                   ENDIF
      * LOSSH
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     33
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK2
     C                   CALL      'SYFI10F'
     C                   PARM                    ZLLOH
     C                   PARM                    UNVN             30
     C                   PARM                    ULK2              2
     C                   GOTO      SRB1
     C                   ENDIF

     C                   GOTO      SRB1
     C                   ENDIF
      *___________________
      * Lag prosjektnummer
      *"""""""""""""""""""
     C     *IN06         IFEQ      *ON
     C     ZLAVD         CHAIN     TELL                               52
     C   52XAVD0         CHAIN     TELL                               52
     C  N52              MOVE      TETURN        ZLPRO
     C  N52              ADD       1             TETURN
     C  N52              UPDATE    TELLR
     C                   GOTO      SRB1
     C                   ENDIF
      *___________________________________________
      * Endre alle poster medsamme containernummer
      *"""""""""""""""""""""""""""""""""""""""""""
     C     ULAD3G        SETLL     ZILLOFL2
     C     ULAD3G        READE     ZILLOFL2                               53
     C     *IN53         DOWEQ     *OFF

     C     BLUNIK        CHAIN     ZILLOF                             54
     C     *IN54         IFEQ      *OFF
     C                   MOVEL     ZLAD3G        BLMN
     C                   Z-ADD     ZLAAR         BLAAR
     C                   Z-ADD     ZLUKE         BLUKE
     C                   Z-ADD     ZLAVD         BLAVD
     C                   MOVEL     ZLSG          BLSG
     C                   Z-ADD     ZLPRO         BLPRO
     C                   MOVEL     ZLOB          BLOB
     C                   Z-ADD     ZLKNR         BLKNR
     C                   MOVEL     ZLTR          BLTR
     C                   MOVEL     ZLLSS         BLLSS
     C                   MOVEL     ZLLSH         BLLSH
     C                   MOVEL     ZLVH          BLVH
     C                   MOVEL     ZLLOH         BLLOH
     C                   UPDATE    BILLOFR
     C                   ENDIF

     C     ULAD3G        READE     ZILLOFL2                               53
     C  N53              ENDDO

     C                   GOTO      SRB9

     C                   ENDIF

     C     SRB9          ENDSR
     C***********************************************
     C     SØKKUN        BEGSR

     C                   MOVE      TXT           UTXT             64
     C                   MOVE      *ZEROS        KN
     C                   MOVE      *BLANKS       UKD               8
     C                   Z-ADD     ZLKNR         WSKNR
     C                   MOVE      KN            UKN              64
     C                   CALL      'SOEKUNBL'
     C                   PARM                    FIFIRM
     C                   PARM                    SOANTK
     C                   PARM                    UTXT
     C                   PARM                    UKN
     C                   PARM                    UKD
     C                   MOVE      UKN           KN
     C                   Z-ADD     0             UFLAGG            1 0
     C                   MOVE      UTXT          TXT
     C                   MOVE      WSKNR         ZLKNR

     C                   ENDSR
     C***********************************************
     C     HENTMS        BEGSR
     C***********************************************
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             62
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
