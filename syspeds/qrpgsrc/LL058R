      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED UGYLDIGE LAGERLOKASJONER   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-11 13-24             ***
      *** LEDIGE INDIKATORER 28 29 31 32 34-39 41-54 95-97    ***
      ***********************************************************
      *
     FLLULLF    UF A E           K DISK
     FLL058D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  W2LLOK                 1     20
     D  LS                     1      9
     D                                     DIM(9)
     D  LS2                   10     20
     D  LS2L                   1      2
     D  LS2B                   3      4
     D  LS2H                   5      6
     D  LS3L                   1      3
     D  LS3B                   4      6
     D  LS3H                   7      9
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      W2LLOK        YLLOK            20
     C                   MOVE      *BLANKS       W2LLOK
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     LULLK1        SETLL     LLULLF
     C     UKD           READE(N)  LLULLF                                 94
     C  N94              MOVE      LULLOK        YLLOK2           20
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        10
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     UKD           READE(N)  LLULLF                                 94
     C  N94              MOVE      LULLOK        YLLOK2
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   SETOFF                                       9998
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C                   SETOFF                                       9830
      *** AVSLUTT
     C   03
     COR 12              GOTO      SLUTT
      *** FRISK OPP
     C   05              GOTO      START
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C     LULLK2        CHAIN(N)  LLULLF                             94
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C                   SETOFF                                       28
     C     W2NR          IFNE      ' '                                          1<-B
     C     W2LLOK        ORNE      *BLANKS
     C     W2NR          IFEQ      ' '                                           2<-B
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          IFEQ      '1'                                            3<-B
     C                   EXSR      LAGNY
     C                   END                                                      3<-E
     C                   Z-ADD     5             LINNBR
     C  N30              Z-ADD     2             POSNBR
     C   30              Z-ADD     5             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     LAGNY         BEGSR
      ***********************************************
     C     LULLK3        CHAIN     LLULLF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'YBC1720'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   MOVE      ' '           W2NR
     C                   GOTO      SLLNY
     C                   END
     C                   EXSR      TESTB
     C   30              GOTO      SLLNY
     C                   MOVE      UKD           LUKD
     C                   MOVE      W2LLOK        LULLOK
     C                   WRITE     LLULLFR
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      *BLANKS       W2LLOK
      *
     C     SLLNY         ENDSR
      *
      ***********************************************
     C     TESTB         BEGSR
      ***********************************************
     C     ULENG         IFNE      0                                            1<-B
     C     ULENG         IFGE      100                                           2<-B
     C     UBRED         ORGE      100
     C     UHØYD         ORGE      100
     C                   Z-ADD     9             XN                3 0
     C                   ELSE                                                    2
     C                   Z-ADD     6             XN
     C                   END                                                     2<-E
     C     1             DO        XN            XN2               3 0           2<-B
     C     LS(XN2)       IFLT      '0'                                            3<-B
     C     LS(XN2)       ORGT      '9'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0867'     MSGNR
     C                   GOTO      SLTST
     C                   END                                                      3<-E
     C                   ENDDO                                                   2<-E
     C                   MOVE      *ZEROS        XLENG             3 0
     C                   MOVE      *ZEROS        XBRED             3 0
     C                   MOVE      *ZEROS        XHØYD             3 0
     C     ULENG         IFGE      100                                           2<-B
     C     UBRED         ORGE      100
     C     UHØYD         ORGE      100
     C                   MOVE      LS3L          XLENG
     C                   MOVE      LS3B          XBRED
     C                   MOVE      LS3H          XHØYD
     C                   ELSE                                                    2
     C                   MOVE      LS2L          XLENG
     C                   MOVE      LS2B          XBRED
     C                   MOVE      LS2H          XHØYD
     C                   END                                                     2<-E
     C     ULENG         IFLT      XLENG                                         2<-B
     C     UBRED         ORLT      XBRED
     C     UHØYD         ORLT      XHØYD
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0867'     MSGNR
     C                   GOTO      SLTST
     C                   END                                                     2<-E
     C                   MOVE      *BLANKS       LS2
     C                   END                                                    1<-E
      *
     C     SLTST         ENDSR
      *
      ***********************************************
     C     HENT          BEGSR
      ***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       10            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     10            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     LULLOK        COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C     LULLK4        CHAIN     LLULLF                             33
     C                   DELETE    LLULLFR
     C                   MOVE      *BLANKS       LULLOK
     C                   MOVEL     '*DELETE'     LULLOK
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     LULLK1        KLIST
     C                   KFLD                    UKD
     C                   KFLD                    YLLOK
     C     LULLK2        KLIST
     C                   KFLD                    UKD
     C                   KFLD                    YLLOK2
     C     LULLK3        KLIST
     C                   KFLD                    UKD
     C                   KFLD                    W2LLOK
     C     LULLK4        KLIST
     C                   KFLD                    UKD
     C                   KFLD                    LULLOK
      *
     C     *ENTRY        PLIST
     C                   PARM                    UKD               5
     C                   PARM                    UTXT             30
     C                   PARM                    ULENG             3 0
     C                   PARM                    UBRED             3 0
     C                   PARM                    UHØYD             3 0
      *
     C                   MOVEL     UTXT          WSTXT
     C                   WRITE     WINDOWSZ
      * 50 OFF = lageret ER definert i L/B/H - > Definer UGYLDIGE
      * 50 ON  = lageret ER UDEFINERT - Definer GYLDIGE posisjoner
     C     ULENG         IFEQ      *Zeros
     C     UBRED         OREQ      *Zeros
     C     UHØYD         OREQ      *Zeros
     C                   MOVE      *ON           *IN50
     C                   END
      *
     C                   ENDSR
      *
