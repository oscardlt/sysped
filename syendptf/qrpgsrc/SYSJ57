********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 ARKIVERING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE BOOKING                         ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-50 52 56-59 61-99       ***
      ***********************************************************
      *
     FFREETXT2  IF   E           K DISK
     FBOOKING   UF   E           K DISK
     FBOOKIN2   IF   E           K DISK
     FBLLOK     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTRAN      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTFM    IF   E           K DISK
N01  FARKTXT    IF   E           K DISK
N01  FFIRMARC   IF   E           K DISK
N01  FARKIVL03  IF   E           K DISK    RENAME(ARKIVR:ARKIVR03)
N01  FARKIVP    O  A E             DISK    USROPN
     FSYSJ57P   O    E             PRINTER
     D                 DS
     D  XOBNA                  1     30
     D  XOBNA2                 1     27
     D                 DS
     D  BODTO                  1      8  0
     D  BODTL                  9     16  0
     D  BODTT                 17     24  0
     D  BODTP                 25     32  0
     D  BODTE                 33     40  0
     D  DT                     1     40  0
     D                                     DIM(5)
     D                 DS
     D  BOTIDO                 1      6  0
     D  BOTIDL                 7     12  0
     D  BOTIDT                13     18  0
     D  BOTIDP                19     24  0
     D  BOTIDE                25     30  0
     D  TID                    1     30  0
     D                                     DIM(5)
     D                 DS
     D  TRT                    1    700
     D                                     DIM(10)
     D  FREE01                 1     70
     D  FREE02                71    140
     D  FREE03               141    210
     D  FREE04               211    280
     D  FREE05               281    350
     D  FREE06               351    420
     D  FREE07               421    490
     D  FREE08               491    560
     D  FREE09               561    630
     D  FREE10               631    700
     D                 DS
     D  BOTFXO                 1      1
     D  BOTFXL                 2      2
     D  BOTFXT                 3      3
     D  BOTFXP                 4      4
     D  BOTFXE                 5      5
     D  TFX                    1      5
     D                                     DIM(5)
     D                 DS
     D  BOKNTO                 1      8  0
     D  BOKNTL                 9     16  0
     D  BOKNTT                17     24  0
     D  BOKNTP                25     32  0
     D  BOKNTE                33     40  0
     D  KNT                    1     40  0
     D                                     DIM(5)
     D                 DS
     D  BOKNCO                 1      8  0
     D  BOKNCL                 9     16  0
     D  BOKNCT                17     24  0
     D  BOKNCP                25     32  0
     D  BOKNCE                33     40  0
     D  KNC                    1     40  0
     D                                     DIM(5)
     D                 DS
     D  BOKNFO                 1      8  0
     D  BOKNFL                 9     16  0
     D  BOKNFT                17     24  0
     D  BOKNFP                25     32  0
     D  BOKNFE                33     40  0
     D  KNF                    1     40  0
     D                                     DIM(5)
     D                 DS
     D  XIDAGD                 1      2  0
     D  XIDAGM                 3      4  0
     D  XIDAGÅ                 5      6  0
     D  XIDAG                  1      6  0
     D                 DS
     D  XIDAG3                 1      4  0
     D  XIDAG2                 5      6  0
     D  XIDAG1                 7      8  0
     D  XIDAGX                 1      8  0
     D                 DS
     D  XDT1D                  1      2  0
     D  XDT1M                  3      4  0
     D  XDT1Å                  5      6  0
     D  XDT1                   1      6  0
     D                 DS
     D  BODT1Å                 1      4  0
     D  BODT1M                 5      6  0
     D  BODT1D                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  XDT3D                  1      2  0
     D  XDT3M                  3      4  0
     D  XDT3Å                  5      6  0
     D  XDT3                   1      6  0
     D                 DS
     D  BODT3Å                 1      4  0
     D  BODT3M                 5      6  0
     D  BODT3D                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  XDT4D                  1      2  0
     D  XDT4M                  3      4  0
     D  XDT4Å                  5      6  0
     D  XDT4                   1      6  0
     D                 DS
     D  BODT4Å                 1      4  0
     D  BODT4M                 5      6  0
     D  BODT4D                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  XDT5D                  1      2  0
     D  XDT5M                  3      4  0
     D  XDT5Å                  5      6  0
     D  XDT5                   1      6  0
     D                 DS
     D  BODT5Å                 1      4  0
     D  BODT5M                 5      6  0
     D  BODT5D                 7      8  0
     D  BODT5                  1      8  0
     D                UDS
     D  UFIRM                  1      2
N01  D                SDS
N01  D  UUSER                254    263
     C*
     C                   EXSR      INIT
     C*
     C* SKRIV TIL PRINTER
     C*
     C     BOOKK         CHAIN     BOOKING                            60
     C  N60              DO
     C                   MOVE      XIDAGX        DT(XN)
     C                   TIME                    TID(XN)
     C                   EXCEPT    BOMRK
     C                   EXSR      HEBOK2
     C     WOPFM         IFEQ      *BLANKS
     C                   EXSR      PRINT
     C                   ELSE
     C     WOPFM         SETLL     KODTFM
     C     *IN34         DOWEQ     '0'
     C     WOPFM         READE     KODTFM                                 34
     C     *IN34         IFEQ      '0'
     C                   EXSR      PRINT
     C                   END
     C                   END
     C                   END
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     HEBOK2        BEGSR
     C******************************************
     C                   MOVE      BODT3Å        UDTÅ
     C                   MOVE      BODT3M        UDTM
     C                   MOVE      BODT3D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT3Å
     C                   MOVE      UDTM          XDT3M
     C                   MOVE      UDTD          XDT3D
     C                   MOVE      BODT1Å        UDTÅ
     C                   MOVE      BODT1M        UDTM
     C                   MOVE      BODT1D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT1Å
     C                   MOVE      UDTM          XDT1M
     C                   MOVE      UDTD          XDT1D
     C                   MOVE      BODT4Å        UDTÅ
     C                   MOVE      BODT4M        UDTM
     C                   MOVE      BODT4D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT4Å
     C                   MOVE      UDTM          XDT4M
     C                   MOVE      UDTD          XDT4D
     C                   MOVE      BODT5Å        UDTÅ              2 0
     C                   MOVE      BODT5M        UDTM              2 0
     C                   MOVE      BODT5D        UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT5Å
     C                   MOVE      UDTM          XDT5M
     C                   MOVE      UDTD          XDT5D
     C*
     C     KODSFK        CHAIN     KODTSF                             33
     C   33              MOVE      *BLANKS       KOSFNV
     C*
     C     BOOK2K        CHAIN     BOOKIN2                            33
     C   33              EXSR      MOVB2
     C*
     C     BOKNRP        IFNE      0
     C                   MOVE      BOKNRP        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         BONARP
     C                   ELSE
     C     BONARP        IFEQ      *BLANKS
     C                   MOVE      BONAA         BONARP
     C                   END
     C                   END
     C*
     C                   MOVE      BOKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         XNAR             30
     C   33              MOVE      *ZEROS        XNAR
     C*
     C     BOKNT         IFEQ      0
     C                   SETON                                        33
     C                   MOVE      *BLANKS       XNAT
     C                   MOVEL     BONAT         XNAT
     C                   ELSE
     C                   MOVE      BOKNT         KUNDNR
     C     KUND1K        CHAIN     TRAN                               33
     C   33              MOVE      *BLANKS       XNAT
     C   33              MOVEL     BOKNR         XNAT
     C  N33              DO
     C                   MOVE      VMTRKU        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      VMNAVN        XNAT
     C                   END
     C  N33              MOVE      KNAVN         XNAT             30
     C  N33              MOVE      ADR1          XAD1T            30
     C  N33              MOVE      ADR2          XAD2T            30
     C  N33              MOVE      *BLANKS       XAD3T            30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XAD3T
     C                   ELSE
     C                   MOVEL     POSTNR        XAD3T
     C                   MOVE      ADR3          XAD3T
     C                   END
     C                   END
     C   33              MOVE      *BLANKS       XAD1T
     C   33              MOVE      *BLANKS       XAD2T
     C   33              MOVE      *BLANKS       XAD3T
     C*
     C                   MOVE      *ZEROS        SUMVKT           11 0
     C                   MOVE      *ZEROS        SUMKUB            9 3
     C*
     C                   MOVE      *BLANKS       XLBNA            30
     C     BOLB          CHAIN     CDBOAT                             33
     C  N33              MOVE      CBNAB         XLBNA
     C   33              MOVEL     BOLBN         XLBNA
     C*
     C                   MOVE      *BLANKS       XOBNA            30
     C     BOOB          CHAIN     CDBOAT                             33
     C  N33              MOVE      CBNAB         XOBNA
     C   33              MOVEL     BOOBN         XOBNA
     C*
     C                   MOVE      *BLANKS       XLSHN            30
     C     BOLSH         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLSHN
     C   33              MOVE      BOLSHN        XLSHN
     C*
     C                   MOVE      *BLANKS       XVHN             30
     C     BOVH          CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XVHN
     C   33              MOVEL     BOVHN         XVHN
     C*
     C                   MOVE      *BLANKS       XLSSN            30
     C     BOLSS         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLSSN
     C   33              MOVEL     BOLSSN        XLSSN
     C*
     C                   MOVE      *BLANKS       XLOSN            30
     C     BOLOS         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLOSN
     C   33              MOVEL     BOLOSN        XLOSN
     C*
     C                   MOVE      *BLANKS       XLOHN            30
     C     BOLOH         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLOHN
     C   33              MOVEL     BOLOHN        XLOHN
     C*
     C     BOCP          COMP      'C'                                    53
     C     BOCP          COMP      'P'                                    54
     C*
     C     SLHEB2        TAG
     C     B2IMCO        COMP      *BLANKS                            5555
     C     B2NAVH        IFEQ      *BLANKS
     C     BLLOKK        CHAIN     BLLOK                              33
     C  N33              MOVE      BENAM         B2NAVH
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVB2         BEGSR
     C******************************************
     C                   MOVE      *BLANKS       B2KDA
     C                   MOVE      *BLANKS       B2KDM
     C                   MOVE      *BLANKS       B2KDN
     C                   MOVE      *BLANKS       B2IMCO
     C                   MOVE      *BLANKS       B2PGNO
     C                   MOVE      *BLANKS       B2UNNO
     C                   MOVE      *BLANKS       B2COC
     C                   MOVE      *BLANKS       B2FP
     C                   MOVE      *BLANKS       B2PG
     C                   MOVE      *ZEROS        B2NT1
     C                   MOVE      *BLANKS       B2VT1
     C                   MOVE      *BLANKS       B2VS1
     C                   MOVE      *ZEROS        B2VKB1
     C                   MOVE      *ZEROS        B2VKN1
     C                   MOVE      *ZEROS        B2M31
     C                   MOVE      *ZEROS        B2NT2
     C                   MOVE      *BLANKS       B2VT2
     C                   MOVE      *BLANKS       B2VS2
     C                   MOVE      *ZEROS        B2VKB2
     C                   MOVE      *ZEROS        B2VKN2
     C                   MOVE      *ZEROS        B2M32
     C                   MOVE      *ZEROS        B2NT3
     C                   MOVE      *BLANKS       B2VT3
     C                   MOVE      *BLANKS       B2VS3
     C                   MOVE      *ZEROS        B2VKB3
     C                   MOVE      *ZEROS        B2VKN3
     C                   MOVE      *ZEROS        B2M33
     C                   MOVE      *ZEROS        B2NT4
     C                   MOVE      *BLANKS       B2VT4
     C                   MOVE      *BLANKS       B2VS4
     C                   MOVE      *ZEROS        B2VKB4
     C                   MOVE      *ZEROS        B2VKN4
     C                   MOVE      *ZEROS        B2M34
     C                   MOVE      *BLANKS       B2FRP
     C                   MOVE      *ZEROS        B2KNS
     C                   MOVE      *BLANKS       B2NAS
     C                   MOVE      *BLANKS       B2ADL
     C                   MOVE      *BLANKS       B2EMS
     C                   MOVE      *BLANKS       B2MFAG
     C                   MOVE      *BLANKS       B2MP
     C                   MOVE      *BLANKS       B2TLF
     C                   MOVE      *ZEROS        B2KNVH
     C                   MOVE      *BLANKS       B2NAVH
     C                   MOVE      *BLANKS       B2HSNR
     C*
     C                   ENDSR
     C*
     C******************************************
     C     HEKUND        BEGSR
     C******************************************
     C                   MOVE      KNT(XN)       KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         XTONA            30
     C  N33              MOVE      ADR1          XTOAD1           30
     C  N33              MOVE      ADR2          XTOAD2           30
     C  N33              MOVE      *BLANKS       XTOAD3           30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XTOAD3
     C                   ELSE
     C                   MOVEL     POSTNR        XTOAD3
     C                   MOVE      ADR3          XTOAD3
     C                   END
     C   33              MOVE      *BLANKS       XTONA
     C   33              MOVE      *BLANKS       XTOAD1
     C   33              MOVE      *BLANKS       XTOAD2
     C   33              MOVE      *BLANKS       XTOAD3
     C*
     C                   MOVE      KNC(XN)       KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         XCCNA            30
     C  N33              MOVE      ADR1          XCCAD1           30
     C  N33              MOVE      ADR2          XCCAD2           30
     C  N33              MOVE      *BLANKS       XCCAD3           30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XCCAD3
     C                   ELSE
     C                   MOVEL     POSTNR        XCCAD3
     C                   MOVE      ADR3          XCCAD3
     C                   END
     C   33              MOVE      *BLANKS       XCCNA
     C   33              MOVE      *BLANKS       XCCAD1
     C   33              MOVE      *BLANKS       XCCAD2
     C   33              MOVE      *BLANKS       XCCAD3
     C*
     C                   MOVE      KNF(XN)       KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         XFRNA            30
     C*
     C     XN            IFEQ      3
     C                   MOVE      BOKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      ADR1          XAD1A            30
     C  N33              MOVE      ADR2          XAD2A            30
     C  N33              MOVE      *BLANKS       XAD3A            30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XAD3A
     C                   ELSE
     C                   MOVEL     POSTNR        XAD3A
     C                   MOVE      ADR3          XAD3A
     C                   END
     C   33              MOVE      *BLANKS       XAD1A
     C   33              MOVE      *BLANKS       XAD2A
     C   33              MOVE      *BLANKS       XAD3A
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C     BOKDC1        IFNE      *BLANKS                                      1<-B
     C     BOMN1         IFNE      *BLANKS                                       2<-B
     C     BOKDC4        IFEQ      *BLANKS                                        3<-B
     C     BONT4         ANDEQ     0
     C     BOMN4         ANDEQ     *BLANKS
     C     BOVS4         ANDEQ     *BLANKS
     C     BOVKT4        ANDEQ     0
     C     BOM34         ANDEQ     0
     C                   MOVE      BOKDC3        BOKDC4
     C                   MOVE      BONT3         BONT4
     C                   MOVE      BOMN3         BOMN4
     C                   MOVE      BOVS3         BOVS4
     C                   MOVE      BOVKT3        BOVKT4
     C                   MOVE      BOM33         BOM34
     C                   MOVE      BOKDC2        BOKDC3
     C                   MOVE      BONT2         BONT3
     C                   MOVE      BOMN2         BOMN3
     C                   MOVE      BOVS2         BOVS3
     C                   MOVE      BOVKT2        BOVKT3
     C                   MOVE      BOM32         BOM33
     C                   MOVE      *BLANKS       BOKDC2
     C                   MOVE      *ZEROS        BONT2
     C                   MOVE      *BLANKS       BOMN2
     C                   MOVE      *BLANKS       BOVS2
     C                   MOVE      *ZEROS        BOVKT2
     C                   MOVE      *ZEROS        BOM32
     C                   ELSE                                                     3
     C                   GOTO      STPR10
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     BOKDC1        CHAIN     CDCON4                             51
     C     BOMN1         IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     CC4FT         BOMN1
     C                   ELSE                                                    2
     C                   MOVEL     CC4FT         BOMN2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     BOKDC2        IFNE      *BLANKS                                      1<-B
     C     BOMN2         IFNE      *BLANKS                                       2<-B
     C     BOKDC4        IFEQ      *BLANKS                                        3<-B
     C     BONT4         ANDEQ     0
     C     BOMN4         ANDEQ     *BLANKS
     C     BOVS4         ANDEQ     *BLANKS
     C     BOVKT4        ANDEQ     0
     C     BOM34         ANDEQ     0
     C                   MOVE      BOKDC3        BOKDC4
     C                   MOVE      BONT3         BONT4
     C                   MOVE      BOMN3         BOMN4
     C                   MOVE      BOVS3         BOVS4
     C                   MOVE      BOVKT3        BOVKT4
     C                   MOVE      BOM33         BOM34
     C                   MOVE      *BLANKS       BOKDC3
     C                   MOVE      *ZEROS        BONT3
     C                   MOVE      *BLANKS       BOMN3
     C                   MOVE      *BLANKS       BOVS3
     C                   MOVE      *ZEROS        BOVKT3
     C                   MOVE      *ZEROS        BOM33
     C                   ELSE                                                     3
     C                   GOTO      STPR10
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     BOKDC2        CHAIN     CDCON4                             51
     C     BOMN2         IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     CC4FT         BOMN2
     C                   ELSE                                                    2
     C                   MOVEL     CC4FT         BOMN3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     BOKDC3        IFNE      *BLANKS                                      1<-B
     C     BOMN3         IFNE      *BLANKS                                       2<-B
     C     BOKDC4        IFNE      *BLANKS                                        3<-B
     C     BONT4         ORNE      0
     C     BOMN4         ORNE      *BLANKS
     C     BOVS4         ORNE      *BLANKS
     C     BOVKT4        ORNE      0
     C     BOM34         ORNE      0
     C                   GOTO      STPR10
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     BOKDC3        CHAIN     CDCON4                             51
     C     BOMN3         IFEQ      *BLANKS                                       2<-B
     C                   MOVEL     CC4FT         BOMN3
     C                   ELSE                                                    2
     C                   MOVEL     CC4FT         BOMN4
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     BOKDC4        IFNE      *BLANKS                                      1<-B
     C     BOMN4         ANDEQ     *BLANKS
     C     BOKDC4        CHAIN     CDCON4                             51
     C                   MOVEL     CC4FT         BOMN4
     C                   END                                                    1<-E
     C     STPR10        TAG
     C     BOVKT1        ADD       BOVKT2        XSUMVK
     C                   ADD       BOVKT3        XSUMVK
     C                   ADD       BOVKT4        XSUMVK
     C     BOM31         ADD       BOM32         XSUMKB
     C                   ADD       BOM33         XSUMKB
     C                   ADD       BOM34         XSUMKB
     C*
     C     TFX(XN)       COMP      'T'                                    51
     C                   EXSR      HEKUND
     C                   WRITE     LHEAD
     C                   SELECT
     C     XN            WHENEQ    1
     C                   WRITE     TELFAX
     C     XN            WHENEQ    2
     C                   WRITE     TELFA2
     C     XN            WHENEQ    3
     C                   EXSR      FREESR
     C                   WRITE     TELFA3
     C     XN            WHENEQ    4
     C                   WRITE     TELFA4
     C                   OTHER
     C                   WRITE     TELFA5
     C                   ENDSL
N01   *
N01  C                   exsr      arkivsr
     C*
     C                   ENDSR
     C*
N01   *=====================================================================
N01  C     ARKIVSR       BEGSR
N01   *=====================================================================
N01  C     ARKIVL03K     CHAIN     ARKIVL03                           33
N01  C                   IF        *IN33
N01  C     UFIRM         CHAIN     FIRMARC                            33
N01  C                   IF        *IN33 = *OFF
N01  C     'bo'          CHAIN     ARKTXT                             33
N01  C  N33              IF        ARKJN = 'J'
N01   *
N01  C                   OPEN      ARKIVP
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      UFIRM         ARFIRM
N01  C                   MOVE      BOAVD         ARAVD
N01  C                   MOVE      BOOPD         AROPD
N01  C                   EVAL      ARUNDE = XARUNDE
N01  C                   MOVE      'bo'          ARTYPE
N01  C                   MOVE      UUSER         ARUSER
N01  C                   MOVE      WDT           ARDATE
N01  C                   MOVE      WTM           ARTIME
N01  C                   MOVE      KNT(XN)       ARKUND
N01  C                   WRITE     ARKIVR
N01  C                   CLOSE     ARKIVP
N01  C                   CALL      'ARC002CLB'
N01  C                   PARM                    ARTYPE
N01  C                   PARM                    ARUSER
N01  C                   END
N01  C                   END
N01  C                   END
N01   *
N01  C                   ENDSR
N01   *
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     BOOKK         KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     BOOK2K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     BLLOKK        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    BOSG
     C     FREEKE        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    YTRANS            1
     C                   MOVE      'T'           YTRANS
N01  C     ARKIVL03K     KLIST
N01  C                   KFLD                    XARTYPE
N01  C                   KFLD                    BOAVD
N01  C                   KFLD                    BOOPD
N01  C                   KFLD                    XARUNDE
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UAVDP             4
     C                   PARM                    UOPDP             7
     C                   PARM                    UNR               1
      * HENT STRINGKODE
     C                   Z-ADD     29            WTSKRN            3 0
     C                   MOVE      UAVDP         LOSAV2            4 0
     C                   CALL      'SYGE01B'
     C                   PARM                    LOSAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C                   PARM                    WLASER            1
      *
     C                   MOVE      UAVDP         YAVD              4 0
     C                   MOVE      UOPDP         YOPD              7 0
     C                   MOVE      UNR           XN                1 0
N01  C                   MOVE      'bo'          XARTYPE           2
N01  C                   SELECT
N01  C                   WHEN      XN = 1
N01  C                   MOVEL     'OS'          XARUNDE          10
N01  C                   WHEN      XN = 2
N01  C                   MOVEL     'LO'          XARUNDE
N01  C                   WHEN      XN = 3
N01  C                   MOVEL     'TR'          XARUNDE
N01  C                   WHEN      XN = 4
N01  C                   MOVEL     'DE'          XARUNDE
N01  C                   WHEN      XN = 5
N01  C                   MOVEL     'TE'          XARUNDE
N01  C                   ENDSL
     C*
     C                   MOVE      'SF'          YSFUNI            2
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          XIDAG3
     C                   ELSE
     C     UYEAR         ADD       2000          XIDAG3
     C                   END
     C                   MOVE      UMONTH        XIDAG2
     C                   MOVE      UDAY          XIDAG1
     C                   MOVE      UYEAR         UDTÅ              2 0
     C                   MOVE      UMONTH        UDTM              2 0
     C                   MOVE      UDAY          UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XIDAGÅ
     C                   MOVE      UDTM          XIDAGM
     C                   MOVE      UDTD          XIDAGD
     C                   MOVE      *ZEROS        KNT
     C                   MOVE      *ZEROS        KNC
     C                   MOVE      *ZEROS        KNF
     C                   MOVE      *BLANKS       TFX
     C                   MOVE      *ZEROS        DT
     C                   MOVE      *ZEROS        TID
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDTD
     C                   PARM                    UDTM
     C                   PARM                    UDTÅ
     C*
     C                   ENDSR
     C*
     C******************************************
     C     FREESR        BEGSR
     C******************************************
     C*
     C     FREEKE        SETLL     FREETXT2
     C     1             DO        10            NR                2 0
     C     FREEKE        READE     FREETXT2                               33
     C   33              GOTO      UTFRI
     C  N33              MOVE      FRTTXT        TRT(NR)
     C                   END
     C     UTFRI         ENDSR
     OBOOKINGR  E            BOMRK
     O                       BODTO
     O                       BOTIDO
     O                       BODTL
     O                       BOTIDL
     O                       BODTT
     O                       BOTIDT
     O                       BODTP
     O                       BOTIDP
     O                       BODTE
     O                       BOTIDE
