********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 FEILMELDING DERSOM......
********************************************************************
      *
     FTRACKF    O  A E           K DISK
     FHEADF     UF   E           K DISK
     FDOKEQ     IF   E           K DISK
     FDOKEF     UF   E           K DISK
     FDOKEF1    IF   E           K DISK
     F                                     RENAME(DOKEFR:DOKEFR2)
     FCUNDL01   IF   E           K DISK
     FFAK2      IF   E           K DISK
     FSTED2     IF   E           K DISK
     FHLOGO     IF   E           K DISK
     FELOGO     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTW     IF   E           K DISK
     FTELLA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTG2    IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FKODTDIS   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCNFF      UF   E             DISK    USROPN
     FLABF      IF A E             DISK    USROPN
     FISUL01    IF   E           K DISK    USROPN
     FPARL01    IF   E           K DISK    USROPN
     FDOLAF     UF A E             DISK
     F                                     INFDS(DOLADS)
     FMCAWF     IF   E           K DISK
     FSYEF14FM  CF   E             WORKSTN USROPN
     FSYEF14P   O    E             PRINTER
     FMERKL1    O    F   50        PRINTER
     F                                     FORMLEN(18)
     F                                     FORMOFL(18)
     FMERKL2    O    F   50        PRINTER
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     D KA1             S              4  0 DIM(6)
     D WR1             S              1    DIM(9)
     D WR2             S              1    DIM(17)
     D WR3             S              1    DIM(30)
     D AR1             S              1    DIM(30)
     D AR2             S              1    DIM(30)
     D RE              S              1    DIM(88)
     D RE1             S              1    DIM(44)
     D RE2             S              1    DIM(44)
     D                 DS
     D  TEAC11                 1      1
     D  TEAC21                 2      2
     D  TEAC34                 3      6
     D  TEAC74                 7     10
     D  TEAACC                 1     10
     D                 DS
     D  KFAC11                 1      1
     D  KFAC21                 2      2
     D  KFAC34                 3      6
     D  KFAC74                 7     10
     D  KFSAC                  1     10
     D                 DS
     D  KFS012                 1      2
     D  KFS031                 3      3
     D  KFS041                 4      4
     D  KFS051                 5      5
     D  KFS064                 6      9
     D  KFS101                10     10
     D  KFS114                11     14
     D  XKFSAC                 1     14
      *
      * DOBBELTDEFINERINGER GRUNNET EKSTERN PRINTERFIL
      *
     D                 DS
     D  AREF06                 1      6
     D  HESAML                 1      6
     D                 DS
     D  DFROA1                 1      3
     D  ZFROA1                 1      3
     D  DFROA2                 4      6
     D  ZFROA2                 4      6
     D  DFROA3                 7      9
     D  ZFROA3                 7      9
     D  DFBLT                 40     48  2
     D  ZFBLT                 40     48  2
     D  DFBLA                 49     57  2
     D  ZFBLA                 49     57  2
     D  XCACOL                58     66  2
     D  YCACOL                58     66  2
     D  XCAPRE                67     75  2
     D  YCAPRE                67     75  2
     D                 DS
     D  FN                     1     90  2 DIM(9)
     D  FN01                   1     10  2
     D  FN02                  11     20  2
     D  FN03                  21     30  2
     D  FN04                  31     40  2
     D  FN05                  41     50  2
     D  FN06                  51     60  2
     D  FN07                  61     70  2
     D  FN08                  71     80  2
     D  FN09                  81     90  2
     D                 DS
     D  FK                     1     63    DIM(9)
     D  FK01                   1      7
     D  FK02                   8     14
     D  FK03                  15     21
     D  FK04                  22     28
     D  FK05                  29     35
     D  FK06                  36     42
     D  FK07                  43     49
     D  FK08                  50     56
     D  FK09                  57     63
     D                 DS
     D  WSOP1                  1      7  0
     D  WSOP2                  8     14  0
     D  WSOP3                 15     21  0
     D  WSOP4                 22     28  0
     D  WSOP5                 29     35  0
     D  WSOP6                 36     42  0
     D  WSOP7                 43     49  0
     D  WSOP8                 50     56  0
     D  WSOP9                 57     63  0
     D  WSOP10                64     70  0
     D  WSOP11                71     77  0
     D  WSOP12                78     84  0
     D  WSOP13                85     91  0
     D  WSOP14                92     98  0
     D  WSOP15                99    105  0
     D  WSOP16               106    112  0
     D  WSOP17               113    119  0
     D  WSOP18               120    126  0
     D  WSOP19               127    133  0
     D  WSOP20               134    140  0
     D  NØ                     1    140  0 DIM(20)
     D                 DS
     D  XARKB                  5      6  0
     D  XARKH                  8      9  0
     D  XARK                   1     10
     D                 DS
     D  XAWB41                 1      4  0
     D  XAWB42                 6      9  0
     D  XAWB9                  1      9
     D                 DS
     D  XPAR1H                 1      2  0
     D  XPAR1D                 4      5  0
     D  XPAR2H                 7      8  0
     D  XPAR2D                10     11  0
     D  XPAR                   1     11
     D                 DS
     D  XFLY1                  1      3
     D  FL                     1      3    DIM(3)
     D                 DS
     D  KA                     1     24    DIM(6)
     D  DFNT1                  1      4
     D  DFNT2                  5      8
     D  DFNT3                  9     12
     D  DFNT4                 13     16
     D  DFNT5                 17     20
     D  DFNT6                 21     24
     D                 DS
     D  VE                     1     42  1 DIM(6)
     D  DFVKT1                 1      7  1
     D  DFVKT2                 8     14  1
     D  DFVKT3                15     21  1
     D  DFVKT4                22     28  1
     D  DFVKT5                29     35  1
     D  DFVKT6                36     42  1
     D                 DS
     D  RA                     1      6    DIM(6)
     D  DFRC1                  1      1
     D  DFRC2                  2      2
     D  DFRC3                  3      3
     D  DFRC4                  4      4
     D  DFRC5                  5      5
     D  DFRC6                  6      6
     D                 DS
     D  IT                     1     24    DIM(6)
     D  DFCOM1                 1      4
     D  DFCOM2                 5      8
     D  DFCOM3                 9     12
     D  DFCOM4                13     16
     D  DFCOM5                17     20
     D  DFCOM6                21     24
     D                 DS
     D  FV                     1     42  1 DIM(6)
     D  DFFBV1                 1      7  1
     D  DFFBV2                 8     14  1
     D  DFFBV3                15     21  1
     D  DFFBV4                22     28  1
     D  DFFBV5                29     35  1
     D  DFFBV6                36     42  1
     D                 DS
     D  MI                     1      6    DIM(6)
     D  DFRK1                  1      1
     D  DFRK2                  2      2
     D  DFRK3                  3      3
     D  DFRK4                  4      4
     D  DFRK5                  5      5
     D  DFRK6                  6      6
     D                 DS
     D  PR                     1     48  2 DIM(6)
     D  DFRPR1                 1      8  2
     D  DFRPR2                 9     16  2
     D  DFRPR3                17     24  2
     D  DFRPR4                25     32  2
     D  DFRPR5                33     40  2
     D  DFRPR6                41     48  2
     D                 DS
     D  BE                     1     60  2 DIM(6)
     D  DFBLT1                 1     10  2
     D  DFBLT2                11     20  2
     D  DFBLT3                21     30  2
     D  DFBLT4                31     40  2
     D  DFBLT5                41     50  2
     D  DFBLT6                51     60  2
     D                 DS
     D  VA                     1    250    DIM(10)
     D  DFVS1                  1     25
     D  DFVS2                 26     50
     D  DFVS3                 51     75
     D  DFVS4                 76    100
     D  DFVS5                101    125
     D  DFVS6                126    150
     D  DFVS7                151    175
     D  DFVS8                176    200
     D  DFVS9                201    225
     D  DFVS10               226    250
     D                 DS
     D  KOAIAT                 1      7  0
     D  XIAT1                  1      2  0
     D  XIAT2                  3      3  0
     D  XIAT3                  4      7  0
     D                 DS
     D  DFROB1                 1      7
     D  XROB12                 1      2
     D                 DS
     D  DFROB2                 1      7
     D  XROB22                 1      2
     D                 DS
     D  DFROB3                 1      7
     D  XROB32                 1      2
     D                 DS
     D  HEGN                   1     15
     D  HEGN11                 5     15
     D  XGN1                   5      5
     D  XGN2                   6      6
     D  XGN3                   7      7
     D  XGN4                   8      8
     D  XGN5                   9      9
     D  XGN6                  10     10
     D  XGN7                  11     11
     D  XGN8                  12     12
     D  XGN9                  13     13
     D  XGN10                 14     14
     D  XGN11                 15     15
     D  XGN                    8     15
     D  WHEGN3                 5      7
     D  WHEGN8                 8     15
     D                 DS
     D  HEHAWB                 1      9
     D  XHAWB                  4      9  0
     D  XHAWB1                 4      4  0
     D  XHAWB2                 5      5  0
     D  XHAWB3                 6      6  0
     D  XHAWB4                 7      7  0
     D  XHAWB5                 8      8  0
     D  XHAWB6                 9      9  0
     D                 DS
     D  HESDF                  1      5
     D  XSDF1                  1      1
     D  XSDF2                  2      2
     D  XSDF3                  3      3
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  WRK2T3                 1    142
     D  WRK2A                  1     65
     D  WRK2B                 66    130
     D  WRK2C                131    142
     D                 DS
     D  FIN                    1    245    DIM(7)
     D  DFINF1                 1     35
     D  DFINF2                36     70
     D  DQINF3                71    105
     D  DQINF4               106    140
     D  DQINF5               141    175
     D  DQINF6               176    210
     D  DQINF7               211    245
     D                 DS
     D  DATT1                  1      2
     D  DATT2                  3      4
     D  DATT3                  5      6
     D  DATT                   1      6
     D                 DS            14
     D PRICAR          C                   CONST('PRIORITY CARGO')
     D                 DS
     D  AWBDES                 1     14
     D  WHESDT                 4      6
     D                 DS
     D  ROUTIN                 1     16
     D  WWA                    1      3
     D  WWB                    5     11
     D  WWC                   12     12
     D  WWD                   13     14
     D                 DS
     D  WARECA                 1      9  0
     D                 DS
     D  ELT1                   1     22
     D  ELT117                 1     17
     D                 DS            24
     D FTXT            C                   CONST('AS AGENT FOR THE -
     D                                     CARRIER')
     D                 DS            12
     D FTXT2           C                   CONST('AS AGENT FOR')
     D                 DS            11
     D FTXT3           C                   CONST('AS CARRIER,')
     D                 DS            11
     D NUM             C                   CONST(' 0123456789')
      *
      * Get recordnumber from file
     D DOLADS          DS
     D  DORECN               397    400B 0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UOPD                  23     29  0
     D  UDT                   30     35  0
     D  UGN                   36     46
     D  UHOD                  47     47
     D  UBBS                  48     48
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                SDS
     D  WUSER                254    263
     IDOLAR
     I              LAISTX                      DOISTX
      *
     C                   EXSR      INIT
      *
     C                   SETOFF                                       27
      *
      *** UIN08 = 1  -->  KOPIER FLYFRAKTBREV
     C     UIN08         IFEQ      '1'
     C                   OPEN      SYEF14FM
     C                   MOVEL     UAVD          DFAVD
     C                   EXFMT     BILDE01
     C   03              GOTO      SLUTT
     C                   Z-ADD     0             WN
     C                   ELSE
     C     DOKF1K        SETLL     DOKEF1
     C                   END
      *
     C     START         TAG
     C     UIN08         IFEQ      '1'
     C     WN            IFEQ      20
     C                   GOTO      SLUTT
     C                   ELSE
     C                   ADD       1             WN
     C     NØ(WN)        IFEQ      0
     C                   GOTO      START
     C                   END
     C                   MOVE      NØ(WN)        DFOPD
     C                   END
     C                   EXSR      KOPI
     C                   GOTO      START
     C                   END
      *
      *** UIN08 = 0  -->  SKRIV UT ORGINALE FLYFRAKTBREV
     C     DOKF1K        READE     DOKEF1                                 44
     C  N44              DO
     C     DFRI          COMP      'F'                                    45
     C   45DFSG          COMP      USG                                    45
     C   45UOPD          IFNE      0
     C     UOPD          COMP      DFOPD                                  45
     C   45UAVD          COMP      DFAVD                                  45
     C                   END
      *
     C                   SETOFF                                       5051
     C   45              DO
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      *BLANKS       XIAT4             5
     C     KOAIA2        IFNE      *ZEROS
     C                   MOVEL     '/'           XIAT4
     C                   MOVE      KOAIA2        XIAT4
     C                   END
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   EXSR      PRINT
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   GOTO      START
     C                   END
     C                   SETON                                        27
     C                   EXSR      PRINT
     C                   SETOFF                                       27
      *
      * UTFØRER RUTINER FOR Å SENDE FRAKTBREV ELEKTRONISK
      *
     C     *IN77         IFEQ      '1'
     C     DFCMN         IFEQ      'J'
     C     DFCMN         OREQ      'Y'
     C     DFCMN         OREQ      'j'
     C     DFCMN         OREQ      'y'
     C                   EXSR      OPNFIL                                       <Åpne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTFWB                                       <Call FWB pgm.
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ENDIF                                                  <DFCMN
     C                   ENDIF                                                  <*IN77
      *
     C     DOKEFK        CHAIN     DOKEF                              33
     C                   MOVE      'P'           DFST
     C   51              MOVE      'P'           DFKDME
     C                   UPDATE    DOKEFR
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      'P'           HEPK8
     C  N33              UPDATE    HEADFR
     C     FIURBL        IFEQ      'J'
     C                   EXSR      TTSR
     C                   END
     C                   END
     C*
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     UIN08         IFEQ      '1'
     C                   CLOSE     SYEF14FM
     C                   END
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C                   RETURN
      *
      ******************************************
     C     KOPI          BEGSR
      ******************************************
     C     STKOPI        TAG
     C     DOKEFK        CHAIN     DOKEF                              44
     C  N44              UPDATE    DOKEFR
     C  N44DFST          COMP      'P'                                4444
     C   44              EXFMT     BILDE02
     C   44WSOPD         IFEQ      0
     C                   GOTO      SLKOPI
     C                   ELSE
     C                   MOVE      WSOPD         DFOPD
     C                   GOTO      STKOPI
     C                   END
      *
     C                   EXSR      PRINT
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   EXFMT     BILDE03
     C                   GOTO      SLKOPI
     C                   END
     C                   SETON                                        27
     C                   EXSR      PRINT
     C                   SETOFF                                       27
      *
     C     SLKOPI        ENDSR
      *
     C******************************************
     C     PRINT         BEGSR
     C******************************************
      *
     C   27              GOTO      TAG01
     C     'DISPU'       CHAIN     KODTDIS                            33
     C     HEADFK        CHAIN     MCAWF                              33
     C     *IN33         IFEQ      *OFF
     C                   Z-ADD     MCAWFE        KDSBL4
     C                   ENDIF
     C                   MOVE      *ZEROS        XTDUA             9 2
      *
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              UPDATE    HEADFR
     C     HEKNS         IFNE      *ZEROS                                         1 B
     C     KEYKUS        CHAIN     CUNDL01                            33
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   END                                                     1<-E
     C     HEGN11        IFEQ      *ZEROS
     C     HEGN11        OREQ      *BLANKS
     C                   GOTO      SLPRIN
     C                   END
     C     HEGN11        IFGT      *ZEROS
     C                   MOVEL     XGN           XAWB41
     C                   MOVE      XGN           XAWB42
     C                   ELSE
     C                   MOVE      *ZEROS        XAWB41
     C                   MOVE      *ZEROS        XAWB42
     C                   END
      *
      * GETS COUNTRY IN FULL TEXT
      *
     C                   MOVE      *BLANKS       KJLAND
     C                   MOVE      *BLANKS       SELAND
     C                   MOVE      HELKS         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        SELAND           30
     C     DQAD4         IFEQ      *BLANKS
     C                   MOVE      HELKK         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        KJLAND           30
     C                   END
      *
     C     HEHAWB        COMP      *ZEROS                                 77
      *
      * UTFØRES KUN VED SINGLE INDIKATOR 77
      * GJØRESELLERS VED UTSKRIFT AV MASTER
      *
     C  N50
     CAN 77DFKDME        IFEQ      'J'
     C                   EXSR      PRINT2
     C                   SETON                                        5051
     C                   END
      *
      *SY* NY KODE REGISTRERING FOR BEGGE TYPER
      *
     C  N50
     CAN 77DFKDME        IFEQ      'B'
     C                   EXSR      PRINT2
     C                   SETON                                        5051
     C                   END
      *
      * UTFØRER RUTINE FOR Å SKRIVE BARCODE MERKELAPP
      * HVIS DET ER BEDT OM DET. KUN SINGEL
     C     *IN77         IFEQ      '1'
     C     DFKDME        IFEQ      'S'
     C     FITDVI        IFEQ      'J'
     C                   MOVE      *OFF          *IN90
     C                   EXSR      OPNFIL                                       <Åpne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      PRINT3                                       <Write Label data
     C     *IN90         IFEQ      '0'
     C                   EXSR      SNDTA2                                       <Send dataq
     C                   SETON                                        5051
     C                   ENDIF                                                  <*IN90
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ELSE
     C                   EXSR      PRINT4
     C                   SETON                                        5051
     C                   ENDIF                                                  <FITDVI
     C                   ELSE
     C                   MOVE      *ON           *IN90
     C                   ENDIF                                                  <DFKDME
     C                   ENDIF                                                  <*IN77
     C*
     C                   MOVE      *ZEROS        XDISBL            5 0
     C*
     C     HEHAWB        IFEQ      *ZEROS
     C     DFFSN         CHAIN     ELOGO                              33
     C                   ELSE
     C     KOWLAS        CHAIN     HLOGO                              33
     C     *IN33         IFEQ      *OFF
     C                   MOVEL     HLT1          ELT1
     C                   MOVEL     HLT2          ELT2
     C                   MOVEL     HLT3          ELT3
     C                   MOVEL     HLT4          ELT4
     C                   MOVEL     HLT5          ELT5
     C                   MOVEL     HLT6          ELT6
     C                   ELSE
     C     999           CHAIN     ELOGO                              33
     C                   ENDIF
     C                   END
     C     KODFSK        CHAIN     KODTFS                             33
     C                   MOVE      *BLANKS       XKFSAC
     C     KFAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      KFAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      KFAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      KFAC74        KFS114
     C                   ELSE
     C                   MOVEL     KFSAC         XKFSAC
     C                   END
     C     HEADFK        CHAIN     MCAWF                              33
     C     *IN33         IFEQ      *OFF
     C                   Z-ADD     MCMCFE        KFSMC
     C                   ENDIF
      *
     C     KOWLAS        IFNE      ' '
     C     TELLAK        CHAIN     TELLA                              33
     C  N33TEAACC        IFNE      *BLANKS
     C     TEAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      TEAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      TEAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      TEAC74        KFS114
     C                   ELSE
     C                   MOVE      *BLANKS       XKFSAC
     C                   MOVEL     TEAACC        XKFSAC
     C                   END
     C                   END
     C                   END
      *
     C     XROB12        COMP      KFSKD2                             7979
     C  N77              SETON                                        79
      *
     C     HESDF         CHAIN     STED2                              66
     C  N66              MOVE      ST2NVN        ZFRAFL           30
     C     HESDT         CHAIN     STED2                              66
     C                   MOVEL     ST2NVN        WW2NVN
      *
     C     KODSFK        CHAIN     KODTSF                             33
     C     DFBELF        COMP      0                                      40
      *
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
     C     DFCCPP        COMP      'CC'                                   70
     C   70              EXSR      SUM
     C   70              Z-ADD     XTKJØ         XTDUA
     C  N70              Z-ADD     KDSBL4        XTDUA
     C  N70XTDUA         IFEQ      0
     C  N70              EXSR      SUM3
     C                   END
      *
      * SKAL BELØP MOT CARRIER PÅ MOTSATT SIDE
      * MED HENSYN TIL CC/PP
      *
     C                   MOVE      *ZEROS        XCAPRE
     C                   MOVE      *ZEROS        XCACOL
      *
     C   70DFKDDC        IFEQ      'P'
     C                   Z-ADD     DFBLDC        XCAPRE            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
     C  N70DFKDDC        IFEQ      'C'
     C                   Z-ADD     DFBLDC        XCACOL            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
      *
     C   70XCAPRE        COMP      *ZEROS                             35
     C  N70XCACOL        COMP      *ZEROS                             35
      *
      * HOPPES HIT VED PRINT AV 2. SIDE FLYFRAKT
      *
     C     TAG01         TAG
      *
      * HENTE TILLEGGSOPPLYSNINGER
      *
     C     DOKEQK        CHAIN     DOKEQ                              88
     C   88              DO
     C                   MOVE      *BLANKS       DQNA
     C                   MOVE      *BLANKS       DQAD1
     C                   MOVE      *BLANKS       DQAD2
     C                   MOVE      *BLANKS       DQAD3
     C                   MOVE      *BLANKS       DQAD4
     C                   MOVE      *BLANKS       DQINFD
     C                   MOVE      *BLANKS       DQINF3
     C                   MOVE      *BLANKS       DQINF4
     C                   MOVE      *BLANKS       DQINF5
     C                   MOVE      *BLANKS       DQINF6
     C                   MOVE      *BLANKS       DQINF7
     C                   MOVE      *BLANKS       DQINF8
     C                   MOVE      *BLANKS       DQINF9
     C                   MOVE      *BLANKS       DQVS11
     C                   MOVE      *BLANKS       DQVS12
     C                   MOVE      *BLANKS       DQVS13
     C                   MOVE      *BLANKS       WPINFD
     C                   END
     C  N88              DO
     C                   MOVE      DQNA          HENAK
     C                   MOVE      DQAD1         HEADK1
     C                   MOVE      DQAD2         HEADK2
     C                   MOVE      DQAD3         HEADK3
     C                   MOVEL     DQINFD        WPINFD
     C                   END
      *
     C                   MOVEL     DFINFC        WPINFC
     C*
     C     DFTLFS        COMP      *BLANKS                            8888
     C     DFTLFK        COMP      *BLANKS                            8989
     C                   EXSR      ZSTART
     C                   WRITE     PRT2
     C                   WRITE     PRTDE0
     C*
     C                   Z-ADD     1             XN                2 0
     C*
      * IN67 på medfører print av AS AGREED
     C     *IN77         IFEQ      *OFF
     C     DFRK1         ANDEQ     'A'
     C                   MOVE      *ON           *IN67
     C                   ENDIF
     C     STARP         TAG
     C     XN            IFGT      2
     C                   MOVE      *OFF          *IN67
     C                   ENDIF
     C     XN            IFEQ      2
     C     BE(2)         ANDEQ     *ZEROS
     C     PR(2)         ANDEQ     *ZEROS
     C                   MOVE      *OFF          *IN67
     C                   ENDIF
     C                   MOVE      KA(XN)        XWRKKA            4
     C     NUM           CHECK     KA(XN)        NUMCHK            1 0
     C     NUMCHK        IFGT      0
     C                   MOVE      *OFF          *IN30
     C                   ELSE
     C                   MOVE      *ON           *IN30
     C                   ENDIF
     C*
     C     VE(XN)        IFGT      *ZEROS
     C                   MOVE      'K'           XKILOA            1
     C                   ELSE
     C                   MOVE      *BLANKS       XKILOA
     C                   END
     C*
     C                   Z-ADD     BE(XN)        WRKBA            10 2
     C*
     C* BASISPRISBEREGNING
     C*
     C     MI(XN)        IFEQ      'B'
     C     FV(XN)        MULT      PR(XN)        XBASI1           10 2
     C                   Z-ADD     XBASI1        BELDEC           13 2
     C                   EXSR      DECI
     C                   Z-ADD     BELDEC        XBASI1
     C     BE(XN)        SUB       XBASI1        XBASIS           10 2
     C                   Z-ADD     XBASI1        BE(XN)
     C                   END
     C*
     C     MI(XN)        COMP      'P'                                    32
     C                   MOVE      *OFF          *IN28
     C                   EXSR      MOVKA
     C                   WRITE     PRTDE2
     C     MI(1)         IFEQ      'P'
     C     XN            ANDEQ     4
     C     MI(1)         OREQ      'D'
     C     XN            ANDEQ     4
     C                   WRITE     PRIO2
     C                   END
     C                   MOVE      XWRKKA        KA(XN)
     C                   Z-ADD     WRKBA         BE(XN)
     C                   ADD       1             XN
     C     XN            COMP      6                                  33
     C  N33              GOTO      STARP
      * IN67 på medfører print av AS AGREED
     C     *IN77         IFEQ      *OFF
     C     DFRK1         ANDEQ     'A'
     C                   MOVE      *ON           *IN67
     C                   ENDIF
      *
     C                   WRITE     PRTDE3
      *
      * FINNER DISPURSMENTFEE
      *
     C   27              GOTO      TAG02
      *
     C   70XTDUA         COMP      KDSBL1                               33
     C   70
     CAN 33              Z-ADD     KDSBL2        XDISBL            5 0
     C   70
     CANN33XTDUA         MULT      KDSPRO        XDISBL
     C   70
     CANN33XDISBL        COMP      KDSBL3                               34
     C   70
     CANN33
     CAN 34              Z-ADD     KDSBL3        XDISBL
     C   70XTDUA         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        XDISBL
     C                   END
      *
      * SKJEKKER OM IKKE DISP-FEE SKAL VÆRE MED
      *
     C                   MOVE      ST2LK         ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C     KLKDIS        COMP      'N'                                    34
     C   34              MOVE      *ZEROS        XDISBL
     C     HEHAWB        IFNE      *ZEROS
     C                   MOVE      *ZEROS        XDISBL
     C                   END
      *
     C                   ADD       XDISBL        DFBLDC
      *
      * MC     SKAL DUE CARRIER
      *
     C   77              ADD       KFSMC         DFBLDC
      *
     C     DFBLT         ADD       DFBLDC        XBELTO            9 2
     C                   ADD       DFBLA         XBELTO
     C                   ADD       DFBLAV        XBELTO
     C                   ADD       XTDUA         XBELTO
     C     DFBLA         COMP      *ZEROS                             36
     C     DFBLAV        COMP      *ZEROS                             37
     C     XTDUA         COMP      *ZEROS                             38
     C     DFBLDC        COMP      *ZEROS                             39
     C     XDISBL        COMP      *ZEROS                             41
     C     KFSMC         COMP      *ZEROS                             78
      *
     C     TAG02         TAG
      *
     C                   EXSR      REMBUR
     C                   EXSR      KDTFMT
     C  N70
     CANN67              WRITE     PRTTO2
     C  N70
     CAN 67              WRITE     ARTTO2
     C   70
     CANN67              WRITE     PRTTO3
     C   70
     CAN 67              WRITE     ARTTO3
     C     SLPRIN        ENDSR
     C*
     C******************************************
     C     MOVKA         BEGSR
     C******************************************
     C                   Z-ADD     1             X3                1 0
     C     X3            DOWLE     6
     C                   MOVE      KA(X3)        TESTSH            1
     C     TESTSH        IFGE      '0'
     C     TESTSH        ANDLE     '9'
     C                   MOVE      KA(X3)        KA1(X3)
     C                   ELSE
     C                   MOVE      *ZEROS        KA1(X3)
     C                   END
     C                   ADD       1             X3
     C                   END
     C*
     C                   MOVE      KA1(XN)       KA1CXN            4 0
     C                   MOVE      KA(XN)        KACXN             4
     C                   MOVE      VE(XN)        VECXN             7 1
     C                   MOVE      RA(XN)        RACXN             1
     C                   MOVE      IT(XN)        ITCXN             4
     C                   MOVE      FV(XN)        FVCXN             7 1
     C                   MOVE      PR(XN)        PRCXN             8 2
     C                   MOVE      BE(XN)        BECXN            10 2
     C                   MOVE      VA(XN)        VACXN            25
     C                   ENDSR
     C*
     C******************************************
     C     PRINT2        BEGSR
     C******************************************
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     HESDT         XFLY1
     C                   MOVE      DFROA1        XFLY2             3
     C                   MOVE      DFROA2        XFLY3             3
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY3
     C     DFROA2        IFNE      *BLANKS
     C                   MOVE      DFROA2        XFLY1
     C                   MOVE      DFROA1        XFLY2
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY2
     C                   MOVE      DFROA1        XFLY1
     C                   END
     C                   END
     C                   Z-ADD     1             XANTL             3 0
     C     XANTL         DOWLE     DFNTT
     C                   EXCEPT    MLAP
     C     DFKDME        IFEQ      'B'
     C                   EXCEPT    MLAP2
     C                   END
     C                   ADD       1             XANTL
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT3        BEGSR
     C******************************************
      * LABEL PRINT MED BARCODE (TDV IS)
     C                   MOVE      WHEGN3        WNHEG3            3 0
     C     WNHEG3        CHAIN     ISUL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     ISPART        LAPAID
     C                   MOVEL     'LAI'         LAMEID
     C     1             CHAIN     CNFF                               90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   ADD       1             CNRECN
     C                   UPDATE    CNFR
     C                   Z-ADD     CNRECN        LARECN
      * HENT PRINTER NAVN
     C                   CALL      'SYGE01'
     C                   PARM                    DFAVD
     C                   PARM      068           WUSKNR            3 0
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WKOPFM
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DFNTT         LANUMC
     C     ISPART        CHAIN     PARL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     LABNAM        LAISTX
     C     DFRK1         IFEQ      'P'
     C     DFRK1         OREQ      'D'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE                                                   <WHEGN3
     C                   MOVEL     *BLANKS       LASERC
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     HESDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     HESDT         LADCTY
     C                   Z-ADD     DFNTT         LANUMP
     C                   Z-ADD     DFVKTT        LAWGHT
     C                   MOVEL     DFINFA        LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3
     C                   MOVEL     HEADK3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DFROA1        IFNE      *BLANKS
     C                   MOVEL     DFROA1        WWA
     C                   MOVEL     DFROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DFROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA2        WWA
     C                   MOVEL     DFROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA3        WWA
     C                   MOVEL     DFROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN11        WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      *BLANK        LAHCDE
      *
     C                   WRITE     LABR
      *
     C     ENDPR3        ENDSR
      *
      ******************************************
     C     PRINT4        BEGSR
      ******************************************
     C                   OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
     C                   MOVE      WHEGN3        WNHEG3
     C     WNHEG3        CHAIN     ISUL01                             90
     C  N90ISPART        CHAIN     PARL01                             90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      * LABEL PRINT MED BARCODE. STANDARD SYSPED400
      * HENT PRINTER NAVN
     C                   CALL      'SYGE01'
     C                   PARM                    DFAVD
     C                   PARM      068           WUSKNR
     C                   PARM                    WOPNVN
     C                   PARM                    WOPTY
     C                   PARM                    WOPHEA
     C                   PARM                    WKOPFM
      * SJEKK OM DET ER KORREKT PRINTER ANGITT I PAPIRTYPE
     C     WOPTY         IFEQ      'ZEBRA 95'
     C     WOPTY         OREQ      'STRIPE  '
     C     WOPTY         OREQ      'ELTRON  '
     C                   CLEAR                   DOLAR
     C     *IN90         IFEQ      *ON
     C     LABNAM        OREQ      *BLANKS
     C                   MOVEL     FIKRTN        DOISTX
     C                   ELSE
     C                   MOVEL     LABNAM        DOISTX
     C                   ENDIF
     C                   MOVEL     WOPNVN        LAPRID
     C                   Z-ADD     DFNTT         LANUMC
     C                   MOVEL     *BLANKS       LAISTX
     C     DFRK1         IFEQ      'P'
     C     DFRK1         OREQ      'D'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE
     C                   MOVEL     *BLANKS       LASERC
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     HESDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     HESDT         LADCTY
     C                   Z-ADD     DFNTT         LANUMP
     C                   Z-ADD     DFVKTT        LAWGHT
     C                   MOVEL     DFINFA        LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3
     C                   MOVEL     HEADK3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     DFROA1        IFNE      *BLANKS
     C                   MOVEL     DFROA1        WWA
     C                   MOVEL     DFROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     DFROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA2        WWA
     C                   MOVEL     DFROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     DFROA3        WWA
     C                   MOVEL     DFROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     DFROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN11        WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
     C                   MOVEL     *ZEROS        LAHNUM
     C                   MOVEL     *ZEROS        LAHWGT
     C                   MOVE      *BLANK        LAHCDE
     C                   Z-ADD     DFAVD         LAAVD
     C                   Z-ADD     DFOPD         LAOPD
     C                   MOVE      DFSG          LASIGN
      *
     C                   WRITE     DOLAR
      *
     C                   CALL      'SYLA01C'
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    WOPTY
     C                   PARM                    WOPNVN
      *
     C     DORECN        CHAIN     DOLAR                              90
     C     *IN90         IFEQ      *OFF
     C                   DELETE    DOLAR
     C                   ENDIF
      *
     C                   ENDIF                                                  <WOPTY
      *
     C     ENDPR4        ENDSR
      ******************************************
     C     SUM           BEGSR
      ******************************************
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
     C                   Z-ADD     1             XN2               2 0
      *
     C  N77              MOVE      'K'           YSK
     C   77              MOVE      'F'           YSK
     C     HEVALK        COMP      FICURR                             7171
     C     FAK2K         SETLL     FAK2
     C                   EXSR      SUM2
     C                   Z-ADD     XBRUTT        XTKJØ             9 2
      *
     C                   ENDSR
      *
      ******************************************
     C     SUM2          BEGSR
      ******************************************
     C                   MOVE      *BLANKS       FK
     C                   MOVE      *ZEROS        FN
     C                   MOVE      *ZEROS        XTOTAL            9 2
     C                   MOVE      *ZEROS        XMVAGR            9 2
     C                   SETOFF                                       33
      *
     C     STVALI        TAG
     C     FAK2K         READE     FAK2                                   33
     C  N33FAKDM         COMP      'J'                                    34
     C  N33FAKDA         IFNE      'K'                                          0<-B
     C  N33FAVK          IFNE      'FFE'                                        1<-B
     C     FAVK          IFNE      'MC '                                         2<-B
     C   34
     CANN71              ADD       FABELN        XMVAGR            9 2
     C   34
     CAN 71              ADD       FABELV        XMVAGR
     C  N71              ADD       FABELN        XTOTAL
     C   71              ADD       FABELV        XTOTAL
     C     XN2           IFLE      9                                              3<-B
     C     KODG2K        CHAIN     KODTG2                             42
     C  N42              MOVE      KG2KRT        FK(XN2)
      *  UNDERTRYKKE DESIMALER - FARLIG VED INSTALLASJON I F.EKS USA. (DOLLAR)
      *                    MOVE FABELN    FN,XN2
     C  N71              Z-ADD     FABELN        FN(XN2)
     C   71              Z-ADD     FABELV        FN(XN2)
     C                   ADD       1             XN2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C                   END                                                    0<-E
     C  N33              GOTO      STVALI
      * VARIABLE VAT
     C                   MOVE      FITAX         FITAXN            4 4
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     FADATO        ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAXN            4 4
     C                   END
      *
     C     XMVAGR        MULT(H)   FITAXN        XMOMS             9 2
     C     XTOTAL        ADD       XMOMS         XBRUTT            9 2
      *
     C                   ENDSR
      ******************************************
     C     SUM3          BEGSR
      ******************************************
     C                   MOVE      'S'           YSK
     C     FAK2K         SETLL     FAK2
     C                   SETOFF                                       33
      *
     C     STVAL2        TAG
     C     FAK2K         READE     FAK2                                   33
     C  N33FAVK          IFEQ      'FFE'
     C   77FABELN        SUB       KFSMC         FABELN
     C                   SUB       DFBLDC        FABELN
     C     DFBLT         IFLT      FABELN
     C     FABELN        SUB       DFBLT         KDSBL4
     C                   Z-ADD     KDSBL4        XTDUA
     C                   GOTO      TAGSK
     C                   END
     C                   END
     C  N33              GOTO      STVAL2
      *
     C     TAGSK         ENDSR
      *
      ******************************************
     C     REMBUR        BEGSR
      ******************************************
      * Feltet for REF og Signatur er nå endret slik at REF skrives
      * ut lenger opp på fraktbrevet og man har tre linjer tilgjengelig
      * for flyselskap, agent, dato, sted, signatur og ledetekst.
      *
      * Dato, sted og signatur skrives fast på den nederste av disse
      * tre linjene. To linjer på 44 pos. brukes da til å skrive ut
      * ledetekst, flyselskap og agent. Dette redigeres utover disse
      * to linjene.
      * For HAWB er det en litt anderledes tekst på utskriften.
      * 77 = på --> singelutskrift.
     C                   Z-ADD     30            XX                3 0
     C                   MOVEL     *BLANKS       REW              88
     C                   MOVEA     *BLANKS       RE1
     C                   MOVEA     *BLANKS       RE2
     C     *IN77         IFEQ      *ON
     C                   MOVEL     FTXT          REW
     C     KFSNAV        IFEQ      *BLANKS
     C                   MOVEL     '...'         KFSNAV
     C                   END
     C                   MOVEA     KFSNAV        RE1
     C                   ELSE
     C                   MOVEL     FTXT3         REW
     C                   GOTO      REM02
     C                   ENDIF
     C     RE1(XX)       DOWEQ     *BLANK
     C                   SUB       1             XX
     C                   ENDDO
     C                   ADD       1             XX
     C                   MOVE      ','           RE1(XX)
     C                   MOVEA     RE1           REW2             31
     C     REW           CAT(P)    REW2:1        REW
     C     REM02         TAG
     C                   MOVEL     KNAVN         REW2
     C     REW           CAT(P)    REW2:1        REW
      *
     C                   MOVEA     REW           RE
     C                   Z-ADD     88            RT                3 0
     C     RE(RT)        DOWEQ     *BLANK
     C                   SUB       1             RT
     C                   ENDDO
     C     RT            IFLE      44
     C                   ADD       1             RT
     C                   ENDIF
     C     REMTAG        TAG
     C     RT            IFLE      44
     C     1             DO        RT            XX
     C                   MOVE      RE(XX)        RE1(XX)
     C                   ENDDO                                                  <1
     C                   Z-ADD     1             YY                3 0
     C     RT            DO        88            XX
     C                   MOVE      RE(XX)        RE2(YY)
     C                   ADD       1             YY
     C     YY            IFGT      44
     C                   LEAVE
     C                   ENDIF
     C                   ENDDO                                                  <RT
     C                   ELSE                                                   <RT
     C     RE(RT)        DOUEQ     *BLANK
     C                   SUB       1             RT
     C                   ENDDO
     C                   GOTO      REMTAG
     C                   ENDIF                                                  <RT
     C                   MOVEA     RE1           LIN01            44
     C                   MOVEA     RE2           LIN02            44
     C                   ENDSR
      ********************************************************************D260
     C     ZSTART        BEGSR
      ********************************************************************
     C                   MOVE      HESDF         XFRA9             9
     C                   MOVEL     XFRA9         XAWBI1           17
     C                   MOVEL     DFFSN         XAWBI1
     C                   MOVE      XAWB9         XAWBI1
     C                   MOVEL     DFFSN         XAWBI2           15
     C                   MOVE      XAWB9         XAWBI2
     C                   MOVEL     HESDF         XAWBI3           12
     C                   MOVE      HEHAWB        XAWB6             6
     C                   MOVE      XAWB6         XAWBI3
     C                   MOVEL     XARK          XPARM            80
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     HEADFK        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C     DOKEQK        KLIST
     C                   KFLD                    DQRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C     DOKEFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C     DOKF1K        KLIST
     C                   KFLD                    YST
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KOAKNR
     C     KEYKUS        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    HEKNS
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    YSK
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    DFAVD
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    DFAVD
     C     KODG2K        KLIST
     C                   KFLD                    YG2UNI
     C                   KFLD                    FAVK
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    DFSG
     C     KODFSK        KLIST
     C                   KFLD                    YFSUNI
     C                   KFLD                    DFFSN
     C     TELLAK        KLIST
     C                   KFLD                    YTAUNI
     C                   KFLD                    DFFSN
     C                   KFLD                    KOWLAS
     C     KODLKK        KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    ST2LKX            2
      *
     C     *ENTRY        PLIST
     C     UIN08         PARM      UIN08         UIN08             1
     C     UPRANT        PARM      UPRANT        UPRANT            2
      *
     C                   MOVE      'F'           DFRI              1
     C                   MOVE      'Q'           DQRI              1
     C                   MOVE      ' '           YST               1
     C                   MOVE      ' '           YSK               1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'AE'          YTAUNI            2
     C                   MOVE      'G2'          YG2UNI            2
     C                   MOVE      'LK '         YLKUNI            3
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'FS'          YFSUNI            2
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVEL     WUSER         WWUSER           17
     C                   MOVE      *BLANKS       WKOPFM            5
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      UAVD          DFAVD
     C     KODTAK        CHAIN     KODTA                              33
     C     KODTWK        CHAIN     KODTW                              33
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVEL     ADR3          WWPLAC           24
     C                   MOVEL     ADR3          XFRAF2           15
     C                   MOVEL     ADR3          XFRAFL           30
      *
      * KALLES KUN EN GANG
      *
     C                   MOVEL     '    -   '    XAWBI2
     C                   MOVEL     '    -'       XAWBI3
      *
     C                   MOVEL     *BLANKS       PGID             17
     C                   MOVEL     *BLANKS       PGIDNE           35
     C                   MOVEL     *BLANKS       PGPACP           17
     C                   MOVEL     *BLANKS       PGPACA           35
     C                   MOVEL     *BLANKS       PGCPAI           17
     C                   MOVEL     *BLANKS       PGCPAA           35
     C                   MOVEL     *BLANKS       PGMTM1            1
     C                   MOVEL     *BLANKS       PGMTM2            1
     C                   MOVEL     *BLANKS       PGMTM3            1
      *
     C                   ENDSR
      ***********************************************
     C     KDTFMT        BEGSR
      ***********************************************
     C                   MOVE      UDAY          UDT1              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UYEAR         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
      *
     C                   ENDSR
      ***********************************************
     C     OPNFIL        BEGSR
      ***********************************************
      * DUMMY READ AV FILER
     C  N90
     CAN 90              READ      LABF                                   90
      * ÅPNER FILER
     C     FITDVI        IFEQ      'N'
     C                   MOVE      '1'           *IN90
     C                   ELSE
     C                   OPEN      CNFF                                 90
     C  N90              OPEN      LABF                                 90
     C  N90              OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
     C                   ENDIF
     C* HVIS ÅPNING AV FILER GIKK GALT KAN IKKE RUTINEN UTFØRES
     C     *IN90         CABEQ     '1'           OPNF99
     C* HVIS ALT GIKK GREIT KAN RUTINEN UTFØRES
     C     OPNF99        ENDSR
     C***********************************************
     C     WRTFWB        BEGSR
     C***********************************************
     C                   MOVEL     *BLANKS       WRK
     C     11            SUBST     HEGN:5        WRK
     C                   EXSR      CHKNUM
     C     *IN91         IFEQ      '0'
     C     *IN92         ANDEQ     '0'
     C     3             SUBST     HEGN:5        W0211A            3
     C                   MOVEL     W0211A        W0211             3 0
     C     W0211         CHAIN     ISUL01                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        PGID
     C                   ELSE
     C                   MOVEL     *BLANKS       PGID
     C                   ENDIF
     C     1             CHAIN(N)  CNFF                               90
     C     *IN90         IFEQ      *OFF
     C     CNCOD1        ANDEQ     'Y'
     C                   MOVEL     'CCS'         PGID
     C                   ENDIF
     C                   CALL      'TDV13R'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM      *BLANKS       AWB              11
     C                   PARM                    PGID
     C                   PARM                    PGIDNE
     C                   PARM                    PGPACP
     C                   PARM                    PGPACA
     C                   PARM                    PGCPAI
     C                   PARM                    PGCPAA
     C                   PARM                    PGMTM1
     C                   PARM                    PGMTM2
     C                   PARM                    PGMTM3
      *
     C                   ENDIF
      *
     C                   ENDSR
      ***********************************************
     C     SNDTA2        BEGSR
      ***********************************************
     C                   MOVEL     'SMADTARQ'    QTNAME           10
     C                   MOVEL     '*LIBL'       QTLIB            10
     C                   Z-ADD     9             QTLEN             5 0
     C                   MOVE      *BLANKS       QTFIEL            9
     C                   Z-ADD     LARECN        WARECA
     C                   MOVE      WARECA        QTFIEL
     C                   Z-ADD     9             QKILEN            3 0
     C                   MOVE      *BLANKS       QKEY              9
     C                   MOVEL     'LAI'         QKEY
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QTNAME
     C                   PARM                    QTLIB
     C                   PARM                    QTLEN
     C                   PARM                    QTFIEL
     C                   PARM                    QKILEN
     C                   PARM                    QKEY
      *
     C                   ENDSR
      ***********************************************
     C     CLOFIL        BEGSR
      ***********************************************
      * CLOSER FILER
     C                   CLOSE     CNFF                                 90
     C                   CLOSE     LABF                                 90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      *
     C                   ENDSR
      ***********************************************
     C     CHKNUM        BEGSR
      ***********************************************
     C                   MOVE      *OFF          *IN91
     C                   Z-ADD     30            ÆX                3 0
     C                   Z-ADD     30            ÆY                3 0
     C                   MOVEA     *BLANKS       AR1
     C                   MOVEA     *BLANKS       AR2
     C                   MOVEA     WRK           AR1
     C     WRK           CABEQ     *BLANKS       CHK99                    92
      * POSISJONER TIL SISTE TEGN I FELTET
     C     AR1(ÆX)       DOWEQ     *BLANK
     C                   SUB       1             ÆX
     C                   ENDDO
      * ERSTATT BLANK MED NULL OG SJEKK OM DET BARE ER TALL
     C     ÆX            DOWGT     0
     C     AR1(ÆX)       IFEQ      *BLANK
     C                   MOVE      '0'           AR1(ÆX)
     C                   ENDIF
     C     AR1(ÆX)       IFGE      '0'
     C     AR1(ÆX)       ANDLE     '9'
     C                   MOVE      AR1(ÆX)       AR2(ÆY)
     C                   SUB       1             ÆX
     C                   SUB       1             ÆY
     C                   ELSE                                                   <AR1,ÆX
      * FELTET INNEHOLDER IKKE BARE TALL. 91 BLIR SATT PÅ
     C                   MOVE      *ON           *IN91
     C                   GOTO      CHK99
     C                   END                                                    <AR1,ÆX
     C                   ENDDO                                                  <ÆX
      * FYLL OPP RESTEN AV FELTET MED NULL
     C     ÆY            DOWGT     0
     C                   MOVE      '0'           AR2(ÆY)
     C                   SUB       1             ÆY
     C                   ENDDO
      *
     C                   MOVEA     AR2           WRK              30
      *
     C     CHK99         ENDSR
      ***********************************************
     C     DECI          BEGSR
      ***********************************************
      * TEST FIRMS NUMBER OF DECIMALS
      *
      * NO DECIMALS
     C     FIDECI        IFEQ      0
     C                   Z-ADD(H)  BELDEC        FABEL0           11 0
     C                   Z-ADD     FABEL0        BELDEC
     C                   ELSE
      * 1 DECIMAL
     C     FIDECI        IFEQ      1
     C                   Z-ADD(H)  BELDEC        FABEL1           12 1
     C                   Z-ADD     FABEL1        BELDEC
     C                   END
     C                   END
      *
     C                   ENDSR
     C***********************************************
     C     TTSR          BEGSR
     C***********************************************
     C                   MOVE      HEAVD         TTAVD
     C                   MOVE      HEOPD         TTOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      'PRA'         TTACTI
     C                   MOVE      ULDT          TTDATE
     C                   MOVE      XULTM         TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      WUSER         TTUSER
     C   77              MOVEL     'Airwaybi'    XXTE16           16
     C   77              MOVE      'll print'    XXTE16
     C  N77              MOVEL     'House-ai'    XXTE16           16
     C  N77              MOVE      'rwaybill'    XXTE16
     C                   MOVEL     XXTE16        XXTE32           32
     C                   MOVEL     'printed '    XXTE16
     C                   MOVE      '(int)   '    XXTE16
     C                   MOVE      XXTE16        XXTE32
     C                   MOVEL     XXTE32        TTTEXT
n01  C   77              MOVEL     'Flyfrakt'    XXTE16           16
n01  C   77              MOVE      'brev int'    XXTE16
n01  C  N77              MOVEL     'Husfrakt'    XXTE16           16
n01  C  N77              MOVE      'brev    '    XXTE16
n01  C                   MOVEL     XXTE16        XXTE32           32
n01  C                   MOVEL     'skrevet '    XXTE16
n01  C                   MOVE      '(int)   '    XXTE16
n01  C                   MOVE      XXTE16        XXTE32
n01  C                   MOVEL     XXTE32        TTTEXL
     C                   MOVE      *BLANKS       XXTE32
     C                   MOVE      HEGN11        XXTE32
     C  N77              MOVEL     HEHAWB        XXTE32
     C                   WRITE     TRACKFR
     C                   ENDSR
      *
      ***********************************************
     OMERKL1    E            MLAP             06
     O                       XGN1                 5
     O                       XGN2                 7
     O                       XGN3                 9
     O                       XGN4                12
     O                       XGN5                14
     O                       XGN6                16
     O                       XGN7                18
     O                       XGN8                21
     O                       XGN9                23
     O                       XGN10               25
     O                       XGN11               27
     O               77      DFNTT         Z     36
     O               77      DFVKTT        4     46
     O          E            MLAP             09
     O                       FL(1)                5
     O                       FL(2)                7
     O                       FL(3)                9
     O                       XFLY2               36
     O                       XFLY3               45
     O          E   N77      MLAP             12
     O                       XSDF1                5
     O                       XSDF2                7
     O                       XSDF3                9
     O                       XHAWB1              11
     O                       XHAWB2              13
     O                       XHAWB3              15
     O                       XHAWB4              17
     O                       XHAWB5              19
     O                       XHAWB6              21
     O                       DFNTT         Z     36
     O                       DFVKTT        4     46
     OMERKL2    E            MLAP2            04
     O                       HENAK               35
     O          E            MLAP2            06
     O                       HEADK1              35
     O          E            MLAP2            08
     O                       HEADK2              35
     O          E            MLAP2            10
     O                       HEADK3              35
