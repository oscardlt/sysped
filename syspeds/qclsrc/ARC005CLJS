/* PTF 2109-2005 ØKT FRA 30 TIL 50 POSISJONER */
             PGM        PARM(&PARM)
             DCL        VAR(&BANE1) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE2) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE3) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE4) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE5) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE6) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE7) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE8) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BANE9) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN10) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN11) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN12) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN13) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN14) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN15) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN16) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN17) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN18) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN19) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN20) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN21) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN22) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN23) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN24) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN25) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN26) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN27) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN28) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN29) TYPE(*CHAR) LEN(70)
             DCL        VAR(&BAN30) TYPE(*CHAR) LEN(70)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(1) /* DISTLISTE */
             DCL        VAR(&MANAUT) TYPE(*CHAR) LEN(1) VALUE('M')
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(391)
             DCL        VAR(&RPLNA) TYPE(*CHAR) LEN(8) +
                          VALUE('*CURRENT')
             DCL        VAR(&RPLAD) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(7) /* Unikkode */
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO30) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO50) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPOSTF) TYPE(*CHAR) LEN(70)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&IE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(40)
             DCL        VAR(&EPO01) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO02) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO03) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO04) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO05) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO06) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO07) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO08) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO09) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO10) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO11) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO12) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO13) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO14) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO15) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO16) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO17) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO18) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO19) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO20) TYPE(*CHAR) LEN(70)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NBR) TYPE(*CHAR) LEN(6)
             RTVJOBA    USER(&QUSER) NBR(&NBR)
/*                      */
             CHGVAR     VAR(&UNIK) VALUE('W' *CAT &NBR)
             CHGVAR     VAR(&EPOST) VALUE(%SST(&PARM 1 70))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&PARM 71 40))
             CHGVAR     VAR(&CVP2) VALUE(%SST(&PARM 111 40))
             CHGVAR     VAR(&CVP3) VALUE(%SST(&PARM 151 40))
             CHGVAR     VAR(&CVP4) VALUE(%SST(&PARM 191 40))
             CHGVAR     VAR(&CVP5) VALUE(%SST(&PARM 231 40))
             CHGVAR     VAR(&CVP6) VALUE(%SST(&PARM 271 40))
             CHGVAR     VAR(&CVP7) VALUE(%SST(&PARM 311 40))
             CHGVAR     VAR(&CVP8) VALUE(%SST(&PARM 351 40))
             CHGVAR     VAR(&IE) VALUE(%SST(&PARM 391 1))
/*                      */
             CHGVAR     VAR(&EPO30) VALUE(&EPOST)
             CHGVAR     VAR(&EPO50) VALUE(&EPOST)
             CHGVAR     VAR(&RPLNA) VALUE(&QUSER)
             RTVNETA    SYSNAME(&RPLAD)
/*                      */
/* HENT REPLYADRESSE    */
/*                      */
/*                      */
             CALL       PGM(EPOS04) PARM(&QUSER &RPLNA &RPLAD &EPOSTF)
/*                      */
/*                      */
/* LEGGER UT COVERPAGE  */
/* I SOURCE             */
/*                      */
             RTVDTAARA  DTAARA(FIRMDT (141 10)) RTNVAR(&LIB)
/*                      */
/* LEGGER UT QUSER      */
/* I ARKSRC             */
/*                      */
             ADDPFM     FILE(ARKSRC) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(ARKSRC) MBR(&UNIK)
             OVRDBF     FILE(ARKSRC) TOFILE(&LIB/ARKSRC) MBR(&UNIK)
             OVRDBF     FILE(ARKEPO) TOFILE(ARKEPOW)
             CALL       PGM(ARC006) PARM(&CVP2 &CVP3 &CVP4 &CVP5 +
                          &CVP6 &CVP7 &CVP8 &IE &CVP1 &EPO50 +
                          &MANAUT &BANE1 &BANE2 &BANE3 &BANE4 +
                          &BANE5 &BANE6 &BANE7 &BANE8 &BANE9 &BAN10 +
                          &BAN11 &BAN12 &BAN13 &BAN14 &BAN15 &BAN16 +
                          &BAN17 &BAN18 &BAN19 &BAN20 &BAN21 &BAN22 +
                          &BAN23 &BAN24 &BAN25 &BAN26 &BAN27 &BAN28 +
                          &BAN29 &BAN30)
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                     */
/* UTEN DISTRIBUSJONSLISTE             */
/*                                     */
             CHGVAR     VAR(&DIST) VALUE(%SST(&EPOST 1 1))
             CHGVAR     VAR(&DISTL) VALUE(%SST(&EPO50 2 6))
             IF         COND(&DIST *NE '*') THEN(DO)
/*                                     */
/* SEND SOM VEDLEGG                    */
/*                                     */
             IF         COND(&BANE1 *NE '            ') THEN(DO)
             EMLSTMF    SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO30/&EPO50/*TO) +
                          STMF(&BANE1 &BANE2 &BANE3 &BANE4 &BANE5 +
                          &BANE6 &BANE7 &BANE8 &BANE9 &BAN10 &BAN11 +
                          &BAN12 &BAN13 &BAN14 &BAN15 &BAN16 &BAN17 +
                          &BAN18 &BAN19 &BAN20 &BAN21 &BAN22 &BAN23 +
                          &BAN24 &BAN25 &BAN26 &BAN27 &BAN28 &BAN29 +
                          &BAN30) MSGM(&LIB/ARKSRC/&UNIK)
             RMVLIBLE   LIB(MMAIL)
             RMVM       FILE(ARKSRC) MBR(&QUSER)
             MONMSG     MSGID(CPF0000)
             DSPJOBLOG  OUTPUT(*PRINT)
             RETURN
             ENDDO
/*                                     */
/* SEND SOM LINK                       */
/*                                     */
             EMLMSG     SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO30/&EPO50/*TO) +
                          TXTF(&LIB/ARKSRC) TXTMBR(&UNIK) EDTMBR(*NO)
/*                      */
/*                      */
             RMVLIBLE   LIB(MMAIL)
             RETURN
             ENDDO
/*                      */
/*                      */
/*                                       */
/*                                     */
/*  SENDING VED DISTRIBUSJONSLISTE     */
/*                                     */
/*                                     */
             CALL       PGM(EPODIS2) PARM(&DISTL &EPO01 &EPO02 &EPO03 +
                          &EPO04 &EPO05 &EPO06 &EPO07 &EPO08 &EPO09 +
                          &EPO10 &EPO11 &EPO12 &EPO13 &EPO14 &EPO15 +
                          &EPO16 &EPO17 &EPO18 &EPO19 &EPO20)
/*                                     */
/*  SENDING TIL MOTTAGER 01            */
/*                                     */
             IF         COND(&EPO01 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPO30) VALUE(&EPO01)
             CHGVAR     VAR(&EPO50) VALUE(&EPO01)
/*                                     */
/* SEND SOM VEDLEGG                    */
/*                                     */
             IF         COND(&BANE1 *NE '            ') THEN(DO)
             EMLSTMF    SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO01/&EPO01/*TO +
                          &EPO02/&EPO02/*TO &EPO03/&EPO03/*TO +
                          &EPO04/&EPO04/*TO &EPO05/&EPO05/*TO +
                          &EPO06/&EPO06/*TO &EPO07/&EPO07/*TO +
                          &EPO08/&EPO08/*TO &EPO09/&EPO09/*TO +
                          &EPO10/&EPO10/*TO &EPO11/&EPO11/*TO +
                          &EPO12/&EPO12/*TO &EPO13/&EPO13/*TO +
                          &EPO14/&EPO14/*TO &EPO15/&EPO15/*TO +
                          &EPO16/&EPO16/*TO &EPO17/&EPO17/*TO +
                          &EPO18/&EPO18/*TO &EPO19/&EPO19/*TO +
                          &EPO20/&EPO20/*TO) STMF(&BANE1 &BANE2 +
                          &BANE3 &BANE4 &BANE5 &BANE6 &BANE7 &BANE8 +
                          &BANE9) MSGM(&LIB/ARKSRC/&UNIK)
             GOTO       CMDLBL(UT)
             ENDDO
/*                                     */
             EMLMSG     SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO01/&EPO01/*TO +
                          &EPO02/&EPO02/*TO &EPO03/&EPO03/*TO +
                          &EPO04/&EPO04/*TO &EPO05/&EPO05/*TO +
                          &EPO06/&EPO06/*TO &EPO07/&EPO07/*TO +
                          &EPO08/&EPO08/*TO &EPO09/&EPO09/*TO +
                          &EPO10/&EPO10/*TO &EPO11/&EPO11/*TO +
                          &EPO12/&EPO12/*TO &EPO13/&EPO13/*TO +
                          &EPO14/&EPO14/*TO &EPO15/&EPO15/*TO +
                          &EPO16/&EPO16/*TO &EPO17/&EPO17/*TO +
                          &EPO18/&EPO18/*TO &EPO19/&EPO19/*TO +
                          &EPO20/&EPO20/*TO) TXTF(&LIB/ARKSRC) +
                          TXTMBR(&UNIK) EDTMBR(*NO)
                          ENDDO
UT:          RMVLIBLE   LIB(MMAIL)
             RMVM       FILE(ARKSRC) MBR(&UNIK)
             MONMSG     MSGID(CPF0000)
                          ENDPGM
