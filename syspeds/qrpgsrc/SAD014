     FCUNDMAF   UF A E           K DISK
     FKODTS8    IF   E           K DISK
     FSAD014FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     CMAK1         SETLL     CUNDMAF
     C     CMAK1         READE     CUNDMAF                                94
      *
     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     CMAK1         READE     CUNDMAF                                94
     C  N94              ENDDO
      *
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     ZRECNO        IFGT      0
     C                   Z-ADD     1             ZRECNO
     C                   END
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
      *** AVSLUTT
     C   03              MOVE      *ZEROS        UFLAGG
     C   03              GOTO      SLUTT
      *
     C   04              DO
     C                   EXSR      SØKKD1
     C                   GOTO      START3
     C                   END
      *
     C   05              GOTO      START
      *
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTSAD
     C                   GOTO      START3
     C                   END
      *
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      *
     C     W2NR          IFNE      ' '                                          1<-B
     C     W2KD          ANDNE     *BLANKS
     C     W2NR          COMP      '1'                                    06
     C     *IN06         CABEQ     '1'           START4
     C     W2KD          IFEQ      *BLANKS                                       2<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0657'     MSGNR
     C                   ELSE                                                    2
     C                   EXSR      NYOPT
     C                   END                                                     2<-E
     C                   MOVE      *BLANKS       W2KD
     C                   MOVE      *BLANKS       W2TXT
     C                   GOTO      START3
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     NYOPT         BEGSR
     C***********************************************
     C     CMAK4         CHAIN     CUNDMAF                            98
     C     *IN98         IFEQ      '1'
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0658'     MSGNR
      *
     C                   ELSE
      *
     C                   MOVE      '0'           *IN99
     C                   SELECT
     C     W2NR          WHENEQ    '2'
     C                   EXSR      CHGSAD
     C     W2NR          WHENEQ    '4'
     C                   EXSR      DLTSAD
     C                   ENDSL
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      *BLANKS       W2KD
     C                   MOVE      *BLANKS       W2TXT
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C     CMAKD         ANDNE     '*D'
     C                   SELECT
     C     WSNR          WHENEQ    '2'
     C                   MOVE      '1'           *IN99
     C                   EXSR      CHGSAD
     C     WSNR          WHENEQ    '4'
     C                   MOVE      '1'           *IN99
     C                   EXSR      DLTSAD
     C                   ENDSL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKD1        BEGSR
     C***********************************************
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    W2KD
     C                   PARM                    USKV              3
     C                   PARM                    UMOD
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKD2        BEGSR
     C***********************************************
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    WMAKD
     C                   PARM                    USKV              3
     C                   PARM                    UMOD
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTSAD        BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN40
     C     W2KD          IFNE      *BLANKS
     C                   MOVE      W2KD          WMAKD
     C                   MOVE      W2TXT         WMATXT
     C                   MOVE      *BLANKS       W2NR
     C                   MOVE      *BLANKS       W2KD
     C                   MOVE      *BLANKS       W2TXT
     C                   GOTO      STCRTT
     C                   END
      *
     C     STCRT         TAG
     C                   EXFMT     VARELI
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
      *
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKKD2
     C                   GOTO      STCRT
     C                   END
     C     *IN12         CABEQ     '1'           SLCRT
      *
     C     STCRTT        TAG
     C                   EXSR      TESTB
     C     *IN30         CABEQ     '1'           STCRT
      *
     C     SLCRT         ENDSR
      *
     C***********************************************
     C     CHGSAD        BEGSR
     C***********************************************
     C                   MOVE      '1'           *IN40
     C                   MOVE      ' '           WSNR
     C                   MOVE      CMAKD         WMAKD
     C                   MOVE      CMATXT        WMATXT
      *
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
      *
     C     *IN04         IFEQ      '1'
     C                   EXSR      SØKKD2
     C                   GOTO      STCHG
     C                   END
     C     *IN12         IFEQ      '1'
     C   99              UPDATE    SUBFIL
     C                   GOTO      SLCHG
     C                   END
      *
     C                   EXSR      TESTB
     C     *IN30         CABEQ     '1'           STCHG
      *
     C     SLCHG         ENDSR
      *
     C***********************************************
     C     DLTSAD        BEGSR
     C***********************************************
     C                   EXFMT     VAREL3
     C     *IN12         IFEQ      '0'
     C     CMAK2         CHAIN     CUNDMAF                            33
     C                   DELETE    CUNDMAFR
     C                   MOVE      '*D'          CMAKD
     C                   MOVE      *BLANKS       CMATXT
     C                   MOVEL     '*SLETTET'    CMATXT
     C                   END
     C     *IN99         IFEQ      '1'
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WMAKD         SETLL     KODTS8
     C     WMAKD         READE     KODTS8                                 90
     C     *IN90         IFEQ      '1'
     C                   MOVE      'SPK0040'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
      *
     C     *IN40         IFEQ      '0'
     C     CMAK3         CHAIN(N)  CUNDMAF                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      'YBC0658'     MSGNR
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C     WMATXT        IFEQ      *BLANKS
     C                   MOVE      KS8FTX        WMATXT
     C                   END
      *
     C     CMAK3         CHAIN     CUNDMAF                            33
     C                   MOVE      WMAKD         CMAKD
     C                   MOVE      WMATXT        CMATXT
     C     *IN33         IFEQ      '0'
     C                   UPDATE    CUNDMAFR
     C   99              UPDATE    SUBFIL
     C                   ELSE
     C                   MOVE      UFI           CMAFI
     C                   MOVE      UKN           CMAKN
     C                   WRITE     CUNDMAFR
     C                   ADD       1             XRECNO
     C                   MOVE      XRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CMAK1         KLIST
     C                   KFLD                    UFI
     C                   KFLD                    UKN
     C     CMAK2         KLIST
     C                   KFLD                    UFI
     C                   KFLD                    UKN
     C                   KFLD                    CMAKD
     C     CMAK3         KLIST
     C                   KFLD                    UFI
     C                   KFLD                    UKN
     C                   KFLD                    WMAKD
     C     CMAK4         KLIST
     C                   KFLD                    UFI
     C                   KFLD                    UKN
     C                   KFLD                    W2KD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFI               2
     C                   PARM                    UKN               8 0
     C                   PARM                    UNA              30
     C                   PARM                    UFLAGG            1 0
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
