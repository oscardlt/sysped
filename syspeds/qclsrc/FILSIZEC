             PGM
             DCL        VAR(&FRALIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILSIZ) TYPE(*CHAR) LEN(10)
             DCLF       FILE(*LIBL/FILSIZED) RCDFMT(BILDE01)
             CHGJOB     JOB(*) LOG(4 00 *SECLVL) LOGCLPGM(*YES)

LOOP1:
             SNDRCVF    DEV(*FILE) RCDFMT(*FILE)
             IF         COND(&IN03 = '1') THEN(GOTO CMDLBL(SLUTT))
             CHGVAR     VAR(&IN30) VALUE('0')

             CHKOBJ     OBJ(QSYS/&FRALIB) OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801 CPF9810) EXEC(CHGVAR +
                          VAR(&IN30) VALUE('1'))

             IF         COND(&IN30 = '1') THEN(GOTO CMDLBL(LOOP1))

             IF         COND(&IN10 = '1') THEN(DO)
             SBMJOB     CMD(CALL PGM(FILSIZE) PARM(&FRALIB &FILSIZ)) +
                          JOB(&FRALIB) JOBQ(SYJOBQNMAX) +
                          LOG(4 00 *SECLVL) LOGCLPGM(*YES)
             GOTO       CMDLBL(SLUTT)
             ENDDO

             CALL       PGM(FILSIZE) PARM(&FRALIB &FILSIZ)

SLUTT:
             RCLRSC
