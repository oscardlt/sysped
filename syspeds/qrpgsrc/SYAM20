      *
      ***********************************************************
      *** PROGRAM FOR PRINTING AMETA INVOICE'S                ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04-26                      ***
      *** LEDIGE INDIKATORER 27-29 31       58-69             ***
      ***                    74-78 80-87 89-96 98             ***
      ***********************************************************
      * 35 = IKKE GIRO SKRIVES
      * 50 = SAMLEFAKTURERING
      * 51 = PARAMETER UKOPI = J  NOT IF UIN05=1(FROM BORDEREAU)
      * 52 = EXPORT
      * 53 = AIR
      * 54 = PAREMETER UKOPI = J AND UIN05=1(FROM BORDEREAU)
      * 70 = INVOICE IN ENGLISH
      * 71 = INVOICING IN OWN CURRENCY
      * 73 = CREDITNOTE
      * 79 = INVOICE IN GERMAN
      *
      *
     FFAK3      IF   E           K DISK
     F                                     RENAME(FAKTR:FAKTR3)
     FSORT      UF A E           K DISK
     FAMHE1     UF   E           K DISK
     F                                     RENAME(AMHER:AMHER1)
     FAMHE2     UF   E           K DISK
     F                                     RENAME(AMHER:AMHER2)
     FAMFAKWRK  IF   E           K DISK
     FMULTKODT  IF   E           K DISK
     FHODE      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYAM20P   O    E             PRINTER
     D APR             S              2  0 DIM(19)
     D WAPR            S              2    DIM(19)
     D ASS             S              1  0 DIM(38)
     D WASS            S              1    DIM(38)
     D HO              S             80    DIM(10)
     D HE              S             80    DIM(10)
     D HT              S             80    DIM(10)
     D                 DS
     D  XBAK                   1      1  0
     D  ABAK                   1      1
     D  XTOTØR                13     14  0
     D  ATOTØR                13     14
     D                 DS
     D  A                      1     11
     D                                     DIM(11)
     D  ATOTKR                 1     11
     D                 DS
     D  IDAGA                  1      4  0
     D  IDAGM                  5      6  0
     D  IDAGD                  7      8  0
     D  IDAG                   1      8  0
     D                 DS
     D  IDAGXD                 1      2  0
     D  IDAGXM                 3      4  0
     D  IDAGXA                 5      6  0
     D  IDAGX                  1      6  0
     D                 DS
     D  XFFDTD                 1      2  0
     D  XFFDTM                 3      4  0
     D  XFFDTA                 5      6  0
     D  XFFDT                  1      6  0
     D                 DS
     D  XFFD2A                 1      4  0
     D  XFFD2M                 5      6  0
     D  XFFD2D                 7      8  0
     D  XFFDT2                 1      8  0
     D                 DS
     D  AHADÅÅ                 1      4  0
     D  AHADMM                 5      6  0
     D  AHADDD                 7      8  0
     D  AHADAT                 1      8  0
     D                 DS
     D  XHADDD                 1      2  0
     D  XHADMM                 3      4  0
     D  XHADÅÅ                 5      6  0
     D  XHADAT                 1      6  0
     D                 DS
     D  SOLNR                  1      3  0
     D  KG2SRT                 1      3  0
     D                 DS
     D  SOAVD                  4      7  0
     D  FAAVD                  4      7  0
     D  SOOPD                  8     14  0
     D  FAOPD                  8     14  0
     D  SOSK                  15     15
     D  FASK                  15     15
     D  SOVK                  16     18
     D  FAVK                  16     18
     D  SOVT                  19     38
     D  FAVT                  19     38
     D  XFAVT1                19     19
     D  XFAVT2                20     38
     D  SOVAL                 39     41
     D  FAVAL                 39     41
     D  SOBELV                42     54  2
     D  FABELV                42     54  2
     D  SOKDM                 55     55
     D  FAKDM                 55     55
     D  SOBELN                56     68  2
     D  FABELN                56     68  2
     D                 DS
     D  HOHT1                  1     80
     D  HOHT2                 81    160
     D  HOHT3                161    240
     D  HOHT4                241    320
     D  HOHT5                321    400
     D  HOHT6                401    480
     D  HOHT7                481    560
     D  HOBT1                561    640
     D  HOBT2                641    720
     D  HOBT3                721    800
     D  HP                     1    800
     D                                     DIM(10)
     D                 DS
     D  WKID                   1     19  0
     D                                     DIM(19)
     D  XWKID                  1     19
     D  KUNDNR                 1      8  0
     D  TEFFNR                 9     15  0
     D  XNULL                 16     19  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D  UPRO                  22     29  0
     D  UHOD                  47     47
     D  UBBS                  48     48
     D  O2                    49     60
     D                                     DIM(6)
     D  UIKKE                 63     63
     D  UDT                   64     69  0
     D  UF                   101    310
     D  WSID                 401    410
     D  UGN                  981    995
     C*
     C                   EXSR      INIT
     C*
     C* COPYROUTINE  VED UKOPI='J'
     C*
     C     UKOPI         IFEQ      'J'
     C                   SETON                                        51
     C                   EXSR      KOPISR
     C                   GOTO      SLUTT
     C                   END
     C*
     C     SLUTT         TAG
     C                   MOVE      XPRANT        UPRANT
     C*
     C*  OVERFØRING REGNSKAP KONTINUERLIG ????
     C*
     C     FIKONT        IFEQ      'J'
     C     FIKONT        OREQ      'Y'
     C                   CALL      'SYFA35CA'
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KOPISR        BEGSR
     C***********************************************
     C*
     C* SUBRUTINE FOR PRINT OF DOKUMENT COPIES
     C*
     C                   Z-ADD     1             XN                2 0
     C     LESWRK        TAG
     C                   READ      AMFAKWRK                               77
     C     *IN77         IFEQ      *OFF
     C                   MOVE      AFFAKT        WIFN              7 0
     C                   SETOFF                                       33
     C  N33              DO
     C     STKOPI        TAG
     C                   SETOFF                                       32
     C  N33              DO
     C                   MOVE      ' '           KOPISK            1
     C*
     C                   MOVE      'F'           GLSTAT
     C                   SETOFF                                       33
     C     FAK2KC        SETLL     FAK3
     C     FAK2KC        READE     FAK3                                   33
     C*
     C  N33              MOVE      FASK          KOPISK
     C*
     C* CHANGES INVOICEDATE
     C*
     C                   MOVE      FADATO        IDAG
     C                   MOVE      IDAGA         IDAGXA
     C                   MOVE      IDAGM         IDAGXM
     C                   MOVE      IDAGD         IDAGXD
     C                   MOVE      FADAFF        XFFDT2
     C                   MOVE      XFFD2D        XFFDTD
     C                   MOVE      XFFD2M        XFFDTM
     C                   MOVE      XFFD2A        XFFDTA
     C*
     C                   MOVE      AFFAKT        XFN
     C                   MOVE      AFFAKT        TEFFNR
     C                   EXSR      PRINT
     C*
     C                   END                                                    <DO N33
     C                   END                                                    <DO N33
     C                   GOTO      LESWRK
     C                   END                                                    <*IN77
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C* VARIABLE VAT
     C                   MOVE      FITAX         FITAXB            4 4
     C                   MOVE      FITAX         PRITAX
     C     FITAXD        IFNE      *ZEROS
     C     FITAX2        ANDNE     *ZEROS
     C     IDAG          ANDLT     FITAXD
     C                   MOVE      FITAX2        FITAXB            4 4
     C                   MOVE      FITAX2        PRITAX
     C                   END
     C*
     C* MOVE *ZEROS NUMBER OF INVOICES
     C                   MOVE      *ZEROS        NBRINV            2 0
     C* MAIN ROUTIN FOR PRINTING OF INVOICE
     C                   SETOFF                                       50
     C                   MOVE      *ZEROS        XSFANR            6 0
     C                   MOVE      *ZEROS        XKFANR            6 0
     C*** GETS THE DEPARTMENTS INFORMATIONS
     C  N45              EXSR      AVDSR
     C  N45              SETON                                        45
     C*
     C*
     C*** TESTS IF TEXT CASH SHALL BE WRITTEN
     C     KO2KON        COMP      'J'                                    39
     C*** FREE INVIOCING
     C     STFREE        TAG
     C                   MOVE      'X'           YSK
     C                   SETOFF                                       33
     C* DOES INVOICING OF FREE IF THERE ARE LINES
     C                   EXSR      SRFREE
     C*
     C     SLPT          ENDSR
     C*
     C***********************************************
     C     SRFREE        BEGSR
     C***********************************************
     C*** HENTER AMETAOPPLYSNINGER
     C* VANLIG FAKTURA
     C                   MOVE      FAFAKT        YFAKN1
     C     AMHEK1        CHAIN     AMHE1                              33
     C     *IN33         IFEQ      *OFF
     C                   MOVE      '4'           AHST
     C                   UPDATE    AMHER1
     C                   ENDIF                                                  <*IN33
     C* KREDITERING
     C     *IN33         IFEQ      *ON
     C                   MOVE      FAFAKT        YFAKN2
     C     AMHEK2        CHAIN     AMHE2                              31
     C     *IN31         IFEQ      *OFF
     C                   MOVE      '4'           AHST
     C                   UPDATE    AMHER2
     C                   ENDIF                                                  <*IN31
     C                   ENDIF                                                  <*IN33
     C*** HENTER KUNDEOPPLYSNINGER
     C                   MOVE      FAKUNR        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C     POSTNR        COMP      0                                      37
     C     SYPOGE        COMP      *BLANKS                                38
     C*
     C                   ADD       1             XPRANT
     C*
     C                   MOVE      FAVAL         XVAL              3
     C     UFIRM         CHAIN     FIRM                               33
     C*
     C                   MOVE      *OFF          *IN70
     C                   MOVE      *OFF          *IN79
     C     SPRAAK        IFEQ      'T'
     C                   MOVE      *ON           *IN79
     C                   ELSE
     C                   MOVE      *ON           *IN70
     C                   ENDIF
     C                   EXSR      BETSR
     C*
     C                   EXSR      VALI
     C*
     C     SLFRE         ENDSR
     C*
     C***********************************************
     C     VALI          BEGSR
     C***********************************************
     C*
     C* GETS TEXT OF COUNTRY OF INVOICERECIEVER
     C                   MOVE      *BLANKS       KLKNVN
     C     LKKEY         CHAIN     KODTLKR                            33
     C*
     C  N70
     CANN79              MOVE      HO            HP
     C   70              MOVE      HE            HP
     C   79              MOVE      HT            HP
     C     DKUND         COMP      'D'                                    48
     C                   SETOFF                                       88
     C                   Z-ADD     2             XSIDE
     C*
     C* TESTS IF IT IS A CREDITNOTE
     C*
     C                   EXSR      KREDIT
     C*
     C  N70KO2NTX        COMP      *BLANKS                                33
     C  N70
     CAN 33              MOVE      XF2NV         KO2NTX
     C   70KO2ETX        COMP      *BLANKS                                33
     C   70
     CAN 33              MOVE      XF2NV2        KO2ETX
     C     XBRUTT        COMP      0                                    73
     C     XVAL          COMP      FICURR                             7171
     C   88              WRITE     KJØP1
     C                   MOVE      ADR3          ADR3B
     C                   MOVE      ADR3          ADR3C
     C                   MOVE      HP(1)         HP1
     C                   MOVE      HP(2)         HP2
     C                   MOVE      HP(3)         HP3
     C                   MOVE      HP(4)         HP4
     C                   MOVE      HP(5)         HP5
     C                   MOVE      HP(6)         HP6
     C                   MOVE      HP(7)         HP7
     C                   EXSR      KDTFM1
     C                   ADD       1             NBRINV
     C                   WRITE     KJØP
     C   55              WRITE     HEAT
     C                   WRITE     HEAD22
     C                   EXSR      KDTFM1
     C*
     C* END HEADING
     C* PRINT DETAIL/LINES
     C*
     C     SORTK         SETLL     SORT
     C                   MOVE      *ZEROS        XTOTAL           13 2
     C                   MOVE      *ZEROS        XMVAGR
     C                   MOVE      *ZEROS        XANTL             2 0
     C*
     C     STVALI        TAG
     C                   SETOFF                                       33
     C                   READ      SORT                                   33
     C   33              GOTO      STVAL2
     C* TEST IF NEXT LINE HAVE SOME CODE AND NO TEXT
     C*
     C     SOVT          IFEQ      *BLANKS
     C                   MOVE      SOKDM         XOKDM             1
     C                   MOVE      SOVK          XOVK              3
     C                   MOVE      SOVT          XOVT             20
     C                   MOVE      SOBELN        XOBELN           13 2
     C                   MOVE      SOBELV        XOBELV           13 2
     C                   EXSR      TESTEQ
     C                   END
     C     FAKDM         COMP      'J'                                    34
     C   34
     CANN71              ADD       FABELN        XMVAGR
     C   34
     CAN 71              ADD       FABELV        XMVAGR
     C                   MOVE      FAVK          YVK
     C     KODGEK        CHAIN     KOGER                              33
     C   79KODG2K        CHAIN     KOG2R                              33
     C  N71              ADD       FABELN        XTOTAL
     C   71              ADD       FABELV        XTOTAL
     C     XFAVT1        IFEQ      'X'
     C                   MOVEL     XFAVT2        KGENOT
     C                   MOVEL     XFAVT2        KGEENT
     C                   MOVEL     XFAVT2        KG2TYT
     C                   MOVE      ' '           KGENOT
     C                   MOVE      ' '           KGEENT
     C                   MOVE      ' '           KG2TYT
     C                   MOVE      *BLANKS       FAVT
     C                   END
     C*
     C                   MOVE      XVAL          XVALB
     C                   MOVE      XVAL          XVALC
     C* NOT BORDEREAU
     C                   DELETE    SORTR
     C                   ADD       1             XANTL
     C  N35XANTL         COMP      11                                 88  88
     C   35XANTL         COMP      29                                 88  88
     C*
     C* PAGE 2
     C*
     C                   GOTO      STVALI
     C*
     C     STVAL2        TAG
     C*
     C     XMVAGR        MULT(H)   FITAXB        XMOMS            13 2
     C                   Z-ADD     XMOMS         XPMOMS
     C     XTOTAL        ADD       XMOMS         XBRUTT
     C                   MOVE      XBRUTT        XTOTØR
     C     XPMOMS        COMP      0                                  7272
     C* SPESIAL BORDEREAU
     C   72              MOVE      XVAL          XVALB
     C   72              MOVE      XVAL          XVALC
     C   72              WRITE     TOTA
     C   72              Z-ADD     0             XMVAGR
     C                   MOVE      HP(8)         HP8
     C                   MOVE      HP(9)         HP9
     C                   MOVE      HP(10)        HP10
     C  N35              WRITE     TOTB0
     C  N35              WRITE     TOTB
     C  N35              Z-ADD     0             XBRUTT
     C   35              WRITE     TOTC0
     C   35              WRITE     TOTC
     C   35              Z-ADD     0             XBRUTT
     C*
     C   71
     COR 73              GOTO      SLVALI
     C*
     C     SLVALI        ENDSR
     C*
     C***********************************************
     C     KREDIT        BEGSR
     C***********************************************
     C* TESTS IF IT IS A CREDITNOTE
     C*
     C     XVAL          COMP      FICURR                             7171
     C     UKOPI         IFEQ      'J'
     C     UIN05         ANDEQ     '0'
     C                   SETOFF                                       33
     C     FAK2KC        SETLL     FAK3
     C                   END
     C*
     C                   MOVE      *ZEROS        XTOTAL
     C                   MOVE      *ZEROS        XMVAGR
     C*
     C     STKRE         TAG
     C                   SETOFF                                       33
     C     UKOPI         IFEQ      'J'
     C     UIN05         ANDEQ     '0'
     C     FAK2KC        READE     FAK3                                   33
     C                   END
     C   33              GOTO      SLKRE
     C     FAKDM         COMP      'J'                                    34
     C   34
     CANN71              ADD       FABELN        XMVAGR
     C   34
     CAN 71              ADD       FABELV        XMVAGR
     C  N71              ADD       FABELN        XTOTAL
     C   71              ADD       FABELV        XTOTAL
     C                   MOVE      FAVK          YVK
     C     KODGEK        CHAIN     KOGER                              33
     C     KODG2K        CHAIN     KOG2R                              33
     C                   WRITE     SORTR
     C                   GOTO      STKRE
     C*
     C     SLKRE         TAG
     C     XMVAGR        MULT(H)   FITAXB        XMOMS
     C     XTOTAL        ADD       XMOMS         XBRUTT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     BETSR         BEGSR
     C***********************************************
     C*
     C                   MOVE      *BLANKS       KLKNVN
     C     LKKEY         CHAIN     KODTLKR                            33
     C*
     C*** FINNER BETBET OG FORFALLSDATO
     C     UKOPI         IFEQ      'J'
     C                   MOVE      XFFDT         FFKOPI            6 0
     C                   END
     C                   MOVE      *ZEROS        XFFDT
     C                   MOVE      *BLANKS       BETTXT
     C                   CALL      'SYFA20A'
     C     XFFDT         PARM      XFFDT         UFFDT             6 0
     C                   PARM                    BETTXT
     C                   PARM                    UFIRM
     C                   PARM                    BETBET
     C*
     C     UKOPI         IFEQ      'J'
     C                   MOVE      FFKOPI        XFFDT             6 0
     C                   END
     C                   MOVE      XFFDTD        XFFD2D
     C                   MOVE      XFFDTM        XFFD2M
     C                   MOVE      XFFDTA        XFFD2A
     C     XFFDTA        IFGT      50
     C                   MOVEL     '19'          XFFD2A
     C                   ELSE
     C                   MOVEL     '20'          XFFD2A
     C                   END
      *
     C                   ENDSR
     C*
     C********************************************************************
     C     AVDSR         BEGSR
     C******************************************
     C     KODTAK        CHAIN     KOAR                               33
     C                   MOVE      KOAKNR        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              DO
     C                   MOVE      KNAVN         XFNAVN           30
     C                   MOVE      ADR1          XFADR1           30
     C                   MOVE      ADR2          XFADR2           30
     C                   MOVE      POSTNR        XFPONR            4 0
     C                   MOVE      ADR3          XFADR3           24
     C                   MOVE      BANKG         XFBANK           15
     C                   END
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C*
     C                   SETOFF                                       55
     C*
     C     LKKEY         KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    SYLAND
     C     FAKTK         KLIST
     C                   KFLD                    FALI
     C                   KFLD                    FAAVD
     C                   KFLD                    FAOPD
     C     FAK2KC        KLIST
     C                   KFLD                    GLSTAT
     C                   KFLD                    WIFN
     C     AMHEK1        KLIST
     C                   KFLD                    YFAKN1            7 0
     C     AMHEK2        KLIST
     C                   KFLD                    YFAKN2            7 0
     C     SORTK         KLIST
     C                   KFLD                    YSOLNR
     C                   KFLD                    YSOSAM
     C                   KFLD                    YSOAVD
     C                   KFLD                    YSOOPD
     C                   KFLD                    YSOSK
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    YVK
     C     KODG2K        KLIST
     C                   KFLD                    YG2UNI
     C                   KFLD                    YVK
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C     HODEK         KLIST
     C                   KFLD                    YNET
     C                   KFLD                    UAVD
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    YKN
     C     FAINK         KLIST
     C                   KFLD                    WIFN
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    UAVD
     C     KODTWK        KLIST
     C                   KFLD                    KOWUNI
     C                   KFLD                    UAVD
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
     C                   PARM                    UFFAK             1
     C                   PARM                    UIN05             1
     C                   PARM                    UIN06             1
     C                   PARM                    UIN07             1
     C                   PARM                    UIN08             1
     C                   PARM                    UKOPI             1
     C*
     C     UKOPI         COMP      'J'                                    54
     C                   MOVE      'O'           GLSTAT            1
     C                   MOVE      ' '           YSK               1
     C                   MOVE      *ZEROS        YOPD              7 0
     C                   MOVE      ' '           YST               1
     C                   MOVE      *ZEROS        YSOLNR            3 0
     C                   MOVE      '   '         YSOSAM            1
     C                   MOVE      *ZEROS        YSOAVD            4 0
     C                   MOVE      *ZEROS        YSOOPD            7 0
     C                   MOVE      ' '           YSOSK             1
     C                   MOVE      *ZEROS        YSKKN             8 0
     C                   MOVE      'GE'          YGEUNI            2
     C                   MOVE      *BLANKS       YVK               3
     C                   MOVE      'G2'          YG2UNI            2
     C                   MOVE      'OTY'         YOTUNI            3
     C                   MOVE      'O2Y'         YO2UNI            3
     C                   MOVE      'FR'          YFRUNI            2
     C                   MOVEL     'LK'          YLKUNI            3
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'Å'           YÅUNI             1
     C                   MOVE      *ZEROS        YDTMP             2 0
     C                   MOVE      *ZEROS        YDTÅP             2 0
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      *BLANKS       YNET              1
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVE      *ZEROS        KUNDNR
     C                   MOVE      *ZEROS        TEFFNR
     C                   MOVE      *ZEROS        XNULL
     C                   MOVE      *ZEROS        SOLNR
     C                   MOVEL     'I N V O '    XF2NV2           16
     C                   MOVE      'I C E   '    XF2NV2
     C                   MOVE      *ZEROS        IDAG
     C                   MOVE      UDAY          IDAGD
     C                   MOVE      UMONTH        IDAGM
     C                   MOVE      UYEAR         IDAGA
     C     UYEAR         IFGT      50
     C                   MOVEL     '19'          IDAGA
     C                   ELSE
     C                   MOVEL     '20'          IDAGA
     C                   END
     C                   MOVE      UDAY          IDAGXD
     C                   MOVE      UMONTH        IDAGXM
     C                   MOVE      UYEAR         IDAGXA
     C                   MOVE      *ZEROS        XFFDT
     C                   MOVE      *ZEROS        XFFDT2
     C                   MOVEL     '2BD10601'    XW77             16
     C                   MOVE      '00000154'    XW77
     C                   MOVEL     '2BD10601'    XW66             16
     C                   MOVE      '00000277'    XW66
     C*
     C* TESTS IF GIRO SHALL BE WRITTEN INDICATOR 35
     C* ALSO WHEN SPLIT IS DEFINED
     C*
     C                   MOVE      'W'           KOWUNI
     C     KODTWK        CHAIN     KOWR                               33
     C     UBBS          COMP      'N'                                    35
     C  N35KOWAWB        COMP      'J'                                    35
     C*
     C     UHOD          IFEQ      'J'
     C                   SETON                                        4446
     C                   ELSE
     C     UHOD          IFEQ      'T'
     C                   SETOFF                                       44
     C                   SETON                                        46
     C                   ELSE
     C     UHOD          IFEQ      'B'
     C                   SETON                                        44
     C                   SETOFF                                       46
     C                   END
     C                   END
     C                   END
     C*
     C   44
     COR 46              DO
     C*** 44 PÅ SKRIVER UT BUNN     46 PÅ SKRIVER UT TOPP
     C     HODEK         CHAIN     HODE                               33
     C  N33              MOVE      HP            HO
     C                   MOVEL     'E'           YNET
     C     HODEK         CHAIN     HODE                               33
     C  N33              MOVE      HP            HE
     C                   MOVEL     'T'           YNET
     C     HODEK         CHAIN     HODE                               33
     C  N33              MOVE      HP            HT
     C*
     C                   END
     C*
     C                   MOVE      'V'           KOVUNI
     C     KODTVK        CHAIN     KOVR                               33
     C*
     C     UFIRM         CHAIN     FIRM                               33
     C*
     C* GETS HEADINGTEXTS FROM MESSAGEMEMBERS FOR BOREDRAU
     C* GENERAL
     C                   EXSR      GETMSG
     C                   MOVE      *BLANKS       SYLAND            2
     C                   MOVE      *BLANKS       HELKS             2
     C                   MOVE      *BLANKS       HELKK             2
     C                   MOVE      *BLANKS       SYPOGE            9
     C                   ENDSR
     C*
     C***********************************************
     C     GETMSG        BEGSR
     C***********************************************
     C* GETS MSGMEMBERS GENERAL ROUTINE
     C*
     C*
     C                   MOVE      'DIV1679'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     80            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1679           80
     C*
     C                   MOVE      'DIV1680'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     30            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1680           30
     C*
     C                   MOVE      'DIV1681'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     12            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1681           12
     C*
     C                   MOVE      'DIV1682'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     16            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1682           16
     C*
     C                   MOVE      'DIV1683'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     20            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1683           20
     C*
     C                   MOVE      'DIV1684'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     24            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1684           24
     C*
     C                   MOVE      'DIV1685'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     12            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1685           12
     C*
     C                   MOVE      'DIV1651'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     13            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1651           13
     C*
     C                   MOVE      'DIV1652'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     13            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1652           13
     C*
     C                   MOVE      'DIV1661'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     13            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1661           13
     C*
     C                   MOVE      'DIV1665'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     15            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1665           15
     C*
     C                   MOVE      'DIV1667'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     15            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1667           15
     C*
     C                   MOVE      'DIV1670'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     15            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1670           15
     C*
     C                   MOVE      'DIV1663'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     13            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          TX1663           13
     C*
     C*
     C                   MOVE      'PRI0020'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     16            XMSGL             4 0          LENGDE PÅ MELDING
     C                   EXSR      GETTXT
     C                   MOVEL     XMSG          XF2NV            16
     C*
     C                   ENDSR
     C***********************************************
     C     GETTXT        BEGSR
     C***********************************************
     C                   Z-ADD     3             XLEVEL            1 0
     C                   Z-ADD     0             XRETUR            1 0
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG            120
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFM1        BEGSR
     C***********************************************
     C                   MOVE      IDAGXD        UDT1              2 0
     C                   MOVE      IDAGXM        UDT2              2 0
     C                   MOVE      IDAGXA        UDT3              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          IDAGXD
     C                   MOVE      UDT2          IDAGXM
     C                   MOVE      UDT3          IDAGXA
     C*
     C                   MOVE      XFFDTD        UDT1
     C                   MOVE      XFFDTM        UDT2
     C                   MOVE      XFFDTA        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XFFDTD
     C                   MOVE      UDT2          XFFDTM
     C                   MOVE      UDT3          XFFDTA
     C                   MOVE      AHADDD        UDT1
     C                   MOVE      AHADMM        UDT2
     C                   MOVE      AHADÅÅ        UDT3
     C                   EXSR      KDTFMT
     C                   MOVE      UDT1          XHADDD
     C                   MOVE      UDT2          XHADMM
     C                   MOVE      UDT3          XHADÅÅ
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTEQ        BEGSR
     C***********************************************
     C     STEQ          TAG
     C                   READ      SORT                                   33
     C   33              DO
     C     *LOVAL        SETLL     SORT
     C                   READ      SORT                                   33
     C                   GOTO      UTEQSR
     C                   END
     C*
     C     XOKDM         IFEQ      SOKDM
     C     XOVK          IFEQ      SOVK
     C     XOVT          IFEQ      SOVT
     C                   ADD       SOBELN        XOBELN
     C                   ADD       SOBELV        XOBELV
     C                   DELETE    SORTR
     C                   GOTO      STEQ
     C                   ELSE
     C                   GOTO      UTEQ
     C                   END
     C                   ELSE
     C                   GOTO      UTEQ
     C                   END
     C                   ELSE
     C                   GOTO      UTEQ
     C                   END
     C     UTEQ          TAG
     C                   READP     SORT                                   33
     C     UTEQSR        TAG
     C                   Z-ADD     XOBELN        SOBELN
     C                   Z-ADD     XOBELV        SOBELV
     C                   ENDSR
