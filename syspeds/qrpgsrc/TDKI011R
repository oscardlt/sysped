      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/TDKI011R MODULE(*LIBL/TDKI011R *LIBL/INCGI)
CRTPGM*        ACTGRP(*NEW) AUT(*USE)
      *
      *********************************************************************
      /copy SYSPEDS/qrpgsrcpy,hspecs
      /copy SYSPEDS/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     IF   E           K DISK    USROPN
     FDKIV      IF   E           K DISK    USROPN
     FDKIVA     IF   E           K DISK    USROPN
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy SYSPEDS/qrpgsrcpy,prototypeb
      /copy SYSPEDS/qrpgsrcpy,usec
      /copy SYSPEDS/qrpgsrcpy,variables3
      *
      * Varible for
     D WSUSER          S             10
     D AVD             S              4
     D AVDN            S              4  0
     D OPD             S              7
     D OPDN            S              7  0
S01  D*LIN             S              2
S01  D*LINN            S              2  0
N01  D LIN             S              5
N01  D LINN            S              5  0
     D JSONstring      s          32000
     D Error           S            150
     D AntLest         S              9  0
     D                 DS
     D  Å00                    1     35
     D                                     DIM(5)
     D  Å00A                   1      7
     D  Å00B                   8     14
     D  Å00C                  15     21
     D  Å00D                  20     28
     D  Å00E                  27     35
     D                 DS
     D  Å01                    1     15
     D                                     DIM(5)
     D  Å01A                   1      3
     D  Å01B                   4      6
     D  Å01C                   7      9
     D  Å01D                  10     12
     D  Å01E                  13     15
     D                 DS
     D  Å02                    1     75  0
     D                                     DIM(5)
     D  Å02A                   1     15S 0
     D  Å02B                  16     30S 0
     D  Å02C                  31     45S 0
     D  Å02D                  46     60S 0
     D  Å02E                  61     75S 0
     D                 DS
     D  Å03                    1     55  2
     D                                     DIM(5)
     D  Å03A                   1     11S 2
     D  Å03B                  12     22S 2
     D  Å03C                  23     33S 2
     D  Å03D                  34     44S 2
     D  Å03E                  45     55S 2
     D                 DS
     D  Å04                    1     20
     D                                     DIM(5)
     D  Å04A                   1      4
     D  Å04B                   5      8
     D  Å04C                   9     12
     D  Å04D                  13     16
     D  Å04E                  17     20
     D                 DS
     D  Å05                    1     85  2
     D                                     DIM(5)
     D  Å05A                   1     17S 2
     D  Å05B                  18     34S 2
     D  Å05C                  35     51S 2
     D  Å05D                  52     68S 2
     D  Å05E                  69     85S 2

      *get input-string
      /copy syspeds/qrpgsrcpy,prolog3

      * Parse input
     C                   EXSR      Parse
      * Open files etc
     C                   EXSR      INIT

     C                   CALLP     gethtmlifs(
     C                             '/syspeddev/html/JSON.html':
     C                             '/CGITAG/')
     C                   CALLP     wrtsection('top')
      * ............................................................................................
      * skriv JSON-Object start..(alltid '{' + x ant param. m/komma mellom (IKKE komma etter siste))
      * ............................................................................................
      /free
        JSONstring='{'
        +'¬user¬ : ¬'+%trim(WSUSER)+'¬, '
        +'¬avd¬ : ¬'+%trim(%editc(AVDN:'Z'))+'¬, '
        +'¬opd¬ : ¬'+%trim(%editc(OPDN:'Z'))+'¬, '
        +'¬lin¬ : ¬'+%trim(%editc(LINN:'Z'))+'¬, '
        +'¬errMsg¬ : ¬'+%trim(Error)+'¬, ¬oneline¬ : [';
      /end-free
      * JSONfix escaper " i tekst,  for deretter å bytte ¬->"
     C                   CALL      'JSONFIX'
     C                   PARM                    JSONstring
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')
      * Hæmta detta ena ærendet.

     C     Error         IFEQ      *blanks
     C     DKIVKey       CHAIN     DKIV                               55
     C     *IN55         IFEQ      '0'
      * Hæmta avgifter
     C                   EXSR      AVG
      * ............................................................................................
      * Skriv en JSON-Array-linje pr menypunkt - komma før hvert nytt element
      * ............................................................................................
      /free
          JSONstring=*blanks;
       JSONstring=%trim(JSONstring)+'{'
          +'¬dkiv_syav¬ : ¬'+%trim(%editc(DKIV_SYAV:'Z'))+'¬, '
          +'¬dkiv_syop¬ : ¬'+%trim(%editc(DKIV_SYOP:'Z'))+'¬, '
          +'¬dkiv_syli¬ : ¬'+%trim(%editc(DKIV_SYLI:'Z'))+'¬, '
          +'¬dkiv_311a¬ : ¬'+%trim(DKIV_311A)+'¬, '
          +'¬dkiv_311b¬ : ¬'+%trim(DKIV_311B)+'¬, '
          +'¬dkiv_311c¬ : ¬'+%trim(DKIV_311C)+'¬, '
          +'¬dkiv_311d¬ : ¬'+%trim(DKIV_311D)+'¬, '
          +'¬dkiv_311e¬ : ¬'+%trim(DKIV_311E)+'¬, '
          +'¬dkiv_312a¬ : ¬'+%trim(DKIV_312A)+'¬, '
          +'¬dkiv_312b¬ : ¬'+%trim(DKIV_312B)+'¬, '
          +'¬dkiv_312c¬ : ¬'+%trim(DKIV_312C)+'¬, '
          +'¬dkiv_312d¬ : ¬'+%trim(DKIV_312D)+'¬, '
          +'¬dkiv_312e¬ : ¬'+%trim(DKIV_312E)+'¬, '
          +'¬dkiv_313a¬ : ¬'+%trim(%editc(DKIV_313A:'Z'))+'¬, '
          +'¬dkiv_313b¬ : ¬'+%trim(%editc(DKIV_313B:'Z'))+'¬, '
          +'¬dkiv_313c¬ : ¬'+%trim(%editc(DKIV_313C:'Z'))+'¬, '
          +'¬dkiv_313d¬ : ¬'+%trim(%editc(DKIV_313D:'Z'))+'¬, '
          +'¬dkiv_313e¬ : ¬'+%trim(%editc(DKIV_313E:'Z'))+'¬, '
          +'¬dkiv_314a¬ : ¬'+%trim(DKIV_314A)+'¬, '
          +'¬dkiv_314b¬ : ¬'+%trim(DKIV_314B)+'¬, '
          +'¬dkiv_314c¬ : ¬'+%trim(DKIV_314C)+'¬, '
          +'¬dkiv_314d¬ : ¬'+%trim(DKIV_314D)+'¬, '
          +'¬dkiv_314e¬ : ¬'+%trim(DKIV_314E)+'¬, '
          +'¬dkiv_315a¬ : ¬'+%trim(DKIV_315A)+'¬, '
          +'¬dkiv_315b¬ : ¬'+%trim(DKIV_315B)+'¬, '
          +'¬dkiv_315c¬ : ¬'+%trim(DKIV_315C)+'¬, '
          +'¬dkiv_315d¬ : ¬'+%trim(DKIV_315D)+'¬, '
          +'¬dkiv_315e¬ : ¬'+%trim(DKIV_315E)+'¬, '
          +'¬dkiv_32¬ : ¬'+%trim(%editc(DKIV_32:'4'))+'¬, '
          +'¬dkiv_331¬ : ¬'+%trim(DKIV_331)+'¬, '
          +'¬dkiv_332¬ : ¬'+%trim(DKIV_332)+'¬, '
          +'¬dkiv_333¬ : ¬'+%trim(DKIV_333)+'¬, '
          +'¬dkiv_sikk¬ : ¬'+%trim(DKIV_SIKK)+'¬, '
          +'¬dkiv_34¬ : ¬'+%trim(DKIV_34)+'¬, '
          +'¬dkiv_35¬ : ¬'+%trim(%editc(DKIV_35:'4'))+'¬, '
          +'¬dkiv_36¬ : ¬'+%trim(DKIV_36)+'¬, '
          +'¬dkiv_37¬ : ¬'+%trim(DKIV_37)+'¬, '
          +'¬dkiv_38¬ : ¬'+%trim(%editc(DKIV_38:'4'))+'¬, '
          +'¬dkiv_39¬ : ¬'+%trim(DKIV_39)+'¬, '
          +'¬dkiv_s27¬ : ¬'+%trim(DKIV_S27)+'¬, '
          +'¬dkiv_401a¬ : ¬'+%trim(DKIV_401A)+'¬, '
          +'¬dkiv_401b¬ : ¬'+%trim(DKIV_401B)+'¬, '
          +'¬dkiv_401c¬ : ¬'+%trim(DKIV_401C)+'¬, '
          +'¬dkiv_401d¬ : ¬'+%trim(DKIV_401D)+'¬, '
          +'¬dkiv_401e¬ : ¬'+%trim(DKIV_401E)+'¬, '
          +'¬dkiv_401f¬ : ¬'+%trim(DKIV_401F)+'¬, '
          +'¬dkiv_401g¬ : ¬'+%trim(DKIV_401G)+'¬, '
          +'¬dkiv_401h¬ : ¬'+%trim(DKIV_401H)+'¬, '
          +'¬dkiv_401i¬ : ¬'+%trim(DKIV_401I)+'¬, '
          +'¬dkiv_401j¬ : ¬'+%trim(DKIV_401J)+'¬, '
          +'¬dkiv_401k¬ : ¬'+%trim(DKIV_401K)+'¬, '
          +'¬dkiv_401l¬ : ¬'+%trim(DKIV_401L)+'¬, '
          +'¬dkiv_401m¬ : ¬'+%trim(DKIV_401M)+'¬, '
          +'¬dkiv_401n¬ : ¬'+%trim(DKIV_401N)+'¬, '
          +'¬dkiv_401o¬ : ¬'+%trim(DKIV_401O)+'¬, '
          +'¬dkiv_401p¬ : ¬'+%trim(DKIV_401P)+'¬, '
          +'¬dkiv_401q¬ : ¬'+%trim(DKIV_401Q)+'¬, '
          +'¬dkiv_401r¬ : ¬'+%trim(DKIV_401R)+'¬, '
          +'¬dkiv_401s¬ : ¬'+%trim(DKIV_401S)+'¬, '
          +'¬dkiv_401t¬ : ¬'+%trim(DKIV_401T)+'¬, '
          +'¬dkiv_401u¬ : ¬'+%trim(DKIV_401U)+'¬, '
          +'¬dkiv_401v¬ : ¬'+%trim(DKIV_401V)+'¬, '
          +'¬dkiv_401w¬ : ¬'+%trim(DKIV_401W)+'¬, '
          +'¬dkiv_401x¬ : ¬'+%trim(DKIV_401X)+'¬, '
          +'¬dkiv_401y¬ : ¬'+%trim(DKIV_401Y)+'¬, '
          +'¬dkiv_402a¬ : ¬'+%trim(DKIV_402A)+'¬, '
          +'¬dkiv_402b¬ : ¬'+%trim(DKIV_402B)+'¬, '
          +'¬dkiv_402c¬ : ¬'+%trim(DKIV_402C)+'¬, '
          +'¬dkiv_402d¬ : ¬'+%trim(DKIV_402D)+'¬, '
          +'¬dkiv_402e¬ : ¬'+%trim(DKIV_402E)+'¬, '
          +'¬dkiv_402f¬ : ¬'+%trim(DKIV_402F)+'¬, '
          +'¬dkiv_402g¬ : ¬'+%trim(DKIV_402G)+'¬, '
          +'¬dkiv_402h¬ : ¬'+%trim(DKIV_402H)+'¬, '
          +'¬dkiv_402i¬ : ¬'+%trim(DKIV_402I)+'¬, '
          +'¬dkiv_402j¬ : ¬'+%trim(DKIV_402J)+'¬, '
          +'¬dkiv_402k¬ : ¬'+%trim(DKIV_402K)+'¬, '
          +'¬dkiv_402l¬ : ¬'+%trim(DKIV_402L)+'¬, '
          +'¬dkiv_402m¬ : ¬'+%trim(DKIV_402M)+'¬, '
          +'¬dkiv_402n¬ : ¬'+%trim(DKIV_402N)+'¬, '
          +'¬dkiv_402o¬ : ¬'+%trim(DKIV_402O)+'¬, '
          +'¬dkiv_402p¬ : ¬'+%trim(DKIV_402P)+'¬, '
          +'¬dkiv_402q¬ : ¬'+%trim(DKIV_402Q)+'¬, '
          +'¬dkiv_402r¬ : ¬'+%trim(DKIV_402R)+'¬, '
          +'¬dkiv_402s¬ : ¬'+%trim(DKIV_402S)+'¬, '
          +'¬dkiv_402t¬ : ¬'+%trim(DKIV_402T)+'¬, '
          +'¬dkiv_402u¬ : ¬'+%trim(DKIV_402U)+'¬, '
          +'¬dkiv_402v¬ : ¬'+%trim(DKIV_402V)+'¬, '
          +'¬dkiv_402w¬ : ¬'+%trim(DKIV_402W)+'¬, '
          +'¬dkiv_402x¬ : ¬'+%trim(DKIV_402X)+'¬, '
          +'¬dkiv_402y¬ : ¬'+%trim(DKIV_402Y)+'¬, '
          +'¬dkiv_403a¬ : ¬'+%trim(DKIV_403A)+'¬, '
          +'¬dkiv_403b¬ : ¬'+%trim(DKIV_403B)+'¬, '
          +'¬dkiv_403c¬ : ¬'+%trim(DKIV_403C)+'¬, '
          +'¬dkiv_403d¬ : ¬'+%trim(DKIV_403D)+'¬, '
          +'¬dkiv_403e¬ : ¬'+%trim(DKIV_403E)+'¬, '
          +'¬dkiv_403f¬ : ¬'+%trim(DKIV_403F)+'¬, '
          +'¬dkiv_403g¬ : ¬'+%trim(DKIV_403G)+'¬, '
          +'¬dkiv_403h¬ : ¬'+%trim(DKIV_403H)+'¬, '
          +'¬dkiv_403i¬ : ¬'+%trim(DKIV_403I)+'¬, '
          +'¬dkiv_403j¬ : ¬'+%trim(DKIV_403J)+'¬, '
          +'¬dkiv_403k¬ : ¬'+%trim(DKIV_403K)+'¬, '
          +'¬dkiv_403l¬ : ¬'+%trim(DKIV_403L)+'¬, '
          +'¬dkiv_403m¬ : ¬'+%trim(DKIV_403M)+'¬, '
          +'¬dkiv_403n¬ : ¬'+%trim(DKIV_403N)+'¬, '
          +'¬dkiv_403o¬ : ¬'+%trim(DKIV_403O)+'¬, '
          +'¬dkiv_403p¬ : ¬'+%trim(DKIV_403P)+'¬, '
          +'¬dkiv_403q¬ : ¬'+%trim(DKIV_403Q)+'¬, '
          +'¬dkiv_403r¬ : ¬'+%trim(DKIV_403R)+'¬, '
          +'¬dkiv_403s¬ : ¬'+%trim(DKIV_403S)+'¬, '
          +'¬dkiv_403t¬ : ¬'+%trim(DKIV_403T)+'¬, '
          +'¬dkiv_403u¬ : ¬'+%trim(DKIV_403U)+'¬, '
          +'¬dkiv_403v¬ : ¬'+%trim(DKIV_403V)+'¬, '
          +'¬dkiv_403w¬ : ¬'+%trim(DKIV_403W)+'¬, '
          +'¬dkiv_403x¬ : ¬'+%trim(DKIV_403X)+'¬, '
          +'¬dkiv_403y¬ : ¬'+%trim(DKIV_403Y)+'¬, '
          +'¬dkiv_411¬ : ¬'+%trim(DKIV_411)+'¬, '
          +'¬dkiv_412¬ : ¬'+%trim(%editc(DKIV_412:'4'))+'¬, '
          +'¬dkiv_42¬ : ¬'+%trim(%editc(DKIV_42:'4'))+'¬, '
          +'¬dkiv_441¬ : ¬'+%trim(DKIV_441)+'¬, '
          +'¬dkiv_4421¬ : ¬'+%trim(DKIV_4421)+'¬, '
          +'¬dkiv_4422¬ : ¬'+%trim(DKIV_4422)+'¬, '
          +'¬dkiv_4423¬ : ¬'+%trim(DKIV_4423)+'¬, '
          +'¬dkiv_4424¬ : ¬'+%trim(DKIV_4424)+'¬, '
          +'¬dkiv_4425¬ : ¬'+%trim(DKIV_4425)+'¬, '
          +'¬dkiv_4426¬ : ¬'+%trim(DKIV_4426)+'¬, '
          +'¬dkiv_4427¬ : ¬'+%trim(DKIV_4427)+'¬, '
          +'¬dkiv_4428¬ : ¬'+%trim(DKIV_4428)+'¬, '
          +'¬dkiv_4429¬ : ¬'+%trim(DKIV_4429)+'¬, '
          +'¬dkiv_442a¬ : ¬'+%trim(DKIV_442A)+'¬, '
          +'¬dkiv_442b¬ : ¬'+%trim(DKIV_442B)+'¬, '
          +'¬dkiv_442c¬ : ¬'+%trim(DKIV_442C)+'¬, '
          +'¬dkiv_442d¬ : ¬'+%trim(DKIV_442D)+'¬, '
          +'¬dkiv_442e¬ : ¬'+%trim(DKIV_442E)+'¬, '
          +'¬dkiv_442f¬ : ¬'+%trim(DKIV_442F)+'¬, '
          +'¬dkiv_442g¬ : ¬'+%trim(DKIV_442G)+'¬, '
          +'¬dkiv_442h¬ : ¬'+%trim(DKIV_442H)+'¬, '
          +'¬dkiv_442i¬ : ¬'+%trim(DKIV_442I)+'¬, '
          +'¬dkiv_443¬ : ¬'+%trim(DKIV_443)+'¬, '
          +'¬dkiv_444a¬ : ¬'+%trim(DKIV_444A)+'¬, '
          +'¬dkiv_444b¬ : ¬'+%trim(DKIV_444B)+'¬, '
          +'¬dkiv_446ka¬ : ¬'+%trim(DKIV_446Ka)+'¬, '
          +'¬dkiv_446kb¬ : ¬'+%trim(DKIV_446Kb)+'¬, '
          +'¬dkiv_446kf¬ : ¬'+%trim(DKIV_446Kf)+'¬, '
          +'¬dkiv_446kj¬ : ¬'+%trim(DKIV_446Kj)+'¬, '
          +'¬dkiv_446kn¬ : ¬'+%trim(DKIV_446Kn)+'¬, '
          +'¬dkiv_446kr¬ : ¬'+%trim(DKIV_446Kr)+'¬, '
          +'¬dkiv_446ta¬ : ¬'+%trim(DKIV_446Ta)+'¬, '
          +'¬dkiv_446tb¬ : ¬'+%trim(DKIV_446Tb)+'¬, '
          +'¬dkiv_446tc¬ : ¬'+%trim(DKIV_446Tc)+'¬, '
          +'¬dkiv_446td¬ : ¬'+%trim(DKIV_446Td)+'¬, '
          +'¬dkiv_446te¬ : ¬'+%trim(DKIV_446Te)+'¬, '
          +'¬dkiv_446tf¬ : ¬'+%trim(DKIV_446Tf)+'¬, '
          +'¬dkiv_446tg¬ : ¬'+%trim(DKIV_446Tg)+'¬, '
          +'¬dkiv_446th¬ : ¬'+%trim(DKIV_446Th)+'¬, '
          +'¬dkiv_446ti¬ : ¬'+%trim(DKIV_446Ti)+'¬, '
          +'¬dkiv_446tj¬ : ¬'+%trim(DKIV_446Tj)+'¬, '
          +'¬dkiv_446tk¬ : ¬'+%trim(DKIV_446Tk)+'¬, '
          +'¬dkiv_446tl¬ : ¬'+%trim(DKIV_446Tl)+'¬, '
          +'¬dkiv_446tm¬ : ¬'+%trim(DKIV_446Tm)+'¬, '
          +'¬dkiv_446tn¬ : ¬'+%trim(DKIV_446Tn)+'¬, '
          +'¬dkiv_446to¬ : ¬'+%trim(DKIV_446To)+'¬, '
          +'¬dkiv_446tp¬ : ¬'+%trim(DKIV_446Tp)+'¬, '
          +'¬dkiv_446tq¬ : ¬'+%trim(DKIV_446Tq)+'¬, '
          +'¬dkiv_446tr¬ : ¬'+%trim(DKIV_446Tr)+'¬, '
          +'¬dkiv_446ts¬ : ¬'+%trim(DKIV_446Ts)+'¬, '
          +'¬dkiv_449a¬ : ¬'+%trim(DKIV_449A)+'¬, '
          +'¬dkiv_449b¬ : ¬'+%trim(DKIV_449B)+'¬, '
          +'¬dkiv_46¬ : ¬'+%trim(%editc(DKIV_46:'4'))+'¬, '
          +'¬dkiv_t11b¬ : ¬'+%trim(%editc(DKIV_T11B:'4'))+'¬, '
          +'¬dkiv_t12¬ : ¬'+%trim(%editc( DKIV_T12:'4'))+'¬, '
          +'¬dkiv_t13a¬ : ¬'+%trim(%editc(DKIV_T13A:'4'))+'¬, '
          +'¬dkiv_t13b¬ : ¬'+%trim(%editc(DKIV_T13B:'4'))+'¬, '
          +'¬dkiv_t13c¬ : ¬'+%trim(%editc(DKIV_T13C:'4'))+'¬, '
          +'¬dkiv_t14d¬ : ¬'+%trim(%editc(DKIV_T14A:'4'))+'¬, '
          +'¬dkiv_t14b¬ : ¬'+%trim(%editc(DKIV_T14B:'4'))+'¬, '
          +'¬dkiv_t14c¬ : ¬'+%trim(%editc(DKIV_T14C:'4'))+'¬, '
          +'¬dkiv_t14d¬ : ¬'+%trim(%editc(DKIV_T14D:'4'))+'¬, '
          +'¬dkiv_t15¬ : ¬'+%trim(%editc( DKIV_T15:'4'))+'¬, '
          +'¬dkiv_t16¬ : ¬'+%trim(%editc( DKIV_T16:'4'))+'¬, '
          +'¬dkiv_t17a¬ : ¬'+%trim(%editc(DKIV_T17A:'4'))+'¬, '
          +'¬dkiv_t17b¬ : ¬'+%trim(%editc(DKIV_T17B:'4'))+'¬, '
          +'¬dkiv_t17c¬ : ¬'+%trim(%editc(DKIV_T17C:'4'))+'¬, '
          +'¬dkiv_t18¬ : ¬'+%trim(%editc( DKIV_T18:'4'))+'¬, '
          +'¬dkiv_t19¬ : ¬'+%trim(%editc( DKIV_T19:'4'))+'¬, '
          +'¬dkiv_t20¬ : ¬'+%trim(%editc( DKIV_T20:'4'))+'¬, '
          +'¬dkiv_t21a¬ : ¬'+%trim(DKIV_T21A)+'¬, '
          +'¬dkiv_t21b¬ : ¬'+%trim(%editc( DKIV_T21B:'4'))+'¬, '
          +'¬dkiv_t22¬ : ¬'+%trim(%editc( DKIV_T22:'4'))+'¬, '
          +'¬dkiv_t23¬ : ¬'+%trim(%editc( DKIV_T23:'4'))+'¬, '
          +'¬dkiv_t24¬ : ¬'+%trim(%editc( DKIV_T24:'4'))+'¬, '
          +'¬dkiv_t25a¬ : ¬'+%trim(DKIV_T25A)+'¬, '
          +'¬dkiv_t25b¬ : ¬'+%trim(%editc(DKIV_T25B:'4'))+'¬, '
          +'¬dkiv_t25c¬ : ¬'+%trim(DKIV_T25C)+'¬, '
          +'¬dkiv_t25d¬ : ¬'+%trim(%editc(DKIV_T25D:'4'))+'¬, '
          +'¬dkiv_28a¬ : ¬'+%trim(DKIV_28A)+'¬, '
          +'¬dkiv_28b¬ : ¬'+%trim(DKIV_28B)+'¬, '
          +'¬dkiv_28c¬ : ¬'+%trim(%editc(DKIV_28C:'4'))+'¬, '
          +'¬dkiv_x01¬ : ¬'+%trim(DKIV_X01)+'¬, '
          +'¬dkiv_x02¬ : ¬'+%trim(DKIV_X02)+'¬, '
          +'¬dkiv_x03¬ : ¬'+%trim(DKIV_X03)+'¬, '
          +'¬dkiv_x04¬ : ¬'+%trim(%editc(DKIV_X04:'4'))+'¬, '
          +'¬dkiv_x05¬ : ¬'+%trim(%editc(DKIV_X05:'4'))+'¬, '
          +'¬dkiv_x06¬ : ¬'+%trim(DKIV_X06)+'¬, '
          +'¬dkiv_x07¬ : ¬'+%trim(%editc(DKIV_X07:'4'))+'¬, '

          +'¬dkiva_aba1¬ : ¬'+%trim(Å00A)+'¬, '
          +'¬dkiva_abk1¬ : ¬'+%trim(Å01A)+'¬, '
          +'¬dkiva_abg1¬ : ¬'+%trim(%editc(Å02A:'4'))+'¬, '
          +'¬dkiva_abs1¬ : ¬'+%trim(%editc(Å03A:'4'))+'¬, '
          +'¬dkiva_abx1¬ : ¬'+%trim(Å04A)+'¬, '
          +'¬dkiva_abb1¬ : ¬'+%trim(%editc(Å05A:'4'))+'¬, '

          +'¬dkiva_aba2¬ : ¬'+%trim(Å00B)+'¬, '
          +'¬dkiva_abk2¬ : ¬'+%trim(Å01B)+'¬, '
          +'¬dkiva_abg2¬ : ¬'+%trim(%editc(Å02B:'4'))+'¬, '
          +'¬dkiva_abs2¬ : ¬'+%trim(%editc(Å03B:'4'))+'¬, '
          +'¬dkiva_abx2¬ : ¬'+%trim(Å04B)+'¬, '
          +'¬dkiva_abb2¬ : ¬'+%trim(%editc(Å05B:'4'))+'¬, '

          +'¬dkiva_aba3¬ : ¬'+%trim(Å00C)+'¬, '
          +'¬dkiva_abk3¬ : ¬'+%trim(Å01C)+'¬, '
          +'¬dkiva_abg3¬ : ¬'+%trim(%editc(Å02C:'4'))+'¬, '
          +'¬dkiva_abs3¬ : ¬'+%trim(%editc(Å03C:'4'))+'¬, '
          +'¬dkiva_abx3¬ : ¬'+%trim(Å04C)+'¬, '
          +'¬dkiva_abb3¬ : ¬'+%trim(%editc(Å05C:'4'))+'¬, '

          +'¬dkiva_aba4¬ : ¬'+%trim(Å00D)+'¬, '
          +'¬dkiva_abk4¬ : ¬'+%trim(Å01D)+'¬, '
          +'¬dkiva_abg4¬ : ¬'+%trim(%editc(Å02D:'4'))+'¬, '
          +'¬dkiva_abs4¬ : ¬'+%trim(%editc(Å03D:'4'))+'¬, '
          +'¬dkiva_abx4¬ : ¬'+%trim(Å04D)+'¬, '
          +'¬dkiva_abb4¬ : ¬'+%trim(%editc(Å05D:'4'))+'¬, '

          +'¬dkiva_aba5¬ : ¬'+%trim(Å00E)+'¬, '
          +'¬dkiva_abk5¬ : ¬'+%trim(Å01E)+'¬, '
          +'¬dkiva_abg5¬ : ¬'+%trim(%editc(Å02E:'4'))+'¬, '
          +'¬dkiva_abs5¬ : ¬'+%trim(%editc(Å03E:'4'))+'¬, '
          +'¬dkiva_abx5¬ : ¬'+%trim(Å04E)+'¬, '
          +'¬dkiva_abb5¬ : ¬'+%trim(%editc(Å05E:'4'))+'¬, '

          +'¬dkiv_err¬ : ¬'+%trim(DKIV_ERR)+'¬}';
      /end-free
     C                   CALL      'JSONFIX'
     C                   PARM                    JSONstring
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')

     C                   ENDIF
     C                   ENDIF
      * ............................................................................................
      * Skriv JSON-string Avsluttning
      * ............................................................................................
     C                   EVAL      JSONstring =']}'
     C                   CALLP     updHTMLvar2('JSONstring'
     C                                         :%addr(JSONstring)
     C                                         :%len(JSONstring))
     C                   CALLP     wrtsection('JSONlin')
      * Quit
     C                   EXSR      EXIT
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     EXIT          BEGSR
      * Lukk fil
     C                   CLOSE     BRIDF
     C  N50              CLOSE     DKIV
     C  N50              CLOSE     DKIVA

      * Do not delete the CALL to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   CALLP     wrtsection('*fini')
      * Quit
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   ENDSR
      *********************************************************
     C     Parse         BEGSR
      *********************************************************
      * Get input
     C                   EVAL      WSUSER  = zhbgetvar('USER')
     C                   EVAL      AVD     = zhbgetvar('AVD')
     C                   EVAL      AVDN    = c2n2(AVD)
     C                   EVAL      OPD     = zhbgetvar('OPD')
     C                   EVAL      OPDN    = c2n2(OPD)
     C                   EVAL      LIN     = zhbgetvar('LIN')
     C                   EVAL      LINN    = c2n2(LIN)
     C                   ENDSR
      *********************************************************
     C     INIT          BEGSR
      *********************************************************
     C                   OPEN      BRIDF
      * Test innlogging
     C     WSUSER        CHAIN     BRIDF                              50
     C     BILIBL        IFEQ      *blanks
     C                   CALLb     'INCGI'
     C                   PARM                    BISTDL
     C                   else
     C                   CALL      BILIBL
     C                   end

     C     DKIVKey       klist
     C                   kfld                    AVDN
     C                   kfld                    OPDN
     C                   kfld                    LINN
     C                   MOVEA     *ZEROS        Å02
     C                   MOVEA     *ZEROS        Å03
     C                   MOVEA     *ZEROS        Å05
     C                   Z-ADD     1             X                 3 0
     C                   Z-ADD     0             WX                3 0

     C   50              EVAL      Error = 'Invalid userID'
     C  N50              OPEN      DKIV
     C  N50              OPEN      DKIVA

     C                   ENDSR
      *********************************************************
     C     AVG           BEGSR
      *********************************************************
      * Sjekker først om det finnes noen verdier å vise
     C     DKIVKEY       SETLL     DKIVA
     C     DKIVKEY       READE(N)  DKIVA                                  56
     C     *IN56         DOWEQ     *OFF
     C                   MOVE      DKIVA_ABA     Å00(X)
     C                   MOVE      DKIVA_ABK     Å01(X)
     C                   MOVE      DKIVA_ABG     Å02(X)
     C                   MOVE      DKIVA_ABS     Å03(X)
     C                   MOVE      DKIVA_ABX     Å04(X)
     C                   MOVE      DKIVA_ABB     Å05(X)
     C                   ADD       1             X
     C     X             IFGT      5
     C                   LEAVE
     C                   ENDIF
     C     DKIVKEY       READE(N)  DKIVA                                  56
     C                   ENDDO
     C                   ENDSR
