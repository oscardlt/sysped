      *
      ***********************************************************
      *** PROGRAM SKAL SENDE XML-FAKTURA                      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-49 51-99                ***
      ***********************************************************
     FFIRM      IF   E           K DISK
     FXMLUFL1   UF   E           K DISK
     FECMSG     IF   E           K DISK    USROPN
     FKODWL01   IF   E           K DISK    USROPN
     FKODTA     IF   E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FFAIN      IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FFAK8      IF   E           K DISK    USROPN
     FEDIC      UF A E             DISK    USROPN
     FEDIS      O  A E             DISK    USROPN
     FEDIM      O  A E             DISK    USROPN
     FEDISE     O  A E             DISK    USROPN
     D TXT             S             80    DIM(158) CTDATA PERRCD(1)
     D TXT01           S             80    DIM(3) CTDATA PERRCD(1)
     D                 DS
     D  ØN152                  1     15  2
     D  ØA152H                 1     13
     D  ØA152X                 5     13
     D  ØA152D                14     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  XMBR                   1     10
     D  XMBRA                  1      1
     D  XMBRB                  2      8S 0
     D                 DS
     D  SDATA                  1     80
     D  SD80                   1     80    DIM(80)
     D                 DS
     D  XXA80                  1     80
     D  A80                    1     80    DIM(80)
     D                 DS
     D  WDT                    1      8
     D  WDTÅ                   1      4
     D  WDTM                   5      6
     D  WDTD                   7      8
     D                 DS
     D  WTM                    1      6
     D  WTMH                   1      2
     D  WTMM                   3      4
     D  WTMS                   5      6
     D                 DS
     D  HEAVD                  1      4  0
     D  HEOPD                  5      9  0
     D  HESG                  10     12
     D  SYSPEDREF              1     12
     D                 DS
     D  FADATO                 1      8  0
     D  FADATOÅ                1      4
     D  FADATOM                5      6
     D  FADATOD                7      8
     D                 DS
     D  FADAFF                 1      8  0
     D  FADAFFÅ                1      4
     D  FADAFFM                5      6
     D  FADAFFD                7      8
     D                 DS
     D  SYKT8                  1      8
     D  SYFR02                 1      1
     D  SYKT7                  2      7
     D  SYKONT                 2      8  0
     D                 DS
     D  XMLT1                  1     44  2 DIM(11)
     D  XFMS01                 1      4  2
     D  XFMS02                 5      8  2
     D  XFMS03                 9     12  2
     D  XFMS04                13     16  2
     D  XFMS05                17     20  2
     D  XFMS06                21     24  2
     D  XFMS07                25     28  2
     D  XFMS08                29     32  2
     D  XFMS09                33     36  2
     D  XFMS10                37     40  2
     D  XFMS11                41     44  2
     D                 DS
     D  XMLT2                  1     33    DIM(11)
     D  XFMV01                 1      3
     D  XFMV02                 4      6
     D  XFMV03                 7      9
     D  XFMV04                10     12
     D  XFMV05                13     15
     D  XFMV06                16     18
     D  XFMV07                19     21
     D  XFMV08                22     24
     D  XFMV09                25     27
     D  XFMV10                28     30
     D  XFMV11                31     33
     D                 DS
     D  XMLT3                  1    143  2 DIM(11)
     D  XFMGN1                 1     13  2
     D  XFMGN2                14     26  2
     D  XFMGN3                27     39  2
     D  XFMGN4                40     52  2
     D  XFMGN5                53     65  2
     D  XFMGN6                66     78  2
     D  XFMGN7                79     91  2
     D  XFMGN8                92    104  2
     D  XFMGN9               105    117  2
     D  XFMGNA               118    130  2
     D  XFMGNB               131    143  2
     D                 DS
     D  XMLT4                  1    143  2 DIM(11)
     D  XFMGV1                 1     13  2
     D  XFMGV2                14     26  2
     D  XFMGV3                27     39  2
     D  XFMGV4                40     52  2
     D  XFMGV5                53     65  2
     D  XFMGV6                66     78  2
     D  XFMGV7                79     91  2
     D  XFMGV8                92    104  2
     D  XFMGV9               105    117  2
     D  XFMGVA               118    130  2
     D  XFMGVB               131    143  2
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C     XMLUFL01K     SETLL     XMLUFL1
     C     XMLUFL01K     READE     XMLUFL1                                50
     C   50              GOTO      SLUTT
      *
     C                   EXSR      SRINIT
      *
     C                   EXSR      SRSTART
     C                   DOW       *IN33 = *OFF
     C                   EXSR      SREMSG
     C     XMLUFL01K     READE     XMLUFL1                                50
     C  N50              IF        XFKN <> XXKN
     C                   LEAVE
     C                   END
     C  N50              ENDDO
     C                   EXSR      SRSLUTT
     C  N50              EXSR      SRCLOSE
     C  N50              GOTO      START
      *
     C     SLUTT         TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SRINIT        BEGSR
      ***********************************************
     C                   OPEN      ECMSG
     C                   OPEN      KODWL01
     C                   OPEN      KODTA
     C                   OPEN      CUNDL01
     C                   OPEN      FAIN
     C                   OPEN      HEADF
     C                   OPEN      FAK8
     C                   OPEN      EDIC
     C                   OPEN      EDIS
     C                   OPEN      EDIM
     C                   OPEN      EDISE
      *
     C     ECMSGK        CHAIN     ECMSG                              33
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
      *
     C                   MOVE      XFKN          XXKN              8 0
     C                   MOVE      *BLANKS       XXA80            80
     C                   MOVE      *ZEROS        XXAN01            1 0
     C                   MOVE      *ZEROS        XNPOS             3 0
     C                   MOVE      *BLANKS       XMBR
     C                   MOVE      'F'           XMBRA
     C                   MOVE      CSN           XMBRB
     C                   MOVE      XMBR          SEMBR
     C                   MOVE      *BLANKS       SDATA
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT
     C                   PARM                    WTM
      *
     C                   EVAL      S0004 = ECIIDI
     C                   EVAL      S0010 = ECIIDC
     C                   EVAL      S0020 = SEMBR
     C                   EVAL      S0036 = 0
     C                   EVAL      SSN   = CSN
     C                   EVAL      SSR   = 'S'
     C                   EVAL      SST   = 'X'
     C                   MOVE      WDT           SDT
     C                   MOVE      WTM           STM
     C                   EVAL      SLIB  = '*LIBL'
     C                   EVAL      SFILE = 'EDISE'
     C                   EVAL      SMBR  = SEMBR
     C                   EVAL      SMBRS  = 0
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSTART       BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
     C                   EVAL      XXA80 = TXT(1)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(2)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT01(1)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT01(2)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT01(3)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(4)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(5)
     C                   EXSR      SRCAT
      * Orginator
     C                   EVAL      XXA80 = TXT(6)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(8)
     C                   CAT       S0004:0       XXA80
     C                   CAT       TXT(9):0      XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(10)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(11)
     C                   CAT       'OrgNr-Avd':0 XXA80
     C                   CAT       TXT(12):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(7)
     C                   EXSR      SRCAT
      * Recipient
     C                   EVAL      XXA80 = TXT(13)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(8)
     C                   CAT       S0010:0       XXA80
     C                   CAT       TXT(9):0      XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(10)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(11)
     C                   CAT       'OrgNr-Avd':0 XXA80
     C                   CAT       TXT(12):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(14)
     C                   EXSR      SRCAT
      * InterchangeID
     C                   EVAL      XXA80 = TXT(15)
     C                   CAT       SEMBR:0       XXA80
     C                   CAT       TXT(16):0     XXA80
     C                   EXSR      SRCAT
      * InterchangeTime
     C                   EVAL      XXA80 = TXT(17)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(19)
     C                   CAT       'year="':1    XXA80
     C                   CAT       WDTÅ:0        XXA80
     C                   CAT       '" month="':0 XXA80
     C                   CAT       WDTM:0        XXA80
     C                   CAT       '" day="':0   XXA80
     C                   CAT       WDTD:0        XXA80
     C                   CAT       '">':0        XXA80
     C                   CAT       WDTÅ:0        XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       WDTM:0        XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       WDTD:0        XXA80
     C                   CAT       TXT(20):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(21)
     C                   CAT       'hour="':1    XXA80
     C                   CAT       WTMH:0        XXA80
     C                   CAT       '" minute="':0XXA80
     C                   CAT       WTMM:0        XXA80
     C                   CAT       '" second="':0XXA80
     C                   CAT       WTMS:0        XXA80
     C                   CAT       '" fraction':0XXA80
     C                   CAT       '="050">':0   XXA80
     C                   CAT       WTMH:0        XXA80
     C                   CAT       ':':0         XXA80
     C                   CAT       WTMM:0        XXA80
     C                   CAT       ':':0         XXA80
     C                   CAT       WTMS:0        XXA80
     C                   CAT       TXT(22):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(18)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREMSG        BEGSR
      ***********************************************
     C                   MOVE      XFFN          FIFN
     C     FIFN          SETLL     FAIN
     C     FIFN          READE     FAIN                                   33
     C                   EVAL      XXAN01 = 0
      * eMessage start
     C                   EVAL      XXA80 = TXT(23)
     C                   EXSR      SRCAT
      * MessageType
     C                   EVAL      XXA80 = TXT(25)
     C                   CAT       'Invoice':0   XXA80
     C                   CAT       TXT(26):0     XXA80
     C                   EXSR      SRCAT
      * MessageVersion
     C                   EVAL      XXA80 = TXT(27)
     C                   CAT       'PS-14':0     XXA80
     C                   CAT       TXT(28):0     XXA80
     C                   EXSR      SRCAT
      * DokumentType
     C                   EVAL      XXA80 = TXT(29)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(31)
     C                   IF        XFFK = 'F'
     C                   CAT       '380':0       XXA80
     C                   ELSE
     C                   CAT       '381':0       XXA80
     C                   END
     C                   CAT       TXT(32):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(33)
     C                   IF        XFFK = 'F'
     C                   CAT       'FAKTURA':0   XXA80
     C                   ELSE
     C                   CAT       'KREDITNOTA':0XXA80
     C                   END
     C                   CAT       TXT(34):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(30)
     C                   EXSR      SRCAT
      * MessageReferance
     C                   EXSR      OPDEDIM
      *
     C                   EVAL      XXA80 = TXT(35)
     C                   MOVE      MMN           XXA07             7
     C                   CAT       XXA07:0       XXA80
     C                   CAT       TXT(36):0     XXA80
     C                   EXSR      SRCAT
      * MessageOriginator
     C                   EVAL      XXA80 = TXT(37)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(8)
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       SYRG:0        XXA80
     C                   CAT       TXT(9):0      XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(10)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(11)
     C                   CAT       'OrgNr-Avd':0 XXA80
     C                   CAT       TXT(12):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(38)
     C                   EXSR      SRCAT
      * MessageRecipient
     C                   EVAL      XXA80 = TXT(39)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(8)
     C                   MOVE      FAKUNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   CAT       SYRG:0        XXA80
     C                   CAT       TXT(9):0      XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(10)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(11)
     C                   CAT       'OrgNr-Avd':0 XXA80
     C                   CAT       TXT(12):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(40)
     C                   EXSR      SRCAT
      * MessageContant start
     C                   EVAL      XXA80 = TXT(41)
     C                   EXSR      SRCAT
      *
     C                   EXSR      SREINV
      * MessageContant slutt
     C                   EVAL      XXA80 = TXT(42)
     C                   EXSR      SRCAT
      * eMessage slutt
     C                   EVAL      XXA80 = TXT(24)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SREINV        BEGSR
      ***********************************************
     C     HEADFK        CHAIN     HEADF                              33
     C     HEADFK        SETLL     FAK8
     C     HEADFK        READE     FAK8                                   33
     C                   IF        FAVAL = *BLANKS
     C                   EVAL      FAVAL = FICURR
     C                   END
      *
     C                   EVAL      XXAN01 = 0
      * Invoice start
     C                   EVAL      XXA80 = TXT(43)
     C                   EXSR      SRCAT
      * InvoiceDates
     C                   EVAL      XXA80 = TXT(45)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(47)
     C                   CAT       'year="':1    XXA80
     C                   CAT       FADATOÅ:0     XXA80
     C                   CAT       '" month="':0 XXA80
     C                   CAT       FADATOM:0     XXA80
     C                   CAT       '" day="':0   XXA80
     C                   CAT       FADATOD:0     XXA80
     C                   CAT       '">':0        XXA80
     C                   CAT       FADATOÅ:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADATOM:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADATOD:0     XXA80
     C                   CAT       TXT(48):0     XXA80
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(49)
     C                   CAT       'year="':1    XXA80
     C                   CAT       FADAFFÅ:0     XXA80
     C                   CAT       '" month="':0 XXA80
     C                   CAT       FADAFFM:0     XXA80
     C                   CAT       '" day="':0   XXA80
     C                   CAT       FADAFFD:0     XXA80
     C                   CAT       '">':0        XXA80
     C                   CAT       FADAFFÅ:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADAFFM:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADAFFD:0     XXA80
     C                   CAT       TXT(50):0     XXA80
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(46)
     C                   EXSR      SRCAT
      * InvoiceReferance
     C                   EVAL      XXA80 = TXT(51)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(53)
     C                   MOVE      XFFN          XXA07             7
     C                   CAT       XXA07:0       XXA80
     C                   CAT       TXT(54):0     XXA80
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(52)
     C                   EXSR      SRCAT
      * PaymentInfo start
     C                   EVAL      XXA80 = TXT(55)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(57)
     C                   CAT       XFBB:0        XXA80
     C                   CAT       TXT(58):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(59)
     C                   CAT       XFBBT:0       XXA80
     C                   CAT       TXT(60):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(61)
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(63)
     C                   CAT       XFKT:0        XXA80
     C                   CAT       TXT(64):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(62)
     C                   EXSR      SRCAT
      * PaymentDueDate
     C                   EVAL      XXA80 = TXT(65)
     C                   CAT       'year="':1    XXA80
     C                   CAT       FADAFFÅ:0     XXA80
     C                   CAT       '" month="':0 XXA80
     C                   CAT       FADAFFM:0     XXA80
     C                   CAT       '" day="':0   XXA80
     C                   CAT       FADAFFD:0     XXA80
     C                   CAT       '">':0        XXA80
     C                   CAT       FADAFFÅ:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADAFFM:0     XXA80
     C                   CAT       '-':0         XXA80
     C                   CAT       FADAFFD:0     XXA80
     C                   CAT       TXT(66):0     XXA80
     C                   EXSR      SRCAT
      * PaymentAmount
     C                   EVAL      XXA80 = TXT(67)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       XFVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   Z-ADD     XFTOT         ØN152
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(68):0     XXA80
     C                   EXSR      SRCAT
      * Kid
     C                   EVAL      XXA80 = TXT(69)
     C                   CAT       XFKID:0       XXA80
     C                   CAT       TXT(70):0     XXA80
     C                   EXSR      SRCAT
      * CheckDigit
     C*                  Z-ADD     21            XN
     C*                  EVAL      XXA80 = XFKID
     C*                  DOW       XN > 1
     C*                  IF        A80(XN) <> ' '
     C*                  MOVE      A80(XN)       XXA01             1
     C*                  LEAVE
     C*                  END
     C*                  EVAL      XN = XN - 1
     C*                  ENDDO
     C*                  EVAL      XXA80 = TXT(71)
     C*                  CAT       XXA01:0       XXA80
     C*                  CAT       TXT(72):0     XXA80
     C*                  EXSR      SRCAT
      * PaymentInfo slutt
     C                   EVAL      XXA80 = TXT(56)
     C                   EXSR      SRCAT
      *
      * Parties
     C                   EXSR      SRPART
      * Summery
     C                   EXSR      SRSUM
      * Details
     C                   EXSR      SRDET
      * Invoice slutt
     C                   EVAL      XXA80 = TXT(44)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRPART        BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
      * Parties start
     C                   EVAL      XXA80 = TXT(73)
     C                   EXSR      SRCAT
      * Invoicer start
     C                   EVAL      XXA80 = TXT(75)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(77)
     C                   EXSR      SRCAT
      *
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      KOAKNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      XXA80 = TXT(79)
     C                   CAT       SYRG:0        XXA80
     C                   CAT       TXT(80):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(81)
     C                   IF        SYFR02 = ' '
     C                   CAT       SYKT7:0       XXA80
     C                   ELSE
     C                   CAT       SYKT8:0       XXA80
     C                   END
     C                   CAT       TXT(82):0     XXA80
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(78)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(83)
     C                   CAT       KNAVN:0       XXA80
     C                   CAT       TXT(84):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(85)
     C                   EXSR      SRCAT
     C                   IF        ADR1 <> *BLANKS
     C                   EVAL      XXA80 = TXT(87)
     C                   CAT       ADR1:0        XXA80
     C                   CAT       TXT(88):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      XXA80 = TXT(89)
     C                   CAT       ADR2:0        XXA80
     C                   CAT       TXT(90):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        ADR3 <> *BLANKS
     C                   EVAL      XXA80 = TXT(91)
     C                   CAT       ADR3:0        XXA80
     C                   CAT       TXT(92):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        POSTNR <> 0
     C                   EVAL      XXA80 = TXT(93)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   ELSE
     C                   IF        SYPOGE <> *BLANKS
     C                   EVAL      XXA80 = TXT(93)
     C                   CAT       SYPOGE:0      XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   END
     C                   EVAL      XXA80 = TXT(95)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       FILAND:0      XXA80
     C                   ELSE
     C                   CAT       SYLAND:0      XXA80
     C                   END
     C                   CAT       TXT(96):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(86)
     C                   EXSR      SRCAT
      * Invoicer slutt
     C                   EVAL      XXA80 = TXT(76)
     C                   EXSR      SRCAT
      * Invoicee start
     C                   EVAL      XXA80 = TXT(97)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(77)
     C                   EXSR      SRCAT
      *
     C                   MOVE      FAKUNR        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C                   EVAL      XXA80 = TXT(79)
     C                   CAT       SYRG:0        XXA80
     C                   CAT       TXT(80):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(81)
     C                   IF        SYFR02 = ' '
     C                   CAT       SYKT7:0       XXA80
     C                   ELSE
     C                   CAT       SYKT8:0       XXA80
     C                   END
     C                   CAT       TXT(82):0     XXA80
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(78)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(83)
     C                   CAT       KNAVN:0       XXA80
     C                   CAT       TXT(84):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(85)
     C                   EXSR      SRCAT
     C                   IF        ADR1 <> *BLANKS
     C                   EVAL      XXA80 = TXT(87)
     C                   CAT       ADR1:0        XXA80
     C                   CAT       TXT(88):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        ADR2 <> *BLANKS
     C                   EVAL      XXA80 = TXT(89)
     C                   CAT       ADR2:0        XXA80
     C                   CAT       TXT(90):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        ADR3 <> *BLANKS
     C                   EVAL      XXA80 = TXT(91)
     C                   CAT       ADR3:0        XXA80
     C                   CAT       TXT(92):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        POSTNR <> 0
     C                   EVAL      XXA80 = TXT(93)
     C                   MOVE      POSTNR        XXA04             4
     C                   CAT       XXA04:0       XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   ELSE
     C                   IF        SYPOGE <> *BLANKS
     C                   EVAL      XXA80 = TXT(93)
     C                   CAT       SYPOGE:0      XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   END
     C                   EVAL      XXA80 = TXT(95)
     C                   IF        SYLAND = *BLANKS
     C                   CAT       FILAND:0      XXA80
     C                   ELSE
     C                   CAT       SYLAND:0      XXA80
     C                   END
     C                   CAT       TXT(96):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(86)
     C                   EXSR      SRCAT
      * Invoicee slutt
     C                   EVAL      XXA80 = TXT(98)
     C                   EXSR      SRCAT
      * Supplier start
     C                   EVAL      XXA80 = TXT(99)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(83)
     C                   CAT       HENAS:0       XXA80
     C                   CAT       TXT(84):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(85)
     C                   EXSR      SRCAT
     C                   IF        HEADS1 <> *BLANKS
     C                   EVAL      XXA80 = TXT(87)
     C                   CAT       HEADS1:0      XXA80
     C                   CAT       TXT(88):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        HEADS2 <> *BLANKS
     C                   EVAL      XXA80 = TXT(89)
     C                   CAT       HEADS2:0      XXA80
     C                   CAT       TXT(90):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        HEADS3 <> *BLANKS
     C                   EVAL      XXA80 = TXT(91)
     C                   CAT       HEADS3:0      XXA80
     C                   CAT       TXT(92):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(93)
     C                   MOVEL     HEADS3        XXA04             4
     C                   CAT       XXA04:0       XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   EVAL      XXA80 = TXT(86)
     C                   EXSR      SRCAT
      * Supplier slutt
     C                   EVAL      XXA80 = TXT(100)
     C                   EXSR      SRCAT
      * Buyer start
     C                   EVAL      XXA80 = TXT(101)
     C                   EXSR      SRCAT
      *
     C                   EVAL      XXA80 = TXT(83)
     C                   CAT       HENAK:0       XXA80
     C                   CAT       TXT(84):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(85)
     C                   EXSR      SRCAT
     C                   IF        HEADK1 <> *BLANKS
     C                   EVAL      XXA80 = TXT(87)
     C                   CAT       HEADK1:0      XXA80
     C                   CAT       TXT(88):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        HEADK2 <> *BLANKS
     C                   EVAL      XXA80 = TXT(89)
     C                   CAT       HEADK2:0      XXA80
     C                   CAT       TXT(90):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   IF        HEADK3 <> *BLANKS
     C                   EVAL      XXA80 = TXT(91)
     C                   CAT       HEADK3:0      XXA80
     C                   CAT       TXT(92):0     XXA80
     C                   EXSR      SRCAT
     C                   EVAL      XXA80 = TXT(93)
     C                   MOVEL     HEADK3        XXA04             4
     C                   CAT       XXA04:0       XXA80
     C                   CAT       TXT(94):0     XXA80
     C                   EXSR      SRCAT
     C                   END
     C                   EVAL      XXA80 = TXT(86)
     C                   EXSR      SRCAT
      * Buyer slutt
     C                   EVAL      XXA80 = TXT(102)
     C                   EXSR      SRCAT
      * Parties slutt
     C                   EVAL      XXA80 = TXT(74)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUM         BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
      * Summary start
     C                   EVAL      XXA80 = TXT(103)
     C                   EXSR      SRCAT
      *
     C                   MOVE      *ZEROS        XXMVAT           13 2
     C     1             DO        11            XN01              3 0
     C                   IF        XMLT1(XN01) > 0
     C                   IF        XMLT2(XN01) = *BLANKS
     C                   EVAL      XMLT2(XN01) = FICURR
     C                   END
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT3(XN01)/100
     C                   ELSE
     C                   EVAL(H)   XXMVAT = XXMVAT+XMLT1(XN01)*XMLT4(XN01)/100
     C                   END
     C                   END
     C                   ENDDO
      * Taxes start
     C                   EVAL      XXA80 = TXT(105)
     C                   EXSR      SRCAT
      *
     C                   MOVE      *ZEROS        XXMVA            13 2
     C     1             DO        11            XN01
     C                   IF        XMLT1(XN01) > 0
      * Tax start
     C                   EVAL      XXA80 = TXT(107)
     C                   EXSR      SRCAT
      * TaxType
     C                   EVAL      XXA80 = TXT(109)
     C                   CAT       'MVA':0       XXA80
     C                   CAT       TXT(110):0    XXA80
     C                   EXSR      SRCAT
      * TaxBase
     C                   EVAL      XXA80 = TXT(111)
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01)
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01)
     C                   END
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(112):0    XXA80
     C                   EXSR      SRCAT
      * TaxPercent
     C                   EVAL      XXA80 = TXT(113)
     C                   EVAL      ØN152 = XMLT1(XN01)
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(114):0    XXA80
     C                   EXSR      SRCAT
      * TaxAmount
     C                   EVAL      XXA80 = TXT(115)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       XMLT2(XN01):0 XXA80
     C                   CAT       '">':0        XXA80
     C                   IF        XMLT2(XN01) = FICURR
     C                   EVAL      ØN152 = XMLT3(XN01)
     C                   ELSE
     C                   EVAL      ØN152 = XMLT4(XN01)
     C                   END
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(116):0    XXA80
     C                   EXSR      SRCAT
      * Tax slutt
     C                   EVAL      XXA80 = TXT(108)
     C                   EXSR      SRCAT
      *
     C                   END
     C                   ENDDO
      * TotalTax
     C                   EVAL      XXA80 = TXT(117)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       XFVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XXMVAT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(118):0    XXA80
     C                   EXSR      SRCAT
      * TotalExclTaxes
     C                   EVAL      XXA80 = TXT(119)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       XFVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XFTOT - XXMVAT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(120):0    XXA80
     C                   EXSR      SRCAT
      * TotalInclTax
     C                   EVAL      XXA80 = TXT(121)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       XFVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XFTOT
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(122):0    XXA80
     C                   EXSR      SRCAT
      * Taxes slutt
     C                   EVAL      XXA80 = TXT(106)
     C                   EXSR      SRCAT
      * Summary slutt
     C                   EVAL      XXA80 = TXT(104)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRDET         BEGSR
      ***********************************************
     C                   EVAL      XXAN01 = 0
     C                   MOVE      *ZEROS        XXBEL            13 2
      * Details start
     C                   EVAL      XXA80 = TXT(123)
     C                   EXSR      SRCAT
      * DetailNumber
     C                   EVAL      XXA80 = TXT(125)
     C                   CAT       '1':0         XXA80
     C                   CAT       TXT(126):0    XXA80
     C                   EXSR      SRCAT
      *
     C                   MOVE      *ZEROS        XXLINNR           5 0
     C     STLIN         TAG
      * LineDetails start
     C                   EVAL      XXA80 = TXT(127)
     C                   EXSR      SRCAT
      * LineNumber
     C                   EVAL      XXA80 = TXT(129)
     C                   ADD       1             XXLINNR
     C                   EVAL      ØN152 = XXLINNR
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(130):0    XXA80
     C                   EXSR      SRCAT
      * Quantities start
     C                   EVAL      XXA80 = TXT(131)
     C                   EXSR      SRCAT
      * QuantitiyOrdered
     C                   EVAL      XXA80 = TXT(133)
     C                   CAT       'qtyType="':1 XXA80
     C                   CAT       'PCE">1':0    XXA80
     C                   CAT       TXT(134):0    XXA80
     C                   EXSR      SRCAT
      * QuantitiyDeliveried
     C                   EVAL      XXA80 = TXT(135)
     C                   CAT       'qtyType="':1 XXA80
     C                   CAT       'PCE">1':0    XXA80
     C                   CAT       TXT(136):0    XXA80
     C                   EXSR      SRCAT
      * Quantities slutt
     C                   EVAL      XXA80 = TXT(132)
     C                   EXSR      SRCAT
      * LineDates
     C*                  EVAL      XXA80 = TXT(137)
     C*                  CAT       TXT(138):0    XXA80
     C                   EVAL      XXA80 = '<LineDates />'
     C                   EXSR      SRCAT
      * LineReference start
     C                   EVAL      XXA80 = TXT(139)
     C                   EXSR      SRCAT
      * OtherReference start
     C                   EVAL      XXA80 = TXT(141)
     C                   EXSR      SRCAT
      * Reference
     C                   EVAL      XXA80 = TXT(143)
     C                   CAT       'type="Vår':1 XXA80
     C                   CAT       'referanse"':1XXA80
     C                   CAT       '>':0         XXA80
     C                   CAT       SYSPEDREF:0   XXA80
     C                   CAT       TXT(144):0    XXA80
     C                   EXSR      SRCAT
      * OtherReference slutt
     C                   EVAL      XXA80 = TXT(142)
     C                   EXSR      SRCAT
      * LineReference slutt
     C                   EVAL      XXA80 = TXT(140)
     C                   EXSR      SRCAT
      * PriceDetails start
     C                   EVAL      XXA80 = TXT(145)
     C                   EXSR      SRCAT
      * Price
     C*                  EVAL      XXA80 = TXT(147)
     C*                  CAT       'type="NET"':1XXA80
     C*                  CAT       '>':0         XXA80
     C*                  IF        FAVAL = FICURR
     C*                  EVAL      XXBEL = FABELN
     C*                  ELSE
     C*                  EVAL      XXBEL = FABELV
     C*                  END
     C*                  EVAL      ØN152 = XXBEL
     C*                  EXSR      SRNE
     C*                  CAT       ØAN:0         XXA80
     C*                  CAT       TXT(148):0    XXA80
     C*                  EXSR      SRCAT
      *
     C                   IF        FAKDM <> 'N'
      * LineTotTaxBase
     C                   EVAL      XXA80 = TXT(149)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       FAVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XXBEL
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(150):0    XXA80
     C                   EXSR      SRCAT
      * TaxPercent
     C                   EVAL      XXA80 = TXT(151)
     C                   IF        FAKDM = 'J'
     C                   EVAL      MVAAVI = FITAX * 100
     C                   ELSE
     C     KODWL01K      CHAIN     KODWL01                            33
     C   33              EVAL      MVAAVI = 0
     C                   END
     C                   EVAL      ØN152 = MVAAVI
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(152):0    XXA80
     C                   EXSR      SRCAT
      * LineTotTax
     C                   EVAL      XXA80 = TXT(153)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       FAVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      XXMVA = XXBEL * MVAAVI / 100
     C                   EVAL      ØN152 = XXMVA
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(154):0    XXA80
     C                   EXSR      SRCAT
      * LineTotExclTax
     C                   EVAL      XXA80 = TXT(155)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       FAVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XXBEL
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(156):0    XXA80
     C                   EXSR      SRCAT
      *
     C                   ELSE
     C                   EVAL      XXMVA = 0
     C                   END
      * LineTotInclTax
     C                   EVAL      XXA80 = TXT(157)
     C                   CAT       'currencyId':1XXA80
     C                   CAT       '="':0        XXA80
     C                   CAT       FAVAL:0       XXA80
     C                   CAT       '">':0        XXA80
     C                   EVAL      ØN152 = XXBEL + XXMVA
     C                   EXSR      SRNE
     C                   CAT       ØAN:0         XXA80
     C                   CAT       TXT(158):0    XXA80
     C                   EXSR      SRCAT
      * PriceDetails slutt
     C                   EVAL      XXA80 = TXT(146)
     C                   EXSR      SRCAT
      * LineDetails slutt
     C                   EVAL      XXA80 = TXT(128)
     C                   EXSR      SRCAT
     C     HEADFK        READE     FAK8                                   33
     C  N33              GOTO      STLIN
      * Details slutt
     C                   EVAL      XXA80 = TXT(124)
     C                   EXSR      SRCAT
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSLUTT       BEGSR
      ***********************************************
      * PostenInterChange
     C                   EVAL      XXA80 = TXT(03)
     C                   EXSR      SRCAT
      *
     C                   WRITE     EDISER
      *
      * Oppdater EDIS
     C                   WRITE     EDISR
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRCLOSE       BEGSR
      ***********************************************
     C                   CLOSE     ECMSG
     C                   CLOSE     KODWL01
     C                   CLOSE     KODTA
     C                   CLOSE     CUNDL01
     C                   CLOSE     FAIN
     C                   CLOSE     HEADF
     C                   CLOSE     FAK8
     C                   CLOSE     EDIC
     C                   CLOSE     EDIS
     C                   CLOSE     EDIM
     C                   CLOSE     EDISE
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDEDIM       BEGSR
      ***********************************************
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
      *
     C                   EVAL      M0004 = S0004
     C                   EVAL      M0010 = S0010
     C                   MOVEL     CMN           M0062
     C                   EVAL      M0065 = 'INVXML'
     C                   MOVEL     XFFN          M0068
     C                   IF        XFFK = 'F'
     C                   MOVEL     '380'         M1001
     C                   ELSE
     C                   MOVEL     '381'         M1001
     C                   END
     C                   MOVEL     XFFN          M1004
     C                   EVAL      MSN = SSN
     C                   EVAL      MMN = CMN
     C                   EVAL      MSR = 'S'
     C                   EVAL      MST = 'C'
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   WRITE     EDIMR
      *
     C                   EVAL      S0036 = S0036 + 1
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for output string, read input from left            SRCAT
      *////////////////////////////////////////////////////////////
     C     SRCAT         BEGSR
      *
     C                   Z-ADD     80            XN                3 0
     C                   DOW       XN > 1
     C                   IF        A80(XN) <> ' '
     C                   LEAVE
     C                   END
     C                   EVAL      XN = XN - 1
     C                   ENDDO
      *
     C                   IF        XXAN01 = 1
     C                   IF        XNPOS = 80
     C                   WRITE     EDISER
     C                   MOVE      *BLANKS       SDATA
     C                   Z-ADD     1             XNPOS
     C                   ELSE
     C                   ADD       1             XNPOS
     C                   ENDIF
     C                   ENDIF
      *
     C     1             DO        XN            XN2               3 0
     C                   IF        XNPOS = 80
     C                   WRITE     EDISER
     C                   MOVE      *BLANKS       SDATA
     C                   Z-ADD     1             XNPOS
     C                   ELSE
     C                   ADD       1             XNPOS
     C                   ENDIF
     C                   MOVE      A80(XN2)      SD80(XNPOS)
     C                   ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA12
     C     ØA152D        IFEQ      '00'                                         <-------------I
     C                   MOVE      ØA152H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA152X        ØA12                                         I
     C                   MOVE      '.  '         ØA12                                         I
     C                   MOVE      ØA152D        ØA12                                         I
     C     Ø12(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(12)
     C     Ø12(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø12(11)
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     XMLUFL01K     KLIST
     C                   KFLD                    XFST
     C                   KFLD                    FIFIRM
     C     ECMSGK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    XFKN
     C                   KFLD                    ECSR
     C                   KFLD                    EC0065
     C     HEADFK        KLIST
     C                   KFLD                    FIAVD
     C                   KFLD                    FIOPD
     C     KODWL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    MOMSTW
     C                   KFLD                    FAKDM
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    FIAVD
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   Z-ADD     0             ØX                2 0
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVE      'A'           KOAUNI
     C                   MOVEL     'S'           ECSR
     C                   MOVEL     'INVXML'      EC0065
      *
     C                   ENDSR
      *
** TXT
<?xml version="1.0" encoding="ISO-8859-1" ?>                                    001
<PostenInterchange                                                              002
</PostenInterchange>                                                            003
<InterchangeType>PostenInterchange</InterchangeType>                            004
<Version>1.4-rev3</Version>                                                     005
<Originator>                                                                    006
</Originator>                                                                   007
<Address>                                                                       008
</Address>                                                                      009
<SubAddress/>                                                                   010
<AddressQualifier>                                                              011
</AddressQualifier>                                                             012
<Recipient>                                                                     013
</Recipient>                                                                    014
<InterchangeId>                                                                 015
</InterchangeId>                                                                016
<InterchangeTime>                                                               017
</InterchangeTime>                                                              018
<Date                                                                           019
</Date>                                                                         020
<Time                                                                           021
</Time>                                                                         022
<eMessage>                                                                      023
</eMessage>                                                                     024
<MessageType>                                                                   025
</MessageType>                                                                  026
<MessageVersion>                                                                027
</MessageVersion>                                                               028
<DocumentType>                                                                  029
</DocumentType>                                                                 030
<DocumentCode>                                                                  031
</DocumentCode>                                                                 032
<DocumentDescriptiveName>                                                       033
</DocumentDescriptiveName>                                                      034
<MessageReference>                                                              035
</MessageReference>                                                             036
<MessageOriginator>                                                             037
</MessageOriginator>                                                            038
<MessageRecipient>                                                              039
</MessageRecipient>                                                             040
<MessageContent>                                                                041
</MessageContent>                                                               042
<Invoice>                                                                       043
</Invoice>                                                                      044
<InvoiceDates>                                                                  045
</InvoiceDates>                                                                 046
<InvoiceDate                                                                    047
</InvoiceDate>                                                                  048
<DueDate                                                                        049
</DueDate>                                                                      050
<InvoiceReferences>                                                             051
</InvoiceReferences>                                                            052
<InvoiceNo>                                                                     053
</InvoiceNo>                                                                    054
<PaymentInfo>                                                                   055
</PaymentInfo>                                                                  056
<PaymentTermsCode>                                                              057
</PaymentTermsCode>                                                             058
<PaymentTermsText>                                                              059
</PaymentTermsText>                                                             060
<PaymentAccountInfo>                                                            061
</PaymentAccountInfo>                                                           062
<AccountNumber>                                                                 063
</AccountNumber>                                                                064
<PaymentDueDate                                                                 065
</PaymentDueDate>                                                               066
<PaymentAmount                                                                  067
</PaymentAmount>                                                                068
<KID>                                                                           069
</KID>                                                                          070
<CheckDigit>                                                                    071
</CheckDigit>                                                                   072
<Parties>                                                                       073
</Parties>                                                                      074
<Invoicer>                                                                      075
</Invoicer>                                                                     076
<Identifications>                                                               077
</Identifications>                                                              078
<CompanyRegNo>                                                                  079
</CompanyRegNo>                                                                 080
<CompanyVATNo>                                                                  081
</CompanyVATNo>                                                                 082
<Name>                                                                          083
</Name>                                                                         084
<PostalAddress>                                                                 085
</PostalAddress>                                                                086
<Address1>                                                                      087
</Address1>                                                                     088
<Address2>                                                                      089
</Address2>                                                                     090
<City>                                                                          091
</City>                                                                         092
<PostCode>                                                                      093
</PostCode>                                                                     094
<CountryCode>                                                                   095
</CountryCode>                                                                  096
<Invoicee>                                                                      097
</Invoicee>                                                                     098
<Supplier>                                                                      099
</Supplier>                                                                     100
<Buyer>                                                                         101
</Buyer>                                                                        102
<Summary>                                                                       103
</Summary>                                                                      104
<Taxes>                                                                         105
</Taxes>                                                                        106
<Tax>                                                                           107
</Tax>                                                                          108
<TaxType>                                                                       109
</TaxType>                                                                      110
<TaxBase>                                                                       111
</TaxBase>                                                                      112
<TaxPercent>                                                                    113
</TaxPercent>                                                                   114
<TaxAmount                                                                      115
</TaxAmount>                                                                    116
<TotalTax                                                                       117
</TotalTax>                                                                     118
<TotalExclTax                                                                   119
</TotalExclTax>                                                                 120
<TotalInclTax                                                                   121
</TotalInclTax>                                                                 122
<Details>                                                                       123
</Details>                                                                      124
<DetailNumber>                                                                  125
</DetailNumber>                                                                 126
<LineDetails>                                                                   127
</LineDetails>                                                                  128
<LineNumber>                                                                    129
</LineNumber>                                                                   130
<Quantities>                                                                    131
</Quantities>                                                                   132
<QuantityOrdered                                                                133
</QuantityOrdered>                                                              134
<QuantityDelivered                                                              135
</QuantityDelivered>                                                            136
<LineDates>                                                                     137
</LineDates>                                                                    138
<LineReference>                                                                 139
</LineReference>                                                                140
<OtherReference>                                                                141
</OtherReference>                                                               142
<Reference                                                                      143
</Reference>                                                                    144
<PriceDetails>                                                                  145
</PriceDetails>                                                                 146
<Price                                                                          147
</Price>                                                                        148
<LineTotalTaxBase                                                               149
</LineTotalTaxBase>                                                             150
<TaxPercent>                                                                    151
</TaxPercent>                                                                   152
<LineTotTax                                                                     153
</LineTotTax>                                                                   154
<LineTotExclTax                                                                 155
</LineTotExclTax>                                                               156
<LineTotInclTax                                                                 157
</LineTotInclTax>                                                               158
** TXT01
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"                          001
 xsi:noNamespaceSchemaLocation="D:\Bruker\Dok\Format\PostenInterchange-Complete-002
PS14C-rev3.xsd">                                                                003
