N710P ********************************************************************
N710P * Behandling av nedlastet norsk postnrfil (se ogs L1 VR840, IBMEND)*
NSYS  * INGEN nedlastn.alternativ gir direkte fast format.               *
NSYS  * - forutesetetr at fila er lagra som excel                        *
NSYS  *           deretter save as 'Formatert tekst(mellomrom) .prn'     *
N710P ********************************************************************
      * 01 PTF10 JOV   Nytt filformat
      * 02 PTF10 JOV   Navn / kommunenavn er ikke venstrestilt etter nedlasting
      * 03 PTF10 JOV   Ytterligere filendringer
      *
     FSYTIRCV   IP   F  256        DISK
     FPONRNNY   O  A E             DISK
     ISYTIRCV   NC  01
     I                                  1    4  PONNR
s03  I*                                 5   34  KONNAV
s03  I*                                35   38  KONR                            Kommunenr
s03  I*                                39   82  KONVN                           Kommunenavn
s03  I*                                83   83  POKAT                           Kategori
s03  I                                 15   36  KONNAV
n03  I                                 38   41  KONR                            Kommunenr
n03  I                                 57   86  KONVN                           Kommunenavn
n03  I                                 88   88  POKAT                           Kategori
N01  I*                                                            B=Både Gateadr og postbokser
N01  I*                                                            F=Flere bruksområder(felles)
N01  I*                                                            G=Gateadresser
N01  I*                                                            K=Kunde med eget postnr.
N01  I*                                                            P=Postbokser
N01  I*                                                            S=Servicepostnr
     I*                                55   84  PONBES
     I*                               105  179  PONTYP
     I*                               105  114  PONTYK
     I*                               205  208  PONKNR
     I*                               209  228  PONKNA
      *
     C     *ENTRY        PLIST
     C                   PARM                    INST              1
      * ER MODUL INSTALLERT ?????
     C     MODOK         IFNE      'J'
     C                   MOVEL     'SYTADINT'    UMODUL           15
     C                   MOVE      '       '     UMODUL
     C                   CALL      'SYPRODT'
     C                   PARM                    UMODUL
     C                   PARM                    UMFLAG            1 0
     C     UMFLAG        IFEQ      1
     C                   MOVE      UMFLAG        INST
     C                   SETON                                        LR
     C                   RETURN
     C                   END
     C                   MOVE      'J'           MODOK             1
     C                   END
     C*
     c                   select
     c     POKAT         wheneq    'B'
     c                   eval      PONTYK = 'B=Både Gateadr og postbokser  '
     c                   eval      PONTYP = 'B=Både Gateadr og postbokser  '
     c     POKAT         wheneq    'F'
     c                   eval      PONTYK = 'F=Flere bruksområder(felles)  '
     c                   eval      PONTYP = 'F=Flere bruksområder(felles)  '
     c     POKAT         wheneq    'G'
     c                   eval      PONTYK = 'G=Gateadresser                '
     c                   eval      PONTYP = 'G=Gateadresser                '
     c     POKAT         wheneq    'K'
     c                   eval      PONTYK = 'K=Kunde med eget postnr.      '
     c                   eval      PONTYP = 'K=Kunde med eget postnr.      '
     c     POKAT         wheneq    'P'
     c                   eval      PONTYK = 'P=Postbokser                  '
     c                   eval      PONTYP = 'P=Postbokser                  '
     c     POKAT         wheneq    'S'
     c                   eval      PONTYK = 'S=Servicepostnr               '
     c                   eval      PONTYP = 'S=Servicepostnr               '
     c                   endsl
     c                   eval      PONKNR = KONR
N02  c                   eval      PONNAV = %trim(KONNAV)
S02  c*                  eval      PONKNA = KONVN
N02  c                   eval      PONKNA = %trim(KONVN)
N02  C     PONNR         ifge      '0001'
N02  C     PONNR         andle     '9999'
     C                   WRITE     PONRNR
N02  c                   endif
      *
     C                   MOVE      '0'           INST
