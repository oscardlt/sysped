      *
      *****************************************************************
      *** PROGRAM SKAL ØKE POSISJON MED 1                           ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER          ***
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORER 27-32 34-99
      *****************************************************************
      *
     D PO              S              1    DIM(7)
     D                 DS
     D XNUM            C                   CONST('0123456789')
     D                 DS
     D  XPOS1                  1      7  0
     D  P2                     1      7  0
     D                                     DIM(7)
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPOS1             7
      *
     C                   MOVEA     UPOS1         PO
     C                   MOVE      *ZEROS        XPOS1             7 0
     C                   MOVE      *ZEROS        XSTART            1 0
     C                   MOVE      *ZEROS        XSLUTT            1 0
     C                   MOVE      *ZEROS        XSLUT2            1 0
     C     1             DO        7             XN                1 0          1<-B
     C     XSTART        IFEQ      0                                             2<-B
     C     PO(XN)        IFNE      ' '                                            3<-B
     C     XNUM          CHECK     PO(XN)                                 33
     C   33              MOVE      *BLANKS       PO
     C   33              GOTO      SLUTT
     C                   MOVE      XN            XSTART
     C                   MOVE      PO(XN)        XPOS1
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     XSLUTT        IFEQ      0                                              3<-B
     C     PO(XN)        IFEQ      ' '                                             4<-B
     C     XN            SUB       1             XSLUTT
     C                   ELSE                                                      4
     C     XNUM          CHECK     PO(XN)                                 33
     C   33              MOVE      *BLANKS       PO
     C   33              GOTO      SLUTT
     C                   MULT      10            XPOS1
     C                   MOVE      PO(XN)        XPOS1
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     PO(XN)        IFNE      ' '                                             4<-B
     C                   MOVE      *BLANKS       PO
     C                   GOTO      SLUTT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     XPOS1         IFGT      0                                            1<-B
     C     XSLUTT        IFEQ      0                                             2<-B
     C                   Z-ADD     7             XSLUTT
     C                   END                                                     2<-E
     C                   ADD       1             XPOS1
     C     6             SUB       XSLUTT        XN2
     C                   ADD       XSTART        XN2
     C     XN2           IFGT      0                                              3<-B
     C     P2(XN2)       IFNE      0                                               4<-B
     C     XSLUTT        IFLT      7                                                5<-B
     C                   ADD       1             XSLUTT
     C                   ELSE                                                       5
     C                   SUB       1             XSTART
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   Z-ADD     7             XN2               1 0
     C                   MOVE      XSLUTT        XN
     C     XN            DOWGE     XSTART
     C                   MOVE      P2(XN2)       PO(XN)
     C                   SUB       1             XN2
     C                   SUB       1             XN
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     SLUTT         TAG
     C                   MOVEA     PO            UPOS1
     C                   SETON                                        LR
     C                   RETURN
     C*
