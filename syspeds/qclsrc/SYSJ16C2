             PGM        PARM(&AVD &OPD &NR &PRT31 &PT31 &JOBK &FAXN +
                          &NAVN &KODF &KODS &FAX &CVP &CP1 &CP2 +
                          &EPOSTJ &EPOST &FTXT)
             DCL        VAR(&FAXN) TYPE(*CHAR) LEN(21)
             DCL        VAR(&NAVN) TYPE(*CHAR) LEN(30)
             DCL        VAR(&KODF) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KODS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&AVD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OPD) TYPE(*CHAR) LEN(7)
             DCL        VAR(&NR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&PRT31) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PT31) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBK) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FAX) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CVP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CP1) TYPE(*CHAR) LEN(160)
             DCL        VAR(&CP2) TYPE(*CHAR) LEN(160)
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(512)
             DCL        VAR(&FYLL) TYPE(*CHAR) LEN(1) VALUE('.')
             DCL        VAR(&EPOSTJ) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&FTXT) TYPE(*CHAR) LEN(900)
    /* */
             DCLF       FILE(FAXSEN)
/*                      */
/*  E-MAIL              */
/*                      */
             IF         COND(&EPOSTJ = 'J') THEN(DO)
             CHGVAR     VAR(&PARM) VALUE(&AVD *CAT &OPD *CAT &NR +
                          *CAT &NAVN *CAT &FAXN *CAT &CVP *CAT +
                          &CP1 *CAT &CP2 *CAT &EPOST *CAT &FYLL)
             SBMJOB     CMD(CALL PGM(SYSJ16C3E) PARM(&PARM)) +
                          JOB(SNDFAXFAKT) JOBD(*USRPRF) +
                          JOBQ(SYJOBQNMAX)
             GOTO       CMDLBL(SLUTT)
             ENDDO
    /* */
    /* GÅ TIL PRINT HVIS IKKE FAX  */
    /* */
             IF         COND(&FAX *NE 'J') THEN(GOTO CMDLBL(STPRT))
    /* */
             RCVF       RCDFMT(*FILE)
             CHGVAR     VAR(&PARM) VALUE(&AVD *CAT &OPD *CAT &NR +
                          *CAT &NAVN *CAT &FAXN *CAT &CVP *CAT +
                          &CP1 *CAT &CP2 *CAT &FYLL)
    /* */
    /* SENDER VIA FAKSMILE */
    /* */
             IF         COND(&FAXSYS = 'F') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ16C3F) PARM(&PARM)) +
                          JOB(FAXADV) JOBD(*USRPRF) JOBQ(QFAX/QFAXJOBQ)
             GOTO       CMDLBL(SLUTT)
             ENDDO
    /*                   */
    /* SENDER VIA FAX400 */
    /*                   */
             IF         COND(&FAXSYS = 'X') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ16C3N) PARM(&PARM &FTXT)) +
                          JOB(FAXADV) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             DLCOBJ     OBJ((QSYS/&FAXLIB *LIB *SHRUPD))
             GOTO       CMDLBL(SLUTT)
                          ENDDO
       /* */
    /*                   */
    /* SENDER VIA BLUFAX */
    /*                   */
             IF         COND(&FAXSYS = 'B') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ16C3B) PARM(&PARM &FTXT)) +
                          JOB(FAXADV) JOBD(*USRPRF) JOBQ(SYJOBQPRT)
             DLCOBJ     OBJ((QSYS/&FAXLIB *LIB *SHRUPD))
             GOTO       CMDLBL(SLUTT)
                          ENDDO
       /* */
 STPRT:      IF         COND(&JOBK = 'J') THEN(DO)
             SBMJOB     CMD(CALL PGM(SYSJ16C3) PARM(&AVD &OPD &NR +
                          &PRT31 &PT31)) JOB(ADVIS) JOBD(*USRPRF) +
                          JOBQ(SYJOBQAV)
                        ENDDO
             ELSE       CMD(DO)
             CALL       PGM(SYSJ16C3) PARM(&AVD &OPD &NR &PRT31 &PT31)
                        ENDDO
       /* */
SLUTT:       ENDPGM
