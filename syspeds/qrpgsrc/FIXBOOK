      *
      ************************************************************
      *** PROGRAM SKAL ENDRE STATUS PÅ BILL OF LADING          ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01 02 04-11 13-26                 ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-97                 ***
      ************************************************************
      *
     FKODTSF    IF   E           K DISK
     FBOOKING   UF   E           K DISK
     FSTS       UF A E           K DISK
     FFIXBOKFM  CF   E             WORKSTN
     D                 DS
     D  BODTRÅ                 1      4  0
     D  BODTRM                 5      6  0
     D  BODTRD                 7      8  0
     D  BODTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  WSDTD1                 1      2  0
     D  WSDTM1                 3      4  0
     D  WSDTÅ1                 5      6  0
     D  WSDT1                  1      6  0
     D                 DS
     D  BODTÅ1                 1      4  0
     D  BODTM1                 5      6  0
     D  BODTD1                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
     D                 DS
     D  BODTÅ2                 1      4  0
     D  BODTM2                 5      6  0
     D  BODTD2                 7      8  0
     D  BODT2                  1      8  0
     D                 DS
     D  WSDTD3                 1      2  0
     D  WSDTM3                 3      4  0
     D  WSDTÅ3                 5      6  0
     D  WSDT3                  1      6  0
     D                 DS
     D  BODTÅ3                 1      4  0
     D  BODTM3                 5      6  0
     D  BODTD3                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  WSDTD4                 1      2  0
     D  WSDTM4                 3      4  0
     D  WSDTÅ4                 5      6  0
     D  WSDT4                  1      6  0
     D                 DS
     D  BODTÅ4                 1      4  0
     D  BODTM4                 5      6  0
     D  BODTD4                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  WSDTD5                 1      2  0
     D  WSDTM5                 3      4  0
     D  WSDTÅ5                 5      6  0
     D  WSDT5                  1      6  0
     D                 DS
     D  BODTÅ5                 1      4  0
     D  BODTM5                 5      6  0
     D  BODTD5                 7      8  0
     D  BODT5                  1      8  0
     D                 DS
     D  WSDTD6                 1      2  0
     D  WSDTM6                 3      4  0
     D  WSDTÅ6                 5      6  0
     D  WSDT6                  1      6  0
     D                 DS
     D  BODTÅ6                 1      4  0
     D  BODTM6                 5      6  0
     D  BODTD6                 7      8  0
     D  BODT6                  1      8  0
     D                 DS
     D  WSDTD7                 1      2  0
     D  WSDTM7                 3      4  0
     D  WSDTÅ7                 5      6  0
     D  WSDT7                  1      6  0
     D                 DS
     D  BODTÅ7                 1      4  0
     D  BODTM7                 5      6  0
     D  BODTD7                 7      8  0
     D  BODT7                  1      8  0
     D                 DS
     D  WSDTD8                 1      2  0
     D  WSDTM8                 3      4  0
     D  WSDTÅ8                 5      6  0
     D  WSDT8                  1      6  0
     D                 DS
     D  BODTÅ8                 1      4  0
     D  BODTM8                 5      6  0
     D  BODTD8                 7      8  0
     D  BODT8                  1      8  0
     D                 DS
     D  WSDTD9                 1      2  0
     D  WSDTM9                 3      4  0
     D  WSDTÅ9                 5      6  0
     D  WSDT9                  1      6  0
     D                 DS
     D  BODTÅ9                 1      4  0
     D  BODTM9                 5      6  0
     D  BODTD9                 7      8  0
     D  BODT9                  1      8  0
     D                 DS
     D  XTIME                  1     14  0
     D  XTID                   1      6  0
     D  XDAG                   7      8  0
     D  XMND                   9     10  0
     D  XAAR                  11     14  0
     D                 DS
     D  SSDTÅ                  1      4  0
     D  SSDTM                  5      6  0
     D  SSDTD                  7      8  0
     D  SSDT                   1      8  0
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXFMT     BILDE01
     C                   SETOFF                                       999830
     C*
     C   03              GOTO      SLUTT
     C     BOOKK         CHAIN     BOOKING                            99
     C   99              DO
     C                   MOVE      'SPO0001'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
     C     KODSFK        CHAIN     KODTSF                             98
     C   98              DO
     C                   EXCEPT    DUMBO
     C                   MOVE      'SPS0001'     MSGNR
     C                   GOTO      START
     C                   END
     C*
     C                   EXSR      KDTFMT
     C*
     C     START2        TAG
     C                   EXFMT     BILDE02
     C*
     C  N05
     CANN12              GOTO      START2
     C   12              EXCEPT    DUMBO
     C   12              GOTO      START
     C*
     C     START3        TAG
     C                   TIME                    XTIME
     C                   MOVE      XAAR          SSDTÅ
     C                   MOVE      XMND          SSDTM
     C                   MOVE      XDAG          SSDTD
     C                   MOVE      XTID          SSTM
     C     STSK          CHAIN     STS                                33
     C  N33              GOTO      START3
     C                   MOVE      WSAVD         SSAVD
     C                   MOVE      WSOPD         SSOPD
     C                   MOVE      WSUSER        SSUSR
     C                   MOVE      WSSG          SSSG
     C                   MOVE      'K'           SSRTYP
     C                   MOVE      BOST          SSSTG
     C                   MOVE      WSST          SSSTN
     C                   WRITE     STSR
     C*
     C                   MOVE      WSST          BOST
     C                   EXCEPT    ENDRE
     C                   MOVE      *ZEROS        WSOPD
     C                   MOVE      *BLANKS       WSST
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODSFK        KLIST
     C                   KFLD                    WSFUNI
     C                   KFLD                    WSSG
     C     BOOKK         KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     STSK          KLIST
     C                   KFLD                    SSDT
     C                   KFLD                    SSTM
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C                   KFLD                    WSUSER
     C*
     C     *ENTRY        PLIST
     C                   PARM                    WSUSER           10
     C*
     C                   MOVE      'SF'          WSFUNI            2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      BODTRD        UDT1              2 0
     C                   MOVE      BODTRM        UDT2              2 0
     C                   MOVE      BODTRÅ        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTRD
     C                   MOVE      UDT2          WSDTRM
     C                   MOVE      UDT3          WSDTRÅ
     C*
     C                   MOVE      BODTD1        UDT1
     C                   MOVE      BODTM1        UDT2
     C                   MOVE      BODTÅ1        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD1
     C                   MOVE      UDT2          WSDTM1
     C                   MOVE      UDT3          WSDTÅ1
     C*
     C                   MOVE      BODTD2        UDT1
     C                   MOVE      BODTM2        UDT2
     C                   MOVE      BODTÅ2        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD2
     C                   MOVE      UDT2          WSDTM2
     C                   MOVE      UDT3          WSDTÅ2
     C*
     C                   MOVE      BODTD3        UDT1
     C                   MOVE      BODTM3        UDT2
     C                   MOVE      BODTÅ3        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD3
     C                   MOVE      UDT2          WSDTM3
     C                   MOVE      UDT3          WSDTÅ3
     C*
     C                   MOVE      BODTD4        UDT1
     C                   MOVE      BODTM4        UDT2
     C                   MOVE      BODTÅ4        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD4
     C                   MOVE      UDT2          WSDTM4
     C                   MOVE      UDT3          WSDTÅ4
     C*
     C                   MOVE      BODTD5        UDT1
     C                   MOVE      BODTM5        UDT2
     C                   MOVE      BODTÅ5        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD5
     C                   MOVE      UDT2          WSDTM5
     C                   MOVE      UDT3          WSDTÅ5
     C*
     C                   MOVE      BODTD6        UDT1
     C                   MOVE      BODTM6        UDT2
     C                   MOVE      BODTÅ6        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD6
     C                   MOVE      UDT2          WSDTM6
     C                   MOVE      UDT3          WSDTÅ6
     C*
     C                   MOVE      BODTD7        UDT1
     C                   MOVE      BODTM7        UDT2
     C                   MOVE      BODTÅ7        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD7
     C                   MOVE      UDT2          WSDTM7
     C                   MOVE      UDT3          WSDTÅ7
     C*
     C                   MOVE      BODTD8        UDT1
     C                   MOVE      BODTM8        UDT2
     C                   MOVE      BODTÅ8        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD8
     C                   MOVE      UDT2          WSDTM8
     C                   MOVE      UDT3          WSDTÅ8
     C*
     C                   MOVE      BODTD9        UDT1
     C                   MOVE      BODTM9        UDT2
     C                   MOVE      BODTÅ9        UDT3
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD9
     C                   MOVE      UDT2          WSDTM9
     C                   MOVE      UDT3          WSDTÅ9
     C*
     C                   ENDSR
     C*
     OBOOKINGR  E            ENDRE
     O                       BOST
     OBOOKINGR  E            DUMBO
