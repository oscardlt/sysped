     FEDIRE1K   IF   E           K DISK
     FECMSG3    IF   E           K DISK
     FEDIS2     IF   E           K DISK    PREFIX(S2_)
     F                                     RENAME(EDISR:EDISR2)
     FEDIM6     IF   E           K DISK    PREFIX(M6_)
     F                                     RENAME(EDIMR:EDIMR6)
     FXMLUFL2   UF   E           K DISK
     FEDIC      UF   E             DISK
     FEDIS      O  A E             DISK
     FEDIM      O  A E             DISK
      *
     D XICTYPE         C                   CONST('<InterchangeType>')
     D  XICTYPE1       C                   CONST('PostenInterchange')
     D XORIGINATOR     C                   CONST('<Originator>')
     D  XORIGiNATOR1   C                   CONST('<Address>')
     D  XORIGiNATOR2   C                   CONST('</Address>')
     D XRECIPIENT      C                   CONST('<Recipient>')
     D  XRECIPIENT1    C                   CONST('<Address>')
     D  XRECIPIENT2    C                   CONST('</Address>')
     D XICID           C                   CONST('<InterchangeId>')
     D  XICID1         C                   CONST('</InterchangeId>')
     D XICTIME         C                   CONST('<InterchangeTime>')
     D  XICTIME1       C                   CONST('<Date year="')
     D  XICTIME2       C                   CONST('month="')
     D  XICTIME3       C                   CONST('day="')
     D  XICTIME4       C                   CONST('<Time hour="')
     D  XICTIME5       C                   CONST('minute="')
     D  XICTIME6       C                   CONST('second="')
     D XRNREF          C                   CONST('<ReceiptNotificationRef')
     D  XRNREF1        C                   CONST('</ReceiptNotificationRef')
     D XRSTATUS        C                   CONST('<ReceiptStatus>')
     D  XRSTATUS1      C                   CONST('</ReceiptStatus>')
     D                 DS
     D  RDATA1                 1   1024
     D  RDATA2              1025   2048
     D  RDATA3                 1   2048
     D  IN                     1   2048    DIM(2048)
     D                 DS
     D  XTXT                   1   1024
     D  XT80                   1   1024    DIM(1024)
     D                 DS
     D  XTXTN                  1   1024
     D  XT80N                  1   1024    DIM(1024)
      *
      *
     C                   EXSR      SRINIT
      *
     C     WMBR          SETLL     EDIRE1K
     C     WMBR          READE     EDIRE1K                                50
     C     *IN50         CABEQ     *ON           SLUTT
     C     XICTYPE       SCAN      RDATA         WPOS              4 0    51
     C  N51WMBR          READE     EDIRE1K                                50
     C  N51XICTYPE       SCAN      RDATA         WPOS              4 0    51
     C     *IN51         CABEQ     *OFF          SLUTT
     C                   MOVE      RDATA         RDATA2
     C                   EXSR      LESREC
     C                   Z-ADD     1             WPOS
      *
      * LES PostenInterchange
     C     XICTYPE1      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTYPE1      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
      *
      * LES Originator
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XORIGINATOR   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XORIGINATOR   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XORIGINATOR1  SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XORIGINATOR1  SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C                   MOVE      WPOS          XSTPOS            4 0
     C                   ADD       9             XSTPOS
     C     XORIGINATOR2  SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XORIGINATOR2  SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   MOVE      WPOS          XSLPOS            4 0
     C                   SUB       1             XSLPOS
     C                   MOVE      *BLANKS       XTXT
     C                   MOVE      *ZEROS        XN2               3 0
     C     XSTPOS        DO        XSLPOS        XNR               4 0
     C                   ADD       1             XN2
     C                   MOVE      IN(XNR)       XT80(XN2)
     C                   ENDDO
     C                   MOVEL     XTXT          S0004
      *
      * LES Recipient
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XRECIPIENT    SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRECIPIENT    SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XRECIPIENT1   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRECIPIENT1   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C                   MOVE      WPOS          XSTPOS            4 0
     C                   ADD       9             XSTPOS
     C     XRECIPIENT2   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRECIPIENT2   SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   MOVE      WPOS          XSLPOS            4 0
     C                   SUB       1             XSLPOS
     C                   MOVE      *BLANKS       XTXT
     C                   MOVE      *ZEROS        XN2               3 0
     C     XSTPOS        DO        XSLPOS        XNR               4 0
     C                   ADD       1             XN2
     C                   MOVE      IN(XNR)       XT80(XN2)
     C                   ENDDO
     C                   MOVEL     XTXT          S0010
      *
     C     ECMSG3K       CHAIN     ECMSG3                             33
     C                   IF        *IN33
     C                   EXSR      SRERROR
     C                   GOTO      SLUTT
     C                   END
      *
      * LES InterchangeId
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICID         SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICID         SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C                   MOVE      WPOS          XSTPOS            4 0
     C                   ADD       15            XSTPOS
     C     XICID1        SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICID1        SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   MOVE      WPOS          XSLPOS            4 0
     C                   SUB       1             XSLPOS
     C                   MOVE      *BLANKS       XTXT
     C                   MOVE      *ZEROS        XN2               3 0
     C     XSTPOS        DO        XSLPOS        XNR               4 0
     C                   ADD       1             XN2
     C                   MOVE      IN(XNR)       XT80(XN2)
     C                   ENDDO
     C                   MOVEL     XTXT          S0020
      *
      * LES InterchangeTime
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME       SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME       SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME1      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME1      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       12            WPOS
     C                   MOVE      *BLANKS       XTXT
     C     1             DO        4             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME2      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME2      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       7             WPOS
     C     5             DO        6             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME3      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME3      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       5             WPOS
     C     7             DO        8             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   MOVEL     XTXT          XMDT              8 0
     C     XICTIME4      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME4      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       12            WPOS
     C                   MOVE      *BLANKS       XTXT
     C     1             DO        2             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME5      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME5      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       8             WPOS
     C     3             DO        4             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XICTIME6      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XICTIME6      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   ADD       8             WPOS
     C     5             DO        6             XNR
     C                   MOVE      IN(WPOS)      XT80(XNR)
     C                   ADD       1             WPOS
     C                   ENDDO
     C                   MOVEL     XTXT          XMTM              6 0
      *
      * LES ReceiptNotificationReference
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XRNREF        SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRNREF        SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C                   MOVE      WPOS          XSTPOS            4 0
     C                   ADD       30            XSTPOS
     C     XRNREF1       SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRNREF1       SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   MOVE      WPOS          XSLPOS            4 0
     C                   SUB       1             XSLPOS
     C                   MOVE      *BLANKS       XTXT
     C                   MOVE      *BLANKS       XTXTN
     C                   MOVE      'N'           XS0020SL          1
     C                   MOVE      *ZEROS        XN2               3 0
     C     XSTPOS        DO        XSLPOS        XNR               4 0
     C                   ADD       1             XN2
     C                   MOVE      IN(XNR)       XT80(XN2)
     C                   IF        IN(XNR) = '.'
     C                   MOVE      'J'           XS0020SL
     C                   END
     C                   IF        XS0020SL = 'N'
     C                   MOVE      IN(XNR)       XT80N(XN2)
     C                   END
     C                   ENDDO
     C                   MOVEL     XTXT          S2_S0020
     C                   MOVEL     XTXTN         S2_S0020N        14
      *
      * LES ReceiptStatus
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C     XRSTATUS      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRSTATUS      SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   IF        WPOS > 1024
     C                   SUB       1024          WPOS
     C                   EXSR      LESREC
     C                   END
     C                   MOVE      WPOS          XSTPOS            4 0
     C                   ADD       15            XSTPOS
     C     XRSTATUS1     SCAN      RDATA3:WPOS   WPOS              4 0    51
     C                   DOW       *IN51 = *OFF
     C                   EXSR      LESREC
     C     XSLUTTLES     CABEQ     'J'           SLUTT
     C     XRSTATUS1     SCAN      RDATA3:WPOS   WPOS              4 0    51
     C  N51              ENDDO
     C                   MOVE      WPOS          XSLPOS            4 0
     C                   SUB       1             XSLPOS
     C                   MOVE      *BLANKS       XTXT
     C                   MOVE      *ZEROS        XN2               3 0
     C     XSTPOS        DO        XSLPOS        XNR               4 0
     C                   ADD       1             XN2
     C                   MOVE      IN(XNR)       XT80(XN2)
     C                   ENDDO
     C                   MOVEL     XTXT          XSTATUS          30
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           SDT
     C                   MOVE      WTM           STM
     C                   MOVE      'R'           SSR
     C                   MOVE      'C'           SST
     C                   MOVEL     WLIB          SLIB
     C                   MOVEL     WFIL          SFILE
     C                   MOVEL     WMBR          SMBR
     C                   EVAL      S0026 = 'XML-KVT POSTEN'
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CSN
     C                   UPDATE    EDICR
     C                   Z-ADD     CSN           SSN
     C                   WRITE     EDISR
      *
     C                   MOVE      S0004         M0004
     C                   MOVE      S0010         M0010
     C                   MOVE      SSN           MSN
     C                   MOVE      'R'           MSR
     C                   MOVE      'C'           MST
     C                   MOVEL     WDT           MDT
     C                   MOVEL     WTM           MTM
     C                   MOVEL     'XMLCVP'      M0065
      *
     C     S2_S0020      CHAIN     EDIS2                              33
     C   33S2_S0020N     CHAIN     EDIS2                              33
     C                   IF        *IN33
     C                   EXSR      SRERROR
     C                   GOTO      SLUTT
     C                   END
     C     S2_SSN        SETLL     EDIM6
     C     S2_SSN        READE     EDIM6                                  33
     C                   DOW       *IN33 = *OFF
     C                   MOVEL     M6_M0068      XFFN
     C     XFFN          CHAIN     XMLUFL2                            33
     C                   IF        *IN33 = *OFF
     C                   IF        XSTATUS = 'OK'
     C                   MOVE      'M'           XFST
     C                   ELSE
     C                   MOVE      'N'           XFST
     C                   END
     C                   UPDATE    XMLUFFR
     C                   END
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   Z-ADD     CMN           MMN
     C                   MOVEL     MMN           M0062
     C                   MOVE      M6_M0068      M0068
     C                   MOVE      M6_M1001      M1001
     C                   MOVE      M6_M1004      M1004
     C                   MOVE      M6_M1225      M1225
     C                   MOVE      M6_MAVD       MAVD
     C                   MOVE      M6_MTDN       MTDN
     C                   MOVE      XMDT          M0068D
     C                   MOVE      XMTM          M0068E
     C                   WRITE     EDIMR
     C     S2_SSN        READE     EDIM6                                  33
     C                   ENDDO
      *
     C     SLUTT         TAG
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      *
      *////////////////////////////////////////////////////////////
      * SR for HENTING AV POSTER                           LESREC /
      *////////////////////////////////////////////////////////////
     C     LESREC        BEGSR
      *
     C                   IF        ((RDATA2 = *BLANKS) AND
     C                              (XSLUTTLES <> *BLANKS))
     C                   MOVE      'J'           XSLUTTLES         1
     C                   ELSE
     C                   READ      EDIRE1K                                50
     C                   MOVE      RDATA2        RDATA1
     C                   IF        *IN50 = *OFF
     C                   MOVE      RDATA         RDATA2
     C                   ELSE
     C                   MOVE      *BLANKS       RDATA2
     C                   MOVE      'S'           XSLUTTLES         1
     C                   END
     C                   END
     C                   IF        WPOS = 0
     C                   Z-ADD     1             WPOS
     C                   END
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for init                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
     C     ECMSG3K       KLIST
     C                   KFLD                    ECSR
     C                   KFLD                    EC0065
     C                   KFLD                    EC0054
     C                   KFLD                    S0004
     C                   KFLD                    S0010
      *
     C     *ENTRY        PLIST
     C                   PARM                    WLIB             10
     C                   PARM                    WFIL             10
     C                   PARM                    WMBR             10
      *
     C                   MOVE      'R'           ECSR
     C                   MOVE      'INVXML'      EC0065
     C                   MOVE      '14C'         EC0054
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      * SR for håndtering av feil                           *PSSR /
      *////////////////////////////////////////////////////////////
     C     *PSSR         BEGSR
     C                   EXSR      SRERROR
      *
     C                   ENDSR     '*CANCL'
      *
      *////////////////////////////////////////////////////////////
      * SR for håndtering av feil                         SRERROR /
      *////////////////////////////////////////////////////////////
     C     SRERROR       BEGSR
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XDT               8 0
     C                   MOVE      WTM           XTM               6 0
     C                   EVAL      XMSG = 'FILNAVN = EDIRE1K, '
     C                             + 'KOMPONENT = ' + %TRIM(WMBR) + ', '
     C                             + 'DATO = ' + %TRIM(%EDITW(XDT:'    .  .  '))
     C                             + ', '
     C                             + 'TID = ' + %TRIM(%EDITW(XTM:'  :  :  '))
     C                             + '.'
     C*                  CALL      'SYXML11CE'
     C                   CALL      'EDIERRC'
     C                   PARM                    XMSG            256
      *
     C                   ENDSR
      *
