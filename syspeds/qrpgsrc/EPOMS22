*TMP* *TMP* MIDLERTIDIG FOR Å TRIKSE MED ATD
CC    * POMSSystem oppdateres ved datoendringer
      *********************************************************************
      *
CRTPG+*  CRTPGM SYSPED/EPOMS22 MODULE(*LIBL/EPOMS22
CRTPGM*        *LIBL/CHECKUSR *LIBL/INCGI) ACTGRP(CGI) AUT(*USE)
      *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10172 * 01 SH  PTF10 norsk text til Track and trace
10XXX * 02 YBC PTF10 OPPDATER REASON CODE PÅ EPOH OG EPOL
10XXX * 03 YBC PTF10 SJEKK OPPDRAG HAR PO MED. HVIS IKKE, ÅPNE FOR ENDRING AV STED
10XXX * 04 YBC PTF10 SUMMERE KOLLI/VEKT/KUBIKKO FØR ENDRING
10XXX * 05 YBC PTF10 SEND ASNSTS TIL EUROPRIS
10XXX * 06 YBC PTF10 TILLATE IKKE ATD FØR ETA ER SATT
10XXX * 07 JOV PTF10 Utvidet med asn-logikk for Voice
10XXX * 08 YBC PTF10 OPPDATER INNGÅENDE KUNDENR PÅ TUKNA
10261 * 09 YBC PTF10 VEKT/KUBIKK I TURER ER ENDRET TIL 9.0 OG 7.3
10XXX * 10 YBC PTF10 NÅR ATD ER OPPGITT, SETT X PÅ WSTST4 FOR "CONFIRMED".
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 11 YBC PTF11 SVC-REFERANSE
********************************************************************
      *********************************************************************
      /copy syspeds/qrpgsrcpy,hspecs
      /copy syspeds/qrpgsrcpy,hspecsbnd
      *********************************************************************
     FBRIDF     UF   E           K DISK    USROPN
N11  FFRISOK    UF A E           K DISK    USROPN
     FTURER14   UF A E           K DISK    USROPN
     FHEAD14    IF   E           K DISK    USROPN
     F                                     RENAME(HEADFR:HEADFR14)
     FHEADF     UF   E           K DISK    USROPN
     FDISP      IF   E           K DISK    USROPN
     FBILLOF    UF   E           K DISK    USROPN
     FBLV1      UF A E           K DISK    USROPN
N03  FEPOH02    IF   E           K DISK    USROPN
N03  FEPOL02    IF   E           K DISK    USROPN
N07  FEPOPOS    IF   E           K DISK    USROPN
     FTRACKT    UF   E           K DISK    USROPN
     FTRACKF    O  A E             DISK    USROPN
     FTELL      UF   E           K DISK    USROPN
     FCDTRAFL2  IF   E           K DISK    USROPN
     FCDCON4    IF   E           K DISK    USROPN
     FSTED2     IF   E           K DISK    USROPN
     FBRPARF    IF   E           K DISK    USROPN
     FFIRMARC   IF   E           K DISK    USROPN
     FARKTXT    IF   E           K DISK    USROPN
     FARKEXT    IF   E           K DISK    USROPN
     FARKIVL11  IF   E           K DISK    USROPN
     FFIRM      IF   E           K DISK    USROPN
     FBILK      IF   E           K DISK    USROPN
     FDRIV      IF   E           K DISK    USROPN
     FKODTLK    IF   E           K DISK    USROPN
     FKODTÅ     IF   E           K DISK    USROPN
     FSTED2D    IF   E           K DISK    USROPN
     F                                     RENAME(STED2R:STED2RD)
     FUNITL01   IF   E           K DISK    USROPN
     FCUNDL01   IF   E           K DISK    USROPN
     FTRAN      IF   E           K DISK    USROPN
     FVALUL01   IF   E           K DISK    USROPN
      *********************************************************************
      *--------------------------------------------------------------------
      * Variables common to all CGIs
      *--------------------------------------------------------------------
      /copy syspeds/qrpgsrcpy,prototypeb
      /copy syspeds/qrpgsrcpy,usec
      /copy syspeds/qrpgsrcpy,variables3
     D IfsMultIndicators...
     d                 ds
     D  NoErrors                       n
     D  NameTooLong                    n
     D  NotAccessible                  n
     D  NoFilesUsable                  n
     D  DupSections                    n
     D  FileIsEmpty                    n
      *
      * Client input variables
     D user            s             10
     D UsrSpcName      s             10
XXX  D TTTEXL          S             70
     D WSKN            S              8
     D BSKN            S              8  0
     D WSSTART         s              1
     D WSCAN           s              1
     D WSTUR           s              8
     D WBTUR           s              8  0
     D WSFRAMES        s              1
     D WSLSH           s              5
     D WSLOH           s              5
     D WSBLNR          s             17
     D WSBLORR         s              1
N11  D WSSVC           s             15
     D WSTR            S              4
     D WSBNV           s             30
     D WSETD           s             10
     D WSETA           s             10
     D WSATD           s             10
     D WSATA           s             10
     D WSEDRE          S              3
     D WSCON1          s             17
     D WSCKD1          s              2
     D WSTST4          s              1
      *
     D WSRAR4          s              4
     D WSRMND          s              2
     D WBRMND          s              2  0
     D WSBILK          s              3
     D WSBILN          s             10
     D WSLK            s              2
     D WSHENG          s             10
     D WSLKH           s              2
     D WSKNT2          s              8
     D WBKNT2          s              8  0
     D WSNAT           s             30
     D WSSJA1          s              8
     D WBSJA1          s              8  0
     D WSSJN1          s             30
     D WSSJA2          s              8
     D WBSJA2          s              8  0
     D WSSJN2          s             30
     D WSDT            s             10
     D WSTM            s              5
     D WBTM            s              4  0
     D WSSTEF          s              5
     D WSLKFR          s              2
     D WSSDF           s             20
     D WSDTT           s             10
     D WSTMT           s              5
     D WBTMT           s              4  0
     D WSSTET          s              5
     D WSLKTO          s              2
     D WSSDT           s             20
     D WSTVAL          s              3
     D WSTAKO          s              1
     D WSTBEL          s             12
     D WBTBEL          s             11  2
     D WSHSD           S              1
     D WSSAVD          S              4
      *
     D FMELDNR         S              2
     D FEILMELDING     S             80
     D EMNE            S             44
     D SENDER          S             17
     D CMD             S           5000
     D MELD            S           5000
     D PGM             C                   CONST('SYSPED/CHECKUSR')
      *
     D OddEven         s             10
      *
     D FEIL01          C                   CONST('Port of loading is not -
     D                                     valid.')
     D FEIL02          C                   CONST('Port of unloading is not -
     D                                     valid.')
     D FEIL03          C                   CONST('Vessel has to be given.')
     D FEIL04          C                   CONST('ETD is not valid.')
     D FEIL05          C                   CONST('ETA is not valid.')
     D FEIL06          C                   CONST('ATD is not valid.')
     D FEIL07          C                   CONST('ATA is not valid.')
     D FEIL08          C                   CONST('Container no. is not valid.')
     D FEIL09          C                   CONST('Type of container can not be -
     D                                     blank.')
     D FEIL10          C                   CONST('You have to select a reason -
     D                                     since at least one of dates is -
     D                                     changed.')
     D FEIL11          C                   CONST('When confirm, you should -
     D                                     give BL-no and container on trip or -
     D                                     on each order.')
     D FEIL21          C                   CONST('Tastet periode er ikke gyldig-
     D                                     .')
     D FEIL22          C                   CONST('Periode er ikke åpen.')
     D FEIL23          C                   CONST('Bilnr. er ikke registrert.')
     D FEIL24          C                   CONST('Landkode er ikke registrert.')
     D FEIL25          C                   CONST('Landkode er ikke registrert.')
     D FEIL26          C                   CONST('Oppgitt bilkode er ugyldig.')
     D FEIL27          C                   CONST('Oppgitt transportør finnes -
     D                                     ikke i register.')
     D FEIL28          C                   CONST('Transportør har stoppkode -
     D                                     - kan ikke benyttes.')
     D FEIL29          C                   CONST('Sjåførnr 1 finnes ikke -
     D                                     eller navn ikke utfyllt.')
     D FEIL30          C                   CONST('Sjåførnr 2 finnes ikke -
     D                                     eller navn ikke utfyllt.')
     D FEIL31          C                   CONST('Fra-dato er ugyldig.')
     D FEIL32          C                   CONST('Fra-sted er ugyldig.')
     D FEIL33          C                   CONST('Til-dato er ugyldig.')
     D FEIL34          C                   CONST('Fra-dato kan ikke være -
     D                                     senere enn til-dato.')
     D FEIL35          C                   CONST('Til-sted er ugyldig.')
     D FEIL36          C                   CONST('Valutakode er gyldig.')
     D FEIL37          C                   CONST('Tastet kode må være A=avtalt -
     D                                     pris eller E=estimat N=nei -
     D                                     M=maskinell.')
      * For xlate mellom Upper Case og Lower Case
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LC              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     D                 DS
     D WBETDÅ                  1      4  0
     D WBETDM                  5      6  0
     D WBETDD                  7      8  0
     D WBETD                   1      8  0
     D                 DS
     D WBETAÅ                  1      4  0
     D WBETAM                  5      6  0
     D WBETAD                  7      8  0
     D WBETA                   1      8  0
     D                 DS
     D WBATDÅ                  1      4  0
     D WBATDM                  5      6  0
     D WBATDD                  7      8  0
     D WBATD                   1      8  0
     D                 DS
     D WBATAÅ                  1      4  0
     D WBATAM                  5      6  0
     D WBATAD                  7      8  0
     D WBATA                   1      8  0
     D                 DS
     D WBDTTÅ                  1      4  0
     D WBDTTM                  5      6  0
     D WBDTTD                  7      8  0
     D WBDTT                   1      8  0
     D                 DS
     D WBDTÅ                   1      4  0
     D WBDTM                   5      6  0
     D WBDTD                   7      8  0
     D WBDT                    1      8  0
     D                 DS
     D WBRAR4                  1      4  0
     D WBRACC                  1      2  0
     D WBRAAR                  3      4  0
     D                 DS
     D TURACC                  1      2  0
     D TURAAR                  3      4  0
     D TURAR4                  1      4  0
S04  D*                DS
S04  D*TUTVKT                  5      9  0
S04  D*XTUTVKT                 1      9  0
S04  D*                DS
S04  D*TUTLM                   3      6  2
S04  D*XTUTLM                  1      6  2
S04  D*                DS
S04  D*TUTM3                   3      7  2
S04  D*XTUTM3                  1      7  2
     D                 DS
     D  DIDATF                 1      8  0
     D  DITIMF                 9     12  0
     D  DIFRA                  1     12  0
     D                 DS
     D  DIDATT                 1      8  0
     D  DITIMT                 9     12  0
     D  DITIL                  1     12  0
     D                 DS
     D  MINDT                  1     12  0
     D  MINDAT                 1      8  0
     D  MINTIM                 9     12  0
     D  MINSTE                13     17
     D  MINLK                 18     19
     D                 DS
     D  MAXDT                  1     12  0
     D  MAXDAT                 1      8  0
     D  MAXTIM                 9     12  0
     D  MAXSTE                13     17
     D  MAXLK                 18     19
     D                 DS
     D  TUTARF                 1     15
     D  TUBLORR                1      1
     D  TUTR                   2      5
     D                 DS
     D  UNRETU                 1     30
     D  UNPDA                  1      4
     D  UNSJNR                 5     12
N02  D                 DS
N02  D  POMSDS1                1    256
N02  D  P1WSEDRE               1      3
      *
     D XBANE           S             50
     D                 DS
     D  updf1                  1    400
     D  updf2                401    800
     D  updf3                801   1200
     D  updf4               1201   1600
     D  updf5               1601   2000
     D  updf6               2001   2400
     D  updf7               2401   2800
     D  updf8               2801   3200
     D  updf9               3201   3600
     D  updf10              3601   4000
     D  updf11              4001   4400
     D  updf12              4401   4800
     D  updf13              4801   5200
     D  updf14              5201   5600
     D  updf15              5601   6000
     D  updf16              6001   6400
     D  updf17              6401   6800
     D  updf18              6801   7200
     D  updf19              7201   7600
     D  updf20              7601   8000
     D  updf21              8001   8400
     D  updf22              8401   8800
     D  updf23              8801   9200
     D  updf24              9201   9600
     D  updf25              9601  10000
     D  updf26             10001  10400
     D  updf27             10401  10800
     D  updf28             10801  11200
     D  updf29             11201  11600
     D  updf30             11601  12000
     D  updf31             12001  12400
     D  updf32             12401  12800
     D  updf33             12801  13200
     D  updf34             13201  13600
     D  updf35             13601  14000
     D  updf36             14001  14400
     D  updf37             14401  14800
     D  updf38             14801  15200
     D  updf39             15201  15600
     D  updf40             15601  16000
     D  updf                   1  16000    DIM(40)
      *
      /copy syspeds/qrpgsrcpy,prolog3
      *
      * Get program start time for calculating execution time
     C                   time                    timedata1
      * Parse input / cvt to numeric
     C                   exsr      Parse
      * File open / keys
     C                   EXSR      INIT
      *
     C                   CALLB     PGM
     C                   PARM                    BIBRID
     C                   PARM                    UsrSpcName
     C                   PARM                    UINN              1
     C                   IF        UINN = 'N'
     C                   GOTO      SLUTT
     C                   END
      * dato/tid siste vellykkede operasjon.
     C     USER          CHAIN     BRIDF                              50
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           BIDTF
     C                   MOVE      WTM           BITIDF
     C                   UPDATE    BRIDFR
      *
     C                   SELECT
     C                   WHEN      WSSTART = 'J'
     C                   IF        WBTUR = 0
     C                   EXSR      SRBLANK
     C                   ELSE
     C                   EXSR      SRGET
     C                   END
     C                   WHEN      WSCAN   = 'J'
     C                   IF        XTURTYPE = 'O'
     C                   EXSR      TESTB1
     C                   ELSE
     C                   EXSR      TESTB1LT
     C                   END
     C                   IF        FEILMELDING = *BLANKS
     C                   EXSR      SREND
     C                   END
     C                   WHEN      WSCAN   = 'Y'
     C                   EXSR      SREND
     C                   OTHER
     C                   IF        XTURTYPE = 'O'
     C                   EXSR      TESTB1
     C                   ELSE
     C                   EXSR      TESTB1LT
     C                   END
     C                   ENDSL
      *
     C                   IF        ((FMELDNR = *BLANKS) AND (WSSTART <> 'J'))
     C                   IF        XTURTYPE = 'O'
     C                   EXSR      SRUPD
     C                   ELSE
     C                   EXSR      SRUPDLT
     C                   END
     C                   ELSE
     C                   END
      *
      * HENT FRA/TIL STED
     C                   IF        WSHSD <> *BLANKS
     C                   EXSR      SRHENTSD
     C                   END
      *
      * Read output skeleton html member into memory
     C                   exsr      LoadHtml
      * Set section variables
     C                   exsr      Settop
     C                   callp     wrtsection('top')
      *
     C                   IF        XTURTYPE = 'O'
      *
     C     TUPRO         SETLL     HEAD14                                 33
     C                   IF        (*IN33 AND (TUPRO <> 0))
N03  C     TUPRO         READE     HEAD14                                 33
N03  C                   DOW       *IN33 = *OFF
N03  C     HEADFK        CHAIN     EPOH02                             33
N03  C   33HEADFK        CHAIN     EPOL02                             33
N03  C  N33              LEAVE
N03  C     TUPRO         READE     HEAD14                                 33
N03  C                   ENDDO
N03  C                   IF        *IN33
N03  C                   MOVE      'N'           XVIS              1
N03  C                   callp     wrtsection('EndreSted')
N03  C                   ELSE
     C                   MOVE      'J'           XVIS              1
     C                   callp     wrtsection('VisSted')
N03  C                   END
     C                   ELSE
     C                   MOVE      'N'           XVIS              1
     C                   callp     wrtsection('EndreSted')
     C                   END
     C                   callp     wrtsection('Tur1')
     C                   EXSR      DSPTROB
     C                   exsr      VISREASON
N04   *
N04   * VIS OPPRINNELIG KOLLI, VEKT OG M3
S09  C*                  IF        TUTS = 99999
N09  C                   IF        TUTS = 9999999
N04  C                   callp     updHtmlVar('XTURNT':
N04  C* vis fortegn                %trim(%editc(XTURNT:'Z')))
N04  C                             %trim(%editc(XTURNT:'M')))
N04  C                   callp     wrtsection('Viskl1')
N04  C                   END
N04  C                   callp     wrtsection('Viskl2')
S09  C*                  IF        TUTVKT = 99999
N09  C                   IF        TUTVKT = 999999999
N04  C                   callp     updHtmlVar('XTURVKT':
N04  C* vis fortegn                %trim(%editc(XTURVKT:'Z')))
N04  C                             %trim(%editc(XTURVKT:'M')))
N04  C                   callp     wrtsection('Visvkt1')
N04  C                   END
N04  C                   callp     wrtsection('Visvkt2')
S09  C*                  IF        TUTM3 = 999.99
N09  C                   IF        TUTM3 = 9999.999
N04  C                   callp     updHtmlVar('XTURM3':
N04  C                             %trim(%editc(XTURM3:'M')))
N04  C                   callp     wrtsection('Vism31')
N04  C                   END
N04  C                   callp     wrtsection('Vism32')
N04   *
     C                   EXSR      HENTDOK
     C                   callp     wrtsection('VisDok')
      *
     C                   IF        XVIS = 'J'
     C                   callp     wrtsection('VisSted2')
     C                   ELSE
     C                   callp     wrtsection('VisSted1')
     C                   END
     C                   callp     wrtsection('VisSted3')
     C                   IF        XVIS = 'N'
     C                   callp     wrtsection('VisSted4')
     C                   ELSE
     C                   callp     wrtsection('VisSted5')
     C                   END
     C                   callp     wrtsection('VisSted6')
      *
     C                   ELSE
     C                   callp     wrtsection('Tur1')
     C                   EXSR      HENTDOK
     C                   callp     wrtsection('VisDok')
     C                   callp     wrtsection('VisSted6')
     C                   END
      *
      *
      * Quit
      * Compute run time
     C                   time                    timedata2
     C     timedata2     subdur    timedata1     ms:*ms
     C                   eval      sec = ms / 1000000
     C                   callp     updhtmlvar('runtime':
     C                             %trim(%editw(sec:'     0 .   ')))
      *
     C                   callp     wrtsection('bot')
     C     SLUTT         TAG
     C                   exsr      Exit
      *
     C                   eval      *inlr = *on
     C                   return
      *
      *
      *=====================================================================
      * Parse input / cvt to numeric
      *=====================================================================
     C     Parse         begsr
      * Parse variables from QUERY_STRING environment variable
     C                   eval      user     = zhbgetvar('user')
     C                   EVAL      UsrSpcName  = zhbgetvar('UsrSpcName')
     C                   eval      WSKN    = zhbgetvar('WSKN')
     C                   eval      BSKN    = c2n2(WSKN)
     C                   eval      WSTUR    = zhbgetvar('WSTUR')
     C                   EVAL      WBTUR    = c2n2(WSTUR)
     C                   eval      WSFRAMES = zhbgetvar('FRAMES')
     C                   eval      WSSTART  = zhbgetvar('WSSTART')
     C                   eval      WSCAN    = zhbgetvar('WSCAN')
     C                   eval      WSTUR    = zhbgetvar('WSTUR')
     C                   EVAL      WBTUR    = c2n2(WSTUR)
     C                   eval      WSLSH    = zhbgetvar('WSLSH')
     C     LC:UC         XLATE     WSLSH         WSLSH
     C                   eval      WSLOH    = zhbgetvar('WSLOH')
     C     LC:UC         XLATE     WSLOH         WSLOH
     C                   eval      WSBLNR   = zhbgetvar('WSBLNR')
     C     LC:UC         XLATE     WSBLNR        WSBLNR
N11  C                   eval      WSSVC    = zhbgetvar('WSSVC')
N11  C     LC:UC         XLATE     WSSVC         WSSVC
     C                   eval      WSBLORR = zhbgetvar('WSBLORR')
     C                   eval      WSTR    = zhbgetvar('WSTR')
     C                   eval      WSBNV    = zhbgetvar('WSBNV')
     C     LC:UC         XLATE     WSBNV         WSBNV
     C                   eval      WSETD    = zhbgetvar('WSETD')
     C                   EVAL      WBETD    = c2n2(WSETD)
     C                   eval      WSETA    = zhbgetvar('WSETA')
     C                   EVAL      WBETA    = c2n2(WSETA)
     C                   eval      WSATD    = zhbgetvar('WSATD')
     C                   EVAL      WBATD    = c2n2(WSATD)
     C                   eval      WSATA    = zhbgetvar('WSATA')
     C                   EVAL      WBATA    = c2n2(WSATA)
     C                   eval      WSEDRE  = zhbgetvar('WSEDRE')
     C                   eval      WSCON1   = zhbgetvar('WSCON1')
     C     LC:UC         XLATE     WSCON1        WSCON1
     C                   eval      WSCKD1   = zhbgetvar('WSCKD1')
     C     LC:UC         XLATE     WSCKD1        WSCKD1
     C                   eval      WSTST4   = zhbgetvar('WSTST4')
      *
     C                   eval      WSRAR4   = zhbgetvar('WSRAR4')
     C                   EVAL      WBRAR4   = c2n2(WSRAR4)
     C                   eval      WSRMND   = zhbgetvar('WSRMND')
     C                   EVAL      WBRMND   = c2n2(WSRMND)
     C                   eval      WSBILK   = zhbgetvar('WSBILK')
     C     LC:UC         XLATE     WSBILK        WSBILK
     C                   eval      WSBILN   = zhbgetvar('WSBILN')
     C     LC:UC         XLATE     WSBILN        WSBILN
     C                   eval      WSLK     = zhbgetvar('WSLK')
     C     LC:UC         XLATE     WSLK          WSLK
     C                   eval      WSHENG   = zhbgetvar('WSHENG')
     C     LC:UC         XLATE     WSHENG        WSHENG
     C                   eval      WSLKH    = zhbgetvar('WSLKH')
     C     LC:UC         XLATE     WSLKH         WSLKH
     C                   eval      WSKNT2   = zhbgetvar('WSKNT2')
     C                   EVAL      WBKNT2   = c2n2(WSKNT2)
     C                   eval      WSNAT    = zhbgetvar('WSNAT')
     C     LC:UC         XLATE     WSNAT         WSNAT
     C                   eval      WSSJA1   = zhbgetvar('WSSJA1')
     C                   EVAL      WBSJA1   = c2n2(WSSJA1)
     C                   eval      WSSJN1   = zhbgetvar('WSSJN1')
     C     LC:UC         XLATE     WSSJN1        WSSJN1
     C                   eval      WSSJA2   = zhbgetvar('WSSJA2')
     C                   EVAL      WBSJA2   = c2n2(WSSJA2)
     C                   eval      WSSJN2   = zhbgetvar('WSSJN2')
     C     LC:UC         XLATE     WSSJN2        WSSJN2
     C                   eval      WSDT     = zhbgetvar('WSDT')
     C                   EVAL      WBDT     = c2n2(WSDT)
     C                   eval      WSTM     = zhbgetvar('WSTM')
     C                   EVAL      WBTM     = c2n2(WSTM)
     C                   eval      WSSTEF   = zhbgetvar('WSSTEF')
     C     LC:UC         XLATE     WSSTEF        WSSTEF
     C                   eval      WSLKFR   = zhbgetvar('WSLKFR')
     C     LC:UC         XLATE     WSLKFR        WSLKFR
     C                   eval      WSDTT    = zhbgetvar('WSDTT')
     C                   EVAL      WBDTT    = c2n2(WSDTT)
     C                   eval      WSTMT    = zhbgetvar('WSTMT')
     C                   EVAL      WBTMT    = c2n2(WSTMT)
     C                   eval      WSSTET   = zhbgetvar('WSSTET')
     C     LC:UC         XLATE     WSSTET        WSSTET
     C                   eval      WSLKTO   = zhbgetvar('WSLKTO')
     C     LC:UC         XLATE     WSLKTO        WSLKTO
     C                   eval      WSTVAL   = zhbgetvar('WSTVAL')
     C     LC:UC         XLATE     WSTVAL        WSTVAL
     C                   eval      WSTAKO   = zhbgetvar('WSTAKO')
     C     LC:UC         XLATE     WSTAKO        WSTAKO
     C                   eval      WSTBEL   = zhbgetvar('WSTBEL')
     C                   EVAL      WBTBEL   = c2n2(WSTBEL)
     C                   eval      WSHSD    = zhbgetvar('WSHSD')
     C                   eval      WSSAVD   = zhbgetvar('WSSAVD')
      *
     C                   eval      FEILMELDING = *BLANKS
     C                   eval      FMELDNR     = *BLANKS
      *
     C                   endsr
      *
      *=====================================================================
      * Close output html and quit
      *=====================================================================
     C     Exit          begsr
      * Do not delete the call to wrtsection with section name *fini.  It is needed
      * to ensure that all output html that has been buffered gets output.
     C                   callp     wrtsection('*fini')
      * Quit
     C                   CLOSE     BRIDF
N11  C                   CLOSE     FRISOK
     C                   CLOSE     TURER14
     C                   CLOSE     HEAD14
     C                   CLOSE     HEADF
     C                   CLOSE     DISP
     C                   CLOSE     BILLOF
     C                   CLOSE     BLV1
N03  C                   CLOSE     EPOH02
N03  C                   CLOSE     EPOL02
N07  C                   CLOSE     EPOPOS
     C                   CLOSE     TRACKT
     C                   CLOSE     TRACKF
     C                   CLOSE     TELL
     C                   CLOSE     CDTRAFL2
     C                   CLOSE     CDCON4
     C                   CLOSE     STED2
     C                   CLOSE     BRPARF
     C                   CLOSE     FIRMARC
     C                   CLOSE     ARKTXT
     C                   CLOSE     ARKEXT
     C                   CLOSE     ARKIVL11
     C                   CLOSE     FIRM
     C                   CLOSE     BILK
     C                   CLOSE     DRIV
     C                   CLOSE     KODTLK
     C                   CLOSE     KODTÅ
     C                   CLOSE     STED2D
     C                   CLOSE     UNITL01
     C                   CLOSE     CUNDL01
     C                   CLOSE     VALUL01
      *
     C                   endsr
      *
      *=====================================================================
      * Read output skeleton html member into memory
      *=====================================================================
     C     LoadHtml      begsr
      *
     C                   IF        XTURTYPE = 'O'
     C*                  callp     gethtml('HTMLSRC':
     C*                            '*LIBL':
     C*                            'EPOMS22':'/CGITAG/')
cccccC                   eval      IfsMultIndicators = gethtmlifsmult(
cccccC                             '/syspeddev/html/Header/eSpedTop.html -
cccccC                             /syspeddev/html/EPOMS22.html -
cccccC                             /syspeddev/html/Footer/eSpedBot.html':
cccccC                             '/CGITAG/')
     C                   ELSE
     C*                  callp     gethtml('HTMLSRC':
     C*                            '*LIBL':
     C*                            'EPOMS22':'/CGITAG/')
cccccC                   eval      IfsMultIndicators = gethtmlifsmult(
cccccC                             '/syspeddev/html/Header/eSpedTop.html -
cccccC                             /syspeddev/html/EPOMS22.html -
cccccC                             /syspeddev/html/Footer/eSpedBot.html':
cccccC                             '/CGITAG/')
     C                   END
      *
     C                   endsr
      *=====================================================================
      *  Set variable data for section /$top
      *=====================================================================
     C     SetTop        begsr
      *
OddEvC                   callp     updHTMLvar('ROWHEAD':RowHead)
OddEvC                   callp     updHTMLvar('LogoImg':LogoImg)
BODY C                   callp     updhtmlvar('BODYCLASS':'class='+BIFARG)
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHtmlVar('UsrSpcName':UsrSpcName)
     C                   callp     updHtmlVar('WSKN':
     C                             %trim(%editc(BSKN:'Z')))
     C                   callp     updHtmlVar('WSTUR':
     C                             %trim(%editc(WBTUR:'L')))
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     updHTMLvar('WSSAVD':WSSAVD)
      *
S04  C*    WBTUR         CHAIN     TURER14                            33
S04  C*                  EVAL      TUAO   = 0
S04  C*                  EVAL      TUTS   = 0
S04  C*                  EVAL      XTUTVKT = 0
S04  C*                  EVAL      XTUTM3  = 0
S04  C*                  EVAL      XTUTLM  = 0
S04  C*                  IF        *IN33 = *OFF
S04  C*    TUPRO         SETLL     HEAD14
S04  C*    TUPRO         READE     HEAD14                                 33
S04  C*                  DOW       *IN33 = *OFF
S04  C*                  EVAL      TUAO   = TUAO + 1
S04  C*                  EVAL      TUTS   = TUTS + HENT
S04  C*                  EVAL      XTUTVKT = XTUTVKT + HEVKT
S04  C*                  EVAL      XTUTM3  = XTUTM3 + HEM3
S04  C*                  EVAL      XTUTLM  = XTUTLM + HELM
S04  C*    TUPRO         READE     HEAD14                                 33
S04  C*                  ENDDO
S04  C*                  UPDATE    TURERR
S04  C*                  END
      *
     C                   callp     updHTMLvar('WSLSH':WSLSH)
     C                   callp     updHTMLvar('WSLOH':WSLOH)
     C                   callp     updHTMLvar('WSBLNR':WSBLNR)
     C                   callp     updHtmlVar('WSBLORR':WSBLORR)
N11  C                   callp     updHTMLvar('WSSVC':WSSVC)
     C                   callp     updHTMLvar('WSBNV':WSBNV)
     C                   callp     updHtmlVar('WSETD':
     C                             %trim(%editw(WBETD:'    .  .  ')))
     C                   callp     updHtmlVar('WSETA':
     C                             %trim(%editw(WBETA:'    .  .  ')))
     C                   callp     updHtmlVar('WSATD':
     C                             %trim(%editw(WBATD:'    .  .  ')))
     C                   callp     updHtmlVar('WSATA':
     C                             %trim(%editw(WBATA:'    .  .  ')))
     C                   callp     updHTMLvar('WSCON1':WSCON1)
     C                   callp     updHTMLvar('WSCKD1':WSCKD1)
     C                   IF        WSTST4 = 'X' AND FEILMELDING = *BLANKS
     C                   callp     updHTMLvar('WSCHECKED':'checked')
     C                   ELSE
     C                   callp     updHTMLvar('WSCHECKED':'')
     C                   END
     C                   callp     updHtmlVar('TUAO':
     C                             %trim(%editc(TUAO:'Z')))
     C                   callp     updHtmlVar('TUTS':
     C                             %trim(%editc(TUTS:'Z')))
     C                   callp     updHtmlVar('TUTVKT':
     C                             %trim(%editc(TUTVKT:'Z')))
     C                   callp     updHtmlVar('TUTM3':
     C                             %trim(%editc(TUTM3:'3')))
     C                   callp     updHtmlVar('TUTLM':
     C                             %trim(%editc(TUTLM:'3')))
      *
     C                   callp     updHtmlVar('WSRAR4':
     C                             %trim(%editc(WBRAR4:'3')))
     C                   callp     updHtmlVar('WSRMND':
     C                             %trim(%editc(WBRMND:'3')))
     C                   callp     updHTMLvar('WSBILK':WSBILK)
     C                   callp     updHTMLvar('WSBILN':WSBILN)
     C                   callp     updHTMLvar('WSLK':WSLK)
     C                   callp     updHTMLvar('WSHENG':WSHENG)
     C                   callp     updHTMLvar('WSLKH':WSLKH)
     C                   callp     updHtmlVar('WSKNT2':
     C                             %trim(%editc(WBKNT2:'3')))
     C                   callp     updHTMLvar('WSNAT':WSNAT)
     C                   callp     updHtmlVar('WSSJA1':
     C                             %trim(%editc(WBSJA1:'3')))
     C                   callp     updHTMLvar('WSSJN1':WSSJN1)
     C                   callp     updHtmlVar('WSSJA2':
     C                             %trim(%editc(WBSJA2:'3')))
     C                   callp     updHTMLvar('WSSJN2':WSSJN2)
     C                   callp     updHtmlVar('WSDT':
     C                             %trim(%editw(WBDT:'    .  .  ')))
     C                   callp     updHtmlVar('WSTM':
     C                             %trim(%editw(WBTM:'0 :  ')))
     C                   callp     updHTMLvar('WSSTEF':WSSTEF)
     C                   callp     updHTMLvar('WSLKFR':WSLKFR)
     C                   callp     updHTMLvar('WSSDF':WSSDF)
     C                   callp     updHtmlVar('WSDTT':
     C                             %trim(%editw(WBDTT:'    .  .  ')))
     C                   callp     updHtmlVar('WSTMT':
     C                             %trim(%editw(WBTMT:'0 :  ')))
     C                   callp     updHTMLvar('WSSTET':WSSTET)
     C                   callp     updHTMLvar('WSLKTO':WSLKTO)
     C                   callp     updHTMLvar('WSSDT':WSSDT)
     C                   callp     updHTMLvar('WSTVAL':WSTVAL)
     C                   callp     updHTMLvar('WSTAKO':WSTAKO)
     C                   callp     updHtmlVar('WSTBEL':
     C                             %trim(%editc(WBTBEL:'3')))
      *
     C                   callp     updhtmlvar('FEILMELDING':
     C                             FEILMELDING)
     C                   callp     updhtmlvar('FMELDNR':FMELDNR)
      *
     C                   endsr
      *
      *=====================================================================******
      *  SRBLANK
      *=====================================================================******
     C     SRBLANK       begsr
      *
     C                   EVAL      WBTUR  = 0
     C                   EVAL      WSLSH  = *BLANKS
     C                   EVAL      WSLOH  = *BLANKS
     C                   EVAL      WSBLNR = *BLANKS
     C                   EVAL      WSBLORR = *BLANKS
N11  C                   EVAL      WSSVC  = *BLANKS
     C                   EVAL      WSBNV  = *BLANKS
     C                   EVAL      WBETD  = 0
     C                   EVAL      WBETA  = 0
     C                   EVAL      WBATD  = 0
     C                   EVAL      WBATA  = 0
     C                   EVAL      WSCON1 = *BLANKS
     C                   EVAL      WSCKD1 = *BLANKS
     C                   EVAL      WSTST4 = *BLANKS
      *
     C                   EVAL      WBRAR4 = 0
     C                   EVAL      WBRMND = 0
     C                   EVAL      WSBILK = *BLANKS
     C                   EVAL      WSBILN = *BLANKS
     C                   EVAL      WSLK   = *BLANKS
     C                   EVAL      WSHENG = *BLANKS
     C                   EVAL      WSLKH  = *BLANKS
     C                   EVAL      WBKNT2 = 0
     C                   EVAL      WSNAT  = *BLANKS
     C                   EVAL      WBSJA1 = 0
     C                   EVAL      WSSJN1 = *BLANKS
     C                   EVAL      WBSJA2 = 0
     C                   EVAL      WSSJN2 = *BLANKS
     C                   EVAL      WBDT   = 0
     C                   EVAL      WBTM   = 0
     C                   EVAL      WSSTEF = *BLANKS
     C                   EVAL      WSLKFR = *BLANKS
     C                   EVAL      WSSDF  = *BLANKS
     C                   EVAL      WBDTT  = 0
     C                   EVAL      WBTMT  = 0
     C                   EVAL      WSSTET = *BLANKS
     C                   EVAL      WSLKTO = *BLANKS
     C                   EVAL      WSSDT  = *BLANKS
     C                   EVAL      WSTVAL = *BLANKS
     C                   EVAL      WSTAKO = *BLANKS
     C                   EVAL      WBTBEL = 0
      *
     C                   endsr
      *
N04   *=====================================================================******
N04   *  SRSUMVKT
N04   *=====================================================================******
N04  C     SRSUMVKT      begsr
N04   *
N04  C                   MOVE      *ZEROS        XTURANT           5 0
S09  C*                  MOVE      *ZEROS        XTURNT            7 0
N09  C                   MOVE      *ZEROS        XTURNT            8 0
S09  C*                  MOVE      *ZEROS        XTURVKT           9 0
N09  C                   MOVE      *ZEROS        XTURVKT          10 0
N04  C                   MOVE      *ZEROS        XTURM3            9 3
N04   *
N04  C     WBTUR         SETLL     HEAD14
N04  C     WBTUR         READE     HEAD14                                 33
N04  C                   DOW       *IN33 = *OFF
N04  C                   EVAL      XTURANT = XTURANT + 1
N04  C                   EVAL      XTURNT  = XTURNT  + HENT
N04  C                   EVAL      XTURVKT = XTURVKT + HEVKT
N04  C                   EVAL      XTURM3  = XTURM3  + HEM3
N04  C     WBTUR         READE     HEAD14                                 33
N04  C                   ENDDO
N04   *
N04  C     WBTUR         CHAIN     TURER14                            33
N04  C                   EVAL      TUAO = XTURANT
S09  C*                  IF        XTURNT > 99999 or XTURNT < -99999
S09  C*                  EVAL      TUTS = 99999
N09  C                   IF        XTURNT > 9999999 or XTURNT < -9999999
N09  C                   EVAL      TUTS = 9999999
N04  C                   ELSE
N04  C                   EVAL      TUTS = XTURNT
N04  C                   END
S09  C*                  IF        XTURVKT > 99999 or XTURVKT < -99999
S09  C*                  EVAL      TUTVKT = 99999
N09  C                   IF        XTURVKT > 999999999 or XTURVKT < -999999999
N09  C                   EVAL      TUTVKT = 999999999
N04  C                   ELSE
N04  C                   EVAL      TUTVKT = XTURVKT
N04  C                   END
S09  C*                  IF        XTURM3 > 999.99 or XTURM3 < -999.99
S09  C*                  EVAL      TUTM3 = 999.99
N09  C                   IF        XTURM3 > 9999.999 or XTURM3 < -9999.999
N09  C                   EVAL      TUTM3 = 9999.999
N04  C                   ELSE
N04  C                   EVAL      TUTM3 = XTURM3
N04  C                   END
N04  C  N33              UPDATE    TURERR
N04   *
N04  C                   ENDSR
N04   *
      *=====================================================================******
      *  SRGET
      *=====================================================================******
     C     SRGET         begsr
      *
     C     WBTUR         CHAIN(N)  TURER14                            33
     C                   IF        TUST <> ' '
     C                   EXSR      SREND
     C                   GOTO      SRGETEND
     C                   END
N04   *
N04  C                   EXSR      SRSUMVKT
N04   *
     C                   EVAL      WSLSH  = TUSTEF
     C                   EVAL      WSLOH  = TUSTET
     C                   EVAL      WSBLNR = TUBLNR
     C                   EVAL      WSBLORR = TUBLORR
N11  C                   EVAL      WSSVC  = TUAD3T
     C                   EVAL      WSTR   = TUTR
     C                   EVAL      WSBNV  = TUBNV
     C                   EVAL      WSCON1 = TUCON1
     C                   EVAL      WSCKD1 = TUCKD1
     C                   EVAL      WSTST4 = TUTST4
     C                   EVAL      WBETD  = TUETD
     C                   EVAL      WBETA  = TUETA
     C                   EVAL      WBATD  = TUATD
     C                   EVAL      WBATA  = TUATA
      *
     C                   EVAL      WBRAR4 = TURAR4
     C                   EVAL      WBRMND = TURMND
     C                   EVAL      WSBILK = TUBILK
     C                   EVAL      WSBILN = TUBILN
     C                   EVAL      WSLK   = TULK
     C                   EVAL      WSHENG = TUHENG
     C                   EVAL      WSLKH  = TULKH
     C                   EVAL      WBKNT2 = TUKNT2
     C                   EVAL      WSNAT  = TUNAT
     C                   EVAL      WBSJA1 = TUSJA1
     C                   EVAL      WSSJN1 = TUSJN1
     C                   EVAL      WBSJA2 = TUSJA2
     C                   EVAL      WSSJN2 = TUSJN2
     C                   EVAL      WBDT   = TUDT
     C                   EVAL      WBTM   = TUTM
     C                   EVAL      WSSTEF = TUSTEF
     C                   MOVEL     TUSONF        WSLKFR
     C                   EVAL      WSSDF  = TUSDF
     C                   EVAL      WBDTT  = TUDTT
     C                   EVAL      WBTMT  = TUTMT
     C                   EVAL      WSSTET = TUSTET
     C                   MOVEL     TUSONT        WSLKTO
     C                   EVAL      WSSDT  = TUSDT
     C                   EVAL      WSTVAL = TUTVAL
     C                   EVAL      WSTAKO = TUTAKO
     C                   EVAL      WBTBEL = TUTBEL
      *
     C     SRGETEND      ENDSR
      *
      *=====================================================================******
      *  TESTB1
      *=====================================================================******
     C     TESTB1        begsr
      *
     C                   IF        WSLSH <> *BLANKS
     C     WSLSH         CHAIN     STED2                              33
     C                   IF        *IN33
     C                   MOVEL     FEIL01        FEILMELDING
     C                   MOVE      '01'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      *
     C                   IF        WSLOH <> *BLANKS
     C     WSLOH         CHAIN     STED2                              33
     C                   IF        *IN33
     C                   MOVEL     FEIL02        FEILMELDING
     C                   MOVE      '02'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      *
     C                   IF        WSBNV = *BLANKS
     C                   MOVEL     FEIL03        FEILMELDING
     C                   MOVE      '03'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
      *
     C                   IF        WBETD <> 0
     C                   MOVE      WBETDD        UDD               2 0
     C                   MOVE      WBETDM        UMM               2 0
     C                   MOVE      WBETDÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL04        FEILMELDING
     C                   MOVE      '04'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      *
S06  C*                  IF        WBETA <> 0
N06  C                   IF        WBETA <> 0 OR WBATD <> 0
     C                   MOVE      WBETAD        UDD               2 0
     C                   MOVE      WBETAM        UMM               2 0
     C                   MOVE      WBETAÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL05        FEILMELDING
     C                   MOVE      '05'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      *
     C                   IF        WBATD <> 0
*TMP*C*TMP*              IF        WBATD > XIDAG
*TMP*C*TMP*              Z-ADD     1             UFLAGG
*TMP*C*TMP*              ELSE
     C                   MOVE      WBATDD        UDD               2 0
     C                   MOVE      WBATDM        UMM               2 0
     C                   MOVE      WBATDÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
*TMP*C*TMP*              END
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL06        FEILMELDING
     C                   MOVE      '06'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
N10  C                   EVAL      WSTST4 = 'X'
     C                   ENDIF
      *
     C                   IF        WBATA <> 0
     C                   IF        WBATA > XIDAG
     C                   Z-ADD     1             UFLAGG
     C                   ELSE
     C                   MOVE      WBATAD        UDD               2 0
     C                   MOVE      WBATAM        UMM               2 0
     C                   MOVE      WBATAÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   END
     C     UFLAGG        IFEQ      1
     C                   MOVEL     FEIL07        FEILMELDING
     C                   MOVE      '07'          FMELDNR
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
      * TEST OM ÅRSAK ER GITT
     C     WBTUR         SETLL     HEAD14
     C     WBTUR         READE     HEAD14                                 33
     C  N33TRACKTK       CHAIN(N)  TRACKT                             33
     C  N33              IF        (((((TXETAD <> 0) AND (TXETAD <> WBETA)) OR
     C                                ((TXETDD <> 0) AND (TXETDD <> WBETD))) OR
     C                                ((TXATAD <> 0) AND (TXATAD <> WBATA))) OR
     C                                ((TXATDD <> 0) AND (TXATDD <> WBATD)))
     C                   IF        WSEDRE = *BLANKS
     C                   MOVEL     FEIL10        FEILMELDING
     C                   MOVE      '10'          FMELDNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C                   IF        ((WSCON1 = *BLANKS) AND (WSCKD1 <> *BLANKS))
     C                   EVAL      FEILMELDING = FEIL08
     C                   EVAL      FMELDNR     = '08'
     C                   GOTO      SLTB1
     C                   END
      *
     C                   IF        ((WSCKD1 <> *BLANKS) OR (WSCON1 <> *BLANKS))
     C     WSCKD1        CHAIN     CDCON4                             33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL09
     C                   EVAL      FMELDNR     = '09'
     C                   GOTO      SLTB1
     C                   END
     C                   END
      *
     C*                  IF        WSTST4 = 'X'                                 1<-B
     C                   IF        WSTST4 = 'X' AND                             1<-B
     C                             (WSBLNR = *BLANKS OR WSCON1 = *BLANKS)
     C                   IF        WSBLNR = *BLANKS
     C                   MOVE      'N'           XBLNROK           1
     C                   ELSE
     C                   MOVE      'J'           XBLNROK
     C                   END
     C                   IF        WSCON1 = *BLANKS
     C                   MOVE      'N'           XCONTOK           1
     C                   ELSE
     C                   MOVE      'J'           XCONTOK
     C                   END
     C     WBTUR         SETLL     HEAD14
     C     WBTUR         READE(N)  HEAD14                                 33
     C                   DOW       *IN33 = *OFF                                  2<-B
     C     BILLOFK       CHAIN(N)  BILLOF                             33
      * SJEKK OM BL-NR FINNES. n = MINST ET OPPDRAG UTEN BL-NR
     C  N33              SELECT                                                   3<-B
     C                   WHEN      XBLNROK = 'N' AND BLBLNR = *BLANKS             3
     C                   MOVE      'n'           XBLNROK
     C                   WHEN      XBLNROK = 'j' AND BLBLNR = *BLANKS             3
     C                   MOVE      'n'           XBLNROK
     C                   WHEN      XBLNROK = 'N' AND BLBLNR <> *BLANKS            3
     C                   MOVE      'j'           XBLNROK
     C                   ENDSL                                                    3<-E
      * SJEKK OM CONTAINERNR FINNES. n = MINST ET OPPDRAG UTEN CONTAINERNR
     C  N33              IF        XCONTOK = 'N' OR XCONTOK = 'j'                 3<-B
     C     BILLOFK       CHAIN(N)  BLV1                               33
     C                   SELECT                                                    4<-B
     C                   WHEN      *IN33                                           4
     C                   MOVE      'n'           XCONTOK
     C                   WHEN      *IN33 = *OFF AND BVMN = *BLANKS                 4
     C                   MOVE      'n'           XCONTOK
     C                   OTHER                                                     4
     C                   MOVE      'j'           XCONTOK
     C                   ENDSL                                                     4<-E
     C                   END                                                      3<-E
     C     WBTUR         READE(N)  HEAD14                                 33
     C                   ENDDO                                                   2<-E
     C                   IF        XCONTOK = 'N' OR XCONTOK = 'n'                2<-B
     C                   MOVEL     FEIL11        FEILMELDING
     C                   MOVE      '12'          FMELDNR
     C                   GOTO      SLTB1
     C                   END                                                     2<-E
     C                   IF        XBLNROK = 'N' OR XBLNROK = 'n'                2<-B
     C                   MOVEL     FEIL11        FEILMELDING
     C                   MOVE      '11'          FMELDNR
     C                   GOTO      SLTB1
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLTB1         ENDSR
      *
      *=====================================================================******
      *  TESTB1LT
      *=====================================================================******
     C     TESTB1LT      begsr
      *
      * TESTER PERIODE  (26 ON=STATUS ULIK ' ' - PROTECT/IKKE TEST)
     C                   IF        ((WBRMND < 1) AND (WBRMND > 12))
     C                   EVAL      FEILMELDING = FEIL21
     C                   EVAL      FMELDNR     = '21'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C     WBRAR4        SUB       XIÅR          DIFFYE            4 0
     C     DIFFYE        IFLT      -1
     C     DIFFYE        ORGT      1
     C                   EVAL      FEILMELDING = FEIL21
     C                   EVAL      FMELDNR     = '21'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C     KODTÅK        CHAIN     KODTÅ                              33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL22
     C                   EVAL      FMELDNR     = '22'
     C                   GOTO      SLTB1LT
     C                   END
      *
      * TESTER BILNUMMER
      *
     C     WSBILN        CHAIN     UNITL01                            33
     C                   IF        *IN33
     C                   IF        WSBILK = *BLANKS
     C                   EVAL      FEILMELDING = FEIL23
     C                   EVAL      FMELDNR     = '23'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C                   ELSE
      *
     C                   MOVE      UNTRME        WSBILK
     C                   IF        WBKNT2 = 0
     C                   MOVE      UNTRAN        WBKNT2
     C                   END
     C     UNPDA         IFEQ      'PDA:'
     C     UNSJNR        ANDGT     '00000000'
     C     UNSJNR        ANDLT     '99999999'
     C     WSSJN1        ANDEQ     *BLANKS
     C                   MOVE      UNSJNR        WSSJA1
     C                   END
     C                   MOVE      UNLAND        WSLK
     C                   MOVE      UNRUND        GMRUND            8 0
     C     UNTILH        IFNE      *BLANKS
     C     WSHENG        ANDEQ     *BLANKS
     C                   MOVE      UNTILH        WSHENG
     C                   END
      *
     C                   END
      *
      * LEGGER OVER HENGER
     C     WSHENG        CHAIN     UNITL01                            33
     C                   IF        *IN33 = *OFF
      * "HENGER" ER STEDSKODE BETYR AT DET ER RUTENR DISTRIBUSJON.
      * LEGG RUTE I FRA/TIL STEDSKODE, DAGENS DATO I FRA/TIL DATO
     C                   MOVEL     WSHENG        ST2KOD
     C     ST2KOD        CHAIN     STED2                              33
     C     *IN33         IFEQ      '0'                                           HENGER=RUTE
     C     WSSTEF        IFEQ      *BLANKS
     C                   MOVE      ST2KOD        WSSTEF
     C                   MOVE      ST2LK         WSLKFR
     C                   END
     C     WSSTET        IFEQ      *BLANKS
     C                   MOVE      ST2KOD        WSSTET
     C                   MOVE      ST2LK         WSLKTO
     C                   END
     C     WSDT          IFEQ      *ZEROS
     C                   MOVE      WSDT          WSDT
     C                   END
     C     WSDTT         IFEQ      *ZEROS
     C                   MOVE      WSDTT         WSDTT
     C                   END
     C                   END
      *
     C                   END
      *
      *** TEST LANDKODE BIL
      *
     C                   MOVE      WSLK          KLKLK
     C     KODTLKK       CHAIN     KODTLK                             33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL24
     C                   EVAL      FMELDNR     = '24'
     C                   GOTO      SLTB1LT
     C                   END
      *
      *** TEST LANDKODE HENGER
      *
     C     WSHENG        IFNE      *BLANKS
     C     WSLKH         IFEQ      *BLANKS
     C                   MOVE      WSLK          WSLKH
     C                   END
     C                   MOVE      WSLKH         KLKLK
     C     KODTLKK       CHAIN     KODTLK                             33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL25
     C                   EVAL      FMELDNR     = '25'
     C                   GOTO      SLTB1LT
     C                   END
     C                   END
      *
      *          TESTER BILKODE
      * GJØRES NOE SENERE DA DENNE HENTES FRA BIL
      *
     C     WSBILK        CHAIN     BILK                               33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL26
     C                   EVAL      FMELDNR     = '26'
     C                   GOTO      SLTB1LT
     C                   END
      *
      *
      * TEST TRANSPORTØR
      *
      * FLYTTET SOM EGEN SR
     C                   MOVE      *BLANKS       WSAD1T           30
     C                   MOVE      *BLANKS       WSAD2T           30
     C                   MOVE      *BLANKS       WSAD3T           30
     C                   MOVE      WBKNT2        KUNDNR
     C     CUNDL01K      CHAIN     TRAN                               33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL27
     C                   EVAL      FMELDNR     = '27'
     C                   GOTO      SLTB1LT
     C                   ELSE
      * FEILMELDING DERSOM STOPPKODE SATT
     C     VMSTOP        IFEQ      'J'
     C     VMSTOP        OREQ      'Y'
     C                   EVAL      FEILMELDING = FEIL28
     C                   EVAL      FMELDNR     = '28'
     C                   GOTO      SLTB1LT
     C                   END
     C                   MOVE      VMNAVN        WSNAT
      * HENT FULLSTENDIG NAVN/ADR VIA KUNDENR.
     C                   MOVE      VMTRKU        KUNDNR
     C     CUNDL01K      CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      ADR1          WSAD1T
     C                   MOVE      ADR2          WSAD2T
     C                   MOVE      *BLANKS       WSAD3T
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSAD3T
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3T
     C                   MOVE      ADR3          WSAD3T
     C                   END
     C                   END
     C                   END
      *
      *  TEST SJÅFØR 1
      *
     C     WBSJA1        IFNE      *ZEROS
     C     WBSJA1        CHAIN     DRIV                               33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL29
     C                   EVAL      FMELDNR     = '29'
     C                   GOTO      SLTB1LT
     C                   ELSE
     C                   MOVE      DRNAVN        WSSJN1
     C                   END
     C                   ELSE
     C     VMINCR        IFEQ      2
     C     WSSJN1        ANDEQ     *BLANKS
     C                   EVAL      FEILMELDING = FEIL29
     C                   EVAL      FMELDNR     = '29'
     C                   GOTO      SLTB1LT
     C                   END
     C                   END
      *
      *  TEST SJÅFØR 2
      *
     C     WBSJA2        IFNE      *ZEROS
     C     WBSJA2        CHAIN     DRIV                               33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL30
     C                   EVAL      FMELDNR     = '30'
     C                   GOTO      SLTB1LT
     C                   ELSE
     C                   MOVE      DRNAVN        WSSJN2
     C                   END
     C                   END
      *
      *** TEST DATO  FRA
      *
     C                   MOVE      WBDTÅ         UÅÅ               2 0
     C                   MOVE      WBDTM         UMM               2 0
     C                   MOVE      WBDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   IF        UFLAGG = 1
      * GODTAR 0 VED NY TUR
     C                   IF        ((WBDT <> 0) OR (TUAO <> 0))
     C                   EVAL      FEILMELDING = FEIL31
     C                   EVAL      FMELDNR     = '31'
     C                   GOTO      SLTB1LT
     C                   END
     C                   END
      *
     C                   IF        ((WSSTEF <> *BLANKS) AND (WSLKFR = *BLANKS))
     C                   MOVE      FILAND        WSLKFR
     C                   END
      * TEST/HENT STED FRA
     C     WSLKFR        IFEQ      *BLANKS
     C     WSSTEF        CHAIN     STED2                              33
     C  N33              MOVEL     ST2LK         WSLKFR
     C                   ELSE
     C     ST2DFK        CHAIN     STED2D                             33
     C                   END
      * GODTAR BLANKT STED VED NYTT OPPDRAG
     C   33WSSTEF        IFEQ      *BLANKS
     C     TUAO          COMP      *ZEROS                             3333
     C  N33              MOVE      *BLANKS       ST2NVN
     C  N33              MOVE      *BLANKS       ST2SOL
     C  N33              MOVE      *BLANKS       ST2LK
     C                   END
     C                   MOVE      *BLANKS       WSSDF
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL32
     C                   EVAL      FMELDNR     = '32'
     C                   GOTO      SLTB1LT
     C                   ELSE
     C                   MOVEL     ST2NVN        WSSDF
     C                   MOVE      ST2SOL        WSSONF            5
     C                   MOVEL     ST2LK         WSSONF
     C                   END
      *** TEST DATO  TIL
     C                   MOVE      WBDTTÅ        UÅÅ               2 0
     C                   MOVE      WBDTTM        UMM               2 0
     C                   MOVE      WBDTTD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   IF        UFLAGG = 1
      * GODTAR 0 VED NY TUR
     C                   IF        ((WBDTT <> 0) OR (TUAO <> 0))
     C                   EVAL      FEILMELDING = FEIL33
     C                   EVAL      FMELDNR     = '33'
     C                   GOTO      SLTB1LT
     C                   END
     C                   END
      *
      * FRADAT IKKE STØRRE ENN TILDAT
      *
     C                   IF        WSDT > WSDTT
     C                   EVAL      FEILMELDING = FEIL34
     C                   EVAL      FMELDNR     = '34'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C                   IF        ((WSSTET <> *BLANKS) AND (WSLKTO = *BLANKS))
     C                   MOVE      FILAND        WSLKTO
     C                   END
      * TEST/HENT STED TIL
     C     WSLKTO        IFEQ      *BLANKS
     C     WSSTET        CHAIN     STED2                              33
     C  N33              MOVEL     ST2LK         WSLKTO
     C                   ELSE
     C     ST2DTK        CHAIN     STED2D                             33
     C                   END
     C   33WSSTET        IFEQ      *BLANKS
     C     TUAO          COMP      *ZEROS                             3333
     C  N33              MOVE      *BLANKS       ST2SOL
     C  N33              MOVE      *BLANKS       ST2NVN
     C  N33              MOVE      *BLANKS       ST2LK
     C                   END
     C                   MOVE      *BLANKS       WSSDT
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL35
     C                   EVAL      FMELDNR     = '35'
     C                   GOTO      SLTB1LT
     C                   ELSE
     C                   MOVEL     ST2NVN        WSSDT
     C                   MOVE      ST2SOL        WSSONT            5
     C                   MOVEL     ST2LK         WSSONT
     C                   END
      *
      * TESTER VALUTAKODE
      *
     C                   IF        WBTBEL <> 0
      *
     C                   IF        WSTVAL = *BLANKS
     C                   MOVE      FICURR        WSTVAL
     C                   END
      *
     C     WSTAKO        IFEQ      *BLANKS
     C                   MOVE      'A'           WSTAKO
     C                   END
      *
     C     VALKEY        CHAIN     VALUL01                            33
     C                   IF        *IN33
     C                   EVAL      FEILMELDING = FEIL36
     C                   EVAL      FMELDNR     = '36'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C                   IF        ((WSTAKO <> 'A') AND (WSTAKO <> 'E'))
     C                   EVAL      FEILMELDING = FEIL37
     C                   EVAL      FMELDNR     = '37'
     C                   GOTO      SLTB1LT
     C                   END
      *
     C                   END
      *
     C     SLTB1LT       ENDSR
      *
      *=====================================================================******
      *  SRUPD
      *=====================================================================******
     C     SRUPD         begsr
     C                   IF        WBTUR = 0
     C                   CLEAR                   TURERR
     C     TEAVD         CHAIN     TELL                               33
     C                   MOVE      TETURN        WBTUR
     C                   ADD       1             TETURN
     C                   UPDATE    TELLR
     C                   ELSE
     C     WBTUR         CHAIN     TURER14                            33
     C                   END
      *
     C                   MOVE      '*PM'         TUSG
S08  C*                  MOVE      BIKUNR        TUKNA
N08  C                   MOVE      BSKN          TUKNA
     C                   MOVE      WSLSH         TUSTEF
     C                   MOVE      WSLOH         TUSTET
     C                   MOVE      WSBLNR        TUBLNR
     C                   IF        WSBLORR = TUBLORR
     C                   MOVE      'N'           XOPDORR           1
     C                   ELSE
     C                   MOVE      'J'           XOPDORR
     C                   END
N11  C                   IF        TUAD3T = WSSVC
N11  C                   MOVE      'N'           XOPDSVC
N11  C                   ELSE
N11  C                   EVAL      TUAD3T = WSSVC
N11  C                   MOVE      'J'           XOPDSVC           1
N11  C                   END
     C                   MOVE      WSBLORR       TUBLORR
     C                   MOVE      WSTR          TUTR
     C                   MOVE      WSBNV         TUBNV
     C                   MOVE      WSCON1        TUCON1
     C                   MOVE      WSCKD1        TUCKD1
      *
     C                   IF        (WSTST4 = 'X' AND TUTST4 <> 'X') OR
     C                             (WSTST4 <> 'X' AND TUTST4 = 'X')
     C                   MOVE      'J'           XORDCOMP          1
     C                   IF        WSTST4 = 'X'
     C                   EVAL      UUNYST = '3'
     C                   ELSE
     C                   EVAL      UUNYST = '2'
     C                   END
     C                   ELSE
     C                   MOVE      'N'           XORDCOMP
     C                   END
N05   *
N05   * SEND ASN ??
N05  C                   MOVE      'N'           XFUNKS40          1
N05  C                   MOVE      'N'           XFUNKS50          1
s07  C*                  IF        TUKNA = 12497 OR (BIFIRM='SY' AND TUKNA=7032)
N07  C                   IF        TUKNA = 12497 OR TUKNA = 21647
N05  C                   IF        WBATD <> 0 AND WBATD <> TUATD
N05  C                   EVAL      XFUNKS40 = 'J'
N05  C                   END
N05  C                   IF        WBATA <> 0 AND WBATA <> TUATA
N05  C                   EVAL      XFUNKS50 = 'J'
N05  C                   END
N05  C                   END
      *
     C                   MOVE      WSTST4        TUTST4
     C                   MOVE      WBATD         TUATD
     C                   MOVE      WBATA         TUATA
     C                   MOVEL     WBETD         TUETD
     C                   MOVEL     WBETA         TUETA
      * fra POMS -> Ecare   sign fra *PM -> WEB
     c                   IF        WBATD <> 0
     c                   eval      TUSG = 'WEB'
     c                   endif
      *
     C                   IF        TUPRO = 0
     C                   MOVE      TEAVD         TUAVD
     C                   MOVE      WBTUR         TUPRO
     C                   WRITE     TURERR
     C                   ELSE
     C                   UPDATE    TURERR
     C                   END
      *
     C     WBTUR         SETLL     HEAD14
     C     WBTUR         READE     HEAD14                                 33
     C                   DOW       *IN33 = *OFF
      * OPPDATER NY OPPDRAGSTYPE
     C                   IF        WBATA <> 0
     C                   call      'ESOVERS4C'
     C                   parm                    HEAVD
     C                   parm                    HEOPD
     C                   parm                    BIFIRM
     C                   parm                    BIBRID
     C                   END
N03   *
N03  C     BILLOFK       CHAIN     BILLOF                             33
N03  C                   IF        *IN33 = *OFF
N03  C                   MOVE      WSLSH         BLLSH
N03  C                   MOVE      WSLOH         BLLOH
N03  C                   UPDATE    BILLOFR
N03  C                   END
      *
     C                   IF        ((WSBLNR <> *BLANKS) OR (WSCON1 <> *BLANKS))
     C     BILLOFK       CHAIN     BILLOF                             33
     C                   IF        *IN33 = *OFF
     C                   IF        WSBLNR <> *BLANKS
     C                   EVAL      BLBLNR = WSBLNR
     C                   END
     C                   IF        ((WSBLORR <> *BLANKS) AND (XOPDORR = 'J'))
     C                   EVAL      BLCH = WSBLORR
     C                   END
     C                   IF        WSTR <> *BLANKS
     C                   EVAL      BLTR = WSTR
     C                   END
     C                   MOVE      WBATD         BLDLOS
     C                   MOVE      WBATA         BLDTA
     C                   UPDATE    BILLOFR
     C                   END
N11   *
N11  C                   IF        XOPDSVC = 'J'
N11  C     FRISOKKSVC    KLIST
N11  C                   KFLD                    HEAVD
N11  C                   KFLD                    HEOPD
N11  C                   KFLD                    SVC_FSKODE
N11  C     *LIKE         DEFINE    FSKODE        SVC_FSKODE
N11  C                   EVAL      SVC_FSKODE = 'SVC'
N11  C     FRISOKKSVC    CHAIN     FRISOK                             33
N11  C                   EVAL      FSSOK  = WSSVC
N11  C                   EVAL      FSDTOP = HEDTOP
N11  C                   SELECT
N11  C                   WHEN      *IN33 = *OFF AND WSSVC <> *BLANKS
N11  C                   UPDATE    FRISOKR
N11  C                   WHEN      *IN33 = *OFF AND WSSVC = *BLANKS
N11  C                   DELETE    FRISOKR
N11  C                   WHEN      *IN33 AND WSSVC <> *BLANKS
N11  C                   EVAL      FSAVD  = HEAVD
N11  C                   EVAL      FSOPD  = HEOPD
N11  C                   EVAL      FSKODE = 'SVC'
N11  C                   WRITE     FRISOKR
N11  C                   WHEN      *IN33 AND WSSVC = *BLANKS
N11  C                   ENDSL
N11  C                   END
N11   *
     C  N33              IF        WSCON1 <> *BLANKS
     C     BILLOFK       CHAIN     BLV1                               33
     C                   EVAL      BVMN   = WSCON1
     C                   EVAL      BVVKT  = HEVKT
     C                   EVAL      BVM3   = HEM3
     C                   IF        BVVKT  = 0
     C                   EVAL      BVNT   = 0
     C                   ELSE
     C                   EVAL      BVNT   = 1
     C                   END
     C                   EVAL      BVKDC  = WSCKD1
     C     BVKDC         CHAIN     CDCON4                             34
     C                   EVAL      BVVS   = CC4FT
      *
     C                   IF        *IN33
     C                   EVAL      BVAVD  = BLAVD
     C                   EVAL      BVOPD  = BLOPD
     C                   EVAL      BVLI   = 1
     C                   EVAL      BVSORT = 10
     C                   WRITE     BLV1R
     C                   ELSE
     C                   UPDATE    BLV1R
     C                   END
     C                   END
     C                   END
      *
     C     TRACKTK       CHAIN     TRACKT                             33
     C                   IF        *IN33 = *OFF
     C                   EXSR      OPDLOG
cc   c                   IF        WBETA <> TXETAD
cc   c                             or WBETD <> TXETDD
cc   c                             or WBATA <> TXATAD
cc   c                             or WBATD <> TXATDD
N02  C                   EVAL      POMSDS1  = *BLANKS
N02  C                   EVAL      P1WSEDRE = WSEDRE
N02  C                   EVAL      POMSDS   = POMSDS1
cc   c                   call      'EPOMS41'
cc   c                   parm                    HEAVD
cc   c                   parm                    HEOPD
cc   c                   parm      WBETD         UUETD             8 0
cc   c                   parm      WBETA         UUETA             8 0
cc   c                   parm      WBATD         UUATD             8 0
cc   c                   parm      WBATA         UUATA             8 0
cc   c                   parm                    POMSDS          256
cc   c                   endif
     C                   MOVE      WBETD         TXETDD
     C                   MOVE      WBETA         TXETAD
     C                   MOVE      WBATD         TXATDD
     C                   MOVE      WBATA         TXATAD
     C                   UPDATE    TRACKTR
     C                   END
      *
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      WBATD         TRSDFD
     C                   MOVE      WBATA         TRSDTD
N03  C                   MOVE      WSLSH         HESDF
N03  C                   MOVE      WSLOH         HESDT
     C                   UPDATE    HEADFR
      * OPPDATER ORDRE
     C                   IF        XORDCOMP = 'J'
     C                   CALL      'EPOMS42'
     C                   PARM      HEAVD         UUAVD             4 0
     C                   PARM      HEOPD         UUOPD             7 0
     C                   PARM                    UUNYST            5
     C                   END
N05   * SEND ASNSTS TIL EUROPRIS
N07  C     HEADFK        CHAIN     EPOPOS                             33
N07  C                   IF        *IN33 = *OFF
N05  C                   IF        XFUNKS40 = 'J'
N07  C                   SELECT
N07  C                   WHEN      TUKNA = 12497
N05  C                   MOVE      HEAVD         UAVDASN           4
N05  C                   MOVE      HEOPD         UOPDASN           7
N05  C                   MOVE      '40'          USTSASN           2
N05  C                   CALL      'EUR04CL'
N05  C                   PARM                    UAVDASN
N05  C                   PARM                    UOPDASN
N05  C                   PARM                    USTSASN
N07  C                   WHEN      TUKNA = 21647
N07  C                   CALL      'EPOMS53R'
N07  C                   PARM                    HEAVD
N07  C                   PARM                    HEOPD
N07  C                   ENDSL
N05  C                   END
N05  C                   IF        XFUNKS50 = 'J'
N07  C                   SELECT
N07  C                   WHEN      TUKNA = 12497
N05  C                   MOVE      HEAVD         UAVDASN           4
N05  C                   MOVE      HEOPD         UOPDASN           7
N05  C                   MOVE      '50'          USTSASN           2
N05  C                   CALL      'EUR04CL'
N05  C                   PARM                    UAVDASN
N05  C                   PARM                    UOPDASN
N05  C                   PARM                    USTSASN
N07  C                   WHEN      TUKNA = 21647
N07  C                   CALL      'EPOMS53R'
N07  C                   PARM                    HEAVD
N07  C                   PARM                    HEOPD
N07  C                   ENDSL
N05  C                   END
N07  C                   END
      *
     C     WBTUR         READE     HEAD14                                 33
     C                   ENDDO
      *
     C     SRUPDEND      ENDSR
      *
      *=====================================================================******
      *  SRUPDLT
      *=====================================================================******
     C     SRUPDLT       begsr
     C                   IF        WBTUR = 0
     C                   CLEAR                   TURERR
     C     TEAVD         CHAIN     TELL                               33
     C                   MOVE      TETURN        WBTUR
     C                   ADD       1             TETURN
     C                   UPDATE    TELLR
     C                   ELSE
     C     WBTUR         CHAIN     TURER14                            33
     C                   END
      *
     C                   MOVE      WBRACC        TURACC
     C                   MOVE      WBRAAR        TURAAR
     C                   MOVE      WBRMND        TURMND
     C                   MOVE      WSBILK        TUBILK
     C                   MOVE      WSBILN        TUBILN
     C                   MOVE      WSLK          TULK
     C                   MOVE      WSHENG        TUHENG
     C                   MOVE      WSLKH         TULKH
     C                   MOVE      WBKNT2        TUKNT2
     C                   MOVE      WSNAT         TUNAT
     C                   MOVE      WSAD1T        TUAD1T
     C                   MOVE      WSAD2T        TUAD2T
     C                   MOVE      WSAD3T        TUAD3T
     C                   MOVE      WBSJA1        TUSJA1
     C                   MOVE      WSSJN1        TUSJN1
     C                   MOVE      WBSJA2        TUSJA2
     C                   MOVE      WSSJN2        TUSJN2
     C                   MOVE      WBDT          TUDT
     C                   MOVE      WBTM          TUTM
     C                   MOVE      WSSDF         TUSDF
     C                   MOVE      WSSTEF        TUSTEF
     C                   MOVE      WSSONF        TUSONF
     C                   MOVE      WSSDF         TUSDF
     C                   MOVE      WBDTT         TUDTT
     C                   MOVE      WBTMT         TUTMT
     C                   MOVE      WSSDT         TUSDT
     C                   MOVE      WSSTET        TUSTET
     C                   MOVE      WSSONT        TUSONT
     C                   MOVE      WSSDT         TUSDT
     C                   MOVE      WSTVAL        TUTVAL
     C                   MOVE      WSTAKO        TUTAKO
     C                   MOVE      WBTBEL        TUTBEL
      *
     C                   IF        TUPRO = 0
     C                   MOVE      TEAVD         TUAVD
     C                   MOVE      WBTUR         TUPRO
     C                   WRITE     TURERR
     C                   ELSE
     C                   UPDATE    TURERR
     C                   END
      *
     C     SRUPDENDLT    ENDSR
      *
      *=====================================================================******
      *  SREND
      *=====================================================================******
     C     SREND         begsr
      *
     C                   callp     gethtml('HTMLSRC':
     C                             '*LIBL':
     C                             'EPOMS22IC':'/CGITAG/')
     C                   callp     updHTMLvar('USER':USER)
     C                   callp     updHTMLvar('FRAMES':WSFRAMES)
     C                   callp     wrtsection('top')
     C                   exsr      Exit
     C                   eval      *inlr = *on
     C                   return
      *
     C                   endsr
      *
      *=====================================================================******
      * Send MEDLING TIL BRUKER
      *=====================================================================******
     C     SNDEMAIL      begsr
      *
     C                   Z-ADD     1024          CMDL             15 5
     C                   EVAL      SENDER = '*CURRENT'
      * Emne
     C                   Eval      EMNE = 'New trip is created '
      *
     C                   EVAL      MELD = 'New trip is created by '
     C                             + %trim(BIBRID) + '/' + %trim(BIBESK)
     C                             + ':/P:/PThis message is created '
     C                             + 'automaticly by the booking system.'
     C                             + ':/NPlease do not reply!'
      *
      * param for tointnet og longmsg må være i apostrofer ( hex 7D )
      * (strenger i single-parametere som inneholder blank el. spesialtegn)
     C                   eval      cmd = 'SNDDST TYPE(*LMSG) TOINTNET('
     C                             +'('+ X'7D' + %trim(XEPMOTT) + X'7D' +')) +
     C                             DSTD('+ X'7D' + %trim(EMNE) + X'7D' + ') +
     C                             LONGMSG('+ X'7D' + %trim(MELD) + X'7D' +') +
     C                             USRID('+  %trim(SENDER) +') SNDFMT(*NOCHG)'
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    CMD
     C                   PARM                    CMDL
      *
     C                   ENDSR
      *
      *=====================================================================******
      *  Display TRAFIKK
      *=====================================================================******
     C     DspTROB       begsr
      * TRAFIKK
     C                   callp     wrtsection('Trafictop')
      *
     C                   IF        WSTR = *BLANKS
     C                   callp     updhtmlvar('CTKD':'')
     C                   callp     updhtmlvar('CTFT':' -- blank -- ')
     C                   callp     wrtsection('Traficrow')
     C                   END
      *
     C     BIFIRM        SETLL     CDTRAFL2
     C     BIFIRM        READE     CDTRAFL2                               33
     C                   DOW       *IN33 = *OFF
     C                   callp     updhtmlvar('CTKD':CTKD)
     C                   callp     updhtmlvar('CTFT':CTFT)
     C                   IF        CTKD = WSTR
     C                   callp     updhtmlvar('SLTRSEL':'SELECTED')
     C                   else
     C                   callp     updhtmlvar('SLTRSEL':'')
     C                   END
     C                   callp     wrtsection('Traficrow')
     C     BIFIRM        READE     CDTRAFL2                               33
     C                   ENDDO
      *
      * legg på mulighet til å velge (tilbake til) kun blank når kode er valgt..
     C                   IF        WSTR <> *BLANKS
     C                   callp     updhtmlvar('SLTRSEL':'')
     C                   callp     updhtmlvar('CTKD':'  ')
     C                   callp     updhtmlvar('CTFT':' -- blank -- ')
     C                   callp     wrtsection('Traficrow')
     C                   END
     C                   callp     wrtsection('TraficBot')
      *
     C                   endsr
      *
      *=====================================================================
      *  HENT DOKUMENTER
      *=====================================================================
     C     HENTDOK       BEGSR
     C                   MOVE      *BLANKS       UPDF
     C     WBTUR         CABEQ     0             SLHENTDOK
     C                   MOVEL     'T:'          ARUNDE
     C                   MOVE      WBTUR         ARUNDE
      *
     C     ARKIVL11K     SETLL     ARKIVL11
     C     ARKIVL11K     READE     ARKIVL11                               33
     C                   MOVE      *ZEROS        XN                3 0
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN
     C                   EVAL      UPDF(XN) = '<a href="'
     C                   CAT       XBANE:0       UPDF(XN)
     C                   CAT       ARLINK:0      UPDF(XN)
     C                   CAT       '" target="':0UPDF(XN)
     C                   CAT       'SyPDFWind': 0UPDF(XN)
     C                   CAT       '">':0        UPDF(XN)
     C                   IF        ARRFK = *BLANKS
     C                   CAT       'DOC':0       UPDF(XN)
     C                   MOVE      XN            XAN               3
     C                   CAT       XAN:0         UPDF(XN)
     C                   ELSE
     C                   CAT       ARRFK:0       UPDF(XN)
     C                   END
     C                   CAT       '<img src="':0UPDF(XN)
     C                   CAT       '/syspeddev':0UPDF(XN)
     C                   CAT       '/PDF.gif"':0 UPDF(XN)
     C                   CAT       'ALT="':1     UPDF(XN)
     C                   CAT       'DOC':0       UPDF(XN)
     C                   CAT       XAN:0         UPDF(XN)
     C                   CAT       '"></a>':0    UPDF(XN)
      *
     C                   IF        ((XAUT = 'L') OR (XAGENT = 'J'))
     C                   EVAL      UPDF(XN) = %trim(UPDF(XN))
     C                             + ' <a href="#" OnClick="DltDoc('
     C                             + 'this.form,'
     C                             + %trim(XAPSTR)
     C                             + %trim(XBANE) + %trim(ARLINK)
     C                             + %trim(XAPSTR) + ',' + %trim(XAPSTR)
     C                             + %trim(ARRFK)
     C                             + %trim(XAPSTR)
     C                             + ')"> <img src="/syspeddev/DeleteX.gif"'
     C                             + ' width=13 height=13 border=0>'
     C                   END
      *
     C     XN            COMP      40                                 33  33
     C  N33ARKIVL11K     READE     ARKIVL11                               33
     C                   ENDDO
      *
     C                   MOVE      *BLANKS       ARUNDE
     C                   MOVEL     WBTUR         ARUNDE
     C                   MOVEL     WBTUR         XAN081            8
     C                   MOVE      *BLANKS       XLINKGM          40
      *
     C     ARKIVL11K     SETLL     ARKIVL11
     C     ARSTAT        READE     ARKIVL11                               33
     C  N33              MOVEL     ARUNDE        XAN082            8
     C  N33XAN081        COMP      XAN082                             3333
     C                   DOW       *IN33 = *OFF
     C                   IF        ARLINK <> XLINKGM
     C                   ADD       1             XN
     C                   EVAL      UPDF(XN) = '<a href="'
     C                   CAT       XBANE:0       UPDF(XN)
     C                   CAT       ARLINK:0      UPDF(XN)
     C     '.pdf'        SCAN      UPDF(XN)                               34
     C  N34'.PDF'        SCAN      UPDF(XN)                               34
     C  N34              CAT       '.pdf':0      UPDF(XN)
     C                   CAT       '" target="':0UPDF(XN)
     C                   CAT       'SyPDFWind': 0UPDF(XN)
     C                   CAT       '">':0        UPDF(XN)
     C                   IF        ARRFK = *BLANKS
     C                   CAT       'DOC':0       UPDF(XN)
     C                   MOVE      XN            XAN               3
     C                   CAT       XAN:0         UPDF(XN)
     C                   ELSE
     C                   CAT       ARRFK:0       UPDF(XN)
     C                   END
     C                   CAT       '<img src="':0UPDF(XN)
     C                   CAT       '/syspeddev':0UPDF(XN)
     C                   CAT       '/PDF.gif"':0 UPDF(XN)
     C                   CAT       'ALT="':1     UPDF(XN)
     C                   CAT       'DOC':0       UPDF(XN)
     C                   CAT       XAN:0         UPDF(XN)
     C                   CAT       '"></a>':0    UPDF(XN)
      *
     C                   IF        ((XAUT = 'L') OR (XAGENT = 'J'))
     C                   EVAL      UPDF(XN) = %trim(UPDF(XN))
     C                             + ' <a href="#" OnClick="DltDoc('
     C                             + 'this.form,'
     C                             + %trim(XAPSTR)
     C                             + %trim(XBANE) + %trim(ARLINK)
     C                             + %trim(XAPSTR) + ',' + %trim(XAPSTR)
     C                             + %trim(ARRFK)
     C                             + %trim(XAPSTR)
     C                             + ')"> <img src="/syspeddev/DeleteX.gif"'
     C                             + ' width=13 height=13 border=0>'
     C                   END
     C                   EVAL      XLINKGM = ARLINK
      *
     C     XN            COMP      40                                 33  33
     C                   END
      *
     C  N33ARSTAT        READE     ARKIVL11                               33
     C  N33              MOVEL     ARUNDE        XAN082            8
     C  N33XAN081        COMP      XAN082                             3333
     C                   ENDDO
      *
     C     SLHENTDOK     TAG
     C                   callp     updHTMLvar('UPDF1':UPDF1)
     C                   callp     updHTMLvar('UPDF2':UPDF2)
     C                   callp     updHTMLvar('UPDF3':UPDF3)
     C                   callp     updHTMLvar('UPDF4':UPDF4)
     C                   callp     updHTMLvar('UPDF5':UPDF5)
     C                   callp     updHTMLvar('UPDF6':UPDF6)
     C                   callp     updHTMLvar('UPDF7':UPDF7)
     C                   callp     updHTMLvar('UPDF8':UPDF8)
     C                   callp     updHTMLvar('UPDF9':UPDF9)
     C                   callp     updHTMLvar('UPDF10':UPDF10)
     C                   callp     updHTMLvar('UPDF11':UPDF11)
     C                   callp     updHTMLvar('UPDF12':UPDF12)
     C                   callp     updHTMLvar('UPDF13':UPDF13)
     C                   callp     updHTMLvar('UPDF14':UPDF14)
     C                   callp     updHTMLvar('UPDF15':UPDF15)
     C                   callp     updHTMLvar('UPDF16':UPDF16)
     C                   callp     updHTMLvar('UPDF17':UPDF17)
     C                   callp     updHTMLvar('UPDF18':UPDF18)
     C                   callp     updHTMLvar('UPDF19':UPDF19)
     C                   callp     updHTMLvar('UPDF20':UPDF20)
     C                   callp     updHTMLvar('UPDF21':UPDF21)
     C                   callp     updHTMLvar('UPDF22':UPDF22)
     C                   callp     updHTMLvar('UPDF23':UPDF23)
     C                   callp     updHTMLvar('UPDF24':UPDF24)
     C                   callp     updHTMLvar('UPDF25':UPDF25)
     C                   callp     updHTMLvar('UPDF26':UPDF26)
     C                   callp     updHTMLvar('UPDF27':UPDF27)
     C                   callp     updHTMLvar('UPDF28':UPDF28)
     C                   callp     updHTMLvar('UPDF29':UPDF29)
     C                   callp     updHTMLvar('UPDF30':UPDF30)
     C                   callp     updHTMLvar('UPDF31':UPDF31)
     C                   callp     updHTMLvar('UPDF32':UPDF32)
     C                   callp     updHTMLvar('UPDF33':UPDF33)
     C                   callp     updHTMLvar('UPDF34':UPDF34)
     C                   callp     updHTMLvar('UPDF35':UPDF35)
     C                   callp     updHTMLvar('UPDF36':UPDF36)
     C                   callp     updHTMLvar('UPDF37':UPDF37)
     C                   callp     updHTMLvar('UPDF38':UPDF38)
     C                   callp     updHTMLvar('UPDF39':UPDF39)
     C                   callp     updHTMLvar('UPDF40':UPDF40)
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     OPDLOG        BEGSR
      *////////////////////////////////////////////////////////////
      * ETA
     C                   IF        WBETA <> TXETAD
     C                   MOVE      TXAVD         TTAVD
     C                   MOVE      TXOPD         TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      WSEDRE        TTEDRE
     C                   MOVE      USER          TTUSER
     C                   EVAL      TTDEPO = 'EPOMS22'
     C                   MOVE      TXETAD        XAN08             8
     C                   EVAL      TTTEXT = 'ETA changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(WSETA) + ' by '
     C                             + %TRIM(USER)
N01  C                   EVAL      TTTEXL = 'ETA endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(WSETA) + ' av '
n01  C                             + %TRIM(USER)
     C                   WRITE     TRACKFR
     C                   END
      * ETD
     C                   IF        WBETD <> TXETDD
     C                   MOVE      TXAVD         TTAVD
     C                   MOVE      TXOPD         TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      WSEDRE        TTEDRE
     C                   MOVE      USER          TTUSER
     C                   EVAL      TTDEPO = 'EPOMS22'
     C                   MOVE      TXETDD        XAN08
     C                   EVAL      TTTEXT = 'ETD changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(WSETD) + ' by '
     C                             + %TRIM(USER)
N01  C                   EVAL      TTTEXL = 'ETD endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(WSETD) + ' av '
n01  C                             + %TRIM(USER)
     C                   WRITE     TRACKFR
     C                   END
      * ATA
     C                   IF        WBATA <> TXATAD
     C                   MOVE      TXAVD         TTAVD
     C                   MOVE      TXOPD         TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      WSEDRE        TTEDRE
     C                   MOVE      USER          TTUSER
     C                   EVAL      TTDEPO = 'EPOMS22'
     C                   MOVE      TXATAD        XAN08             8
     C                   EVAL      TTTEXT = 'ATA changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(WSATA) + ' by '
     C                             + %TRIM(USER)
N01  C                   EVAL      TTTEXL = 'ATA endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(WSATA) + ' av '
n01  C                             + %TRIM(USER)
     C                   WRITE     TRACKFR
     C                   END
      * ETD
     C                   IF        WBATD <> TXATDD
     C                   MOVE      TXAVD         TTAVD
     C                   MOVE      TXOPD         TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      WSEDRE        TTEDRE
     C                   MOVE      USER          TTUSER
     C                   EVAL      TTDEPO = 'EPOMS22'
     C                   MOVE      TXATDD        XAN08
     C                   EVAL      TTTEXT = 'ATD changed from '
     C                             + %TRIM(XAN08) + ' to '
     C                             + %TRIM(WSATD) + ' by '
     C                             + %TRIM(USER)
N01  C                   EVAL      TTTEXL = 'ATD endret fra '
n01  C                             + %TRIM(XAN08) + ' til '
n01  C                             + %TRIM(WSATD) + ' av '
n01  C                             + %TRIM(USER)
     C                   WRITE     TRACKFR
     C                   END
      * INGEN DATO ENDRING
     C                   IF        ((((WBETA = TXETAD) AND
     C                                (WBETD = TXETDD)) AND
     C                                (WBATA = TXATAD)) AND
     C                                (WBATD = TXATDD))
     C                   IF        WSEDRE <> *BLANKS
     C                   MOVE      TXAVD         TTAVD
     C                   MOVE      TXOPD         TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'CHD'         TTACTI
     C                   MOVE      USER          TTUSER
     C                   EVAL      TTDEPO = 'EPOMS22'
     C                   MOVE      WSEDRE        TTEDRE
     C                   EVAL      TTTEXT = 'New information from '
     C                             + %TRIM(USER)
N01  C                   EVAL      TTTEXL = 'Ny informasjon fra '
N01  C                             + %TRIM(USER)
     C                   WRITE     TRACKFR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRHENTSD      BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        MINDT
     C                   MOVEL     '99999999'    MINDT
     C                   MOVE      *ZEROS        MAXDT
     C     WBTUR         SETLL     HEAD14
     C     WBTUR         READE     HEAD14                                 33
     C                   DOW       *IN33 = *OFF
     C     DISPK         CHAIN     DISP                               33
     C  N33              IF        DIFRA < MINDT
     C                   MOVE      DIFRA         MINDT
     C                   MOVE      DISTEF        MINSTE
     C                   MOVEL     DISONF        MINLK
     C                   END
     C  N33DITIL         IFGT      MAXDT
     C                   MOVE      DITIL         MAXDT
     C                   MOVE      DISTET        MAXSTE
     C                   MOVEL     DISONT        MAXLK
     C                   END
     C     WBTUR         READE     HEAD14                                 33
     C                   ENDDO
      *
     C                   SELECT
     C                   WHEN      ((WSHSD = 'F') AND (MINDAT <> 99999999))
     C                   MOVE      MINDAT        WSDT
     C                   MOVE      MINTIM        WSTM
     C                   MOVE      MINSTE        WSSTEF
     C                   MOVE      MINLK         WSLKFR
     C                   IF        WSLKFR = *BLANKS
     C     WSSTEF        CHAIN     STED2                              33
     C  N33              MOVEL     ST2LK         WSLKFR
     C                   ELSE
     C     ST2DFK        CHAIN     STED2D                             33
     C                   END
     C  N33              MOVEL     ST2NVN        WSSDF
     C   33              MOVE      *BLANKS       WSSDF
     C                   WHEN      ((WSHSD = 'T') AND (MAXDAT <> 0))
     C                   MOVE      MAXDAT        WSDTT
     C                   MOVE      MAXTIM        WSTMT
     C                   MOVE      MAXSTE        WSSTET
     C                   MOVE      MAXLK         WSLKTO
     C                   IF        WSLKTO = *BLANKS
     C     WSSTET        CHAIN     STED2                              33
     C  N33              MOVEL     ST2LK         WSLKTO
     C                   ELSE
     C     ST2DTK        CHAIN     STED2D                             33
     C                   END
     C  N33              MOVEL     ST2NVN        WSSDT
     C   33              MOVE      *BLANKS       WSSDT
     C                   ENDSL
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
     C     VISREASON     BEGSR
      *////////////////////////////////////////////////////////////
      * REASON
     C                   callp     wrtsection('Reasontop')
      *
     C                   IF        WSEDRE = *BLANKS
     C                   callp     updhtmlvar('RKD':'')
     C                   callp     updhtmlvar('RFT':' -- blank -- ')
     C                   callp     wrtsection('Reasonrow')
     C                   END
      *
     C                   MOVE      *ZEROS        XN                3 0
     C                   MOVEL     'OSREA'       PAID
     C                   MOVE      BIBRID        PABRID
     C     BRPARFK       CHAIN     BRPARF                             33
     c   33              Eval      PABRID = '*KUNDFT*'+BIFIRM
     C   33BRPARFK       CHAIN     BRPARF                             33
     C                   DOW       *IN33 = *OFF
     C                   ADD       1             XN
     C                   MOVEL     PAVRDA        XAN03             3
     C                   callp     updhtmlvar('RKD':XAN03)
     C                   callp     updhtmlvar('RFT':PAVRDA)
     C                   IF        XAN03 = WSEDRE
     C                   callp     updhtmlvar('SLREASON':'SELECTED')
     C                   else
     C                   callp     updhtmlvar('SLREASON':'')
     C                   END
     C                   callp     wrtsection('Reasonrow')
     C     BRPARFK       READE     BRPARF                                 33
     C                   ENDDO
      *
      * legg på mulighet til å velge (tilbake til) kun blank når kode er valgt..
     C                   callp     wrtsection('ReasonBot')
      *
     C                   ENDSR
      *
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          begsr
     C                   OPEN      BRIDF
     C     USER          CHAIN(N)  BRIDF                              50
     C* En "standardvariant" libl: call bound (INCGI=*MODULE) med parameter.
     C     BILIBL        ifeq      *blanks
     C                   callb     'INCGI'
     C                   parm                    BISTDL
     C                   else
     C* Helt egen bibl.liste satt på user - normal CALL (BILIBL er "*pgm")
     C                   call      BILIBL
     C                   end
      *
OddEv * hent Parametre som går igjen i mange prog:
OddEv *      Odd/Even/Rowhead-farger,Logobilde,Språk,Intern/Ekstern bruker,  mm
OddEvc                   call      'ESGETPAR'
OddEvc                   parm                    BIBRID
OddEvc                   parm                    BIFIRM
OddEvc                   parm                    BIKUNR
OddEvc                   parm                    BIKNG
OddEvc                   parm                    RowHead          10
OddEvc                   parm                    Odd              10
OddEvc                   parm                    Even             10
OddEvc                   parm                    LogoImg          50
OddEvc                   parm                    XSPRÅK            2
OddEvc                   parm                    XINTERN           1
OddEvc                   parm                    ParmDS1        1024
OddEvc                   parm                    ParmDS2        1024
OddEvc                   parm                    ParmDS3        1024
      *
N11  C                   OPEN      FRISOK
     C                   OPEN      TURER14
     C                   OPEN      HEAD14
     C                   OPEN      HEADF
     C                   OPEN      DISP
     C                   OPEN      BILLOF
     C                   OPEN      BLV1
N03  C                   OPEN      EPOH02
N03  C                   OPEN      EPOL02
N07  C                   OPEN      EPOPOS
     C                   OPEN      TRACKT
     C                   OPEN      TRACKF
     C                   OPEN      CDTRAFL2
     C                   OPEN      CDCON4
     C                   OPEN      STED2
     C                   OPEN      TELL
     C                   OPEN      BRPARF
     C                   OPEN      FIRMARC
     C                   OPEN      ARKTXT
     C                   OPEN      ARKEXT
     C                   OPEN      ARKIVL11
     C                   OPEN      FIRM
     C                   OPEN      BILK
     C                   OPEN      DRIV
     C                   OPEN      KODTLK
     C                   OPEN      KODTÅ
     C                   OPEN      STED2D
     C                   OPEN      UNITL01
     C                   OPEN      CUNDL01
     C                   OPEN      TRAN
     C                   OPEN      VALUL01
      *
     C     DISPK         klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     HEADFK        klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     BILLOFK       klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     TRACKTK       klist
     C                   kfld                    HEAVD
     C                   kfld                    HEOPD
     C     ARKIVL11K     klist
     C                   kfld                    ARSTAT
     C                   kfld                    ARUNDE
     C                   MOVE      'A'           ARSTAT
     C     ARKLAGK       KLIST
     C                   KFLD                    BIFIRM
     C                   KFLD                    ARKLAG
     C     KODTÅK        KLIST
     C                   KFLD                    KOÅUNI
     C                   KFLD                    WBRACC
     C                   KFLD                    WBRAAR
     C                   KFLD                    WBRMND
     C     KODTLKK       KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C     ST2DFK        KLIST
     C                   KFLD                    WSLKFR
     C                   KFLD                    WSSTEF
     C     ST2DTK        KLIST
     C                   KFLD                    WSLKTO
     C                   KFLD                    WSSTET
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     CDTRAFL2K     KLIST
     C                   KFLD                    BIFIRM
     C                   KFLD                    WSTR
     C     VALKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSTVAL
     C     BRPARFK       KLIST
     C                   kfld                    PABRID
     C                   kfld                    PAKUNR
     C                   kfld                    PAID
     C     BrParKey      klist
     C                   kfld                    PABRID
     C                   kfld                    PAKUNR
     C                   kfld                    PAID
     C                   MOVE      BIBRID        PABRID
     C                   MOVE      *zeros        PAKUNR
      *
     C                   MOVE      'TURPL'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XTURTYPE          1
     C   33              MOVE      'O'           XTURTYPE
XXX  C                   MOVE      'O'           XTURTYPE
     C                   MOVE      'EPOST'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVEL     PAVRDA        XEPMOTT          50
     C                   IF        XTURTYPE = 'O'
     C                   MOVE      'OSAVD'       PAID
     C                   ELSE
     C                   MOVE      'LTAVD'       PAID
     C                   END
     C     BrParKey      CHAIN     BRPARF                             33
     C                   Z-ADD     PAVRDN        TEAVD
     C                   MOVE      'SSAGT'       PAID
     C     BrParKey      chain     BRPARF                             33
     C  N33              MOVE      'J'           XAGENT            1
     C                   MOVE      'AUTOR'       PAID
     C     BrParKey      chain     BRPARF                             33
     C                   IF        *IN33
     C                   MOVE      'N'           XAUT              1
     C                   ELSE
     C                   MOVEL     PAVRDA        XAUT
     C                   END
     C     'ZO'          CHAIN     ARKTXT                             33
     C                   IF        ARKLAG = *BLANKS
     C     BIFIRM        READE     FIRMARC                                50
     C                   ELSE
     C     ARKLAGK       CHAIN     ARKEXT                             33
     C                   END
     C                   EVAL      XBANE = '/' + %TRIM(ARCANE) + '/'
     C                   BITON     '123457'      XAPSTR            1
     C                   BITOFF    '06'          XAPSTR
     C                   MOVE      'Å'           KOÅUNI
     C                   MOVE      'LK '         KLKUNI            3
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           XIDAG             8 0
     C                   MOVEL     WDT           XIÅR              4 0
     C     BIFIRM        CHAIN     FIRM                               33
      *
     C                   endsr
      *
