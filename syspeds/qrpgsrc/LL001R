      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE VARE-REGISTER             ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 11 13-24
      *** LEDIGE INDIKATORER 32 34-39 41-52 95-97
      ***********************************************************
      *
     FLLVAREUP  UF A E           K DISK
     FLLVARE01  IF   E           K DISK
     F                                     RENAME(LLVARER:LLVARER1)
     FLLVARE02  IF   E           K DISK
     F                                     RENAME(LLVARER:LLVARER2)
     FLLVARE04  IF   E           K DISK
     F                                     RENAME(LLVARER:LLVARER4)
     FLLVARLOG  O  A E             DISK
     FLLAGJS03  IF   E           K DISK
     FLLGRPK05  IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FCUNDC01   IF   E           K DISK
     FKODTSE    IF   E           K DISK
     FTARI      IF   E           K DISK
     FLLTARF    UF A E           K DISK
     FLLVADR3   IF   E           K DISK
     FKUFAST    IF A E           K DISK
     FLLAUTF    IF   E           K DISK
     FLL001D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D TX              S             62    DIM(17)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  LTTANR                 1     20
     D  T1                     1     20
     D                                     DIM(20)
     D                 DS
     D  XTTANR                 1     20
     D  T2                     1     20
     D                                     DIM(20)
     D                 DS
     D  LVANR                  1     15
     D  XDLT                   1      7
     D                 DS
     D  LVMIN                  1      5  0
     D  LVMIN1                 5      5  0
     D                 DS
     D  LVVB                   1     35
     D  WXVB                   1     33
     D                 DS
     D  VADRNA                 1     30
     D  XADRNA                 1     10
     D                 DS
     D  WSAN01                 1      5  0
     D  WSAN00                 1      5  0
     D                 DS
     D  LVAN01                 1      5  0
     D  LVAN00                 1      5  0
     D                 DS
     D  WSLOK1                 1      5
     D  WSLOK2                 6     25
     D  WSLLOK                 1     25
     D                 DS
     D  LVLOK1                 1      5
     D  LVLOK2                 6     25
     D  LVLLOK                 1     25
     D                 DS
     D  WSPLK1                 1      5
     D  WSPLK2                 6     25
     D  WSPLOK                 1     25
     D                 DS
     D  LVPLK1                 1      5
     D  LVPLK2                 6     25
     D  LVPLOK                 1     25
     D                 DS
     D  WSBDAT                 1      8  0
     D  WSBDAÅ                 1      4  0
     D  WSBDAM                 5      6  0
     D  WSBDAD                 7      8  0
     D                 DS
     D  LVBDAT                 1      8  0
     D  LVBDAÅ                 1      4  0
     D  LVBDAM                 5      6  0
     D  LVBDAD                 7      8  0
     D                 DS
     D  XTIME                  1     14  0
     D  XTID                   1      6  0
     D  XDD                    7      8  0
     D  XMM                    9     10  0
     D  XÅÅ                   11     14  0
     D                SDS
     D  ZUSER                254    263
      *
     C                   EXSR      INIT
     C     WSGRUP        IFNE      0
     C     WSPNR         ORNE      0
     C                   GOTO      BG2
     C                   END
      *
     C     BG1           TAG
     C  N04
     CANN30              Z-ADD     7             LINNBR
     C  N04
     CANN30              Z-ADD     30            POSNBR
     C                   EXFMT     BILDE01
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      '0'           *IN30
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      BG1
     C                   END
      *
     C     BG2           TAG
      *
     C     WSPNR         CHAIN     LLGRPK05                           30
     C     *IN30         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'JOV0825'     MSGNR
     C                   GOTO      BG1
     C                   ELSE
     C                   MOVE      GKGRP         WSGRUP
     C                   END
      *
     C     WSGRUP        IFGT      0
     C     CUN1KG        CHAIN     CUNDL01                            99
     C     *IN99         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      BG1
     C                   END
     C                   END
      *
     C     CUN1KP        CHAIN     CUNDL01                            98
     C     *IN98         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      BG1
     C                   END
      *
     C     WSPNR         CHAIN     LLAUTF                             33
     C                   IF        *IN33 = *OFF
     C     LLAUTFK       KLIST
     C                   KFLD                    WSPNR
     C                   KFLD                    ZUSER
     C     LLAUTFK       CHAIN     LLAUTF                             33
     C   33              GOTO      SLUTT
     C                   END
      *
     C                   MOVEA     '10'          *IN(27)
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *off          *in39
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C   27LVKEY1        SETLL     LLVARE01
     C   28LVKEY2        SETLL     LLVARE02
     C     START1        TAG
     C   27LVK11         READE     LLVARE01                               94
     C   28LVK12         READE     LLVARE02                               94
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C   41              MOVE      *on           *in39
     C                   WRITE     SUBFIL
     C   27LVK11         READE     LLVARE01                               94
     C   28LVK12         READE     LLVARE02                               94
     C  N94              MOVE      LVANR         XANR             15
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
      *
     C     START3        TAG
     C                   SETOFF                                       9998
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C                   SETOFF                                       9830
      *** AVSLUTT
     C   03              GOTO      SLUTT
      *** FRISK OPP
     C   05              GOTO      START
      *** LAGE NY
     C     START4        TAG
     C   06              DO
     C                   EXSR      MOVB2
     C                   GOTO      START5
     C                   END
     C*** AVSLUTT
     C   12              DO
     C     UGRP          IFNE      *BLANKS
     C     UPNR          ORNE      *BLANKS
     C                   GOTO      SLUTT
     C                   END
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      '0'           *IN30
     C                   GOTO      BG1
     C                   END
      *
      *** BLA VIDERE
     C   25              DO
     C     LVKEYLES      CHAIN     LLVARE01                           33
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C                   MOVE      *off          *in39
     C                   GOTO      START2
     C                   END
      *
     C                   MOVE      '0'           *IN29
     C     W2NR          IFNE      ' '                                          1<-B
     C     W2ANR         ORNE      *BLANKS
     C     W2VB          ORNE      *BLANKS
     C     W2NR          IFEQ      ' '                                           2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
      * HVIS 29 ON - OPTION ER UTFØRT FRA TOPLINJA
     C                   MOVE      '1'           *IN29
     C     W2NR          IFEQ      '1'                                            3Z-B
     C                   MOVE      '1'           *IN06
     C                   MOVE      ' '           W2NR
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2ANR         IFEQ      *BLANKS                                        3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0579'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYOPT
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2ANR
     C                   MOVE      *BLANKS       W2VB
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      START3
      *
     C     START5        TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
     C                   MOVEA     '000'         *IN(65)
     C                   MOVEA     '00000000'    *IN(57)
     C                   MOVEA     '0000'        *IN(53)
     C                   MOVEA     '000000'      *IN(47)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      START5
     C                   END
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C   09              GOTO      START5
     C   10              GOTO      START5
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
      ***********************************************
     C     NYSØK         BEGSR
      ***********************************************
     C     W2ANR         IFEQ      *BLANKS
     C                   MOVEA     '01'          *IN(27)
     C                   MOVE      W2VB          YVB              35
     C                   ELSE
     C                   MOVEA     '10'          *IN(27)
     C                   MOVE      W2ANR         YANR             15
     C                   END
      *
     C                   MOVE      *BLANKS       W2ANR
     C                   MOVE      *BLANKS       W2VB
      *
     C                   ENDSR
      *
      ***********************************************
     C     NYOPT         BEGSR
      ***********************************************
     C     LVKUP2        CHAIN(N)  LLVAREUP                           98
     C   98              DO
     C                   MOVE      'YBC0580'     MSGNR
     C                   GOTO      SLOPT
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    '2'
     C                   EXSR      CHGVAR
     C     W2NR          WHENEQ    '3'
     C                   EXSR      CPYVAR
     C     W2NR          WHENEQ    '4'
     C                   EXSR      DLTVAR
     C     W2NR          WHENEQ    '5'
     C                   EXSR      DSPVAR
     C                   OTHER
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   GOTO      SLOPT
     C                   ENDSL
      *
     C     SLOPT         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *BLANKS       W2NR
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C  N40              DO
     C     WSANR         COMP      *BLANKS                                90
     C   90              MOVE      'YBC0581'     MSGNR
     C   90              SETON                                        30
     C  N90LVKUP1        CHAIN(N)  LLVAREUP                           33
     C  N90
     CANN33              DO
     C                   MOVE      'YBC0582'     MSGNR
     C                   SETON                                        3090
     C                   END
     C   90              Z-ADD     4             LINNBR
     C   90              Z-ADD     22            POSNBR
     C                   END
      *
     C     WSLNR         IFEQ      *BLANKS
     C                   MOVE      *BLANKS       XADRNA
     C                   ELSE
     C     VADRK         CHAIN     LLVADR3                            56
     C  N30*IN56         IFEQ      '1'                                           2<-B
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     11            POSNBR
     C                   MOVE      'SPL0110'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSANS         IFNE      *BLANKS
     C     CUNDCK        CHAIN     CUNDC01                            55
     C  N30*IN55         IFEQ      '1'                                           2<-B
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     50            POSNBR
     C                   MOVE      'YBC0873'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   END
      *
     C     WSANRL        IFNE      *BLANKS
     C     LVKLEV        CHAIN     LLVARE04                           33
     C  N33LVANR         IFNE      WSANR
     C                   SETON                                        65
     C  N30              DO
     C                   MOVE      'YBC0685'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     48            POSNBR
     C                   END
     C                   END
     C                   END
      *
     C     WSTANR        IFNE      0
     C     TARIK         CHAIN     TARI                               54
     C   54
     CANN30              DO
     C                   MOVE      'SPT0033'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
     C     WSFYL         IFNE      *BLANKS
     C     WSFYL         CHAIN     KODTSE                             53
     C   53
     CANN30              DO
     C                   MOVE      'YBC1826'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
     C                   END
     C                   END
      *
     C     WSVB          IFEQ      *BLANKS
     C  N30              MOVE      'YBC0583'     MSGNR
     C  N30              Z-ADD     5             LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   SETON                                        8930
     C                   END
      *
      * TEST AV VAREGRP
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C     WSAG01        IFNE      *BLANKS
     C                   MOVEL     WSAG01        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             47
     C     *IN30         IFEQ      '0'
     C     *IN47         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   MOVE      'JOV1363'     MSGNR
     C                   END
     C                   END
     C     WSAG02        IFNE      *BLANKS
     C                   MOVEL     WSAG02        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             48
     C     *IN30         IFEQ      '0'
     C     *IN48         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'JOV1363'     MSGNR
     C                   END
     C                   END
     C     WSAG03        IFNE      *BLANKS
     C                   MOVEL     WSAG03        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             49
     C     *IN30         IFEQ      '0'
     C     *IN49         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     38            POSNBR
     C                   MOVE      'JOV1363'     MSGNR
     C                   END
     C                   END
     C     WSAG04        IFNE      *BLANKS
     C                   MOVEL     WSAG04        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             50
     C     *IN30         IFEQ      '0'
     C     *IN50         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     46            POSNBR
     C                   MOVE      'JOV1363'     MSGNR
     C                   END
     C                   END
     C     WSAG05        IFNE      *BLANKS
     C                   MOVEL     WSAG05        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             51
     C     *IN30         IFEQ      '0'
     C     *IN51         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     54            POSNBR
     C                   MOVE      'JOV1363'     MSGNR
     C                   END
     C                   END
      *  Vareeier
     C                   movel     'VE'          KFTYP
     C     WSEIER        IFNE      *BLANKS
     C                   MOVEL     WSEIER        KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             52
     C     *IN30         IFEQ      '0'
     C     *IN52         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     73            POSNBR
     C                   MOVE      'JOV1364'     MSGNR
     C                   END
     C                   END
      * GRUNNENHET
     C     WSEH0         IFEQ      *BLANKS
     C  N30              MOVE      'YBC0601'     MSGNR
     C  N30              Z-ADD     10            LINNBR
     C  N30              Z-ADD     26            POSNBR
     C                   SETON                                        8830
     C                   END
      *
     C     WSEH0T        IFEQ      *BLANKS
     C  N30              MOVE      'YBC0602'     MSGNR
     C  N30              Z-ADD     10            LINNBR
     C  N30              Z-ADD     30            POSNBR
     C                   SETON                                        8730
     C                   END
      *
     C     WSVKT0        IFEQ      0
     C  N30              MOVE      'YBC0603'     MSGNR
     C  N30              Z-ADD     10            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        8630
     C                   END
     C                   Z-ADD     1             FORANT            5 0
     C                   Z-ADD     WSVKT0        FORVKT            7 2
     C                   Z-ADD     WSKUB0        FORKUB            7 4
      *
     C     WSVKF0        IFNE      0
     C     WSVKF0        ANDLT     WSVKT0
     C  N30              MOVE      'YBC0863'     MSGNR
     C  N30              Z-ADD     11            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6430
     C                   END
      *
     C     WSKUF0        IFNE      0
     C     WSKUF0        ANDLT     WSVKT0
     C  N30              MOVE      'YBC0864'     MSGNR
     C  N30              Z-ADD     11            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        6330
     C                   END
     C                   Z-ADD     WSVKF0        FORVKF            7 2
     C                   Z-ADD     WSKUF0        FORKUF            7 4
      *
      * ALTERNATIV ENHET 1
     C     WSAN01        IFNE      0
     C     WSVKT1        ORNE      0
     C     WSKUB1        ORNE      0
      *
     C     WSEH1         IFEQ      *BLANKS
     C  N30              MOVE      'YBC0604'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     26            POSNBR
     C                   SETON                                        8430
     C                   END
      *
     C     WSEH1T        IFEQ      *BLANKS
     C  N30              MOVE      'YBC0605'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     30            POSNBR
     C                   SETON                                        8330
     C                   END
      *
     C     WSAN01        IFEQ      0
     C  N30              MOVE      'YBC0606'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     47            POSNBR
     C                   SETON                                        8230
     C                   END
      *
     C     WSVKT0        MULT      WSAN01        XVKT              7 2
     C     WSVKT1        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKT1
     C                   END
     C     WSVKT1        IFLT      XVKT
     C  N30              MOVE      'YBC0607'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        8130
     C                   END
      *
     C     WSKUB0        MULT      WSAN01        XKUB              7 4
     C     WSKUB1        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUB1
     C                   END
     C     WSKUB1        IFLT      XKUB
     C  N30              MOVE      'YBC0610'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        8030
     C                   END
      *
     C                   Z-ADD     WSAN01        FORANT
     C                   Z-ADD     WSVKT1        FORVKT
     C                   Z-ADD     WSKUB1        FORKUB
      *
     C     WSVKF0        MULT      WSAN01        XVKT              7 2
     C     WSVKF1        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKF1
     C                   END
     C     WSVKF1        IFLT      XVKT
     C  N30              MOVE      'YBC0607'     MSGNR
     C  N30              Z-ADD     13            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6230
     C                   END
     C     WSVKF1        IFNE      0
     C     WSVKF1        ANDLT     WSVKT1
     C  N30              MOVE      'YBC0863'     MSGNR
     C  N30              Z-ADD     13            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6230
     C                   END
      *
     C     WSKUF0        MULT      WSAN01        XKUB              7 4
     C     WSKUF1        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUF1
     C                   END
     C     WSKUF1        IFLT      XKUB
     C  N30              MOVE      'YBC0610'     MSGNR
     C  N30              Z-ADD     13            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        6130
     C                   END
     C     WSKUF1        IFNE      0
     C     WSKUF1        ANDLT     WSVKT1
     C  N30              MOVE      'YBC0864'     MSGNR
     C  N30              Z-ADD     13            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        6130
     C                   END
      *
     C                   Z-ADD     WSVKF1        FORVKF
     C                   Z-ADD     WSKUF1        FORKUF
      *
     C                   END
      *
      * ALTERNATIV ENHET 2
     C*          WSAN02    IFNE 0
     C*          WSAN12    ORNE 0
     C     WSAN12        IFNE      0
     C     WSVKT2        ORNE      0
     C     WSKUB2        ORNE      0
      *
     C     WSEH2         IFEQ      *BLANKS
     C  N30              MOVE      'YBC0604'     MSGNR
     C  N30              Z-ADD     14            LINNBR
     C  N30              Z-ADD     26            POSNBR
     C                   SETON                                        7930
     C                   END
      *
     C     WSEH2T        IFEQ      *BLANKS
     C  N30              MOVE      'YBC0605'     MSGNR
     C  N30              Z-ADD     14            LINNBR
     C  N30              Z-ADD     30            POSNBR
     C                   SETON                                        7830
     C                   END
      *
     C     WSAN12        IFEQ      0
     C  N30              MOVE      'YBC0608'     MSGNR
     C  N30              Z-ADD     14            LINNBR
     C  N30              Z-ADD     47            POSNBR
     C                   SETON                                        7730
     C                   ELSE
     C     WSAN12        MULT      FORANT        WSAN02
     C                   END
      *
     C     FORVKT        MULT      WSAN12        XVKT              7 2
     C     WSVKT2        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKT2
     C                   END
     C     WSVKT2        IFLT      XVKT
     C  N30              MOVE      'YBC0609'     MSGNR
     C  N30              Z-ADD     14            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        7530
     C                   END
      *
     C     FORKUB        MULT      WSAN12        XKUB              7 4
     C     WSKUB2        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUB2
     C                   END
     C     WSKUB2        IFLT      XKUB
     C  N30              MOVE      'YBC0611'     MSGNR
     C  N30              Z-ADD     14            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        7430
     C                   END
      *
     C                   Z-ADD     WSAN02        FORANT
     C                   Z-ADD     WSVKT2        FORVKT
     C                   Z-ADD     WSKUB2        FORKUB
      *
     C     FORVKF        MULT      WSAN12        XVKT              7 2
     C     WSVKF2        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKF2
     C                   END
     C     WSVKF2        IFLT      XVKT
     C  N30              MOVE      'YBC0609'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6030
     C                   END
     C     WSVKF2        IFNE      0
     C     WSVKF2        ANDLT     WSVKT2
     C  N30              MOVE      'YBC0863'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6030
     C                   END
      *
     C     FORKUF        MULT      WSAN12        XKUB              7 4
     C     WSKUF2        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUF2
     C                   END
     C     WSKUF2        IFLT      XKUB
     C  N30              MOVE      'YBC0611'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        5930
     C                   END
     C     WSKUF2        IFNE      0
     C     WSKUF2        ANDLT     WSVKT2
     C  N30              MOVE      'YBC0864'     MSGNR
     C  N30              Z-ADD     15            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        5930
     C                   END
      *
     C                   Z-ADD     WSVKF2        FORVKF
     C                   Z-ADD     WSKUF2        FORKUF
      *
     C                   ELSE
     C                   MOVE      *ZEROS        WSAN02
     C                   END
      *
      * ALTERNATIV ENHET 3
     C     WSAN23        IFNE      0
     C     WSVKT3        ORNE      0
     C     WSKUB3        ORNE      0
      *
     C     WSEH3         IFEQ      *BLANKS
     C  N30              MOVE      'YBC0604'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     26            POSNBR
     C                   SETON                                        7330
     C                   END
      *
     C     WSEH3T        IFEQ      *BLANKS
     C  N30              MOVE      'YBC0605'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     30            POSNBR
     C                   SETON                                        7230
     C                   END
      *
     C     WSAN23        IFEQ      0
     C  N30              MOVE      'YBC0608'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     47            POSNBR
     C                   SETON                                        7130
     C                   ELSE
     C     WSAN23        MULT      FORANT        WSAN03
     C                   END
      *
     C     FORVKT        MULT      WSAN23        XVKT              7 2
     C     WSVKT3        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKT3
     C                   END
     C     WSVKT3        IFLT      XVKT
     C  N30              MOVE      'YBC0612'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        6930
     C                   END
      *
     C     FORKUB        MULT      WSAN23        XKUB              7 4
     C     WSKUB3        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUB3
     C                   END
     C     WSKUB3        IFLT      XKUB
     C  N30              MOVE      'YBC0613'     MSGNR
     C  N30              Z-ADD     16            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        6830
     C                   END
      *
     C     FORVKF        MULT      WSAN23        XVKT              7 2
     C     WSVKF3        IFEQ      *ZEROS
     C                   Z-ADD     XVKT          WSVKF3
     C                   END
     C     WSVKF3        IFLT      XVKT
     C  N30              MOVE      'YBC0612'     MSGNR
     C  N30              Z-ADD     17            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        5830
     C                   END
     C     WSVKF3        IFNE      0
     C     WSVKF3        ANDLT     WSVKT3
     C  N30              MOVE      'YBC0863'     MSGNR
     C  N30              Z-ADD     17            LINNBR
     C  N30              Z-ADD     61            POSNBR
     C                   SETON                                        5830
     C                   END
      *
     C     FORKUF        MULT      WSAN23        XKUB              7 4
     C     WSKUF3        IFEQ      *ZEROS
     C                   Z-ADD     XKUB          WSKUF3
     C                   END
     C     WSKUF3        IFLT      XKUB
     C  N30              MOVE      'YBC0613'     MSGNR
     C  N30              Z-ADD     17            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        5730
     C                   END
     C     WSKUF3        IFNE      0
     C     WSKUF3        ANDLT     WSVKT3
     C  N30              MOVE      'YBC0864'     MSGNR
     C  N30              Z-ADD     17            LINNBR
     C  N30              Z-ADD     70            POSNBR
     C                   SETON                                        5730
     C                   END
      *
     C                   ELSE
     C                   MOVE      *ZEROS        WSAN03
     C                   END
      *
      * LAVESTE SALGSENHET
     C     WSMIN         IFGT      3
     C  N30              MOVE      'YBC0614'     MSGNR
     C  N30              Z-ADD     19            LINNBR
     C  N30              Z-ADD     23            POSNBR
     C                   SETON                                        6730
     C                   ELSE
      *
     C                   SELECT
     C     WSMIN         WHENEQ    0
     C                   MOVE      'STK'         WSMEH
     C     WSMIN         WHENEQ    1
     C     WSAN01        COMP      0                                      67
     C  N67              MOVE      'ESK'         WSMEH
     C     WSMIN         WHENEQ    2
     C     WSAN02        COMP      0                                      67
     C  N67              MOVE      'KRT'         WSMEH
     C     WSMIN         WHENEQ    3
     C     WSAN03        COMP      0                                      67
     C  N67              MOVE      'PAL'         WSMEH
     C                   ENDSL
     C     *IN67         IFEQ      '1'
     C  N30              MOVE      'YBC0616'     MSGNR
     C  N30              Z-ADD     18            LINNBR
     C  N30              Z-ADD     23            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C   30              GOTO      SLTB1
      *
      *
      *** OPPDATERE PÅ REGISTER OG SUBFIL
     C     LVKUP1        CHAIN     LLVAREUP                           33
     C  N33
     CANN40              UPDATE    LLVARER
     C  N33
     CANN40              GOTO      SLTB1
      *
      * GI MELDING OM MAN MÅ GJØRE TILSVARENDE ENDRINGER PÅ LAGERBEH.
     C  N33WSAN01        IFNE      LVAN01
     C     WSAN12        ORNE      LVAN12
     C     WSAN02        ORNE      LVAN02
     C     WSAN23        ORNE      LVAN23
     C     WSAN03        ORNE      LVAN03
     C     WSVKT0        ORNE      LVVKT0
     C     WSKUB0        ORNE      LVKUB0
     C     WSVKF0        ORNE      LVVKF0
     C     WSKUF0        ORNE      LVKUF0
     C     WSVKT1        ORNE      LVVKT1
     C     WSKUB1        ORNE      LVKUB1
     C     WSVKF1        ORNE      LVVKF1
     C     WSKUF1        ORNE      LVKUF1
     C     WSVKT2        ORNE      LVVKT2
     C     WSKUB2        ORNE      LVKUB2
     C     WSVKF2        ORNE      LVVKF2
     C     WSKUF2        ORNE      LVKUF2
     C     WSVKT3        ORNE      LVVKT3
     C     WSKUB3        ORNE      LVKUB3
     C     WSVKF3        ORNE      LVVKF3
     C     WSKUF3        ORNE      LVKUF3
     C     LAGJS3        SETLL     LLAGJS03
     C     LAGJS3        READE     LLAGJS03                               33
     C     *IN33         IFEQ      '0'
     C                   EXFMT     ALARM
     C                   WRITE     LVARLOGR
     C                   END
     C                   MOVE      '0'           *IN33
     C                   ELSE
     C     WSANRL        IFNE      LVANRL
     C     WSVB          ORNE      LVVB
     C     WSBATC        ORNE      LVBATC
     C     WSTXT         ORNE      LVTXT
     C     WSLLOK        ORNE      LVLLOK
     C     WSSN          ORNE      LVSN
     C     WSPLOK        ORNE      LVPLOK
     C     WSPMIN        ORNE      LVPMIN
     C     WSPNTS        ORNE      LVPNTS
     C                   WRITE     LVARLOGR
     C                   END
     C                   END
      *
     C                   EXSR      MOVWLV
     C  N33              UPDATE    LLVARER
     C   33              MOVE      *ZEROS        LVSALD
     C   33              WRITE     LLVARER
     C     LTARFK        CHAIN     LLTARF                             33
     C     *IN33         IFEQ      '0'
     C     WSTANR        IFEQ      0
     C                   DELETE    LLTARFR
     C                   ELSE
     C                   MOVE      *BLANKS       LTTANR
     C                   MOVEL     WSTANR        LTTANR
     C                   MOVE      WSFYL         LTFYL
     C                   UPDATE    LLTARFR
     C                   END
     C                   ELSE
     C     WSTANR        IFNE      0
     C                   MOVE      WSGRUP        LTGRUP
     C                   MOVE      WSPNR         LTPNR
     C                   MOVE      WSANR         LTANR
     C                   MOVE      YLK           LTLK
     C                   MOVE      *BLANKS       LTTANR
     C                   MOVEL     WSTANR        LTTANR
     C                   MOVE      WSFYL         LTFYL
     C                   WRITE     LLTARFR
     C                   END
     C                   END
      *
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C  N29
     CAN 40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   SELECT
     C     *IN09         WHENEQ    '1'
     C                   CALL      'LL001RA'
     C                   PARM      WSGRUP        UGRUP2            8 0
     C                   PARM      WSPNR         UPNR2             8 0
     C                   PARM                    WSANR
     C     ZRECNO        CHAIN     SUBFIL                             33
     C     *IN10         WHENEQ    '1'
     C                   CALL      'LL001RB'
     C                   PARM      WSGRUP        UGRUP2            8 0
     C                   PARM      WSPNR         UPNR2             8 0
     C                   PARM                    WSANR
     C     ZRECNO        CHAIN     SUBFIL                             33
     C                   OTHER
     C                   EXSR      MOVB2
     C                   END
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
      *
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      CHGVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      '3'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      CPYVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      DLTVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      DSPVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      'D'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      DEAVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C     WSNR          IFEQ      'A'
     C                   MOVE      ' '           WSNR
     C     XDLT          COMP      '*DELETE'                              98
     C   98              GOTO      SLHENT
     C                   EXSR      AKTVAR
     C   12              GOTO      SLHENT
     C                   END
      *
     C                   END
      *
     C     SLHENT        TAG
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGVAR        BEGSR
     C***********************************************
     C                   EXSR      MOVLVW
     C                   SETON                                        99
     C     LVAKT         COMP      'I'                                    31
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
     C                   MOVEA     '000'         *IN(65)
     C                   MOVEA     '00000000'    *IN(57)
     C                   MOVEA     '0000'        *IN(53)
     C                   MOVEA     '000000'      *IN(47)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      STCHG
     C                   END
     C   12              DO
     C* N28              UPDATE    SUBFIL
     C  N29              UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C   09              GOTO      STCHG
     C   10              GOTO      STCHG
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYVAR        BEGSR
     C***********************************************
     C                   EXSR      MOVLVW
     C  N29              UPDATE    SUBFIL
     C                   Z-ADD     4             LINNBR
     C                   SETON                                        99
     C                   SETOFF                                       40
     C                   MOVE      *OFF          *IN31
     C     STCPY         TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
     C                   MOVEA     '000'         *IN(65)
     C                   MOVEA     '00000000'    *IN(57)
     C                   MOVEA     '00'          *IN(55)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      STCPY
     C                   END
     C   12              EXSR      MOVB2
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCPY
     C   09              GOTO      STCPY
     C   10              GOTO      STCPY
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     5             LINNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTVAR        BEGSR
     C***********************************************
     C                   SETON                                        99
     C     LVKUP3        CHAIN(N)  LLVAREUP                           33
     C     VADRK3        CHAIN     LLVADR3                            33
     C   33              MOVE      *BLANKS       XADRNA
     C     LTARKX        CHAIN(N)  LLTARF                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      HENTTN
     C                   MOVE      LTFYL         WSFYL
     C                   ELSE
     C                   MOVE      *BLANKS       WSFYL
     C                   MOVE      *ZEROS        WSTANR
     C                   END
     C     LVAKT         COMP      'I'                                    31
     C                   EXFMT     VAREL3
     C  N12              DO
     C     LVKUP3        CHAIN     LLVAREUP                           33
     C     *in10         IFEQ      *ON
     C  N31              move      'I'           LVAKT
     C   31              move      'A'           LVAKT
     C  N33              update    LLVARER
     C                   else
     C  N33              DELETE    LLVARER
     C     LVKUP3        SETLL     LLTARF
     C     LVKUP3        READE     LLTARF                                 33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    LLTARFR
     C     LVKUP3        READE     LLTARF                                 33
     C  N33              ENDDO
     C                   EXSR      MOVB1
     C                   end
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C  N29              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPVAR        BEGSR
     C***********************************************
     C                   SETON                                        99
     C     LVKUP3        CHAIN(N)  LLVAREUP                           33
     C     VADRK3        CHAIN     LLVADR3                            33
     C   33              MOVE      *BLANKS       XADRNA
     C     LTARKX        CHAIN(N)  LLTARF                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      HENTTN
     C                   MOVE      LTFYL         WSFYL
     C                   ELSE
     C                   MOVE      *BLANKS       WSFYL
     C                   MOVE      *ZEROS        WSTANR
     C                   END
     C     LVAKT         COMP      'I'                                    31
     C                   EXFMT     VAREL3
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C  N29              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     DEAVAR        BEGSR
     C***********************************************
     C                   SETON                                        99
     C     LVKUP3        CHAIN     LLVAREUP                           33
     C  N33              MOVE      'I'           LVAKT
     C  N33              UPDATE    LLVARER
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C  N29              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     AKTVAR        BEGSR
     C***********************************************
     C                   SETON                                        99
     C     LVKUP3        CHAIN     LLVAREUP                           33
     C  N33              MOVE      'A'           LVAKT
     C  N33              UPDATE    LLVARER
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     LVVKT0        COMP      0                                      41
     C  N41LVAKT         COMP      'I'                                    41
     C  N29              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWLV        BEGSR
     C***********************************************
     C                   TIME                    XTIME
     C                   MOVE      ZUSER         LVBUSE
     C                   MOVE      XDD           LVBDAD
     C                   MOVE      XMM           LVBDAM
     C                   MOVE      XÅÅ           LVBDAÅ
     C                   MOVE      XTID          LVBKL
     C                   MOVE      'A'           LVAKT
     C                   MOVE      WSGRUP        LVGRUP
     C                   MOVE      WSPNR         LVPNR
     C                   MOVE      WSLNR         LVLNR
     C                   MOVE      WSANS         LVANS
     C                   MOVE      WSANR         LVANR
     C                   MOVE      WSANRL        LVANRL
     C                   MOVE      WSVB          LVVB
     C                   MOVE      WSAG01        LVAG01
     C                   MOVE      WSAG02        LVAG02
     C                   MOVE      WSAG03        LVAG03
     C                   MOVE      WSAG04        LVAG04
     C                   MOVE      WSAG05        LVAG05
     C                   MOVE      WSEIER        LVEIER
     C                   MOVE      WSEH0         LVEH0
     C                   MOVE      WSEH0T        LVEH0T
     C                   MOVE      WSVKT0        LVVKT0
     C                   MOVE      WSKUB0        LVKUB0
     C                   MOVE      WSVKF0        LVVKF0
     C                   MOVE      WSKUF0        LVKUF0
     C                   MOVE      WSEH1         LVEH1
     C                   MOVE      WSEH1T        LVEH1T
     C                   MOVE      WSAN01        LVAN01
     C                   MOVE      WSVKT1        LVVKT1
     C                   MOVE      WSKUB1        LVKUB1
     C                   MOVE      WSVKF1        LVVKF1
     C                   MOVE      WSKUF1        LVKUF1
     C                   MOVE      WSEH2         LVEH2
     C                   MOVE      WSEH2T        LVEH2T
     C                   MOVE      WSAN02        LVAN02
     C                   MOVE      WSAN12        LVAN12
     C                   MOVE      WSVKT2        LVVKT2
     C                   MOVE      WSKUB2        LVKUB2
     C                   MOVE      WSVKF2        LVVKF2
     C                   MOVE      WSKUF2        LVKUF2
     C                   MOVE      WSEH3         LVEH3
     C                   MOVE      WSEH3T        LVEH3T
     C                   MOVE      WSAN03        LVAN03
     C                   MOVE      WSAN23        LVAN23
     C                   MOVE      WSVKT3        LVVKT3
     C                   MOVE      WSKUB3        LVKUB3
     C                   MOVE      WSVKF3        LVVKF3
     C                   MOVE      WSKUF3        LVKUF3
     C                   MOVE      WSMIN         LVMIN
     C                   MOVE      WSMEH         LVMEH
     C                   MOVE      WSMSTK        LVMSTK
     C                   MOVE      WSBATC        LVBATC
     C                   MOVE      WSSN          LVSN
     C                   MOVE      WSNTSN        LVNTSN
     C                   MOVE      WSKTLI        LVKTLI
     C                   MOVE      WSDTP         LVDTP
     C                   MOVE      WSPLS         LVPLS
     C                   MOVE      WSPRI         LVPRI
     C                   MOVE      WSSPRI        LVSPRI
     C                   MOVE      WSDTU         LVDTU
     C                   MOVE      WSTXT         LVTXT
     C                   MOVE      WSLLOK        LVLLOK
     C                   MOVE      WSPLOK        LVPLOK
     C                   MOVE      WSPMIN        LVPMIN
     C                   MOVE      WSPNTS        LVPNTS
     C                   IF        WSPLOK <> *BLANKS
     C                   MOVE      WSPLOK        LVLLOK
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVLVW        BEGSR
     C***********************************************
     C     LVKUP3        CHAIN(N)  LLVAREUP                           33
     C                   MOVE      LVLNR         WSLNR
     C     VADRK         CHAIN     LLVADR3                            33
     C   33              MOVE      *BLANKS       XADRNA
     C                   MOVE      LVANS         WSANS
     C                   MOVE      LVANR         WSANR
     C                   MOVE      LVANRL        WSANRL
     C                   MOVE      LVVB          WSVB
     C                   MOVE      LVAG01        WSAG01
     C                   MOVE      LVAG02        WSAG02
     C                   MOVE      LVAG03        WSAG03
     C                   MOVE      LVAG04        WSAG04
     C                   MOVE      LVAG05        WSAG05
     C                   MOVE      LVEIER        WSEIER
     C                   MOVE      LVEH0         WSEH0
     C                   MOVE      LVEH0T        WSEH0T
     C                   MOVE      LVVKT0        WSVKT0
     C                   MOVE      LVKUB0        WSKUB0
     C                   MOVE      LVVKF0        WSVKF0
     C                   MOVE      LVKUF0        WSKUF0
     C                   MOVE      LVEH1         WSEH1
     C                   MOVE      LVEH1T        WSEH1T
     C                   MOVE      LVAN01        WSAN01
     C                   MOVE      LVVKT1        WSVKT1
     C                   MOVE      LVKUB1        WSKUB1
     C                   MOVE      LVVKF1        WSVKF1
     C                   MOVE      LVKUF1        WSKUF1
     C                   MOVE      LVEH2         WSEH2
     C                   MOVE      LVEH2T        WSEH2T
     C                   MOVE      LVAN02        WSAN02
     C                   MOVE      LVAN12        WSAN12
     C                   MOVE      LVVKT2        WSVKT2
     C                   MOVE      LVKUB2        WSKUB2
     C                   MOVE      LVVKF2        WSVKF2
     C                   MOVE      LVKUF2        WSKUF2
     C                   MOVE      LVEH3         WSEH3
     C                   MOVE      LVEH3T        WSEH3T
     C                   MOVE      LVAN03        WSAN03
     C                   MOVE      LVAN23        WSAN23
     C                   MOVE      LVVKT3        WSVKT3
     C                   MOVE      LVKUB3        WSKUB3
     C                   MOVE      LVVKF3        WSVKF3
     C                   MOVE      LVKUF3        WSKUF3
     C                   MOVE      LVMIN         WSMIN
     C                   MOVE      LVMEH         WSMEH
     C                   MOVE      LVMSTK        WSMSTK
     C                   MOVE      LVBATC        WSBATC
     C                   MOVE      LVSN          WSSN
     C                   MOVE      LVNTSN        WSNTSN
     C                   MOVE      LVKTLI        WSKTLI
     C                   MOVE      LVDTP         WSDTP
     C                   MOVE      LVPLS         WSPLS
     C                   MOVE      LVPRI         WSPRI
     C                   MOVE      LVSPRI        WSSPRI
     C                   MOVE      LVDTU         WSDTU
     C                   MOVE      LVTXT         WSTXT
     C                   MOVE      LVSALD        WSSALD
     C                   MOVE      LVLLOK        WSLLOK
     C                   MOVE      LVPLOK        WSPLOK
     C                   MOVE      LVPMIN        WSPMIN
     C                   MOVE      LVPNTS        WSPNTS
     C                   MOVE      LVBUSE        WSBUSE
     C                   MOVE      LVBDAT        WSBDAT
     C                   MOVE      LVBKL         WSBKL
     C     LTARKX        CHAIN(N)  LLTARF                             33
     C     *IN33         IFEQ      '0'
     C                   EXSR      HENTTN
     C                   MOVEL     LTFYL         WSFYL
     C                   ELSE
     C                   MOVE      *ZEROS        WSTANR
     C                   MOVE      *BLANKS       WSFYL
     C                   END
     C                   SETON                                        40
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     22            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       LVANR
     C                   MOVE      '*DELETE'     XDLT
     C                   MOVE      *BLANKS       LVVB
     C                   MOVE      *ZEROS        LVMIN
     C                   MOVE      *BLANKS       LVMEH
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *OFF          *IN31
     C                   MOVE      *BLANKS       WSLNR
     C                   MOVE      *BLANKS       XADRNA
     C                   MOVE      *BLANKS       WSANS
     C                   MOVE      *BLANKS       WSANR
     C                   MOVE      *BLANKS       WSANRL
     C                   MOVE      *BLANKS       WSVB
     C                   MOVE      *BLANKS       WSAG01
     C                   MOVE      *BLANKS       WSAG02
     C                   MOVE      *BLANKS       WSAG03
     C                   MOVE      *BLANKS       WSAG04
     C                   MOVE      *BLANKS       WSAG05
     C                   MOVE      *BLANKS       WSEIER
     C                   MOVE      'STK'         WSEH0
     C                   MOVE      *BLANKS       WSEH0T
     C                   MOVEL     'STYKK'       WSEH0T
     C                   MOVE      *ZEROS        WSVKT0
     C                   MOVE      *ZEROS        WSKUB0
     C                   MOVE      *ZEROS        WSVKF0
     C                   MOVE      *ZEROS        WSKUF0
     C                   MOVE      'ESK'         WSEH1
     C                   MOVE      *BLANKS       WSEH1T
     C                   MOVEL     'ESKE'        WSEH1T
     C                   MOVE      *ZEROS        WSAN01
     C                   MOVE      *ZEROS        WSVKT1
     C                   MOVE      *ZEROS        WSKUB1
     C                   MOVE      *ZEROS        WSVKF1
     C                   MOVE      *ZEROS        WSKUF1
     C                   MOVE      'KRT'         WSEH2
     C                   MOVE      *BLANKS       WSEH2T
     C                   MOVEL     'KARTONG'     WSEH2T
     C                   MOVE      *ZEROS        WSAN02
     C                   MOVE      *ZEROS        WSAN12
     C                   MOVE      *ZEROS        WSVKT2
     C                   MOVE      *ZEROS        WSKUB2
     C                   MOVE      *ZEROS        WSVKF2
     C                   MOVE      *ZEROS        WSKUF2
     C                   MOVE      'PAL'         WSEH3
     C                   MOVE      *BLANKS       WSEH3T
     C                   MOVEL     'PALL'        WSEH3T
     C                   MOVE      *ZEROS        WSAN03
     C                   MOVE      *ZEROS        WSAN23
     C                   MOVE      *ZEROS        WSVKT3
     C                   MOVE      *ZEROS        WSKUB3
     C                   MOVE      *ZEROS        WSVKF3
     C                   MOVE      *ZEROS        WSKUF3
     C                   MOVE      *ZEROS        WSMIN
     C                   MOVE      *BLANKS       WSMEH
     C                   MOVE      *ZEROS        WSMSTK
     C                   MOVE      *BLANKS       WSSN
     C                   MOVE      *ZEROS        WSNTSN
     C                   MOVE      *BLANKS       WSKTLI
     C                   MOVE      *ZEROS        WSPRI
     C                   MOVE      *ZEROS        WSSPRI
     C                   MOVE      *BLANKS       WSTXT
     C                   MOVE      *BLANKS       WSLLOK
     C                   MOVE      *BLANKS       WSPLOK
     C                   MOVE      *ZEROS        WSPMIN
     C                   MOVE      *ZEROS        WSPNTS
     C                   MOVE      *ZEROS        WSSALD
     C                   MOVE      *BLANKS       WSBUSE
     C                   MOVE      *ZEROS        WSBDAT
     C                   MOVE      *ZEROS        WSBKL
     C                   MOVE      *BLANKS       WSFYL
     C                   MOVE      *ZEROS        WSTANR
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     22            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     37
     C                   MOVE      'SØKGRP  '    UTYPE             8
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRUP
     C                   PARM                    WSPNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     37
     C                   MOVE      WSGRUP        UTYPE
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRUP
     C                   PARM                    WSPNR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     27
     C                   CALL      'LL033R'
     C                   PARM                    WSPNR
     C                   PARM                    WSLNR
     C                   Z-ADD     50            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     50
     C     POSNBR        ANDLE     79
     C                   CALL      'VCUNDCR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSPNR
     C                   PARM                    URRN             10 0
     C                   PARM                    UEMFA             1
     C                   PARM                    WSANS
     C  N40              Z-ADD     4             LINNBR
     C   40              Z-ADD     6             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     79
     C                   MOVE      WSTANR        UTANR             8
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           USEDT             8 0
     C                   CALL      'SAD010A'
     C                   PARM                    UTANR
     C                   PARM                    USEDT
     C                   MOVE      UTANR         WSTANR
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     73
     C                   CALL      'SAD052H'
     C                   PARM                    WSFYL
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      * Varegruppe/vareeier
     C     LINNBR        IFEQ      06
      * Opprett defn om det ikke finnes..
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   move      ' DEFN'       KFKOD
     C     KUFAKEY       CHAIN     KUFAST                             33
     C     *in33         Ifeq      '1'
     C                   eval      KFTXT= 'Varegrupper for lagerkunde ' + KNAVN
     C                   eval      KFTXTE= '.'
     C                   write     KOFASTR
     C                   END
      *
      * Vareeiere
     C                   movel     'VE'          KFTYP
     C     KUFAKEY       CHAIN     KUFAST                             33
     C     *in33         Ifeq      '1'
     C                   eval      KFTXT= 'Vareeiere for lagerkunde ' + KNAVN
     C                   eval      KFTXTE= '.'
     C                   write     KOFASTR
     C                   END
      * Søk varegruppe 1
     C     POSNBR        IFGE      22
     C     POSNBR        ANDLE     26
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSAG01
     C                   Z-ADD     30            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      * Søk varegruppe  2
     C     POSNBR        IFGE      30
     C     POSNBR        ANDLE     34
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSAG02
     C                   Z-ADD     38            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      * Søk varegruppe  3
     C     POSNBR        IFGE      38
     C     POSNBR        ANDLE     42
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSAG03
     C                   Z-ADD     46            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      * Søk varegruppe  4
     C     POSNBR        IFGE      46
     C     POSNBR        ANDLE     50
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSAG04
     C                   Z-ADD     54            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      * Søk varegruppe  5
     C     POSNBR        IFGE      54
     C     POSNBR        ANDLE     58
     C                   movel     'VG'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSAG05
     C                   Z-ADD     73            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      * Vareeier
     C     POSNBR        IFGE      73
     C     POSNBR        ANDLE     77
     C                   movel     'VE'          KFTYP
     C                   move      WSPNR         KFTYP
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KFKOD             5
     C                   CALL      'SYKUKD'
     C                   PARM                    KFTYP
     C                   PARM                    KDUPD
     C                   PARM                    KFKOD
     C     KFKOD         IFNE      *BLANKS
     C                   MOVEL     KFKOD         WSEIER
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     61            POSNBR
     C                   END
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C     SLSØK2        ENDSR
      *
     C***********************************************
     C     HENTTN        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        WSTANR
     C                   MOVE      *ZEROS        XN2               3 0
     C     1             DO        20            XN                3 0
     C     T1(XN)        IFGE      '0'
     C     T1(XN)        ANDLE     '9'
     C                   ADD       1             XN2
     C                   MOVE      T1(XN)        T2(XN2)
     C                   END
     C                   ENDDO
     C     XN2           IFGE      8
     C                   MOVEL     XTTANR        WSTANR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUN1KG        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSGRUP
     C     CUN1KP        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNR
     C     CUNDCK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNR
     C                   KFLD                    WSANS
     C     VADRK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNR
     C                   KFLD                    WSLNR
     C     VADRK3        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    LVPNR
     C                   KFLD                    LVLNR
     C     LVKEYLES      KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    XANR
     C     LVKEY1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    YANR
     C     LVK11         KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C     LVKEY2        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    YVB
     C     LVK12         KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C     LVKUP1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    WSANR
     C     LVKUP2        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    W2ANR
     C     LVKUP3        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    LVANR
     C     LVKLEV        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    WSEIER
     C                   KFLD                    WSANRL
     C     LAGJS3        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    WSANR
     C     TARIK         KLIST
     C                   KFLD                    WSTANR
     C                   KFLD                    TATAR
     C     LTARFK        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    WSANR
     C                   KFLD                    YLK
     C                   MOVE      'NO'          YLK               2
     C     LTARKX        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    LVANR
     C                   KFLD                    YLK
     C     KUFAKEY       KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
      *
     C     *ENTRY        PLIST
     C                   PARM                    UGRP              8
     C                   PARM                    UPNR              8
      *
     C     UGRP          IFNE      *BLANKS
     C                   MOVE      UGRP          WSGRUP
     C                   END
     C     UPNR          IFNE      *BLANKS
     C                   MOVE      UPNR          WSPNR
     C                   END
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   MOVE      *ZEROS        LVMIN
     C                   MOVE      *BLANKS       LVLLOK
     C                   MOVE      *BLANKS       WSLLOK
     C                   MOVE      *BLANKS       LVPLOK
     C                   MOVE      *BLANKS       WSPLOK
     C                   MOVE      *ZEROS        WSAN01
     C                   MOVE      *ZEROS        LVAN01
      *
     C                   ENDSR
      *
