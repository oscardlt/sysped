********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10006 * 01 sh  PTF10 *cr  går til *CE for eksport
10006 * 02 CB  PTF10 *cr  går til *CE for eksport rettet feil
********************************************************************
     FHEADDTU   IF   E           K DISK
     FHEADF     UF   E           K DISK    PREFIX(W_)
     F                                     RENAME(HEADFR:HEADFRW)
     FFRISOK    IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
     FSVIH      IF   E           K DISK
     FSVEH      IF   E           K DISK
     FSYGE47D   CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)

     C                   EXSR      INIT

     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     HEADKEY3      SETLL     HEADDTU
     C     UHEUR         READPE    HEADDTU                                94
     C     *IN94         DOWEQ     *OFF
      * Test at oppdraget har ekstern referans
     C     FRIKEY        CHAIN     FRISOK                             99
n01  C   99FRIKEYE       CHAIN     FRISOK                             99
     C     *IN99         IFEQ      *OFF
      * Test at det ikke finnes tolldeklarasjon allerede
     C                   EVAL      ZVIH_SYAV=HEAVD
     C                   EVAL      ZVIH_SYOP=HEOPD
     C     HEADKEY       CHAIN     SADH                               99
     C   99HEADKEY       CHAIN     SAEH                               99
     C   99HEADKEY2      CHAIN     SVIH                               99
     C   99HEADKEY2      CHAIN     SVEH                               99
     C     *IN99         IFEQ      *ON
     C     HETLL         IFEQ      *BLANKS
     C     HEGNN         ANDEQ     *BLANKS
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C     ZRECNO        COMP      100                                94  94
     C     UHEUR         READPE    HEADDTU                                94
     C  N94              ENDDO

     C     ZRECNO        IFEQ      0
     C                   EVAL      HENAS='** No records found **'
     C                   EVAL      HENAK=*BLANKS
     C                   EVAL      HEDTR=0
     C                   EVAL      FSSOK=*BLANKS
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   ENDIF
     C     ZRECNO        IFGT      1
     C                   Z-ADD     1             ZRECNO
     C                   ENDIF
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVE      '1'           *IN29

     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C*                  EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C                   SETOFF                                       9830
     C   03
     COR 12              GOTO      SLUTT
     C*** FRISK OPP
     C   05              GOTO      START
      *
      *** BLA VIDERE
     C   25              GOTO      START3
      *
     C     ZRECNO        IFEQ      0
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      HENTSR
     C   98              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(91)
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '1'
     C                   MOVEL     FSSOK         UEKSREF
     C                   GOTO      SLHENT
     C                   END
     C  N98WSNR          IFEQ      '4'
     C     HEADKEY       CHAIN     HEADF                              95
     C  N95HEST          IFEQ      'U'
     C                   DELETE    HEADFRW
     C                   ENDIF
     C                   ENDIF
     C                   ENDDO
      *
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
      *
     C     SLHENT        ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
      *
     C     *ENTRY        PLIST
     C                   PARM                    UHEUR             1
     C                   PARM                    UEKSREF          35
     C     FRIKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   KFLD                    WFSKODE2          3
     C                   MOVE      '*CR'         WFSKODE2
n01  C     FRIKEYE       KLIST
n01  C                   KFLD                    HEAVD
n01  C                   KFLD                    HEOPD
N02  C                   KFLD                    WFSKODE3          3
N02  C                   MOVE      '*CE'         WFSKODE3
S02  C*                  KFLD                    WFSKODE2          3
S02  C*                  MOVE      '*CE'         WFSKODE2
     C     HEADKEY       KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADKEY2      KLIST
     C                   KFLD                    ZVIH_SYAV
     C                   KFLD                    ZVIH_SYOP
     C     *LIKE         DEFINE    SVIH_SYAV     ZVIH_SYAV
     C     *LIKE         DEFINE    SVIH_SYOP     ZVIH_SYOP
     C     HEADKEY3      KLIST
     C                   KFLD                    UHEUR
     C                   KFLD                    ZHEDTOP
     C     *LIKE         DEFINE    HEDTOP        ZHEDTOP
     C                   EVAL      ZHEDTOP=99999999
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
