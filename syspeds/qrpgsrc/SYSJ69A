********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 ARKIVERING
10XXX * 02 SH  PTF10 Layoutendring / afpds ut
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE BOOKING                         ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-25                            ***
      *** LEDIGE INDIKATORER       30-32 34-50 52 56-59 61-99 ***
      ***********************************************************
      *
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FHODE      IF   E           K DISK
     FBOOKING   UF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFREETXT2  IF   E           K DISK
N01  FARKTXT    IF   E           K DISK
N01  FFIRMARC   IF   E           K DISK
N01  FARKIVL03  IF   E           K DISK    RENAME(ARKIVR:ARKIVR03)
N01  FARKIVP    O  A E             DISK    USROPN
     FSYSJ69P   O    E             PRINTER
     D                 DS
     D  XMN1                   1     65
     D  XMN2                  66    130
     D  XMN3                 131    195
     D  XMN4                 196    260
     D  XMN5                 261    325
     D  XMN6                 326    390
     D  XMN7                 391    455
     D  XMN8                 456    520
     D  MN                     1    520
     D                                     DIM(8)
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  XDT1D                  1      2  0
     D  XDT1M                  3      4  0
     D  XDT1Å                  5      6  0
     D  XDT1                   1      6  0
     D                 DS
     D  BODT1Å                 1      4  0
     D  BODT1M                 5      6  0
     D  BODT1D                 7      8  0
     D  BODT1                  1      8  0
     D                 DS
     D  XDT3D                  1      2  0
     D  XDT3M                  3      4  0
     D  XDT3Å                  5      6  0
     D  XDT3                   1      6  0
     D                 DS
     D  BODT3Å                 1      4  0
     D  BODT3M                 5      6  0
     D  BODT3D                 7      8  0
     D  BODT3                  1      8  0
     D                 DS
     D  XDT4D                  1      2  0
     D  XDT4M                  3      4  0
     D  XDT4Å                  5      6  0
     D  XDT4                   1      6  0
     D                 DS
     D  BODT4Å                 1      4  0
     D  BODT4M                 5      6  0
     D  BODT4D                 7      8  0
     D  BODT4                  1      8  0
     D                 DS
     D  XDT5D                  1      2  0
     D  XDT5M                  3      4  0
     D  XDT5Å                  5      6  0
     D  XDT5                   1      6  0
     D                 DS
     D  BODT5Å                 1      4  0
     D  BODT5M                 5      6  0
     D  BODT5D                 7      8  0
     D  BODT5                  1      8  0
     D                 DS
     D  XDT7D                  1      2  0
     D  XDT7M                  3      4  0
     D  XDT7Å                  5      6  0
     D  XDT7                   1      6  0
     D                 DS
     D  BODT7Å                 1      4  0
     D  BODT7M                 5      6  0
     D  BODT7D                 7      8  0
     D  BODT7                  1      8  0
     D                 DS
     D  XDT8D                  1      2  0
     D  XDT8M                  3      4  0
     D  XDT8Å                  5      6  0
     D  XDT8                   1      6  0
     D                 DS
     D  BODT8Å                 1      4  0
     D  BODT8M                 5      6  0
     D  BODT8D                 7      8  0
     D  BODT8                  1      8  0
     D                 DS
     D  XDT9D                  1      2  0
     D  XDT9M                  3      4  0
     D  XDT9Å                  5      6  0
     D  XDT9                   1      6  0
     D                 DS
     D  BODT9Å                 1      4  0
     D  BODT9M                 5      6  0
     D  BODT9D                 7      8  0
     D  BODT9                  1      8  0
     D                UDS
     D  UFIRM                  1      2
N01  D                SDS
N01  D  UUSER                254    263
      *
     C                   EXSR      INIT
      *
      * SKRIV TIL PRINTER
      *
     C     BOOKK         CHAIN     BOOKING                            60
     C  N60              DO
     C                   MOVE      XIDAG         BODTBB
     C                   TIME                    BOTIBB
     C                   EXCEPT    BOMRK
     C                   EXSR      HEINFO
     C     WOPFM         IFEQ      *BLANKS
     C                   WRITE     SYSJ69P1
N02  C                   WRITE     OVL
     C                   ELSE
     C     WOPFM         SETLL     KODTFM
     C     *IN34         DOWEQ     '0'
     C     WOPFM         READE     KODTFM                                 34
     C     *IN34         IFEQ      '0'
     C                   WRITE     SYSJ69P1
N02  C                   WRITE     OVL
     C                   END
     C                   END
     C                   END
N01   *
N01  C                   exsr      arkivsr
N01   *
     C                   END
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C******************************************
     C     HEINFO        BEGSR
     C******************************************
     C                   MOVE      BODT1Å        UDTÅ
     C                   MOVE      BODT1M        UDTM
     C                   MOVE      BODT1D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT1Å
     C                   MOVE      UDTM          XDT1M
     C                   MOVE      UDTD          XDT1D
     C                   MOVE      BODT3Å        UDTÅ
     C                   MOVE      BODT3M        UDTM
     C                   MOVE      BODT3D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT3Å
     C                   MOVE      UDTM          XDT3M
     C                   MOVE      UDTD          XDT3D
     C                   MOVE      BODT4Å        UDTÅ
     C                   MOVE      BODT4M        UDTM
     C                   MOVE      BODT4D        UDTD
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT4Å
     C                   MOVE      UDTM          XDT4M
     C                   MOVE      UDTD          XDT4D
     C                   MOVE      BODT5Å        UDTÅ              2 0
     C                   MOVE      BODT5M        UDTM              2 0
     C                   MOVE      BODT5D        UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT5Å
     C                   MOVE      UDTM          XDT5M
     C                   MOVE      UDTD          XDT5D
     C                   MOVE      BODT9Å        UDTÅ              2 0
     C                   MOVE      BODT9M        UDTM              2 0
     C                   MOVE      BODT9D        UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT9Å
     C                   MOVE      UDTM          XDT9M
     C                   MOVE      UDTD          XDT9D
      *
     C     BODT7         COMP      *ZEROS                             2626
     C                   MOVE      BODT7Å        UDTÅ              2 0
     C                   MOVE      BODT7M        UDTM              2 0
     C                   MOVE      BODT7D        UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT7Å
     C                   MOVE      UDTM          XDT7M
     C                   MOVE      UDTD          XDT7D
      *
     C     BODT8         COMP      *ZEROS                             2727
     C                   MOVE      BODT8Å        UDTÅ              2 0
     C                   MOVE      BODT8M        UDTM              2 0
     C                   MOVE      BODT8D        UDTD              2 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDTÅ          XDT8Å
     C                   MOVE      UDTM          XDT8M
     C                   MOVE      UDTD          XDT8D
      *
     C     KODSFK        CHAIN     KODTSF                             33
     C   33              MOVE      *BLANKS       KOSFNV
      *
     C                   MOVE      *BLANKS       XLSSNV
     C     BOLSS         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLSSNV
     C   33              MOVEL     BOLSSN        XLSSNV
      *
     C                   MOVE      *BLANKS       XLBNV
     C     BOLB          CHAIN     CDBOAT                             33
     C  N33              MOVE      CBNAB         XLBNV
     C   33              MOVEL     BOLBN         XLBNV
      *
     C                   MOVE      *BLANKS       XLSHNV
     C     BOLSH         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLSHNV
     C   33              MOVE      BOLSHN        XLSHNV
      *
     C                   MOVE      *BLANKS       XOBNV
     C     BOOB          CHAIN     CDBOAT                             33
     C  N33              MOVE      CBNAB         XOBNV
     C   33              MOVEL     BOOBN         XOBNV
      *
     C                   MOVE      *BLANKS       XVHNV
     C     BOVH          CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XVHNV
     C   33              MOVEL     BOVHN         XVHNV
      *
     C                   MOVE      *BLANKS       XVHNV2
     C     BOVH2         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XVHNV2
     C   33              MOVEL     BOVH2         XVHNV2
      *
     C                   MOVE      *BLANKS       XLOHNV
     C     BOLOH         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLOHNV
     C   33              MOVEL     BOLOHN        XLOHNV
      *
     C                   MOVE      *BLANKS       XLOSNV
     C     BOLOS         CHAIN     STED2                              33
     C  N33              MOVE      ST2NVN        XLOSNV
     C   33              MOVEL     BOLOSN        XLOSNV
      *
     C                   MOVE      *BLANKS       MN
     C     FRET2K        SETLL     FREETXT2                           33
     C     1             DO        8             XN                1 0
     C     FRET2K        READE     FREETXT2                               33
     C  N33              MOVEL     FRTTXT        MN(XN)
     C  N33              END
      * STYKKGODS...
     C                   MOVE      *OFF          *IN28
     C                   MOVE      *BLANKS       CC4FT1
     C                   MOVE      *BLANKS       CC4FT2
     C                   MOVE      *BLANKS       CC4FT3
     C                   MOVE      *BLANKS       CC4FT4
      * ELLER CONTAINER....
     C     BOKDC1        IFNE      *BLANKS                                      1<-B
     C     BOKDC1        CHAIN     CDCON4                             33
     C                   MOVEL     CC4FT         CC4FT1
     C                   MOVE      *ON           *IN28
     C                   END
     C     BOKDC2        IFNE      *BLANKS                                      1<-B
     C     BOKDC2        CHAIN     CDCON4                             33
     C                   MOVEL     CC4FT         CC4FT2
     C                   MOVE      *ON           *IN28
     C                   END
     C     BOKDC3        IFNE      *BLANKS                                      1<-B
     C     BOKDC3        CHAIN     CDCON4                             33
     C                   MOVEL     CC4FT         CC4FT3
     C                   MOVE      *ON           *IN28
     C                   END
     C     BOKDC4        IFNE      *BLANKS                                      1<-B
     C     BOKDC4        CHAIN     CDCON4                             33
     C                   MOVEL     CC4FT         CC4FT4
     C                   MOVE      *ON           *IN28
     C                   END
      *
      *
     C                   MOVEL     BOMN1         BOMN1X
     C                   MOVEL     BOVS1         BOVS1X
     C                   MOVEL     BOMN2         BOMN2X
     C                   MOVEL     BOVS2         BOVS2X
     C                   MOVEL     BOMN3         BOMN3X
     C                   MOVEL     BOVS3         BOVS3X
     C                   MOVEL     BOMN4         BOMN4X
     C                   MOVEL     BOVS4         BOVS4X
      * ANNEN LAYOUT VED CONT.GODS - DOBBELTDEFINERER NOEN FELT
     C     *IN28         IFEQ      *ON
     C                   MOVE      BONT1         BONT1Y
     C                   MOVEL     BOMN1         BOMN1Y
     C                   MOVE      BONT2         BONT2Y
     C                   MOVEL     BOMN2         BOMN2Y
     C                   MOVE      BONT3         BONT3Y
     C                   MOVEL     BOMN3         BOMN3Y
     C                   MOVE      BONT4         BONT4Y
     C                   MOVEL     BOMN4         BOMN4Y
     C                   END
      *
      * TESTER SPRÅKKODE
      *
     C                   MOVE      BOKNBB        KUNDNR
     C     KUNDKE        CHAIN     CUNDL01                            33
     C  N33SPRAAK        COMP      ' '                                2929
     C                   ENDSR
      *
N01   *=====================================================================
N01  C     ARKIVSR       BEGSR
N01   *=====================================================================
N01  C     ARKIVL03K     CHAIN     ARKIVL03                           33
N01  C                   IF        *IN33
N01  C     UFIRM         CHAIN     FIRMARC                            33
N01  C                   IF        *IN33 = *OFF
N01  C     'bo'          CHAIN     ARKTXT                             33
N01  C  N33              IF        ARKJN = 'J'
N01   *
N01  C                   OPEN      ARKIVP
N01  C                   CALL      'SYGE15C'
N01  C                   PARM                    WDT               8
N01  C                   PARM                    WTM               6
N01  C                   MOVE      UFIRM         ARFIRM
N01  C                   MOVE      BOAVD         ARAVD
N01  C                   MOVE      BOOPD         AROPD
N01  C                   EVAL      ARUNDE = XARUNDE
N01  C                   MOVE      'bo'          ARTYPE
N01  C                   MOVE      UUSER         ARUSER
N01  C                   MOVE      WDT           ARDATE
N01  C                   MOVE      WTM           ARTIME
N01  C                   MOVE      KUNDNR        ARKUND
N01  C                   WRITE     ARKIVR
N01  C                   CLOSE     ARKIVP
N01  C                   CALL      'ARC002CLB'
N01  C                   PARM                    ARTYPE
N01  C                   PARM                    ARUSER
N01  C                   END
N01  C                   END
N01  C                   END
N01   *
N01  C                   ENDSR
N01   *
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUNDKE        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     BOOKK         KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    BOSG
     C     HODEK         KLIST
     C                   KFLD                    YNET
     C                   KFLD                    YAVD
     C     FRET2K        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    FRTKOD
     C                   MOVE      'O'           FRTKOD
N01  C     ARKIVL03K     KLIST
N01  C                   KFLD                    XARTYPE
N01  C                   KFLD                    BOAVD
N01  C                   KFLD                    BOOPD
N01  C                   KFLD                    XARUNDE
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVDP             4
     C                   PARM                    UOPDP             7
     C                   PARM                    UNAVN            30
     C                   PARM                    UFAXNR           21
     C                   PARM                    UATTN
     C     UATTN         COMP      *BLANKS                                45
      * HENT STRINGKODE
     C     UFAXNR        IFEQ      *BLANKS
     C                   Z-ADD     29            WTSKRN            3 0
     C                   MOVE      UAVDP         LOSAV2            4 0
     C                   CALL      'SYGE01B'
     C                   PARM                    LOSAV2
     C                   PARM                    WTSKRN
     C                   PARM                    WOPNVN           10
     C                   PARM                    WOPTY            10
     C                   PARM                    WOPHEA            1
     C                   PARM                    WOPFM             5
     C                   PARM                    WLASER            1
     C                   END
      *
     C                   MOVE      UAVDP         YAVD              4 0
     C                   MOVE      UOPDP         YOPD              7 0
N01  C                   MOVE      'bo'          XARTYPE           2
     C                   MOVEL     'BB'          XARUNDE          10
      *
     C                   MOVE      '0'           *IN29
     C                   MOVE      'SF'          YSFUNI            2
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          XIDAGÅ
     C                   ELSE
     C     UYEAR         ADD       2000          XIDAGÅ
     C                   END
     C                   MOVE      UMONTH        XIDAGM
     C                   MOVE      UDAY          XIDAGD
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   MOVE      ' '           YNET              1
     C     HODEK         CHAIN     HODE                               33
      *
N02  C                   MOVEL     'STDBO'       FB01
     C                   ENDSR
      *
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   CALL      'DATOFMT'
     C                   PARM                    UDTD
     C                   PARM                    UDTM
     C                   PARM                    UDTÅ
      *
     C                   ENDSR
      *
     OBOOKINGR  E            BOMRK
     O                       BODTBB
     O                       BOTIBB
