********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11108 * 01 YBC PTF11 OMBEREGNING PÅ OMBEREGNING
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL KOPIERE OPPDRAG TIL OMBEREGNING        ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 05 06 09 11 16 18-22 25 56
      *** LEDIGE INDIKATORER 27 34 37-60 63-67 74 75          ***
      ***********************************************************
      *
S01  F*SADH      IF A E           K DISK
S01  F*SADHOM    IF A E           K DISK    RENAME(SADHR:SADHROM)
S01  F*SADF      IF A E           K DISK
N01  FSADH      UF A E           K DISK
N01  FSADHOM    UF A E           K DISK    RENAME(SADHR:SADHROM)
N01  FSADF      UF A E           K DISK
     FSADV      UF A E           K DISK
     FSADVJ     UF A E           K DISK
     FSADW      UF A E           K DISK
N01  FSADOMT    UF A E           K DISK
N01  FSADOMTH   UF A E           K DISK
N01  FSADOMTF   UF A E           K DISK
N01  FSADOMTV   UF A E           K DISK
N01  FSADOMTVJ  UF A E           K DISK
N01  FSADOMTW   UF A E           K DISK
      *
     C                   EXSR      INIT
N01   *
N01  C                   SELECT
N01  C                   WHEN      UTYPE = 'NYO'                                NY OMBEREGNING
N01  C*                  EXSR      SRNYOMBORI                                   SIST OMBEREGNING
N01  C                   EXSR      SRNYOMB                                      ORIGINAL FORTOLLING
N01  C                   WHEN      UTYPE = 'NYS'                                ANGRE NY OMBEREGNING
N01  C                   EXSR      SRANGOMB
N01  C                   ENDSL
      *
S01  C*    SADHK         CHAIN     SADHOM                             33
N01  C     SADHK         CHAIN(N)  SADHOM                             33
     C                   SELECT
     C                   WHEN      *IN33 AND UTYPE <> 'OMS'
     C                   EVAL      SITDN = UTDN * -1
      *
S01  C*    SADHK         CHAIN     SADH                               33
N01  C     SADHK         CHAIN(N)  SADH                               33
     C                   MULT      -1            SITDN
     C                   EVAL      SIST   = ' '
     C                   EVAL      SISG   = USG
     C                   EVAL      SIMF   = *BLANKS
     C                   MOVE      WDT           SIDT
     C                   WRITE     SADHR
     C                   WRITE     SADHROM
      *
     C                   EVAL      SITDN = UTDN * -1
      *
     C     SADHK         SETLL     SADF
     C     SADHK         READE     SADF                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SFOPDN
     C                   WRITE     SADFR
     C     SADHK         READE     SADF                                   33
     C                   ENDDO
      *
     C     SADHK         SETLL     SADV
     C     SADHK         READE(N)  SADV                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SVTDN
     C                   WRITE     SADVR
     C     SADHK         READE(N)  SADV                                   33
     C                   ENDDO
      *
     C     SADHK         SETLL     SADVJ
     C     SADHK         READE(N)  SADVJ                                  33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SJTDN
     C                   WRITE     SADVJR
     C     SADHK         READE(N)  SADVJ                                  33
     C                   ENDDO
      *
     C     SADHK         SETLL     SADW
     C     SADHK         READE(N)  SADW                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SWTDN
     C                   WRITE     SADWR
     C     SADHK         READE(N)  SADW                                   33
     C                   ENDDO
      *
      * OMSTART: SLETT GAMLE OG LAGE NYE I OMBEREGNINGSOPPDRAG
     C                   WHEN      *IN33 = *OFF AND UTYPE = 'OMS'
      * SLETT GAMLE LINJE I OMBEREGNINGSOPPDRAG (SITDN < 0)
     C     SADHK         SETLL     SADV
     C     SADHK         READE     SADV                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADVR
     C     SADHK         READE     SADV                                   33
     C                   ENDDO
     C     SADHK         SETLL     SADVJ
     C     SADHK         READE     SADVJ                                  33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADVJR
     C     SADHK         READE     SADVJ                                  33
     C                   ENDDO
     C     SADHK         SETLL     SADW
     C     SADHK         READE     SADW                                   33
     C                   DOW       *IN33 = *OFF
     C                   DELETE    SADWR
     C     SADHK         READE     SADW                                   33
     C                   ENDDO
      * LAGE NYE LINJER
     C                   EVAL      SITDN = UTDN * -1
      *
     C     SADHK         SETLL     SADV
     C     SADHK         READE(N)  SADV                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SVTDN
     C                   WRITE     SADVR
     C     SADHK         READE(N)  SADV                                   33
     C                   ENDDO
      *
     C     SADHK         SETLL     SADVJ
     C     SADHK         READE(N)  SADVJ                                  33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SJTDN
     C                   WRITE     SADVJR
     C     SADHK         READE(N)  SADVJ                                  33
     C                   ENDDO
      *
     C     SADHK         SETLL     SADW
     C     SADHK         READE(N)  SADW                                   33
     C                   DOW       *IN33 = *OFF
     C                   MULT      -1            SWTDN
     C                   WRITE     SADWR
     C     SADHK         READE(N)  SADW                                   33
     C                   ENDDO
      *
     C                   ENDSL
      *
     C                   EVAL      *INLR = *ON
     C                   RETURN
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     SADHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    SITDN
N01  C     SADHKOM       KLIST
N01  C                   KFLD                    UAVD
N01  C                   KFLD                    UTDN
N01  C     SADHKORI      KLIST
N01  C                   KFLD                    X_SIAVD
N01  C                   KFLD                    X_SITDN
N01  C     SADOMTK       KLIST
N01  C                   KFLD                    UAVD
N01  C                   KFLD                    UTDN
N01  C                   KFLD                    SIOMBN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG
     C                   PARM                    UTYPE             3
      *
     C     *LIKE         DEFINE    SIAVD         UAVD
     C     *LIKE         DEFINE    SITDN         UTDN
     C     *LIKE         DEFINE    SISG          USG
N01  C     *LIKE         DEFINE    SIAVD         X_SIAVD
N01  C     *LIKE         DEFINE    SITDN         X_SITDN
N01  C     *LIKE         DEFINE    SITLL         X_SITLL
N01  C     *LIKE         DEFINE    SITLE         X_SITLE
N01  C     *LIKE         DEFINE    SIDTG         X_SIDTG
N01  C     *LIKE         DEFINE    SIOMBN        X_SIOMBN
     C                   EVAL      SITDN = UTDN
N01  C                   EVAL      X_SIAVD = UAVD
N01  C                   EVAL      X_SITDN = UTDN * -1
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   ENDSR
      *
N01   ***********************************************
N01  C     SRNYOMB       BEGSR
N01   ***********************************************
N01  C                   EVAL      SIOMBN = 99
N01  C     SADOMTK       SETLL     SADOMT
N01  C     SADHKOM       READPE(N) SADOMT                                 33
N01  C                   IF        *IN33
N01  C                   EVAL      X_SIOMBN = 1
N01  C                   ELSE
N01  C                   EVAL      X_SIOMBN = SIOMBN + 1
N01  C                   END
N01  C                   CLEAR                   SADOMTR
N01  C                   MOVE      WDT           SIDTSL
N01  C                   MOVE      WTM           SITMSL
N01   *
N01  C     SADHKOM       CHAIN(N)  SADHOM                             33
N01  C                   EVAL      SIOMBN = X_SIOMBN
N01  C                   WRITE     SADOMTR
N01  C     SADHKORI      CHAIN(N)  SADH                               33
N01  C                   EVAL      X_SITLL  = SITLL
N01  C                   EVAL      X_SITLE  = SITLE
N01  C                   EVAL      X_SIDTG  = SIDTG
N01  C     SADHKOM       CHAIN     SADH                               33
N01  C                   EVAL      SIOMBN = X_SIOMBN
N01  C                   WRITE     SADOMTHR
N01  C                   EVAL      SITLL  = X_SITLL
N01  C                   EVAL      SITLE  = X_SITLE
N01  C                   EVAL      SIDTG  = X_SIDTG
N01  C                   EVAL      SIMF   = *BLANKS
N01  C                   UPDATE    SADHR
N01  C     SADHKOM       SETLL     SADF
N01  C     SADHKOM       READE(N)  SADF                                   33
N01  C                   EVAL      SFOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTFR
N01  C     SADHKOM       READE(N)  SADF                                   33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADV
N01  C     SADHKOM       READE(N)  SADV                                   33
N01  C                   EVAL      SVOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTVR
N01  C     SADHKOM       READE(N)  SADV                                   33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADVJ
N01  C     SADHKOM       READE(N)  SADVJ                                  33
N01  C                   EVAL      SVOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTVJR
N01  C     SADHKOM       READE(N)  SADVJ                                  33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADW
N01  C     SADHKOM       READE(N)  SADW                                   33
N01  C                   EVAL      SWOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTWR
N01  C     SADHKOM       READE(N)  SADW                                   33
N01  C                   ENDDO
N01   *
N01  C                   EVAL      *INLR = *ON
N01  C                   RETURN
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     SRNYOMBORI    BEGSR
N01   ***********************************************
N01  C                   EVAL      SIOMBN = 99
N01  C     SADOMTK       SETLL     SADOMT
N01  C     SADHKOM       READPE(N) SADOMT                                 33
N01  C                   IF        *IN33
N01  C                   EVAL      X_SIOMBN = 1
N01  C                   ELSE
N01  C                   EVAL      X_SIOMBN = SIOMBN + 1
N01  C                   END
N01  C                   CLEAR                   SADOMTR
N01  C                   MOVE      WDT           SIDTSL
N01  C                   MOVE      WTM           SITMSL
N01   *
N01  C     SADHKOM       CHAIN     SADHOM                             33
N01  C                   EVAL      SIOMBN = X_SIOMBN
N01  C                   WRITE     SADOMTR
N01  C                   DELETE    SADHROM
N01  C                   CLEAR                   SADHROM
N01  C     SADHKOM       CHAIN     SADH                               33
N01  C                   EVAL      SIOMBN = X_SIOMBN
N01  C                   WRITE     SADOMTHR
N01  C                   DELETE    SADHR
N01  C                   CLEAR                   SADHR
N01  C     SADHKOM       SETLL     SADF
N01  C     SADHKOM       READE     SADF                                   33
N01  C                   EVAL      SFOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTFR
N01  C                   DELETE    SADFR
N01  C     SADHKOM       READE     SADF                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SADFR
N01  C     SADHKOM       SETLL     SADV
N01  C     SADHKOM       READE     SADV                                   33
N01  C                   EVAL      SVOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTVR
N01  C                   DELETE    SADVR
N01  C     SADHKOM       READE     SADV                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SADVR
N01  C     SADHKOM       SETLL     SADVJ
N01  C     SADHKOM       READE     SADVJ                                  33
N01  C                   EVAL      SVOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTVJR
N01  C                   DELETE    SADVJR
N01  C     SADHKOM       READE     SADVJ                                  33
N01  C                   ENDDO
N01  C                   CLEAR                   SADVJR
N01  C     SADHKOM       SETLL     SADW
N01  C     SADHKOM       READE     SADW                                   33
N01  C                   EVAL      SWOMBN = X_SIOMBN
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADOMTWR
N01  C                   DELETE    SADWR
N01  C     SADHKOM       READE     SADW                                   33
N01  C                   ENDDO
N01  C                   CLEAR                   SADWR
N01   *
N01  C                   EVAL      UTYPE = 'OMB'
N01   *
N01  C                   ENDSR
N01   *
N01   ***********************************************
N01  C     SRANGOMB      BEGSR
N01   ***********************************************
N01   * SJEKK OM TIDLIGERE OMBEREGNING FINNES
N01  C                   EVAL      SIOMBN = 99
N01  C     SADOMTK       SETLL     SADOMT
N01  C     SADHKOM       READPE(N) SADOMT                                 33
N01  C   33              GOTO      SLANGOMB
N01  C                   EVAL      X_SIOMBN = SIOMBN
N01   *
N01   * SLETT UFERDIG OMBEREGNING
N01  C     SADHKOM       CHAIN     SADHOM                             33
N01  C                   DELETE    SADHROM
N01  C     SADHKOM       CHAIN     SADH                               33
N01  C                   DELETE    SADHR
N01  C     SADHKOM       SETLL     SADF
N01  C     SADHKOM       READE     SADF                                   33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SADFR
N01  C     SADHKOM       READE     SADF                                   33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADV
N01  C     SADHKOM       READE     SADV                                   33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SADVR
N01  C     SADHKOM       READE     SADV                                   33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADVJ
N01  C     SADHKOM       READE     SADVJ                                  33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SADVJR
N01  C     SADHKOM       READE     SADVJ                                  33
N01  C                   ENDDO
N01  C     SADHKOM       SETLL     SADW
N01  C     SADHKOM       READE     SADW                                   33
N01  C                   DOW       *IN33 = *OFF
N01  C                   DELETE    SADWR
N01  C     SADHKOM       READE     SADW                                   33
N01  C                   ENDDO
N01   *
N01   * FLYTT SISTE OMBEREGNING TILBAKE
N01  C                   EVAL      SIOMBN = X_SIOMBN
N01   *
N01  C     SADOMTK       CHAIN     SADOMT                             33
N01  C                   WRITE     SADHROM
N01  C                   DELETE    SADOMTR
N01  C     SADOMTK       CHAIN     SADOMTH                            33
N01  C                   WRITE     SADHR
N01  C                   DELETE    SADOMTHR
N01  C     SADOMTK       SETLL     SADOMTF
N01  C     SADOMTK       READE     SADOMTF                                33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADFR
N01  C                   DELETE    SADOMTFR
N01  C     SADOMTK       READE     SADOMTF                                33
N01  C                   ENDDO
N01  C     SADOMTK       SETLL     SADOMTV
N01  C     SADOMTK       READE     SADOMTV                                33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADVR
N01  C                   DELETE    SADOMTVR
N01  C     SADOMTK       READE     SADOMTV                                33
N01  C                   ENDDO
N01  C     SADOMTK       SETLL     SADOMTVJ
N01  C     SADOMTK       READE     SADOMTVJ                               33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADVJR
N01  C                   DELETE    SADOMTVJR
N01  C     SADOMTK       READE     SADOMTVJ                               33
N01  C                   ENDDO
N01  C     SADOMTK       SETLL     SADOMTW
N01  C     SADOMTK       READE     SADOMTW                                33
N01  C                   DOW       *IN33 = *OFF
N01  C                   WRITE     SADWR
N01  C                   DELETE    SADOMTWR
N01  C     SADOMTK       READE     SADOMTW                                33
N01  C                   ENDDO
N01   *
N01  C     SLANGOMB      TAG
N01  C                   EVAL      *INLR = *ON
N01  C                   RETURN
N01   *
N01  C                   ENDSR
N01   *
