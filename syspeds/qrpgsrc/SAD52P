S25  H*debug(*yes)
N25  H Option( *SrcStmt ) DftActGrp( *No ) BndDir( 'QC2LE' ) debug(*yes)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 Skriv godkjennelsesdato ve utskrift i ettertid
10006 * 02 SH  PTF10 *cr til *ce
10XXX * 03 YBC PTF10 FIRSØKEVEI FLYTTES 3 POS. TIL VENSTRE
10XXX * 04 jov PTF10 AFP-PRINT, AVVIKENDE I FORHOLD TIL PDF (+ PDF NÅ LIK SOM I SAD61P)
10XXX * 05 YBC PTF10 BEHOLD SISTE LEST POST FRA SADAVGE
10XXX * 06 SH  PTF10 innført drawer skuff  ant kopier
10XXX * 07 SH  PTF10 dataliste 70 lang / flyttet kundenummer
10XXX * 08 YBC PTF10 SKRIV DESIMAL PÅ FAKTURASUM
10XXX * 09 YBC PTF10 HENT FAKTURANR OG BETALINGSREF VED KONTAKTOPPGJØR
10XXX * 10 SH  PTF10 tekstretting
10XXX * 11 SH  PTF10 LITT TEKSTFLYTTING   GRUNNET DHL
10XXX * 12 SH  PTF10 tekst fra fri søkevei
10XXX * 13 SH  PTF10 utskuff innført
10024 * 14 YBC PTF10 KODE FOR SAMSLÅING AV LINJER
10XXX * 15 YBC PTF10 SKRIV UT TOTAL BRT.VEKT SOM ER SUM AV LINJEVEKT
10XXX * 16 SH  PTF10 eksterndefinert hovedark + div
10XXX * 17 SH  PTF10 PRINTERSTYRING OVERRIDE PÅ BRUKER
10XXX * 18 SH  PTF10 sjekk ov OVL er blank på bruker
10264 * 19 YBC PTF10 DATALIST ER BYTTET MED SAD61PFT
10XXX * 20 YBC PTF10 HENT DEFAUL VERDIER FRA AVDELING
10XXX * 21 YBC PTF10 FLYTT SVFT PÅ RIKTIG MÅTE
10318 * 22 YBC PTF10 VEKT ER ENDRET FRA 9.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
10XXX * 23 SH  PTF10 hørejustering ved LASER=F
10XXX * 24 SH  PTF10 endret overlay
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11015 * 25 YBC PTF11 SEND XML-FIL TIL EMMA SYSTEM
11XXX * 26 YBC PTF11 NÅ ER DET NOK PLASS TIL GODSNR. TRENG IKKE HØYREINNST.
11XXX * 27 YBC PTF11 *IN34 MÅ BEVARES
11XXX * 28 SH  PTF11 rettelse utskuff
11XXX * 29 YBC PTF11 PRINT OMBEREGNING
11XXX * 30 YBC PTF11 BRUK RIKTIG BANE
11XXX * 31 YBC PTF11 SKRIV UT LØPENR AV OPPRINNELIG SAD PÅ OMBEREGNING
11XXX * 32 YBC PTF11 STATISTISK VERDI MELLOM 0 OG 1 SETTES TIL 1
11XXX * 33 SH  PTF11 endring grunnet brukerstyring
11XXX * 34 YBC PTF11 VEDLEGG TIL EMMA SJEKKER OGSÅ PÅ FIRMA-NIVÅ
11XXX * 35 SH  PTF11 MÅ OGSÅ OPPDATERE HEADF VED A= ARKIV
11XXX * 36 YBC PTF11 SEND TOTAL VEKT SOM ER SUMMERT FRA LINJER TIL EMMA
11XXX * 37 SH  PTF11 opphevet 35
11XXX * 38 SH  PTF11 epostadresse tariffør
11XXX * 39 SH  PTF11 overflow
11XXX * 40 SH  PTF11 Sett på Lr istedfor AV  + ovf 72 på sad52pft
11XXX * 41 YBC PTF11 TELL ANTALL LINJER PÅ UTSKRIFT RUBR. 28
11109 * 42 YBC PTF11 OMBEREGNING PÅ OMBEREGING. IND. 35 ER TATT I BRUK
11XXX * 43 SH  PTF11 MAILTAG I PRINTERFIL print på epost
11176 * 44 YBC PTF11 TILLEGGSLINJER MED SAMME POST
11176 * 45 SH  PTF11 *STD gir standarskriver
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT TOLLDEKLARASJON  (EKSPORT)   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-29 32 36 38 45-47 50-53 55-59 61-69 71-87 94
      ***    IND. 49,91,48 ER TATT I BRUK VED SJØ-OPPDRAG     ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
     H DECEDIT('0,') DATEDIT(*DMY.)
N16  FKODTSI    IF   E           K DISK
     FFRISOK    IF   E           K DISK
N12  FKODFRI    IF   E           K DISK
     FSADAVGE   IF   E           K DISK
     FKODTFM    IF   E           K DISK
N14  FSAEHTL    IF   E           K DISK
     FSAEH      UF   E           K DISK
N29  FSAEHOM    IF   E           K DISK    RENAME(SAEHR:SAEHOMR)
N42  FSAEOMTH   IF   E           K DISK    PREFIX(TO_)
     FSAEH7     IF   E           K DISK    RENAME(SAEHR:SAEH7R)
     FSAEV2     UF   E           K DISK
N14  FSAEV4     UF   E           K DISK    RENAME(SAEVR:SAEV4R)
     FSAEF      IF   E           K DISK
     FSTANDE    IF   E           K DISK
     FHEADF     UF   E           K DISK
     FFIRM      IF   E           K DISK
     FWFILEEXP  UF A E           K DISK    USROPN
     FKODTLB    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FTARI      IF   E           K DISK
N22  FSOKTARI2  IF   E           K DISK
     FKODTP     IF   E           K DISK
N17  FKODTPUSR  IF   E           K DISK
     FEDIM4     IF   E           K DISK
N25  FEDIC      UF   E             DISK
N25  FEDIM      O  A E             DISK    RENAME(EDIMR:EDIMR0)
N25  F                                     PREFIX(M0_)
N25  FEDIS      O  A E             DISK    RENAME(EDISR:EDISR0)
N25  F                                     PREFIX(S0_)
N25  FEDISX     O  A E             DISK    RENAME(EDISXR:EDISXR0)
N25  F                                     PREFIX(X0_)
N25  FCUNDC01   IF   E           K DISK
N25  FFIRMARC   IF   E           K DISK
N25  FARKTXT    IF   E           K DISK
N25  FARKEXT    IF   E           K DISK
N25  FARKIVL02  IF   E           K DISK
N25  FARKVEDK   IF   E           K DISK
N25  FKODTS2    IF   E           K DISK
S16  F*OLLDEK   O    F   85        PRINTER USROPN
S16  F*                                    FORMLEN(72)
S16  F*                                    FORMOFL(72)
N16  FSAD52PF   O    E             PRINTER USROPN
     FTOLLDEK2  O    F   85        PRINTER USROPN
     F                                     FORMLEN(72)
     F                                     FORMOFL(72)
S19  F*ATALIST  O    F   85        PRINTER USROPN
N19  FSAD52PFT  O    E             PRINTER USROPN
N25   *
N25  D FILE_o          s               *
N25  D String          s            512a
N25  D rc              s             10i 0
N25  D Data            s             80a   Varying
N25  D Codepage        s              5a   Varying
N25  D CmdLine         S            512
N25  D CmdLen          S             15  5
N25  D LF              c                   x'25'
N25  Dopen             Pr              *   ExtProc( '_C_IFS_fopen' )
N25  D                                 *   Value Options( *String )
N25  D                                 *   Value Options( *String )
N25  Dfputs            Pr            10i 0 ExtProc( '_C_IFS_fputs' )
N25  D                                 *   Value Options( *String )
N25  D                                 *   Value
N25  Dclose            Pr            10i 0 ExtProc( '_C_IFS_fclose' )
N25  D                                 *   Value
N25  D                 DS
N25  D  WMBR                   1     14
N25  D  WMBRA                  1      1
N25  D  WMBRB                  2     10  0
N25   *
N25  D                 DS
N25  D  XTXT801                1     80
N25  D  XT801                  1     80    DIM(80)
N25  D                 DS
N25  D  XTXT802                1     80
N25  D  XT802                  1     80    DIM(80)
N25  D                 DS
N25  D  AVKVED                 5     64
N25  D  VKD                    1     64    DIM(32)
N25  D VEDL            S            100    DIM(100)
N25  D EDIDTA          DS           256
N25  D  UELIBF               171    180
s16  D*TY              S              2    DIM(12)
s16  D*GL              S              9  0 DIM(12)
s16  D*ST              S              6  3 DIM(12)
s16  D*PR              S              1    DIM(12)
s16  D*BL              S              9  0 DIM(12)
s16  D*T1              S              2    DIM(4)
s16  D*T2              S              9  0 DIM(4)
     D MN              S             17    DIM(20)
     D VS              S             25    DIM(20)
     D F1              S             75    DIM(9)
     D F2              S             75    DIM(9)
     D F3              S             75    DIM(9)
     D F4              S             75    DIM(9)
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
S16  D*                                    FILE(TOLLDEK) -
N16  D                                     FILE(SAD52PF) -
     D                                     OUTQ(')
     D XCMDPDF         C                   CONST('DEVTYPE(')
     D XCMDPDF2        C                   CONST('FRONTOVL(FSAD38)')
     D XCMD12          C                   CONST('OVRPRTF -
     D                                     FILE(TOLLDEK2) -
     D                                     OUTQ(')
     D XCMD13          C                   CONST('OVRPRTF -
S19  D*                                    FILE(DATALIST) -
N19  D                                     FILE(SAD52PFT) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 85) -
     D                                     CPI(10) -
     D                                     OVRFLW(72) -
     D                                     USRDTA(')
N22  D XCMD21A         C                   CONST('PAGESIZE(108 120) -
N22  D                                     LPI(9) -
N22  D                                     CPI(15) -
N22  D                                     OVRFLW(108) -
N22  D                                     USRDTA(')
S19  D*XCMD22          C                   CONST('PAGESIZE(48 85) -
N19  D XCMD22          C                   CONST('PAGESIZE(48 120) -
     D                                     CPI(10) -
     D                                     OVRFLW(48) -
     D                                     USRDTA(')
S07  D*XCMD23          C                   CONST('PAGESIZE(72 85) -
S19  D*XCMD23          C                   CONST('PAGESIZE(70 85) -
S19  D*                                    CPI(10) -
s07  D*                                    OVRFLW(72) -
s40  D*XCMD23          C                   CONST('PAGESIZE(70 120) -
n40  D XCMD23          C                   CONST('PAGESIZE(72 120) -
N19  D                                     CPI(15) -
s40  D*                                    OVRFLW(70) -
n40  D                                     OVRFLW(72) -
     D                                     USRDTA(')
     D XCMD31          C                   CONST(') COPIES(')
     D XCMD01          C                   CONST('CLRPFM -
     D                                     FILE(WFILEEXP) -
     D                                     MBR(SADPRT)')
     D XCMD02          C                   CONST('OVRDBF -
     D                                     FILE(WFILEEXP) -
     D                                     TOFILE(WFILEEXP) -
     D                                     MBR(SADPRT)')
     D                 DS
     D  XANTDL                 1      1  0
     D  XANTD2                 1      1
     D                 DS
     D  WFERNR                 1      5  0
     D  XN2                    2      5  0
     D                 DS
s12  D* FSSOK                  1     35
n12  D  FSSOK00                1     35
     D  FSSO15                 1     15
N11  D  FSSO25                 1     15
N12  D                 DS
N12  D  DFS                    1     10    DIM(10)
N12  D  FSDOKK                 1     10
N12  D                 DS
N12  D  DFRT                   1    210    DIM(3)
N22  D                 DS
N22  D  WFEVKB                 1      9  0
N22  D  WFEVKB123              1     12  3
N22  D                 DS
N22  D  WFEVKN                 1      9  0
N22  D  WFEVKN123              1     12  3
     D                 DS
S22  D* WFEKN1                 1     17
S22  D* WFEKN2                18     34
S22  D* WFEKN3                35     51
S22  D* WFEKN4                52     68
S22  D* WFEKN5                69     85
S22  D* WFEKN6                86    102
S22  D* WFEKN7               103    119
S22  D* KN                     1    119    DIM(7) ASCEND
N22  D  WFEKN1                 1     28
N22  D  WFEKN1A                1     24
N22  D  WFEKN2                29     56
N22  D  WFEKN2A               29     52
N22  D  WFEKN3                57     84
N22  D  WFEKN3A               57     80
N22  D  WFEKN4                85    112
N22  D  WFEKN4A               85    108
N22  D  WFEKN5               113    140
N22  D  WFEKN5A              113    136
N22  D  WFEKN6               141    168
N22  D  WFEKN6A              141    164
N22  D  WFEKN7               169    196
N22  D  WFEKN7A              169    192
N22  D  KN                     1    196    DIM(7) ASCEND
     D                 DS
S22  D* WFEVB1                 1     15
S22  D* WFEVB2                16     30
S22  D* WFEVB3                31     45
S22  D* WFEVB4                46     60
S22  D* WFEVB5                61     75
S22  D* WFEVB6                76     90
S22  D* WFEVB7                91    105
S22  D* WFEVB71               91    105
S22  D* VB                     1    105
S22  D*                                    DIM(7) ASCEND
N22  D  WFEVB1                 1     30
N22  D  WFEVB2                31     60
N22  D  WFEVB3                61     90
N22  D  WFEVB4                91    120
N22  D  WFEVB5               121    150
N22  D* WFEVB6               151    180
N22  D* WFEVB7               181    210
N22  D* WFEVB71              181    210
N22  D  VB                     1    210    DIM(7) ASCEND
     D                 DS
     D  WFETO1                 1     45
N16  D  WFETO1A                1     17
     D  WFETO2                46     90
N16  D  WFETO2A               46     62
     D  WFETO3                91    135
N16  D  WFETO3A               91    107
     D  WFETO4               136    180
N16  D  WFETO4A              136    152
     D  WFETO5               181    225
N16  D  WFETO5A              181    197
N22  D  WFETO6               226    270
N22  D  WFETO7               271    315
N22  D  WFETO8               316    360
N22  D  WFETO9               361    405
N22  D  WFETO10              406    450
N22  D  WFETO11              451    495
N22  D  WFETO12              496    540
N22  D  WFETO13              541    585
N22  D  WFETO14              586    630
N22  D  WFETO15              631    675
S22  D* TO                     1    225    DIM(5)
N22  D  TO                     1    675    DIM(15)
     D                 DS
     D  WFETC1                 1      3
     D  WFETC2                 4      6
     D  WFETC3                 7      9
     D  WFETC4                10     12
     D  WFETC5                13     15
N22  D  WFETC6                16     18
N22  D  WFETC7                19     21
N22  D  WFETC8                22     24
N22  D  WFETC9                25     27
N22  D  WFETC10               28     30
N22  D  WFETC11               31     33
N22  D  WFETC12               34     36
N22  D  WFETC13               37     39
N22  D  WFETC14               40     42
N22  D  WFETC15               43     45
S22  D* TC                     1     15    DIM(5)                               Cref ved komm.
N22  D  TC                     1     45    DIM(15)                              Cref ved komm.
     D                 DS
     D  XWFVN1                 1      6  0
     D  XWFVN2                 7      8  0
     D  WFEVNT                 1      8  0
     D                 DS
     D  SEFIDÅ                 1      4  0
     D  SEFIDM                 5      6  0
     D  SEFIDD                 7      8  0
     D  SEFID                  1      8  0
     D                 DS
     D  SFÅR                   1      4  0
     D  SFMND                  5      6  0
     D  SFDAG                  7      8  0
     D  SFDT                   1      8  0
     D                 DS
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D  SVTOPL                 1     45
     D                 DS
     D  XDP1                   1      1  0
     D  SEDP                   1      2  0
     D                 DS
     D  SVVNT                  1      8  0
     D  SVFYL                  9     10
     D  SVAVT                 11     11
     D  SVAVTS                12     14
S22  D* SVAVTP                15     17P 3
S22  D* XBRUD1                 1     17
N22  D  SVAVTP                15     21  3
N22  D  XBRUD1                 1     21
     D  UDD                    5      6  0
     D                 DS
     D  DTWS                   1     10
     D  DTUSER                11     20
     D  DTIN39                21     21
     D  DTPRT1                22     31
     D  DTPRT2                32     41
     D  DTPRT3                42     51
     D  DTDTA                  1    128
S26  C*                DS
S26  C* SEPOS                  1      8
S26  C* SEPO06                 1      6
S26  C* SEPO26                 2      6
S26  C* SEPO36                 3      6
S26  C* SEPO46                 4      6
S26  C* SEPO56                 5      6
S26  C* SEPO66                 6      6
S26  C*                DS
S26  C* UTGNPO                 1     22
S26  C* UTGN                   1     16
S26  C* UTPO06                17     22
n01  D                 DS
n01  D  SEDTG                  1     10
n01  D  SEAAR                  1      4
n01  D  SEMND                  5      6
n01  D  SEDAG                  7      8
n01  D                 DS
n01  D  PRODAT                 1     10
n01  D  PRAAR                  1      4
n01  D  PRMND                  6      7
n01  D  PRDAG                  9     10
n16  D                 DS
n16  D  SEAVD                  1      4  0
n16  D  SEAVD1                 1      4  0
S29  D*                DS
S29  D* SETDN                  1      7  0
S29  D* SETDN1                 1      7  0
n16  D                 DS
n16  D  SESG                   1      3
n16  D  SESG1                  1      3
n16  D                 DS
n16  D  WFEVT                  1      4
n16  D  WFEVT1                 1      4
n16  D                 DS
n16  D  WFEANT                 1      6  0
n16  D  WFEANT1                1      6  0
n16  D                 DS
n16  D  SENAD                  1     30
n16  D  SENAD1                 1     30
n16  D                 DS
n16  D  WTY01                  1      2
n16  D  WTY02                  3      4
n16  D  WTY03                  5      6
n16  D  WTY04                  7      8
n16  D  WTY05                  9     10
n16  D  WTY06                 11     12
n16  D  WTY07                 13     14
n16  D  WTY08                 15     16
n16  D  WTY09                 17     18
n16  D  WTY10                 19     20
n16  D  WTY11                 21     22
n16  D  WTY12                 22     24
n16  D  TY                     1     24    DIM(12)
n16  D                 DS
n16  D  WGL01                  1      9  0
n16  D  WGL02                 10     18  0
n16  D  WGL03                 19     27  0
n16  D  WGL04                 28     36  0
n16  D  WGL05                 37     45  0
n16  D  WGL06                 46     54  0
n16  D  WGL07                 55     63  0
n16  D  WGL08                 64     72  0
n16  D  WGL09                 73     81  0
n16  D  WGL10                 82     90  0
n16  D  WGL11                 91     99  0
n16  D  WGL12                100    108  0
n16  D  GL                     1    108  0 DIM(12)
n16  D                 DS
S22  D* WST01                  1      6  3
S22  D* WST02                  7     12  3
S22  D* WST03                 13     18  3
S22  D* WST04                 19     24  3
S22  D* WST05                 25     30  3
S22  D* WST06                 31     36  3
S22  D* WST07                 37     42  3
S22  D* WST08                 43     48  3
S22  D* WST09                 49     54  3
S22  D* WST10                 55     60  3
S22  D* WST11                 61     66  3
S22  D* WST12                 67     72  3
S22  D* ST                     1     72  3 DIM(12)
N22  D  WST01                  1      7  3
N22  D  WST02                  8     14  3
N22  D  WST03                 15     21  3
N22  D  WST04                 22     28  3
N22  D  WST05                 29     35  3
N22  D  WST06                 36     42  3
N22  D  WST07                 43     49  3
N22  D  WST08                 50     56  3
N22  D  WST09                 57     63  3
N22  D  WST10                 64     70  3
N22  D  WST11                 71     77  3
N22  D  WST12                 78     84  3
N22  D  ST                     1     84  3 DIM(12)
n16  D                 DS
n16  D  WPR01                  1      1
n16  D  WPR02                  2      2
n16  D  WPR03                  3      3
n16  D  WPR04                  4      4
n16  D  WPR05                  5      5
n16  D  WPR06                  6      6
n16  D  WPR07                  7      7
n16  D  WPR08                  8      8
n16  D  WPR09                  9      9
n16  D  WPR10                 10     10
n16  D  WPR11                 11     11
n16  D  WPR12                 12     12
n16  D  PR                     1     12    DIM(12)
n16  D                 DS
n16  D  WBL01                  1      9  0
n16  D  WBL02                 10     18  0
n16  D  WBL03                 19     27  0
n16  D  WBL04                 28     36  0
n16  D  WBL05                 37     45  0
n16  D  WBL06                 46     54  0
n16  D  WBL07                 55     63  0
n16  D  WBL08                 64     72  0
n16  D  WBL09                 73     81  0
n16  D  WBL10                 82     90  0
n16  D  WBL11                 91     99  0
n16  D  WBL12                100    108  0
n16  D  BL                     1    108  0 DIM(12)
n16  D                 DS
n16  D  WT101                  1      2
n16  D  WT102                  3      4
n16  D  WT103                  5      6
n16  D  WT104                  7      8
n16  D  WT105                  9     10
n16  D  WT106                 11     12
n16  D  WT107                 13     14
n16  D  WT108                 15     16
n16  D  WT109                 17     18
n16  D  WT110                 19     20
n16  D  WT111                 21     22
n16  D  WT112                 23     24
n16  D  T1                     1     24    DIM(12)
n16  D                 DS
n16  D  WT201                  1      9  0
n16  D  WT202                 10     18  0
n16  D  WT203                 19     27  0
n16  D  WT204                 28     36  0
n16  D  WT205                 37     45  0
n16  D  WT206                 46     54  0
n16  D  WT207                 55     63  0
n16  D  WT208                 64     72  0
n16  D  WT209                 73     81  0
n16  D  WT210                 82     90  0
n16  D  WT211                 91     99  0
n16  D  WT212                100    108  0
n16  D  T2                     1    108  0 DIM(12)
N42  D                 DS
N42  D  TOMBL                  1     40    DIM(4)
N42  D  TO1_SETLL              1     10
N42  D  TO2_SETLL             11     20
N42  D  TO3_SETLL             21     30
N42  D  TO4_SETLL             31     40
N42  D                 DS
N42  D  TOMBE                  1     24    DIM(4)
N42  D  TO1_SETLE              1      6
N42  D  TO2_SETLE              7     12
N42  D  TO3_SETLE             13     18
N42  D  TO4_SETLE             19     24
     D                 DS
     D  SVFT01                 1     28
     D  SVFT02                29     56
     D  SVFT03                57     84
     D  SVFT04                85    112
     D  SVFT05               113    140
     D  SVFT06               141    168
     D  SVFT07               169    196
     D  SVFT                   1    224    DIM(8)
     D                 DS
     D  SVNT01                 1      6  0
     D  SVNT02                 7     12  0
     D  SVNT03                13     18  0
     D  SVNT04                19     24  0
     D  SVNT05                25     30  0
     D  SVNT06                31     36  0
     D  SVNT07                37     42  0
     D  SVNT                   1     48  0 DIM(8)
     D                 DS
     D  SVEH01                 1      4
     D  SVEH02                 5      8
     D  SVEH03                 9     12
     D  SVEH04                13     16
     D  SVEH05                17     20
     D  SVEH06                21     24
     D  SVEH07                25     28
     D  SVEH                   1     32    DIM(8)
     D                 DS
     D  SVVT01                 1     30
     D  SVVT02                31     60
     D  SVVT03                61     90
     D  SVVT04                91    120
     D  SVVT05               121    150
     D  SVVT                   1    240    DIM(8)
     D                 DS
     D  SVTOP1                 1     17
     D  SVTOP2                18     34
     D  SVTOP3                35     51
     D  SVTOP4                52     68
     D  SVTOP5                69     85
     D  SVTOP6                86    102
     D  SVTOP7               103    119
     D  SVTOP8               120    136
     D  SVTOP9               137    153
     D  SVTOP10              154    170
     D  SVTOP                  1    187    DIM(11)
     D                 DS
     D  SVCRE1                 1      3
     D  SVCRE2                 4      6
     D  SVCRE3                 7      9
     D  SVCRE4                10     12
     D  SVCRE5                13     15
     D  SVCRE6                16     18
     D  SVCRE7                19     21
     D  SVCRE8                22     24
     D  SVCRE9                25     27
     D  SVCRE10               28     30
     D  SVTCR                  1     33    DIM(11)
      *
     C                   MOVEL     'SAD52PQ'     UDTAQ            10
     C                   MOVEL     '*LIBL'       ULIBL            10
     C                   Z-ADD     128           ULENGT            5 0
     C                   MOVE      *BLANKS       UDTA            128
     C                   Z-SUB     99999         UWAIT             5 0
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C     START0        TAG
     C                   EXSR      INIT
      *
      * SPESIALBEHANDLING VED FAX
      *
     C     PRTTYP        IFEQ      'F'
s37  C**   PRTTYP        oreq      'A'
N37  C     PRTTYP        oreq      'A'
N25  C     PRTTYP        OREQ      'X'
     C                   SETON                                        32
     C     PRTAVX        CHAIN     STANDE                             33
     C     FAXTD         CHAIN(N)  SAEH                               30
s16  C*                  OPEN      TOLLDEK
n16  C                   OPEN      SAD52PF
     C                   OPEN      TOLLDEK2
S19  C*                  OPEN      DATALIST
N19  C                   OPEN      SAD52PFT
     C  N30              EXSR      PRINT
s16  C*                  CLOSE     TOLLDEK
n16  C                   CLOSE     SAD52PF
     C                   CLOSE     TOLLDEK2
S19  C*                  CLOSE     DATALIST
N19  C                   CLOSE     SAD52PFT
     C                   GOTO      SLUTT
     C                   END
     C*
      *
      *** LES TOLLDEK. FRA SAEH-REGISTER. OG TEST OM AVDELING ER SAMMEN
      ***   SOM FORRIGE TOLLDEK. HVIS IKKE, HENTES AVDELINGSDATA OG GÅ
      ***   UT PROGRAM FOR Å ORDNE ALLE PRINTERSTYRING (SETT UIN02='1')
      ***   SÅ GÅ TILBAKE TIL PROGRAM.
      *
     C     SAEH7K        SETLL     SAEH7                              30
     C     START         TAG
     C     SAEH7K        READE     SAEH7                                  30
     C  N30SEAVD         IFNE      UAVD
     C                   GOTO      SLUTT
     C                   END
      *** IND. 32 PÅ BETYR AT DET SKAL KOMME UT UTSKRIFT.
      *** UTOLK = J ---> DENNE TOLLDEK. SKAL VIA KOMMUNIKASJON (TVINN)
     C  N30              DO
     C                   EXSR      OVRFHV
n33  C                   EXSR      OVRF
s16  C*                  OPEN      TOLLDEK
n16  C                   OPEN      SAD52PF
     C                   OPEN      TOLLDEK2
S19  C*                  OPEN      DATALIST
N19  C                   OPEN      SAD52PFT
     C                   EXSR      PRINT
s16  C*                  CLOSE     TOLLDEK
n16  C                   CLOSE     SAD52PF
     C                   CLOSE     TOLLDEK2
S19  C*                  CLOSE     DATALIST
N19  C                   CLOSE     SAD52PFT
     C                   END
      *** FERDIG Å BEHANDLE EN TOLLDEK. OG GÅ TIL NESTE TOLLDEK.
     C  N30              GOTO      START
      *
     C     SLUTT         TAG
     C                   CLOSE     WFILEEXP
     C     PRTTYP        IFNE      'F'
     C     PRTTYP        andne     'A'
N25  C     PRTTYP        ANDNE     'X'
     C     PRTTYP        ANDNE     'H'
     C                   GOTO      START0
     C                   ELSE
      * FORTELLER FAX OM DATALISTE ER PRODUSERT
     C                   MOVE      FAXDE2        PRTTYP
     C                   END
     C                   SETON                                        LR
      ***********************************************
     C     PRINT         BEGSR
      ***********************************************
N31  C                   IF        SETDN < 0
N31  C                   EVAL      SETDN = SETDN * -1
N31  C     SAEHK         CHAIN(N)  SAEH                               33
N31  C                   MOVE      SEDTG         OMB_SEDTG
N31  C                   MOVE      SETLL         OMB_SETLL
N31  C                   MOVE      SETLE         OMB_SETLE
N31  C                   EVAL      SETDN = SETDN * -1
N31  C                   END
     C     SAEHK         CHAIN     SAEH                               33
     C   33              GOTO      SLPRI
N25   *
N25  C                   MOVE      'N'           XSNDEMMA          1
N25   * VED TEST * LINJE UNDER OG LINJE MED END PÅ DENNE OG LINJE MED "GOTO STPRI0"
N25  C                   IF        PRTTYP = 'X'
N25  C     CUNDC01K      CHAIN     CUNDC01                            33
N25  C                   DOW       *IN33 = *OFF
N25  C                   IF        CTYPE = '*SAD EKSPORT' AND CLIVE = 'X'
N25  C     EDIM4KS       SETLL     EDIM4
N25  C     EDIM4KS       READPE    EDIM4                                  33
N25  C                   DOW       *IN33 = *OFF
N25  C                   IF        M0065 = 'XMLEMA' AND M1001 = '830'
N25  C                   GOTO      STPRI0
N25  C                   END
N25  C     EDIM4KS       READPE    EDIM4                                  33
N25  C                   ENDDO
N25  C   33              EVAL      XSNDEMMA = 'J'
N25  C                   GOTO      STPRI0
N25  C                   END
N25  C     CUNDC01K      READE     CUNDC01                                33
N25  C                   ENDDO
N25  C     STPRI0        TAG
N25  C                   IF        XSNDEMMA = 'N'
N25  C                   UPDATE    SAEHR
s40  C*                  EVAL      *INLR = *OFF
n40  C                   EVAL      *INLR = *ON
N25  C                   RETURN
N25  C                   END
N25  C                   END
N14  C     SAEHK         CHAIN     SAEHTL                             33
N14  C   33              EVAL      SESAM = 'J'
n01   * fikser dato  dagens hvis ikke godkjent
n01  c                   movel     '    .  .  '  prodat
n01  C     sedtg         ifne      *blanks
n01  c                   move      sedag         prdag
n01  c                   move      semnd         prmnd
n01  c                   move      seaar         praar
n01  c                   else
n01  c                   move      '2000'        praar
n01  c                   move      uyear         praar
n01  c                   move      umonth        prmnd
n01  c                   move      uday          prdag
n01  c                   end
     C                   CLEAR                   WFILEER
     C                   CLEAR                   SAEVR
     C                   MOVE      *ZEROS        XVNTM             9 0
      *
     C     TVIM4K        SETLL     EDIM4
     C     STPRI1        TAG
     C     TVI41K        READPE    EDIM4                                  33
     C  N33M1N07         IFEQ      'DIU'
     C                   MOVE      '1'           *IN33
     C                   ELSE
     C     M1N07         IFNE      'DUA'
     C     M1N07         ANDNE     'DME'
     C     M1N07         ANDNE     'DPU'
     C     M1N07         ANDNE     'DTK'
     C                   GOTO      STPRI1
     C                   END
     C     M1001         CABNE     '830'         STPRI1
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      M0068A        XEDT              8 0
     C                   ELSE
     C                   MOVE      SEDT          XEDT
     C                   END
     C                   MOVE      '0'           *IN33
      *
N29   *** IND. 26 OMBEREGNING
N29  C     SETDN         COMP      0                                    26
N29  C  N26              Z-ADD     SETDN         SETDN1
N29  C   26              Z-SUB     SETDN         SETDN1
N29  C   26SAEHK         CHAIN     SAEHOM                             33
      *** IND. 37 PÅ BETYR UTLEVERINGSATTEST
     C     SEMF          COMP      'DUA'                                  37
      *
     C     SEMF          COMP      'DTK'                                  34
N09   *
N09   * VED KONTAKTOPPGJØR HENTER FAKTURA
N09  C     FRIKEYTLI     CHAIN     FRISOK                             33
N09  C  N33              EVAL      XBETALT = 'Betalt: '
N09  C  N33              EVAL      XFAKTNR = 'Fakturanr: '
N09  C                             + %TRIM(FSSOK)
N09  C   33              MOVE      *BLANKS       XBETALT          30
N09  C   33              MOVE      *BLANKS       XFAKTNR          30
N09   *
N09   * VED KONTAKTOPPGJØR HENTER BETALINGSREF
N09  C     FRIKEYTLP     CHAIN     FRISOK                             33
N09  C  N33              EVAL      XBETALL = 'Betalingsref: '
N09  C                             + %TRIM(FSSOK)
N09  C   33              MOVE      *BLANKS       XBETALL          30
N09   *
      *
N12  C                   MOVE      *BLANKS       FSSOK00
     C     FRIKEY        CHAIN     FRISOK                             33
N12  C  N33              MOVEL     fssok         fssok00
     C   33              MOVE      *BLANKS       FSSOK
      *** HENTE CONTAINERNR. OG TESTE OPPDRAGSTYEP
     C     HEADFK        CHAIN(N)  HEADF                              33
     C   33              MOVE      *BLANKS       HETRCN
     C   33              MOVE      *ZEROS        HEKNA
     C     SEUR          COMP      'G'                                    48
     C  N48              SETOFF                                       91
     C   48HETRCN        COMP      *BLANKS                                91
      *
      * TDOK: HVIS AGENT I RUBR 8. SKAL MOTTAKER I RUBR 31
     C                   MOVE      *OFF          *IN95
     C     SEKNS         IFNE      *ZEROS
     C     SEKNS         COMP      HEKNA                                  95
     C                   END
      *
      *** SET NØDVENDIGE INDIKATORER PÅ/AV
     C                   EXSR      SETI1
      *
      *** I SUMVAR GJØR NØDVENDIGE BEREGNINGER (SUMMER VARELINJER)
      ***   OG SKRIV UT DETALJLINJER PÅ WFILEEXP
N14  C                   IF        SESAM = 'N'
N14   * OMNUMMERE LINJENR
N14  C                   MOVE      *ZEROS        XVLN1             5 0
N14  C                   MOVE      *ZEROS        XVLN2             5 0
N14  C     SAEHK         SETLL     SAEV4
N14  C     SAEHK         READE     SAEV4                                  33
N14  C                   DOW       *IN33 = *OFF
N14  C                   IF        SVLN <> 0
N14  C                   IF        ((SVLN = XVLN2) OR (SVVKTB = 0))
N14  C                   EVAL      SVLN  = XVLN1
N14  C                   ELSE
N14  C                   EVAL      XVLN2 = SVLN
N14  C                   ADD       1             XVLN1
N14  C                   EVAL      SVLN  = XVLN1
N14  C                   END
N14  C                   END
N14  C                   EXCEPT    SAEVL4
N14  C     SAEHK         READE     SAEV4                                  33
N14  C                   ENDDO
N14  C                   END
N36  C                   MOVE      *ZEROS        XTVKTBEMMA        9 0
     C                   EXSR      SUMVAR
     C     XNR           IFEQ      0
     C                   Z-ADD     1             XNTF              5 0
     C                   ELSE
     C                   Z-ADD     XNR           XNTF
     C                   END
N29  C   26              Z-ADD     XNROMB        XNTF
      *** 32 PÅ ---> SKRIVE FAKTURALINJER
     C                   EXSR      UTR28
      *
      *** SET NØDVENDIGE INDIKATORER PÅ/AV
     C                   EXSR      SETI2
N25   *
N25  C                   IF        XSNDEMMA = 'J'                               1<-B
N25  C                   EXSR      SREMMA1
N25  C                   END                                                    1<-E
      *
      *** TESTE OM DET SKAL BRUKE DATALISTE (EVENTUELL VANLIG ELLER A4)
      ***   UDL = J --> VANLIG DATALISTE;  UDL = 1 --> A4-LISTE
      *** XNR       --> ANTALL VARELINJER;
      *** XLANT + 1 --> MIN. ANTALL VARELINJER FOR Å BRUKE DATALISTE
      *** PRINT2 --> SKRIVE UT TOLLDEK. PÅ DATALISTE
      *** PRINT3 --> SKRIVE UT TOLLDEK. PÅ TOLDEK.FORMULAR
     C     UDL           IFEQ      'J'
     C     UDL           OREQ      '1'
     C     XNR           IFGT      XLANT
N29  C     *IN26         ANDEQ     *OFF
N29  C     XNROMB        ORGT      XLANT
N29  C     *IN26         ANDEQ     *ON
     C                   EXSR      PRINT2
     C                   ELSE
     C                   EXSR      PRINT3
     C                   END
     C                   ELSE
     C                   EXSR      PRINT3
     C                   END
N29   *
N42  C                   IF        *IN26
N42  C                   EVAL      *IN35 = *OFF
N42  C                   MOVE      *ZEROS        XN_OMB            1 0
N42  C                   MOVE      *BLANKS       TOMBE
N42  C                   MOVE      *BLANKS       TOMBL
N42  C     SAEHK         SETLL     SAEOMTH
N42  C     SAEHK         READE     SAEOMTH                                33
N42  C                   DOW       *IN33 = *OFF
N42  C                   EVAL      *IN35 = *ON
N42  C                   ADD       1             XN_OMB
N42  C                   MOVE      TO_SETLE      TOMBE(XN_OMB)
N42  C                   MOVE      TO_SETLL      TOMBL(XN_OMB)
N42  C                   IF        XN_OMB = 4
N42  C                   LEAVE
N42  C                   END
N42  C     SAEHK         READE     SAEOMTH                                33
N42  C                   ENDDO
N42  C                   END
N29   * SKRIV UT OMBEREGNING
N29  C   26              WRITE     OMBEREGN
      * INGEN OPPDATERING VED FAXING
      *
     C     PRTTYP        IFEQ      'F'
S37  C*    PRTTYP        oreq      'A'
N25  C     PRTTYP        OREQ      'X'
     C                   GOTO      SLPRI
     C                   END
     C*
      *
      *** OPPDATERE SAEH-/HEAD-REGISTER
     C                   MOVE      'P'           SEST
     C   37              MOVE      'U'           SEST
     C                   MOVE      *BLANKS       SEWS
     C                   EXCEPT    UPDSAE
N12  C                   MOVE      *BLANKS       FSSOK00
     C     FRIKEY        CHAIN     FRISOK                             33
     C   33              MOVE      *BLANKS       FSSOK
N12  C  N33              MOVEL     fssok         fssok00
     C     HEADFK        CHAIN     HEADF                              33
     C  N33              MOVE      'P'           HEPK6
     C  N33              MOVE      XNTF          HENTF
     C  N33              UPDATE    HEADFR
      * UPDATE TAXES/PRICES TO INVOICE
     C  N33*IN33         IFEQ      '0'
     C                   CALL      'SYFA50'
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   ENDIF
      *
S25  C*    SLPRI         ENDSR
N25  C     SLPRI         TAG
N25  C                   IF        XSNDEMMA = 'J'                               1<-B
N25  C                   EXSR      SREMMA9
N25  C                   END                                                    1<-E
N25   *
N25  C                   ENDSR
N25   *
      ***********************************************
     C     SETI1         BEGSR
      ***********************************************
      *
     C     SERG          IFEQ      *BLANKS
     C                   MOVEL     'IKKE REG'    XRG              11
     C                   MOVE      '.  '         XRG
     C                   ELSE
     C                   MOVE      SERG          XRG
      * IKKE SKRIV UT HELE PERSONNR. FOR PRIVATPERSONER
     C     1             SUBST     XRG:11        PERSN             1
     C                   IF        PERSN <> *BLANKS
     C                   MOVE      '******'      XRG
     C                   END
     C                   END
      *** HENTE OMREGNINGSFAKTOR AV VALUTA (FAKTURA)
     C     KODVAK        SETGT     KODTVAL2
     C     SEVAL1        READPE    KODTVAL2                               33
      * HVIS IKKE FINNES, FORSØK PÅ SENERE DATO
     C   33KODVAK        SETGT     KODTVAL2
     C   33SEVAL1        READE     KODTVAL2                               33
     C   33SEVAL1        IFEQ      'IEP'
     C                   Z-ADD     1             KVAOMR
     C                   ELSE
     C                   Z-ADD     100           KVAOMR
     C                   END
     C     KODLBK        CHAIN     KODTLB                             33
     C  N33              MOVE      KLBKT         SELV2
      *
     C                   MOVE      *ZEROS        XNR               5 0
N29  C                   MOVE      *ZEROS        XNROMB            5 0
     C                   MOVE      *ZEROS        XN2               4 0
     C                   MOVE      *ZEROS        XN3               5 0
     C                   MOVE      *ZEROS        XTOTT             9 0
      * XTOLKL SKAL INNEHOLDE SPESIFISERTE KOLLI
     C                   MOVE      *ZEROS        XTOTKL            6 0
      *
      *** 40 PÅ ---> SKRIVE ANDRE KOSTNAD (JUSTERING)
      *** 96 PÅ ---> SKRIVE FORTEGN BAK JUSTERING
     C     SEBEL3        COMP      0                                  4040
     C   40SEFTG2        COMP      '-'                                    96
     C   40
     CANN96SEFTG2        COMP      'M'                                    96
      *
     C                   ENDSR
      ***********************************************
     C     SETI2         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        T2
      *** SEFIDÅ = 0 (69 PÅ) ---> TOLLDEK. ER PÅ 2000-TALLET
      *** SEFIDÅ > 0 (69 AV) ---> TOLLDEK. ER PÅ 1900-TALLET
     C     SEFID         COMP      0                                  9292
      *** 93 PÅ ---> TRANSASJONSTYPE = 0 OG IKKE SKRIVE FAKT.SUM
     C     SETST         COMP      0                                      93
      *** 89 PÅ ---> IKKE SKRIVE FAKTURASUM
     C     SEDP          COMP      22                                     89
     C     SEDP          COMP      12                                     89
     C  N89SEDP          COMP      22                                     89
     C  N89SEDP          COMP      30                                     89
     C  N89SEDP          COMP      35                                     89
     C  N89SEDP          COMP      36                                     89
      *
      *** 41 PÅ ---> SKRIVE 'DAGSOPPGJØR'
      *** 42 PÅ, SEKTC=' '  ---> SKRIVE 'KONTANT'
     C                   SETOFF                                       43
     C     SEKDDK        COMP      'D'                                    41
     C   41SEKTC         COMP      ' '                                    41
     C     SEKDDK        COMP      'K'                                    42
     C     SEBEL1        COMP      0                                      43
      *** 54 PÅ ---> SKRIVE FERSK FISK AVGIFT
     C     XTOTT         COMP      100                                54
      * XRESKL SKAL INNEHOLDE 1 ELLER DIFERANSE MELLOM XTOTKL OG SENTK
     C     SENTK         IFGT      XTOTKL
     C     SENTK         SUB       XTOTKL        XRESKL            6 0
     C                   ELSE
     C                   Z-ADD     1             XRESKL
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     SUMVAR        BEGSR
      ***********************************************
N15  C                   MOVE      *ZEROS        XTVKTB            9 0
      *** DERSOM SJØ-OPPDRAG, HENTER MERKE & NR.
     C   48              DO
     C                   CALL      'SAD61PBL'
     C                   PARM      SEAVD         UAVD2             4 0
     C                   PARM      SETDN         UTDN              7 0
     C                   PARM                    UNR               2 0
     C                   PARM                    MN
     C                   PARM                    UN2               2 0
     C                   PARM                    VS
     C                   END
N29  C                   MOVE      'J'           XORI              1
N29  C                   MOVE      'J'           XTOTSLT           1
      *** XBEL1 = FAKTURASUM + FRAKT
     C     SEBEL2        IFEQ      0                                            1<-B
     C     SEFTG2        OREQ      'P'
     C     SEFTG2        OREQ      'M'
     C                   Z-ADD     0             XBEL1            13 2
     C                   ELSE                                                   1
     C     SEVAL2        IFEQ      SEVAL1                                         2<-B
     C                   Z-ADD     SEBEL2        XBEL1
     C                   ELSE                                                     2
     C     SEVKU         IFEQ      0
     C                   Z-ADD     0             XWORK
     C                   ELSE
     C     SEBEL3        DIV       SEVKU         XWORK
     C                   ENDIF
     C     XWORK         MULT      KVAOMR        XBEL1
     C                   END                                                      2<-E
     C                   END                                                    1<-E
     C     SEFTG2        IFEQ      '-'
     C     SEFTG2        OREQ      'M'
     C     SEBEL1        SUB       XBEL1         XBEL1
     C                   ELSE
     C     SEBEL1        ADD       XBEL1         XBEL1
     C                   END
      *** OMREGNE FAKTURASUM +FRAKT TIL NOK VED UTFØRSEL
     C     XBEL1         IFNE      0
     C     KVAOMR        IFEQ      0
     C                   Z-ADD     0             XWORK
     C                   ELSE
     C     XBEL1         DIV       KVAOMR        XWORK            15 5
     C                   ENDIF
     C     XWORK         MULT(H)   SEVKU         XSUMSV           11 0
     C                   END
      *** ---------------------------------------------
      *
N14  C                   IF        SESAM = 'N'
N14  C                   MOVE      *ZEROS        XVLN              5 0
N14  C     SAEV2K        SETLL     SAEV4
N14  C                   ELSE
S22  C*                  MOVE      *BLANKS       XBRUD2           17
N22  C                   MOVE      *BLANKS       XBRUD2           21
     C     SAEV2K        SETLL     SAEV2                              33
N14  C                   END
      *
      *** SAMSLÅING AV VARELINJER
     C     STSV          TAG
N14  C                   IF        SESAM = 'N'
N14  C     SAEV2K        READE     SAEV4                                  33
N29  C  N33              IF        XORI = 'J'
N29  C                   IF        SVNYL = 'J'
N29  C                   GOTO      STSV
N29  C                   END
N29  C                   ELSE
N29  C                   IF        SVNYL <> 'J'
N29  C                   GOTO      STSV
N29  C                   END
N29  C                   END
N29  C   33              IF        SETDN < 0 AND XORI = 'J'
N29  C                   EVAL      XORI = 'N'
N29  C     SAEV2K        SETLL     SAEV4
N29  C                   GOTO      STSV
N29  C                   END
N14  C  N33SVLN          IFEQ      0
N14  C                   EXCEPT    SAEVD4
N14  C                   GOTO      STSV
N14  C                   ENDIF
N14  C                   ELSE
     C     SAEV2K        READE     SAEV2                                  33
N29  C  N33              IF        XORI = 'J'
N29  C                   IF        SVNYL = 'J'
N29  C                   GOTO      STSV
N29  C                   END
N29  C                   ELSE
N29  C                   IF        SVNYL <> 'J'
N29  C                   GOTO      STSV
N29  C                   END
N29  C                   END
N14  C                   END
      *** XBRUD2 <> BLANK ---> SISTE SAMSLÅENDE LINJE SKAL TIL ARB.FIL
N14  C   33              IF        SESAM = 'N'
N14  C     XVLN          IFNE      0
N14  C                   EXSR      REGN
N14  C                   END
N14  C                   ELSE
     C   33XBRUD2        IFNE      *BLANKS
     C                   EXSR      REGN
     C                   END
N14  C                   END
N29  C   33              IF        SETDN < 0 AND XORI = 'J'
N29  C                   EVAL      XORI = 'N'
N29  C                   MOVE      *BLANKS       XBRUD2
N29  C     SAEV2K        SETLL     SAEV2
N29  C                   GOTO      STSV
N29  C                   END
     C   33              GOTO      SLSV
N29  C                   IF        SVNYL <> 'S'
N29  C                   MOVE      'N'           XTOTSLT           1
N29  C                   END
      *
      *** XBRUD2 = BLANK ---> STARTE LINJETELLER MED 1 VED 1. RECORD
N14  C                   IF        SESAM = 'N'
N14  C     XVLN          IFEQ      0
N14  C                   EXSR      FLYTT
N14  C                   ELSE
N14  C     XVLN          IFNE      SVLN
N14  C                   EXSR      REGN
N14  C                   EXSR      FLYTT
N14  C                   END
N14  C                   END
N14  C                   MOVE      SVLN          XVLN
N14  C                   IF        SVLN = 0
N14  C                   Z-ADD     XNR           SVLN
N14  C                   END
N14  C                   EXCEPT    SAEVL4
N14  C                   ELSE
     C     XBRUD2        IFEQ      *BLANKS
     C                   EXSR      FLYTT
     C                   ELSE
     C                   MOVE      'N'           XUNR              1
     C     SVEH01        IFEQ      'U.NR'
     C     SVEH01        OREQ      'U-NR'
     C                   MOVE      'J'           XUNR
     C                   END
     C     XBRUD1        IFNE      XBRUD2
     C     XUNR          OREQ      'J'
      *** VED BRUDD OPPDATER VARELINJE PÅ ARBEIDSFIL (WFILEEXP)
     C                   EXSR      REGN
     C                   EXSR      FLYTT
     C                   END
     C                   END
      *
     C                   Z-ADD     XNR           SVLN
     C                   EXCEPT    SAEVLN
N14  C                   END
      *
     C                   MOVE      XBRUD1        XBRUD2
      *** TEST OM SKAL LEGGE INN MERKE & NR. PÅ DENNE VARELINJEN
     C  N49
     CAN 48SV01          COMP      'B'                                    49
      *
      *** HVIS MERKE & NR. (CONTAINERNR.) ER ULIK FRA DE FOREGÅENDE,
      *** LEGGER INN I TABELL (KN).  MAX = 7 LINJER
     C     1             DO        7             XN2                            1<-B
     C                   IF        SVFT(XN2) <> *BLANKS                          2<-B
     C     1             DO        7             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      KN(XN4) = *BLANKS                               4
     C                   EVAL      KN(XN4) = SVFT(XN2)
     C                   LEAVE
     C                   WHEN      KN(XN4) = SVFT(XN2)                             4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
      *** HVIS VARESLAG ER ULIK FRA DE FOREGÅENDE,
      *** LEGGER INN I TABELL (VB).  MAX = 7 LINJER
     C     STSV2B        TAG
     C     1             DO        7             XN2                            1<-B
     C                   IF        SVVT(XN2) <> *BLANKS                          2<-B
     C     1             DO        7             XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      VB(XN4) = *BLANKS                               4
     C                   EVAL      VB(XN4) = SVVT(XN2)
     C                   LEAVE
     C                   WHEN      VB(XN4) = SVVT(XN2)                             4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
      *** ENHETS KODE LEGGES I WFEVT
     C     STSV2         TAG
     C     WFEVT         IFEQ      *BLANKS                                      1<-B
     C                   MOVE      SVEH01        WFEVT
     C                   END                                                    1<-E
      *
      *** SUMMERE ANTALL ENHETER
     C     1             DO        7             XN2                            1<-B
     C                   EVAL      WFEANT = WFEANT + SVNT(XN2)
     C                   ENDDO                                                  1<-E
      *
      *** HVIS TILLEGGSOPPLYSNING ER ULIK FRA DE FOREGÅENDE,
E22   *** LEGGER INN I TABELL (TO).  MAX = 10 LINJER
     C     1             DO        10            XN2                            1<-B
     C                   IF        SVTOP(XN2) <> *BLANKS                         2<-B
     C     1             DO        10            XN4                              3<-B
     C                   SELECT                                                    4<-B
     C                   WHEN      TO(XN4) = *BLANKS                               4
     C                   EVAL      TO(XN4) = SVTOP(XN2)
     C                   EVAL      TC(XN4) = SVTCR(XN2)
     C                   LEAVE
     C                   WHEN      TO(XN4) = SVTOP(XN2) AND TC(XN4) = SVTCR(XN2)   4
     C                   LEAVE
     C                   ENDSL                                                     4<-E
     C                   ENDDO                                                    3<-E
     C                   END                                                     2<-E
     C                   ENDDO                                                  1<-E
      *
     C     STSV3         TAG
      *** SUMMERE NETTO/BRUTTO VEKT
S22  C*                  ADD       SVVKTB        WFEVKB
S22  C*                  ADD       SVVKTN        WFEVKN
N22  C                   ADD       SVVKTB        WFEVKB123
N22  C                   ADD       SVVKTN        WFEVKN123
S22  C*                  IF        WFENTM < 0
S22  C*                  IF        SVNTM < 0
S22  C*                  ADD       SVNTM         WFENTM
S22  C*                  ELSE
S22  C*                  EVAL      WFENTM = WFENTM + SVNTM / -100
S22  C*                  END
S22  C*                  ELSE
     C                   ADD       SVNTM         WFENTM
S22  C*                  END
      *** SUMMERE TOLLVERDI VED UTFØRSEL
     C                   ADD       SVBELT        XESTB            13 2
      *
     C                   GOTO      STSV
      *
     C     SLSV          ENDSR
      ***********************************************
     C     UTR28         BEGSR
      ***********************************************
      *** SKRIVE FAKTURALINJER (RUBR. 28)
     C                   SETOFF                                       7060
     C     SAEFK         SETLL     SAEF
     C     SAEFK         READE     SAEF                                   70
     C  N70              DO
      *
S19  C*                  EXCEPT    RU28H
N19  C                   WRITE     RU28H
     C     SEFID         IFNE      99999999
S19  C*                  EXCEPT    RU28H2
N19  C                   WRITE     RU28H2
     C                   END
S19  C*                  EXCEPT    RU28D
N19  C                   WRITE     RU28D
S41  C*                  Z-ADD     1             XN4                    90
N41  C                   Z-ADD     6             XN4                    90
     C                   Z-ADD     1             XR28SD            3 0
      *
     C                   SETON                                        60
     C     STUT28        TAG
     C     SAEFK         READE     SAEF                                   70
     C  N70XN4           IFGE      XA4
     C                   ADD       1             XR28SD               90
S19  C*                  EXCEPT    RU28H
N19  C                   WRITE     RU28H
S41  C*                  Z-ADD     1             XN4
N41  C                   Z-ADD     6             XN4
     C                   ELSE
     C                   ADD       1             XN4
     C                   END
S19  C* N70              EXCEPT    RU28D
N19  C  N70              WRITE     RU28D
     C  N70              GOTO      STUT28
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     PRINT2        BEGSR
      ***********************************************
      *** SKRIVE TOLLDEK. PÅ DATALISTE
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN3
     C                   Z-ADD     1             XLN
     C                   SETOFF                                       33
      *
     C     SAEHK         SETLL     WFILEEXP
     C                   MOVE      'J'           FAXDE2            1
S19  C*                  EXCEPT    DLHEAD
N19  C                   WRITE     DLHEAD
     C                   Z-ADD     4             XN4               5 0
      *
     C     STPR2         TAG
      *** LESE SAMSLÅENDE POST FRA ARBEIDSFIL
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C                   DELETE    WFILEER
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
     C   33              GOTO      STPR22
     C                   DELETE    WFILEER
S22  C*                  IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
     C                   EVAL      XVNTM = WFENTM
S22  C*                  END
      *
     C                   MOVE      *ZEROS        XN3
     C                   MOVE      *BLANKS       TY
     C                   MOVE      *ZEROS        GL
     C                   MOVE      *ZEROS        ST
     C                   MOVE      *BLANKS       PR
     C                   MOVE      *ZEROS        BL
      *** FLYTTE AVGIFT FOR FERSK FISK Å SKRIVE UT
     C   54WFEBL         IFNE      0
     C                   ADD       1             XN3
     C                   MOVE      'FF'          TY(XN3)
     C                   MOVE      WFESTB        GL(XN3)
     C                   Z-ADD     WFEATP        ST(XN3)
N05  C                   MOVE      ' '           AGPP
     C     AVGEK         SETLL     SADAVGE
     C     AVGEK         READE     SADAVGE                                31
     C     *IN31         DOWEQ     '0'
     C     AGDTF         IFLE      XEDT
     C     AGDTT         ANDGT     XEDT
     C                   LEAVE
     C                   END
     C     AVGEK         READE     SADAVGE                                31
     C  N31              ENDDO
     C     *IN31         IFEQ      *OFF
N05  C     AGPP          ORNE      ' '
     C                   MOVE      AGPP          PR(XN3)
     C                   ELSE
     C                   MOVE      'P'           PR(XN3)
     C                   END
     C                   Z-ADD     WFEBL         BL(XN3)
     C                   ADD       WFEBL         T2(4)
     C                   END
      *
     C     STPR21        TAG
      *** BEREGNE ANTALL LINJER PÅ DENNE SAMSLÅENDE LINJEN.
      *** XN3 INNEHOLDER ANTALL LINJER
     C                   Z-ADD     3             XN3
      *
     C     TO(2)         IFNE      *BLANKS
N19  C     VB(3)         ORNE      *BLANKS
     C                   Z-ADD     4             XN3
     C     TO(3)         COMP      *BLANKS                                33
N19  C   33VB(4)         COMP      *BLANKS                                33
     C  N33              ADD       1             XN3
     C  N33TO(4)         COMP      *BLANKS                                33
N19  C   33VB(5)         COMP      *BLANKS                                33
     C  N33              ADD       1             XN3
S22  C* N33TO(5)         COMP      *BLANKS                                33
N19  C*  33VB(6)         COMP      *BLANKS                                33
S22  C* N33              ADD       1             XN3
N19  C* N33VB(7)         COMP      *BLANKS                                33
N19  C* N33              ADD       1             XN3
     C                   END
      *
     C     XN3           IFLE      2
     C                   Z-ADD     3             XN3
     C                   END
     C     XN3           IFLE      3
     C     TY(3)         ANDNE     *BLANKS
     C                   Z-ADD     4             XN3
     C                   END
     C     XN3           IFLE      4
     C     TY(4)         ANDNE     *BLANKS
     C                   Z-ADD     5             XN3
     C                   END
      *
     C     WFEVT         IFEQ      'U.NR'
     C     WFEVT         OREQ      'U-NR'
     C                   ADD       1             XN3
N39  C                   ADD       1             XN4
     C                   END
      *
     C                   ADD       XN3           XN4
     C     XN4           IFGT      XA4
S19  C*                  EXCEPT    DLHEAD
N19  C                   WRITE     DLHEAD
     C     WFEVT         IFEQ      'U.NR'
     C     WFEVT         OREQ      'U-NR'
     C                   SUB       1             XN3
     C                   END
     C     XN3           ADD       4             XN4
     C                   END
      *
S19  C*                  EXCEPT    DLIST1
N19  C                   WRITE     DLIST1
     C     XN3           IFGT      3
S19  C*                  EXCEPT    DLIST2
N19  C                   WRITE     DLIST2
     C                   END
     C     XN3           IFGT      4
S19  C*                  EXCEPT    DLIST3
N19  C                   WRITE     DLIST3
     C                   END
     C     XN3           IFGT      5
S19  C*                  EXCEPT    DLIST4
N19  C                   WRITE     DLIST4
     C                   END
S22  C*    XN3           IFGT      6
S19  C*                  EXCEPT    DLIST5
S22  C*                  WRITE     DLIST5
S22  C*                  END
N19  C*    XN3           IFGT      7
N19  C*                  WRITE     DLIST6
N19  C*                  END
N22  C     5             DO        10            XN3
N22  C                   IF        TO(XN3) = *BLANKS
N22  C                   LEAVE
N22  C                   END
N22  C                   ADD       1             XN4
N22  C     XN4           IFGT      XA4
N22  C                   WRITE     DLHEAD
N22  C                   Z-ADD     5             XN4
N22  C                   END
N22  C                   EVAL      WFETO = TO(XN3)
N22  C                   WRITE     DLIST5
N22  C                   END
N22   *
     C     WFEVT         IFEQ      'U.NR'
     C     WFEVT         OREQ      'U-NR'
S19  C*                  EXCEPT    DLIMV2
N19  C                   WRITE     DLIMV2
     C                   END
      *
S19  C*                  EXCEPT    DLBLIN
N19  C                   WRITE     DLBLIN
N25   *
N25  C                   IF        XSNDEMMA = 'J'
N25  C                   EXSR      SREMMA5
N25  C                   END
      *
     C                   GOTO      STPR2
      *
      *** NÅ SKAL SKRIVE UT FØRST SIDE
     C     STPR22        TAG
     C                   SETON                                        44
     C                   EXSR      UTDEL2
     C                   Z-ADD     0             XN3
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     F1(1)         IFEQ      *BLANKS                                      1<-B
     C                   EXSR      TRIMGN
N12  C                   EXSR      FRISR
s16  C*                  EXCEPT    DLDEL1
n16  C                   exsr      srovl
N29  C   26              MOVE      XNR           XNROMB2           5 0
N29  C   26              MOVE      XNROMB        XNR
n16  C                   WRITE     DLDEL1
N29  C   26              MOVE      XNROMB2       XNR
N16  C     ovljn         ifeq      'J'
n16  C                   write     ovl
n16  C                   end
     C                   ELSE                                                   1
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                             2<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                        3<-B
     C                   ADD       10            YN
     C                   ELSE                                                     3
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
N12  C                   EXSR      FRISR
s16  C*                  EXCEPT    DLDEL1
n16  C                   exsr      srovl
N29  C   26              MOVE      XNR           XNROMB2           5 0
N29  C   26              MOVE      XNROMB        XNR
n16  C                   WRITE     DLDEL1
N29  C   26              MOVE      XNROMB2       XNR
N16  C     ovljn         ifeq      'J'
n16  C                   write     ovl
n16  C                   end
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   ENDSR
      ***********************************************
     C     PRINT3        BEGSR
      ***********************************************
      *** SKRIVE TOLLDEK. PÅ VANLIG TOLLDEK.FORMULAR
     C                   MOVE      *ZEROS        XN2
     C                   MOVE      *ZEROS        XN3
     C                   MOVE      *ZEROS        XN4               5 0
     C                   MOVE      *ZEROS        XSIDE             2 0
     C                   MOVE      *ZEROS        XTSIDE            2 0
     C                   MOVE      *BLANKS       T1
     C                   MOVE      *ZEROS        T2
     C                   MOVE      *ZEROS        XTOT             10 0
     C                   SETOFF                                       33
      *
     C     SAEHK         SETLL     WFILEEXP
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C                   DELETE    WFILEER
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
N29  C                   IF        *IN26 = *OFF
     C   33              GOTO      SLPR3
N29  C                   ELSE
N29  C   33              CLEAR                   WFILEER
N29  C                   END
     C  N33              DELETE    WFILEER
S22  C*                  IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
     C                   EVAL      XVNTM = WFENTM
S22  C*                  END
      *
      *** BEREGNE ANTALL SIDER OG SETTES INN XSIDE
     C     XNR           IFNE      0                                            1<-B
S29  C*    XNR           IFNE      1                                             2<-B
N29  C                   SELECT                                                  2<-B
N29  C                   WHEN      *IN26 = *OFF AND XNR <> 1                     2
     C                   ADD       1             XSIDE
     C     XNR           ADD       4             XNR
     C     XNR           DIV       3             XTSIDE
     C     XNR           SUB       4             XNR
N29  C                   WHEN      *IN26 = *ON AND XNR <> 1                      2
N29  C                   ADD       1             XSIDE
N29  C     XNROMB        ADD       4             XNROMB
N29  C     XNROMB        DIV       3             XTSIDE
N29  C     XNROMB        SUB       4             XNROMB
S29  C*                  ELSE
N29  C                   OTHER
     C                   MOVE      *ZEROS        XSIDE
     C                   MOVE      *ZEROS        XTSIDE
     C                   MOVE      *ZEROS        XN2
     C                   END                                                     2<-E
     C                   MOVE      *BLANKS       TY
     C                   MOVE      *ZEROS        GL
     C                   MOVE      *ZEROS        ST
     C                   MOVE      *BLANKS       PR
     C                   MOVE      *ZEROS        BL
     C                   Z-ADD     1             XLN
     C                   MOVE      'J'           XSLETT            1
     C                   EXSR      FLYTT2
      *
S29  C*    XNR           COMP      1                                    4444
N29  C  N26XNR           COMP      1                                    4444
N29  C   26XNROMB        COMP      1                                    4444
     C   44              EXSR      UTDEL2
     C                   MOVE      'N'           XSLETT
     C                   END                                                    1<-E
      *
     C                   EXSR      SJVBES
      *
     C                   MOVE      *BLANKS       KFMT1
     C                   MOVE      *BLANKS       KFMT2
     C     F1(1)         IFEQ      *BLANKS                                      1<-B
     C                   EXSR      TRIMGN
N12  C                   EXSR      FRISR
s16  C*                  EXCEPT    DEL1
n16  C                   exsr      srovl
N29  C   26              MOVE      XNR           XNROMB2           5 0
N29  C   26              MOVE      XNROMB        XNR
n16  C                   WRITE     DEL1
N29  C   26              MOVE      XNROMB2       XNR
N16  C     ovljn         ifeq      'J'
n16  C                   write     ovl
n16  C                   end
     C                   ELSE                                                   1
     C                   MOVE      *ZEROS        YN                3 0
     C     YN            DOWLT     9                                             2<-B
     C                   ADD       1             YN
     C     F1(YN)        IFEQ      *BLANKS                                        3<-B
     C                   ADD       10            YN
     C                   ELSE                                                     3
     C                   MOVE      F1(YN)        KFMT1
     C                   MOVE      F2(YN)        KFMT2
     C                   EXSR      TRIMGN
N12  C                   EXSR      FRISR
s16  C*                  EXCEPT    DEL1
n16  C                   exsr      srovl
N29  C   26              MOVE      XNR           XNROMB2           5 0
N29  C   26              MOVE      XNROMB        XNR
n16  C                   WRITE     DEL1
N29  C   26              MOVE      XNROMB2       XNR
N16  C     ovljn         ifeq      'J'
n16  C                   write     ovl
n16  C                   end
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
N25   *
N25  C                   IF        XSNDEMMA = 'J'
N25  C                   EXSR      SREMMA5
N25  C                   END
      *
     C                   MOVE      *ZEROS        XLN               3 0
     C     STPR30        TAG
     C                   ADD       1             XLN
     C     XLASER        IFEQ      'N'
     C                   MOVE      'J'           XSLETT            1
     C                   MOVE      F3(XLN)       XPFM1            75
     C                   MOVE      F4(XLN)       XPFM2            75
     C                   ELSE
     C                   ADD       1             XLN
     C     F3(XLN)       IFEQ      *BLANKS
     C                   MOVE      'J'           XSLETT
     C                   ELSE
     C                   MOVE      'N'           XSLETT
     C                   END
     C                   SUB       1             XLN
     C                   MOVE      F3(XLN)       XPFM1
     C                   MOVE      F4(XLN)       XPFM2
     C                   END
      *
      *
      *** SKRIV UT DEL 2
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C                   DELETE    WFILEER
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
     C   33              GOTO      SLPR3
     C     XSLETT        IFEQ      'J'
     C                   DELETE    WFILEER
     C                   ELSE
     C                   UPDATE    WFILEER
     C                   END
S22  C*                  IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
     C                   EVAL      XVNTM = WFENTM
S22  C*                  END
      *
     C     STPR3         TAG
     C                   EXSR      MOVB3
     C                   EXSR      SJVBES
     C                   EXCEPT    DEL21
N25   *
N25  C                   IF        XSNDEMMA = 'J'
N25  C                   EXSR      SREMMA5
N25  C                   END
N25   *
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C     XSLETT        IFEQ      'J'
N29  C                   DELETE    WFILEER
N29  C                   ELSE
N29  C                   UPDATE    WFILEER
N29  C                   END
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
     C  N33XSLETT        IFEQ      'J'
     C                   DELETE    WFILEER
     C                   ELSE
     C                   UPDATE    WFILEER
     C                   END
S22  C* N33              IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
S22  C*                  EVAL      XVNTM = WFENTM
S22  C*                  END
N22  C  N33              EVAL      XVNTM = WFENTM
     C   33              EXCEPT    DEL21X
     C   33              EXSR      UTDEL2
     C   33XSLETT        IFEQ      'J'
     C                   GOTO      SLPR3
     C                   ELSE
     C     SAEHK         SETLL     WFILEEXP
     C                   GOTO      STPR30
     C                   END
      *
     C                   EXSR      FLYTT2
     C                   EXSR      SJVBES
     C                   EXCEPT    DEL22
N25   *
N25  C                   IF        XSNDEMMA = 'J'
N25  C                   EXSR      SREMMA5
N25  C                   END
N25   *
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C     XSLETT        IFEQ      'J'
N29  C                   DELETE    WFILEER
N29  C                   ELSE
N29  C                   UPDATE    WFILEER
N29  C                   END
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
     C  N33XSLETT        IFEQ      'J'
     C                   DELETE    WFILEER
     C                   ELSE
     C                   UPDATE    WFILEER
     C                   END
S22  C* N33              IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
S22  C*                  EVAL      XVNTM = WFENTM
S22  C*                  END
N22  C  N33              EVAL      XVNTM = WFENTM
     C   33              EXCEPT    DEL22X
     C   33              EXSR      UTDEL2
     C   33XSLETT        IFEQ      'J'
     C                   GOTO      SLPR3
     C                   ELSE
     C     SAEHK         SETLL     WFILEEXP
     C                   GOTO      STPR30
     C                   END
      *
     C                   EXSR      FLYTT2
     C                   EXSR      SJVBES
     C                   EXCEPT    DEL23
N25   *
N25  C                   IF        XSNDEMMA = 'J'
N25  C                   EXSR      SREMMA5
N25  C                   END
N25   *
     C     XLN           IFEQ      1
     C     XSLETT        ANDEQ     'J'
     C     SAEHK         READE     WFILEEXP                               33
N29  C                   DOW       *IN33 = *OFF
N29  C                   IF        WFENYL <> 'S'
N29  C                   LEAVE
N29  C                   END
N29  C                   DELETE    WFILEER
N29  C     SAEHK         READE     WFILEEXP                               33
N29  C                   ENDDO
     C  N33              DELETE    WFILEER
S22  C* N33              IF        WFENTM < 0
S22  C*                  EVAL      XVNTM = WFENTM * -100
S22  C*                  ELSE
S22  C*                  EVAL      XVNTM = WFENTM
S22  C*                  END
N22  C  N33              EVAL      XVNTM = WFENTM
     C   33              EXSR      UTDEL2
     C                   END
     C  N33              EXCEPT    DEL2S
     C     XLN           IFEQ      1
     C     XSLETT        ANDEQ     'J'
     C  N33              GOTO      STPR3
     C                   ELSE
     C     SAEHK         SETLL     WFILEEXP
     C     XSLETT        IFEQ      'J'
     C                   MOVE      *ZEROS        XLN
     C                   END
     C                   GOTO      STPR30
     C                   END
      *
     C     SLPR3         ENDSR
      ***********************************************
     C     FLYTT         BEGSR
      ***********************************************
      *** FLYTTE HOVEDOPPLYSNINGER FRA HOVEDLINJE TIL ARBEIDSVARIABLER
      *** OG BLANKE DE ANDRE ARBEIDSVARIABLENE.
     C                   MOVE      SVAVD         WFEAVD
     C                   MOVE      SVTDN         WFETDN
N29  C                   MOVE      SVNYL         WFENYL
N29  C                   IF        SVNYL <> 'S'
N29  C                   ADD       1             XNROMB
N29  C                   END
     C                   ADD       1             XNR
     C                   Z-ADD     1             XN2
     C                   Z-ADD     1             XN3
      *
     C                   MOVE      SVAVT         XAVT              1
     C                   MOVE      SVAVTS        WFEATS
     C                   MOVE      SVAVTP        WFEATP
     C                   MOVE      SVVNT         WFEVNT
     C                   MOVE      SVFYL         WFEFYL
     C                   MOVE      *ZEROS        WFEBL
     C                   MOVE      *BLANKS       KN
     C                   MOVE      *ZEROS        WFEANT
     C                   MOVE      *BLANKS       WFEVT
     C                   MOVE      *BLANKS       VB
     C                   MOVE      *BLANKS       TO
     C                   MOVE      *BLANKS       TC
     C                   MOVE      *ZEROS        WFEJUS
      *
     C                   MOVE      *ZEROS        WFESTB
     C                   MOVE      *ZEROS        XESTB
     C                   MOVE      *ZEROS        WFESUM
S22  C*                  MOVE      *ZEROS        WFEVKB
S22  C*                  MOVE      *ZEROS        WFEVKN
N22  C                   MOVE      *ZEROS        WFEVKB123
N22  C                   MOVE      *ZEROS        WFEVKN123
     C                   MOVE      *ZEROS        WFENTM
      *
     C                   ENDSR
      ***********************************************
     C     FLYTT2        BEGSR
      ***********************************************
      *** FLYTTE DATA ARBEIDSFIL TIL TABLER FOR Å SKRIVE UT
     C                   ADD       1             XN3
     C     XN3           MULT      4             XN4
     C     XN4           SUB       3             XN4
      *** FLYTTE AVGIFT FOR FERSK FISK
     C   54WFEBL         IFNE      0
     C                   MOVE      'FF'          TY(XN4)
     C                   Z-ADD     WFESTB        GL(XN4)
     C                   Z-ADD     WFEATP        ST(XN4)
N05  C                   MOVE      ' '           AGPP
     C     AVGEK         SETLL     SADAVGE
     C     AVGEK         READE     SADAVGE                                31
     C     *IN31         DOWEQ     '0'
     C     AGDTF         IFLE      XEDT
     C     AGDTT         ANDGT     XEDT
     C                   LEAVE
     C                   END
     C     AVGEK         READE     SADAVGE                                31
     C  N31              ENDDO
     C     *IN31         IFEQ      *OFF
N05  C     AGPP          ORNE      ' '
     C                   MOVE      AGPP          PR(XN4)
     C                   ELSE
     C                   MOVE      'P'           PR(XN4)
     C                   END
     C                   Z-ADD     WFEBL         BL(XN4)
     C     XLN           IFEQ      1
     C                   ADD       WFEBL         T2(4)
     C                   END
     C                   END
      *
     C     SLFLY2        ENDSR
      ***********************************************
     C     REGN          BEGSR
      ***********************************************
N22  C                   IF        WFEVKB123 < 0.5
N22  C                   Z-ADD     1             WFEVKB
N22  C                   ELSE
N22  C                   ADD       0,5           WFEVKB123
N22  C                   END
N22  C                   IF        WFEVKN123 < 0.5
N22  C                   Z-ADD     1             WFEVKN
N22  C                   ELSE
N22  C                   ADD       0,5           WFEVKN123
N22  C                   END
N22   *
      *** BEREGNE STATISTISK VERDI
     C     XESTB         IFNE      0
     C     KVAOMR        IFEQ      0
     C                   Z-ADD(H)  XESTB         WFESTB
     C                   ELSE
     C     XESTB         DIV       KVAOMR        XWORK
     C     XWORK         MULT(H)   SEVKU         WFESTB
     C                   END
N32  C                   IF        WFESTB = 0
N32  C                   EVAL      WFESTB = 1
N32  C                   END
     C                   END
      *
      *** 40 PÅ ---> FORDELE ANDRE KOSTNAD ETTER VEKT OG LEGGE DET INN
      ***            JUSTERING OG SUMMERE DET MED STATISTISK VERDI
     C     SEVKB         IFEQ      0
     C   40              Z-ADD     0             XWORK
     C                   ELSE
     C   40WFEVKB        DIV(H)    SEVKB         XWORK
     C                   ENDIF
     C   40XWORK         MULT(H)   SEBEL3        WFEJUS
     C   40
     CAN 96WFESTB        SUB       WFEJUS        WFESTB
     C   40
     CANN96WFESTB        ADD       WFEJUS        WFESTB
      *
      *** BEREGNE AVGIFT FOR TORSKFISKEREDERIENE
     C     XAVT          IFEQ      'X'
N05  C                   MOVE      ' '           AGPP
     C     WFESTB        MULT      WFEATP        XWORK
     C     AVGEK         SETLL     SADAVGE
     C     AVGEK         READE     SADAVGE                                31
     C     *IN31         DOWEQ     '0'
     C     AGDTF         IFLE      XEDT
     C     AGDTT         ANDGT     XEDT
     C                   LEAVE
     C                   END
     C     AVGEK         READE     SADAVGE                                31
     C  N31              ENDDO
S05  C*    *IN31         IFEQ      *OFF
S05  C*    AGPP          ANDEQ     '%'
N05  C     AGPP          IFEQ      '%'
     C     XWORK         DIV(H)    100           WFEBL
     C                   ELSE
     C     XWORK         DIV(H)    1000          WFEBL
     C                   END
     C                   END
      *
     C     SLREGN        TAG
      *** 49 PÅ -> LEGGE MERKE & NR. FRA B/L TIL DENNE VARELINJEN
     C   49
     CAN 48              EXSR      UTBL
     C                   SETOFF                                       49
      *
     C                   MOVE      XNR           WFERNR
      * SUMMERE TOTAL KOLLI
     C                   ADD       WFEANT        XTOTKL
      *** SKRIVE SAMSLÅENDE LINJER TIL ARBEIDSFIL
     C     WFKEY         CHAIN     WFILEEXP                           97
     C   97              WRITE     WFILEER
N36  C                   ADD       WFEVKB        XTVKTBEMMA
      *
      *** SUMMERE FORSKJELLIGE AVGIFTER
     C                   ADD       WFEBL         XTOTT
N15   *** SUMMERE BRUTTOVEKT
N15  C                   ADD       WFEVKB        XTVKTB
     C                   SETOFF                                       97
      *
     C                   ENDSR
      ******************************************
     C     UTBL          BEGSR
      ******************************************
     C                   Z-ADD     1             XN2
     C     XN2           DOWLE     7                                            1<-B
     C     KN(XN2)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STUBL1
     C                   ELSE                                                    2
     C                   ADD       1             XN2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     STUBL1        TAG
     C                   Z-ADD     1             XN3
S22  C*    XN3           DOWLE     5                                            1<-B
N22  C     XN3           DOWLE     10                                           1<-B
     C     TO(XN3)       IFEQ      *BLANKS                                       2<-B
     C                   GOTO      STUBL2
     C                   ELSE                                                    2
     C                   ADD       1             XN3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     STUBL2        TAG
     C                   Z-ADD     1             UN2               2 0
      *
     C     UN2           DOWLE     UNR                                          1<-B
     C     XN2           IFLE      7                                             2<-B
     C                   Z-ADD     1             XN4
     C     XN4           DOWLE     7                                              3<-B
     C     MN(UN2)       IFEQ      KN(XN4)                                         4<-B
     C                   GOTO      STUBL3
     C                   END                                                       4<-E
     C                   ADD       1             XN4
     C                   END                                                      3<-E
     C                   MOVE      MN(UN2)       KN(XN2)
     C                   ADD       1             XN2
     C                   ELSE                                                    2
S22  C*    XN3           IFLE      5                                              3<-B
N22  C     XN3           IFLE      10                                             3<-B
     C                   MOVEL     MN(UN2)       TO(XN3)
     C                   ADD       1             UN2
     C     UN2           IFGT      UNR                                             4<-B
     C                   GOTO      SLUBL
     C                   END                                                       4<-E
     C                   MOVE      MN(UN2)       TO(XN3)
     C                   ADD       1             XN3
     C                   ELSE                                                     3
     C                   GOTO      SLUBL
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     STUBL3        TAG
     C                   ADD       1             UN2
     C                   END                                                    1<-E
      *
     C     SLUBL         ENDSR
      ***********************************************
     C     SJVBES        BEGSR
      ***********************************************
      *** TESTE OM MERKE & NR. = BLANK. HVIS DET FLYTT FRA HEAD-
      *** HVIS HEAD IKKE FINNES- SETT 'ADR.'
S22  C*    BLAN17        LOOKUP    KN                                 88
N22  C     BLAN28        LOOKUP    KN                                 88
     C  N88              DO
     C                   MOVEL     'ADR'         KN(1)
     C     HEADFK        CHAIN     HEADF                              70
     C  N70              UPDATE    HEADFR
     C  N70HEGM1         IFNE      *BLANKS
     C                   MOVEL     HEGM1         KN(1)
     C                   MOVEL     HEGM2         KN(2)
     C                   END
     C                   END
      *** VED ANTALL KOLLI > 0 TESTES ENHET KODE. HVIS DEN ER BLANK,
      *** FLYTTER 'EX' INN OG FLYTTER TOTALL KOLLI INN.
     C                   SETOFF                                       99
     C     WFEANT        IFEQ      0
     C     WFEVT         ANDEQ     *BLANKS
     C                   Z-ADD     XRESKL        WFEANT
     C     XNR           IFEQ      1
     C                   MOVE      'KLL.'        WFEVT
     C                   ELSE
     C                   MOVEL     'EX'          WFEVT
     C                   SETON                                        99
     C                   END
     C                   END
     C     WFEVT         IFEQ      'U.NR'
     C     WFEVT         OREQ      'U-NR'
     C                   MOVE      'KLL.'        WFEVT
     C                   END
      *
     C                   SETOFF                                       88
      *** TESTE OM VARESLAG = BLANK. HVIS DET, FLYTTER TESKT FRA
      *** TOLLTARIFF INN.
S22  C*    BLAN15        LOOKUP    VB                                 88
N22  C     BLAN30        LOOKUP    VB                                 88
     C  N88WFEVNT        COMP      0                                      70
S22  C* N88
S22  C*NN70TARIK         CHAIN     TARI                               70
S22  C* N88
S22  C*NN70              MOVE      TAALFA        VB(1)
N22  C                   IF        *IN88 = *OFF AND *IN70 = *OFF
N22  C     WFEVNT        CHAIN     SOKTARI2                           70
N22  C                   IF        *IN70
N22  C     TARIK         CHAIN     TARI                               70
N22  C  N70              EVAL      VB(1) = TAALFA
N22  C                   ELSE
N22  C                   EVAL      VB(1) = BESKR1
N22  C                   END
N22  C                   END
     C  N88
     CAN 70              DO
     C     HEADFK        CHAIN     HEADF                              70
     C  N70              UPDATE    HEADFR
     C  N70HEVS1         IFNE      *BLANKS
S22  C*                  MOVEL     HEVS1         VB(1)
S22  C*                  MOVEL     HEVS2         VB(2)
N22  C                   EVAL      VB(1) = HEVS1
N22  C                   EVAL      VB(2) = HEVS2
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     UTDEL2        BEGSR
      ***********************************************
      *** BEREGNE TOTALL AVGIFTER FOR UTSKRIVING
     C     XLN           CABNE     1             SLUTD2
     C                   Z-ADD     0             XN4
      *
     C     T2(4)         IFNE      0
     C                   ADD       1             XN4
     C                   MOVE      'FF'          T1(XN4)
     C                   MOVE      T2(4)         T2(XN4)
     C                   END
      *
     C     XN4           DOWLT     4
     C                   ADD       1             XN4
     C                   MOVE      *ZEROS        T2(XN4)
     C                   END
      *
     C     T2(1)         ADD       T2(2)         XTOT
     C                   ADD       T2(3)         XTOT
     C                   ADD       T2(4)         XTOT
      *
     C     SLUTD2        TAG
     C  N44              EXCEPT    DEL2S
      *
     C                   ENDSR
      ***********************************************
     C     MOVB3         BEGSR
      ***********************************************
     C                   Z-ADD     0             XN3
     C     XLN           IFEQ      1
     C                   ADD       1             XSIDE
     C                   END
     C                   MOVE      *BLANKS       TY
     C                   MOVE      *ZEROS        GL
     C                   MOVE      *ZEROS        ST
     C                   MOVE      *BLANKS       PR
     C                   MOVE      *ZEROS        BL
     C                   EXSR      FLYTT2
      *
     C                   ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    PRTTYP            1
     C                   PARM                    PRTAVD            4
     C                   PARM                    PRTTDN            7
     C                   PARM                    PRTPT1           10
     C                   PARM                    PRTPT2           10
     C                   PARM                    PRTPT3           10
N16  C     KEYSI         KLIST
N16  C                   KFLD                    SIUNIK            2
N16  C                   KFLD                    SESG
N16  C                   MOVE      'SI'          SIUNIK
     C     FAXTD         KLIST
     C                   KFLD                    PRTAVX            4 0
     C                   KFLD                    PRTTDX            7 0
     C     PRTTYP        IFEQ      'H'
     C                   SETON                                        32
     C                   MOVEL     'HIST'        UWS
     C                   MOVEL     PRTPT1        DTPRT1
     C                   MOVEL     PRTPT2        DTPRT2
     C                   MOVEL     PRTPT3        DTPRT3
     C                   ELSE
     C     PRTAVD        IFGE      '0000'
     C     PRTAVD        ANDLE     '9999'
     C                   MOVE      PRTAVD        PRTAVX
     C                   MOVE      PRTTDN        PRTTDX
N20  C     PRTAVX        CHAIN     STANDE                             33
N20  C                   MOVEL     SELV2         XUATK
N20  C                   MOVE      SEDL          UDL
N20  C                   MOVE      SETOLK        UTOLK
N20  C                   MOVE      'P'           WOPUNI
     C                   END
     C                   END
      *
     C     WFKEY         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    XNR
     C     AVGEK         KLIST
     C                   KFLD                    WFEVNT
     C                   KFLD                    AGAKD
     C                   KFLD                    WFEATS
     C                   MOVE      'FF'          AGAKD
     C     SAEHK         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     FRIKEY        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    WSKODE
s02  C*                  MOVE      '*CR'         WSKODE            3
n02  C                   MOVE      '*CE'         WSKODE            3
N09  C     FRIKEYTLI     KLIST
N09  C                   KFLD                    SEAVD
N09  C                   KFLD                    SETDN
N09  C                   KFLD                    WSKODETLI
N09  C                   MOVE      'TLI'         WSKODETLI         3
N09  C     FRIKEYTLP     KLIST
N09  C                   KFLD                    SEAVD
N09  C                   KFLD                    SETDN
N09  C                   KFLD                    WSKODETLP
N09  C                   MOVE      'TLP'         WSKODETLP         3
     C     SAEH7K        KLIST
     C                   KFLD                    UWS
     C                   KFLD                    XST
     C                   MOVE      'K'           XST               1
     C     SAEV2K        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     STANEK        KLIST
     C                   KFLD                    UAVD
     C     HEADFK        KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     KODVAK        KLIST
     C                   KFLD                    SEVAL1
     C                   KFLD                    XEDT
     C     KODLBK        KLIST
     C                   KFLD                    XLBUNI
     C                   KFLD                    SELV
     C     TARIK         KLIST
     C                   KFLD                    WFEVNT
     C                   KFLD                    XTAR
     C     WFILEK        KLIST
     C                   KFLD                    WFERNR
     C     SAEFK         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C     KODKEY        KLIST
     C                   KFLD                    WOPUNI
     C                   KFLD                    WOPAVD
     C                   KFLD                    WOPLNR
N17  C     KODKEYU1      KLIST
N17  C                   KFLD                    SESG
N17  C                   KFLD                    WOPLNR
N25  C     CUNDC01K      KLIST
N25  C                   KFLD                    FIFIRM
N25  C                   KFLD                    SEKNK
N25  C                   KFLD                    CCONTA
N25  C                   EVAL      CCONTA = 'EMMA-XML'
N25  C     ARKEXTK       KLIST
N25  C                   KFLD                    FIFIRM
N25  C                   KFLD                    ARKLAG
N25  C     ARKIVL02K     KLIST
N25  C                   KFLD                    ARSTAT
N25  C                   KFLD                    SEAVD
N25  C                   KFLD                    SETDN
N25  C                   KFLD                    ARTYPE
N25  C                   EVAL      ARSTAT = 'A'
N25  C     ARKVEDKK      KLIST
N25  C                   KFLD                    FIFIRM
N25  C                   KFLD                    SEKNK
N25  C                   KFLD                    AVTYPE
N25  C                   EVAL      AVTYPE = 'se'
N25  C     EDIM4KS       KLIST
N25  C                   KFLD                    X4SR_S
N25  C                   KFLD                    SEAVD
N25  C                   KFLD                    SETDN
N25  C                   MOVE      'S'           X4SR_S            1
N25  C     KODTS2K       KLIST
N25  C                   KFLD                    KS2UNI
N25  C                   KFLD                    SELKA
     C     TVIM4K        KLIST
     C                   KFLD                    X4SR
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    MAX0B
     C     TVI41K        KLIST
     C                   KFLD                    X4SR
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   MOVE      'R'           X4SR              1
     C                   MOVE      '99999999'    MAX0B             8 0
      *
     C     PRTTYP        IFEQ      'F'
     C     PRTTYP        OREQ      'A'
N25  C     PRTTYP        OREQ      'X'
     C                   MOVE      '1'           UDL
     C                   GOTO      FAXTAG
     C                   END
      *
      *
     C                   GOTO      STINI2
     C     STINIT        TAG
     C                   CALL      'QRCVDTAQ'
     C                   PARM                    UDTAQ
     C                   PARM                    ULIBL
     C                   PARM                    ULENGT
     C                   PARM                    UDTA
     C                   PARM                    UWAIT
      *
     C                   MOVE      UDTA          DTDTA
     C                   MOVE      DTWS          UWS              10
      *** UIN39=0 -> KOMMER FRA TOLLDE.REGISTRERING    (U4 I S/36)
      *** UIN39=1 -> KOMMER FRA KOMMUNIKASJON
     C                   MOVE      DTIN39        *IN39
N43  C                   move      *blanks       DTEPOST
N43  C     *in39         ifeq      '0'
N43  C     dtuser        andne     *blanks
N43  C     dtprt1        andeq     'EPOSTSND'
N43  C                   CALL      'SYGE108CU'
N43  C                   PARM                    DTUSER
N43  C                   PARM                    DTEPOST          70
N43  C     DTEPOST       IFNE      *BLANKS
N43  C                   MOVE      *blanks       usrepo          120
N43  C                   EVAL      usrepo='USRDFNDTA('
N43  C                             + X'7D'
N43  C                             + 'MAILTAG('
N43  C                             + %trim(DTEPOST)
N43  C                             + ')'
N43  C                             + X'7D'
N43  C                             + ')'
N43  C                   end
N43  C                   END
     C  N39PRTTYP        COMP      'A'                                    39
     C     STINI2        TAG
     C     SAEH7K        SETLL     SAEH7                              33
     C     SAEH7K        READE     SAEH7                                  33
     C   33              GOTO      STINIT
     C                   MOVE      SEAVD         UAVD              4 0
     C     STANEK        CHAIN     STANDE                             33
     C                   MOVEL     SELV2         XUATK             1
     C                   MOVE      SEDL          UDL               1
     C                   MOVE      SETOLK        UTOLK             1
     C                   MOVE      'P'           WOPUNI
      *
     C                   EXSR      OVRF
      *
     C     FAXTAG        TAG
N25   *
N25  C                   MOVE      *BLANKS       XDATA           500
N25  C                   MOVE      *BLANKS       XSUMAVG          13 2
N25  C                   BITON     '123457'      XAPS              1
N25  C                   BITOFF    '06'          XAPS
N25  C                   EVAL      KS2UNI = 'S2'
N25  C     *DTAARA       DEFINE                  EDIDTA
N25  C                   IN        EDIDTA
N25   *
n11  C  N39PRTTYP        COMP      'A'                                    39
N25  C  N39PRTTYP        COMP      'X'                                    39
     C                   OPEN      WFILEEXP
      *
     C                   MOVE      'LB '         XLBUNI            2
     C                   MOVE      *BLANKS       XTAR              3
S22  C*                  MOVE      *BLANKS       BLAN15           15
S22  C*                  MOVE      *BLANKS       BLAN17           17
N22  C                   MOVE      *BLANKS       BLAN30           30
N22  C                   MOVE      *BLANKS       BLAN28           28
     C                   MOVE      *ZEROS        SEAVD
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *ZEROS        SEFID
      *
     C                   MOVE      *ZEROS        WFERNR
     C                   MOVE      *ZEROS        WFEVNT
S22  C*                  MOVE      *ZEROS        WFEVKB
S22  C*                  MOVE      *ZEROS        WFEVKN
N22  C                   MOVE      *ZEROS        WFEVKB123
N22  C                   MOVE      *ZEROS        WFEVKN123
      *
     C                   MOVE      *ZEROS        WFESTB
     C                   MOVE      *ZEROS        XESTB
     C                   MOVE      *ZEROS        WFENTM
     C                   MOVE      *ZEROS        WFESUM
     C                   MOVE      *ZEROS        WFEANT
     C                   MOVE      *ZEROS        WFEJUS
     C     *LIKE         DEFINE    KOPAVD        WOPAVD
     C     *LIKE         DEFINE    KOPUNI        WOPUNI
     C     *LIKE         DEFINE    KOPLNR        WOPLNR
     C                   Z-ADD     0             WOPAVD
     C                   Z-ADD     0             WOPLNR
      *
     C     FIKDT         IFEQ      0
     C                   Z-ADD     1             XLANT             2 0
     C                   ELSE
     C     UDL           IFEQ      '1'
     C                   Z-ADD     1             XLANT             2 0
     C                   ELSE
     C                   Z-ADD     10            XLANT
     C                   END
     C                   END
      *
     C     SEA4          IFEQ      'J'
     C                   Z-ADD     63            XA4               2 0
     C                   ELSE
     C                   Z-ADD     44            XA4
     C                   END
     C     UYEAR         IFGT      85
     C                   MOVEL     '19'          UCENT             2 0
     C                   ELSE
     C                   MOVEL     '20'          UCENT
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     OVRF          BEGSR
      ***********************************************
      * Printerstyring for tilleggsark
     C                   Z-ADD     SEAVD         WOPAVD
     C                   Z-ADD     92            WOPLNR
N17  C     KODKEYU1      CHAIN     KODTPUSR                           33
N45  C  N33KOPNVN        COMP      '*STD'                                 33
N17  C*    KODKEY        CHAIN     KODTP                              33
N17  C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       F3
     C                   MOVE      *BLANKS       F4
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C                   MOVE      *ZEROS        YN
     C     STFM2         TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   ADD       1             YN
     C                   MOVE      KFMT1         F3(YN)
     C                   MOVE      KFMT2         F4(YN)
     C                   END
     C  N33              GOTO      STFM2
     C     YN            IFGT      1
     C                   MOVE      'J'           XLASER            1
     C                   ELSE
     C                   MOVE      'N'           XLASER
     C                   END
     C                   ENDIF
     C     DTPRT2        IFNE      *BLANKS
     C                   MOVE      DTPRT2        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD12        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       ')':0         UCMD
N06  C     KOPDRAW       ifne      *blanks
N06  c                   move      *blanks       FDRAW            20
N06  c                   eval      FDRAW='DRAWER('                              PDF
N06  C                   CAT       KOPDRAW:0     FDRAW
N06  C                   CAT       ')':0         FDRAW
N06  C                   CAT       FDRAW:1       UCMD
N06  C                   END
N06  C     KOPCOPI       ifne      *blanks
N06  c                   move      *blanks       FDCOP            20
N06  c                   eval      FDCOP='COPIES('                              PDF
N06  C                   CAT       KOPCOPI:0     FDCOP
N06  C                   CAT       ')':0         FDCOP
N06  C                   CAT       FDCOP:1       UCMD
N06  C                   END
      *OUTBIN(&DRAWUT) utskuff
N13  C     KOPOUTB       ifne      *blanks
N13  c                   move      *blanks       FDOUT            20
N13  c                   eval      FDOUT='OUTBIN('                              PDF
s28  C*                  CAT       KOPOUTB:0     FDCOP
s28  C*                  CAT       ')':0         FDCOP
n28  C                   CAT       KOPOUTB:0     FDOUT
n28  C                   CAT       ')':0         FDOUT
N13  C                   CAT       FDOUT:1       UCMD
N13  C                   END
N43  C     DTEPOST       ifne      *blanks
N43  C                   CAT       usrepo:1      UCMD
N43  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     c*                  dump
      *
      * Printerstyring for datalisterk
     C                   Z-ADD     SEAVD         WOPAVD
     C                   Z-ADD     93            WOPLNR
     C                   MOVE      *ZEROS        XANTDL
N17  C     KODKEYU1      CHAIN     KODTPUSR                           33
N45  C  N33KOPNVN        COMP      '*STD'                                 33
N17  C*    KODKEY        CHAIN     KODTP                              33
N17  C   33KODKEY        CHAIN     KODTP                              33
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C     STOVF1        TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   MOVEL     KFMT1         DLFMT1           75
     C                   ADD       1             XANTDL
     C                   GOTO      STOVF1
     C                   END
     C                   ENDIF
     C     DTPRT3        IFNE      *BLANKS
     C                   MOVE      DTPRT3        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     SEA4          IFEQ      'J'
     C     XCMD13        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD23:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C     XANTDL        IFNE      0
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XANTD2:0      UCMD
     C                   END
     C                   CAT       ')':0         UCMD
     C                   ELSE
     C     XCMD13        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD22:1      UCMD
     C                   CAT       DTUSER:0      UCMD
     C     XANTDL        IFNE      0
     C                   CAT       XCMD31:0      UCMD
     C                   CAT       XANTD2:0      UCMD
     C                   END
     C                   CAT       ')':0         UCMD
     C                   END
N06  C     KOPDRAW       ifne      *blanks
N06  c                   move      *blanks       FDRAW            20
N06  c                   eval      FDRAW='DRAWER('                              PDF
N06  C                   CAT       KOPDRAW:0     FDRAW
N06  C                   CAT       ')':0         FDRAW
N06  C                   CAT       FDRAW:1       UCMD
N06  C                   END
N06  C     KOPCOPI       ifne      *blanks
N06  c                   move      *blanks       FDCOP            20
N06  c                   eval      FDCOP='COPIES('                              PDF
N06  C                   CAT       KOPCOPI:0     FDCOP
N06  C                   CAT       ')':0         FDCOP
N06  C                   CAT       FDCOP:1       UCMD
N06  C                   END
      *OUTBIN(&DRAWUT) utskuff
N13  C     KOPOUTB       ifne      *blanks
N13  c                   move      *blanks       FDOUT            20
N13  c                   eval      FDOUT='OUTBIN('                              PDF
s28  C*                  CAT       KOPOUTB:0     FDCOP
s28  C*                  CAT       ')':0         FDCOP
n28  C                   CAT       KOPOUTB:0     FDOUT
n28  C                   CAT       ')':0         FDOUT
N13  C                   CAT       FDOUT:1       UCMD
N13  C                   END
N43  C     DTEPOST       ifne      *blanks
N43  C                   CAT       usrepo:1      UCMD
N43  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD01        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD02        UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   ENDSR
      ***********************************************
     C     OVRFHV        BEGSR
      ***********************************************
      * Printerstyring for hovedark
     C                   Z-ADD     SEAVD         WOPAVD
     C                   Z-ADD     91            WOPLNR
N17  C     KODKEYU1      CHAIN     KODTPUSR                           33
N45  C  N33KOPNVN        COMP      '*STD'                                 33
N17  C*    KODKEY        CHAIN     KODTP                              33
N17  C   33KODKEY        CHAIN     KODTP                              33
     C                   MOVE      *BLANKS       F1
     C                   MOVE      *BLANKS       F2
     C     *IN33         IFEQ      '1'
     C                   MOVE      *BLANKS       KOPNVN
     C                   MOVEL     '*JOB'        KOPNVN
     C                   ELSE
     C     KOPFM         SETLL     KODTFM                             33
     C                   MOVE      *ZEROS        YN
     C     STFM1         TAG
     C     KOPFM         READE     KODTFM                                 33
     C  N33KFMT1         IFNE      *BLANKS
     C                   ADD       1             YN
     C                   MOVE      KFMT1         F1(YN)
     C                   MOVE      KFMT2         F2(YN)
     C                   END
     C  N33              GOTO      STFM1
     C                   ENDIF
     C     DTPRT1        IFNE      *BLANKS
     C                   MOVE      DTPRT1        KOPNVN
     C                   END
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       ')':0         UCMD
     C     KOPLAS        IFEQ      'P'
N04  C     KOPLAS        OREQ      'F'
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*AFPDS)':0   UCMD
     C                   CAT       XCMDPDF2:1    UCMD
     c                   move      *blanks       FMOVL            20
s16  c*                  eval      FMOVL='FRONTMGN(0.14 0.23)'                  PDF(LIKT SAD IMP)
N16  c                   eval      FMOVL='FRONTMGN(0.43 0.20)'                  AFP
N04  C     KOPLAS        IFEQ      'F'
s16  c*                  eval      FMOVL='FRONTMGN(0.23 0)'                     AFP
s24  c*                  eval      FMOVL='FRONTMGN(0.24 0.30)'                     AFP
n24  c                   eval      FMOVL='FRONTMGN(0.23 0)'                     AFP
N04  C                   END
N04  C                   CAT       FMOVL:1       UCMD
     C                   ELSE
     C                   CAT       XCMDPDF:1     UCMD
     C                   CAT       '*SCS)':0     UCMD
     C                   END
S22  C*                  CAT       XCMD21:1      UCMD
N22  C                   CAT       XCMD21A:1     UCMD
     C                   CAT       DTUSER:0      UCMD
     C                   CAT       ')':0         UCMD
N06  C     KOPDRAW       ifne      *blanks
N06  c                   move      *blanks       FDRAW            20
N06  c                   eval      FDRAW='DRAWER('                              PDF
N06  C                   CAT       KOPDRAW:0     FDRAW
N06  C                   CAT       ')':0         FDRAW
N06  C                   CAT       FDRAW:1       UCMD
N06  C                   END
N06  C     KOPCOPI       ifne      *blanks
N06  c                   move      *blanks       FDCOP            20
N06  c                   eval      FDCOP='COPIES('                              PDF
N06  C                   CAT       KOPCOPI:0     FDCOP
N06  C                   CAT       ')':0         FDCOP
N06  C                   CAT       FDCOP:1       UCMD
N06  C                   END
      *OUTBIN(&DRAWUT) utskuff
N13  C     KOPOUTB       ifne      *blanks
N13  c                   move      *blanks       FDOUT            20
N13  c                   eval      FDOUT='OUTBIN('                              PDF
s28  C*                  CAT       KOPOUTB:0     FDCOP
s28  C*                  CAT       ')':0         FDCOP
n28  C                   CAT       KOPOUTB:0     FDOUT
n28  C                   CAT       ')':0         FDOUT
N13  C                   CAT       FDOUT:1       UCMD
N13  C                   END
N43  C     DTEPOST       ifne      *blanks
N43  C                   CAT       usrepo:1      UCMD
N43  C                   end
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   ENDSR
     C*
     C***********************************************
     C     TRIMGN        BEGSR
     C***********************************************
      * Trimmer utskrift av godsnummer/posisjon
N26  C                   EVAL      UTGNP = %TRIM(SEGN) + '-' + %TRIM(SEPOS)
S26  C*                  MOVEL     SEGN          UTGN
S26  C*                  MOVE      '-'           UTGN
S26  C*                  MOVEL     SEPO06        UTPO06
S26  C*
S26  C*    SEPO06        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:6      UTGNP            22
S26  C*                  ELSE
S26  C*    SEPO26        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:5      UTGNP            22
S26  C*                  ELSE
S26  C*    SEPO36        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:4      UTGNP            22
S26  C*                  ELSE
S26  C*    SEPO46        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:3      UTGNP            22
S26  C*                  ELSE
S26  C*    SEPO56        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:2      UTGNP            22
S26  C*                  ELSE
S26  C*    SEPO66        IFEQ      *BLANKS
S26  C*    ' '           CAT       UTGNPO:1      UTGNP            22
S26  C*                  ELSE
S26  C*                  MOVEL     UTGNPO        UTGNP            22
S26  C*                  ENDIF                                                  <SEPO¤6
S26  C*                  ENDIF                                                  <SEPO56
S26  C*                  ENDIF                                                  <SEPO46
S26  C*                  ENDIF                                                  <SEPO36
S26  C*                  ENDIF                                                  <SEPO26
S26  C*                  ENDIF                                                  <SEPO06
      *
     C                   ENDSR
N12   ***************************************************************
N12  C     frisr         begsr
N12   ***************************************************************
N12  c                   z-add     1             nr                2 0
N12  C                   clear                   DFRT
N12   *
N12   * FRIE SØKEVEIER (KUN DE SOM HAR DOK.KODE T=Tolldek
N12   *
N12  C     SAEHK         SETLL     FRISOK
N12  C     SAEHK         READE     FRISOK                                 33
N12  C     *IN33         DOWEQ     '0'
N12  C                   SORTA     DFS
N12  C     DFS(10)       IFNE      ' '
N12  C     'T'           LOOKUP    DFS                                    33
N12  C     *IN33         IFEQ      '1'
N12  C     FSKODE        CHAIN     KODFRI                             33
N12  C     *IN33         IFEQ      '0'
N12  C                   MOVEL     KFSOTX        DFRT(NR)
N12  c     DFRT(NR)      cat       ':':0         DFRT(NR)
N12  c     DFRT(NR)      cat       FSSOK:0       DFRT(NR)
N12  C                   ADD       1             NR
N12  C                   END
N12  C                   END
N12  C                   END
N12  C*
N12  C     SAEHK         READE     FRISOK                                 33
N12  C  N33NR            COMP      3                                  33
N12  C                   END
N12  C     DFRT(1)       IFNE      *blanks
N12  C                   MOVEL     DFRT(1)       TO(4)
N12  C                   END
N12  C     DFRT(2)       IFNE      *blanks
N12  C                   MOVEL     DFRT(2)       TO(3)
N12  C                   END
N12  C     DFRT(3)       IFNE      *blanks
N12  C                   MOVEL     DFRT(3)       TO(2)
N12  C                   END
N12  C                   ENDSR
N16   ***************************************************************
N16  C     srovl         begsr
N16   ***************************************************************
N16  C                   MOVE      'N'           OVLJN
N16   *
s38  C*    XBETALT       IFEQ      *BLANKS
N27  C                   MOVE      *IN34         XIN34             1
N38  C                   MOVE      *BLANKS       EPOSTT
N16  C     KEYSI         CHAIN     KODTSI                             34
N38  C  N34              exsr      epostsr
N38  C     XBETALT       IFEQ      *BLANKS
N16  C     *in34         IFEQ      '0'
     c     ksovl         andne     *blanks
N16  C                   EVAL      XFAKTNR=SETARF
N16  C                   EVAL      XBETALT=SENAD
N09  C                   EVAL      XBETALL = 'Tlf:'
     C     XBETALL       CAT       SETLF:1       XBETALL
     c*
N16  C                   MOVEL     KSOVL         FB01              8
N16  C                   MOVE      'J'           OVLJN             1
n16  c                   end
s38  C*                  MOVE      XIN34         *IN34
n16  c                   end
N38  C                   MOVE      XIN34         *IN34
N16  C                   ENDSR
     C*
N25   *
N38  C***********************************************
N38  C     EPOSTSR       BEGSR
N38  C***********************************************
N38  C     KSUSER        ifne      *BLANKS
N38  C                   CALL      'EPOS04E'
N38  C                   PARM                    KSUSER
N38  C                   PARM                    DIRENA            8
N38  C                   PARM                    DIREAD            8
N38  C                   PARM                    EPOSTT
N38  C                   END
N38  C                   ENDSR
N25   ***************************************************************
N25  C     SREMMA1       BEGSR
N25   ***************************************************************
N25  C     1             CHAIN     EDIC                               36
N25  C                   ADD       1             CSN
N25  C                   ADD       1             CMN
N25  C                   UPDATE    EDICR
N25  C                   EVAL      WMBRA = 'S'
N25  C                   EVAL      WMBRB = CSN
N25   * Lag fil og set codepage (pc)
N25  C                   MOVE      *BLANKS       WFilNam         256
N25  C                   EVAL      WFilNam= '/' + %TRIM(UELIBF) + 'X'
N25  C                             + '/EMMA/EDISE/' + %TRIM(SETLE)
N25  C                             + %TRIM(SETLL) + '_DEKLKODE.xml'
N25  C                   MOVE      *BLANKS       WFilNam2        256
N25  C                   EVAL      WFilNam2 = '/' + %TRIM(UELIBF) + 'X'
N25  C                             + '/EMMA/EDISE1K/BACKUP/' + %TRIM(SETLE)
N25  C                             + %TRIM(SETLL) + '_' + %TRIM(CPHONE) + '.xml'
N25  C                   EVAL      FILE_o = open( %TrimR( WFilNam2 )
N25  C                             : 'w, codepage=819' )
N25  C                   EVAL      rc = close( FILE_o )
N25  C                   EVAL      FILE_o = open( %TrimR( WFilNam2 )
N25  C                             : 'w' )
N25   *
N25  C                   EVAL      XDATA = '<?xml version="1.0" '
N25  C                             + 'encoding="ISO-8859-1" '
N25  C                             + 'standalone="yes"?>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<EmmaSystemsFortolling>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Fortolling>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Tollnummer>'
N25  C                             + %TRIM(SETLE) + %TRIM(SETLL)
N25  C                             + '</Tollnummer>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Unhsekvens>'
N25  C                             + %TRIM(%EDITC(M0068B:'Z')) + '</Unhsekvens>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Unhversjon>'
N25  C                             + %TRIM(%EDITC(M0068C:'Z')) + '</Unhversjon>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Deklarasjon1A>'
N25  C                             + %TRIM(SEDTY) + '</Deklarasjon1A>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   MOVEL     SEDP          XAN01             1
N25  C                   EVAL      XDATA = '<Deklarasjon1B>'
N25  C                             + %TRIM(XAN01) + '</Deklarasjon1B>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   * Avsender
N25  C                   EVAL      XDATA = '<Avsender>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Orgnr>'
N25  C                             + %TRIM(SERG) + '</Orgnr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SENAK
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Navn>'
N25  C                             + %TRIM(XTXT802) + '</Navn>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEADK1
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Gateadresse>'
N25  C                             + %TRIM(XTXT802) + '</Gateadresse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEADK2
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Postadresse>'
N25  C                             + %TRIM(XTXT802) + '</Postadresse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C     ' '           SCAN      SEADK3        XPOS              3 0    36
N25  C   36              IF        XPOS < 10
N25  C                   EVAL      XTXT801 = %SUBST(SEADK3:1:XPOS-1)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Postnr>'
N25  C                             + %TRIM(XTXT802) + '</Postnr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XPOS = XPOS + 1
N25  C                   ELSE
N25  C                   EVAL      XPOS = 1
N25  C                   END
N25  C  N36              EVAL      XPOS = 1
N25  C                   EVAL      XTXT801 = %SUBST(SEADK3:XPOS:31-XPOS)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Poststed>'
N25  C                             + %TRIM(XTXT802) + '</Poststed>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Land>NORGE</Land>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Landkode>NO</Landkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        SEKNK <> 0
N25  C                   EVAL      XDATA = '<Nr>'
N25  C                             + %TRIM(%EDITC(SEKNK:'Z')) + '</Nr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   EVAL      XDATA = '</Avsender>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   EVAL      XDATA = '<Vareposter>'
N25  C                             + %TRIM(%EDITC(XNR:'Z')) + '</Vareposter>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Antallkolli>'
N25  C                             + %TRIM(%EDITC(SENTK:'Z')) + '</Antallkolli>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<TotBruttoVekt>'
S36  C*                            + %TRIM(%EDITC(SEVKB:'Z'))
N36  C                             + %TRIM(%EDITC(XTVKTBEMMA:'Z'))
N25  C                             + '</TotBruttoVekt>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   MOVE      SEAVD         XAN04             4
N25  C                   MOVE      SETDN         XAN07             7
N25  C                   MOVE      *BLANKS       KUREF            35
N25  C                   EVAL      KUREF = XAN04 + '/' + XAN07 + '/' + SESG
N25  C                   EVAL      XDATA = '<Referanse>'
N25  C                             + %TRIM(KUREF) + '</Referanse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   * Mottager
N25  C                   EVAL      XDATA = '<Mottaker>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SENAS
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Navn>'
N25  C                             + %TRIM(XTXT802) + '</Navn>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEADS1
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Gateadresse>'
N25  C                             + %TRIM(XTXT802) + '</Gateadresse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEADS2
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Postadresse>'
N25  C                             + %TRIM(XTXT802) + '</Postadresse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C     ' '           SCAN      SEADS3        XPOS              3 0    36
N25  C   36              IF        XPOS < 10
N25  C                   EVAL      XTXT801 = %SUBST(SEADS3:1:XPOS-1)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Postnr>'
N25  C                             + %TRIM(XTXT802) + '</Postnr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XPOS = XPOS + 1
N25  C                   ELSE
N25  C                   EVAL      XPOS = 1
N25  C                   END
N25  C  N36              EVAL      XPOS = 1
N25  C                   EVAL      XTXT801 = %SUBST(SEADS3:XPOS:31-XPOS)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Poststed>'
N25  C                             + %TRIM(XTXT802) + '</Poststed>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C     KODTS2K       CHAIN     KODTS2                             42
N25  C                   EVAL      XTXT801 = KS2FTX
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Land>'
N25  C                             + %TRIM(XTXT802) + '</Land>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Landkode>'
N25  C                             + %TRIM(SELKA) + '</Landkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        SEKNS <> 0
N25  C                   EVAL      XDATA = '<Nr>'
N25  C                             + %TRIM(%EDITC(SEKNS:'Z')) + '</Nr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   EVAL      XDATA = '</Mottaker>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   * Deklarant
N25  C                   EVAL      XTXT801 = SENAD
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Deklarantnavn>'
N25  C                             + %TRIM(XTXT802) + '</Deklarantnavn>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SETLF
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Deklaranttlf>'
N25  C                             + %TRIM(XTXT802) + '</Deklaranttlf>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   EVAL      XDATA = '<Landkode>'
N25  C                             + %TRIM(SELKA) + '</Landkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = KS2FTX
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Landtekst>'
N25  C                             + %TRIM(XTXT802) + '</Landtekst>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Container>'
N25  C                             + %TRIM(SEKDC) + '</Container>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SELV2
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Levvilkkode>'
N25  C                             + %TRIM(XTXT802) + '</Levvilkkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SELVT
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Levvilktekst>'
N25  C                             + %TRIM(XTXT802) + '</Levvilktekst>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SETRID
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<AktivtransportID>'
N25  C                             + %TRIM(XTXT802) + '</AktivtransportID>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<AktivtransportTYPE>'
N25  C                             + %TRIM(SELKT) + '</AktivtransportTYPE>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Fakturabelop>'
N25  C                             + %TRIM(%EDITC(SEBEL1:'L'))
N25  C                             + '</Fakturabelop>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Fakturuakurs>'
N25  C                             + %TRIM(%EDITC(SEVKU:'4'))
N25  C                             + '</Fakturuakurs>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Transaksjonstype>'
N25  C                             + %TRIM(%EDITC(SETST:'Z'))
N25  C                             + '</Transaksjonstype>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Transportvedgrensen>'
N25  C                             + %TRIM(%EDITC(SETRM:'Z'))
N25  C                             + '</Transportvedgrensen>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        SEKDDK = ' '
N25  C                   EVAL      XDATA = '<Betaler>M</Betaler>'
N25  C                   ELSE
N25  C                   EVAL      XDATA = '<Betaler>'
N25  C                             + %TRIM(SEKDDK) + '</Betaler>'
N25  C                   END
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   * Faktura
N25  C                   EXSR      SREMMA2
N25   *
N25  C                   MOVE      SEKDH         XAN04             4
N25  C                   EVAL      XDATA = '<Utpasseringstollstedkode>'
N25  C                             + %TRIM(XAN04)
N25  C                             + '</Utpasseringstollstedkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Utpasseringstollstedtekst>'
N25  C                             + %TRIM(SEKDFT)
N25  C                             + '</Utpasseringstollstedtekst>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Varenslagringsstedkode>'
N25  C                             + %TRIM(SEKDLS)
N25  C                             + '</Varenslagringsstedkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SELS
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Varenslagringsstedtekst>'
N25  C                             + %TRIM(XTXT802)
N25  C                             + '</Varenslagringsstedtekst>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   ENDSR
N25   *
N25   ***************************************************************
N25  C     SREMMA2       BEGSR
N25   ***************************************************************
N25   *
N25  C                   IF        SEFIF = 'F15  ER  BENYTTET'
N25   *
N25  C     SAEFK         SETLL     SAEF
N25  C     SAEFK         READE     SAEF                                   36
N25  C                   DOW       *IN36 = *OFF
N25  C                   EVAL      XDATA = '<Faktura>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SFTXT
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Fakturanr>'
N25  C                             + %TRIM(XTXT802) + '</Fakturanr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Belop>'
N25  C                             + %TRIM(%EDITC(SFBL28:'4')) + '</Belop>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Valuta>'
N25  C                             + %TRIM(SFVK28) + '</Valuta>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Kurs>'
N25  C                             + %TRIM(%EDITC(SFKR28:'4')) + '</Kurs>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Dato>'
N25  C                             + %TRIM(%EDITW(SEDT:'    .  .  '))
N25  C                             + '</Dato>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</Faktura>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C     SAEFK         READE     SAEF                                   36
N25  C                   ENDDO
N25   *
N25  C                   ELSE
N25  C                   EVAL      XDATA = '<Faktura>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEFIF
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Fakturanr>'
N25  C                             + %TRIM(XTXT802) + '</Fakturanr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Belop>'
N25  C                             + %TRIM(%EDITC(SEBEL1:'4')) + '</Belop>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Valuta>'
N25  C                             + %TRIM(SEVAL1) + '</Valuta>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Kurs>'
N25  C                             + %TRIM(%EDITC(SEVKU:'4')) + '</Kurs>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Dato>'
N25  C                             + %TRIM(%EDITW(SEFID:'    .  .  '))
N25  C                             + '</Dato>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</Faktura>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25   *
N25  C                   ENDSR
N25   *
N25   ***************************************************************
N25  C     SREMMA5       BEGSR
N25   ***************************************************************
N25  C                   EVAL      XDATA = '<Varelinje>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C*                  EVAL      XDATA = '<Grunnlag>'
N25  C*                            + %TRIM(%EDITC(XXXXXX:'Z')) + '</Grunnlag>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   IF        SEKDC = '0'
N25  C*    1             DO        7             XN7               3 0
N25  C*                  IF        KN(XN7) <> *BLANKS
N25  C*                  EVAL      XDATA = '<MerkeogNummer>'
N25  C*                            + %TRIM(KN(XN7)) + '</MerkeogNummer>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  END
N25  C*                  ENDDO
N25  C                   IF        KN(1) <> *BLANKS
N25  C                   EVAL      XTXT801 = KN(1)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<MerkeogNummer>'
N25  C                             + %TRIM(XTXT802) + '</MerkeogNummer>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   END
N25   *
N25  C                   IF        WFEANT = 0
N25  C                   EVAL      XDATA = '<Antall>'
N25  C                             + %TRIM(%EDITC(SENTK:'Z')) + '</Antall>'
N25  C                   ELSE
N25  C                   EVAL      XDATA = '<Antall>'
N25  C                             + %TRIM(%EDITC(WFEANT:'Z')) + '</Antall>'
N25  C                   END
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = VB(1)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Vareslag>'
N25  C                             + %TRIM(XTXT802) + '</Vareslag>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        VB(2) <> *BLANKS
N25  C                   EVAL      XTXT801 = VB(2)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsbeskrivelse1>'
N25  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse1>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   IF        VB(3) <> *BLANKS
N25  C                   EVAL      XTXT801 = VB(3)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsbeskrivelse2>'
N25  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse2>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   IF        VB(4) <> *BLANKS
N25  C                   EVAL      XTXT801 = VB(4)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsbeskrivelse3>'
N25  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse3>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   IF        VB(5) <> *BLANKS
N25  C                   EVAL      XTXT801 = VB(5)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsbeskrivelse4>'
N25  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse4>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   IF        VB(6) <> *BLANKS
N25  C                   EVAL      XTXT801 = VB(6)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsbeskrivelse5>'
N25  C                             + %TRIM(XTXT802) + '</Godsbeskrivelse5>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25   *
N25  C                   IF        SEKDC = '1'
N25  C     1             DO        7             XN7               3 0
N25  C                   IF        KN(XN7) <> *BLANKS
N25  C                   EVAL      XTXT801 = KN(XN7)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Container' + %TRIM(%EDITC(XN7:'Z'))
N25  C                             + '>' + %TRIM(XTXT802)
N25  C                             + '</Container' + %TRIM(%EDITC(XN7:'Z')) +'>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   ENDDO
N25  C                   END
N25   *
N25  C                   IF        WFERNR = 0
N25  C                   EVAL      XDATA = '<Varepostnr>1</Varepostnr>'
N25  C                   ELSE
N25  C                   EVAL      XDATA = '<Varepostnr>'
N25  C                             + %TRIM(%EDITC(WFERNR:'4')) + '</Varepostnr>'
N25  C                   END
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   MOVE      WFEVNT        XAN08             8
N25  C                   EVAL      XDATA = '<Varenummer>'
N25  C                             + %TRIM(XAN08) + '</Varenummer>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        %SUBST(WFEFYL:1:1) >= '0' AND
N25  C                             %SUBST(WFEFYL:1:1) <= '9'
N25  C                   EVAL      XDATA = '<Opprfylke>'
N25  C                             + %TRIM(WFEFYL) + '</Opprfylke>'
N25  C                   ELSE
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Opprinnelse>'
N25  C                             + %TRIM(WFEFYL) + '</Opprinnelse>'
N25  C                   END
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Bruttovekt>'
N25  C                             + %TRIM(%EDITC(WFEVKB:'4')) + '</Bruttovekt>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Prosedyre>'
N25  C                             + %TRIM(%EDITC(SEDP:'4')) + '</Prosedyre>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Nettovekt>'
N25  C                             + %TRIM(%EDITC(WFEVKN:'Z')) + '</Nettovekt>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Annenenhet>'
N25  C                             + %TRIM(%EDITC(WFENTM:'Z')) + '</Annenenhet>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C     1             DO        15            XN7               3 0
N25  C                   IF        TO(XN7) <> *BLANKS
N25  C                   EVAL      XDATA = '<Dokument>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Kode>'
N25  C                             + %TRIM(TC(XN7)) + '</Kode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = TO(XN7)
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Tekst>'
N25  C                             + %TRIM(XTXT802) + '</Tekst>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</Dokument>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   ENDDO
N25   *
N25  C                   EVAL      XDATA = '<Statistiskverdi>'
N25  C                             + %TRIM(%EDITC(WFESTB:'Z'))
N25  C                             + '</Statistiskverdi>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C     1             DO        8             XN7               3 0
N25  C                   IF        TY(XN7) <> *BLANKS
N25  C                   EVAL      XDATA = '<Avgift>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Avgkode>'
N25  C                             + %TRIM(TY(XN7)) + '</Avgkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Grunnlag>'
N25  C                             + %TRIM(%EDITC(GL(XN7):'4')) + '</Grunnlag>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Sats>'
N25  C                             + %TRIM(%EDITC(ST(XN7):'4')) + '</Sats>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Belop>'
N25  C                             + %TRIM(%EDITC(BL(XN7):'4')) + '</Belop>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<BM>'
N25  C                             + %TRIM(PR(XN7)) + '</BM>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</Avgift>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   END
N25  C                   ENDDO
N25   *
N25  C                   EVAL      XDATA = '</Varelinje>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   ENDSR
N25   *
N25   ***************************************************************
N25  C     SREMMA9       BEGSR
N25   ***************************************************************
N25   * VEDLEGG
N25  C                   MOVE      *BLANKS       VKD
N25  C     ARKVEDKK      CHAIN     ARKVEDK                            36
N34  C                   IF        AVKVED = *BLANKS
N34  C     'se'          CHAIN     ARKTXT                             36
N34  C  N36              EVAL      AVKVED = ARKVED
N34  C                   END
N25  C                   EVAL      VKD(1) = 'se'
N25  C                   EVAL      VKD(2) = 'sg'
N25   *
N25  C                   EVAL      ARTYPE = VKD(1)
N25  C                   Z-ADD     1             XN8               3 0
N25  C                   MOVE      *BLANKS       VEDL
N25  C                   MOVE      *ZEROS        XN7
S30  C*    FIFIRM        CHAIN     FIRMARC                            36
N25  C     STEMMA91      TAG
N25  C     ARTYPE        CHAIN     ARKTXT                             36
N25  C                   IF        ARKLAG <> *BLANKS
N25  C     ARKEXTK       CHAIN     ARKEXT                             36
N30  C                   ELSE
N30  C     FIFIRM        CHAIN     FIRMARC                            36
N25  C                   END
N25  C     ARKIVL02K     SETLL     ARKIVL02
N25  C     ARKIVL02K     READE     ARKIVL02                               36
N25  C                   DOW       *IN36 = *OFF
N25  C                   ADD       1             XN7
N25  C     '.'           SCAN      ARLINK                                 36
N25  C  N36              EVAL      ARLINK = %TRIM(ARLINK) + '.pdf'
N25  C                   EVAL      VEDL(XN7) = '/' + %TRIM(ARCANE)
N25  C                             + '/' + %TRIM(ARLINK)
N25  C                   EVAL      XDATA = '<Vedlegg>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Filnavn>'
N25  C                             + %TRIM(ARLINK) + '</Filnavn>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   IF        ARRFK = *BLANKS
N25  C                   EVAL      ARRFK = %TRIM(ARTXT) + ' ' + %TRIM(KUREF)
N25  C                   END
N25  C                   EVAL      XDATA = '<Beskrivelse>'
N25  C                             + %TRIM(ARRFK) + '</Beskrivelse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</Vedlegg>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C     ARKIVL02K     READE     ARKIVL02                               36
N25  C                   ENDDO
N25  C                   ADD       1             XN8
N25  C                   IF        VKD(XN8) <> *BLANKS
N25  C                   EVAL      ARTYPE = VKD(XN8)
N25  C                   GOTO      STEMMA91
N25  C                   END
N25   *
N25  C                   MOVE      SEKTA         XAN05             5
N25  C                   EVAL      XDATA = '<Tollkontonr>'
N25  C                             + %TRIM(SEKTC) + %TRIM(XAN05)
N25  C                             + '</Tollkontonr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   MOVE      SEKTB         XAN02             2
N25  C                   EVAL      XDATA = '<Kontrollsiffer>'
N25  C                             + %TRIM(XAN02) + '</Kontrollsiffer>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEGN
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Godsnr>'
N25  C                             + %TRIM(XTXT802) + '</Godsnr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SEPOS
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Posnr>'
N25  C                             + %TRIM(XTXT802) + '</Posnr>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   SELECT
N25  C*                  WHEN      XSIFRT1 <> *BLANKS
N25  C*                  EVAL      XTXT801 = XSIFRT1
N25  C*                  EXSR      KNVST
N25  C*                  EVAL      XDATA = '<Regnskapsopplysninger1>'
N25  C*                            + %TRIM(XTXT802)
N25  C*                            + '</Regnskapsopplysninger1>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XTXT801 = XSIFRT2
N25  C*                  EXSR      KNVST
N25  C*                  EVAL      XDATA = '<Regnskapsopplysninger2>'
N25  C*                            + %TRIM(XTXT802)
N25  C*                            + '</Regnskapsopplysninger2>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XTXT801 = XSIFRT3
N25  C*                  EXSR      KNVST
N25  C*                  EVAL      XDATA = '<Regnskapsopplysninger3>'
N25  C*                            + %TRIM(XTXT802)
N25  C*                            + '</Regnskapsopplysninger3>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XTXT801 = XSIFRT4
N25  C*                  EXSR      KNVST
N25  C*                  EVAL      XDATA = '<Regnskapsopplysninger4>'
N25  C*                            + %TRIM(XTXT802)
N25  C*                            + '</Regnskapsopplysninger4>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   WHEN      XBETALT <> *BLANKS
N25  C                   EVAL      XTXT801 = XBETALT
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Regnskapsopplysninger1>'
N25  C                             + %TRIM(XTXT802)
N25  C                             + '</Regnskapsopplysninger1>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = XFAKTNR
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Regnskapsopplysninger2>'
N25  C                             + %TRIM(XTXT802)
N25  C                             + '</Regnskapsopplysninger2>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Regnskapsopplysninger3>'
N25  C                             + %TRIM(XBETALL)
N25  C                             + '</Regnskapsopplysninger3>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   ENDSL
N25   *
N25  C                   EVAL      XTXT801 = SEDST
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Sted>'
N25  C                             + %TRIM(XTXT802) + '</Sted>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Dato>'
N25  C                             + %TRIM(PRODAT) + '</Dato>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SENAD1
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Representantensnavn>'
N25  C                             + %TRIM(XTXT802) + '</Representantensnavn>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XTXT801 = SETARF
N25  C                   EXSR      KNVST
N25  C                   EVAL      XDATA = '<Representantensunderskrift>'
N25  C                             + %TRIM(XTXT802)
N25  C                             + '</Representantensunderskrift>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   * Tilleggsopplysninger
N25  C                   EVAL      XDATA = '<TilleggsOpplysninger>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Deklkode>'
N25  C                             + %TRIM(CPHONE) + '</Deklkode>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XDATA = '<OppdragsGivernr>'
N25  C*                            + '</OppdragsGivernr>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XDATA = '<OppdragsGivernavn>'
N25  C*                            + %TRIM(SINAK) + '</OppdragsGivernavn>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C*                  EVAL      XDATA = '<OppdragsGiverorgnr>'
N25  C*                            + %TRIM(SIRG) + '</OppdragsGiverorgnr>'
N25  C*                  EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<InternReferanse>'
N25  C                             + %TRIM(KUREF) + '</InternReferanse>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<ImportEksport>E</ImportEksport>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<Godkjentdato>'
N25  C                             + %SUBST(SEDTG:7:2) + '.'
N25  C                             + %SUBST(SEDTG:5:2) + '.'
N25  C                             + %SUBST(SEDTG:1:4) + '</Godkjentdato>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<SumAvgifter>'
N25  C                             + %TRIM(%EDITC(XTOT:'Z'))
N25  C                             + '</SumAvgifter>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<SumMoms></SumMoms>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '<SumEkslMoms>'
N25  C                             + %TRIM(%EDITC(XTOT:'Z'))
N25  C                             + '</SumEkslMoms>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</TilleggsOpplysninger>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25   *
N25  C                   EVAL      XDATA = '</Fortolling>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      XDATA = '</EmmaSystemsFortolling>'
N25  C                   EVAL      rc = fputs(%trimr(XDATA) + LF: File_o)
N25  C                   EVAL      rc = close( FILE_o )
N25   *
N25  C                   CALL      'SYGE15C'
N25  C                   PARM                    WDT               8
N25  C                   PARM                    WTM               6
N25   *
N25  C                   CLEAR                   EDISR0
N25  C                   EVAL      S0_S0004  = CMOBIL
N25  C                   EVAL      S0_S0010  = CFAX
N25  C                   EVAL      S0_S0020  = WMBR
N25  C                   EVAL      S0_SSN    = CSN
N25  C                   EVAL      S0_SSR    = 'S'
N25  C                   EVAL      S0_SST    = 'A'
N25  C                   EVAL      S0_S0036  = 1
N25  C                   MOVEL     WDT           S0_SDT
N25  C                   MOVEL     WTM           S0_STM
N25  C                   EVAL      S0_SFILE  = '*IFS'
N25  C                   EVAL      S0_SMBR   = WMBR
N25  C                   EVAL      S0_SLIB   = '*LIBL'
N25  C                   EVAL      S0_SIFS   = WFILNAM2
N25  C                   WRITE     EDISR0
N25   *
N25  C                   CLEAR                   EDISXR0
N25  C                   EVAL      X0_SXPRODM  = WMBR
N25  C                   EVAL      X0_SXIFSOBJ = Wfilnam2
N25  C                   WRITE     EDISXR0
N25   *
N25  C                   CLEAR                   EDIMR0
N25  C                   EVAL      M0_M0004  = CMOBIL
N25  C                   EVAL      M0_M0010  = CFAX
N25  C                   EVAL      M0_MSN    = CSN
N25  C                   EVAL      M0_MMN    = CMN
N25  C                   EVAL      M0_MSR    = 'S'
N25  C                   EVAL      M0_MST    = 'C'
N25  C                   EVAL      M0_MAVD   = SEAVD
N25  C                   EVAL      M0_MTDN   = SETDN
N25  C                   EVAL      M0_M0035  = M0035
N25  C                   EVAL      M0_M0062  = M0062
N25  C                   EVAL      M0_M0065  = 'XMLEMA'
N25  C                   EVAL      M0_M0068  = 'EMMA-' + %TRIM(KUREF)
N25  C                   EVAL      M0_M1001  = '830'
N25  C                   EVAL      M0_M1004  = *BLANKS
N25  C                   EVAL      M0_M1225  = 'XML'
N25  C                   EVAL      M0_M1N07  = 'XML'
N25  C                   EVAL      M0_M0068A = M0068A
N25  C                   EVAL      M0_M0068B = M0068B
N25  C                   EVAL      M0_M0068C = M0068C
N25  C                   MOVEL     WDT           M0_MDT
N25  C                   MOVEL     WTM           M0_MTM
N25  C                   WRITE     EDIMR0
N25   * VEDL
N25  C     1             DO        100           XN7
N25  C                   IF        VEDL(XN7) = *BLANKS
N25  C                   LEAVE
N25  C                   END
N25  C     1             CHAIN     EDIC                               51
N25  C                   ADD       1             CSN
N25  C                   UPDATE    EDICR
N25  C                   EVAL      WMBRB = CSN
N25  C                   EVAL      S0_S0020  = WMBR
N25  C                   EVAL      S0_SSN    = CSN
N25  C                   EVAL      S0_SST    = 'A'
N25  C                   EVAL      S0_SFILE  = '*IFS'
N25  C                   EVAL      S0_SMBR   = WMBR
N25  C                   EVAL      S0_SLIB   = '*LIBL'
N25  C                   EVAL      S0_SIFS   = VEDL(XN7)
N25  C                   WRITE     EDISR0
N25  C                   ENDDO
N25   *
N25  C                   ENDSR
N25   *
N25   ***********************************************
N25  C     KNVST         BEGSR
N25   ***********************************************
N25  C                   Z-ADD     50            XN53              3 0
N25  C     XN53          SUB       4             XN54              3 0
N25  C     XN53          SUB       5             XN55              3 0
N25  C     XN53          SUB       6             XN56              3 0
N25  C                   Z-ADD     0             XN52              3 0
N25  C                   MOVE      *BLANKS       XTXT802
N25  C     1             DO        80            XN51              3 0
N25  C                   IF        (((((XT801(XN51) = '&') OR
N25  C                                 (XT801(XN51) = '"')) OR
N25  C                                 (XT801(XN51) = XAPS)) OR
N25  C                                 (XT801(XN51) = '<')) OR
N25  C                                 (XT801(XN51) = '>'))
N25  C                   IF        XN52 < XN53
N25  C                   ADD       1             XN52
N25  C                   SELECT
N25  C                   WHEN      XT801(XN51) = '&'
N25  C                   IF        XN51 < XN55
N25  C                   MOVEA     '&amp;'       XT802(XN52)
N25  C                   ADD       4             XN52
N25  C                   ELSE
N25  C                   SUB       1             XN52
N25  C                   END
N25  C                   WHEN      XT801(XN51) = '"'
N25  C                   IF        XN51 < 75
N25  C                   MOVEA     '&quot;'      XT802(XN52)
N25  C                   ADD       5             XN52
N25  C                   ELSE
N25  C                   SUB       1             XN52
N25  C                   END
N25  C                   WHEN      XT801(XN51) = XAPS
N25  C                   IF        XN51 < XN56
N25  C                   MOVEA     '&apos;'      XT802(XN52)
N25  C                   ADD       5             XN52
N25  C                   ELSE
N25  C                   SUB       1             XN52
N25  C                   END
N25  C                   WHEN      XT801(XN51) = '>'
N25  C                   IF        XN51 < XN54
N25  C                   MOVEA     '&gt;'        XT802(XN52)
N25  C                   ADD       3             XN52
N25  C                   ELSE
N25  C                   SUB       1             XN52
N25  C                   END
N25  C                   WHEN      XT801(XN51) = '<'
N25  C                   IF        XN51 < XN54
N25  C                   MOVEA     '&lt;'        XT802(XN52)
N25  C                   ADD       3             XN52
N25  C                   ELSE
N25  C                   SUB       1             XN52
N25  C                   END
N25  C                   ENDSL
N25  C                   END
N25  C                   ELSE
N25  C                   IF        XN52 < XN53
N25  C                   ADD       1             XN52
N25  C                   MOVE      XT801(XN51)   XT802(XN52)
N25  C                   ELSE
N25  C                   LEAVE
N25  C                   END
N25  C                   END
N25  C                   ENDDO
N25   *
N25  C                   ENDSR
N25   *
      * =============================================================
      *
      *** ............ START DEL-1 (IKKE DATA LISTE PÅ DEL-2) .......
s16  O*OLLDEK   E            DEL1             01
s16  O*                      KFMT1               75
s16  O*         E            DEL1             02
S03  O*                                          27 'REF:     /     /   '
s11  O*                                          27 'REF:     /       /   '
s16  O*                                          29 'REF:     /       /   '
s16  O*                      SEAVD         Z     17
s16  O*                      SETDN         Z     25
s16  O*                      SESG                29
s03  O*                      FSSO15              60
s11  O*                      FSSO15              47
S16  O*                      FSSO25              55
s16  O*              39   N37                    75 'LINJEDEKLARERT'
s10  O*             N39 34N37                    77 'LINJEDEKLARERT KOPI'
s16  O*             N39 34N37                    77 'L.DEKLARERT KOPI'
S16  O*              39    37                    75 'UTLEV.-ATTEST '
s10  O*             N39 34 37                    77 'UTLEV.-ATTEST  KOPI'
s16  O*             N39 34 37                    78 'UTLEV-ATTEST KOPI'
s16  O*         E            DEL1             03
S16  O*                                           8 '**'
s16  O*                      XRG                 37
s16  O*                      SEDTG               67
s16  O*         E            DEL1             04
s16  O*                                           8 '**'
s16  O*                      SENAK               39
s16  O*                      SEDTY               47
S16  O*                      XDP1                50
s16  O*                      SETLL               67
s16  O*         E            DEL1             05
s16  O*                      SEADK1              39
s16  O*                      SETLE               63
s16  O*         E            DEL1             06
s16  O*                      SEADK2              39
s16  O*                      XSIDE         Z     46
S16  O*                      XTSIDE        Z     49
s16  O*         E            DEL1             07
s16  O*                      SEADK3              39
s16  O*                      SEKNK         Z     78
s16  O*         E            DEL1             08
s16  O*                      XNR           Z     47
s16  O*                      SENTK         Z     55
s03  O*                                          72 '    /       /   '
S03  O*                      SEAVD         Z     60
s03  O*                      SETDN         Z     68
s16  O*                      SEAVD               62
s16  O*                      SETDN               69
s16  O*                      SESG                72
s07  O*                      SEKNK         Z     80
s16  O*         E            DEL1             09
s16  O*                      SEKNS         Z     39
S16  O*         E            DEL1             10
s16  O*                      SENAS               39
s16  O*         E            DEL1             11
s16  O*                      SEADS1              39
s16  O*         E            DEL1             12
s16  O*                      SEADS2              39
s16  O*         E            DEL1             13
s16  O*                      SEADS3              39
S16  O*         E            DEL1             15
s16  O*                      SETLF               37
s16  O*         E            DEL1             16
s16  O*                      SELKA               67
s16  O*                      SELKAT              65
s16  O*                      SELKB               76
s16  O*         E            DEL1             17
s16  O*                      SENAD               39
S16  O*         E            DEL1             18
s16  O*                      SEFTB               80
s16  O*         E            DEL1             20
s16  O*                      SEKDC               43
s16  O*                      SELV2               48
s16  O*                      SELVT               67
s16  O*         E            DEL1             22
s16  O*                      SETRID              27
S16  O*                      SELKT               43
s16  O*                      SETST               73
s16  O*         E   N89   N93DEL1             22
s16  O*             N43      XBEL1         M     62
s08  O*                                          62 '    '
s16  O*                      SEVAL1              48
s16  O*             N43      SEVKU         J     71
s16  O*         E            DEL1             24
S16  O*                      SETRM         Z     11
s16  O*         E      N60   DEL1             24
s16  O*                      SEFIF               65
s16  O*                 92                       78 '    .  .  '
s16  O*                 92   SEFIDÅ              72
s16  O*                 92   SEFIDM              75
s16  O*                 92   SEFIDD              78
s16  O*         E       60   DEL1             24
S16  O*                                          70 'SE FAKTURAOVERSIKT'
s16  O*         E            DEL1             25
s16  O*                                           8 '**'
s16  O*         E            DEL1             26
s16  O*                                           8 '**'
s16  O*                      SEKDFT              26
s16  O*                      SELS                42
s16  O*                                          42 ' '
S16  O*                      SEKDLS              44
s16  O*         E            DEL1             28
s16  O*                      XN2           Z     50
s16  O*                      XWFVN1              60 '0    .  '
s16  O*                      XWFVN2              65
s16  O*         E            DEL1             29
s16  O*                      KN(1)               25
s16  O*             N99      WFEANT        Z     32
S16  O*             N99      WFEVT               37
s16  O*              99      WFEVT               30
s16  O*              99      WFEANT        Z     35
s16  O*                      VB(1)               53
s16  O*         E            DEL1             30
s16  O*                      KN(2)               25
s16  O*                      VB(2)               53
s16  O*                      WFEFYL              61
S16  O*                      WFEVKB        Z     73
s16  O*         E            DEL1             31
s16  O*                      KN(3)               25
s16  O*                      VB(3)               53
s16  O* 95 ON=Agent står i rubr.8 - varemottaker må skrives her (T-DOK)
s16  O*         E            DEL1             32
s16  O*             N95      KN(4)               25
s16  O*             N95      VB(4)               53
S16  O*              95                          22 'Varemottaker:'
s16  O*              95      HENAK               53
s16  O*                      SEDP                57
s16  O*                      WFEVKN        Z     73
s16  O*         E   N95      DEL1             33
s16  O*                      KN(5)               25
s16  O*                      VB(5)               53
s16  O*         E    95      DEL1             33
S16  O*                                          22 '(Empfanger)  '
s16  O*                      HEADK1              53
s16  O*         E   N95      DEL1             34
s16  O*                      KN(6)               25
s16  O*                      VB(6)               53
s16  O*         E    95      DEL1             34
s16  O*                                          22 '(Consignee)  '
s16  O*                      HEADK2              53
S16  O*         E   N95      DEL1             35
s16  O*                      KN(7)               25
s16  O*             N48      VB(7)               53
s16  O*              48 91   VB(7)               53
s16  O*              48N91                       35 'EX Cont:'
s16  O*              48N91   HETRCN              53
s16  O*         E    95      DEL1             35
s16  O*                      HEADK3              53
S16  O*         E            DEL1             36
s16  O*                      TO(1)               53
s16  O*                      XVNTM         Z     62
s16  O*         E            DEL1             37
s16  O*                      TO(2)               53
s16  O*         E            DEL1             38
s16  O*                      TO(3)               53
s16  O*         E            DEL1             39
S16  O*                      TO(4)               53
s16  O*         E            DEL1             40
s16  O*                      TO(5)               53
s16  O*                      WFESTB        Z     77
s16  O*         E            DEL1             42
s16  O*                      TY(1)               11
s16  O*                      GL(1)         Z     21
s16  O*                      ST(1)         2     30
S16  O*                      PR(1)               31
s16  O*                      BL(1)         Z     41
s16  O*             N41N42   SEKTC               45
s16  O*             N41N42   SEKTA               50
s16  O*             N41N42                       52 '-'
s16  O*             N41N42   SEKTB               55
s16  O*              41                          55 'DAGSOPPGJØR'
s16  O*                 42                       53 'KONTANT'
S16  O*         E            DEL1             42
s16  O*                      UTGNP               78
s16  O*         E            DEL1             43
s16  O*                      TY(2)               11
s16  O*                      GL(2)         Z     21
s16  O*                      ST(2)         2     30
s16  O*                      PR(2)               31
s16  O*                      BL(2)         Z     41
S16  O*         E            DEL1             44
s16  O*                      TY(3)               11
s16  O*                      GL(3)         Z     21
s16  O*                      ST(3)         2     30
s16  O*                      PR(3)               31
s16  O*                      BL(3)         Z     41
s16  O*                      XBETALT             77
s16  O*         E            DEL1             45
S16  O*                      TY(4)               11
s16  O*                      GL(4)         Z     21
s16  O*                      ST(4)         2     30
s16  O*                      PR(4)               31
s16  O*                      BL(4)         Z     41
s16  O*                      XFAKTNR             77
s16  O*         E            DEL1             46
s16  O*                      XBETALL             77
S16  O*         E            DEL1             50
s16  O*                      XTOT          Z     41
s16  O*         E            DEL1             59
s16  O*                      SEGFT1              39
s16  O*         E            DEL1             60
s16  O*                      SEGFT2              39
s16  O*                      SEGKD         Z     55
s16  O*         E            DEL1             62
S16  O*                      SEDST               69
s01  O*                                          78 '    .  .  '
s01  O*                      UCENT               70
s01  O*                      UYEAR               72
s01  O*                      UMONTH              75
s01  O*                      UDAY                78
s16  O*                      PRODAT              78
s16  O*         E            DEL1             64
S16  O*                      SENAD               84
s16  O*         E            DEL1             66
s16  O*                      SETARF              70
s16  O*         E            DEL1             70
s16  O*                      KFMT2               75
s16  O*** '''''''''''' SLUTT DEL-1 (IKKE DATA LISTE PÅ DEL-2) ''''''
s16  O*
s16  O*** ............ START DEL-1 (DATA LISTE PÅ DEL-2) ...........
S16  O*OLLDEK   E            DLDEL1           01
s16  O*                      KFMT1               75
s16  O*         E            DLDEL1           02
s03  O*                                          27 'REF:     /     /   '
s16  O*                                          29 'REF:     /       /   '
s16  O*                      SEAVD         Z     17
s16  O*                      SETDN         Z     25
s16  O*                      SESG                29
S03  O*                      FSSO15              60
s11  O*                      FSSO15              47
s16  O*                      FSSO25              55
s16  O*              39   N37                    75 'LINJEDEKLARERT'
s16  O*             N39 34N37                    77 'LINJEDEKLARERT KOPI'
s10  O*             N39 34N37                    77 'L.DEKLARERT KOPI'
s16  O*              39    37                    75 'UTLEV.-ATTEST '
s16  O*             N39 34 37                    77 'UTLEV.-ATTEST  KOPI'
S10  O*             N39 34 37                    78 'UTLEV-ATTEST KOPI'
s16  O*         E            DLDEL1           03
s16  O*                                           8 '**'
s16  O*                      XRG                 37
s16  O*                      SEDTG               67
s16  O*         E            DLDEL1           04
s16  O*                                           8 '**'
s16  O*                      SENAK               39
S16  O*                      SEDTY               47
s16  O*                      XDP1                50
s16  O*                      SETLL               67
s16  O*         E            DLDEL1           05
s16  O*                      SEADK1              39
s16  O*                      SETLE               63
s16  O*         E            DLDEL1           06
s16  O*                      SEADK2              39
S16  O*         E            DLDEL1           07
s16  O*                      SEADK3              39
s16  O*                      SEKNK         Z     78
s16  O*         E            DLDEL1           08
s16  O*                      XNR           Z     47
s16  O*                      SENTK         Z     55
s03  O*                                          72 '    /       /   '
s03  O*                      SEAVD         Z     60
S03  O*                      SETDN         Z     68
s16  O*                      SEAVD               62
s16  O*                      SETDN               69
s16  O*                      SESG                72
s07  O*                      SEKNK         Z     80
s16  O*         E            DLDEL1           09
s16  O*                      SEKNS         Z     39
s16  O*         E            DLDEL1           10
S16  O*                      SENAS               39
s16  O*         E            DLDEL1           11
s16  O*                      SEADS1              39
s16  O*         E            DLDEL1           12
s16  O*                      SEADS2              39
s16  O*         E            DLDEL1           13
s16  O*                      SEADS3              39
s16  O*         E            DLDEL1           15
S16  O*                      SETLF               37
s16  O*         E            DLDEL1           16
s16  O*                      SELKAT              65
s16  O*                      SELKA               67
s16  O*                      SELKB               76
s16  O*         E            DLDEL1           17
s16  O*                      SENAD               39
s16  O*         E            DLDEL1           18
S16  O*                      SEFTB               80
s16  O*         E            DLDEL1           20
s16  O*                      SEKDC               43
s16  O*                      SELV2               48
s16  O*                      SELVT               67
s16  O*         E            DLDEL1           22
s16  O*                      SETRID              27
s16  O*                      SELKT               43
S16  O*                      SETST               73
s16  O*         E   N89   N93DLDEL1           22
s16  O*             N43      XBEL1         M     62
s08  O*                                          62 '    '
s16  O*                      SEVAL1              48
s16  O*             N43      SEVKU         J     71
s16  O*         E            DLDEL1           24
s16  O*                      SETRM         Z     11
S16  O*         E      N60   DLDEL1           24
s16  O*                      SEFIF               65
s16  O*                 92                       78 '    .  .  '
s16  O*                 92   SEFIDÅ              72
s16  O*                 92   SEFIDM              75
s16  O*                 92   SEFIDD              78
s16  O*         E       60   DLDEL1           24
s16  O*                                          70 'SE FAKTURAOVERSIKT'
S16  O*         E            DLDEL1           25
s16  O*                                           8 '**'
s16  O*         E            DLDEL1           26
s16  O*                                           8 '**'
s16  O*                      SEKDFT              26
s16  O*                      SELS                42
s16  O*                                          42 ' '
s16  O*                      SEKDLS              44
S16  O*         E            DLDEL1           30
s16  O*                      SEFT1               53
s15  O*                      SEVKB         Z     73
s16  O*                      XTVKTB        Z     73
s16  O*         E            DLDEL1           32
s16  O*                      SEDP                57
s16  O*                        SEFT2     53
s16  O*             N95      SEFT2               53
S16  O*              95                          22 'Varemottaker:'
s16  O*              95      HENAK               53
s16  O*         E    95      DLDEL1           33
s16  O*                                          22 '(Empfanger)  '
s16  O*                      HEADK1              53
s16  O*         E    95      DLDEL1           34
s16  O*                                          22 '(Consignee)  '
s16  O*                      HEADK2              53
S16  O*         E    95      DLDEL1           35
s16  O*                      HEADK3              53
s16  O*         E            DLDEL1           38
s16  O*         E            DLDEL1           37
s16  O*                      SEFT3               53
s12  O*         E            DLDEL1           38
s16  O*                      TO(3)               53
s16  O*         E            DLDEL1           39
S16  O*                      TO(4)               53
s16  O*         E            DLDEL1           40
s16  O*                      TO(5)               53
s16  O*         E            DLDEL1           42
s16  O*                      T1(1)               11
s16  O*                      T2(1)         Z     41
s16  O*             N41N42   SEKTC               45
s16  O*             N41N42   SEKTA               50
S16  O*             N41N42                       52 '-'
s16  O*             N41N42   SEKTB               55
s16  O*              41                          55 'DAGSOPPGJØR'
s16  O*                 42                       53 'KONTANT'
s16  O*         E            DLDEL1           42
s16  O*                      UTGNP               80
s16  O*         E            DLDEL1           43
s16  O*                      T1(2)               11
S16  O*                      T2(2)         Z     41
s16  O*         E            DLDEL1           44
s16  O*                      T1(3)               11
s16  O*                      T2(3)         Z     41
s16  O*                      XBETALT             77
s16  O*         E            DLDEL1           45
s16  O*                      T1(4)               11
s16  O*                      T2(4)         Z     41
S16  O*                      XFAKTNR             77
s16  O*         E            DLDEL1           46
s16  O*                      XBETALL             77
s16  O*         E            DLDEL1           50
s16  O*                      XTOT          Z     41
s16  O*         E            DLDEL1           59
s16  O*                      SEGFT1              39
s16  O*         E            DLDEL1           60
S16  O*                      SEGFT2              39
s16  O*                      SEGKD         Z     55
s16  O*         E            DLDEL1           62
s16  O*                      SEDST               69
s01  O*                                          78 '    .  .  '
s01  O*                      UCENT               70
s01  O*                      UYEAR               72
s01  O*                      UMONTH              75
s16  O*                      UDAY                78
s16  O*                      PRODAT              78
s16  O*         E            DLDEL1           64
S16  O*                      SENAD               84
s16  O*         E            DLDEL1           66
s16  O*                      SETARF              70
s16  O*OLLDEK   E            DLDEL1           70
s16  O*                      KFMT2               75
      *** '''''''''''' SLUTT DEL-1 (DATA LISTE PÅ DEL-2)
      *
      *
      *** ............ START DEL-2 (STANDARD FORMULAR)
     OTOLLDEK2  E            DEL21            01
     O                       XPFM1               75
     OTOLLDEK2  E            DEL21            02
S03  O*                                          28 'REF:     /     /   '
S11  O*                                          28 'REF:     /       /   '
N11  O                                           29 'REF:     /       /   '
S11  O*                      SEAVD         Z     18
S11  O*                      SETDN         Z     26
S11  O*                      SESG                30
N11  O                       SEAVD         Z     17
N11  O                       SETDN         Z     25
N11  O                       SESG                29
S03  O*                      FSSO15              60
s11  O*                      FSSO15              47
n11  O                       FSSO25              55
     O               39   N37                    75 'LINJEDEKLARERT'
S10  O*             N39 34N37                    77 'LINJEDEKLARERT KOPI'
N10  O              N39 34N37                    77 'L.DEKLARERT KOPI'
     O               39    37                    75 'UTLEV.-ATTEST '
S10  O*             N39 34 37                    77 'UTLEV.-ATTEST  KOPI'
N10  O              N39 34 37                    78 'UTLEV-ATTEST KOPI'
     O          E            DEL21            03
     O                       XRG                 38
     O                       SEDTY               47
     O                       XDP1                50
     O                       SEDTG               68
     O          E            DEL21            04
     O                       SENAK               39
     O                       SETLL               68
     O          E            DEL21            05
     O                       SETLE               63
     O          E            DEL21            06
     O                       XSIDE         Z     47
     O                       XTSIDE        Z     50
     O                                           56 '**'
      *
      *** DEL-2 FØRST VAREPOST
     O          E            DEL21            08
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O          E            DEL21            09
S22  O*                      KN(1)               26
N22  O                       KN(1)               44
     O              N99      WFEANT        Z     33
     O              N99      WFEVT               38
     O               99      WFEVT               31
     O               99      WFEANT        Z     36
     O                       VB(1)               54
     O          E            DEL21            10
S22  O*                      KN(2)               26
N22  O                       KN(2)               44
     O                       VB(2)               54
     O                       WFEFYL              62
     O                       WFEVKB        Z     74
     O          E            DEL21            11
S22  O*                      KN(3)               26
N22  O                       KN(3)               44
     O                       VB(3)               54
     O          E            DEL21            12
S22  O*                      KN(4)               26
N22  O                       KN(4)               44
     O                       VB(4)               54
     O                       SEDP                58
     O                       WFEVKN        Z     74
     O          E            DEL21            13
S22  O*                      KN(5)               26
N22  O                       KN(5)               44
     O                       VB(5)               54
     O          E            DEL21            14
S22  O*                      KN(6)               26
N22  O                       KN(6)               44
     O                       VB(6)               54
     O          E            DEL21            15
S22  O*                      KN(7)               26
N22  O                       KN(7)               44
     O              N48      VB(7)               54
     O               48 91   VB(7)               54
     O               48N91                       36 'EX Cont:'
     O               48N91   HETRCN              54
     O          E            DEL21            16
     O                       TO(1)               54
     O                       XVNTM         Z     63
     O          E            DEL21            17
     O                       TO(2)               54
     O          E            DEL21            18
     O                       TO(3)               54
     O          E            DEL21            19
     O                       TO(4)               54
     O          E            DEL21            20
     O                       TO(5)               54
     O                       WFESTB        Z     78
     O          E            DEL21X           25
     O                                           32 '**** IKKE BENYTTET ****'
     O          E            DEL21X           39
     O                                           32 '**** IKKE BENYTTET ****'
      *
      *** DEL-2 ANNEN VAREPOST
     O          E            DEL22            22
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O          E            DEL22            23
S22  O*                      KN(1)               26
N22  O                       KN(1)               44
     O              N99      WFEANT        Z     33
     O              N99      WFEVT               38
     O               99      WFEVT               31
     O               99      WFEANT        Z     36
     O                       VB(1)               54
     O          E            DEL22            24
S22  O*                      KN(2)               26
N22  O                       KN(2)               44
     O                       VB(2)               54
     O                       WFEFYL              62
     O                       WFEVKB        Z     74
     O          E            DEL22            25
S22  O*                      KN(3)               26
N22  O                       KN(3)               44
     O                       VB(3)               54
     O          E            DEL22            26
S22  O*                      KN(4)               26
N22  O                       KN(4)               44
     O                       VB(4)               54
     O                       SEDP                58
     O                       WFEVKN        Z     74
     O          E            DEL22            27
S22  O*                      KN(5)               26
N22  O                       KN(5)               44
     O                       VB(5)               54
     O          E            DEL22            28
S22  O*                      KN(6)               26
N22  O                       KN(6)               44
     O                       VB(6)               54
     O          E            DEL22            29
S22  O*                      KN(7)               26
N22  O                       KN(7)               44
     O              N48      VB(7)               54
     O               48 91   VB(7)               54
     O               48N91                       36 'EX Cont:'
     O               48N91   HETRCN              54
     O          E            DEL22            30
     O                       TO(1)               54
     O                       XVNTM         Z     63
     O          E            DEL22            31
     O                       TO(2)               54
     O          E            DEL22            32
     O                       TO(3)               54
     O          E            DEL22            33
     O                       TO(4)               54
     O          E            DEL22            34
     O                       TO(5)               54
     O                       WFESTB        Z     78
     O          E            DEL22X           39
     O                                           32 '**** IKKE BENYTTET ****'
      *
      *** DEL-2 TREDJE VAREPOST
     O          E            DEL23            36
     O                       XN2           Z     51
     O                       XWFVN1              60 '0    .  '
     O                       XWFVN2              66
     O          E            DEL23            37
S22  O*                      KN(1)               26
N22  O                       KN(1)               44
     O              N99      WFEANT        Z     33
     O              N99      WFEVT               38
     O               99      WFEVT               31
     O               99      WFEANT        Z     36
     O                       VB(1)               54
     O          E            DEL23            38
S22  O*                      KN(2)               26
N22  O                       KN(2)               44
     O                       VB(2)               54
     O                       WFEFYL              62
     O                       WFEVKB        Z     74
     O          E            DEL23            39
S22  O*                      KN(3)               26
N22  O                       KN(3)               44
     O                       VB(3)               54
     O          E            DEL23            40
S22  O*                      KN(4)               26
N22  O                       KN(4)               44
     O                       VB(4)               54
     O                       SEDP                58
     O                       WFEVKN        Z     74
     O          E            DEL23            41
S22  O*                      KN(5)               26
N22  O                       KN(5)               44
     O                       VB(5)               54
     O          E            DEL23            42
S22  O*                      KN(6)               26
N22  O                       KN(6)               44
     O                       VB(6)               54
     O          E            DEL23            43
S22  O*                      KN(7)               26
N22  O                       KN(7)               44
     O              N48      VB(7)               54
     O               48 91   VB(7)               54
     O               48N91                       36 'EX Cont:'
     O               48N91   HETRCN              54
     O          E            DEL23            44
     O                       TO(1)               54
     O                       XVNTM         Z     63
     O          E            DEL23            45
     O                       TO(2)               54
     O          E            DEL23            46
     O                       TO(3)               54
     O          E            DEL23            47
     O                       TO(4)               54
     O          E            DEL23            48
     O                       TO(5)               54
     O                       WFESTB        Z     78
      *
      *** DEL-2 SUMMERINGSLINJE
     O          E            DEL2S            50
     O                       TY(1)               11
     O                       GL(1)         Z     21
     O                       ST(1)         2     30
     O                       PR(1)               31
     O                       BL(1)         Z     41
     O                       TY(5)               47
     O                       GL(5)         Z     58
     O                       ST(5)         2     66
     O                       PR(5)               67
     O                       BL(5)         Z     78
     O          E            DEL2S            51
     O                       TY(2)               11
     O                       GL(2)         Z     21
     O                       ST(2)         2     30
     O                       PR(2)               31
     O                       BL(2)         Z     41
     O                       TY(6)               47
     O                       GL(6)         Z     58
     O                       ST(6)         2     66
     O                       PR(6)               67
     O                       BL(6)         Z     78
     O          E            DEL2S            52
     O                       TY(3)               11
     O                       GL(3)         Z     21
     O                       ST(3)         2     30
     O                       PR(3)               31
     O                       BL(3)         Z     41
     O                       TY(7)               47
     O                       GL(7)         Z     58
     O                       ST(7)         2     66
     O                       PR(7)               67
     O                       BL(7)         Z     78
     O          E            DEL2S            53
     O                       TY(4)               11
     O                       GL(4)         Z     21
     O                       ST(4)         2     30
     O                       PR(4)               31
     O                       BL(4)         Z     41
     O                       TY(8)               47
     O                       GL(8)         Z     58
     O                       ST(8)         2     66
     O                       PR(8)               67
     O                       BL(8)         Z     78
     O          E            DEL2S            60
     O                       TY(9)               11
     O                       GL(9)         Z     21
     O                       ST(9)         2     30
     O                       PR(9)               31
     O                       BL(9)         Z     41
     O               33      T1(1)               47
     O               33      T2(1)         Z     57
     O          E            DEL2S            61
     O                       TY(10)              11
     O                       GL(10)        Z     21
     O                       ST(10)        2     30
     O                       PR(10)              31
     O                       BL(10)        Z     41
     O               33      T1(2)               47
     O               33      T2(2)         Z     57
     O          E            DEL2S            62
     O                       TY(11)              11
     O                       GL(11)        Z     21
     O                       ST(11)        2     30
     O                       PR(11)              31
     O                       BL(11)        Z     41
     O               33      T1(3)               47
     O               33      T2(3)         Z     57
     O          E            DEL2S            63
     O                       TY(12)              11
     O                       GL(12)        Z     21
     O                       ST(12)        2     30
     O                       PR(12)              31
     O                       BL(12)        Z     41
     O               33      T1(4)               47
     O               33      T2(4)         Z     57
     O                                           63 '**'
     O          E       33   DEL2S            68
     O                       XTOT          Z     57
     O          E            DEL2S            70
     O                       XPFM2               75
      *** '''''''''''' SLUTT DEL-2 (STANDARD FORMULAR)
      *
      *
      *** ............ START DEL-2 (DATA LISTE)
S19  O*ATALIST  E            DLHEAD           01
S19  O*                      DLFMT1              75
S19  O*ATALIST  E            DLHEAD           02
S03  O*                                          20 'REF:     /     /   '
S03  O*                      SEAVD         Z     10
S03  O*                      SETDN         Z     18
S03  O*                      SESG                22
S03  O*                      FSSO15              60
S19  O*                                          22 'REF:     /       /   '
S19  O*                      SEAVD         Z     10
S19  O*                      SETDN         Z     18
S19  O*                      SESG                26
s11  O*                      FSSO15              47
S19  O*                      FSSO25              55
S19  O*              39   N37                    75 'LINJEDEKLARERT'
S10  O*             N39 34N37                    77 'LINJEDEKLARERT KOPI'
S19  O*             N39 34N37                    77 'L.DEKLARERT KOPI'
S19  O*              39    37                    75 'UTLEV.-ATTEST '
S10  O*             N39 34 37                    77 'UTLEV.-ATTEST  KOPI'
S19  O*             N39 34 37                    78 'UTLEV-ATTEST KOPI'
S19  O*         E            DLHEAD           03
S19  O*                                           4 'NR.'
S19  O*                                          12 'VARENR.'
S19  O*                                          16 'PR'
S19  O*                                          27 'STAT.VERDI'
S19  O*                                          37 'VKT/MENGD'
S19  O*                                          40 'FK'
S19  O*                                          43 'TY'
S19  O*                                          55 'GRUNNLAG'
S19  O*                                          63 'SATS'
S19  O*                                          76 'BELØP'
S19  O*                                          79 'BM'
S19  O*         E            DLHEAD           04
S19  O*                                          24 '------------------------'
S19  O*                                          48 '------------------------'
S19  O*                                          72 '------------------------'
S19  O*                                          80 '--------'
S19  O*         E            DLBLIN      1
S19  O*         E            DLIST1      1
S19  O*                      XN2           Z      4
S19  O*                      WFEVNT              13
S19  O*                      SEDP                16
S19  O*                      WFESTB        Z     27
S19  O*                      WFEVKN        Z     37
S19  O*                      WFEFYL              40
S19  O*                      TY(1)               43
S19  O*                      GL(1)         Z     55
S19  O*                      ST(1)         2     64
S19  O*                      PR(1)               65
S19  O*                      BL(1)         Z     76
S19  O*         E            DLIST1      1
S19  O*                      TO(1)               50
S19  O*                                          36 '               '
S19  O*                                          50 '               '
S19  O*                      XVNTM         Z     37
S19  O*                      TY(2)               43
S19  O*                      GL(2)         Z     55
S19  O*                      ST(2)         2     64
S19  O*                      PR(2)               65
S19  O*                      BL(2)         Z     76
S19  O*         E            DLIST2      1
S19  O*                      TO(2)               50
S19  O*                                          36 '               '
S19  O*                                          50 '               '
S19  O*                      TY(3)               43
S19  O*                      GL(3)         Z     55
S19  O*                      ST(3)         2     64
S19  O*                      PR(3)               65
S19  O*                      BL(3)         Z     76
S19  O*         E            DLIST3      1
S19  O*                      TO(3)               50
S19  O*                                          36 '               '
S19  O*                                          50 '               '
S19  O*                      TY(4)               43
S19  O*                      GL(4)         Z     55
S19  O*                      ST(4)         2     64
S19  O*                      PR(4)               65
S19  O*                      BL(4)         Z     76
S19  O*         E            DLIST4      1
S19  O*                      TO(4)               50
S19  O*                                          36 '               '
S19  O*                                          50 '               '
S19  O*         E            DLIST5      1
S19  O*                      TO(5)               50
S19  O*                                          36 '               '
S19  O*                                          50 '               '
S19  O*         E            DLIMV2      1
S19  O*                                          20 'Understells nr:'
S19  O*                      WFEKN1              39
S19  O*** '''''''''''' SLUTT DEL-2 (DATA LISTE)
S19  O*
S19  O*** ............ START Å SKRIVE UT RUBR. 28
S19  O*         E            RU28H            01
S19  O*                      DLFMT1              75
S19  O*         E            RU28H            02
S19  O*                                           8 'Rubr.28'
S19  O*                                          19 'Avdeling:'
S19  O*                      SEAVD         Z     24
S19  O*                                          35 'T.dek.nr.'
S19  O*                      SETDN         Z     43
S19  O*                                          53 'Tariffør'
S19  O*                      SETARF              70
S19  O*              39   N37                    80 'LINJEDEKL'
S19  O*             N39 34N37                    80 'L.D. KOPI'
S19  O*              39    37                    80 'UTL.ATT. '
S19  O*             N39 34 37                    80 'UTL.ATT.K'
S19  O*         E            RU28H            03
S19  O*                                          24 '------------------------'
S19  O*                                          48 '------------------------'
S19  O*                                          72 '------------------------'
S19  O*                                          80 '--------'
S11  O*                      FSSO15              60
S19  O*                      FSSO25              55
S19  O*         E            RU28H            04
S19  O*                                          30 'Finansielle opplysninger'
S19  O*                                          55 'og bankdata             '
S19  O*                                          65 'Dato'
S19  O*              90                          74 'Side'
S19  O*              90      XR28SD        Z     78
S19  O*         E            RU28H            05
S19  O*                                          24 '------------------------'
S19  O*                                          48 '------------------------'
S19  O*                                          72 '------------------------'
S19  O*                                          80 '--------'
S19  O*         E            RU28H2           06
S19  O*                      SEFIF               23
S19  O*                                          68 '    .  .  '
S19  O*                      SEFIDÅ              62
S19  O*                      SEFIDM              65
S19  O*                      SEFIDD              68
S19  O*         E            RU28D       1
S19  O*                      SFTXT               23
S19  O*                      SFBL28              40 '          ,  '
S19  O*                      SFVK28              45
S19  O*                      SFKR28              54 '   ,   '
S19  O*                                          68 '    .  .  '
S19  O*                      SFÅR                62
S19  O*                      SFMND               65
S19  O*                      SFDAG               68
      *** '''''''''''' SLUTT Å SKRIVE UT RUBR. 28
      *
     OSAEVR     E            SAEVLN
     O                       SVLN
     OSAEHR     E            UPDSAE
     O                       SEST
     O                       SELV2
     O                       SEWS
N14  OSAEV4R    E            SAEVL4
N14  O                       SVLN
N14  O          EDEL         SAEVD4
