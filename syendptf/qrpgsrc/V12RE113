     H DFTACTGRP(*NO)
     FSAEV      UF   E           K DISK
     FSAEVCN    O  A E             DISK

     d WhereC          s            512a
     d SqlStm          s            512a
     d myrows0         s             10i 0
     d myrows          s             10i 0
     d XAPS            C                   const(X'7D')
     d X               S             10  0
      *  Prototype for V12RE113
     d v12re113        pr
      *
     d MyPoDS          ds                  Qualified  dim(10000)
     d  SVAVD                         4S 0
     d  SVTDN                         7S 0
     d  SVLI                          5S 0
     d  SVEH01                        4A
     d  SVFT01                       28A
     d  SVEH02                        4A
     d  SVFT02                       28A
     d  SVEH03                        4A
     d  SVFT03                       28A
     d  SVEH04                        4A
     d  SVFT04                       28A
     d  SVEH05                        4A
     d  SVFT05                       28A
     d  SVEH06                        4A
     d  SVFT06                       28A
     d  SVEH07                        4A
     d  SVFT07                       28A
      /free

       exsr init;

       SqlStm = 'Select SVAVD, SVTDN, SVLI, SVEH01, SVFT01, ' +
                'SVEH02, SVFT02, SVEH03, SVFT03, SVEH04, SVFT04, ' +
                'SVEH05, SVFT05, SVEH06, SVFT06, SVEH07, SVFT07 ' +
                'from SAEV ' +
                'Where SVEH01 = ' + xaps + 'CONT' + xaps +
                ' or SVEH02 = ' + xaps + 'CONT' + xaps +
                ' or SVEH03 = ' + xaps + 'CONT' + xaps +
                ' or SVEH04 = ' + xaps + 'CONT' + xaps +
                ' or SVEH05 = ' + xaps + 'CONT' + xaps +
                ' or SVEH06 = ' + xaps + 'CONT' + xaps +
                ' or SVEH07 = ' + xaps + 'CONT' + xaps;
       Exec SQL PREPARE DynSel from :SqlStm;
       EXEC SQL DECLARE  A33  cursor for DynSel;
       Exec SQL OPEN A33;
       Myrows = %elem(MyPoDS);
       exec sql FETCH A33   for :MyRows rows
                  INTO :MyPoDs;
       Exec SQL CLOSE A33;

       if myrows > 0;
         for x = 1 to myrows;
           if mypods(x).sveh01 = *blanks and mypods(x).sveh02 = *blanks
              and mypods(x).sveh03 = *blanks and mypods(x).sveh04 = *blanks
              and mypods(x).sveh05 = *blanks and mypods(x).sveh06 = *blanks
              and mypods(x).sveh07 = *blanks;
             leave;
           endif;

           svavd  = mypods(x).svavd;
           svtdn  = mypods(x).svtdn;
           svli   = mypods(x).svli;
           sveh01 = mypods(x).sveh01;
           svft01 = mypods(x).svft01;
           sveh02 = mypods(x).sveh02;
           svft02 = mypods(x).svft02;
           sveh03 = mypods(x).sveh03;
           svft03 = mypods(x).svft03;
           sveh04 = mypods(x).sveh04;
           svft04 = mypods(x).svft04;
           sveh05 = mypods(x).sveh05;
           svft05 = mypods(x).svft05;
           sveh06 = mypods(x).sveh06;
           svft06 = mypods(x).svft06;
           sveh07 = mypods(x).sveh07;
           svft07 = mypods(x).svft07;

           if sveh01 = 'CONT';
             eval svcnr = svft01;
             write saevcnr;
           endif;
           if sveh02 = 'CONT';
             eval svcnr = svft02;
             write saevcnr;
           endif;
           if sveh03 = 'CONT';
             eval svcnr = svft03;
             write saevcnr;
           endif;
           if sveh04 = 'CONT';
             eval svcnr = svft04;
             write saevcnr;
           endif;
           if sveh05 = 'CONT';
             eval svcnr = svft05;
             write saevcnr;
           endif;
           if sveh06 = 'CONT';
             eval svcnr = svft06;
             write saevcnr;
           endif;
           if sveh07 = 'CONT';
             eval svcnr = svft07;
             write saevcnr;
           endif;

           chain (svavd: svtdn: svli) saev;
           if %found;
             if sveh01 = 'CONT';
               eval sveh01 = *blanks;
               eval svft01 = *blanks;
             endif;
             if sveh02 = 'CONT';
               eval sveh02 = *blanks;
               eval svft02 = *blanks;
             endif;
             if sveh03 = 'CONT';
               eval sveh03 = *blanks;
               eval svft03 = *blanks;
             endif;
             if sveh04 = 'CONT';
               eval sveh04 = *blanks;
               eval svft04 = *blanks;
             endif;
             if sveh05 = 'CONT';
               eval sveh05 = *blanks;
               eval svft05 = *blanks;
             endif;
             if sveh06 = 'CONT';
               eval sveh06 = *blanks;
               eval svft06 = *blanks;
             endif;
             if sveh07 = 'CONT';
               eval sveh07 = *blanks;
               eval svft07 = *blanks;
             endif;
             update saevr;
           endif;

         endfor;
       endif;

       *inlr = *on;
       return;

      //***********************************************
       begsr init;
      //***********************************************

       endsr;

      /end-free
