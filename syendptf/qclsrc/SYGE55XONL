/* *********************************************************************   */
/*       * RETTINGER I DETTE PROGRAM:                                      */
/* PTFnr:*Sek Sig Vers  Beskrivelse..........................              */
/* """"""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""    */
/* 12324 * 01 ORG PTF12 Fil til excel endret fra .xls til .xlsx            */
/* ********************************************************************    */
/* VED KOMPILERING ADDLIBLE HSSFCGI */
/* +               ADDLIBLE MMAIL   */
/* SENDE FIL TIL SEG SELV      */
/* I EXCEL FORMAT              */
/* CPYCMD ENDRET               */
/* IKKE BRUK QDLS              */
             PGM        PARM(&FILE &MBR)
             DCL        VAR(&FILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TMPF10) TYPE(*CHAR) LEN(10)
             DCL        VAR(&STMF) TYPE(*CHAR) LEN(30)
             DCL        VAR(&HTTP0) TYPE(*CHAR) LEN(7) VALUE('http://')
             DCL        VAR(&HTTP) TYPE(*CHAR) LEN(70)
/*______________*/
/* LES FIRMAFIL ARKIV */
/*""""""""""""""*/
             DCLF       FILE(FIRMARC) RCDFMT(*ALL)
             RCVF       DEV(*FILE) RCDFMT(*FILE)
             CHGJOB     CCSID(277)
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                                */
/* BESTEMMER STREAMFILE                          */
/*                                                */
             IF         COND(&MBR = '          ') THEN(CHGVAR +
                          VAR(&MBR) VALUE(&FILE))
/*           CHGVAR     VAR(&STMF) VALUE('/pdf/tmp/' *CAT &FILE +
                          *TCAT '.xls') */  /* S01 */
             CHGVAR     VAR(&STMF) VALUE('/pdf/tmp/' *CAT &FILE +
                          *TCAT '.xlsx') /* N01 */
             DEL        OBJLNK(&STMF)
             MONMSG     MSGID(CPF0000)
/*                                                */
/* LEGGER TIL XLS VERKTØY                        */
/*                                                */
             ADDLIBLE   LIB(HSSFCGI)
             MONMSG     MSGID(CPF0000)
             TABLEXLS   FROMFILE(&FILE) FROMMBR(&MBR) TOXLS(&STMF)
             MONMSG     MSGID(CPF0000)
/*                                                */
/* HENTER EGEN MAIL ADRESSE                      */
/*                                                */
             CHGAUT     OBJ(&STMF) USER(*PUBLIC) DTAAUT(*RWX) +
                          OBJAUT(*ALL)
             CHGVAR     VAR(&HTTP) VALUE(&HTTP0 *TCAT &ARCPAD *TCAT +
                        &STMF)
             CALL       PGM(SYGE33CL) PARM(&HTTP)
             RMVLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
             RMVLIBLE   LIB(HSSFCGI)
             MONMSG     MSGID(CPF0000)
 SLUTT:      ENDPGM
