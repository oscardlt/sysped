      *
     ‚***********************************************************
     ‚*** PROGRAM SKAL OVERFØRE SAD-LINJER TIL TET            ***
     ‚*** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
     ‚*** LEDIGE INDIKATORER 01-26                            ***
     ‚*** LEDIGE INDIKATORER 27-32 34-99                      ***
     ‚***********************************************************
     H DFTACTGRP(*NO)
     fsveh      if   e           k disk
     fsvev4     if   e           k disk
     fsvxv      o  a e             disk
     fsvxvam    o  a e             disk
     fcundl01   if   e           k disk
     d                 ds
     d syrg                          14
     d  syfore                       11    overlay(syrg)
     d   syfor9                       9    overlay(syfore)
     d                 ds
     d xli                     1      5  0
     d xli_a                   1      5
     d                 ds
     d svev_vata               1      8
     d svev_vata_n             1      8  0
     ‚*  Prototype for svx012rb
     d svx012rb        pr
     d ufirm_                              like(ufirm)
     d uavd_                               like(uavd)
     d utdn_                               like(utdn)
     d uli_                                like(uli)
     d uavd2_                              like(uavd2)
     d utdn2_                              like(utdn2)
     ‚*  *ENTRY Interface for Main Procedure
     d svx012rb        pi
     d ufirm                          2
     d uavd                           4
     d utdn                           7
     d uli                            5
     d uavd2                          4
     d utdn2                          7
     ‚*----------------------------------------------------------------------
     ‚* Stand Alone Fields - TOP
     ‚*----------------------------------------------------------------------
     d xln             s              5  0
     ‚*----------------------------------------------------------------------
     ‚* Stand Alone Fields - BOTTOM
     ‚*----------------------------------------------------------------------

      /free
       exsr init;

       xln = *zeros;
       setll ( svev_syav : svev_syop ) svev4;
       reade ( svev_syav : svev_syop ) svev4;
       dow not %eof;
         select;
         when xln = 0;
           exsr srhent;                                                         // HENT DATA FRA SAE
         when svev_vano = xln;
           exsr srsum;                                                          // SUMMERE VEKT
         other;
           write svxvr;
           exsr srhent;                                                         // HENT DATA FRA SAE
         endsl;
         reade ( svev_syav : svev_syop ) svev4;
       enddo;

       if tvli <> 0;
         write svxvr;
       endif;

       uli = xli_a;

       *inlr = *on;

       //**********************************************
       begsr srhent;
         //**********************************************
         xln = svev_vano;
         xli = xli +1;
         tvli = xli;
         tvvnt  = svev_vata_n;
         tvvktb = svev_brut;
         tvvktn = svev_neto;
         tvnteh = svev_ankv;
        // tvmn = svft01;
        // tvnt = svnt01;
        // tveh = sveh01;
        // %subst(tvvt:1:30) = svvt01;
         tvdty = '830';
        // tvdref = %trim(setle) + ' ' + %trim(setll);
         exsr hadr12;

       endsr;

       //**********************************************
       begsr srsum;
         //**********************************************
           tvvktb = tvvktb + svev_brut;
           tvvktn = tvvktn + svev_neto;
           tvnteh = tvnteh + svev_ankv;
       endsr;

       //**********************************************
       begsr hadr12;
         //**********************************************
         tvkns = sveh_avkn;
         tvnas = sveh_avna;
         tvads1 = sveh_ava1;
         tvpns = sveh_avpn;
         tvpss = sveh_avpa;
         tvsks = 'SV';
         tvlks = sveh_avlk;
         if sveh_avkn = 0;                                                      // 1<-B
           tvtins = *blanks;
         else;                                                                  // 1
           kundnr = sveh_avkn;
           chain ( ufirm : kundnr ) cundl01;
           *in34 = not %found;
           tvtins = *blanks;
          if %found;
           select;                                                              // 2<-B
           when eori = *blanks;                                                 // 2
             if ((syfor9 <> *blanks) and (syfor9 <> *zeros));                   //   3<-B
               tvtins = tvlks + syfor9;
             else;                                                              //  3
               tvtins = *blanks;
             endif;                                                             //   3<-E
           other;                                                               // 2
             tvtins = eori;
           endsl;                                                               //  2<-E
          endif;
         endif;                                                                 // 1<-E

         tvknk = sveh_mokn;
         tvnak = sveh_mona;
         tvadk1 = sveh_moa1;
         tvpnk = sveh_mopn;
         tvpsk = sveh_mopa;
         tvskk = 'SV';
         tvlkk = sveh_molk;
         if sveh_mokn = 0;                                                      // 1<-B
           tvtink = *blanks;
         else;                                                                  // 1
           kundnr = sveh_mokn;
           chain ( ufirm : kundnr ) cundl01;
           *in34 = not %found;
           tvtink = *blanks;
          if %found;
           select;                                                              // 2<-B
           when eori = *blanks;                                                 // 2
             if ((syfor9 <> *blanks) and (syfor9 <> *zeros));                   //   3<-B
               tvtink = tvlkk + syfor9;
             else;                                                              //  3
               tvtink = *blanks;
             endif;                                                             //   3<-E
           other;                                                               // 2
             tvtink = eori;
           endsl;                                                               //  2<-E
          endif;
         endif;                                                                 // 1<-E

         if tvads1 = *blanks;                                                   // 1<-B
           %subst(tvads1:1:1) = '.';
         endif;                                                                 // 1<-E
         if tvadk1 = *blanks;                                                   // 1<-B
           %subst(tvadk1:1:1) = '.';
         endif;                                                                 // 1<-E

         write svxvamr;

       endsr;

       //**********************************************
       begsr init;
         //**********************************************

         svev_syav = %dec(uavd2:4:0);
         svev_syop = %dec(utdn2:7:0);
         tvavd = %dec(uavd:4:0);
         tvtdn = %dec(utdn:7:0);
         xli   = %dec(uli:5:0);
         tvavd2 = %dec(uavd2:4:0);
         tvtdn2 = %dec(utdn2:7:0);

         chain ( svev_syav : svev_syop ) sveh;

       endsr;
      /end-free
