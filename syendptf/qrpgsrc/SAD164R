      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE E.F. MANIFEST (OPPDRAG)     ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-02 06-08 10 11 13-26
      *** LEDIGE INDIKATORER 27-29 31 32 34-48 50-81          ***
      ***********************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 JOV Søk kunde
12XXX * 02 YBC Oppdater navn og adresse kun ved navn er blank
12XXX * 03 YBC Utgående prosedyre = FALSE --> Ingen eksp.EU og eksp.id
12XXX * 04 YBC Oppdragsnr ved oppdatering av item fra SADV
********************************************************************
      *
     FSADH      IF   E           K DISK
     FSADV4     IF   E           K DISK
     FSADEXHL1  UF   E           K DISK
     FSADEXHL2  UF A E           K DISK    RENAME(SADEXHFR:SADEXHFR2)
     FSADEXML2  IF   E           K DISK
     FSADEXIL1  IF A E           K DISK
     FSVEH      IF   E           K DISK
     FSVZH      IF   E           K DISK
     FTRACKF    O  A E             DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FSTED2D    IF   E           K DISK
     FTRKODL01  IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FTELLGE    UF A E           K DISK
     FEDIM2     IF   E           K DISK
     FSAD164D   CF   E             WORKSTN INFDS(FBAREA)
     D                SDS
     D  UUSR                 254    263
     D FBAREA          DS
     D  WSCLOC               382    383B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  WSETYPT                1     30
     D  WSETYPT15              1     15
     D                 DS
     D  WSPRT                  1     30
     D  WSPRT20                1     20
     D                 DS
     D  WS0068A                1      8  0
     D  WS0068AC               1      2  0
     D  WS0068AA               3      4  0
     D  WS0068AM               5      6  0
     D  WS0068AD               7      8  0
      *
     C                   EXSR      INIT
      *...............................................
      * BILDE-1 INNLESING AV HOVED OPPLYSNINGER AV TUR
      *'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C                   IF        *IN30 = *OFF AND *IN04 = *OFF
     C                   EVAL      LINNBR = 5
     C                   EVAL      POSNBR = 15
     C                   END
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG' OR
     C                             UTYPE = 'CRT' OR UTYPE = 'PLK'
      * EGET HOUSE
     C                   EXFMT     BILDE01
     C                   ELSE
      * ANDRE HOUSE
n01  C                   if        WSDKHT = *blanks                             Dok-ref-type
n01  C                   eval      WSDKHT = 'N714'                              UNDERKONNOSSEMENT
n01  C                   endif
     C                   EXFMT     BILDE02
     C                   END
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '000000000000'*IN(76)
     C                   MOVEA     '000000000000'*IN(64)
     C                   MOVEA     '000000'      *IN(58)
     C                   EVAL      *IN30 = *OFF
      *
      *  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG' OR
     C                             UTYPE = 'CRT' OR UTYPE = 'PLK'
      * EGET HOUSE
     C                   EXSR      SOKDTA
     C                   ELSE
      * ANDRE HOUSE
     C                   EXSR      SOKDTA2
     C                   END
     C                   GOTO      START
     C                   END
      *
      *  05 = Avikkende deklarant/representativ
     C   05              DO
     C                   EXSR      SRCHGDR
     C                   GOTO      START
     C                   END
      *  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ UT
     C   12              GOTO      SLUTT
      *
      * ----------- T E S T   B I L D E 0 1 ----------
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG' OR
     C                             UTYPE = 'CRT' OR UTYPE = 'PLK'
      * EGET HOUSE
     C                   IF        *IN10 = *OFF
     C                   EXSR      TESTB1
     C                   END
     C                   ELSE
      * ANDRE HOUSE
     C                   EXSR      TESTB2
     C                   END
     C   30              GOTO      START
      *
     C                   EXSR      OPDOPD
      *
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG' OR
     C                             UTYPE = 'CRT' OR UTYPE = 'PLK'
     C                   CALL      'SAD165R'
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    UPRO              8 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
     C                   END
      *
     C     SLUTT         TAG
     C                   SELECT
     C                   WHEN      *IN12
     C                   EVAL      UFLAGG = 1
     C                   OTHER
     C                   EVAL      UFLAGG = 0
     C                   ENDSL
      *
      * Test goodsitem og sett status
     C                   IF        EHST = ' '
     C     SADEXHL1K     CHAIN     SADEXHL1                           33
     C                   IF        *IN33 = *OFF
     C     SADEXHL1K     CHAIN     SADEXIL1                           33
      * *IN33 på --> Ingen item --> Feil HouseConsignment
     C   33              EVAL      EHST = 'F'
     C  N33              IF        EHVKB = 0 OR EHAVD = 0
     C                   EVAL      EHVKB = 0
     C                   DOW       *IN33 = *OFF
     C                   EVAL      EHVKB = EHVKB + EICVKB
     C     SADEXHL1K     READE     SADEXIL1                               33
     C                   ENDDO
     C                   END
     C                   UPDATE    SADEXHFR
     C                   END
     C                   END
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      ***********************************************
     C     SOKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK
      *
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     16
     C                   EVAL      KFTYP  = 'SADEFPR'
     C                   EVAL      UUPDAT = 'N'
     C                   EVAL      KFKOD  = WSPR
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT            1
     C                   PARM                    KFKOD
     C                   EVAL      WSPR = KFKOD
     C     KOFASTK       CHAIN     KOFAST                             94
     C  N94              EVAL      WSPRT = KFTXT
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     53
     C                   EVAL      KFTYP  = 'SADEFPRUT'
     C                   EVAL      UUPDAT = 'N'
     C                   EVAL      KFKOD  = WSUPR
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT            1
     C                   PARM                    KFKOD
     C                   EVAL      WSUPR = KFKOD
     C     KOFASTK       CHAIN     KOFAST                             33
     C  N33              EVAL      WSUPRT = KFTXT
     C                   Z-ADD     65            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     65
     C     POSNBR        ANDLE     66
     C                   EVAL      KFTYP  = 'SADEFETYPE'
     C                   EVAL      UUPDAT = 'N'
     C                   EVAL      KFKOD  = WSETYP
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT            1
     C                   PARM                    KFKOD
     C                   EVAL      WSETYP = KFKOD
     C     KOFASTK       CHAIN     KOFAST                             94
     C  N94              EVAL      WSETYPT = KFTXT
     C                   Z-ADD     93            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     100
     C     POSNBR        ANDLE     103
     C*                  EVAL      KFTYP  = 'SADEFDTYPE'
     C*                  EVAL      UUPDAT = 'N'
     C*                  EVAL      KFKOD  = WSTRTY
     C*                  CALL      'SYFAKDA'
     C*                  PARM                    KFTYP
     C*                  PARM                    UUPDAT            1
     C*                  PARM                    KFKOD
     C*                  EVAL      WSTRTY = KFKOD
     C                   EVAL      TKUNIK = '228'
     C                   EVAL      TKKODE = WSTRTY
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSTRTY = TKKODE
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     22
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDF
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   EVAL      KLKLK = ULK
     C                   EVAL      ST2KOD = WSSDF
     C     STED2DK       CHAIN     STED2D                             33
     C  N33              EVAL      WSSDFT = ST2NVN
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     65            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     68
     C     POSNBR        ANDLE     72
     C                   MOVE      *BLANKS       UNVN
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSDT
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   EVAL      KLKLK = ULK
     C                   EVAL      ST2KOD = WSSDT
     C     STED2DK       CHAIN     STED2D                             33
     C  N33              EVAL      WSSDTT = ST2NVN
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     51
     C                   EVAL      TKUNIK = '756'
     C                   EVAL      TKKODE = WSROE
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSRGRO = TKKODE
     C                   Z-ADD     69            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     103
     C     POSNBR        ANDLE     104
     C                   EVAL      TKUNIK = '704'
     C                   EVAL      TKKODE = WSROE
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSROE = TKKODE
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNS
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAS
     C                   IF        WSKNS <> 0
     C                   EXSR      TESTS
     C                   END
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     101
     C     POSNBR        ANDLE     102
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKS
     C                   PARM                    USPED
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNM
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAM
     C                   IF        WSKNM <> 0
     C                   EXSR      TESTM
     C                   END
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     101
     C     POSNBR        ANDLE     102
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKM
     C                   PARM                    USPED
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     75
     C                   EVAL      TKUNIK = '754'
     C                   EVAL      TKKODE = WSDKHT
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSDKHT = TKKODE
     C                   Z-ADD     87            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDGE     94
     C     POSNBR        ANDLE     96
     C                   MOVE      WDT           USIDT             8 0
     C                   CALL      'SAD061F'
     C                   PARM                    WSTCVA
     C                   PARM                    USIDT
     C                   Z-ADD     105           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     16
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR1
     C                   PARM                    USPED
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     19
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR2
     C                   PARM                    USPED
     C                   Z-ADD     21            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     21
     C     POSNBR        ANDLE     22
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR3
     C                   PARM                    USPED
     C                   Z-ADD     24            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     24
     C     POSNBR        ANDLE     25
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR4
     C                   PARM                    USPED
     C                   Z-ADD     27            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     27
     C     POSNBR        ANDLE     28
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR5
     C                   PARM                    USPED
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     31
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR6
     C                   PARM                    USPED
     C                   Z-ADD     33            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     34
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR7
     C                   PARM                    USPED
     C                   Z-ADD     36            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     36
     C     POSNBR        ANDLE     37
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR8
     C                   PARM                    USPED
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     92
     C     POSNBR        ANDLE     93
     C                   EVAL      TKUNIK = '750'
     C                   EVAL      TKKODE = WSPTYP
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSPTYP = TKKODE
     C                   Z-ADD     104           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     104
     C     POSNBR        ANDLE     107
     C                   EVAL      TKUNIK = '751'
     C                   EVAL      TKKODE = WSPTM
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSPTM = TKKODE
     C                   Z-ADD     113           POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     113
     C     POSNBR        ANDLE     114
     C                   CALL      'SYFI10L'
     C                   PARM                    WSPLK
     C                   PARM                    USPED
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
      ***********************************************
     C     SOKDTA2       BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * SØK
      *
      *
N01  C     LINNBR        IFEQ      6
N01  C     POSNBR        ANDGE     15
N01  C     POSNBR        ANDLE     22
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNM
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAM
N01  C                   IF        WSKNM <> 0
N01  C                   EXSR      TESTM
N01  C                   END
N01  C                   GOTO      SLSØK2
N01  C                   END
      *
S01  C*    LINNBR        IFEQ      6
S01  C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     72
     C     POSNBR        ANDLE     75
     C                   EVAL      TKUNIK = '754'
     C                   EVAL      TKKODE = WSDKHT
     C                   CALL      'TR002R'
     C                   PARM                    TKUNIK
     C                   PARM                    TKKODE
     C                   PARM                    UTYPE2            3
     C                   EVAL      WSDKHT = TKKODE
     C                   Z-ADD     72            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        ENDSR
      *
      ***********************************************
     C     SOKDTA3       BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKND
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAD
     C                   IF        WSKND <> 0
     C                   EXSR      TESTD
     C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK3
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     101
     C     POSNBR        ANDLE     102
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKD
     C                   PARM                    USPED
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK3
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     15
     C     POSNBR        ANDLE     22
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNR
     C                   PARM                    FIFIRM
     C                   PARM                    WSNAR
     C                   IF        WSKNR <> 0
     C                   EXSR      TESTR
     C                   END
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK3
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     101
     C     POSNBR        ANDLE     102
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKR
     C                   PARM                    USPED
     C                   Z-ADD     108           POSNBR
     C                   GOTO      SLSØK3
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK3        ENDSR
      *
      ***********************************************
     C     TESTB1        BEGSR
      ***********************************************
     C                   IF        UTYPE <> 'DSP' AND WSRG = *BLANKS
     C                             AND (SIST = 'T' OR SIST = 'U' OR SIST = 'P')
     C     SADHK         SETGT     EDIM2
     C     SADHK         READPE    EDIM2                                  33
     C                   IF        *IN33 = *OFF
     C                   EVAL      WSPR    = '01'
     C                   EVAL      WSPRT   = 'IMMEDIATE_RELEASE_IMPORT'
     C                   EVAL      WSUPR   = 'EXP'
     C                   EVAL      WSRG    = %SUBST(M0068:1:9)
     C                   EVAL      WS0068A = M0068A
     C                   EVAL      WS0068B = M0068B
     C                   END
     C                   END
      *
      * Container indikator
     C*    WSCNIN        COMP      0                                      99
      * Containernr
     C                   IF        WSCNIN > 0
     C     WSCNR         COMP      *BLANKS                                98
     C                   END
      * Varebeskrivelse
     C     WSVT          COMP      *BLANKS                                97
      *
      * importProcedure
     C*                  IF        WSPR <> *BLANKS
     C                   EVAL      KFTYP  = 'SADEFPR'
     C                   EVAL      KFKOD  = WSPR
     C     KOFASTK       CHAIN     KOFAST                             96
     C  N96              EVAL      WSPRT = KFTXT
     C*                  END
      * outgoingProcedure
     C**                 IF        WSUPR <> *BLANKS
     C                   EVAL      KFTYP  = 'SADEFPRUT'
     C                   EVAL      KFKOD  = WSUPR
     C     KOFASTK       CHAIN     KOFAST                             95
     C  N95              EVAL      WSUPRT = KFTXT
     C**                 END
      *
Njov c                   IF        WSPRT = 'TRANSIT_RELEASE' and
Njov c                             WSUPR <>'EXP'
Njov c                   eval      *in95 = *on
Njov c                   ENDIF
      * exportFromEU
N03  C                   IF        WSUPR = 'FALSE'
N03  C                   EVAL      WSETYP = *BLANKS
N03  C                   EVAL      WSETYPT = *BLANKS
N03  C                   EVAL      WSEID  = *BLANKS
N03  C                   ELSE
Njov C                   EVAL      WSETYPT = *blanks
Njov C                   IF        WSETYP <> *BLANKS
Njov C                             OR WSUPR <> 'TRA'                            ikke krav v/transit
     C                   EVAL      KFTYP  = 'SADEFETYPE'
     C                   EVAL      KFKOD  = WSETYP
     C     KOFASTK       CHAIN     KOFAST                             94
     C  N94              EVAL      WSETYPT = KFTXT
      *
     C     WSEID         COMP      *BLANKS                                93
Njov C                   END
N03  C                   END
      * Norsk import
     C                   IF        WSRG <> *BLANKS OR WS0068A <> 0
      * Org.nr
     C     WSRG          COMP      *BLANKS                                92
      * Dato
     C     WS0068A       COMP      0                                      59
     C                   IF        *IN59 = *OFF
     C                   MOVEL     WS0068A       XAN02             2
     C     XAN02         COMP      '20'                               5959
     C                   IF        *IN92 = *OFF
     C                   MOVE      WS0068AD      XDAG              2 0
     C                   MOVE      WS0068AM      XMND              2 0
     C                   MOVE      WS0068AA      XAAR              2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    XDAG
     C                   PARM                    XMND
     C                   PARM                    XAAR
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      59
     C                   END
     C                   END
      * Sekvens
     C     WS0068B       COMP      0                                      58
     C                   ELSE
      * NCTS
     C     WSTRNR        COMP      *BLANKS                                91
     C                   END
      *
     C*    WSTRTY        COMP      *BLANKS                                90
     C*                  EVAL      KFTYP  = 'SADEFDTYPE'
     C*                  EVAL      KFKOD  = WSTRTY
     C*    KOFASTK       CHAIN     KOFAST                             90
     C* N90              EVAL      WSUPRT = KFTXT
njov c                   if        WSTRNR <> *blanks or WSTRTY <> *blanks
     C                   EVAL      TKUNIK = '228'
     C                   EVAL      TKKODE = WSTRTY
     C     TRKODL01K     CHAIN     TRKODL01                           90
     C  N90              EVAL      WSUPRT = TKTXTN
njov c                   if        WSTRTY = *blanks
njov c                   eval      WSTRTY = 'N820'
njov C                   endif
njov C                   endif
      * FRA STED
     C                   EVAL      KLKLK = WSLKF
     C     KODTLKK       CHAIN     KODTLK                             89
      *
     C                   EVAL      ST2KOD = WSSDF
     C     STED2DK       CHAIN     STED2D                             88
     C  N88              EVAL      WSSDFT = ST2NVN
      * TIL STED
     C                   EVAL      KLKLK = WSLKT
     C     KODTLKK       CHAIN     KODTLK                             87
      *
     C                   EVAL      ST2KOD = WSSDT
     C     STED2DK       CHAIN     STED2D                             86
     C  N86              EVAL      WSSDTT = ST2NVN
      * additionalFiscalReference
     C*    WSRGA         COMP      *BLANKS                                85
      *
     C                   IF        WSRGA <> *BLANKS OR WSRGRO <> *BLANKS
      * Aktørens rolle
     C                   EVAL      TKUNIK = '756'
     C                   EVAL      TKKODE = WSRGRO
     C     TRKODL01K     CHAIN     TRKODL01                           84
     C                   END
      * additionalSupplyChainActor
     C                   IF        WSRGE <> *BLANKS
     C*    WSROE         COMP      *BLANKS                                83
     C                   EVAL      TKUNIK = '704'
     C                   EVAL      TKKODE = WSRGE
     C     TRKODL01K     CHAIN     TRKODL01                           83
     C                   END
      * Avsender
     C                   IF        WSKNS <> 0
     C                   EXSR      TESTS
     C                   END
      *
     C                   IF        WSRGS = *BLANKS
     C     SADHK         CHAIN     SVEH                               33
     C                   IF        *IN33 = *OFF AND SVEH_AVEO <> *BLANKS
     C                   EVAL      WSRGS = SVEH_AVEO
     C                   ELSE
     C                   EVAL      *IN81 = *ON
     C                   END
     C                   END
      *
     C                   IF        WSNAS = *BLANKS
     C                   EVAL      *IN80 = *ON
     C                   END
      *
     C                   IF        WSAD1S = *BLANKS
     C                   EVAL      *IN79 = *ON
     C                   END
      *
     C                   IF        WSPNS = *BLANKS
     C                   EVAL      *IN78 = *ON
     C                   END
      *
     C                   IF        WSPSS = *BLANKS
     C                   EVAL      *IN77 = *ON
     C                   END
      *
     C                   EVAL      KLKLK = WSLKS
     C     KODTLKK       CHAIN     KODTLK                             76
      *
     C                   IF        WSEMS = *BLANKS
     C                   EVAL      *IN75 = *ON
     C                   END
      *
     C     '@'           SCAN      WSEMS         XPOS              3 0    33
     C                   SELECT
     C                   WHEN      WSEMS = *BLANKS
     C                   EVAL      WSEMST = '  '
     C                   WHEN      XPOS > 0
     C                   EVAL      WSEMST = 'EM'
     C                   OTHER
     C                   EVAL      WSEMST = 'TE'
     C                   ENDSL
      * Mottaker
     C                   IF        WSKNM <> 0
     C                   EXSR      TESTM
     C                   END
      *
     C                   IF        WSRGM = *BLANKS
     C                   EVAL      *IN73 = *ON
     C                   END
      *
     C                   IF        WSNAM = *BLANKS
     C                   EVAL      *IN72 = *ON
     C                   END
      *
     C                   IF        WSAD1M = *BLANKS
     C                   EVAL      *IN71 = *ON
     C                   END
      *
     C                   IF        WSPNM = *BLANKS
     C                   EVAL      *IN70 = *ON
     C                   END
      *
     C                   IF        WSPSM = *BLANKS
     C                   EVAL      *IN69 = *ON
     C                   END
      *
     C                   EVAL      KLKLK = WSLKM
     C     KODTLKK       CHAIN     KODTLK                             68
      *
     C                   IF        WSEMM = *BLANKS
     C                   EVAL      *IN67 = *ON
     C                   END
      *
     C     '@'           SCAN      WSEMM         XPOS                     33
     C                   SELECT
     C                   WHEN      WSEMM = *BLANKS
     C                   EVAL      WSEMMT = '  '
     C                   WHEN      XPOS > 0
     C                   EVAL      WSEMMT = 'EM'
     C                   OTHER
     C                   EVAL      WSEMMT = 'TE'
     C                   ENDSL
      * transportDocumentHouseLevel
     C*                  IF        WSDKH <> *BLANKS OR WSDKHT <> *BLANKS
     C*                  EVAL      TKUNIK = '754'
     C*                  EVAL      TKKODE = WSDKHT
     C*    TRKODL01K     CHAIN     TRKODL01                           97
     C*                  END
      *
     C*                  IF        WSTCVA <> *BLANKS OR WSTCBL <> 0
     C     WSTCVA        CHAIN     KODTVAL2                           66
     C     WSTCBL        COMP      0                                      65
     C*                  END
      * countryOfRoutingOfConsinments
     C                   EVAL      KLKLK = WSLKR1
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 15
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR2 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR2
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 18
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR3 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR3
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 21
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR4 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR4
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 24
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR5 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR5
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 27
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR6 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR6
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 30
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR7 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR7
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 33
     C                   END
     C                   END
      *
     C                   IF        *IN64 = *OFF AND WSLKR8 <> *BLANKS
     C                   EVAL      KLKLK = WSLKR8
     C     KODTLKK       CHAIN     KODTLK                             64
     C                   IF        *IN64
     C                   EVAL      LINNBR = 17
     C                   EVAL      POSNBR = 36
     C                   END
     C                   END
      * Passiv kjøretøy
      * Type
     C                   IF        WSPMRK <> *BLANKS OR WSPTYP <> *BLANKS
     C                   EVAL      TKUNIK = '750'
     C                   EVAL      TKKODE = WSPTYP
     C     TRKODL01K     CHAIN     TRKODL01                           63
     C                   END
      * Mode
     C                   IF        WSPMRK <> *BLANKS OR WSPTM  <> *BLANKS
     C                   EVAL      TKUNIK = '751'
     C                   EVAL      TKKODE = WSPTM
     C     TRKODL01K     CHAIN     TRKODL01                           62
     C                   END
      * Landkode
     C                   IF        WSPLK <> *BLANKS
     C                   EVAL      KLKLK = WSPLK
     C     KODTLKK       CHAIN     KODTLK                             61
     C                   END
      * UCR referanse
sjov C*    WSUCR         COMP      *BLANKS                                60
njov C                   setoff                                           60
      *
     C                   EXSR      HMSG
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG          BEGSR
      ***********************************************
     C   99              DO
     C                   MOVE      'YBC2154'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   98
     CANN30              DO
     C                   MOVE      'YBC2155'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   END
      *
     C   97
     CANN30              DO
     C                   MOVE      'YBC2156'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     76            POSNBR
     C                   END
      *
     C   96
     CANN30              DO
     C                   MOVE      'YBC2157'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   95
     CANN30              DO
     C                   MOVE      'YBC2198'     MSGNR
Njov c                   IF        WSPRT = 'TRANSIT_RELEASE' and
Njov c                             WSUPR <>'EXP'
Njov c                   eval      WSUPR = 'EXP'
NJov C                   MOVE      'JOV1803'     MSGNR
Njov c                   ENDIF
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   END
      *
     C   94
     CANN30              DO
     C                   MOVE      'YBC2094'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     65            POSNBR
     C                   END
      *
     C   93
     CANN30              DO
     C                   MOVE      'YBC2096'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     93            POSNBR
     C                   END
      *
     C   92
     CANN30              DO
     C                   MOVE      'YBC2158'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   59
     CANN30              DO
     C                   MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
      *
     C   58
     CANN30              DO
     C                   MOVE      'YBC2202'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   END
      *
     C   91
     CANN30              DO
     C                   MOVE      'YBC2159'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
jov  C*                  Z-ADD     75            POSNBR
Jov  C                   Z-ADD     15            POSNBR
Jov  C                   SETON                                        92
     C                   END
      *
     C   90
     CANN30              DO
     C                   MOVE      'YBC2160'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     100           POSNBR
     C                   END
      *
     C   89
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   88
     CANN30              DO
     C                   MOVE      'YBC2161'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   END
      *
     C   87
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     65            POSNBR
     C                   END
      *
     C   86
     CANN30              DO
     C                   MOVE      'YBC2161'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     68            POSNBR
     C                   END
      *
     C   85
     CANN30              DO
     C                   MOVE      'YBC2162'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   84
     CANN30              DO
     C                   MOVE      'YBC2163'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   END
      *
     C   83
     CANN30              DO
     C                   MOVE      'YBC2164'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     103           POSNBR
     C                   END
      *
     C   82
     CANN30              DO
     C                   MOVE      'SPK0115'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   81
     CANN30              DO
     C                   MOVE      'YBC2170'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
      *
     C   80
     CANN30              DO
     C                   MOVE      'YBC2165'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     59            POSNBR
     C                   END
      *
     C   79
     CANN30              DO
     C                   MOVE      'YBC2166'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   78
     CANN30              DO
     C                   MOVE      'YBC2167'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     62            POSNBR
     C                   END
      *
     C   77
     CANN30              DO
     C                   MOVE      'YBC2168'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C   76
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     101           POSNBR
     C                   END
      *
     C   75
     CANN30              DO
     C                   MOVE      'YBC2169'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   74
     CANN30              DO
     C                   MOVE      'SPK0115'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   73
     CANN30              DO
     C                   MOVE      'YBC2170'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
      *
     C   72
     CANN30              DO
     C                   MOVE      'YBC2165'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     59            POSNBR
     C                   END
      *
     C   71
     CANN30              DO
     C                   MOVE      'YBC2166'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   70
     CANN30              DO
     C                   MOVE      'YBC2167'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     62            POSNBR
     C                   END
      *
     C   69
     CANN30              DO
     C                   MOVE      'YBC2168'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C   68
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     101           POSNBR
     C                   END
      *
     C   67
     CANN30              DO
     C                   MOVE      'YBC2169'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C*  66
     C*NN30              DO
     C*                  MOVE      'YBC2171'     MSGNR
     C*                  SETON                                        30
     C*                  Z-ADD     16            LINNBR
     C*                  Z-ADD     72            POSNBR
     C*                  END
      *
     C   66
     CANN30              DO
     C                   MOVE      'SPV0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     94            POSNBR
     C                   END
      *
     C   65
     CANN30              DO
     C                   MOVE      'YBC2172'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     105           POSNBR
     C                   END
      *
     C   64
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     C                   END
      *
     C   63
     CANN30              DO
     C                   MOVE      'YBC2185'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     92            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C   62
     CANN30              DO
     C                   MOVE      'YBC2186'     MSGNR
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     104           POSNBR
     C                   SETON                                        30
     C                   END
      *
     C   61
     CANN30              DO
     C                   MOVE      'SPL0001'     MSGNR
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     113           POSNBR
     C                   SETON                                        30
     C                   END
      *
     C   60
     CANN30              DO
     C                   MOVE      'YBC2191'     MSGNR
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   SETON                                        30
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTB2        BEGSR
      ***********************************************
      * Bruttovekt
     C                   IF        WSVKB = 0
     C                   EVAL      *IN99 = *ON
     C                   END
      * Avsender
     C                   IF        WSKNM <> 0
     C                   EXSR      TESTS
     C                   IF        *IN83 = *ON
     C                   EVAL      *IN98 = *ON
     C                   EVAL      *IN83 = *OFF
     C                   END
     C                   END
      *
     C                   IF        WSNAM = *BLANKS
     C                   EVAL      *IN97 = *ON
     C                   END
      * transportDocumentHouseLevel
     C                   IF        WSDKH <> *BLANKS OR WSDKHT <> *BLANKS
     C                   EVAL      TKUNIK = '754'
     C                   EVAL      TKKODE = WSDKHT
     C     TRKODL01K     CHAIN     TRKODL01                           96
     C                   END
      *
     C                   EXSR      HMSG2
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG2         BEGSR
      ***********************************************
      *
     C   99              DO
     C                   MOVE      'SPV0002'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   98
     CANN30              DO
     C                   MOVE      'SPK0115'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   97
     CANN30              DO
     C                   MOVE      'YBC2165'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   END
      *
     C   96
     CANN30              DO
     C                   MOVE      'YBC2171'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTS         BEGSR
      ***********************************************
      *
S02  C*                  IF        WSKNS = 0                                    1<-B
S02  C*                  EVAL      *IN82 = *ON
S02  C*                  ELSE                                                   1
S02  C*                  IF        WSNAS = *BLANKS                               2<-B
S02  C*                  MOVE      'J'           XHENTRG           1
S02  C*                  ELSE                                                    2
S02  C*                  MOVE      'N'           XHENTRG
S02  C*                  END                                                     2<-E
     C                   EVAL      KUNDNR = WSKNS
S02  C*    CUNDL01K      CHAIN     CUNDL01                            83
N02  C     CUNDL01K      CHAIN     CUNDL01                            82
     C                   IF        *IN82 = *OFF                                  2<-B
N02  C                             AND WSNAS = *BLANKS
     C                   EVAL      WSNAS  = KNAVN
     C                   EVAL      WSAD1S = ADR1
     C                   EVAL      WSNRS  = ADR2
     C                   EVAL      WSPNS  = *BLANKS
     C                   IF        POSTNR = 0                                     3<-B
     C                   EVAL      WSPNS  = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNS
     C                   ENDIF                                                    3<-E
     C                   EVAL      WSPSS  = ADR3
     C                   IF        SYLAND = *BLANKS                               3<-B
     C                   EVAL      WSLKS  = FILAND
     C                   ELSE                                                     3
     C                   EVAL      WSLKS  = SYLAND
     C                   END                                                      3<-E
     C                   SELECT                                                   3<-B
     C                   WHEN      SYEPOS <> *BLANKS                              3
     C                   EVAL      WSEMS  = SYEPOS
     C                   EVAL      WSEMST = 'EM'
     C                   WHEN      TLF <> *BLANKS                                 3
     C                   EVAL      WSEMS  = TLF
     C                   EVAL      WSEMST = 'TE'
     C                   ENDSL                                                    3<-E
     C                   IF        SYFOR9 <> *ZEROS                               3<-B
N02  C                             AND SYFOR9 <> *BLANKS
S02  C*                            AND XHENTRG = 'J'
     C                   EVAL      WSRGS = SYRG
N02  C                   ELSE                                                     3
N02  C                   if        EORI <> *blanks
N02  C                   EVAL      WSRGS = EORI
N02  C                   END                                                       4<-E
     C                   END                                                      3<-E
S02  C*                  ELSE                                                    2
S02  C*                  EVAL      *IN82 = *ON
     C                   END                                                     2<-E
S02  C*                  END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTM         BEGSR
      ***********************************************
      *
S02  C*                  IF        WSKNM = 0                                    1<-B
S02  C*                  EVAL      *IN74 = *ON
S02  C*                  ELSE                                                   1
S02  C*                  IF        WSNAM = *BLANKS                               2<-B
S02  C*                  MOVE      'J'           XHENTRG           1
S02  C*                  ELSE                                                    2
S02  C*                  MOVE      'N'           XHENTRG
S02  C*                  END                                                     2<-E
     C                   EVAL      KUNDNR = WSKNM
     C     CUNDL01K      CHAIN     CUNDL01                            74
     C                   IF        *IN74 = *OFF                                  2<-B
N02  C                             AND WSNAM = *BLANKS
     C                   EVAL      WSNAM  = KNAVN
     C                   EVAL      WSAD1M = ADR1
     C                   EVAL      WSNRM  = ADR2
     C                   EVAL      WSPNM  = *BLANKS
     C                   IF        POSTNR = 0                                     3<-B
     C                   EVAL      WSPNM  = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNM
     C                   ENDIF                                                    3<-E
     C                   EVAL      WSPSM  = ADR3
     C                   IF        SYLAND = *BLANKS                               3<-B
     C                   EVAL      WSLKM  = FILAND
     C                   ELSE                                                     3
     C                   EVAL      WSLKM  = SYLAND
     C                   END                                                      3<-E
     C                   SELECT                                                   3<-B
     C                   WHEN      SYEPOS <> *BLANKS                              3
     C                   EVAL      WSEMM  = SYEPOS
     C                   EVAL      WSEMMT = 'EM'
     C                   WHEN      TLF <> *BLANKS                                 3
     C                   EVAL      WSEMM  = TLF
     C                   EVAL      WSEMMT = 'TE'
     C                   ENDSL                                                    3<-E
     C                   IF        SYFOR9 <> *ZEROS                               3<-B
N02  C                             AND SYFOR9 <> *BLANKS
S02  C*                            AND XHENTRG = 'J'
     C                   EVAL      WSRGM = SYRG
N02  C                   ELSE                                                     3
N02  C                   if        EORI <> *blanks                                 4<-B
N02  C                   EVAL      WSRGM = EORI
N02  C                   END                                                       4<-E
     C                   END                                                      3<-E
S02  C*                  ELSE                                                    2
S02  C*                  EVAL      *IN74 = *ON
     C                   END                                                     2<-E
S02  C*                  END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTD         BEGSR
      ***********************************************
      *
S02  C*                  IF        WSNAD = *BLANKS                              1<-B
S02  C*                  MOVE      'J'           XHENTRG           1
S02  C*                  ELSE                                                   1
S02  C*                  MOVE      'N'           XHENTRG
S02  C*                  END                                                    1<-E
     C                   EVAL      KUNDNR = WSKND
     C     CUNDL01K      CHAIN     CUNDL01                            99
     C                   IF        *IN99 = *OFF                                 1<-B
N02  C                             AND WSNAD = *BLANKS
     C                   EVAL      WSNAD  = KNAVN
     C                   EVAL      WSAD1D = ADR1
     C                   EVAL      WSNRD  = ADR2
     C                   EVAL      WSPND  = *BLANKS
     C                   IF        POSTNR = 0                                    2<-B
     C                   EVAL      WSPND  = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPND
     C                   ENDIF                                                   2<-E
     C                   EVAL      WSPSD  = ADR3
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   EVAL      WSLKD  = FILAND
     C                   ELSE                                                    2
     C                   EVAL      WSLKD  = SYLAND
     C                   END                                                     2<-E
     C                   SELECT                                                  2<-B
     C                   WHEN      SYEPOS <> *BLANKS                             2
     C                   EVAL      WSEMD  = SYEPOS
     C                   EVAL      WSEMDT = 'EM'
     C                   WHEN      TLF <> *BLANKS                                2
     C                   EVAL      WSEMD  = TLF
     C                   EVAL      WSEMDT = 'TE'
     C                   ENDSL                                                   2<-E
     C                   IF        SYFOR9 <> *ZEROS                              2<-B
N02  C                             AND SYFOR9 <> *BLANKS
S02  C*                            AND XHENTRG = 'J'
     C                   EVAL      WSRGD = SYRG
N02  C                   ELSE                                                    2
N02  C                   if        EORI <> *blanks                                3<-B
N02  C                   EVAL      WSRGD = EORI
N02  C                   END                                                      3<-E
     C                   END                                                     2<-E
S02  C*                  ELSE                                                   1
S02  C*                  EVAL      *IN99 = *ON
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     TESTR         BEGSR
      ***********************************************
      *
S02  C*                  IF        WSNAR = *BLANKS                              1<-B
S02  C*                  MOVE      'J'           XHENTRG           1
S02  C*                  ELSE                                                   1
S02  C*                  MOVE      'N'           XHENTRG
S02  C*                  END                                                    1<-E
     C                   EVAL      KUNDNR = WSKNR
     C     CUNDL01K      CHAIN     CUNDL01                            91
     C                   IF        *IN91 = *OFF                                 1<-B
N02  C                             AND WSNAR = *BLANKS
     C                   EVAL      WSNAR  = KNAVN
     C                   EVAL      WSAD1R = ADR1
     C                   EVAL      WSNRR  = ADR2
     C                   EVAL      WSPNR  = *BLANKS
     C                   IF        POSTNR = 0                                    2<-B
     C                   EVAL      WSPNR  = SYPOGE
     C                   ELSE
     C                   MOVEL     POSTNR        WSPNR
     C                   ENDIF                                                   2<-E
     C                   EVAL      WSPSR  = ADR3
     C                   IF        SYLAND = *BLANKS                              2<-B
     C                   EVAL      WSLKR  = FILAND
     C                   ELSE                                                    2
     C                   EVAL      WSLKR  = SYLAND
     C                   END                                                     2<-E
     C                   SELECT                                                  2<-B
     C                   WHEN      SYEPOS <> *BLANKS                             2
     C                   EVAL      WSEMR  = SYEPOS
     C                   EVAL      WSEMRT = 'EM'
     C                   WHEN      TLF <> *BLANKS                                2
     C                   EVAL      WSEMR  = TLF
     C                   EVAL      WSEMRT = 'TE'
     C                   ENDSL                                                   2<-E
     C                   IF        SYFOR9 <> *ZEROS                              2<-B
N02  C                             AND SYFOR9 <> *BLANKS
S02  C*                            AND XHENTRG = 'J'
     C                   EVAL      WSRGR = SYRG
N02  C                   ELSE                                                     3
N02  C                   if        EORI <> *blanks                                 4<-B
N02  C                   EVAL      WSRGR = EORI
N02  C                   END                                                       4<-E
     C                   END                                                     2<-E
S02  C*                  ELSE                                                   1
S02  C*                  EVAL      *IN91 = *ON
     C                   END                                                    1<-E
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVEXW        BEGSR
      ***********************************************
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UTDN          WSTDN
      *
     C                   IF        EHRGD   = *BLANKS
      * deklarant
     C                   EVAL      WSKND   = EMKND
     C                   EVAL      WSRGD   = EMRGD
     C                   EVAL      WSNAD   = EMNAD
     C                   EVAL      WSNA2D  = EMNA2D
     C                   EVAL      WSAD1D  = EMAD1D
     C                   EVAL      WSNRD   = EMNRD
     C                   EVAL      WSPND   = EMPND
     C                   EVAL      WSPSD   = EMPSD
     C                   EVAL      WSLKD   = EMLKD
     C                   EVAL      WSPBD   = EMPBD
     C                   EVAL      WSEMD   = EMEMD
     C                   EVAL      WSEMDT  = EMEMDT
      * representativ
     C                   EVAL      WSKNR   = EMKNR
     C                   EVAL      WSRGR   = EMRGR
     C                   EVAL      WSSTR   = EMSTR
     C                   EVAL      WSNAR   = EMNAR
     C                   EVAL      WSNA2R  = EMNA2R
     C                   EVAL      WSAD1R  = EMAD1R
     C                   EVAL      WSNRR   = EMNRR
     C                   EVAL      WSPNR   = EMPNR
     C                   EVAL      WSPSR   = EMPSR
     C                   EVAL      WSLKR   = EMLKR
     C                   EVAL      WSPBR   = EMPBR
     C                   EVAL      WSEMR   = EMEMR
     C                   EVAL      WSEMRT  = EMEMRT
      *
     C                   ELSE
      * deklarant
     C                   EVAL      WSKND   = EHKND
     C                   EVAL      WSRGD   = EHRGD
     C                   EVAL      WSNAD   = EHNAD
     C                   EVAL      WSNA2D  = EHNA2D
     C                   EVAL      WSAD1D  = EHAD1D
     C                   EVAL      WSNRD   = EHNRD
     C                   EVAL      WSPND   = EHPND
     C                   EVAL      WSPSD   = EHPSD
     C                   EVAL      WSLKD   = EHLKD
     C                   EVAL      WSPBD   = EHPBD
     C                   EVAL      WSEMD   = EHEMD
     C                   EVAL      WSEMDT  = EHEMDT
      * representativ
     C                   EVAL      WSKNR   = EHKNR
     C                   EVAL      WSRGR   = EHRGR
     C                   EVAL      WSSTR   = EHSTR
     C                   EVAL      WSNAR   = EHNAR
     C                   EVAL      WSNA2R  = EHNA2R
     C                   EVAL      WSAD1R  = EHAD1R
     C                   EVAL      WSNRR   = EHNRR
     C                   EVAL      WSPNR   = EHPNR
     C                   EVAL      WSPSR   = EHPSR
     C                   EVAL      WSLKR   = EHLKR
     C                   EVAL      WSPBR   = EHPBR
     C                   EVAL      WSEMR   = EHEMR
     C                   EVAL      WSEMRT  = EHEMRT
      *
     C                   END
      * consigmentHouseLevel
     C                   EVAL      WSCNIN  = EHCNIN
     C                   EVAL      WSCNR   = EHCNR
     C                   EVAL      WSVKB   = EHVKB
     C                   EVAL      WSNTK   = EHNTK
     C                   EVAL      WSVT    = EHVT
      * exportFromEU
     C                   EVAL      WSETYP  = EHETYP
     C                   EVAL      WSETYPT = EHETYPT
     C                   EVAL      WSEID   = EHEID
      * importProcedure
     C                   EVAL      WSPR    = EHPR
     C                   EVAL      WSPRT   = EHPRT
      * outgoingProcedure
     C                   EVAL      WSUPR   = EHUPR
     C                   EVAL      WSUPRT  = EHUPRT
      * Norsk import
     C                   EVAL      WSRG    = EHRG
     C                   EVAL      WS0068A = EH0068A
     C                   EVAL      WS0068B = EH0068B
      * NCTS
     C                   EVAL      WSTRNR  = EHTRNR
     C                   EVAL      WSTRTY  = EHTRTY
      *
     C                   EVAL      WSLKF   = EHLKF
     C                   EVAL      WSSDF   = EHSDF
     C                   EVAL      WSSDFT  = EHSDFT
     C                   EVAL      WSLKT   = EHLKT
     C                   EVAL      WSSDT   = EHSDT
     C                   EVAL      WSSDTT  = EHSDTT
      * additionalFiscalReference
     C                   EVAL      WSRGA   = EHRGA
     C                   EVAL      WSRGRO  = EHRGRO
      * additionalSupplyChainActor
     C                   EVAL      WSRGE   = EHRGE
     C                   EVAL      WSROE   = EHROE
      * Avsender
     C                   EVAL      WSKNS   = EHKNS
     C                   EVAL      WSRGS   = EHRGS
     C                   EVAL      WSNAS   = EHNAS
     C                   EVAL      WSNA2S  = EHNA2S
     C                   EVAL      WSAD1S  = EHAD1S
     C                   EVAL      WSNRS   = EHNRS
     C                   EVAL      WSPNS   = EHPNS
     C                   EVAL      WSPSS   = EHPSS
     C                   EVAL      WSLKS   = EHLKS
     C                   EVAL      WSPBS   = EHPBS
     C                   EVAL      WSEMS   = EHEMS
     C                   EVAL      WSEMST  = EHEMST
      * Mottaker
     C                   EVAL      WSKNM   = EHKNM
     C                   EVAL      WSRGM   = EHRGM
     C                   EVAL      WSNAM   = EHNAM
     C                   EVAL      WSNA2M  = EHNA2M
     C                   EVAL      WSAD1M  = EHAD1M
     C                   EVAL      WSNRM   = EHNRM
     C                   EVAL      WSPNM   = EHPNM
     C                   EVAL      WSPSM   = EHPSM
     C                   EVAL      WSLKM   = EHLKM
     C                   EVAL      WSPBM   = EHPBM
     C                   EVAL      WSEMM   = EHEMM
     C                   EVAL      WSEMMT  = EHEMMT
      * transportDocumentHouseLevel
     C                   EVAL      WSDKH   = EHDKH
     C                   EVAL      WSDKHT  = EHDKHT
     C                   EVAL      WSTCMP  = EHTCMP
     C                   EVAL      WSTCVA  = EHTCVA
     C                   EVAL      WSTCBL  = EHTCBL
      * countryOfRoutingOfConsinments
     C                   EVAL      WSLKR1  = EHLKR1
     C                   EVAL      WSLKR2  = EHLKR2
     C                   EVAL      WSLKR3  = EHLKR3
     C                   EVAL      WSLKR4  = EHLKR4
     C                   EVAL      WSLKR5  = EHLKR5
     C                   EVAL      WSLKR6  = EHLKR6
     C                   EVAL      WSLKR7  = EHLKR7
     C                   EVAL      WSLKR8  = EHLKR8
      * Passiv kjøretøy
     C                   EVAL      WSPMRK  = EHPMRK
     C                   EVAL      WSPTYP  = EHPTYP
     C                   EVAL      WSPTM   = EHPTM
     C                   EVAL      WSPTMT  = EHPTMT
     C                   EVAL      WSPLK   = EHPLK
      * Bilnr
     C*                  EVAL      WSTRID  = EHTRID
      * UCR reference
     C                   EVAL      WSUCR   = EHUCR
      *
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVWEX        BEGSR
      ***********************************************
      * deklarant
     C                   EVAL      EHKND   = WSKND
     C                   EVAL      EHRGD   = WSRGD
     C                   EVAL      EHNAD   = WSNAD
     C                   EVAL      EHNA2D  = WSNA2D
     C                   EVAL      EHAD1D  = WSAD1D
     C                   EVAL      EHNRD   = WSNRD
     C                   EVAL      EHPND   = WSPND
     C                   EVAL      EHPSD   = WSPSD
     C                   EVAL      EHLKD   = WSLKD
     C                   EVAL      EHPBD   = WSPBD
     C                   EVAL      EHEMD   = WSEMD
     C                   EVAL      EHEMDT  = WSEMDT
      * representativ
     C                   EVAL      EHKNR   = WSKNR
     C                   EVAL      EHRGR   = WSRGR
     C                   EVAL      EHSTR   = WSSTR
     C                   EVAL      EHNAR   = WSNAR
     C                   EVAL      EHNA2R  = WSNA2R
     C                   EVAL      EHAD1R  = WSAD1R
     C                   EVAL      EHNRR   = WSNRR
     C                   EVAL      EHPNR   = WSPNR
     C                   EVAL      EHPSR   = WSPSR
     C                   EVAL      EHLKR   = WSLKR
     C                   EVAL      EHPBR   = WSPBR
     C                   EVAL      EHEMR   = WSEMR
     C                   EVAL      EHEMRT  = WSEMRT
      * consigmentHouseLevel
     C                   EVAL      EHCNIN  = WSCNIN
     C                   EVAL      EHCNR   = WSCNR
     C                   EVAL      EHVKB   = WSVKB
     C                   EVAL      EHNTK   = WSNTK
     C                   EVAL      EHVT    = WSVT
      * exportFromEU
     C                   EVAL      EHETYP  = WSETYP
     C                   EVAL      EHETYPT = WSETYPT
     C                   EVAL      EHEID   = WSEID
      * importProcedure
     C                   EVAL      EHPR    = WSPR
     C                   EVAL      EHPRT   = WSPRT
      * outgoingProcedure
     C                   EVAL      EHUPR   = WSUPR
     C                   EVAL      EHUPRT  = WSUPRT
      * Norsk import
     C                   EVAL      EHRG    = WSRG
     C                   EVAL      EH0068A = WS0068A
     C                   EVAL      EH0068B = WS0068B
      * NCTS
     C                   EVAL      EHTRNR  = WSTRNR
     C                   EVAL      EHTRTY  = WSTRTY
      *
     C                   EVAL      EHLKF   = WSLKF
     C                   EVAL      EHSDF   = WSSDF
     C                   EVAL      EHSDFT  = WSSDFT
     C                   EVAL      EHLKT   = WSLKT
     C                   EVAL      EHSDT   = WSSDT
     C                   EVAL      EHSDTT  = WSSDTT
      * additionalFiscalReference
     C                   EVAL      EHRGA   = WSRGA
     C                   EVAL      EHRGRO  = WSRGRO
      * additionalSupplyChainActor
     C                   EVAL      EHRGE   = WSRGE
     C                   EVAL      EHROE   = WSROE
      * Avsender
     C                   EVAL      EHKNS   = WSKNS
     C                   EVAL      EHRGS   = WSRGS
     C                   EVAL      EHNAS   = WSNAS
     C                   EVAL      EHNA2S  = WSNA2S
     C                   EVAL      EHAD1S  = WSAD1S
     C                   EVAL      EHNRS   = WSNRS
     C                   EVAL      EHPNS   = WSPNS
     C                   EVAL      EHPSS   = WSPSS
     C                   EVAL      EHLKS   = WSLKS
     C                   EVAL      EHPBS   = WSPBS
     C                   EVAL      EHEMS   = WSEMS
     C                   EVAL      EHEMST  = WSEMST
      * Mottaker
     C                   EVAL      EHKNM   = WSKNM
     C                   EVAL      EHRGM   = WSRGM
     C                   EVAL      EHNAM   = WSNAM
     C                   EVAL      EHNA2M  = WSNA2M
     C                   EVAL      EHAD1M  = WSAD1M
     C                   EVAL      EHNRM   = WSNRM
     C                   EVAL      EHPNM   = WSPNM
     C                   EVAL      EHPSM   = WSPSM
     C                   EVAL      EHLKM   = WSLKM
     C                   EVAL      EHPBM   = WSPBM
     C                   EVAL      EHEMM   = WSEMM
     C                   EVAL      EHEMMT  = WSEMMT
      * transportDocumentHouseLevel
     C                   EVAL      EHDKH   = WSDKH
     C                   EVAL      EHDKHT  = WSDKHT
     C                   EVAL      EHTCMP  = WSTCMP
     C                   EVAL      EHTCVA  = WSTCVA
     C                   EVAL      EHTCBL  = WSTCBL
      * countryOfRoutingOfConsinments
     C                   EVAL      EHLKR1  = WSLKR1
     C                   EVAL      EHLKR2  = WSLKR2
     C                   EVAL      EHLKR3  = WSLKR3
     C                   EVAL      EHLKR4  = WSLKR4
     C                   EVAL      EHLKR5  = WSLKR5
     C                   EVAL      EHLKR6  = WSLKR6
     C                   EVAL      EHLKR7  = WSLKR7
     C                   EVAL      EHLKR8  = WSLKR8
      * Passiv kjøretøy
     C                   EVAL      EHPMRK  = WSPMRK
     C                   EVAL      EHPTYP  = WSPTYP
     C                   EVAL      EHPTM   = WSPTM
     C                   EVAL      EHPTMT  = WSPTMT
     C                   EVAL      EHPLK   = WSPLK
      * Bilnr
     C*                  EVAL      EHTRID  = WSTRID
     C                   EVAL      EHUCR   = WSUCR
      *
     C                   ENDSR
      *
      ***********************************************
     C     MOVSAW        BEGSR
      ***********************************************
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UTDN          WSTDN
      * deklarant
     C                   EVAL      WSKND   = EMKND
     C                   EVAL      WSRGD   = EMRGD
     C                   EVAL      WSNAD   = EMNAD
     C                   EVAL      WSNA2D  = EMNA2D
     C                   EVAL      WSAD1D  = EMAD1D
     C                   EVAL      WSNRD   = EMNRD
     C                   EVAL      WSPND   = EMPND
     C                   EVAL      WSPSD   = EMPSD
     C                   EVAL      WSLKD   = EMLKD
     C                   EVAL      WSPBD   = EMPBD
     C                   EVAL      WSEMD   = EMEMD
     C                   EVAL      WSEMDT  = EMEMDT
      * representativ
     C                   EVAL      WSKNR   = EMKNR
     C                   EVAL      WSRGR   = EMRGR
     C                   EVAL      WSSTR   = EMSTR
     C                   EVAL      WSNAR   = EMNAR
     C                   EVAL      WSNA2R  = EMNA2R
     C                   EVAL      WSAD1R  = EMAD1R
     C                   EVAL      WSNRR   = EMNRR
     C                   EVAL      WSPNR   = EMPNR
     C                   EVAL      WSPSR   = EMPSR
     C                   EVAL      WSLKR   = EMLKR
     C                   EVAL      WSPBR   = EMPBR
     C                   EVAL      WSEMR   = EMEMR
     C                   EVAL      WSEMRT  = EMEMRT
      * consigmentHouseLevel
     C                   EVAL      WSCNIN  = 0
     C                   EVAL      WSCNR   = *BLANKS
     C                   EVAL      WSVKB   = 0
     C                   EVAL      WSNTK   = 0
     C                   EVAL      WSVT    = *BLANKS
      * exportFromEU
     C                   EVAL      WSETYP  = *BLANKS
     C                   EVAL      WSETYPT = *BLANKS
     C                   EVAL      WSEID   = *BLANKS
      * importProcedure
     C                   EVAL      WSPR    = *BLANKS
     C                   EVAL      WSPRT   = *BLANKS
      * outgoingProcedure
     C                   EVAL      WSUPR   = *BLANKS
     C                   EVAL      WSUPRT  = *BLANKS
      * Norsk import
     C                   EVAL      WSRG    = *BLANKS
     C                   EVAL      WS0068A = 0
     C                   EVAL      WS0068B = 0
      * NCTS
     C                   EVAL      WSTRNR  = *BLANKS
     C                   EVAL      WSTRTY  = *BLANKS
      *
     C                   EVAL      WSLKF   = *BLANKS
     C                   EVAL      WSSDF   = *BLANKS
     C                   EVAL      WSSDFT  = *BLANKS
     C                   EVAL      WSLKT   = *BLANKS
     C                   EVAL      WSSDT   = *BLANKS
     C                   EVAL      WSSDTT  = *BLANKS
      * additionalFiscalReference
     C                   EVAL      WSRGA   = *BLANKS
     C                   EVAL      WSRGRO  = *BLANKS
      * additionalSupplyChainActor
     C                   EVAL      WSRGE   = *BLANKS
     C                   EVAL      WSROE   = *BLANKS
      * Avsender
     C                   EVAL      WSKNS   = 0
     C                   EVAL      WSRGS   = *BLANKS
     C                   EVAL      WSNAS   = *BLANKS
     C                   EVAL      WSNA2S  = *BLANKS
     C                   EVAL      WSAD1S  = *BLANKS
     C                   EVAL      WSNRS   = *BLANKS
     C                   EVAL      WSPNS   = *BLANKS
     C                   EVAL      WSPSS   = *BLANKS
     C                   EVAL      WSLKS   = *BLANKS
     C                   EVAL      WSPBS   = *BLANKS
     C                   EVAL      WSEMS   = *BLANKS
     C                   EVAL      WSEMST  = *BLANKS
      * Mottaker
     C                   EVAL      WSKNM   = 0
     C                   EVAL      WSRGM   = *BLANKS
     C                   EVAL      WSNAM   = *BLANKS
     C                   EVAL      WSNA2M  = *BLANKS
     C                   EVAL      WSAD1M  = *BLANKS
     C                   EVAL      WSNRM   = *BLANKS
     C                   EVAL      WSPNM   = *BLANKS
     C                   EVAL      WSPSM   = *BLANKS
     C                   EVAL      WSLKM   = *BLANKS
     C                   EVAL      WSPBM   = *BLANKS
     C                   EVAL      WSEMM   = *BLANKS
     C                   EVAL      WSEMMT  = *BLANKS
      * transportDocumentHouseLevel
     C                   EVAL      WSDKH   = *BLANKS
     C                   EVAL      WSDKHT  = *BLANKS
     C                   EVAL      WSTCMP  = *BLANKS
     C                   EVAL      WSTCVA  = *BLANKS
     C                   EVAL      WSTCBL  = 0
      * countryOfRoutingOfConsinments
     C                   EVAL      WSLKR1  = *BLANKS
     C                   EVAL      WSLKR2  = *BLANKS
     C                   EVAL      WSLKR3  = *BLANKS
     C                   EVAL      WSLKR4  = *BLANKS
     C                   EVAL      WSLKR5  = *BLANKS
     C                   EVAL      WSLKR6  = *BLANKS
     C                   EVAL      WSLKR7  = *BLANKS
     C                   EVAL      WSLKR8  = *BLANKS
      * Passiv kjøretøy
     C                   EVAL      WSPMRK  = *BLANKS
     C                   EVAL      WSPTYP  = *BLANKS
     C                   EVAL      WSPTM   = *BLANKS
     C                   EVAL      WSPTMT  = *BLANKS
     C                   EVAL      WSPLK   = *BLANKS
      * Bilnr
     C*                  EVAL      WSTRID  = *BLANKS
     C                   EVAL      WSUCR   = *BLANKS
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRCHGDR       BEGSR
      ***********************************************
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     15            POSNBR
      *
     C     STCHGDR1      TAG
     C                   EXFMT     BILDE03
     C                   MOVEA     '000000000000'*IN(88)
     C                   MOVEA     '00000'       *IN(83)
     C                   MOVE      '0'           *IN30
      *
      *  04 = SØK DEKLARANT/REPRESENTIV
     C   04              DO
     C                   EXSR      SOKDTA3
     C                   GOTO      STCHGDR1
     C                   END
      *
     C   12              GOTO      SLCHGDR
      *
     C                   EXSR      TESTB3
     C   30              GOTO      STCHGDR1
      *
     C     SLCHGDR       ENDSR
      *
      ***********************************************
     C     TESTB3        BEGSR
      ***********************************************
      * Deklarant
     C                   IF        WSKND <> 0
     C                   EXSR      TESTD
     C                   END
      *
     C                   IF        WSRGD = *BLANKS
     C                   EVAL      *IN98 = *ON
     C                   END
      *
     C                   IF        WSNAD = *BLANKS
     C                   EVAL      *IN97 = *ON
     C                   END
      *
     C                   IF        WSAD1D = *BLANKS
     C                   EVAL      *IN96 = *ON
     C                   END
      *
     C                   IF        WSPND = *BLANKS
     C                   EVAL      *IN95 = *ON
     C                   END
      *
     C                   IF        WSPSD = *BLANKS
     C                   EVAL      *IN94 = *ON
     C                   END
      *
     C                   EVAL      KLKLK = WSLKD
     C     KODTLKK       CHAIN     KODTLK                             93
      *
     C                   IF        WSEMD = *BLANKS
     C                   EVAL      *IN92 = *ON
     C                   END
      *
     C     '@'           SCAN      WSEMD         XPOS              3 0    33
     C                   SELECT
     C                   WHEN      WSEMD = *BLANKS
     C                   EVAL      WSEMDT = '  '
     C                   WHEN      XPOS > 0
     C                   EVAL      WSEMDT = 'EM'
     C                   OTHER
     C                   EVAL      WSEMDT = 'TE'
     C                   ENDSL
      * Representvi
     C                   IF        WSKNR <> 0
     C                   EXSR      TESTR
     C                   END
      *
     C                   IF        WSRGR = *BLANKS
     C                   EVAL      *IN90 = *ON
     C                   END
      *
     C                   IF        WSRGR <> *BLANKS AND WSSTR = ' '
     C                   EVAL      *IN89 = *ON
     C                   END
      *
     C                   IF        WSNAR = *BLANKS
     C                   EVAL      *IN88 = *ON
     C                   END
      *
     C                   IF        WSAD1R = *BLANKS
     C                   EVAL      *IN87 = *ON
     C                   END
      *
     C                   IF        WSPNR = *BLANKS
     C                   EVAL      *IN86 = *ON
     C                   END
      *
     C                   IF        WSPSR = *BLANKS
     C                   EVAL      *IN85 = *ON
     C                   END
      *
     C                   EVAL      KLKLK = WSLKR
     C     KODTLKK       CHAIN     KODTLK                             84
      *
     C                   IF        WSEMR = *BLANKS
     C                   EVAL      *IN83 = *ON
     C                   END
      *
     C     '@'           SCAN      WSEMR         XPOS                     33
     C                   SELECT
     C                   WHEN      WSEMR = *BLANKS
     C                   EVAL      WSEMRT = '  '
     C                   WHEN      XPOS > 0
     C                   EVAL      WSEMRT = 'EM'
     C                   OTHER
     C                   EVAL      WSEMRT = 'TE'
     C                   ENDSL
      *
     C                   EXSR      HMSG3
      *
     C                   ENDSR
      *
      ***********************************************
     C     HMSG3         BEGSR
      ***********************************************
      *
     C   99              DO
     C                   MOVE      'YBC2037'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   98
     CANN30              DO
     C                   MOVE      'YBC2038'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
      *
     C   97
     CANN30              DO
     C                   MOVE      'YBC2039'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     59            POSNBR
     C                   END
      *
     C   96
     CANN30              DO
     C                   MOVE      'YBC2040'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   95
     CANN30              DO
     C                   MOVE      'YBC2125'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     62            POSNBR
     C                   END
      *
     C   94
     CANN30              DO
     C                   MOVE      'YBC2041'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C   93
     CANN30              DO
     C                   MOVE      'YBC2042'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     101           POSNBR
     C                   END
      *
     C   92
     CANN30              DO
     C                   MOVE      'YBC2043'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   91
     CANN30              DO
     C                   MOVE      'YBC2136'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   90
     CANN30              DO
     C                   MOVE      'YBC2137'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     33            POSNBR
     C                   END
      *
     C   89
     CANN30              DO
     C                   MOVE      'YBC2189'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     55            POSNBR
     C                   END
      *
     C   88
     CANN30              DO
     C                   MOVE      'YBC2138'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     63            POSNBR
     C                   END
      *
     C   87
     CANN30              DO
     C                   MOVE      'YBC2139'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C   86
     CANN30              DO
     C                   MOVE      'YBC2140'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     62            POSNBR
     C                   END
      *
     C   85
     CANN30              DO
     C                   MOVE      'YBC2141'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     72            POSNBR
     C                   END
      *
     C   84
     CANN30              DO
     C                   MOVE      'YBC2142'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     101           POSNBR
     C                   END
      *
     C   83
     CANN30              DO
     C                   MOVE      'YBC2143'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     15            POSNBR
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     OPDOPD        BEGSR
      ***********************************************
      *
     C     SADEXHL2K     CHAIN     SADEXHL2                           33
     C  N33              MOVE      'U'           XOPDEXHL2         1
     C   33              MOVE      'A'           XOPDEXHL2
      *
     C                   EXSR      TTSR
      *
      * FLYTTER SKJERMVARIABLE TIL FILVARIABLE
      *
     C                   EXSR      MOVWEX
     C                   MOVE      UAVD          XAN04             4
     C                   MOVE      UTDN          XAN07             7
      *
     C                   SELECT
     C                   WHEN      XOPDEXHL2 = 'U'
     C                   IF        UTYPE = 'CH2'
     C                   IF        EHDKH = *BLANKS
      * Uten transportDokument --> Feil HouseConsignment
     C                   EVAL      EHST = 'F'
     C                   ELSE
     C                   EVAL      EHST = ' '
     C                   END
     C                   ELSE
     C                   IF        UTYPE <> 'CR2' AND EHDKH = *BLANKS
     C                   EVAL      EHDKHT = 'N714'
     C                   EVAL      EHDKH  = %TRIM(EMRGD)
     C                             + '-' + XAN04 + '-' + XAN07
     C                   END
     C  N10              EVAL      EHST   = ' '
     C   10              EVAL      EHST   = 'F'
     C                   END
     C                   UPDATE    SADEXHFR2
     C                   WHEN      XOPDEXHL2 = 'A'
     C     'EKSPFORT'    CHAIN     TELLGE                             33
     C                   IF        *IN33 = *OFF
     C                   EVAL      UTDN = GENO
     C                   EVAL      GENO = GENO + 1
     C                   UPDATE    TELLGER
     C                   ELSE
     C                   EVAL      UTDN = 1
     C                   EVAL      GECO = 'EKSPFORT'
     C                   EVAL      GENO = 2
     C                   WRITE     TELLGER
     C                   END
     C                   EVAL      EHPRO  = UPRO
     C                   EVAL      EHAVD  = 0
     C                   EVAL      EHTDN  = UTDN
     C                   IF        UTYPE = 'CRT'
     C  N10              EVAL      EHST   = ' '
     C   10              EVAL      EHST   = 'F'
     C                   EVAL      EHDKH  = %TRIM(EMRGD)
     C                             + '-' + XAN04 + '-' + XAN07
     C                   EVAL      WSDKH  = EHDKH
     C                   EVAL      EHDKHT = 'N714'
     C                   EVAL      WSDKHT = EHDKHT
     C                   END
     C                   IF        EHDKH = *BLANKS
     C  N10              EVAL      EHST   = ' '
     C   10              EVAL      EHST   = 'F'
     C                   END
     C                   WRITE     SADEXHFR2
     C*                  IF        UTYPE = 'CRT' OR UTYPE = 'CHG'
     C*                  EXSR      SROPDITEM
     C*                  END
      *
     C                   OTHER
     C                   ENDSL
      *
     C                   IF        UTYPE = 'CRT' OR UTYPE = 'CHG'
     C                   EXSR      SROPDITEM
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     SROPDITEM     BEGSR
      ***********************************************
     C                   IF        SIST = 'T' OR SIST = 'U' OR SIST = 'P'
      *
     C     SADEXHL1K     CHAIN     SADEXIL1                           33
     C                   IF        *IN33
      * INGEN LINJE FRA FØR. OPPDATER LINJE FRA SAD-LINJE
     C                   CLEAR                   SADEXIFR
     C                   EVAL      EIPRO  = UPRO
     C                   EVAL      EIAVD  = SIAVD
S04  C*                  EVAL      EITDN  = SIOPD
N04  C                   EVAL      EITDN  = SITDN
     C                   EVAL      EILI   = 0
     C                   EVAL      EIVAL  = SIVAL3
     C     SADHK         SETLL     SADV4
     C     SADHK         READE     SADV4                                  33
     C                   DOW       *IN33 = *OFF
     C*                  IF        EILI = SVLI
     C                   IF        EILI = SVLN
     C                   EVAL      EIBL   = EIBL + SVBELT
     C                   EVAL      EICVKB = EICVKB + SVVKTB
     C                   EVAL      EICVKN = EICVKN + SVVKTN
     C                   EVAL      EINT   = EINT + SVNT01
     C                   EVAL      EINTEH = 'PK'
     C                   ELSE
     C                   IF        EILI > 0
     C                   WRITE     SADEXIFR
     C                   END
     C*                  EVAL      EILI   = SVLI
     C*                  EVAL      EILID  = SVLI
     C                   EVAL      EILI   = SVLN
     C                   EVAL      EILID  = SVLN
     C                   EVAL      EIBL   = SVBELT
     C                   EVAL      EIVT   = SVVT01
     C                   EVAL      EIVNT  = SVVNT
     C                   EVAL      EICVKB = SVVKTB
     C                   EVAL      EICVKN = SVVKTN
     C                   EVAL      EILK   = SVLK
     C                   EVAL      EIMK   = SVFT01
     C                   EVAL      EINT   = SVNT01
     C                   EVAL      EINTEH = 'PK'
     C                   END
     C     SADHK         READE     SADV4                                  33
     C                   ENDDO
      *
     C                   IF        EILI > 0
     C                   WRITE     SADEXIFR
     C                   END
      *
     C                   END
      *
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     KODTLKK       KLIST
     C                   KFLD                    KLKUNI
     C                   KFLD                    KLKLK
     C                   EVAL      KLKUNI = 'LK'
     C     STED2DK       KLIST
     C                   KFLD                    KLKLK
     C                   KFLD                    ST2KOD
     C     CUNDL01K      KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     SADEXML2K     KLIST
     C                   KFLD                    UPRO
     C     SADEXHL1K     KLIST
     C                   KFLD                    UPRO
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SADEXHL2K     KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SADHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     KOFASTK       KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C     TRKODL01K     KLIST
     C                   KFLD                    TKUNIK
     C                   KFLD                    TKKODE
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPRO              8 0
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UFLAGG            1 0
      *
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVE      'N'           USPED             1
     C                   MOVE      *ZEROS        WS0068A
      *
     C                   if        UTYPE ='CPY'
     C                   exsr      CPYHOUSE
     C                   eval      UTYPE ='CHG'
     c                   endif
     C     UTYPE         COMP      'DSP'                                  49
     C  N49UTYPE         COMP      'DS2'                                  49
      *
     C     SADEXML2K     CHAIN     SADEXML2                           33
     C     SADEXHL1K     CHAIN(N)  SADEXHL1                           33
     C   33SADEXHL2K     CHAIN(N)  SADEXHL2                           33
     C     SADHK         CHAIN     SADH                               33
     C  N33              IF        EHEID = *BLANKS OR EHETYP = *BLANKS
     C     SADHK         CHAIN     SVEH                               33
     C                   IF        *IN33 = *OFF
     C                   IF        EHETYP = *BLANKS
     C                   SELECT
     C                   WHEN      SVEH_MTYP = 'ALE'
     C                   EVAL      EHETYP = '04'
     C                   WHEN      SVEH_MTYP = 'UGE'
     C                   EVAL      EHETYP = '05'
     C                   WHEN      SVEH_MTYP = 'ECS'
     C                   EVAL      EHETYP = '06'
     C                   WHEN      SVEH_MTYP = 'UNU'
     C                   EVAL      EHETYP = '07'
     C                   ENDSL
     C                   END
     C     SVEH_TUID     CHAIN     SVZH                               33
     C  N33              EVAL      EHEID = SVZH_MRNN
     C                   END
     C                   END
      *
     C                   IF        UTYPE = 'DSP' OR UTYPE = 'CHG'
     C                             OR UTYPE = 'DS2' OR UTYPE = 'CH2'
     C                             OR UTYPE = 'PLK' OR UTYPE = 'PL2'
     C                   EXSR      MOVEXW
     C                   ELSE
     C                   EXSR      MOVSAW
     C                   END
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   WRITE     WINDOWSZ
      *
     C                   ENDSR
      *
      ***********************************************
     C     TTSR          BEGSR
      ***********************************************
     C                   EVAL      TTAVD  = UAVD
     C                   EVAL      TTOPD  = UTDN
     C                   EVAL      TTTUR  = UPRO
     C                   EVAL      TTACTI = 'EFC'
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      TTDATE        TTDATL
     C                   MOVE      TTTIME        TTTIML
     C                   MOVE      UUSR          TTUSER
     C                   IF        *IN33
     C                   EVAL      TTTEXT = 'Oppdrag er plukket til E.F. '
     C                             + 'manifest.'
     C                   EVAL      TTTEXL = 'Oppdrag er plukket til E.F. '
     C                             + 'manifest.'
     C                   EVAL      TTEDEV = 'CRT'
     C                   ELSE
     C                   EVAL      TTTEXT = 'Info. av oppdrag i E.F. manifest '
     C                             + 'er endret.'
     C                   EVAL      TTTEXL = 'Info. av oppdrag i E.F. manifest '
     C                             + 'er endret.'
     C                   EVAL      TTEDEV = 'CHG'
     C                   END
      *
     C                   WRITE     TRACKFR
     C                   ENDSR
      *
      ***********************************************
     C     CPYHOUSE      BEGSR
      ***********************************************
     C     SADEXHL2K     CHAIN(n)  SADEXHL2                           33
     c                   if        %found
      * blank statuser og LRN/MRN/ transpDocNr
     c                   eval      EHST     = *blanks
     c                   eval      EHST2    = *blanks
     c                   eval      EHST3    = *blanks
     c                   eval      EHUUID   = *blanks
     c                   eval      EHMID    = *blanks
     c                   eval      EHDKH    = *blanks
     c                   eval      EHDTS    = *zeros
     c                   eval      EHTMS    = *zeros
      *  Ved ny - avd =  0 ,  tildel nr / lagre
     C                   EVAL      EHAVD  = 0
     C     'EKSPFORT'    CHAIN     TELLGE                             33
     C                   IF        *IN33 = *OFF
     C                   EVAL      EHTDN= GENO
     C                   EVAL      GENO = GENO + 1
     C                   UPDATE    TELLGER
     C                   ELSE
     C                   EVAL      EHTDN= 1
     C                   EVAL      GECO = 'EKSPFORT'
     C                   EVAL      GENO = 2
     C                   WRITE     TELLGER
     C                   END
     c                   write     SADEXHFR2
      * kopier også første linje for å ha å jobbe med
     C     SADEXHL1K     CHAIN     SADEXIL1
     c                   if        %found
     c                   eval      EIAVD  = EHAVD
     c                   eval      EITDN  = EHTDN
     c                   WRITE     SADEXIFR
     c                   endif
      *  Key for videre arbeid
     c                   eval      UAVD   = EHAVD
     c                   eval      UTDN   = EHTDN
      *
     c                   endif
     C                   ENDSR
