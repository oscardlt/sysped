             PGM
             /*___________________*/
             /* Declare variables */
             /*"""""""""""""""""""*/
             DCL        VAR(&MBR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OK) TYPE(*LGL) LEN(1)
             DCL        VAR(&SSN) TYPE(*DEC) LEN(9 0)
             DCL        VAR(&NETW) TYPE(*CHAR) LEN(1)
             DCL        VAR(&IID) TYPE(*CHAR) LEN(35)
             DCL        VAR(&U0054) TYPE(*CHAR) LEN(3)
             DCL        VAR(&U0065) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PGM) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PGM2) TYPE(*CHAR) LEN(10)
             /*_______________________________________*/
             /* Mark messages to send with status='+' */
             /*"""""""""""""""""""""""""""""""""""""""*/
NYTTF:       CALL       PGM(E091R) PARM(&OK)
             /*_______________________________________*/
             /* NOT ALLOCATE                          */
             /*"""""""""""""""""""""""""""""""""""""""*/
             MONMSG     MSGID(CPF4128) EXEC(DO)
             DLYJOB     DLY(300)
             GOTO       CMDLBL(NYTTF)
             ENDDO
             /*____________________________________________________*/
             /* Is there anything to send ? + generate membername. */
             /*""""""""""""""""""""""""""""""""""""""""""""""""""""*/
 START:      CALL       PGM(E092R) PARM(&OK &MBR &SSN &NETW &IID +
                          &U0065 &U0054)
             IF         COND(&OK *EQ '0') THEN(GOTO CMDLBL(OK))
             GOTO       CMDLBL(END)
             /*____________________*/
             /* Create EDIfact-fil */
             /*""""""""""""""""""""*/
OK:          IF         COND(&U0065 *EQ 'IFTMBC') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E201R_))
             IF         COND(&U0065 *EQ 'IFCSUM') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E203R_))
             IF         COND(&U0065 *EQ 'IFTMCS') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E204R_))
             IF         COND(&U0065 *EQ 'INVOIC') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E205R_))
             IF         COND(&U0065 *EQ 'SLSRPT') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E206R_))
             IF         COND(&U0065 *EQ 'IFTMIN') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E207R_))
             IF         COND(&U0065 *EQ 'IFTSTA') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E208R_))
             IF         COND(&U0065 *EQ 'ORDERS') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E209R_))
             IF         COND(&U0065 *EQ 'INVRPT') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E210R_))
             IF         COND(&U0065 *EQ 'ORDRSP') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E211R_))
             IF         COND(&U0065 *EQ 'DESADV') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E212R_))
             IF         COND(&U0065 *EQ 'RECADV') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E213R_))
             IF         COND(&U0065 *EQ 'PRICAT') THEN(CHGVAR +
                          VAR(&PGM) VALUE(E214R_))
             CHGVAR     VAR(&PGM2) VALUE(&PGM *CAT &U0054)
             CALL       PGM(&PGM2) PARM(&SSN)
             GOTO       CMDLBL(START)

 END:        ENDPGM
