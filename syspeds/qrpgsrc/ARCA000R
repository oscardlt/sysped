      *********************************************************************
      * Skriv skilleark med strekkode
      *********************************************************************
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Upload også ved L1 ....
10XXX * 02 JOV PTF10 'batc forside' med kode *F*
10XXX * 03 sh  PTF10 år i strekkode
10XXX * 04 JOV PTF10 'batc forside' utvidet logikk  / cursorplasssering / feilmedling
10XXX * 05 YBC PTF10 HENT BANE FRA ARKEXT
10XXX * 06 JOV PTF10 PTF5 tilbakeført - feil
10XXX * 07 JOV PTF10 tar i bruk innparamet STRKOD for direkteutskrift (uten bilde)
10XXXA* 08 JOV PTF10 FLERE DETALJLINJER MED DIV TEKST hentet fra oppdrag/Kbilag mm..
10XXXA* 09 JOV PTF10 Blanking av DETLIN2 var glemt ved batch forside(etter PTF08)
10XXXA* 10 JOV PTF10 protecter J/N LABEL - hentes ubetinget fra fil AKTTXT
10XXXA* 11 JOV PTF10 flytter strekkode 100 px til høyre ved label
10XXXA* 12 JOV PTF10 endring av bar width/ratio mm på label (burde heller bruke CODE128??)
10XXXA* 13 JOV PTF10 Gått over til  CODE128:=)
10XXXA* 14 SH  PTF10 Kan gå som batchjobb mot tur
10XXXA* 15 SH  PTF10 Alle på gitt turnummer
10XXXA* 16 JOV PTF10 *SY* inn er variant av *L1*/ skriv fra til bilagsnr som label(KBILAGB)
      * %%%%%%%%%%%%%%
      * 17 JOV PTF11 også /SYSCA/FRBREV..   gir oppdrags-info på skillearket
      * 18 SH  PTF11 låser parameter *T til tur skilleark
      * 19 SH  PTF12 agent på skilleark
********************************************************************
n03  FFIRM      IF   E           K DISK
     FARKTXT    IF   E           K DISK
s06  F*RKEXT    IF   E           K DISK
N08  FHEADF     IF   E           K DISK
n15  FHEAD11    IF   E           K DISK
n15  F                                     RENAME(HEADFR:HEAD11r)
N08  FKOSTA     IF   E           K DISK
N08  FLEVEL01   IF   E           K DISK
s14  F*RCA000D  CF   E             WORKSTN
n14  FARCA000D  CF   E             WORKSTN USROPN
N04  F                                     INFDS(FBAREA)
     FARCA000P  O    E             PRINTER
     FZBARC     O    F   66        PRINTER
n04  D FBAREA          DS
      * CURSOR LOKASJON på skjermen totalt
n04  D  WSCLOC               370    371B 0
n04  D  WSSUBN               378    379B 0
      * CURSOR LOKASJON AV AKTIV VINDU
     D  WSCLOW               382    383B 0
     D                 DS
     D  DATA                   1     66
     D  DATA1                  4     66
     D  DATA3                  1      3
     D  TG2                    6     14
     D                 DS
     D  avdopd                 1     11
     D  heavd                  1      4  0
     D  heopd                  5     11  0
     D                 DS            34
     D DFLT            C                   CONST('^XA^LH50,00^CI4-
     D                                     ^FWN^LRY^PR4^MSY^XZ')
     D                 DS
     D  ARTXT                  1     15
     D  ARTXT1_7               1      7                                         *SPLIT*
N02  D  ARTXT1_3               1      3                                         *F*
     D                 DS
     D  WSBAR                  1     22
     D  BAR                    1     22
     D                                     DIM(22)
     D  WSBAR07                1     07
     D  WSBAR08                1     08
     D  WSBAR09                1     09
     D  WSBAR10                1     10
     D  WSBAR11                1     11
     D  WSBAR12                1     12
     D  WSBAR13                1     13
     D  WSBAR14                1     14
     D  WSBAR15                1     15
     D  WSBAR16                1     16
     D  WSBAR17                1     17
     D  WSBAR18                1     18
     D  WSBAR19                1     19
     D  WSBAR20                1     20
     D  WSBAR21                1     21
     D  WSBAR22                1     22
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D  xDATO                  7     14  0
      *
     D                UDS
     D  UFIRM                  3      4
      *
     C                   EXSR      INIT
      *
N07  c     Direkte       ifeq      'J'
N07  c     TYPE          andne     '  '
N07  c     TYPE          andne     'Z '
N07  c                   goto      Dirtag
N07  c                   endif
      *
     c     start         tag
     c                   move      *OFF          *in55
     C     Type          Chain     arktxt                             33
     c     *in33         IFeq      *OFF
S10  c*    ARSLAB        IFNE      ' '
     c                   move      ARSLAB        LABEL
S10  c*                  end
      * max 4 lang avvikende fr.brevsmapp (4 bak FRBREV....)
N04  c     ARTXT1_3      ifeq      '*F*'
N04  c                   move      string        TST16            16
N04  c     TST16         ifne      *blanks
N04  c                   move      *blanks       String
N04  c                   z-add     4             LinNbr
N04  c                   z-add     9             PosNbr
N04  c                   end
N04  c                   end
     c                   movel     ARSBAN        SCABAN
     c     SCABAN        comp      *blanks                            5555
     c                   end
      **
     C                   EXFMT     WINDOW
N07  c     Dirtag        tag
     C                   setoff                                       30
n04  C     WSCLOW        DIV       256           LINNBR
n04  C                   MVR                     POSNBR
      * avbryt
     C     *IN12         CABEQ     '1'           Slutt                            B2
     c
     c     *in02         IFEQ      '1'
     c                   eval      PrtSki = '*BYTT*'
     c                   eval      PrtLab = '*BYTT*'
     c                   goto      Slutt
     c                   end
      * søk type
     c     *in04         IFEQ      '1'
N04  c     LinNbr        Ifne      4
n18  c     uutype        ifne      *blanks
n18  c                   move      uutype        type
n18  c                   end
     c                   CALL      'ARCA000B'
     C                   PARM                    TYPE
N04  c                   else
N04   * avvikende type til *F* batchforside.
N04  C                   Movel     'Z '          AVTYPE            2
N04  c                   CALL      'ARCA000B'
N04  C                   PARM                    AVTYPE
N04  c                   eval      string = AVtype
N04  c                   end
N04  c                   z-add     3             LinNbr
N04  c                   z-add     9             PosNbr
     c                   goto      start
     c                   end
      * L1 - test frabilagsnr før upload..
     c     *in50         ifeq      *ON
     c     frabnr        comp      *zeros                                 30
s04  c*    *in30         cabeq     *on           start
N04  c     *in30         ifeq      *on
N04  C                   MOVE      'JOV1508'     MSGNR
N04  c                   z-add     4             LinNbr
N04  c                   z-add     16            PosNbr
N04  c                   goto      start
N04  c                   end
     c                   clear                   string
n03  c                   movel     aar           string
n03  c                   move      frabnr        frabnra           7
n03  C     string        cat       frabnra:0     string
s03  c*                  movel     FRABNR        STRING
     c                   end
      * Upload  (det MÅ da være BANE knyttet til typen)
     c     *in10         IFEQ      '1'
     c     *in55         ifeq      *off
     C     Type          Chain     arktxt                             33
     c  n33              movel     ARSBAN        SCABAN
s06  C* N33              IF        ((ARSBAN = *BLANKS) AND (ARKLAG <> *BLANKS))
s06  C*    ARKEXTK       CHAIN     ARKEXT                             33
s06  c* N33              EVAL      SCABAN = '/' + ARCANE
s06  C*                  END
     c     SCABAN        comp      *blanks                                30
s04  c*    *in30         cabeq     *on           start
N04  c     *in30         ifeq      *on
N04  C                   MOVE      'JOV1509'     MSGNR
N04  c                   z-add     6             LinNbr
N04  c                   z-add     2             PosNbr
N04  c                   goto      start
N04  c                   end
     c                   end
     c                   exsr      Upload
     c                   goto      slutt
     c                   end
      *
     C     Type          Chain     arktxt                             30
s04  C*    *IN30         CABEQ     '1'           Start                            B2
N04  c     *in30         ifeq      *on
N04  C                   MOVE      'JOV1510'     MSGNR
N04  c                   z-add     3             LinNbr
N04  c                   z-add     9             PosNbr
N04  c                   goto      start
N04  c                   end
N08  c                   movel     ARSBAN        SCABAN
N10  c                   move      ARSLAB        LABEL
      *
     C                   TIME                    XULTID
     C                   MOVE      XDATO         DATO
     C                   MOVE      XULTM         TID
      * differensiert header - forklarende tekst på akillearket
     c                   eval      OVERSK =' STREKKODE SKILLEARK'
     c                   eval      DETLIN1='Skillearket skal plasseres FORAN '
     c                             +'det (de) dokument'
     c                   eval      DETLIN2='som skal inngå i aktuell referanse'
N07  c     SCABAN        ifne      *blanks
N07  c                   exsr      FixDetSR
N07  c                   endif
     c*
     c     ARTXT1_7      ifeq      '*SPLIT*'
N09  c                   eval      DETLIN2=' '
     c                   eval      OVERSK =' SCAN BATCH FORSIDE '
     c                   eval      DETLIN1='Forside med kode *SPLIT* = '
     c                             +'Resten av batchen splittes pr side.'
E08  c                   eval      DETLIN3='Resultatet plasseres i "annet-map'
     c                             +'pen" for manuell/webbasert match.'
E08  c                   eval      DETLIN5='OBS! Strekkoder på de følgende '
     c                             +'sider ignoreres totalt! '
     c                   end
N02  c     ARTXT1_3      ifeq      '*F*'
N09  c                   eval      DETLIN2=' '
N02  c                   eval      OVERSK =' SCAN BATCH FORSIDE '
N02  c                   eval      DETLIN1='Forside med kode *F*.... = '
N02  c                             +'Resten av batchen splittes pr side.'
e08  c                   eval      DETLIN3='Resultatet plasseres i "fraktbrev'
N02  c                             +'smappe" med tillegg .... (bak *F*).'
e08  c                   eval      DETLIN5='Benyttes når kvittert brev skannes'
N02  c                             +' flere steder (Hent, Term.  mm)'
N04   * 2 første i string MÅ være en gyldig arkivkode DER TEKST STARTER MED "*Fr..... " (el POD)
N04  C     String        ifeq      'POD'
N04  c                   eval      ARTXT = 'POD fraktbrev'
N04  c                   else
N04  c                   movel     string        string1_2         2
N04  C     String1_2     Chain     arktxt                             30
N04  C  N30ARTXT1_3      comp      '*Fr'                              3030
N04  c     *in30         ifeq      *on
N04  C                   MOVE      'JOV1511'     MSGNR
N04  c                   z-add     4             LinNbr
N04  c                   z-add     9             PosNbr
N04  c                   goto      start
N04  c                   end
N04  c                   move      ARTXT         tmpARTXT         15
N04  C     Type          Chain     arktxt                             30
N04  c                   move      tmpARTXT      ARTXT
N04  c                   end
N04  c                   Move      'J'           FBavvik           1
N02  c                   end
     c*
      * Fra-til L1-bilagsnr...
     c     L1Tag         tag
     c     *in50         ifeq      *ON
n03  c                   clear                   string
n03  c                   movel     aar           string
n03  c                   move      frabnr        frabnra           7
n03  C     string        cat       frabnra:0     string
s03  c*                  movel     FRABNR        STRING
     c                   end
      *
     c                   eval      WSBAR = type+%trim(String)
      * label.
     c     LABEL         ifeq      'J'
n15  C     alle          ifne      'J'
     c                   exsr      srLabel
n15  c                   else
n15  c                   exsr      srlabel0
n15  c                   end
     c                   else
     c* skilleark (eller frontpage med behandlingsinstruks..)
     c     ARTXT1_7      ifeq      '*SPLIT*'
     c                   eval      WSBAR = '*SPLIT*'
     c                   end
n02  c*    ARTXT1_3      ifeq      '*F*'
n02  c     FBavvik       ifeq      'J'
n02  c                   eval      WSBAR = '*F*'+String
n02  c                   end
n15  c     alle          ifne      'J'
TMP   * hex 8F for å få FNC1 ..
TMP  c*                  eval      wsbar=X'8F'+%trim(WSBAR)
TMP   *
     c                   exsr      TrimBar
     C                   Write     SkilleArk
n15  c                   else
n15  c                   exsr      allesr
n15  c                   end
     c                   end
      * Fra-til L1-bilagsnr...
     c     *in50         ifeq      *ON
     c     TILBNR        ifeq      *zeros
     c                   move      FRABNR        TILBNR
     c                   end
     c     FRABNR        iflt      TILBNR
     c                   add       1             FRABNR
     c                   goto      L1TAG
     c                   end
     c                   end
      *
     C     Slutt         tag
N14  C     direkte       ifne      'J'
N14  C                   close     arca000d
n14  C                   end
     C                   EVAL      *inlr = *on
     C                   RETURN
     C***********************************************
     C     Upload        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Laste opp dokument til SYSPED "ar'
     C                             +'kivagent" (1-3 min/ferdig arkivert)'
     C                   EVAL      WebType = 'ESPEA'
     c                   eval      WSBAR = type+%trim(String)
     C                   EVAL      WebSok  = '&dok='+%trim(WSBAR)+
     C                             '&bane='+%trim(SCABAN)
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C                   ENDSR
      *************************************************************
     C     TrimBAR       BEGSR
      *************************************************************
     C*  BLANKE BAK I ET FELT SOM SKRIVES SOM AFP/PDF-BARKODE BLIR MED I BARCODEN
     C*  FINNES SIKKERT MER ELEGANTE MÅTER MEN DETTE DUGER....
      * FORVENTER LENGDE MELLOM 7 OG 22
      *  ind *67=7 lang, *in68=8l ang, 69=9 lang, *in70=10     ..... .... 82=22 lang
     c                   movea     '0000'        *in(67)
     c                   movea     '0000000000'  *in(71)
     c                   movea     '00'          *in(81)
     c                   z-add     8             NB                2 0          teller første blank
     c                   z-add     67            NI                2 0          teller indikator
     c     BAR(NB)       Downe     ' '
     c                   add       1             NB
     c                   add       1             NI
     c     NB            cabeq     22            UtBar
     C                   end
     c     Utbar         tag
     c                   move      *on           *in(NI)
     C                   endsr
N08   *************************************************************
N08  C     FixDetSR      BEGSR
N08   *************************************************************
N08  c                   clear                   DetLin3
N08  c                   clear                   DetLin4
N08  c                   clear                   DetLin5
N08  c                   clear                   DetLin6
N08  c                   clear                   DetLin7
N08  c                   clear                   DetLin8
N08  c                   clear                   DetLin9
N08  c                   clear                   DetLin10
N08   * Tekst utfra Type
N08   *
N08   */OPPDRAG
N08  C     '/OPPDRAG'    scan      SCABAN                                 35
N17  C  N35'/FRBREV'     scan      SCABAN                                 35
N08  C     *in35         ifeq      *on
N08  C                   eval      DetLin4 ='SKANN BASERT PÅ OPPDRAG.  '
N08  C                             +'Avd/Oppdr:'
N09  c                   movel     STRING        TMP11            11
N08  C                   movel     TMP11         HEAVDA            4
N08  C                   move      TMP11         HEOPDA            7
N08  C                   TESTN                   TMP11                36
N08  C     *in36         ifeq      *off
N08  C                   eval      DetLin4 =%trim(DetLin4)+' '
N08  C                             +HEAVDA+'/'+ HEOPDA
N08  C                   else
N08  C                   move      HEAVDA        HEAVD
N08  C                   move      HEOPDA        HEOPD
N08  C                   eval      DetLin4 =%trim(DetLin4)+' '
N08  C                             +%trim(%editc(HEAVD:'Z'))+'/'
N08  C                             +%trim(%editc(HEOPD:'Z'))
N08  c     HeaKey        chain     Headf                              33
N08  c     *in33         cabeq     '1'           UtFixDet
N08   * Oppdrag funnet - linjer 5-10 tilgjengelige for mer tekst
N08  C                   eval      DetLin4 =%trim(DetLin4)
N08  C                             +'  Turnr: '+%trim(%editc(HEPRO:'Z'))
N08  C                   eval      DetLin5 ='Avsender: ' + %trim(HENAS)
N08  c                             +',  ' + %trim(HEADS3)
N08  C                   eval      DetLin6 ='Mottaker: ' + %trim(HENAK)
N08  c                             +',  ' + %trim(HEADK3)
N08  C                   eval      DetLin7 ='A.ref/K.ref: ' + %trim(HERFA)
N08  C                   eval      DetLin8 ='Ant: ' + %trim(%editc(HENT:'Z'))
N08  c                             +'  ' + %trim(HEVS1) + '  Vekt: '
N08  c                             +%trim(%editc(HEVKT:'Z'))+' kg'
N19  c     henaa         ifne      *blanks
N19  C                   eval      DetLin10 ='Agent: ' + %trim(HENAA)
N19  c                   end
N08  C                   endif
N08   *
N08  C                   goto      UtFixDet
N08  C                   endif
N08   *
N08   *
N08   */KBILAG
N08  C     '/KBILAG '    scan      SCABAN                                 35
N08  C     *in35         ifeq      *on
N08  C                   eval      DetLin4 ='SKANN BASERT PÅ '
N08  C                             +'KOSTNADSBILAG.  Løpenr: '
N09  c                   movel     STRING        TMP7              7
N08  C                   TESTN                   TMP7                 36
N08  C     *in36         ifeq      *off
N08  C                   eval      DetLin4 =%trim(DetLin4)
N08  C                             +TMP7
N08  C                   else
N08  C                   move      TMP7          KABNR
N08  C                   eval      DetLin4 =%trim(DetLin4)
N08  C                             +%trim(%editc(KABNR:'Z'))
N08  c     KABNR         chain     KOSTA                              33
N08  c     *in33         cabeq     '1'           UtFixDet
N08   * Kbilag funnet  - linjer 5-10 tilgjengelige for mer tekst
N08  c     LevKey        chain     LEVEL01                            33
N08  c   33              move      *blanks       LNAVN
N08  C                   eval      DetLin4 =%trim(DetLin4)
N08  C                             +'  Bilagsnr: '+%trim(%editc(KABNR2:'Z'))
N08  C                   eval      DetLin5 ='Bilagsdato: '
N08  C                             +%trim(%editw(KABDT:'    .  .  '))
N08  C                             +'  Forf.: '
N08  C                             +%trim(%editw(KAFFDT:'    .  .  '))
N08  C                             +'  Fakturanr: ' + KAFNR
N08  C                   eval      DetLin6 ='Leverandør: '
N08  C                             +%trim(%editc(KALNR:'Z'))+' '+LNAVN
N08  C                   eval      DetLin7 ='Valuta: ' + (KAVAL)+'  Beløp:  '
N08  c                             +%trim(%editc(KABL:'J'))
N08  C                   eval      DetLin9 ='Attestasjonskode: '+KASG
N08  C                   endif
N08   *
N08  C                   goto      UtFixDet
N08  C                   endif
N08   *
N08   *
N08   *
N08  C     UtFixDet      endsr
      *=====================================================================******
      *  INITIER
      *=====================================================================******
     C     INIT          BEGSR
N06  C*    ARKEXTK       KLIST
N06  C*                  KFLD                    FIFIRM
N06  C*                  KFLD                    ARKLAG
     C     *entry        PLIST
     C                   PARM                    Type              2
     C                   PARM                    String           20
     C                   PARM                    StrKod            5
     C                   PARM                    PrtSki           10
     C                   PARM                    PrtLab           10
      *
      *
N08  C     HeaKey        KLIST
N08  C                   KFLD                    HEAVD
N08  C                   KFLD                    HEOPD
      *
N08  C     LevKey        KLIST
N08  C                   KFLD                    FIFIRM
N08  C                   KFLD                    KALNR
      *
N07  C     StrKod        ifeq      '*DIR*'
N07  c                   move      'J'           DIREKTE           1
N07  c                   move      *blanks       StrKod
N14  c                   else
N14  C                   open      arca000d
N07  c                   endif
     c                   movel     PrtSki        WSPRTS
     c                   movel     PrtLab        WSPRTL
      * Foreslå dft 'Z ' - ved søk kommer en da rett på...
n18  c                   move      type          uutype            2
N07  c     Type          ifeq      *blanks
N18  c     Type          oreq      '*T'
     C                   MOVE      'Z '          Type
N07  c                   endif
N04  C                   Z-ADD     3             LINNBR
N04  C                   Z-ADD     10            POSNBR
     C     STRING        IFEQ      '*L1*'
N16  C     STRING        OREQ      '*SY*'
     C                   MOVE      *ON           *IN50
N16  C     STRING        IFEQ      '*L1*'
     C                   MOVE      *BLANKS       STRING
     C                   MOVE      'ZB'          Type
     C                   MOVE      'J'           LABEL
N16  C                   else
N16  C                   MOVE      *ON           *IN51
N16  C                   MOVE      *BLANKS       STRING
N16  C                   MOVE      'ZU'          Type
N16  C                   MOVE      'J'           LABEL
N16  C                   endif
     C                   END
      *
      *
n03  c     *loval        setll     FIRM
n03  c                   read      FIRM
n03  c                   z-add     uyear         aar
      *
     C                   ENDSR
      *
      ********************************************************************
     C     SRLABEL       BEGSR
      ********************************************************************
      * Send Default Instructions
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     DFLT          DATA
     C                   EXCEPT    ZBARCA
      * Start of Text bit (^XA)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^XA'         DATA
     C                   EXCEPT    ZBARCA
      * HVis L1 - ledetekst
     C     *in50         ifeq      *on
      * Ledetekst - 'L1 Bilag. Firma:'
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FO'         DATA
e11  C                   MOVEL     '150,50'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^AD'         DATA
     C                   MOVEL     ',15,12'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FD'         DATA
     C                   eval      DATA1='L1 Bil.nr. Firma:'
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FS'         DATA
     C                   EXCEPT    ZBARCA
      * firmakode
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FO'         DATA
e11  C                   MOVEL     '370,38'      DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^AD'         DATA
     C                   MOVEL     ',30,25'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FD'         DATA
     C                   MOVEL     UFIRM         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FS'         DATA
     C                   EXCEPT    ZBARCA
     c                   endif
      * STREKKODEN.
      * DATA POSITION
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FO'         DATA
e11  C*                  MOVEL     '130,70'      DATA1
n12  C                   MOVEL     '110,70'      DATA1
     C                   EXCEPT    ZBARCA
      * FONT (SELECTING BARCODE FIELD DEFAULT) width,ratio, hight
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^BY'         DATA
     C*                  MOVEL     '2.5,2:1,15'  DATA1
s12  C*                  MOVEL     '2,4:1,15'    DATA1
n12  C*                  MOVEL     '3,2:1,15'    DATA1
n13  C                   MOVEL     '2.5,2:1,15'  DATA1
     C                   EXCEPT    ZBARCA
s13   * FONT  (B3 = CODE 39)
s13  C*                  MOVE      *BLANKS       DATA
s13  C*                  MOVEL     '^B3'         DATA
s13  C*                  MOVEL     'N,N,80,'     DATA1
s13  C*                  CAT       'N':0         DATA1
N13   * FONT  (BC = gs1/ean 128)
N13  C                   MOVE      *BLANKS       DATA
N13  C                   MOVEL     '^BC'         DATA
N13  C                   MOVEL     'N,80,N,'     DATA1
N13  C                   CAT       'N,N,N':0     DATA1
N13  C                   EXCEPT    ZBARCA
      * TEXT TO BE PRINTED AS BARCODE
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FD'         DATA
     C                   MOVEL     WSBAR         DATA1
     C                   EXCEPT    ZBARCA
      * FIELD SEPARATOR INSTRUCTION (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FS'         DATA
     C                   EXCEPT    ZBARCA
      * Skrive "human readable" manuelt for å få større font
      * Data Position
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FO'         DATA
e11  C                   MOVEL     '150,155'     DATA1
     C                   EXCEPT    ZBARCA
      * Font
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^AD'         DATA
     C                   MOVEL     ',25,20'      DATA1
     C                   EXCEPT    ZBARCA
      * Text to be printed
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FD'         DATA
     C                   MOVEL     WSBAR         DATA1
     C                   EXCEPT    ZBARCA
      * Field Separator instruction (^FS)
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^FS'         DATA
     C                   EXCEPT    ZBARCA
      ***
      * END
     C                   MOVE      *BLANKS       DATA
     C                   MOVEL     '^XZ'         DATA
     C                   EXCEPT    ZBARCA
      *
     C                   ENDSR
      *
n15  C***********************************************
n15  C     allesr        BEGSR
n15  C***********************************************
n15  c     turkey        klist
n15  c                   kfld                    hepro
n15  c                   setoff                                       32
n15  c                   movel     string        hepro
n15  c     turkey        setll     head11
n15  c     *in32         doweq     '0'
n15  c     turkey        reade     head11                                 32
n15  c     *in32         ifeq      '0'
n15  c     hest          andne     'D'
n15  c                   eval      string=avdopd
n15  c                   eval      wsbar=avdopd
n15  c                   exsr      fixdetsr
n15  c                   exsr      TrimBar
n15  C                   Write     SkilleArk
n15  c                   end
n15  c                   end
n15  c                   endsr
n15  C***********************************************
n15  C     srlabel0      BEGSR
n15  C***********************************************
n15  c                   setoff                                       32
n15  c                   movel     string        hepro
n15  c     turkey        setll     head11
n15  c     *in32         doweq     '0'
n15  c     turkey        reade     head11                                 32
n15  c     *in32         ifeq      '0'
n15  c     hest          andne     'D'
n15  c                   eval      wsbar=avdopd
n15  c                   exsr      srlabel
n15  c                   end
n15  c                   end
n15  c                   endsr
     OZBARC     E            ZBARCA
     O                       DATA
