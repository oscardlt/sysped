      *
      ***********************************************************
      *** PROGRAM SKAL SKRIVE UT BILL OF LADIND (LOKAL)       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 02-26                            ***
      *** LEDIGE INDIKATORER 27-31 35-59 63-95 98 99          ***
      ***********************************************************
      *
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FBOOKING   UF   E           K DISK
     FBLLOK     IF   E           K DISK
     FBLV1LF    IF   E           K DISK
     FBLV2LF    IF   E           K DISK
     FBLVSD2    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCDBLF     IF   E           K DISK
     FCDBLFLF   IF   E           K DISK
     F                                     RENAME(CDBLFR:CDBLFRL)
     FCDBLF2    IF   E           K DISK
     FKODTP     IF   E           K DISK
     FSYSJ15P   O    E             PRINTER USROPN
     FSYSJ15P2  O    E             PRINTER OFLIND(*IN01)
     D AN              S              1    DIM(10)
     D MN              S             17    DIM(100)
     D FT              S             51    DIM(100)
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(SYSJ15P) -
     D                                     OUTQ(')
     D XCMD12          C                   CONST(') PAGESIZE(72 120) -
     D                                     CPI(15) OVRFLW(72) -
     D                                     FORMTYPE(')
     D XCMD13          C                   CONST(') SECURE(*YES)')
     D XCMD21          C                   CONST('OVRPRTF -
     D                                     FILE(SYSJ15P) -
     D                                     OUTQ(')
     D XCMD22          C                   CONST(') PAGESIZE(72 120) -
     D                                     CPI(15) OVRFLW(72) -
     D                                     DRAWER(')
     D XCMD23          C                   CONST(') FORMTYPE(')
     D XCMD24          C                   CONST(') COPIES(')
     D XCMD25          C                   CONST(') SECURE(*YES)')
     D                 DS
     D  BOAVD                  1      4  0
     D  BLAVD                  1      4  0
     D                 DS
     D  BOOPD                  1      7  0
     D  BLOPD                  1      7  0
     D                 DS
     D  BOSG                   1      3
     D  BLSG                   1      3
     D                 DS
     D  BOREIS                 1     14
     D  BLREIS                 1     14
     D                 DS
     D  AA                     1    150
     D                                     DIM(150)
     D  AA120                  1    120
     D                 DS
     D  CFLIN                  1      2  0
     D  VL                     1      2  0
     D                 DS
     D  CFCOL                  1      3  0
     D  VK                     1      3  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     C*
     C                   EXSR      INIT
     C*
     C* SKRIV TIL PRINTER
     C*
     C     BLLOKK        SETLL     BLLOK
     C     START         TAG
     C     UAVD          READE     BLLOK                                  60
     C  N60BEOPD         IFGT      UOPDT
     C                   GOTO      SLUTT
     C                   END
     C  N60BOOKK         CHAIN     BOOKING                            33
     C  N60
     CAN 33              GOTO      START
     C  N60              EXCEPT    BODUM
     C  N60BOST          IFNE      ' '
     C     UOPDF         ANDNE     UOPDT
     C                   GOTO      START
     C                   END
     C  N60USG           IFNE      BOSG
     C     USG           ANDNE     'ALL'
     C     UOPDF         ANDNE     UOPDT
     C                   GOTO      START
     C                   END
     C  N60              DO
     C                   EXSR      LESANT
     C                   EXSR      PRINT
     C     BOOKK         CHAIN     BOOKING                            33
     C  N33              DO
     C                   MOVE      'P'           BOST
     C                   MOVE      XIDAG         BODTB
     C                   EXCEPT    BOMRK
     C                   END
     C                   GOTO      START
     C                   END
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     LESANT        BEGSR
     C******************************************
     C                   MOVE      'J'           XSTYGD            1
     C                   Z-ADD     0             XSUMNT            5 0
     C                   Z-ADD     0             YLI
     C                   Z-ADD     0             YSORT
     C     BLV1K         SETLL     BLV1LF
     C                   SETOFF                                       33
     C     STLA1         TAG
     C     BLVKEY        READE     BLV1LF                                 33
     C  N33BVKDC         IFNE      *BLANKS
     C                   MOVE      'N'           XSTYGD
     C                   END
     C  N33              ADD       BVNT          XSUMNT
     C  N33              GOTO      STLA1
     C*
     C                   Z-ADD     0             XLI               3 0
     C                   Z-ADD     5             XLI2              1 0
     C                   Z-ADD     0             XLI1              3 0
     C                   Z-ADD     5             XLI21             1 0
     C                   Z-ADD     0             XN                3 0
     C                   Z-ADD     0             XN2               3 0
     C                   MOVE      *BLANKS       MN
     C                   MOVE      *BLANKS       FT
     C     BLV2K         SETLL     BLV2LF
     C                   SETOFF                                       33
     C     STLA2         TAG
     C     BLVKEY        READE     BLV2LF                                 33
     C  N33BVMN          IFNE      *BLANKS                                      1<-B
     C     BVLI          IFNE      XLI1                                          2<-B
     C     XLI21         DOWLE     4                                              3<-B
     C                   ADD       1             XN
     C                   ADD       1             XLI21
     C                   END                                                      3<-E
     C                   MOVE      BVLI          XLI1
     C                   MOVE      BVLI2         XLI21
     C                   END                                                     2<-E
     C     XLI21         DOWLT     BVLI2                                         2<-B
     C                   ADD       1             XN
     C                   ADD       1             XLI21
     C                   END                                                     2<-E
     C                   ADD       1             XLI21
     C                   ADD       1             XN
     C                   MOVE      BVMN          MN(XN)
     C                   END
     C  N33BVKD          IFNE      ' '                                           2<-B
     C     BVKD          ANDNE     'Z'
     C     BVKD          ANDNE     'N'
     C     BVKD          ANDNE     'B'
     C                   GOTO      STLA2
     C                   END                                                     2<-E
     C  N33              DO
     C     XLI           IFNE      BVLI
     C     XLI2          DOWLE     4
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   END
     C                   MOVE      BVLI          XLI
     C                   MOVE      BVLI2         XLI2
     C                   END
     C     XLI2          DOWLT     BVLI2
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   END
     C                   ADD       1             XN2
     C                   ADD       1             XLI2
     C                   MOVE      BVFT          FT(XN2)
     C                   GOTO      STLA2
     C                   END
     C*
     C     XN            IFLT      XN2
     C                   MOVE      XN2           XN
     C                   END
     C                   Z-ADD     1             XN2
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OVRPRT        BEGSR
     C***********************************************
     C     CF2PRT        IFEQ      *BLANKS
     C     UPRT26        ORNE      *BLANKS
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       KOPNVN:0      UCMD
     C                   CAT       XCMD12:0      UCMD
     C                   CAT       KOPTY:0       UCMD
     C                   CAT       XCMD13:0      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ELSE
     C                   MOVE      *BLANKS       UCMD
     C     XCMD21        CAT       CF2PRT:0      UCMD
     C                   CAT       XCMD22:0      UCMD
     C                   CAT       CF2SKF:0      UCMD
     C                   CAT       XCMD23:0      UCMD
     C                   CAT       CF2KDP:0      UCMD
     C                   CAT       XCMD24:0      UCMD
     C                   CAT       CF2ANT:0      UCMD
     C                   CAT       XCMD25:0      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   END
      *
     C                   ENDSR
     C*
     C******************************************
     C     PRINT         BEGSR
     C******************************************
     C*                    WRITELINJE1
     C     CDBLFK        CHAIN     CDBLF                              33
     C   33              MOVE      'STAND'       BEKDP
     C   33CDBLFK        CHAIN     CDBLF                              33
     C                   MOVE      CFCOL         XANTL             3 0
     C     BEKDP         CHAIN     CDBLF2                             33
     C                   EXSR      OVRPRT
     C                   OPEN      SYSJ15P
     C*
     C                   SETOFF                                       6297
     C     STP11         TAG
     C                   Z-ADD     1             YLIN
     C                   WRITE     LINJE1
     C                   MOVE      *BLANKS       AA
     C                   SETOFF                                       61
     C     CDBLK2        SETLL     CDBLFLF
     C     STP12         TAG
     C     BEKDP         READE     CDBLFLF                                61
     C*
     C* CFFNR (FELTNR.) > 500  BETYR FELTET TILHØRER LOKAL-B/L
     C   61              Z-ADD     71            CFLIN
     C     YLIN          DOWLT     CFLIN
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             YLIN
     C                   END
     C*
     C   61
     CAN 62CDBLFK        CHAIN     CDBLF                              33
     C   61
     CAN 62              GOTO      STP11
     C*
     C* CFFNR < 201 BETYR FELTET TILHØRER LOKAL-B/L
     C  N61CFFNR         IFLT      201
     C                   EXSR      PRINT2
     C                   ELSE
     C*
     C* 201 <= CFFNR < 301  BETYR FELTET TILHØRER VARELINJE (CMD-10/11)
     C     CFFNR         IFLT      300
     C                   EXSR      PRINT3
     C                   ELSE
     C* 301 <= CFFNR < 600  BETYR FELTET TILHØRER LOKAL-B/L
     C                   EXSR      PRINT2
     C                   END
     C                   END
     C  N61              GOTO      STP12
     C*
     C                   EXSR      UTSID2
     C*
     C                   CLOSE     SYSJ15P
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT2        BEGSR
     C******************************************
     C     CFFNR         IFEQ      1
     C                   MOVE      BEAVD         X4                4
     C                   MOVEA     X4            AN(1)
     C                   Z-ADD     4             AT                1 0
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      2
     C                   MOVE      BEOPD         X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      3
     C                   MOVEA     BOSG          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      4
     C                   MOVE      BOKNR         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      5
     C                   MOVE      BOKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     KNAVN         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      6
     C                   MOVE      BOKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     ADR1          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      7
     C                   MOVE      BOKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVEA     ADR2          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      8
     C                   MOVE      BOKNR         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              MOVE      *BLANKS       XADR3            30
     C  N33POSTNR        IFEQ      0
     C                   MOVEL     ADR3          XADR3
     C                   ELSE
     C                   MOVEL     POSTNR        XADR3
     C                   MOVE      ADR3          XADR3
     C                   END
     C  N33              MOVEA     XADR3         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      9
     C     BOOB          CHAIN     CDBOAT                             33
     C  N33              MOVEA     CBNAB         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      10
     C                   MOVEA     BOREIS        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      11
     C                   MOVEA     BEBLNR        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      12
     C                   MOVE      BOUKE         X2                2
     C                   MOVEA     X2            AN(1)
     C                   Z-ADD     2             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      13
     C                   MOVE      BOAAR         X2                2
     C                   MOVEA     X2            AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      14
     C                   MOVE      BEKNA         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      15
     C                   MOVEA     BENAA         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      16
     C                   MOVEA     BEAD1A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      17
     C                   MOVEA     BEAD2A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      18
     C                   MOVEA     BEAD3A        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      20
     C                   MOVE      BEKNM         X8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      21
     C                   MOVEA     BENAM         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      22
     C                   MOVEA     BEAD1M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      23
     C                   MOVEA     BEAD2M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      24
     C                   MOVEA     BEAD3M        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      26
     C                   MOVE      BEKNN         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      27
     C                   MOVEA     BENAN         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      28
     C                   MOVEA     BEAD1N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      29
     C                   MOVEA     BEAD2N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      30
     C                   MOVEA     BEAD3N        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      32
     C     BOLSS         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOLSS         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      34
     C     BOLSH         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOLSH         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      35
     C     BOLB          CHAIN     CDBOAT                             33
     C  N33              MOVEA     CBNAB         AA(VK)
     C   33              MOVEA     BOLB          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      36
     C     BOVH          CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOVH          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      37
     C     BOLOH         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOLOH         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      38
     C     BOLOS         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOLOS         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      40
     C                   MOVE      BODT1         UDT               6 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          X2                2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT2          X2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT1          X2
     C                   MOVEA     X2            AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      41
     C                   MOVEA     BOMM          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      42
     C                   MOVE      BOPRO         X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      43
     C                   MOVE      BOKNDA        X8                8
     C                   MOVEA     X8            AN(1)
     C                   Z-ADD     8             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      44
     C                   MOVEA     BONADA        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      63
     C     BEKDCP        IFEQ      'C'
     C                   MOVEA     XDEST         AA(VK)
     C                   ELSE
     C                   MOVEA     XPREP         AA(VK)
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      64
     C                   MOVEA     BENTBS        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      65
     C     BESD          CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      66
     C     FIDTFM        IFEQ      1
     C                   EXSR      MOVDAG
     C                   EXSR      MOVMND
     C                   EXSR      MOVÅR
     C                   ELSE
     C     FIDTFM        IFEQ      2
     C                   EXSR      MOVMND
     C                   EXSR      MOVDAG
     C                   EXSR      MOVÅR
     C                   ELSE
     C                   EXSR      MOVÅR
     C                   EXSR      MOVMND
     C                   EXSR      MOVDAG
     C                   END
     C                   END
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      379
     C     XSTYGD        ANDEQ     'N'                                          CONTAINER
     C                   MOVE      XSUMNT        X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      380
     C     XSTYGD        ANDEQ     'J'                                          STYKKGODS
     C                   MOVE      XSUMNT        X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      481
     C                   MOVEA     CF2FT1        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      482
     C                   MOVEA     CF2FT2        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      483
     C                   MOVEA     CF2FT3        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      484
     C                   MOVEA     CF2FT4        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      485
     C                   MOVEA     CF2FT5        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      486
     C                   MOVEA     CF2FT6        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      487
     C                   MOVEA     CF2FT7        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      488
     C                   MOVEA     CF2FT8        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      489
     C                   MOVEA     CF2FT9        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      591
     C                   MOVEA     BEFT          AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      592
     C                   MOVEA     BEKDSA        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      593
     C                   MOVEA     BEKDRA        AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     CFFNR         IFEQ      594
     C                   MOVEA     BEKDTF        AA(VK)
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      595
     C                   MOVE      BOBLG         X7                7
     C                   MOVEA     X7            AN(1)
     C                   Z-ADD     7             AT
     C                   EXSR      NUM1
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      596
     C                   MOVE      BODT3         UDT               6 0
     C                   EXSR      KDTFMT
     C                   MOVE      UDT3          X2                2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT2          X2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       2             VK
     C                   MOVE      '/'           AA(VK)
     C                   ADD       1             VK
     C                   MOVE      UDT1          X2
     C                   MOVEA     X2            AA(VK)
     C                   GOTO      SLP21
     C                   END
      *
     C     CFFNR         IFEQ      597
     C     BOVHL         CHAIN     STED2                              33
     C  N33              MOVEA     ST2NVN        AA(VK)
     C   33              MOVEA     BOVHL         AA(VK)
     C                   GOTO      SLP21
     C                   END
     C*
     C     SLP21         ENDSR
     C*
     C******************************************
     C     MOVDAG        BEGSR
     C******************************************
     C                   MOVE      BEDT          XDTD              2 0
     C     XDTD          IFLT      10
     C                   Z-ADD     XDTD          XDG               1 0
     C                   MOVE      XDG           AA(VK)
     C                   ADD       2             VK
     C                   ELSE
     C                   MOVE      XDTD          X2                2
     C                   MOVEA     X2            AA(VK)
     C                   ADD       3             VK
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVMND        BEGSR
     C******************************************
     C                   MOVE      BEDT          XDTFMT
     C                   MOVEL     XDTFMT        XDTM              2 0
     C     XDTM          IFEQ      1
     C                   MOVEA     'JANUARY'     AA(VK)
     C                   ADD       8             VK
     C                   END
     C*
     C     XDTM          IFEQ      2
     C                   MOVEA     'FEBRUARY'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C     XDTM          IFEQ      3
     C                   MOVEA     'MARCH'       AA(VK)
     C                   ADD       6             VK
     C                   END
     C*
     C     XDTM          IFEQ      4
     C                   MOVEA     'APRIL'       AA(VK)
     C                   ADD       6             VK
     C                   END
     C*
     C     XDTM          IFEQ      5
     C                   MOVEA     'MAY'         AA(VK)
     C                   ADD       4             VK
     C                   END
     C*
     C     XDTM          IFEQ      6
     C                   MOVEA     'JUNE'        AA(VK)
     C                   ADD       5             VK
     C                   END
     C*
     C     XDTM          IFEQ      7
     C                   MOVEA     'JULY'        AA(VK)
     C                   ADD       5             VK
     C                   END
     C*
     C     XDTM          IFEQ      8
     C                   MOVEA     'AUGUST'      AA(VK)
     C                   ADD       7             VK
     C                   END
     C*
     C     XDTM          IFEQ      9
     C                   MOVEA     'SEPTEMBE'    AA(VK)
     C                   ADD       8             VK
     C                   MOVEA     'R'           AA(VK)
     C                   ADD       2             VK
     C                   END
     C*
     C     XDTM          IFEQ      10
     C                   MOVEA     'OCTOBER'     AA(VK)
     C                   ADD       8             VK
     C                   END
     C*
     C     XDTM          IFEQ      11
     C                   MOVEA     'NOVEMBER'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C     XDTM          IFEQ      12
     C                   MOVEA     'DECEMBER'    AA(VK)
     C                   ADD       9             VK
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     MOVÅR         BEGSR
     C******************************************
     C                   MOVEL     BEDT          XDTÅ              4 0
     C                   MOVE      XDTÅ          X4                4
     C                   MOVEA     X4            AA(VK)
     C                   ADD       5             VK
     C*
     C                   ENDSR
     C*
     C******************************************
     C     NUM1          BEGSR
     C******************************************
     C                   Z-ADD     1             AT1               1 0
     C     AT1           DOWLT     AT
     C     AN(AT1)       COMP      '0'                                    33
     C   33              ADD       1             AT1
     C  N33              GOTO      STN11
     C                   END
     C*
     C     STN11         TAG
     C                   SUB       1             VK
     C                   ADD       AT1           VK
     C     AT1           DOWLE     AT
     C                   MOVE      AN(AT1)       AA(VK)
     C                   ADD       1             VK
     C                   ADD       1             AT1
     C                   END
     C*
     C                   ENDSR
     C*
     C******************************************
     C     PRINT3        BEGSR
     C******************************************
     C                   SELECT
     C     CFFNR         WHENEQ    270
     C                   MOVE      VK            V1                3 0
     C     CFFNR         WHENEQ    271
     C                   MOVE      VK            V2                3 0
     C     CFFNR         WHENEQ    272
     C                   MOVE      VK            V3                3 0
     C     CFFNR         WHENEQ    273
     C                   MOVE      VK            V4                3 0
     C     CFFNR         WHENEQ    274
     C                   MOVE      VK            V5                3 0
     C     CFFNR         WHENEQ    275
     C                   MOVE      VK            V6                3 0
     C                   ENDSL
     C     1             DO        5
     C  N61              READ      CDBLFLF                                61
     C                   SELECT
     C     CFFNR         WHENEQ    270
     C                   MOVE      VK            V1                3 0
     C     CFFNR         WHENEQ    271
     C                   MOVE      VK            V2                3 0
     C     CFFNR         WHENEQ    272
     C                   MOVE      VK            V3                3 0
     C     CFFNR         WHENEQ    273
     C                   MOVE      VK            V4                3 0
     C     CFFNR         WHENEQ    274
     C                   MOVE      VK            V5                3 0
     C     CFFNR         WHENEQ    275
     C                   MOVE      VK            V6                3 0
     C                   ENDSL
     C                   END
     C                   Z-ADD     0             XNTLIN            3 0
     C                   SETOFF                                       3462
     C   97              GOTO      STP33
     C     BLV1K         SETLL     BLV1LF
     C*
     C     STP31         TAG
     C     BLVKEY        READE     BLV1LF                                 34
     C  N34              DO                                                     1<-B
     C                   MOVEA     BVMN          AA(V1)
     C     BVNT          IFNE      0                                             2<-B
     C                   MOVE      BVNT          X5                5
     C                   MOVEA     X5            AN(1)
     C                   Z-ADD     5             AT
     C                   Z-ADD     V3            VK
     C                   EXSR      NUM1
     C                   END                                                     2<-E
     C                   MOVEA     BVVS          AA(V4)
     C     BVVKT         IFNE      0                                             2<-B
     C                   MOVE      BVVKT         X9                9
     C                   MOVEA     X9            AN(1)
     C                   Z-ADD     V5            VK
     C                   EXSR      NUM2
     C                   END                                                     2<-E
     C     BVM3          IFNE      0                                             2<-B
     C                   MOVE      BVM3          X9
     C                   MOVEA     X9            AN(1)
     C                   Z-ADD     V6            VK
     C                   EXSR      NUM3
     C                   END                                                     2<-E
     C*
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             XNTLIN
     C                   ADD       1             YLIN
     C     XNTLIN        IFLT      XANTL                                         2<-B
     C                   GOTO      STP31
     C                   ELSE                                                    2
     C     BLVKEY        READE     BLV1LF                                 34
     C  N34              SETON                                        62
     C  N34              MOVE      BVLI          YLI
     C  N34              MOVE      BVSORT        YSORT
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     STP33         TAG
     C  N62              SETON                                        97
     C  N62XNTLIN        COMP      XANTL                              62
     C  N62XN2           DOWLE     XN
     C                   MOVE      MN(XN2)       BVMN
     C                   MOVE      FT(XN2)       BVFT
     C                   MOVEA     BVMN          AA(V1)
     C                   MOVEA     BVFT          AA(V2)
     C                   WRITE     UTSKRI
     C                   MOVE      *BLANKS       AA
     C                   ADD       1             YLIN
     C                   ADD       1             XNTLIN
     C                   ADD       1             XN2
     C     XNTLIN        COMP      XANTL                              62
     C   62              GOTO      SLP3
     C                   END
     C*
     C     SLP3          ENDSR
     C*
     C******************************************
     C     NUM2          BEGSR
     C******************************************
     C     AN(1)         COMP      '0'                                    33
     C  N33              MOVE      AN(1)         AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(2)         COMP      '0'                                    33
     C  N33              MOVE      AN(2)         AA(VK)
     C                   ADD       1             VK
     C   33AN(3)         COMP      '0'                                    33
     C  N33              MOVE      AN(3)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(4)         COMP      '0'                                    33
     C  N33              MOVE      AN(4)         AA(VK)
     C                   ADD       1             VK
     C   33AN(5)         COMP      '0'                                    33
     C  N33              MOVE      AN(5)         AA(VK)
     C                   ADD       1             VK
     C   33AN(6)         COMP      '0'                                    33
     C  N33              MOVE      AN(6)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(7)         COMP      '0'                                    33
     C  N33              MOVE      AN(7)         AA(VK)
     C                   ADD       1             VK
     C   33AN(8)         COMP      '0'                                    33
     C  N33              MOVE      AN(8)         AA(VK)
     C                   ADD       1             VK
     C   33AN(9)         COMP      '0'                                    33
     C  N33              MOVE      AN(9)         AA(VK)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     NUM3          BEGSR
     C******************************************
     C     AN(1)         COMP      '0'                                    33
     C  N33              MOVE      AN(1)         AA(VK)
     C                   ADD       1             VK
     C   33AN(2)         COMP      '0'                                    33
     C  N33              MOVE      AN(2)         AA(VK)
     C                   ADD       1             VK
     C   33AN(3)         COMP      '0'                                    33
     C  N33              MOVE      AN(3)         AA(VK)
     C                   ADD       1             VK
     C  N33              MOVE      '.'           AA(VK)
     C*
     C                   ADD       1             VK
     C   33AN(4)         COMP      '0'                                    33
     C  N33              MOVE      AN(4)         AA(VK)
     C                   ADD       1             VK
     C   33AN(5)         COMP      '0'                                    33
     C  N33              MOVE      AN(5)         AA(VK)
     C*
     C                   ADD       1             VK
     C                   MOVE      AN(6)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      ','           AA(VK)
     C*
     C                   ADD       1             VK
     C                   MOVE      AN(7)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      AN(8)         AA(VK)
     C                   ADD       1             VK
     C                   MOVE      AN(9)         AA(VK)
     C*
     C                   ENDSR
     C*
     C******************************************
     C     UTSID2        BEGSR
     C******************************************
     C                   MOVE      *ZEROS        YLI
     C     BLVSDK        SETLL     BLVSD2
     C                   SETOFF                                       33
     C     BLVKEY        READE     BLVSD2                                 33
     C   33              GOTO      SLUTS
     C*
     C     BOOB          CHAIN     CDBOAT                             96
     C   96              MOVE      *BLANKS       XOBNAV           30
     C  N96              MOVEL     CBNAB         XOBNAV
     C     BOLB          CHAIN     CDBOAT                             96
     C   96              MOVE      *BLANKS       XLBNAV           30
     C  N96              MOVEL     CBNAB         XLBNAV
     C     BOVH          CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XVIAHN           30
     C  N96              MOVE      ST2NVN        XVIAHN
     C     BOLOH         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLOSHN           30
     C  N96              MOVE      ST2NVN        XLOSHN
     C     BOLOS         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLOSN            30
     C  N96              MOVE      ST2NVN        XLOSN
     C     BOLSH         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLSTHN           30
     C  N96              MOVE      ST2NVN        XLSTHN
     C     BOLSS         CHAIN     STED2                              96
     C   96              MOVE      *BLANKS       XLSTN            30
     C  N96              MOVE      ST2NVN        XLSTN
     C*
     C                   MOVE      BODT1         UDT               6 0
     C                   EXSR      KDTFMT
     C                   WRITE     SIDE2
     C                   SETOFF                                       01
     C                   Z-ADD     1             XSLNR             3 0
     C                   Z-ADD     0             XSUMVK            9 0
     C                   Z-ADD     0             XSUMKB            9 3
     C     BVLI          DOWGT     XSLNR
     C                   WRITE     TOMS2
     C                   ADD       1             XSLNR
     C                   END
     C     BVVKT         COMP      0                                  9696
     C     BVM3          COMP      0                                  3232
     C                   WRITE     SIDE2D
     C                   ADD       1             XSLNR
     C                   ADD       BVVKT         XSUMVK
     C                   ADD       BVM3          XSUMKB
     C*
     C     STUTS2        TAG
     C     BLVKEY        READE     BLVSD2                                 33
     C  N33              DO
     C     BVLI          DOWGT     XSLNR
     C  N01              WRITE     TOMS2
     C                   ADD       1             XSLNR
     C                   END
     C   01              WRITE     SIDE2
     C   01              SETOFF                                       01
     C     BVVKT         COMP      0                                  9696
     C     BVM3          COMP      0                                  3232
     C                   WRITE     SIDE2D
     C                   ADD       1             XSLNR
     C                   ADD       BVVKT         XSUMVK
     C                   ADD       BVM3          XSUMKB
     C                   GOTO      STUTS2
     C                   END
     C*
     C     XSUMVK        COMP      0                                  9696
     C     XSUMKB        COMP      0                                  3232
     C   01              WRITE     SIDE2
     C   01              SETOFF                                       01
     C                   WRITE     SIDE2S
     C*
     C     SLUTS         ENDSR
     C*
     C******************************************
     C     INIT          BEGSR
     C******************************************
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     BOOKK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BEOPD
     C     BLLOKK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPDF
     C     BLVKEY        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BOOPD
     C     BLV1K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BOOPD
     C                   KFLD                    YSORT
     C                   KFLD                    YLI
     C     BLV2K         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BOOPD
     C                   KFLD                    YSORT
     C                   KFLD                    YLI
     C                   KFLD                    YLI2
     C     BLVSDK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    BOOPD
     C                   KFLD                    YLI
     C     CDBLFK        KLIST
     C                   KFLD                    BEKDP
     C                   KFLD                    YFNR
     C     CDBLK2        KLIST
     C                   KFLD                    BEKDP
     C                   KFLD                    YLIN
     C     KODTPK        KLIST
     C                   KFLD                    YPUNI             1
     C                   KFLD                    UAVD
     C                   KFLD                    YLNR              3 0
     C                   MOVE      'P'           YPUNI
     C                   Z-ADD     26            YLNR
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UOPDF2            7
     C                   PARM                    UOPDT2            7
     C                   PARM                    UPRT26           10
     C                   PARM                    UPT26            10
     C                   TESTN                   UOPDF2               33
     C  N33              DO
     C                   MOVE      *ZEROS        UOPDF             7 0
     C                   MOVE      *ZEROS        UOPDT             7 0
     C                   END
     C   33              DO
     C                   MOVE      UOPDF2        UOPDF
     C                   SETOFF                                       33
     C                   TESTN                   UOPDT2               33
     C   33              MOVE      UOPDT2        UOPDT
     C  N33              MOVE      UOPDF         UOPDT
     C                   END
     C*
     C                   MOVE      *ZEROS        YSORT             3 0
     C                   MOVE      *ZEROS        YLI               3 0
     C                   MOVE      *ZEROS        YLI2              1 0
     C                   MOVE      *ZEROS        YFNR              3 0
     C                   MOVE      *ZEROS        YLIN              2 0
     C                   MOVEL     'DESTINAT'    XDEST            11
     C                   MOVE      'ION'         XDEST
     C                   MOVEL     'PREPAID'     XPREP             7
     C                   MOVE      *ZEROS        CFLIN
     C                   MOVE      *ZEROS        CFCOL
     C                   MOVE      *ZEROS        BOAVD
     C                   MOVE      *ZEROS        BOOPD
     C                   MOVE      *BLANKS       BOSG
     C                   MOVE      *BLANKS       BOREIS
     C                   Z-ADD     1024          UCMDL            15 5
     C*
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          XIDAGÅ
     C                   ELSE
     C     UYEAR         ADD       2000          XIDAGÅ
     C                   END
     C                   MOVE      UMONTH        XIDAGM
     C                   MOVE      UDAY          XIDAGD
     C*
     C     UPRT26        IFEQ      *BLANKS
     C     KODTPK        CHAIN     KODTP                              33
     C                   ELSE
     C     KODTPK        CHAIN     KODTP                              33
     C                   MOVE      UPRT26        KOPNVN
     C                   MOVE      UPT26         KOPTY
     C                   END
     C     KOPFM         CHAIN     KODTFM                             33                       42
     C     FIFIRM        SETLL     FIRM                               33
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      UDT           XDTFMT            4 0
     C                   MOVEL     UDT           UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C*
     C                   ENDSR
     C*
     OBOOKINGR  E            BOMRK
     O                       BOST
     O                       BODTB
     O          E            BODUM
