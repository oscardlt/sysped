********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P11070* 01 YBC PTF11 FEL kontroll
********************************************************************
     FSVTAR1    IF   E           K DISK
     FSVTLK     IF   E           K DISK
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametere
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVTA_IE
     C                   PARM                    UVTA_VATA
     C                   PARM                    ULK               2
     C                   PARM                    UVTA_MUC
      *________________
      * Arbetsvariablar
      *""""""""""""""""
     C     *LIKE         DEFINE    SVTA_IE       UVTA_IE
     C     *LIKE         DEFINE    SVTA_VATA     UVTA_VATA
     C     *LIKE         DEFINE    SVTA_RG       UVTA_RG
     C     *LIKE         DEFINE    SVTA_MUC      UVTA_MUC
     C     *LIKE         DEFINE    SVTA_IE       WVTA_IE
     C     *LIKE         DEFINE    SVTA_VATA     WVTA_VATA
     C     *LIKE         DEFINE    SVTA_MTI      WVTA_MTI
     C                   EVAL      WVTA_IE=UVTA_IE
     C                   EVAL      WVTA_VATA=UVTA_VATA
S01  C*                  EVAL      WVTA_MTI='110'
N01  C                   EVAL      WVTA_MTI='109'
     C                   EVAL      UVTA_MUC=*BLANKS
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     SVTAKEY       KLIST
     C                   KFLD                    WVTA_IE
     C                   KFLD                    WVTA_VATA
     C                   KFLD                    WVTA_MTI
N01  C     SVTAKEY2      KLIST
N01  C                   KFLD                    WVTA_IE
N01  C                   KFLD                    WVTA_VATA
     C     SVTLKKEY      KLIST
     C                   KFLD                    ULK
     C                   KFLD                    SVTA_RG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Finnes x-tra mängdenhet                              SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C     SVTAKEY       SETLL     SVTAR1
S01  C*    SVTAKEY       READE     SVTAR1                                 55
N01  C     SVTAKEY2      READE     SVTAR1                                 55
     C     *IN55         DOWEQ     *OFF
      * Er landkoden riktig ?
     C     SVTA_RG       CABEQ     ULK           SRB1
      * Eller stæmmer regionen ?
     C     SVTLKKEY      CHAIN     SVTLK                              56
     C     *IN56         CABEQ     *OFF          SRB1
N01   * Riktig gruppkod ?
N01  C     SVTA_MTI      IFEQ      '109'
N01  C     SVTA_MTI      OREQ      '110'
N01  C     SVTA_MTI      OREQ      '111'
N01  C                   GOTO      SRB1
N01  C                   ENDIF
     C                   GOTO      SRB2
     C     SRB1          TAG
      * Har nå funnet x-mängdenhet, konverter og returner
     C                   SELECT
     C     SVTA_MUC      WHENEQ    'ASV'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'BSV'
     C                   EVAL      UVTA_MUC='%   '
     C     SVTA_MUC      WHENEQ    'CCT'
     C                   EVAL      UVTA_MUC='T   '
     C     SVTA_MUC      WHENEQ    'CEN'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'CTM'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'DHS'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'DTN'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'FUB'
     C                   EVAL      UVTA_MUC='KU  '
     C     SVTA_MUC      WHENEQ    'GFI'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'GRM'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'GRT'
     C                   EVAL      UVTA_MUC='T   '
     C     SVTA_MUC      WHENEQ    'HLT'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'HMT'
     C                   EVAL      UVTA_MUC='ME  '
     C     SVTA_MUC      WHENEQ    'KCC'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KCL'
     C                   EVAL      UVTA_MUC='T   '
     C     SVTA_MUC      WHENEQ    'KGM'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KLT'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'KMA'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KNI'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KNS'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KPH'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KPO'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KPP'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KSD'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KSH'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'KUR'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'LPA'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'LTR'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'LVO'
     C                   EVAL      UVTA_MUC='L   '
     C     SVTA_MUC      WHENEQ    'MIL'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'MTK'
     C                   EVAL      UVTA_MUC='KV  '
     C     SVTA_MUC      WHENEQ    'MTQ'
     C                   EVAL      UVTA_MUC='KU  '
     C     SVTA_MUC      WHENEQ    'MTR'
     C                   EVAL      UVTA_MUC='ME  '
     C     SVTA_MUC      WHENEQ    'MWH'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'NAR'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'NCL'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'NPR'
     C                   EVAL      UVTA_MUC='P   '
     C     SVTA_MUC      WHENEQ    'PSA'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'PTK'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'SVK'
     C                   EVAL      UVTA_MUC='KG  '
     C     SVTA_MUC      WHENEQ    'SVP'
     C                   EVAL      UVTA_MUC='%   '
     C     SVTA_MUC      WHENEQ    'TJO'
     C                   EVAL      UVTA_MUC='ST  '
     C     SVTA_MUC      WHENEQ    'TNE'
     C                   EVAL      UVTA_MUC='T   '
     C                   OTHER
     C                   EVAL      UVTA_MUC=SVTA_MUC
     C                   ENDSL
     C                   GOTO      SRB9
     C     SRB2          TAG
S01  C*    SVTAKEY       READE     SVTAR1                                 55
N01  C     SVTAKEY2      READE     SVTAR1                                 55
     C                   ENDDO
     C     SRB9          ENDSR
