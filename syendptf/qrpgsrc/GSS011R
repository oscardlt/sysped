********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10004 * 01 YBC PTF10 LEVERANDØRSNR ER ØKT TIL 5.0
10004 * 02 SH  PTF10 ny farlig gods fil
10XXX * 03 YBC PTF10 NYTT PARAMETER TIL GSS049C
10XXX * 04 YBC PTF10 OPPDATER LOGG I GSSLGF VED NYE REGISTRERING
10XXX * 05 YBC PTF10 TEST OGSÅ P.O.NR PÅ PENDING ORDRE
10027 * 06 YBC PTF10 VIS ORDRETYPE
10029 * 07 YBC PTF10 NY MODUS FOR Å ENDRE DEL AV ORDRE
10XXX * 08 YBC PTF10 TVING REGISTRERING AV MRN-NR
10XXX * 09 YBC PTF10 SKRIV ORDRETYPE PÅ MERKELAPP
10XXX * 10 YBC PTF10 TEST LEVERINGSDATO VED IKKE PEDING-ORDRE
10XXX * 11 YBC PTF10 OPPDATER LOGG VED ENDRING
10XXX * 12 JOV PTF10 Nye parametre SYIN10B
10XXX * 13 SH  PTF10 SYIN10B FJERNET NÅ GSS082R
A38   * 14 SH  PTF11 delt parameter PO til GSS013R
********************************************************************
AMR01 * AMR SKAL AUTOMATISK HA LOKASJON I STREKKODE.
AMR01 * DENNE ENDRINGEN SKAL TA BORT NÅR VI INNFØRER KODEFELT PÅ FIRMA.
      *
      **************************************************************
      *** PROGRAM SKAL ARBEIDE MED ORDREINNHOLD / PRINTER MERKELAPPER
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-03 05-09 11 13-26
      *** LEDIGE INDIKATORER 34-38 40-80
      **************************************************************
      *
     FSTED2     IF   E           K DISK
     FGSSORF    UF A E           K DISK
     FGSSOWL01  UF   E           K DISK    PREFIX(W1_)
     FGSSPOF    UF A E           K DISK
     FGSSPOL01  IF   E           K DISK
     F                                     RENAME(GSSPOFR:GSSPOFR1)
     FGSSPAF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FKODTFT    IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FGSSCNF    UF A E           K DISK
     FGSSSFF    IF   E           K DISK
     FGSSCGF    IF   E           K DISK
     FGSSFGF    IF   E           K DISK
N02  FGSSDGF    IF   E           K DISK
N04  FGSSLGL01  UF A E           K DISK
N08  FGSSRFF    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKUFAST    IF   E           K DISK
     FDOKUF     IF   E           K DISK
     FGSS011P   O    E             PRINTER USROPN
     FGSS011D   CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D HØ              S              3  2 DIM(12)
     D LE              S              3  2 DIM(12)
     D BR              S              3  2 DIM(12)
     D AN              S              3  0 DIM(12)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D  ORDTL                  1      8  0
     D                 DS
     D  ORPOAA                 1      4  0
     D  ORPOMM                 5      6  0
     D  ORPODD                 7      8  0
     D  ORPORD                 1      8  0
     D                 DS
     D  WSDTLD                 1      2  0
     D  WSDTLM                 3      4  0
     D  WSDTLÅ                 5      6  0
     D  WSDTL                  1      6  0
     D                 DS
     D  WSPODD                 1      2  0
     D  WSPOMM                 3      4  0
     D  WSPOAA                 5      6  0
     D  WSPORD                 1      6  0
     D                 DS
     D  ORDT2Å                 1      4  0
     D  ORDT2M                 5      6  0
     D  ORDT2D                 7      8  0
     D  ORDTL2                 1      8  0
     D                 DS
     D  WSDT2D                 1      2  0
     D  WSDT2M                 3      4  0
     D  WSDT2Å                 5      6  0
     D  WSDTL2                 1      6  0
     D                 DS
     D  ORDT3Å                 1      4  0
     D  ORDT3M                 5      6  0
     D  ORDT3D                 7      8  0
     D  ORDTL3                 1      8  0
     D                 DS
     D  WSDT3D                 1      2  0
     D  WSDT3M                 3      4  0
     D  WSDT3Å                 5      6  0
     D  WSDTL3                 1      6  0
     D                 DS
     D  ORDTWÅ                 1      4  0
     D  ORDTWM                 5      6  0
     D  ORDTWD                 7      8  0
     D  ORDTWL                 1      8  0
     D                 DS
     D  WSDTWD                 1      2  0
     D  WSDTWM                 3      4  0
     D  WSDTWÅ                 5      6  0
     D  WSDTWL                 1      6  0
     D                 DS
     D  ORDTRÅ                 1      4  0
     D  ORDTRM                 5      6  0
     D  ORDTRD                 7      8  0
     D  ORDTR                  1      8  0
     D                 DS
     D  WSDTRD                 1      2  0
     D  WSDTRM                 3      4  0
     D  WSDTRÅ                 5      6  0
     D  WSDTR                  1      6  0
     D                 DS
     D  POLNO                  1      2  0
     D  XLN                    1      2  0
     D                 DS
N14  D  PO1                    1    500
N14  D  PO2                  501   1000
     D  WSCON1                 1     20
     D  WSCON2                21     40
     D  WSCON3                41     60
     D  WSCON4                61     80
     D  WSCON5                81    100
     D  WSCON6               101    120
     D  WSCON7               121    140
     D  WSCON8               141    160
     D  WSCON9               161    180
     D  WSCO10               181    200
     D  WSCO11               201    220
     D  WSCO12               221    240
     D  WSCO13               241    260
     D  WSCO14               261    280
     D  WSCO15               281    300
     D  WSCO16               301    320
     D  WSCO17               321    340
     D  WSCO18               341    360
     D  WSCO19               361    380
     D  WSCO20               381    400
     D  WSCO21               401    420
     D  WSCO22               421    440
     D  WSCO23               441    460
     D  WSCO24               461    480
     D  WSCO25               481    500
     D  WSCO26               501    520
     D  WSCO27               521    540
     D  WSCO28               541    560
     D  WSCO29               561    580
     D  WSCO30               581    600
     D  WSCO31               601    620
     D  WSCO32               621    640
     D  WSCO33               641    660
     D  WSCO34               661    680
     D  WSCO35               681    700
     D  WSCO36               701    720
     D  WSCO37               721    740
     D  WSCO38               741    760
     D  WSCO39               761    780
     D  WSCO40               781    800
     D  WSCO41               801    820
     D  WSCO42               821    840
     D  WSCO43               841    860
     D  WSCO44               861    880
     D  WSCO45               881    900
     D  WSCO46               901    920
     D  WSCO47               921    940
     D  WSCO48               941    960
     D  WSCO49               961    980
     D  WSCO50               981   1000
     D  PO                     1   1000
     D                                     DIM(50)
     D                 DS
     D  DF1004                 1     35
     D  WSFBNR                 1     20
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(GSS011P) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(66 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(60)')
N04  D                SDS
N04  D  WUSER                254    263
     D                UDS
     D  UFIRM                  1      2
     D  UUSID                101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C  N30              Z-ADD     5             LINNBR
N07  C  N30
N07  CAN 38              Z-ADD     9             LINNBR
     C  N30              Z-ADD     22            POSNBR
     C                   MOVE      WSCON1        XCON             20
     C                   IF        ORONO = 0
     C                   MOVE      '0'           *IN39
     C                   ELSE
     C     ORONO         CHAIN     GSSFGF                             33
N02  C   33ORONO         CHAIN     GSSDGF                             33
     C                   IF        *IN33
     C                   MOVE      '0'           *IN39
     C                   ELSE
     C                   MOVE      '1'           *IN39
     C                   END
     C                   END
     C                   EXFMT     GSS011DA
S08  C*                  MOVEA     '00000000'    *IN(92)
S08  C*                  MOVEA     '0000000000'  *IN(82)
N08  C                   MOVEA     '0000000000'  *IN(90)
N08  C                   MOVEA     '000000000'   *IN(81)
     C                   MOVE      '0'           *IN30
     C     WSCON1        IFNE      XCON
     C                   MOVE      'J'           WSOK
     C                   END
      *
     C   12              GOTO      SLUTT
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        GRECNO            4 0
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
     C   06              DO
N13  C     ORONO         IFEQ      0
N13  C                   MOVE      'SHU1602'     MSGNR
N13  C                   MOVE      '1'           *IN30
N13  C   30              GOTO      START
N13  C                   end
     C                   EXSR      KUBIKK
     C                   GOTO      START
     C                   END
      *
     C     UTYPE         IFNE      'DSP'
     C     WSOK          IFNE      'Y'
     C                   EXSR      TESTPO
     C     WSOK          CABEQ     'N'           START
     C                   END
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
     C                   EXSR      UPDORD
N08   *
N08  C                   IF        WSTYPE = 'T'
N08  C     ORONO         SETLL     GSSRFF
N08  C     ORONO         READE     GSSRFF                                 33
N08  C                   DOW       *IN33 = '0'
N08  C                   IF        ((RFKD = 'MRNI') OR (RFKD = 'MRNO'))
N08  C                   LEAVE
N08  C                   END
N08  C     ORONO         READE     GSSRFF                                 33
N08  C  N33              ENDDO
N08  C                   IF        *IN33 = '1'
N08  C                   CALL      'GSS019R'
N08  C                   PARM                    UONO
N08  C                   PARM                    UTYPE
N08  C                   PARM                    UFLAGG
N08  C                   MOVE      '0'           *IN07
N08  C                   END
N08  C                   END
N08   *
     C     XDL           IFEQ      'J'
     C     WSTXT1        ANDEQ     *BLANKS
     C                   MOVE      '1'           *IN09
     C                   END
     C                   END
      *
     C   09              DO
     C                   CALL      'GSS017R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C     UONO          CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      PATXT1        WSTXT1
     C                   MOVE      PAPKD         WSPKD
     C                   ELSE
     C                   MOVE      *BLANKS       WSTXT1
     C                   MOVE      *BLANKS       WSPKD
     C                   END
     C  N03
     CANN08
     CANN10
     CANN16
     CANN14
     CANN11
     CANN07WSPRL         IFNE      'Y'
     C                   GOTO      START
     C                   END
     C                   END
      *
     C   10              DO
     C                   CALL      'GSS014R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C     UFLAGG        CABEQ     1             START
     C     WSCLI         IFEQ      0
     C     WSWT          OREQ      0
     C     WSPOS1        OREQ      *BLANKS
     C                   GOTO      START
     C                   END
     C                   END
      *
     C   11              DO
     C                   CALL      'GSS013R'
     C                   PARM      WSCNO         UCNO2             8 0
     C                   PARM                    UONO
     C                   PARM                    WSBCD
S14  C*                  PARM                    PO
n14  C                   PARM                    PO1
n14  C                   PARM                    PO2
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C                   GOTO      START
     C                   END
     C  N27
     CAN 15              do
     C                   EXSR      MOREPO
     C                   GOTO      START
     C                   END
      *
     C   07              DO
     C                   CALL      'GSS019R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C                   GOTO      START
     C                   END
      *
     C   14              DO
     C                   CALL      'GSS038R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C                   GOTO      START
     C                   END
      *
     C     WSPRL         IFEQ      'Y'
     C                   EXSR      PRTMLP
     C   12              GOTO      START
     C                   MOVE      'N'           WSPRL
     C                   END
      *
     C   03              GOTO      SLUTT
     C   08              GOTO      SLUTT
     C   16              DO
     C                   EXSR      MOVB
     C                   GOTO      START
     C                   END
     C  N05              GOTO      START
     C                   CALL      'GSS012R'
     C                   PARM                    UONO
     C                   PARM                    UTYPE
     C                   PARM                    UFLAGG
     C     UFLAGG        IFEQ      1
     C                   GOTO      START
     C                   END
      *
     C     SLUTT         TAG
     C     UONO          IFNE      0
     C     UTYPE         ANDNE     'DSP'
N07  C                   IF        UTYPE <> 'CH2'
     C     UONO          CHAIN     GSSORF                             33
     C     ORCLI         IFEQ      0
     C     ORWT          OREQ      0
     C     ORPOS1        OREQ      *BLANKS
     C                   MOVE      'P'           ORST
     C                   MOVE      *ZEROS        ORDTL
     C                   ELSE
     C                   MOVE      '0'           ORST
     C                   END
     C  N33              UPDATE    GSSORFR
N07  C                   END
N07  C                   IF        UTYPE = 'CH2'
N07  C                   MOVE      'CH3'         UTYPE2            3
N07  C                   ELSE
     C                   MOVE      'CH2'         UTYPE2            3
N07  C                   END
AMR01C                   CALL      'GSS018R'
AMR01C                   PARM                    UONO
AMR01C                   PARM                    UTYPE2
AMR01C                   PARM                    ORPOS1
AMR01C                   PARM                    ORCLI
     C                   END
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     MOVB          BEGSR
     C***********************************************
     C                   MOVE      ' '           WSST
     C                   MOVE      ' '           WSRTNG
N05  C                   MOVE      ' '           WSTYPE
     C                   MOVE      *ZEROS        UONO
     C                   MOVE      *ZEROS        WSTNO
     C                   MOVE      *ZEROS        WSTNO2
     C                   MOVE      *ZEROS        WSTNO3
     C                   MOVE      *ZEROS        WSSNO
     C                   MOVE      *BLANKS       WSSNM
     C                   MOVE      *ZEROS        WSCLNF
     C                   MOVE      *ZEROS        WSCLNT
     C                   MOVE      *BLANKS       WSLC2
     C                   MOVE      *BLANKS       WSLC3
     C                   MOVE      *BLANKS       WSPOS2
     C                   MOVE      *BLANKS       WSPOS3
     C                   MOVE      UDAY          WSDTLD
     C                   MOVE      UMONTH        WSDTLM
     C                   MOVE      UYEAR         WSDTLÅ
     C                   MOVE      *ZEROS        WSPORD
     C                   MOVE      *ZEROS        WSCLI
     C                   MOVE      *ZEROS        WSWT
     C                   MOVE      *ZEROS        WSVOL
     C                   MOVE      *BLANKS       WSTXT1
     C                   MOVE      *BLANKS       WSPKD
     C                   MOVE      *ZEROS        WSAMT
     C                   MOVE      *BLANKS       WSCURC
     C                   MOVE      *ZEROS        WSCLNF
     C                   MOVE      *ZEROS        WSCLNT
     C                   MOVE      *ZEROS        WSDTWL
     C                   MOVE      *BLANKS       WSFTCD
     C                   MOVE      *BLANKS       WSFT1
     C                   MOVE      *BLANKS       WSFT2
     C                   MOVE      *BLANKS       WSFT3
     C                   MOVE      *BLANKS       WSFT4
     C                   MOVE      *BLANKS       WSKDL1
     C                   MOVE      *BLANKS       WSKDL2
     C                   MOVE      *BLANKS       WSKDL3
     C                   MOVE      *BLANKS       WSOT
     C                   MOVE      *BLANKS       WSFR
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UYEAR         WSDTRÅ
     C                   movea     *blanks       po
     C                   ENDSR
      *
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSCNO
     C                   PARM      UFIRM         UFIRM2            2
     C                   PARM                    USØKKN           30
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB         BEGSR
     C***********************************************
     C     WSPORT        IFNE      *BLANKS
     C     wsport        chain     sted2                              83
     C   83              DO
     C                   MOVE      'SHU1160'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     36            POSNBR
     C                   END
     C                   END
      *
     C     WSPORD        IFNE      0
     C                   MOVE      WSPOAA        UÅÅ               2 0
     C                   MOVE      WSPOMM        UMM               2 0
     C                   MOVE      WSPODD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      82
     C   82
     CANN30              DO
     C                   MOVE      'SHU1161'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     42            POSNBR
     C                   END
     C                   END
      *
N08   *
N08  C                   IF        WSLC = 'RTM' AND WSTYPE = ' '
N08  C                   MOVE      'YBC1989'     MSGNR
N08  C                   MOVE      '1'           *IN30
N08  C                   MOVE      '1'           *IN81
N08  C                   Z-ADD     4             LINNBR
N08  C                   Z-ADD     30            POSNBR
N08  C                   END
      *
     C     WSBCD         CHAIN     CDBOAT                             99
     C     *IN99         IFEQ      '1'                                          1<-B
     C     *in30         ANDNE     '1'
     C                   MOVE      'GSS0032'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   ELSE                                                   1
     C                   MOVE      CBNAB         WSBNM
     C     CBKN          IFNE      0                                             2<-B
     C                   MOVE      CBKN          WSCNO
     C                   END                                                     2<-E
     C     CUND1K        CHAIN     CUNDL01                            98
     C   98              MOVE      'GSS0028'     MSGNR
     C  N98UBICGR        IFNE      *BLANKS                                       2<-B
     C     WSCNO         CHAIN     GSSCGF                             98
     C  N98CGCG          COMP      UBICGR                             9898
     C   98              MOVE      'GSS0029'     MSGNR
     C                   END                                                     2<-E
     C  N98UBICNO        IFNE      0                                             2<-B
     C     UBICNO        ANDNE     WSCNO
     C                   MOVE      '1'           *IN98
     C                   MOVE      'GSS0030'     MSGNR
     C                   END                                                     2<-E
     C   98              DO                                                      2<-B
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END                                                     2<-E
     C  N98              MOVE      KNAVN         WSCNM
     C                   END                                                    1<-E
      *
     C     WSSNO         IFEQ      0
     C     WSSNM         COMP      *BLANKS                                97
     C                   ELSE
     C     WSSNO         CHAIN     GSSSFF                             97
     C  N97              MOVE      SFNM          WSSNM
     C                   END
     C   97
     CANN30              DO
     C                   MOVE      'GSS0031'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     7             LINNBR
     C     WSSNO         IFEQ      0
     C                   Z-ADD     34            POSNBR
     C                   ELSE
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
     C     *IN08         IFEQ      '0'
     C     *IN10         ANDEQ     '0'
     C     WSCLI         COMP      0                                      96
     C   96
     CANN30              DO
     C                   MOVE      'GSS0033'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
     C     *IN08         IFEQ      '0'
     C     *IN10         ANDEQ     '0'
     C     WSWT          COMP      0                                      95
     C   95
     CANN30              DO
     C                   MOVE      'GSS0034'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     41            POSNBR
     C                   END
     C                   END
      *
     C     WSDSC         COMP      *BLANKS                                93
     C   93
     CANN30              DO
     C                   MOVE      'GSS0036'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
      *
N08  C                   SELECT
N08  C     WSLC          WHENEQ    'OSL'
N08  C                   MOVE      'OSLL '       WSPOS1
N08  C     WSLC          WHENEQ    'RTM'
N08  C                   MOVE      'RTML '       WSPOS1
N08  C                   OTHER
     C     WSLC          COMP      *BLANKS                                92
     C   92
     CANN30              DO
     C                   MOVE      'GSS0037'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
N08  C                   ENDSL
      *
     C     WSDTL         IFNE      0
N10  C     *IN08         OREQ      '0'
     C                   MOVE      WSDTLÅ        UÅÅ               2 0
     C                   MOVE      WSDTLM        UMM               2 0
     C                   MOVE      WSDTLD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      90
     C   90
     CANN30              DO
     C                   MOVE      'GSS0039'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
     C     WSDTWL        IFNE      0
     C     *IN08         OREQ      '1'
     C                   MOVE      WSDTWÅ        UÅÅ               2 0
     C                   MOVE      WSDTWM        UMM               2 0
     C                   MOVE      WSDTWD        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C   89
     CANN30              DO
     C                   MOVE      'GSS0040'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     64            POSNBR
     C                   END
     C                   END
      *
     C     *IN08         IFEQ      '0'
     C     *IN10         ANDEQ     '0'
     C     WSPOS1        COMP      *BLANKS                                91
     C   91
     CANN30              DO
     C                   MOVE      'GSS0038'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
     C     WSOT          IFNE      *BLANKS
     C     KODOTK        CHAIN     KODTOTY                            85
     C   85
     CANN30              DO
     C                   MOVE      'SPO0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     54            POSNBR
     C                   END
     C                   END
      *
     C     WSFR          IFNE      *BLANKS
     C     KODFRK        CHAIN     KODTFR                             84
     C   84
     CANN30              DO
     C                   MOVE      'SPF0006'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     68            POSNBR
     C                   END
     C                   END
      *
     C     WSAMT         COMP      0                                      86
     C   86
     CANN30              DO
     C                   MOVE      'GSS0065'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
      *
     C     KODVAK        CHAIN     VALUL01                            88
     C   88
     CANN30              DO
     C                   MOVE      'GSS0045'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     36            POSNBR
     C                   END
      *
     C     WSFTCD        IFNE      *BLANKS
     C                   MOVE      '1'           *IN94
     C     KODF1K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN94
     C  N33              MOVEL     KFTFTX        WSFT1
     C   33              MOVE      *BLANKS       WSFT1
     C     KODF2K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN94
     C  N33              MOVEL     KFTFTX        WSFT2
     C   33              MOVE      *BLANKS       WSFT2
     C     KODF3K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN94
     C  N33              MOVEL     KFTFTX        WSFT3
     C   33              MOVE      *BLANKS       WSFT3
     C     KODF4K        CHAIN     KODTFTR                            33
     C  N33              MOVE      '0'           *IN94
     C  N33              MOVEL     KFTFTX        WSFT4
     C   33              MOVE      *BLANKS       WSFT4
     C   94
     CANN30              DO
     C                   MOVE      'GSS0035'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   END
     C                   END
      *
     C     WSCLNT        IFNE      0
     C     WSCLNT        COMP      WSCLNF                               87
     C   87
     CANN30              DO
     C                   MOVE      'GSS0041'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     22            POSNBR
     C                   END
     C                   END
      *
N08  C     SLTB01        TAG
N08   *
     C                   ENDSR
      *
     C***********************************************
     C     TESTPO        BEGSR
     C***********************************************
     C                   MOVE      'N'           XDL               1
     C                   MOVE      ORONO         XONO              7 0
     C     1             DO        50            XN                2 0          1<-B
     C     PO(XN)        IFNE      *BLANKS                                       2<-B
     C                   IF        PO(XN) = '*'
     C                   EVAL      PO(XN) = 'NOT STATED'
     C                   END
     C                   IF        PO(XN) <> 'NOT STATED'
     C                   MOVE      PO(XN)        WSCON
     C     WSCON         SETLL     GSSPOL01
     C     WSCON         READE     GSSPOL01                               33
     C     *IN33         DOWEQ     '0'                                            3<-B
     C     XONO          IFNE      POONO                                           4<-B
     C     XONO          OREQ      0
     C     POONO         CHAIN(N)  GSSORF                             34
     C     ORBCD         IFEQ      WSBCD                                            5<-B
     C     ORST          ANDNE     'D'
S05  C*    ORST          ANDNE     'P'
     C     POONO         CHAIN     GSSPAF                             99
     C  N99PAPKD         COMP      ' '                                9999
     C                   MOVE      'N'           WSOK
     C     STTPO         TAG
     C                   EXFMT     GSS011DC
     C                   IF        *IN08
     C                   MOVE      XONO          UONO2             7
     C                   CALL      'GSS029R'
     C                   PARM                    WSBCD
     C                   PARM                    WSCON
     C                   PARM                    UONO2
     C                   GOTO      STTPO
     C                   END
     C     WSOK          CABEQ     'N'           SLTPO
     C     POONO         CHAIN     GSSPAF                             34
     C  N34              MOVE      'J'           XDL               1
     C                   GOTO      STTPON
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C     WSCON         READE     GSSPOL01                               33
     C  N33              ENDDO                                                    3<-E
     C                   END
     C                   END                                                     2<-E
     C     STTPON        TAG
     C                   ENDDO                                                  1<-E
      *
     C     SLTPO         TAG
     C                   MOVE      XONO          ORONO
     C                   MOVE      '0'           *IN99
     C                   ENDSR
      *
     C***********************************************
     C     UPDORD        BEGSR
     C***********************************************
     C     UONO          IFEQ      0
     C     CNCC          CHAIN     GSSCNF                             33
     C   33              Z-ADD     1             CNNO
     C                   MOVE      CNNO          UONO
     C                   ADD       1             CNNO
     C   33              WRITE     GSSCNFR
     C  N33              UPDATE    GSSCNFR
     C                   MOVE      *ZEROS        ORDTL2
     C                   MOVE      *ZEROS        ORDTL3
     C                   MOVE      *BLANKS       ORLC2
     C                   MOVE      *BLANKS       ORLC3
     C                   MOVE      *ZEROS        ORTNO2
     C                   MOVE      *ZEROS        ORTNO3
     C                   MOVEA     '01'          *IN(27)
     C                   END
      *
     C     UONO          CHAIN     GSSORF                             33
N11  C  N33              EXSR      OPDLOG
     C                   MOVE      UONO          ORONO
S07  C*    *IN16         IFEQ      '0'
N07  C  N38*IN16         IFEQ      '0'
     C                   MOVE      'X'           ORST
     C                   ELSE
     C                   MOVE      '0'           ORST
     C                   END
     C                   MOVE      ORST          WSST
     C                   MOVE      WSTNO         ORTNO
     C                   MOVE      WSCNO         ORCNO
     C                   MOVE      WSSNO         ORSNO
     C                   MOVE      WSSNM         ORSNM
     C                   MOVE      WSRTNG        ORRTNG
N05  C                   MOVE      WSTYPE        ORTYPE
     C                   MOVE      WSBCD         ORBCD
     C                   MOVE      WSCLI         ORCLI
     C                   MOVE      WSWT          ORWT
     C                   MOVE      WSVOL         ORVOL
     C                   MOVE      WSDSC         ORDSC
     C                   MOVE      WSAMT         ORAMT
     C                   MOVE      WSCURC        ORCURC
     C                   MOVE      WSCLNF        ORCLNF
     C                   MOVE      WSCLNT        ORCLNT
     C     WSDTWL        IFEQ      0
     C                   MOVE      *ZEROS        ORDTWL
     C                   ELSE
     C                   MOVE      WSDTWÅ        ORDTWÅ
     C     WSDTWÅ        IFGT      50
     C                   MOVEL     '19'          ORDTWÅ
     C                   ELSE
     C                   MOVEL     '20'          ORDTWÅ
     C                   END
     C                   MOVE      WSDTWM        ORDTWM
     C                   MOVE      WSDTWD        ORDTWD
     C                   END
     C     WSDTL         IFEQ      0
     C                   MOVE      *ZEROS        ORDTL
     C                   ELSE
     C                   MOVE      WSDTLÅ        ORDTLÅ
     C     WSDTLÅ        IFGT      50
     C                   MOVEL     '19'          ORDTLÅ
     C                   ELSE
     C                   MOVEL     '20'          ORDTLÅ
     C                   END
     C                   MOVE      WSDTLM        ORDTLM
     C                   MOVE      WSDTLD        ORDTLD
     C                   END
     C                   MOVE      WSLC          ORLC
     C                   MOVE      WSPORT        ORPORT
     C     WSPORD        IFEQ      0
     C                   MOVE      *ZEROS        ORPORD
     C                   ELSE
     C                   MOVE      WSPOAA        ORPOAA
     C     WSDTLÅ        IFGT      50
     C                   MOVEL     '19'          ORPOAA
     C                   ELSE
     C                   MOVEL     '20'          ORPOAA
     C                   END
     C                   MOVE      WSPOMM        ORPOMM
     C                   MOVE      WSPODD        ORPODD
     C                   END
     C                   MOVE      WSPOS1        ORPOS1
     C                   MOVE      WSPOS2        ORPOS2
     C                   MOVE      WSPOS3        ORPOS3
     C                   MOVE      WSFTCD        ORFTCD
     C                   MOVE      WSFT1         ORFT1
     C                   MOVE      WSFT2         ORFT2
     C                   MOVE      WSFT3         ORFT3
     C                   MOVE      WSFT4         ORFT4
     C                   MOVE      WSKDL1        ORKDL1
     C                   MOVE      WSKDL2        ORKDL2
     C                   MOVE      WSKDL3        ORKDL3
     C                   MOVE      WSOT          OROT
     C                   MOVE      WSFR          ORFR
     C                   MOVE      WSDTRÅ        ORDTRÅ
     C     WSDTRÅ        IFGT      50
     C                   MOVEL     '19'          ORDTRÅ
     C                   ELSE
     C                   MOVEL     '20'          ORDTRÅ
     C                   END
     C                   MOVE      WSDTRM        ORDTRM
     C                   MOVE      WSDTRD        ORDTRD
     C   33              WRITE     GSSORFR
     C   33              CALL      'GSS049C'
     C                   PARM                    UONO              7 0
N03  C                   PARM                    UTNO             11 0
N04   *
N04  C                   IF        *IN33
N04  C                   MOVE      WUSER         LGUSER
N04  C                   CALL      'SYGE15C'
N04  C                   PARM                    WDT               8
N04  C                   PARM                    WTM               6
N04  C                   MOVE      WDT           LGDT
N04  C                   MOVE      WTM           LGTID
N04  C                   Z-ADD     1             LGLN
N04  C                   MOVEL     'GSS011R'     LGPGM
N04  C     ORCLI         IFEQ      0
N04  C     ORWT          OREQ      0
N04  C     ORPOS1        OREQ      *BLANKS
N04   * VED PENDING OPPDATERER 0 PÅ HENDELSESDATO OG TID.
N04  C                   MOVE      *ZEROS        LGHDT
N04  C                   MOVE      *ZEROS        LGHTID
N04  C                   ELSE
N04  C                   MOVE      WDT           LGHDT
N04  C                   MOVEL     WTM           LGHTID
N04  C                   END
N04  C                   Z-ADD     3             LGNIVÅ
N04  C                   MOVEL     'CRTOR'       LGFTYP
N04  C                   MOVE      ORONO         LGONO
N04  C                   EVAL      LGTXT = 'ORDER IS CREATED.'
N04  C                   WRITE     GSSLGFR
N04  C                   ELSE
N04  C                   MOVE      *ZEROS        LGHDT
N04  C                   MOVE      *ZEROS        LGHTID
N04  C     GSSLGL01K     CHAIN     GSSLGL01                           33
N04  C                   IF        *IN33 = *OFF
N04   * FRA PENDING TIL VANLIG OPPDATER HENDELSESDATO OG TID FOR LOGGEN
N04  C                   CALL      'SYGE15C'
N04  C                   PARM                    WDT               8
N04  C                   PARM                    WTM               6
N04  C                   MOVE      WDT           LGHDT
N04  C                   MOVEL     WTM           LGHTID
N04  C                   UPDATE    GSSLGFR
N04  C                   ELSE
N04  C                   MOVE      *OFF          *IN33
N04  C                   END
N04  C                   END
N04   *
     C  N33              UPDATE    GSSORFR
     C     ORONO         CHAIN     GSSOWL01                           33
     C                   IF        *IN33 = *OFF
     C                   IF        W1_ORST <> 'P'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      'P'           W1_ORST
     C                   MOVE      UUSID         W1_ORUSRP
     C                   MOVE      WDT           W1_ORDTP
     C                   MOVE      WTM           W1_ORTMP
     C                   END
     C                   UPDATE    GSSOWFR
     C                   END
      *
     C                   MOVE      ORONO         POONO
     C     1             DO        50            POLNO
     C     GSSPOK        CHAIN     GSSPOF                             33
     C     PO(XLN)       IFEQ      *BLANKS
     C  N33              DELETE    GSSPOFR
     C                   ELSE
     C                   MOVE      PO(XLN)       POCONO
     c                   CALL      'GSS051R'
     c                   parm                    pocono
     c                   parm                    pocon2
     C   33              WRITE     GSSPOFR
     C  N33              UPDATE    GSSPOFR
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     GETORD        BEGSR
     C***********************************************
     C     UONO          CHAIN     GSSORF                             33
N11  C                   MOVE      ORST          XORST             1
     C     UTYPE         IFNE      'CPY'
     C                   MOVE      ORST          WSST
     C     UTYPE         IFNE      'DSP'
N07  C     UTYPE         ANDNE     'CH2'
     C                   MOVE      'X'           ORST
     C                   END
     C                   END
     C                   UPDATE    GSSORFR
     C     UTYPE         IFEQ      'CHG'
     C     WSST          ANDNE     '0'
     C     WSST          ANDNE     'P'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
N07  C   38WSST          IFLT      '1'
N07  C     WSST          ORGT      '3'
N07  C                   MOVE      '1'           *INLR
N07  C                   RETURN
N07  C                   END
     C                   MOVE      ORTNO         WSTNO
     C                   MOVE      ORTNO2        WSTNO2
     C                   MOVE      ORTNO3        WSTNO3
     C                   MOVE      ORCNO         WSCNO
     C     CUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         WSCNM
     C                   MOVE      ORSNO         WSSNO
     C     WSSNO         IFEQ      0
     C                   MOVE      ORSNM         WSSNM
     C                   ELSE
     C     WSSNO         CHAIN     GSSSFF                             33
     C                   MOVE      SFNM          WSSNM
     C                   END
     C                   MOVE      ORRTNG        WSRTNG
N05  C                   MOVE      ORTYPE        WSTYPE
     C                   MOVE      ORBCD         WSBCD
     C     WSBCD         CHAIN     CDBOAT                             33
     C                   MOVE      CBNAB         WSBNM
     C                   MOVE      ORCLI         WSCLI
     C                   MOVE      ORWT          WSWT
     C                   MOVE      ORVOL         WSVOL
     C                   MOVE      ORDSC         WSDSC
     C                   MOVE      ORAMT         WSAMT
     C                   MOVE      ORCURC        WSCURC
     C                   MOVE      ORCLNF        WSCLNF
     C                   MOVE      ORCLNT        WSCLNT
     C                   MOVE      ORDTWÅ        WSDTWÅ
     C                   MOVE      ORDTWM        WSDTWM
     C                   MOVE      ORDTWD        WSDTWD
     C                   MOVE      ORDTLÅ        WSDTLÅ
     C                   MOVE      ORDTLM        WSDTLM
     C                   MOVE      ORDTLD        WSDTLD
     C                   MOVE      ORPOAA        WSPOAA
     C                   MOVE      ORPOMM        WSPOMM
     C                   MOVE      ORPODD        WSPODD
     C                   MOVE      ORDT2Å        WSDT2Å
     C                   MOVE      ORDT2M        WSDT2M
     C                   MOVE      ORDT2D        WSDT2D
     C                   MOVE      ORDT3Å        WSDT3Å
     C                   MOVE      ORDT3M        WSDT3M
     C                   MOVE      ORDT3D        WSDT3D
     C                   MOVE      ORLC          WSLC
     C                   MOVE      ORPORT        wsPORT
     C                   MOVE      ORLC2         WSLC2
     C                   MOVE      ORLC3         WSLC3
     C                   MOVE      ORPOS1        WSPOS1
     C                   MOVE      ORPOS2        WSPOS2
     C                   MOVE      ORPOS3        WSPOS3
     C                   MOVE      ORFTCD        WSFTCD
     C                   MOVE      ORFT1         WSFT1
     C                   MOVE      ORFT2         WSFT2
     C                   MOVE      ORFT3         WSFT3
     C                   MOVE      ORFT4         WSFT4
     C                   MOVE      ORKDL1        WSKDL1
     C                   MOVE      ORKDL2        WSKDL2
     C                   MOVE      ORKDL3        WSKDL3
     C                   MOVE      OROT          WSOT
     C                   MOVE      ORFR          WSFR
     C                   MOVE      ORDTRÅ        WSDTRÅ
     C                   MOVE      ORDTRM        WSDTRM
     C                   MOVE      ORDTRD        WSDTRD
     C     UONO          CHAIN     GSSPAF                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      PATXT1        WSTXT1
     C                   MOVE      PAPKD         WSPKD
     C                   ELSE
     C                   MOVE      *BLANKS       WSTXT1
     C                   MOVE      *BLANKS       WSPKD
     C                   END
     C     UTYPE         IFNE      'CPY'
     C     ORST2         ANDNE     *BLANKS
     C                   MOVE      ORST2         WSST2
     C     KUFASK        CHAIN     KUFAST                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      KFTXTE        XFTXTE
     C                   ELSE
     C                   MOVEL     '*UNKNOW'     XFTXTE
     C                   END
     C                   END
      *
     C     ORONO         SETLL     GSSPOF                             33
     C     ORONO         READE(N)  GSSPOF                                 33
     C                   MOVE      *BLANKS       PO
     C                   MOVE      *ZEROS        XN
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XN
     C                   MOVE      POCONO        PO(XN)
     C     ORONO         READE(N)  GSSPOF                                 33
     C  N33              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTMLP        BEGSR
     C***********************************************
     C                   MOVE      UBIPRM        WSPRTM
     C                   MOVE      'Y'           WSSK
     C     STPRT         TAG
     C                   EXFMT     GSS011DB
     C                   MOVE      '0'           *IN99
     C  N12              DO
     C     WSPRTM        COMP      *BLANKS                                99
     C   99              GOTO      STPRT
     C     WSSK          IFEQ      'Y'
     C                   MOVE      ORONO         UPONO             7
     C                   MOVE      WSDTL         UPDTL             6
     C                   CALL      'GSS011RP'
     C                   PARM                    WSPRTM                         PRINTNAVN
     C                   PARM                    UPONO                          INTER ORDRENR
N09  C                   PARM                    WSTYPE                         ORDRETYPE
     C                   PARM                    WSBNM                          BÅTNAVN
     C                   PARM                    WSCNM                          KUNDENAVN
     C                   PARM                    WSSNM                          LEVERANDØR
     C                   PARM                    UPDTL                          LEV.DATO
     C                   PARM                    WSCLI                          ANTALL KOLLI
     C                   PARM                    WSCON1                         P.O.NR 1
     C                   PARM                    WSCON2                         P.O.NR 2
     C                   PARM                    WSCON3                         P.O.NR 3
     C                   PARM                    WSCON4                         P.O.NR 4
     C                   PARM                    WSCON5                         P.O.NR 5
     C                   PARM                    WSCON6                         P.O.NR 6
     C                   ELSE
     C                   EXSR      UTMLP
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     UTMLP         BEGSR
     C***********************************************
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     XCMD11        CAT       WSPRTM:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   OPEN      GSS011P
     C     WSSNO         IFEQ      0
     C                   MOVE      WSSNM         SFNM
     C                   MOVE      *BLANKS       SFAD1
     C                   MOVE      *BLANKS       SFAD2
     C                   MOVE      *BLANKS       SFAD3
     C                   MOVE      *BLANKS       SFTEL
     C                   MOVE      *BLANKS       SFFAX
     C                   END
      *
     C     1             DO        WSCLI         XSIDE
     C                   WRITE     GSS011PA
     C                   END
      *
     C                   CLOSE     GSS011P
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C                   Z-ADD     1             UFLAGG            1 0
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     36
     C     POSNBR        ANDLE     40
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULKA
     C                   CALL      'SYFI10F'
     C                   PARM                    WSPORT
     C                   PARM                    UNVN             30
     C                   PARM                    ULKA              2
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     29
     C                   EXSR      SØKUNR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     22
S01  C*    POSNBR        ANDLE     24
N01  C     POSNBR        ANDLE     26
     C                   CALL      'GSS005R'
     C                   PARM                    UFLAGG
     C                   PARM                    WSSNO
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     24
     C                   CALL      'SYSJ11A'
     C                   PARM                    WSBCD
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     22
     C     POSNBR        ANDLE     26
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULKA
     C                   CALL      'SYFI10F'
     C                   PARM                    WSLC
     C                   PARM                    UNVN             30
     C                   PARM                    ULKA              2
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     54
     C     POSNBR        ANDLE     55
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOT
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     68
     C     POSNBR        ANDLE     70
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WSFR
     C                   PARM                    USPED
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     37
     C     POSNBR        ANDLE     39
     C                   MOVE      'J'           USØK              1
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSCURC
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     19
     C                   CALL      'SYFI10I'
     C                   PARM                    WSFTCD
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'GSS0013'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     KUBIKK        BEGSR
     C***********************************************
S13  C*                  MOVE      'J'           XFLYTM
      * SUBROUTINE FOR CUBIKK
S13  C*                  CALL      'SYIN10B'
S13  C*                  PARM                    Uavd              4 0
S13  C*                  PARM                    Uopd              7 0
S13  C*                  PARM                    Ufbn              3 0
S13  C*                  PARM                    XFLYTM            1
N13  C                   CALL      'GSS082R'
N13  C                   PARM                    ORONO
     C                   PARM                    UM3               7 3
N13  C                   PARM                    UANT              5 0
N13  C                   PARM                    UVKT              8 2
S13  C*                  PARM                    HØ
S13  C*                  PARM                    LE
S13  C*                  PARM                    BR
S13  C*                  PARM                    AN
     C     UM3           IFNE      *ZEROS
     C                   Z-ADD(H)  UM3           WSVOL
     C                   END
N13  C     UANT          IFNE      *ZEROS
N13  C                   Z-ADD(H)  UANT          WSCLI
N13  C                   END
N13  C     UVKT          IFNE      *ZEROS
N13  C                   Z-ADD(H)  UVKT          WSWT
N13  C                   END
      *
     C                   ENDSR
      *
N11   ***********************************************
N11  C     OPDLOG        BEGSR
N11   ***********************************************
N11  C                   IF        WSDTL = 0 AND ORDTL = 0
N11  C                   MOVE      *ZEROS        XDTL              8 0
N11  C                   ELSE
N11  C                   EVAL      XDTL = 20000000 + WSDTLÅ * 10000
N11  C                             + WSDTLM * 100 + WSDTLD
N11  C                   END
N11  C                   IF        WSDTWL = 0 AND ORDTWL = 0
N11  C                   MOVE      *ZEROS        XDTWL             8 0
N11  C                   ELSE
N11  C                   EVAL      XDTWL = 20000000 + WSDTWÅ * 10000
N11  C                             + WSDTWM * 100 + WSDTWD
N11  C                   END
N11  C                   IF        WSST2  <> ORST2  OR
N11  C                             WSTYPE <> ORTYPE OR
N11  C                             WSBCD  <> ORBCD  OR
N11  C                             WSSNM  <> ORSNM  OR
N11  C                             WSCLI  <> ORCLI  OR
N11  C                             WSWT   <> ORWT   OR
N11  C                             WSVOL  <> ORVOL  OR
N11  C                             WSDSC  <> ORDSC  OR
N11  C                             WSLC   <> ORLC   OR
N11  C                             XDTL   <> ORDTL  OR
N11  C                             XDTWL  <> ORDTWL OR
N11  C                             WSPOS1 <> ORPOS1 OR
N11  C                             WSPOS2 <> ORPOS2 OR
N11  C                             WSPOS3 <> ORPOS3 OR
N11  C                             WSOT   <> OROT   OR
N11  C                             WSFR   <> ORFR   OR
N11  C                             WSAMT  <> ORAMT  OR
N11  C                             WSCURC <> ORCURC OR
N11  C                             WSCLNF <> ORCLNF OR
N11  C                             WSCLNT <> ORCLNT
N11  C                   CLEAR                   GSSLGFR
N11  C                   EVAL      LGUSER = WUSER
N11  C                   CALL      'SYGE15C'
N11  C                   PARM                    WDT               8
N11  C                   PARM                    WTM               6
N11  C                   MOVE      WDT           LGDT
N11  C                   MOVE      WTM           LGTID
N11  C                   MOVE      WDT           LGHDT
N11  C                   MOVE      WTM           LGHTID
N11  C                   EVAL      LGPGM  = 'GSS011R'
N11  C                   EVAL      LGNIVÅ = 3
N11  C                   EVAL      LGFTYP = 'CHGOR'
N11  C                   EVAL      LGONO  = ORONO
N11  C                   IF        WSST2  <> ORST2
N11  C                   EVAL      LGTXT  = 'Status 2 is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORST2)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSST2)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSTYPE <> ORTYPE
N11  C                   EVAL      LGTXT  = 'Order type is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORTYPE)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSTYPE)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSBCD  <> ORBCD
N11  C                   EVAL      LGTXT  = 'Wessel code is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORBCD)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSBCD)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSSNM  <> ORSNM
N11  C                   EVAL      LGTXT  = 'Supplier is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORSNM)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSSNM)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSCLI  <> ORCLI
N11  C                   EVAL      LGTXT  = 'Colli is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORCLI
N11  C                   EVAL      LGNNY  = WSCLI
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSWT   <> ORWT
N11  C                   EVAL      LGTXT  = 'Weight is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORWT
N11  C                   EVAL      LGNNY  = WSWT
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSVOL  <> ORVOL
N11  C                   EVAL      LGTXT  = 'Volumn is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORVOL
N11  C                   EVAL      LGNNY  = WSVOL
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSDSC  <> ORDSC
N11  C                   EVAL      LGTXT  = 'Goods description is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORDSC)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSDSC)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSLC   <> ORLC
N11  C                   EVAL      LGTXT  = 'Location is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORLC)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSLC)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        XDTL   <> ORDTL
N11  C                   EVAL      LGTXT  = 'Deliveried date is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORDTL
N11  C                   EVAL      LGNNY  = XDTL
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        XDTWL  <> ORDTWL
N11  C                   EVAL      LGTXT  = 'Expected del.date is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORDTWL
N11  C                   EVAL      LGNNY  = XDTWL
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSPOS1 <> ORPOS1
N11  C                   EVAL      LGTXT  = 'Position 1 is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORPOS1)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSPOS1)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSPOS2 <> ORPOS2
N11  C                   EVAL      LGTXT  = 'Position 2 is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORPOS2)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSPOS2)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSPOS3 <> ORPOS3
N11  C                   EVAL      LGTXT  = 'Position 3 is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORPOS3)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSPOS3)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSOT   <> OROT
N11  C                   EVAL      LGTXT  = 'SYSPED Order type is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(OROT)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSOT)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSFR   <> ORFR
N11  C                   EVAL      LGTXT  = 'SYSPED delivery way is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORFR)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSFR)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSAMT  <> ORAMT
N11  C                   EVAL      LGTXT  = 'Amount is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORAMT
N11  C                   EVAL      LGNNY  = WSAMT
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSCURC <> ORCURC
N11  C                   EVAL      LGTXT  = 'Currency code is changed.'
N11  C                   EVAL      LGAGM  = 'From ' + %TRIM(ORCURC)
N11  C                             + '          Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = 'To ' + %TRIM(WSCURC)
N11  C                   EVAL      LGNGM  = 0
N11  C                   EVAL      LGNNY  = 0
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSCLNF <> ORCLNF
N11  C                   EVAL      LGTXT  = 'Colli number from is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORCLNF
N11  C                   EVAL      LGNNY  = WSCLNF
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11  C                   IF        WSCLNT <> ORCLNT
N11  C                   EVAL      LGTXT  = 'Colli number to is changed.'
N11  C                   EVAL      LGAGM  = 'Status=' + %TRIM(XORST)
N11  C                   EVAL      LGANY  = *BLANKS
N11  C                   EVAL      LGNGM  = ORCLNT
N11  C                   EVAL      LGNNY  = WSCLNT
N11  C                   WRITE     GSSLGFR
N11  C                   END
N11   *
N11  C                   END
N11   *
N11  C                   ENDSR
N11   *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSCNO
     C     GSSPOK        KLIST
     C                   KFLD                    POONO
     C                   KFLD                    POLNO
     C     KODVAK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSCURC
     C     KODOTK        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    WSOT
     C                   MOVE      'OTY'         KO1UNI
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    WSFR
     C                   MOVE      'FR'          KFRUNI
     C     KODF1K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN1              1 0
     C                   Z-ADD     1             XLN1
     C     KODF2K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN2              1 0
     C                   Z-ADD     2             XLN2
     C     KODF3K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN3              1 0
     C                   Z-ADD     3             XLN3
     C     KODF4K        KLIST
     C                   KFLD                    WSFTCD
     C                   KFLD                    XLN4              1 0
     C                   Z-ADD     4             XLN4
     C     KUFASK        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    WSST2
     C     DOKUFK        KLIST
     C                   KFLD                    DFRI
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
N04  C     GSSLGL01K     KLIST
N04  C                   KFLD                    ORONO
N04  C                   KFLD                    LGHDT
N04  C                   KFLD                    LGHTID
      *
     C     *ENTRY        PLIST
     C                   PARM                    UONO              7 0
     C                   PARM                    UTYPE             3
     C                   PARM                    UBCD              5
     C                   PARM                    UCNO              8 0
S01  C*                  PARM                    USNO              3 0
N01  C                   PARM                    USNO              5 0
     C                   PARM                    ULC               5
      *
     C                   CLEAR                   GSS011DA
     C                   CLEAR                   GSSORFR
     C                   MOVE      *ZEROS        WSDTL
     C                   MOVE      *ZEROS        ORDTL
     C                   MOVE      *ZEROS        WSDTL2
     C                   MOVE      *ZEROS        ORDTL2
     C                   MOVE      *ZEROS        WSDTL3
     C                   MOVE      *ZEROS        ORDTL3
     C                   MOVE      *ZEROS        WSDTWL
     C                   MOVE      *ZEROS        ORDTWL
     C                   MOVE      UYEAR         WSDTRÅ
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      *ZEROS        ORDTR
     C                   MOVE      *ZEROS        POLNO
     C                   MOVE      *BLANKS       PO
     C                   MOVE      'T'           CNCC
     C                   MOVE      'N'           WSPRL
     C                   MOVE      'J'           WSOK
     C                   MOVEL     'SSSTATUS'    KFTYP
     C     UTYPE         COMP      'CRT'                                  27
     C     UTYPE         COMP      'CHG'                                  28
     C     UTYPE         COMP      'DSP'                                  29
N07  C     UTYPE         COMP      'CH2'                                  38
     C                   MOVE      *BLANKS       WSST2
     C                   MOVE      *BLANKS       XFTXTE
     C                   MOVE      'F'           DFRI
     C                   Z-ADD     1             DFFBNR
     C   28
N07  COR 38
     COR 29              EXSR      GETORD
     C     UTYPE         IFEQ      'CPY'
     C                   EXSR      GETORD
     C                   MOVE      ' '           WSST
     C     ORST2         IFNE      *BLANKS
     C                   MOVE      'IPR'         WSST2
     C     KUFASK        CHAIN     KUFAST                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      KFTXTE        XFTXTE
     C                   ELSE
     C                   MOVEL     '*UNKNOW'     XFTXTE
     C                   END
     C                   END
     C                   MOVE      *ZEROS        UONO
     C                   MOVE      *ZEROS        WSTNO
     C                   MOVE      *ZEROS        WSTNO2
     C                   MOVE      *ZEROS        WSTNO3
     C                   MOVE      *ZEROS        WSCLNF
     C                   MOVE      *ZEROS        WSCLNT
     C                   MOVE      *BLANKS       WSLC2
     C                   MOVE      *BLANKS       WSLC3
     C                   MOVE      UDAY          WSDTLD
     C                   MOVE      UMONTH        WSDTLM
     C                   MOVE      UYEAR         WSDTLÅ
     C                   MOVE      UYEAR         WSDTRÅ
     C                   MOVE      UMONTH        WSDTRM
     C                   MOVE      UDAY          WSDTRD
     C                   MOVE      '1'           *IN27
     C                   END
     C     UTYPE         IFEQ      'CRT'
     C                   MOVE      UBCD          WSBCD
     C                   MOVE      UCNO          WSCNO
     C                   MOVE      USNO          WSSNO
     C                   MOVE      ULC           WSLC
     C                   MOVE      *BLANKS       WSLC2
     C                   MOVE      *BLANKS       WSLC3
     C                   MOVE      UDAY          WSDTLD
     C                   MOVE      UMONTH        WSDTLM
     C                   MOVE      UYEAR         WSDTLÅ
     C                   END
     C     WSST2         COMP      *BLANKS                            3131
     C                   SELECT
     C     WSTNO         WHENNE    0
     C                   MOVEL     WSTNO         DFAVD
     C                   MOVE      WSTNO         DFOPD
     C     WSTNO2        WHENNE    0
     C                   MOVEL     WSTNO2        DFAVD
     C                   MOVE      WSTNO2        DFOPD
     C     WSTNO3        WHENNE    0
     C                   MOVEL     WSTNO3        DFAVD
     C                   MOVE      WSTNO3        DFOPD
     C                   ENDSL
     C     DOKUFK        CHAIN     DOKUF                              32
     C   32              MOVE      *BLANKS       DF1004
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOREPO        BEGSR
     C***********************************************
     C                   exfmt     GSS011DD
      *  12              goto      endpo
     C     endpo         endsr
