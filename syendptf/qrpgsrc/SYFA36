********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 SH  PTF12 utløpsdato
12XXX * 02 SH  PTF12 historikk merke
********************************************************************
      *
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE FRAKTAVTALER              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09 11 13-20 22-24
      *** LEDIGE INDIKATORER 36-39 48-60 65-79 82 83 95-97
      ***********************************************************
      *
     FKODTW     IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FKODTVA    IF   E           K DISK
     FSTED2     IF   E           K DISK
     FKOFAST    IF   E           K DISK
     FFRATN     UF A E           K DISK
     FFRATNNY   IF   E           K DISK
     F                                     RENAME(FRATR:FRATRNY)
     FFRATFRA   IF   E           K DISK
     F                                     RENAME(FRATR:FRATRFRA)
     FFRATTIL   UF   E           K DISK
     F                                     RENAME(FRATR:FRATRTIL)
     FCUNDL01   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYFA36FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFIL2:ZRECN2)
     F                                     INFDS(FBAREA)
     D WP              S              1    DIM(12)
     D CFB             S              5  0 DIM(12)
     D CFM             S              5  0 DIM(12)
     D XFB             S              5  0 DIM(12)
     D XFM             S              5  0 DIM(12)
     D XVK             S              5  0 DIM(12)
     D AVK             S              5  0 DIM(12)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  FB01                   1      3P 0
     D  FB02                   4      6P 0
     D  FB03                   7      9P 0
     D  FB04                  10     12P 0
     D  FB05                  13     15P 0
     D  FB06                  16     18P 0
     D  FB07                  19     21P 0
     D  FB08                  22     24P 0
     D  FB09                  25     27P 0
     D  FB10                  28     30P 0
     D  FB11                  31     33P 0
     D  FB12                  34     36P 0
     D  FB                     1     36P 0
     D                                     DIM(12)
     D  FBX                    1     36
     D                 DS
     D  FM01                   1      3P 0
     D  FM02                   4      6P 0
     D  FM03                   7      9P 0
     D  FM04                  10     12P 0
     D  FM05                  13     15P 0
     D  FM06                  16     18P 0
     D  FM07                  19     21P 0
     D  FM08                  22     24P 0
     D  FM09                  25     27P 0
     D  FM10                  28     30P 0
     D  FM11                  31     33P 0
     D  FM12                  34     36P 0
     D  FM                     1     36P 0
     D                                     DIM(12)
     D  FMX                    1     36
     D                 DS
     D  KOWF1                  1      1
     D  KOWF2                  2      2
     D  KOWF3                  3      3
     D  KOWF4                  4      4
     D  KOWF5                  5      5
     D  KOWF6                  6      6
     D  KOWF7                  7      7
     D  KOWF8                  8      8
     D  KOWF9                  9      9
     D  KOWF10                10     10
     D  KOWF11                11     11
     D  KOWF12                12     12
     D  FP                     1     12
     D                                     DIM(12)
     D                 DS
     D  KOVK1                  1      5  0
     D  KOVK2                  6     10  0
     D  KOVK3                 11     15  0
     D  KOVK4                 16     20  0
     D  KOVK5                 21     25  0
     D  KOVK6                 26     30  0
     D  KOVK7                 31     35  0
     D  KOVK8                 36     40  0
     D  KOVK9                 41     45  0
     D  KOVK10                46     50  0
     D  KOVK11                51     55  0
     D  KOVK12                56     60  0
     D  FIB                    1     60  0
     D                                     DIM(12)
     D                 DS
     D  WB1                    1      5  0
     D  WB2                    6     10  0
     D  WB3                   11     15  0
     D  WB4                   16     20  0
     D  WB5                   21     25  0
     D  WB6                   26     30  0
     D  WB7                   31     35  0
     D  WB8                   36     40  0
     D  WB9                   41     45  0
     D  WB10                  46     50  0
     D  WB11                  51     55  0
     D  WB12                  56     60  0
     D  WB                     1     60  0
     D                                     DIM(12)
     D                 DS
     D  FRVK1                  1      5  0
     D  FRVK2                  6     10  0
     D  FRVK3                 11     15  0
     D  FRVK4                 16     20  0
     D  FRVK5                 21     25  0
     D  FRVK6                 26     30  0
     D  FRVK7                 31     35  0
     D  FRVK8                 36     40  0
     D  FRVK9                 41     45  0
     D  FRVK10                46     50  0
     D  FRVK11                51     55  0
     D  FRVK12                56     60  0
     D  FVK                    1     60  0
     D                                     DIM(12)
     D  FVKX                   1     60
     D                 DS
     D  WVK1                   1      5  0
     D  WVK2                   6     10  0
     D  WVK3                  11     15  0
     D  WVK4                  16     20  0
     D  WVK5                  21     25  0
     D  WVK6                  26     30  0
     D  WVK7                  31     35  0
     D  WVK8                  36     40  0
     D  WVK9                  41     45  0
     D  WVK10                 46     50  0
     D  WVK11                 51     55  0
     D  WVK12                 56     60  0
     D  WVK                    1     60  0
     D                                     DIM(12)
     D                 DS
     D  FTDT                   1      8  0
     D  FTDTÅ                  1      4  0
N01  D  FTDTÅ2                 3      4  0
     D  FTDTM                  5      6  0
     D  FTDTD                  7      8  0
N02  D                 DS
N02  D  FTDF                   1      8  0
N02  D  FTDTÅF                 1      4  0
N02  D  FTDTÅ2F                3      4  0
N02  D  FTDTMF                 5      6  0
N02  D  FTDTDF                 7      8  0
     D                 DS
     D  WSDTU                  1      6  0
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
N02  D                 DS
N02  D  WSDTF                  1      6  0
N02  D  WSDTDF                 1      2  0
N02  D  WSDTMF                 3      4  0
N02  D  WSDTÅF                 5      6  0
N02  D                 DS
N02  D  W2DATF                 1      8  0
N02  D  W2AAR2                 1      4  0
N02  D  W2MND2                 5      6  0
N02  D  W2DAG2                 7      8  0
N02  D                 DS
N02  D  WKDATF                 1      8  0
N02  D  WKAAR2                 1      4  0
N02  D  WKMND2                 5      6  0
N02  D  WKDAG2                 7      8  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
      *
     C                   EXSR      INIT
      *
     C     START0        TAG
N02  C                   EVAL      MODE='Produksjon'
N02  c                   seton                                        77
     C  N04              Z-ADD     5             LINNBR
     C  N04              Z-ADD     25            POSNBR
     C                   EXFMT     BILDE01
N02  C                   move      uhist         fthst
N02  C     uhist         ifeq      *blanks
N02  C                   EVAL      MODE='Produksjon'
N02  c                   seton                                        77
N02  C                   else
N02  C                   EVAL      MODE='Historikk'
N02  c                   setoff                                       77
N02  C                   END
     C                   MOVE      '0'           *IN99
     C                   MOVE      '0'           *IN30
     C                   MOVE      '0'           *IN32
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDT0
     C                   GOTO      START0
     C                   END
      *
     C     WSKNR         IFEQ      0
     C                   MOVE      '0'           *IN27
     C     CUN1AK        CHAIN     CUNDL01                            33
     C                   ELSE
     C     CUND1K        CHAIN     CUNDL01                            99
     C   99              MOVE      'SPK0001'     MSGNR
     C   99              MOVE      '1'           *IN30
     C   30              GOTO      START0
     C                   MOVE      '1'           *IN27
     C                   MOVE      KNAVN         WSKNV
     C                   END
     C     VALKOD        IFEQ      *BLANKS
     C                   MOVE      FICURR        XVAL
     C                   ELSE
     C                   MOVE      VALKOD        XVAL              3
     C                   END
     C                   MOVEA     FIB           AVK
      *
     C                   SETOFF                                       36
     C     WSFRA         COMP      *BLANKS                            343435
     C  N34WSTIL         COMP      *BLANKS                            3535
     C  N34
     CANN35              MOVE      '1'           *IN36
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C   34FRAFRK        SETLL     FRATFRA
     C   35FRATIK        SETLL     FRATTIL
s02  C*  36WSKNR         SETLL     FRATFRA
n02  C   36WSKNRK        SETLL     FRATFRA
N02  C   37FRATKHIS      SETGT     FRATNNY
     C     START1        TAG
     C   34FRAFRK        READE     FRATFRA                                94
     C   35FRATIK        READE(N)  FRATTIL                                94
s02  C*  36WSKNR         READE     FRATFRA                                94
s02  C   36WSKNRK        READE     FRATFRA                                94
N02  C   37FRATKHI       READPE    FRATNNY                                94
     C*
     C   34
     CANN94WSTIL         IFNE      *BLANKS
     C     WSTIL         ANDNE     FTTIL
     C                   GOTO      START1
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C                   Z-ADD     99999         FRVK12
N01  C                   EVAL      WSDTTI=FTDTÅ2+FTDTM*100+FTDTD*10000
N01  C                   EVAL      WSDTFR=FTDTÅ2F+FTDTMF*100+FTDTDF*10000
     C                   WRITE     SUBFIL
     C     STARTX        TAG
     C   34FRAFRK        READE     FRATFRA                                94
     C   35FRATIK        READE(N)  FRATTIL                                94
s02  C*  36WSKNR         READE     FRATFRA                                94
n02  C   36WSKNRK        READE     FRATFRA                                94
N02  C   37FRATKHI       READPE    FRATNNY                                94
     C   34
     CANN94WSTIL         IFNE      *BLANKS
     C     WSTIL         ANDNE     FTTIL
     C                   GOTO      STARTX
     C                   END
     C     *IN94         IFEQ      '0'
     C                   MOVE      FTFRA         YSFRA
     C                   MOVE      FTFRAN        YSFRAN
     C                   MOVE      FTOPDT        YSOPDT
     C                   MOVE      FTSK          YSSK
     C                   MOVE      FTTIL         YSTIL
     C                   END
     C  N94              END
     C                   END
      *
     C                   Z-ADD     ZRECNO        YRECNO            4 0
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C                   SETOFF                                       983081
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * UT FRA HISTORIKK
     c     *IN12         IFEQ      '1'
     C     *IN37         ANDEQ     '1'
     C                   MOVEA     '0010'        *in(34)
     C                   GOTO      START
     C                   END
      *
      *** AVSLUTT
     C   03              GOTO      SLUTT
      * FRISK OPP
     C   05              GOTO      START
      * LAGE NY
     C   06              DO                                                     1<-B
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   EXSR      MOVB2
     C                   MOVEA     AVK           WVK
     C* LEGGER INN INITIELLE VERDIER VED NYREGISTRERING
     C     *IN32         IFEQ      '1'                                           2<-B
     C                   MOVE      FTMM          W2MM
     C                   MOVE      FTPRPR        W2PRPR
     C                   MOVE      FTLMOM        W2LMOM
     C                   MOVE      FTM3OM        W2M3OM
     C                   MOVE      FTVAL         W2VAL
     C                   MOVE      FTFAST        W2FAST
     C                   MOVE      FTKOLL        W2KOLL
     C                   ELSE                                                    2
     C                   MOVE      KOVOMR        W2PRPR
     C                   MOVE      KOWMM         W2MM
     C                   MOVE      KOVLKG        W2LMOM
     C                   MOVE      KOVKKG        W2M3OM
     C                   MOVE      XVAL          W2VAL
     C                   Z-ADD     0             W2FAST
     C     1             DO        12            NP                2 0            3<-B
     C     FP(NP)        IFEQ      'F'                                             4<-B
     C                   ADD       1             W2FAST
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   GOTO      START5
     C                   END                                                    1<-E
     C*** OLJETILLEGG M.M.
     C   07              DO
     C                   CALL      'SYFA23B'
     C                   PARM                    WSKNR
     C                   GOTO      START3
     C                   END
      * 12 = tilbake
     C   12              DO
     C                   CLEAR                   VARELI
     C                   CLEAR                   BILDE01
     C                   CLEAR                   FRATR
     C                   GOTO      START0
     C                   END
      * SØK FRA
     C   08              DO
     C                   CLEAR                   VARELI
     C                   CLEAR                   BILDE01
     C                   CLEAR                   FRATR
     C                   GOTO      START0
     C                   END
      * SLETT ALLE AVTALER
     C   10              DO
     C     WSKNR         IFEQ      0
     C                   MOVE      'SHU0716'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START3
     C                   END
     C                   EXSR      SLETTA
     C   12              GOTO      START3
     C   10              GOTO      START0
     C                   END
      *
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94
     CAN 34FRFRSK        CHAIN     FRATFRA                            94
     C  N94
     CAN 35FRTISK        CHAIN(N)  FRATTIL                            94
     C  N94
     CAN 36FRFRSK        CHAIN     FRATFRA                            94
     C                   GOTO      START2
     C                   END
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C     *IN81         CABEQ     '1'           START
     C                   END
n03  c     histo         ifeq      'J'
n03  c                   goto      start
n03  c                   end
     C                   GOTO      START3
      *
     C*** CREATE A RECORD
     C     START5        TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '0000000'     *IN(84)
     C                   SETOFF                                       30
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START5
     C                   END
      *
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      START5
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     SLETTA        BEGSR
     C***********************************************
     C     STSLT         TAG
     C                   EXFMT     BILDE02
     C  N10
     CANN12              GOTO      STSLT
     C   10              DO
s02  C*    WSKNR         SETLL     FRATN                              33
n02  C     WSKNRK        SETLL     FRATN                              33
     C     STSLT2        TAG
s02  C*    WSKNR         READE     FRATN                                  33
n02  C     WSKNRK        READE     FRATN                                  33
     C  N33              DELETE    FRATR
     C  N33              GOTO      STSLT2
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
      * fikser ny dato i nøkkelbegrep
     c                   move      WSDTDF        W2DAG2
     c                   move      WSDTMF        W2MND2
     c                   move      WSDTÅF        W2AAR2
     c                   movel     20            W2AAR2
      * N40=ny record
      *
     C  N40              DO
      *
     C     KODFRK        CHAIN     KODTFR                             90
     C   90              MOVE      'SPF0006'     MSGNR
     C   90              Z-ADD     7             LINNBR
     C   90              SETON                                        30
      *
     C     W2OPDT        IFNE      'GE'
     C     KODOTK        CHAIN     KODTOTY                            89
     C   89
     CANN30              MOVE      'SPO0007'     MSGNR
     C   89
     CANN30              Z-ADD     8             LINNBR
     C   89              SETON                                        30
     C                   END
      *
     C     W2SK          COMP      ' '                                    88
     C   88
     CANN30              MOVE      'SPS0032'     MSGNR
     C   88
     CANN30              Z-ADD     9             LINNBR
     C   88              SETON                                        30
      * FRA STED.
     C     W2FRA         CHAIN     STED2                              87
      * HENT SONEKODE?? - I SÅ FALL SJEKK PÅ NY
     C  N87W2FRSO        IFNE      *BLANKS
     C                   MOVE      ST2KO2        W2FRA
     C     W2FRA         CHAIN     STED2                              87
     C                   END
     C   87              MOVE      'SPS0030'     MSGNR
     C   87              Z-ADD     10            LINNBR
     C   87              SETON                                        30
      *
     C     W2TIL         CHAIN     STED2                              86
      * HENT SONEKODE?? - I SÅ FALL SJEKK PÅ NY
     C  N86W2TISO        IFNE      *BLANKS
     C                   MOVE      ST2KO2        W2TIL
     C     W2TIL         CHAIN     STED2                              86
     C                   END
     C   86
     CANN30              DO
     C                   Z-ADD     11            LINNBR
     C                   MOVE      'SPS0030'     MSGNR
     C                   SETON                                        30
     C                   END
      *
      *  Chainer fil må ikke finnes
      *
     C     FRATK         CHAIN(N)  FRATN                              33
     C  N33
     CANN30              DO
     C                   Z-ADD     7             LINNBR
     C                   MOVE      'YBC0272'     MSGNR
     C                   SETON                                        30
     C                   END
     C                   END                                                    END (N40 DO)
      * TEST TABELTYPE
     C                   MOVEL     W2KOLL        KFKOD
     C     KOFASK        CHAIN     KOFAST                             84
     C  N30*IN84         IFEQ      '1'
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     8             POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC0348'     MSGNR
     C                   GOTO      SLTB1
     C                   END
      *
     C     KODVAK        CHAIN     KODTVA                             85
     C   85
     CANN30              DO
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     74            POSNBR
     C                   MOVE      'SPV0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C   30
     CANN85              Z-ADD     25            POSNBR
     C   30              GOTO      SLTB1
      *
      *
      * oppdaterer/skriver til CFRAT
      *
      * alt ok  legger gammel post som historikk ved endring
      *
N02  c     *in40         ifeq      '1'
N02  c     FTHST         andeq     ' '
N02  C     FTDF          andne     W2DATF
     c                   move      w2datf        w2datfg           8 0
     c                   move      ftdf          w2datf
     C     FRATK         CHAIN     FRATN                              33
N02  c  N33              move      'J'           fthst
N02  c  N33              update    fratr
N02  c                   move      ' '           fthst
     c                   move      w2datfg       ftdf
N02  c                   write     fratr
     c                   move      w2datfg       w2datf
N02  c                   end
     C     FRATK         CHAIN     FRATN                              33
     C                   EXSR      MOVWFR
     C                   MOVE      ' '           WSNR
     C   40              UPDATE    SUBFIL
     C  N40              DO
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   END
     C                   WRITE     SUBCTL
      *
     C  N33              UPDATE    FRATR
     C   33              WRITE     FRATR
     C                   MOVE      '1'           *IN32
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C     WSKNR         IFEQ      W2KNR
     C     WKFRAN        ANDEQ     W2FRAN
     C     WKOPDT        ANDEQ     W2OPDT
     C     WKSK          ANDEQ     W2SK
     C     WKFRA         ANDEQ     W2FRA
     C     WKTIL         ANDEQ     W2TIL
     C                   MOVE      'YBC0140'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     6             LINNBR
     C                   GOTO      SLTB2
     C                   END
      *
     C     W2KNR         IFNE      0
     C     CUNK1K        CHAIN     CUNDL01                            80
     C   80              MOVE      'SPK0001'     MSGNR
     C   80              MOVE      '1'           *IN30
     C   80              Z-ADD     6             LINNBR
     C                   END
      *
     C     W2FRAN        IFNE      *BLANKS
     C     KODFRK        CHAIN     KODTFR                             90
     C   90
     CANN30              MOVE      'SPF0006'     MSGNR
     C   90
     CANN30              Z-ADD     7             LINNBR
     C   90              SETON                                        30
     C                   END
      *
     C     W2OPDT        IFNE      *BLANKS
     C     W2OPDT        ANDNE     'GE'
     C     KODOTK        CHAIN     KODTOTY                            89
     C   89
     CANN30              MOVE      'SPO0007'     MSGNR
     C   89
     CANN30              Z-ADD     8             LINNBR
     C   89              SETON                                        30
     C                   END
      * FRA STED.
     C     W2FRA         IFNE      *BLANKS
     C     W2FRA         CHAIN     STED2                              87
     C  N87W2FRSO        IFNE      *BLANKS
     C                   MOVE      ST2KO2        W2FRA
     C     W2FRA         CHAIN     STED2                              87
     C                   END
     C   87
     CANN30              MOVE      'SPS0030'     MSGNR
     C   87
     CANN30              Z-ADD     10            LINNBR
     C   87              SETON                                        30
     C                   END
      *
     C     W2TIL         IFNE      *BLANKS
     C     W2TIL         CHAIN     STED2                              86
     C  N86W2TISO        IFNE      *BLANKS
     C                   MOVE      ST2KO2        W2TIL
     C     W2TIL         CHAIN     STED2                              86
     C                   END
     C   86
     CANN30              DO
     C                   Z-ADD     11            LINNBR
     C                   MOVE      'SPS0030'     MSGNR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C   30              Z-ADD     40            POSNBR
     C   30              GOTO      SLTB2
      *
      * KOPIERE AVTALER
     C                   EXSR      KOPIAV
      *
     C     SLTB2         ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       15            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '2'
     C     FTFRA         COMP      '*DLT '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      CHGFRT
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '3'
     C     FTFRA         COMP      '*DLT '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      CPYFRT
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '4'
     C     FTFRA         COMP      '*DLT '                                98
     C   98              GOTO      SLHENT
     C                   EXSR      DLTFRT
     C   12              GOTO      SLHENT
     C                   END
N02  C     WSNR          IFEQ      'H'
N02  c                   move      'J'           histo             1
N02  C                   MOVE      ' '           wsnr
N02  c                   update    subfil
n02  C                   MOVEA     '0001'        *IN(34)
n02  C                   GOTO      SLHENT
n02  C                   END
     C                   END
      *
     C     SLHENT        TAG
     C   98              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   SETON                                            30
     C                   END
     C                   ADD       4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGFRT        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   SETON                                        40
     C                   EXSR      MOVFRW
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     10            POSNBR
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '0000000'     *IN(84)
     C                   MOVE      '0'           *IN30
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C   12              DO
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVB2
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYFRT        BEGSR
     C***********************************************
     C                   MOVE      FTFRAN        WKFRAN
     C                   MOVE      FTOPDT        WKOPDT
     C                   MOVE      FTSK          WKSK
     C                   MOVE      FTFRA         WKFRA
     C                   MOVE      FTTIL         WKTIL
N02  C                   MOVE      FTDF          WKDATF
     C                   EXSR      MOVC11
     C                   MOVE      WSKNR         W2KNR
     C                   MOVE      FTFRAN        W2FRAN
     C                   MOVE      FTOPDT        W2OPDT
     C                   MOVE      FTSK          W2SK
     C                   MOVE      FTFRA         W2FRA
     C                   MOVE      FTTIL         W2TIL
N02  C                   MOVE      *ZEROS        W2DATF
     C                   SETON                                        99
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     40            POSNBR
      *
     C     STCPY         TAG
     C                   EXFMT     VAREL2
     C                   MOVEA     '000000'      *IN(85)
     C                   MOVE      '0'           *IN80
     C                   MOVE      '0'           *IN30
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      STCPY
     C                   END
     C     *IN12         IFEQ      '1'
     C                   EXSR      MOVB2
     C                   ELSE
     C                   EXSR      TESTB2
     C   12              Z-ADD     6             LINNBR
     C   12              Z-ADD     40            POSNBR
     C   12
     COR 30              GOTO      STCPY
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     DLTFRT        BEGSR
     C***********************************************
     C                   SELECT
     C     FTMM          WHENEQ    1
     C                   MOVE      'MIN'         WSMIMA
     C                   MOVE      '1'           *IN47
     C     FTMM          WHENEQ    2
     C                   MOVE      'MAX'         WSMIMA
     C                   MOVE      '1'           *IN47
     C                   OTHER
     C                   MOVE      '0'           *IN47
     C                   END
     C                   SETON                                        99
     C                   EXFMT     VAREL3
     C  N12              DO
     C     FRATDK        CHAIN     FRATN                              33
     C  N33              DELETE    FRATR
     C                   EXSR      MOVB1
     C                   MOVE      '0'           *IN32
     C                   END
     C     XLIN          IFEQ      0
     C                   Z-ADD     15            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     KOPIAV        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       YKFRAN
     C                   MOVE      *BLANKS       YKOPDT
     C                   MOVE      *BLANKS       YKSK
     C                   MOVE      *BLANKS       YKFRA
     C                   MOVE      *BLANKS       YKTIL
     C                   MOVEA     '000000'      *IN(41)
      *
     C                   SELECT
     C     W2FRAN        WHENEQ    *BLANKS
     C                   MOVE      '1'           *IN41
     C     W2OPDT        WHENEQ    *BLANKS
     C                   MOVE      WKFRAN        YKFRAN
     C                   MOVE      '1'           *IN42
     C     W2SK          WHENEQ    *BLANKS
     C                   MOVE      WKFRAN        YKFRAN
     C                   MOVE      WKOPDT        YKOPDT
     C                   MOVE      '1'           *IN43
     C     W2FRA         WHENEQ    *BLANKS
     C                   MOVE      WKFRAN        YKFRAN
     C                   MOVE      WKOPDT        YKOPDT
     C                   MOVE      WKSK          YKSK
     C                   MOVE      '1'           *IN44
     C     W2TIL         WHENEQ    *BLANKS
     C                   MOVE      WKFRAN        YKFRAN
     C                   MOVE      WKOPDT        YKOPDT
     C                   MOVE      WKSK          YKSK
     C                   MOVE      WKFRA         YKFRA
     C                   MOVE      '1'           *IN45
     C                   OTHER
     C                   MOVE      WKFRAN        YKFRAN
     C                   MOVE      WKOPDT        YKOPDT
     C                   MOVE      WKSK          YKSK
     C                   MOVE      WKFRA         YKFRA
     C                   MOVE      WKTIL         YKTIL
     C                   MOVE      '1'           *IN46
     C                   ENDSL
      *
      * KOPIERE AVTALE TIL SUBFIL2 OG VISE PÅ SKJERMEN
     C                   EXSR      KOPI2
      * KOPIERE AVTALER FRA SUBFIL2 TIL AVTALE-FIL
     C  N12              EXSR      KOPI3
      * BLANKE ALLE INNPUT FELTER
     C  N12              EXSR      MOVB2
      *
     c  N12              move      w2knr         w2knra            8
     c  N12              call      'SYFA36HK'
     c                   parm                    w2knra
     C                   ENDSR
      *
     C***********************************************
     C     KOPI2         BEGSR
     C***********************************************
     C                   MOVE      '0'           *IN31
     C                   MOVE      '1'           *IN63
     C                   WRITE     SUBCTL2
     C                   MOVEA     '00'          *IN(63)
     C                   Z-ADD     *ZEROS        ZRECN2
     C     W2KNR         COMP      0                                  2828
     C                   MOVE      'DIV0000'     MSGNR
      *
     C     FRATKK        SETLL     FRATN                              33
     C     STKP2         TAG
s02  C*  41WSKNR         READE(N)  FRATN                                  33
n02  C   41WSKNRK        READE(N)  FRATN                                  33
     C   42FRAK2K        READE(N)  FRATN                                  33
     C   43FRAK3K        READE(N)  FRATN                                  33
     C   44FRAK4K        READE(N)  FRATN                                  33
     C   45FRAK5K        READE(N)  FRATN                                  33
     C   46FRAK6K        READE(N)  FRATN                                  33
     C     *IN33         IFEQ      '0'                                          1<-B
      *
     C     W2FRAN        IFNE      *BLANKS                                       2<-B
     C     WKFRAN        IFEQ      FTFRAN                                         3<-B
     C                   MOVE      W2FRAN        FTFRAN
     C                   ELSE                                                     3
     C                   GOTO      STKP2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     W2OPDT        IFNE      *BLANKS                                       2<-B
     C     WKOPDT        IFEQ      FTOPDT                                         3<-B
     C                   MOVE      W2OPDT        FTOPDT
     C                   ELSE                                                     3
     C                   GOTO      STKP2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     W2SK          IFNE      *BLANKS                                       2<-B
     C     WKSK          IFEQ      FTSK                                           3<-B
     C                   MOVE      W2SK          FTSK
     C                   ELSE                                                     3
     C                   GOTO      STKP2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C     W2FRA         IFNE      *BLANKS                                       2<-B
     C     WKFRA         IFEQ      FTFRA                                          3<-B
     C                   MOVE      W2FRA         FTFRA
     C                   ELSE                                                      3
     C                   GOTO      STKP2
     C                   END                                                       3<-E
     C                   END                                                      3<-E
     C     W2TIL         IFNE      *BLANKS                                       2<-B
     C     WKTIL         IFEQ      FTTIL                                          3<-B
     C                   MOVE      W2TIL         FTTIL
     C                   ELSE                                                     3
     C                   GOTO      STKP2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      *
     C                   MOVE      W2KNR         FTKNR
     C                   EXSR      MOVC21
     C     FRATTK        CHAIN(N)  FRATTIL                            29
     C                   EXSR      MOVC22
      *
     C     *IN29         IFEQ      '1'                                           2<-B
     C                   MOVE      'N'           XJN
     C                   ELSE                                                    2
      * IKKE KOPIERE TIL SEG SELV
     C     WSKNR         IFEQ      FTKNR                                          3<-B
     C     WKFRAN        ANDEQ     FTFRAN
     C     WKOPDT        ANDEQ     FTOPDT
     C     WKSK          ANDEQ     FTSK
     C     WKFRA         ANDEQ     FTFRA
     C     WKTIL         ANDEQ     FTTIL
     C                   GOTO      STKP2
     C                   END                                                      3<-E
      *
     C                   MOVE      'YBC0141'     MSGNR
     C                   MOVE      '1'           *IN31
     C                   MOVE      'J'           XJN
     C     WSKNR         IFEQ      FTKNR                                          3<-B
     C     W2FRAN        IFNE      *BLANKS                                         4<-B
     C     WKFRAN        ANDNE     FTFRAN
     C                   GOTO      STKP21
     C                   END                                                       4<-E
     C     W2OPDT        IFNE      *BLANKS                                         4<-B
     C     WKOPDT        ANDNE     FTOPDT
     C                   GOTO      STKP21
     C                   END                                                       4<-E
     C     W2SK          IFNE      *BLANKS                                         4<-B
     C     WKSK          ANDNE     FTSK
     C                   GOTO      STKP21
     C                   END                                                       4<-E
     C     W2FRA         IFNE      *BLANKS                                         4<-B
     C     WKFRA         ANDNE     FTFRA
     C                   GOTO      STKP21
     C                   END                                                       4<-E
     C     W2TIL         IFNE      *BLANKS                                         4<-B
     C     WKTIL         ANDNE     FTTIL
     C                   GOTO      STKP21
     C                   END                                                       4<-E
     C                   EXSR      MOVC12
     C     STKP21        TAG
     C                   END                                                      3<-E
      *
     C                   END                                                     2<-E
      *
     C                   ADD       1             ZRECN2
N01  C                   EVAL      WSDTFR=FTDTÅ2F+FTDTMF*100+FTDTDF*10000
     C                   WRITE     SUBFIL2
     C                   GOTO      STKP2
     C                   END                                                    1<-E
      *
     C     ZRECN2        IFEQ      0
     C                   MOVE      'YBC0147'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN12
     C                   ELSE
      * VISE AVTALER SOM SKAL KOPIERES PÅ SKJERMEN
     C                   MOVE      ZRECN2        XRECN2            5 0
     C                   Z-ADD     1             ZRECN2
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   MOVEA     '11'          *IN(61)
     C     ZRECN2        COMP      15                                   6464
     C                   WRITE     SUBCTL2
     C                   EXFMT     BUNN2
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     KOPI3         BEGSR
     C***********************************************
     C     1             DO        XRECN2        ZRECN2
     C     ZRECN2        CHAIN     SUBFIL2                            61
     C     XJN           IFEQ      'N'
     C                   MOVE      '1'           *IN81
     C                   WRITE     FRATR
     C                   ELSE
     C     *IN21         IFEQ      '1'
     C                   MOVE      '1'           *IN81
     C                   EXSR      MOVC21
     C     FRATTK        CHAIN     FRATTIL                            29
     C                   EXSR      MOVC22
     C  N29              UPDATE    FRATRTIL
     C                   END
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVWFR        BEGSR
     C***********************************************
     C                   MOVE      WSKNR         FTKNR
     C                   MOVE      W2FRAN        FTFRAN
     C                   MOVE      W2OPDT        FTOPDT
     C                   MOVE      W2FRA         FTFRA
     C                   MOVE      W2TIL         FTTIL
     C                   MOVE      W2SK          FTSK
     C                   MOVEA     WB            FB
     C                   MOVE      W2MIN         FTMIN
     C                   MOVE      W2MAX1        FTMAX1
N04  C                   MOVE      W2HST         FTHST
     C     WSDTU         IFEQ      0
     C                   MOVE      *ZEROS        FTDT
     C                   ELSE
     C                   MOVE      WSDTD         FTDTD
     C                   MOVE      WSDTM         FTDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          FTDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          FTDTÅ
     C                   END
     C                   END
N02  C     WSDTF         IFEQ      0
N02  C                   MOVE      *ZEROS        FTDF
N02  C                   ELSE
N02  C                   MOVE      WSDTDF        FTDTDF
N02  C                   MOVE      WSDTMF        FTDTMF
N02  C     WSDTÅF        IFGT      50
N02  C     WSDTÅF        ADD       1900          FTDTÅF
N02  C                   ELSE
N02  C     WSDTÅF        ADD       2000          FTDTÅF
N02  C                   END
N02  C                   END
     C                   MOVE      W2MAX2        FTMAX2
     C                   MOVE      W2MAX3        FTMAX3
      * INGEN MIN/MAX VED VAREVERDI / GRUNNPRIS
     C     W2KOLL        IFEQ      'V'
     C     W2KOLL        OREQ      'G'
     C                   MOVE      *ZEROS        W2MM
     C                   MOVE      *ZEROS        W2PRPR
     C                   END
      *STYKK/LASTEM./KUBIKK/GRUNNPRIS+KILORATE  ER ALLTID PR 1!
     C     W2KOLL        IFEQ      'X'
     C     W2KOLL        OREQ      'T'
     C     W2KOLL        OREQ      'L'
     C     W2KOLL        OREQ      'M'
     C     W2KOLL        OREQ      'G'
     C                   Z-ADD     1             W2PRPR
     C                   END
     C                   MOVE      W2PRPR        FTPRPR
     C                   MOVE      W2FAST        FTFAST
     C                   MOVE      W2KOLL        FTKOLL
     C                   MOVE      W2KODE        FTKODE
     C                   MOVE      W2MM          FTMM
     C                   MOVE      W2VAL         FTVAL
     C                   MOVE      W2LMOM        FTLMOM
     C                   MOVE      W2M3OM        FTM3OM
     C                   Z-ADD     99999         WVK12
     C                   MOVEA     WVK           FVK
     C                   MOVEA     *ZEROS        FM
     C     W2KODE        IFNE      'P'
     C     W2PRPR        IFNE      *ZEROS
     C     W2KOLL        OREQ      'M'
     C     W2KOLL        OREQ      'L'
     C     W2KOLL        OREQ      'X'
     C     W2KOLL        OREQ      'T'
     C                   EXSR      SRFM
     C                   END
     C                   END
     C                   MOVEA     FVK           AVK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVFRW        BEGSR
     C***********************************************
     C                   MOVE      FTHST         W2HST
     C                   MOVE      FTFRAN        W2FRAN
     C                   MOVE      FTOPDT        W2OPDT
     C                   MOVE      FTFRA         W2FRA
     C                   MOVE      FTSK          W2SK
     C                   MOVE      FTTIL         W2TIL
     C                   MOVEA     FB            WB
     C                   MOVE      FTMIN         W2MIN
     C                   MOVE      FTMAX1        W2MAX1
     C                   MOVE      FTDTD         WSDTD
     C                   MOVE      FTDTM         WSDTM
     C                   MOVE      FTDTÅ         WSDTÅ
N02  C                   MOVE      FTDTDf        WSDTDf
N02  C                   MOVE      FTDTMf        WSDTMf
N02  C                   MOVE      FTDTÅf        WSDTÅf
     C                   MOVE      FTMAX2        W2MAX2
     C                   MOVE      FTMAX3        W2MAX3
     C                   MOVE      FTPRPR        W2PRPR
     C                   MOVE      FTFAST        W2FAST
     C                   MOVE      FTKOLL        W2KOLL
     C                   MOVE      FTKODE        W2KODE
     C                   MOVE      FTMM          W2MM
     C                   MOVE      FTVAL         W2VAL
     C                   MOVE      FTLMOM        W2LMOM
     C                   MOVE      FTM3OM        W2M3OM
     C                   MOVEA     FVK           WVK
     C                   SELECT
     C     FTMM          WHENEQ    1
     C                   MOVE      'MIN'         WSMIMA
     C                   MOVE      '1'           *IN47
     C     FTMM          WHENEQ    2
     C                   MOVE      'MAX'         WSMIMA
     C                   MOVE      '1'           *IN47
     C                   OTHER
     C                   MOVE      '0'           *IN47
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   move      ' '           FTHST
     C                   MOVE      *BLANKS       FTFRAN
     C                   MOVE      *BLANKS       FTOPDT
     C                   MOVE      *BLANKS       FTFRA
     C                   MOVE      '*DLT '       FTFRA
     C                   MOVE      *BLANKS       FTSK
     C                   MOVE      *BLANKS       FTTIL
     C                   MOVE      *ZEROS        FB
     C                   MOVE      *ZEROS        FTMIN
     C                   MOVE      *ZEROS        FTMAX1
     C                   MOVE      *ZEROS        FTDT
N02  C                   MOVE      *ZEROS        FTDF
     C                   MOVE      *ZEROS        FTMAX2
     C                   MOVE      *ZEROS        FTMAX3
     C                   MOVE      *ZEROS        FTFAST
     C                   MOVE      *BLANKS       FTKODE
     C                   MOVE      *BLANKS       FTKOLL
     C                   MOVE      *ZEROS        FTPRPR
     C                   MOVE      *ZEROS        FTMM
     C                   MOVE      *BLANKS       FTVAL
     C                   MOVE      *ZEROS        FTLMOM
     C                   MOVE      *ZEROS        FTM3OM
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *BLANKS       W2HST
     C                   MOVE      *BLANKS       W2FRAN
     C                   MOVE      *BLANKS       W2OPDT
     C                   MOVE      *BLANKS       W2FRA
     C                   MOVE      *BLANKS       W2FRSO
     C                   MOVE      *BLANKS       W2SK
     C                   MOVE      *BLANKS       W2TIL
     C                   MOVE      *BLANKS       W2TISO
     C                   MOVE      *ZEROS        WB
     C                   MOVE      *ZEROS        W2MIN
     C                   MOVE      *ZEROS        W2MAX1
     C                   MOVE      *ZEROS        WSDTU
N02  C                   MOVE      *ZEROS        WSDTF
     C                   MOVE      *ZEROS        W2MAX2
     C                   MOVE      *ZEROS        W2MAX3
     C                   MOVE      *ZEROS        W2FAST
     C                   MOVE      *BLANKS       W2KODE
     C                   MOVE      *BLANKS       W2KOLL
     C                   Z-ADD     *ZEROS        W2PRPR
     C                   MOVEA     *ZEROS        FM
     C                   MOVE      '0'           *IN47
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDT0        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     32
     C                   EXSR      SØKKUN
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK0
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSFRA
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     10            LINNBR
     C                   GOTO      SLSØK0
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSTIL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     12            LINNBR
     C                   GOTO      SLSØK0
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK0        TAG
     C                   Z-ADD     25            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C  N40LINNBR        IFEQ      7
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     27
     C                   CALL      'SYFI10G'
     C                   PARM                    W2FRAN
     C                   PARM                    USPED
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C  N40LINNBR        IFEQ      8
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     26
     C                   CALL      'SYFI10C'
     C                   PARM                    W2OPDT
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C  N40LINNBR        IFEQ      10
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2FRA
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C  N40LINNBR        IFEQ      11
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2TIL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDEQ     8
     C                   MOVE      *BLANKS       KFKOD
     C                   CALL      'SYFAKDA'
     C                   PARM                    KFTYP
     C                   PARM                    UUPDAT            1
     C                   PARM                    KFKOD
     C                   MOVEL     KFKOD         W2KOLL
     C                   Z-ADD     15            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     74
     C     POSNBR        ANDLE     76
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    W2VAL
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     47
     C                   EXSR      SØKKUN
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     42
     C                   CALL      'SYFI10G'
     C                   PARM                    W2FRAN
     C                   PARM                    USPED
     C                   Z-ADD     8             LINNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     41
     C                   CALL      'SYFI10C'
     C                   PARM                    W2OPDT
     C                   Z-ADD     9             LINNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     44
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2FRA
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     11            LINNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     44
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2TIL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     12            LINNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK2        TAG
     C                   Z-ADD     40            POSNBR
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      5
     C                   MOVE      WSKNR         UKN               8 0
     C                   ELSE
     C                   MOVE      W2KNR         UKN
     C                   END
     C                   MOVE      *BLANKS       USØKKN
      *
     C                   CALL      'SOEKKUN'
     C                   PARM                    UKN
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
      *
     C     LINNBR        IFEQ      5
     C                   MOVE      UKN           WSKNR
     C                   ELSE
     C                   MOVE      UKN           W2KNR
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVC11        BEGSR
     C***********************************************
     C                   MOVE      FB            CFB
     C                   MOVE      FM            CFM
     C                   MOVE      FTMIN         WKMIN             5 0
     C                   MOVE      FTMAX1        WKMAX1            5 0
     C                   MOVE      FTDT          WKDT              8 0
     C                   MOVE      FTDF          WKDF              8 0
     C                   MOVE      FTMAX2        WKMAX2            5 0
     C                   MOVE      FTMAX3        WKMAX3            5 0
     C                   MOVE      FTKODE        WKKODE            1
     C                   MOVE      FTKOLL        WKKOLL            1
     C                   MOVE      FTPRPR        WKPRPR            5 0
     C                   MOVE      FTFAST        WKFAST            2 0
     C                   MOVE      FTMM          WKMM              1 0
     C                   MOVE      FTVAL         WKVAL             3
     C                   MOVE      FTLMOM        WKLMOM            5 0
     C                   MOVE      FTM3OM        WKM3OM            5 0
     C                   MOVEA     FVK           WVK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVC12        BEGSR
     C***********************************************
     C                   MOVE      CFB           FB
     C                   MOVE      CFM           FM
     C                   MOVE      WKMIN         FTMIN
     C                   MOVE      WKMAX1        FTMAX1
     C                   MOVE      WKDT          FTDT
      *
N02  C     W2DATF        ifeq      0
N02  C                   MOVE      WKDF          FTDF
N02  C                   else
N02  C                   MOVE      W2DATF        FTDF
N02  c                   end
     C                   MOVE      WKMAX2        FTMAX2
     C                   MOVE      WKMAX3        FTMAX3
     C                   MOVE      WKKOLL        FTKOLL
     C                   MOVE      WKKODE        FTKODE
     C                   MOVE      WKPRPR        FTPRPR
     C                   MOVE      WKFAST        FTFAST
     C                   MOVE      WKMM          FTMM
     C                   MOVE      WKVAL         FTVAL
     C                   MOVE      WKLMOM        FTLMOM
     C                   MOVE      WKM3OM        FTM3OM
     C                   MOVEA     WVK           FVK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVC21        BEGSR
     C***********************************************
     C                   MOVE      FB            XFB
     C                   MOVE      FM            XFM
     C                   MOVE      FTMIN         XXMIN             5 0
     C                   MOVE      FTMAX1        XXMAX1            5 0
     C                   MOVE      FTDT          XXDT              8 0
N02  C                   MOVE      FTDF          XXDF              8 0
     C                   MOVE      FTMAX2        XXMAX2            5 0
     C                   MOVE      FTMAX3        XXMAX3            5 0
     C                   MOVE      FTKODE        XXKODE            1
     C                   MOVE      FTKOLL        XXKOLL            1
     C                   MOVE      FTPRPR        XXPRPR            5 0
     C                   MOVE      FTFAST        XXFAST            2 0
     C                   MOVE      FTMM          XXMM              1 0
     C                   MOVE      FTVAL         XXVAL             3
     C                   MOVE      FTLMOM        XXLMOM            5 0
     C                   MOVE      FTM3OM        XXM3OM            5 0
     C                   MOVEA     FVK           XVK
      *
     C                   ENDSR
      *
     C***********************************************
     C     MOVC22        BEGSR
     C***********************************************
     C                   MOVE      XFB           FB
     C                   MOVE      XFM           FM
     C                   MOVE      XXMIN         FTMIN
     C                   MOVE      XXMAX1        FTMAX1
     C                   MOVE      XXDT          FTDT
N02  C     W2DATF        ifeq      0
N02  C                   MOVE      XXDF          FTDF
N02  C                   else
N02  C                   MOVE      W2DATF        FTDF
N02  c                   end
     C                   MOVE      XXMAX2        FTMAX2
     C                   MOVE      XXMAX3        FTMAX3
     C                   MOVE      XXKOLL        FTKOLL
     C                   MOVE      XXKODE        FTKODE
     C                   MOVE      XXPRPR        FTPRPR
     C                   MOVE      XXFAST        FTFAST
     C                   MOVE      XXMM          FTMM
     C                   MOVE      XXVAL         FTVAL
     C                   MOVE      XXLMOM        FTLMOM
     C                   MOVE      XXM3OM        FTM3OM
     C                   MOVEA     XVK           FVK
      *
     C                   ENDSR
      *
     C***********************************************
     C     SRFM          BEGSR
     C***********************************************
     C                   Z-ADD     0             NR                2 0
     C                   MOVE      *BLANKS       WP
     C     NR            DOWLT     W2FAST
     C                   ADD       1             NR
     C                   MOVE      'F'           WP(NR)
     C                   END
     C*
     C                   Z-ADD     0             YPRIS             5 0
     C                   Z-ADD     1             NR
     C* Kode 1=Maxpris i et intervall skal legges inn i neste intervall
     C* som minimumspris (MAXPRIS legges i YPRIS - Huskes til neste
     C* legges da i ARRAY FM,NR)
     C     FTMM          IFEQ      1                                            1<-B
     C*
     C* NR ER HER 1 - SPESIELT M.H.T. MINIMUM(FÅR INGENTING FRA FORIGE)
     C* Minimum enten "fast i grp" eller "Min.grp. 1" bruk høyeste
     C     FTMIN         IFGT      WB(1)                                         2<-B
     C                   Z-ADD     FTMIN         YPRIS
     C                   ELSE                                                    2
     C                   Z-ADD     WB(1)         YPRIS
     C                   END                                                     2<-E
     C                   Z-ADD     YPRIS         FM(1)
      * BEREGN MAX. I VEKTGRUPPE 1 OG LEGGE DEN I YPRIS
     C     WP(1)         IFEQ      'F'                                           2<-B
     C     WB(1)         IFGT      YPRIS                                          3<-B
     C                   Z-ADD     WB(1)         YPRIS
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     FVKX          IFEQ      *ZEROS                                         3<-B
     C     FIB(1)        MULT      WB(1)         WORK              9 0
     C                   ELSE                                                     3
     C     FVK(1)        MULT      WB(1)         WORK
     C                   END                                                      3<-E
     C     W2KOLL        IFEQ      'L'                                            3<-B
     C     W2KOLL        OREQ      'M'
     C     WORK          DIV(H)    100           YPRIS
     C                   ELSE                                                     3
     C     WORK          DIV       W2PRPR        YPRIS
     C                   END                                                      3<-E
     C     YPRIS         IFLT      FM(1)                                          3<-B
     C                   Z-ADD     FM(1)         YPRIS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*
     C     STMM1         TAG
     C     FVKX          IFEQ      *ZEROS                                        2<-B
     C     FIB(NR)       CABEQ     99999         SLMM
     C                   ELSE                                                    2
     C     FVK(NR)       CABEQ     99999         SLMM
     C                   END                                                     2<-E
     C                   MOVE      NR            N2
     C                   ADD       1             NR
      *
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C     WB(NR)        IFGT      YPRIS                                          3<-B
     C                   Z-ADD     WB(NR)        FM(NR)
     C                   Z-ADD     WB(NR)        YPRIS
     C                   ELSE                                                     3
     C                   Z-ADD     YPRIS         FM(NR)
     C                   END                                                      3<-E
     C                   ELSE                                                    2
      * LEGGE MAX. FORRIGE INN I MIN. DENNE
     C                   Z-ADD     YPRIS         FM(NR)
      * BEREGN MIN. DENNE INTERVALEN
     C     FVKX          IFEQ      *ZEROS                                         3<-B
     C     FIB(N2)       MULT      WB(NR)        WORK              9 0
     C                   ELSE                                                     3
     C     FVK(N2)       MULT      WB(NR)        WORK
     C                   END                                                      3<-E
     C     W2KOLL        IFEQ      'L'                                            3<-B
     C     W2KOLL        OREQ      'M'
     C     WORK          DIV(H)    100           YPRIS
     C                   ELSE                                                     3
      *  HVIS WSKOLL = 'X' OG WSPRPR = 0 GÅR PROGRAMMET I ERROR
      *  LEGGER DERFOR 1 I WSPRPR, MEN DET LEGGES UT 0 I FILA.
     C     W2KOLL        IFEQ      'X'                                             4<-B
     C     W2KOLL        OREQ      'T'                                             4<-B
     C                   Z-ADD     1             W2PRPR
     C                   END                                                       4<-E
     C     WORK          DIV       W2PRPR        YPRIS
     C                   END                                                      3<-E
     C     YPRIS         IFGT      FM(NR)                                         3<-B
     C                   Z-ADD     YPRIS         FM(NR)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      * BEREGN MAX. DENNE INTERVALEN OG LEGGE DENNE INN I YPRIS
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     FM(NR)        YPRIS
     C                   ELSE                                                    2
      * BEREGN MAX. DENNE INTERVALEN
     C     FVKX          IFEQ      *ZEROS                                         3<-B
     C     FIB(NR)       MULT      WB(NR)        WORK              9 0
     C                   ELSE                                                     3
     C     FVK(NR)       MULT      WB(NR)        WORK
     C                   END                                                      3<-E
     C     W2KOLL        IFEQ      'L'                                            3<-B
     C     W2KOLL        OREQ      'M'
     C     WORK          DIV(H)    100           YPRIS                            3
     C                   ELSE
      *  HVIS WSKOLL = 'X' OG WSPRPR = 0 GÅR PROGRAMMET I ERROR
      *  LEGGER DERFOR 1 I WSPRPR, MEN DET LEGGES UT 0 I FILA.
     C     WORK          DIV       W2PRPR        YPRIS
     C                   END                                                      3<-E
     C     YPRIS         IFLT      FM(NR)                                         3<-B
     C                   Z-ADD     FM(NR)        YPRIS
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   GOTO      STMM1
     C*
     C                   END                                                    1<-E
     C*
     C     FTMM          IFEQ      2                                            1<-B
     C*
     C                   Z-ADD     2             N2                2 0
     C     STMM2         TAG
     C     WP(NR)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     WB(NR)        FM(NR)
     C                   ELSE                                                    2
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS                                         3<-B
     C     FIB(NR)       MULT      WB(N2)        WORK              9 0
     C                   ELSE                                                     3
     C     FVK(NR)       MULT      WB(N2)        WORK
     C                   END                                                      3<-E
     C     W2KOLL        IFEQ      'L'                                            3<-B
     C     W2KOLL        OREQ      'M'
     C     WORK          DIV(H)    100           FM(NR)
     C                   ELSE                                                     3
     C     WORK          DIV       W2PRPR        FM(NR)
     C     FM(NR)        IFEQ      *ZEROS                                          4<-B
     C                   Z-ADD     W2MAX3        FM(NR)
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C* AVTALESPESIFIK VEKTINNDELING ???
     C     FVKX          IFEQ      *ZEROS                                        2<-B
     C     FIB(N2)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C                   ADD       1             N2
     C                   GOTO      STMM2
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C     FVK(N2)       IFNE      99999                                          3<-B
     C                   ADD       1             NR
     C                   ADD       1             N2
     C                   GOTO      STMM2
     C                   END                                                      3<-E
     C                   END                                                     2<-E
      * BEREGN MAX. PÅ SISTE VEKTINTERVALEN
     C     WP(N2)        IFEQ      'F'                                           2<-B
     C                   Z-ADD     WB(N2)        FM(N2)
     C                   ELSE                                                    2
     C     FVKX          IFEQ      *ZEROS                                         3<-B
     C     FIB(N2)       MULT      WB(N2)        WORK              9 0
     C                   ELSE                                                     3
     C     FVK(N2)       MULT      WB(N2)        WORK
     C                   END                                                      3<-E
     C     W2KOLL        IFEQ      'L'                                            3<-B
     C     W2KOLL        OREQ      'M'
     C     WORK          DIV(H)    100           WORK
     C                   ELSE                                                     3
     C     WORK          DIV(H)    W2PRPR        WORK
     C     WORK          IFEQ      *ZEROS                                          4<-B
     C                   Z-ADD     W2MAX3        WORK
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     WORK          IFGT      99999                                          3<-B
     C                   Z-ADD     99999         FM(N2)
     C                   ELSE                                                     3
     C                   Z-ADD     WORK          FM(N2)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C*
     C                   END                                                    1<-E
     C*
     C     SLMM          ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N02  C                   move      *blanks       mode             10
N02  C                   EVAL      MODE='Produksjon'
N02  c                   seton                                        77
     C     KODTWK        KLIST
     C                   KFLD                    KOWUNI
     C                   KFLD                    UAVD
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    UAVD
     C     KODTAK        KLIST
     C                   KFLD                    KOAUNI
     C                   KFLD                    UAVD
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    W2FRAN
     C     KODOTK        KLIST
     C                   KFLD                    KOTUNI
     C                   KFLD                    W2OPDT
N02  C     WSKNRK        KLIST
N02  c                   kfld                    uhist
N02  C                   KFLD                    WSKNR
     C     FRATK         KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    W2FRAN
     C                   KFLD                    W2OPDT
     C                   KFLD                    W2SK
     C                   KFLD                    W2FRA
     C                   KFLD                    W2TIL
     C                   KFLD                    FTAVTN
     c                   KFLD                    W2DATF
     C                   MOVE      *ZEROS        FTAVTN
     C     FRATKHIS      KLIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     c                   KFLD                    DAT99             8 0
     c                   z-add     99999999      dat99
     C     FRATKHI       KLIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C     FRATDK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
     C                   KFLD                    FTTIL
     C                   KFLD                    FTAVTN
     C     FRATTK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    FTKNR
     C                   KFLD                    FTTIL
     C                   KFLD                    FTFRAN
     C                   KFLD                    FTOPDT
     C                   KFLD                    FTSK
     C                   KFLD                    FTFRA
N02  C                   KFLD                    W2DATF
     C     FRAFRK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    WSFRA
     C     FRATIK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    WSTIL
     C     FRFRSK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YSFRA             5
     C                   KFLD                    YSFRAN            3
     C                   KFLD                    YSOPDT            2
     C                   KFLD                    YSSK              1
     C                   KFLD                    YSTIL             5
     C     FRTISK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YSTIL
     C                   KFLD                    YSFRAN
     C                   KFLD                    YSOPDT
     C                   KFLD                    YSSK
     C                   KFLD                    YSFRA
     C     FRATKK        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN            3
     C                   KFLD                    YKOPDT            2
     C                   KFLD                    YKSK              1
     C                   KFLD                    YKFRA             5
     C                   KFLD                    YKTIL             5
     C     FRAK2K        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN
     C     FRAK3K        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN
     C                   KFLD                    YKOPDT
     C     FRAK4K        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN
     C                   KFLD                    YKOPDT
     C                   KFLD                    YKSK
     C     FRAK5K        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN
     C                   KFLD                    YKOPDT
     C                   KFLD                    YKSK
     C                   KFLD                    YKFRA
     C     FRAK6K        KLIST
N02  c                   kfld                    UHIST
     C                   KFLD                    WSKNR
     C                   KFLD                    YKFRAN
     C                   KFLD                    YKOPDT
     C                   KFLD                    YKSK
     C                   KFLD                    YKFRA
     C                   KFLD                    YKTIL
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNR
     C     CUNK1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    W2KNR
     C     CUN1AK        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KOAKNR
     C     KODVAK        KLIST
     C                   KFLD                    YVAUNI
     C                   KFLD                    W2VAL
     C     KOFASK        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'KOLTYP'      KFTYP
     C*
     C                   MOVE      'J'           USPED             1
     C                   MOVE      'J'           USØK              1
     C                   MOVE      'W'           KOWUNI            1
     C                   MOVE      'V'           KOVUNI            1
     C                   MOVE      'A'           KOAUNI            1
     C                   MOVE      'FR'          KFRUNI            2
     C                   MOVE      'OTY'         KOTUNI            3
     C                   MOVE      'VA'          YVAUNI            2
     C                   MOVE      *ZEROS        WB
     C                   MOVE      *ZEROS        FB
     C                   MOVE      *ZEROS        FM
     C                   MOVE      *ZEROS        FVK
     C                   MOVE      *ZEROS        WVK
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   99
      *** HENTE AVDELING ***
     C     KODTAK        CHAIN     KODTA                              99
     C     KODTWK        CHAIN     KODTW                              99
     C  N99KODTVK        CHAIN     KODTV                              99
     C                   MOVE      '99999'       KOVK12
N02  c                   move      *zeros        w2datf
N02  c                   move      *zeros        wsdtu
N02  c                   move      *zeros        wsdtf
      *
     C                   ENDSR
      *
