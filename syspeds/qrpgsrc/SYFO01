********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 UTOLL
********************************************************************
      *
      * OBS!! PROGRAMMET LIGGER IKKE!!!!! I SYENDRE HOS INTERSPED!!!!
      *
      * OBS! PROGRAMMET INNEHOLDER MANGE INTERSPED-HARDKODINGER
      * DET ER KUN DE SOM PR. I DAG (980612) BRUKER PROGRAMMET
      * ENDRINGER MERKET MED INT BETYR AT DET LIGGER HARDKODINGER
      * SOM MÅ GJEØRES OM/GJØRES FLEKSIBLE HVIS ANDRE SKAL BENYTTE PGM.
      * PROGRAMMET LIGGER IKKE!!!!! I SYENDRE HOS INTERSPED!!!!
      *
INT01 * 1. BRUKE AGNETNR FOR Å HENTE LEV.KUNDENR HVIS FASHIONET.
INT01 * 2. CONSIGNMENTNR LIGGER I FO1004
INT01 * 3. IKKE GENERER FORDELINGSOPPDRAG HVIS INT.KUNDENR = 0
INT01 * 4. SEND KALL PÅ VA029R - AJOURFØR UTTAK PÅ INTERSPED LAGER
      * ENDRINGER ER MERKET MED INT
      *
      *
      *  ALLE RETTELSER FOR INTERSPED ER MERKET INT
      *
      *     BASEK- HENTER EDINUMMER TIL BASESTEDET
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE FORDELINGSLIJER TIL HOVEDOPPDRAG
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02    07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 27-29    32 34-39 41-86 95-96    ***
      ***********************************************************
      *
INT  FBASEK     IF   E           K DISK
     FLOPTEL    UF A E           K DISK
     FFORDEL    UF A E           K DISK
     FFORDEL1   IF   E           K DISK
     F                                     RENAME(FORDR:FORDR1)
     FFORDEL2   IF   E           K DISK
     F                                     RENAME(FORDR:FORDR2)
     FFORDEL3   IF   E           K DISK
     F                                     RENAME(FORDR:FORDR3)
     FFORDEL4   UF   E           K DISK
     F                                     RENAME(FORDR:FORDR4)
     FFIRM      IF   E           K DISK
     FHEADF     UF A E           K DISK
     FKUNKO2    IF A E           K DISK
     FCUNDL01   IF   E           K DISK
     FKODTV     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODTOT2   IF   E           K DISK
     FKODTU     IF   E           K DISK
     FVADR      IF   E           K DISK
     FTELL      UF   E           K DISK
     FFRATXT    IF   E           K DISK
     FFRISOK    O    E           K DISK
     FKODFRI    IF   E           K DISK
     FDOKUF     UF A E           K DISK
INT  FEDICS1    UF A E           K DISK
     FSTED2D    IF   E           K DISK
     FKUFAST    IF   E           K DISK
     FUTLLOGF   O  A E             DISK
     FSYFO01FM  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     F                                     SFILE(SUBFIL:ZRECNO)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
INT01D                 DS
INT01D  FO1004                 1     35
INT01D  XO1004                29     35
      *___________________________
      * Finner username
      *"""""""""""""""""""""""""""
     D                SDS
     D  ZJOB                 244    253
     D  ZUSER                254    263
     D  ZJOBNR               264    269  0
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
     D                 DS
     D  DSNAAD                 1     30
     D  DSNAVN                 1     15
     D  DSSK                  16     16
     D  DSSTPO                17     30
     D  DSPOST                17     20
     D  DSSTED                22     30
     D                 DS
     D  XMÅL1                  6      9
     D  XMÅL2                 11     13
     D  XMÅL                   1     13
     D                 DS
     D  DSPOCH                 1      4
     D  DSPONR                 1      4  0
     D                 DS
     D  DSSOK                  1     35
     D  DSAVD                  1      4
     D  DSOPD                  5     11
     D  DSREST                12     35
     D                 DS
     D  DSADR3                 1     30
     D  DSPNR3                 1      4
     D  DSSTE3                 6     30
     D                 DS
     D  WSTST                  1     17
     D  WSLEK                  1     17
     D                 DS
     D  SFTST                  1     17
     D  SFLEK                  1     17
     D  SFLEK2                 1     15
     D                 DS
     D  DXMSG                  1     62
     D  DXPOS1                 1      4
     D  DXLOP                  5      9
     D  DXKN14                10     17  0
     D  DXREST                18     62
     D                 DS
     D  FOADK3                 1     30
     D  W1ADK3                 1      2
     D  W2ADK3                 3     30
INT  D                 DS
INT  D  XFXLNR                 1      2  0
      *
     D                 DS
     D  QDATA                  1    109
     D  QDA01                  1      2
     D  QDA02                  3      6
     D  QDA03                  7     13
     D  QDA04                 14     14
     D  QDA05                 16     16
     D  QDA06                 17     20
     D  QDA07                 21     24
     D  QDA08                 25     26
     D  QDA09                 27     28
     D  QDA10                 29     29
     D  QDA11                 30     30
     D  QDA12                 31     37
     D  QDA13                 38     38
     D  QDA14                 39    100
     D  QDA15                101    101
     D  QDA16                102    102
     D  QDA17                103    103
     D  QDA18                104    109
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  HEFT1                  1     51
     D  HEFT1A                 1     30
     D  HEFT1B                31     45
INT01 *INT*START
     D SBM029          C                   CONST('SBMJOB CMD(CALL PGM-
     D                                     (VA029R)) JOB(VALAG-
     D                                     ERUT) JOBQ(SYJOBQAV)')
INT01 * NAVNGITT DS MED LENGDE 1024 FOR PARAMETER TIL QCMDEXEC
INT01D SBMCMD          DS          1024
     IFORDR4
     I              FOSTAT                      F4STAT
     I              FOAVD                       F4AVD
     I              FOOPD                       F4OPD
     I              FOLOP                       F4LOP
     I              FOLEK                       F4LEK
     I              FOKNR                       F4KNR
     I              FOADRN                      F4ADRN
     I              FOKLL                       F4KLL
     I              FOVSL                       F4VSL
     I              FOVKT                       F4VKT
     I              FOM3                        F4M3
     I              FOMRK                       F4MRK
     I              FOUTL                       F4UTL
     I              FOSJN                       F4SJN
     I              FOTJN                       F4TJN
     I              FOAVDI                      F4AVDI
     I              FOOPDI                      F4OPDI
     I              FOAVDV                      F4AVDV
     I              FOOPDV                      F4OPDV
     I              FOMJN                       F4MJN
     I              FOPALL                      F4PALL
     I              FOZML                       F4ZML
INT01 *INT*SLUTT
     C*
     C                   EXSR      INIT
     C*
     C                   MOVE      1             SELOP
     C*
     C     START         TAG
     C                   MOVE      *ON           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C     SELOP         IFEQ      *ZEROS
     C     SELEK         ANDEQ     *BLANKS
     C     SEKNR         ANDEQ     *ZEROS
     C     SEMRK         ANDEQ     *BLANKS
     C                   MOVE      1             SELOP
     C                   ENDIF                                                  <SELOP
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     SELOP         IFNE      *ZEROS
     C     SEKEY         SETLL     FORDEL
     C                   ELSE
     C     SELEK         IFNE      *BLANKS
     C     SEKEY2        SETLL     FORDEL2
     C                   ELSE
     C     SEKNR         IFNE      *ZEROS
     C     SEKEY1        SETLL     FORDEL1
     C                   ELSE
     C     SEMRK         IFNE      *BLANKS
     C     SEKEY3        SETLL     FORDEL3
     C                   ENDIF                                                  <SEMRK
     C                   ENDIF                                                  <SEKNR
     C                   ENDIF                                                  <SELEK
     C                   ENDIF                                                  <SELOP
      *
     C     START1        TAG
     C                   DO        6
     C     SELOP         IFNE      *ZEROS
     C     HEADKY        READE(N)  FORDEL                                 94
     C                   ELSE
     C     SELEK         IFNE      *BLANKS
     C     HEADKY        READE     FORDEL2                                94
     C                   ELSE
     C     SEKNR         IFNE      *ZEROS
     C     HEADKY        READE     FORDEL1                                94
     C                   ELSE
     C     SEMRK         IFNE      *BLANKS
     C     HEADKY        READE     FORDEL3                                94
     C                   ENDIF                                                  <SEMRK
     C                   ENDIF                                                  <SEKNR
     C                   ENDIF                                                  <SELEK
     C                   ENDIF                                                  <SELOP
     C                   MOVE      *OFF          *IN45
     C                   MOVE      *OFF          *IN54
     C     *IN94         IFEQ      *OFF
     C                   EXSR      MOVFSF
     C                   ADD       1             ZRECNO
     C                   MOVE      *BLANKS       DSNAAD
     C     KUNKE3        CHAIN     CUNDL01                            27
     C     *IN27         IFEQ      *OFF
      *
INT   * TEST OM DET SKAL SETTE STOPPKODE, IKKE TEST HVIS AVD=9484,9485
INT  C     SFUTL         IFEQ      *BLANKS
INT  C     FOAVD         ANDNE     9484
INT  C     FOAVD         ANDNE     9485
INT  C     HEOT          ANDEQ     'D1'                                         *INTERSPED**
INT  C     SYKONT        ANDEQ     *ZEROS                                       *IKKE TOLLKR
INT  C     FOAVDI        ANDEQ     *ZEROS                                       *NYTT F.OPPD
INT  C     FOOPDI        ANDEQ     *ZEROS                                       *NYTT F.OPPD
INT  C                   MOVE      '45'          SFUTL
INT  C     FORDK         CHAIN     FORDEL                             31
INT  C                   MOVE      '45'          FOUTL
INT  C                   UPDATE    FORDR
INT  C                   END
      *
     C                   MOVEL     KNAVN         DSNAVN
     C                   MOVE      '/'           DSSK
     C                   MOVE      POSTNR        DSPOST
     C                   MOVEL     ADR3          DSSTED
     C*
     C*** TEST PÅ KUNDE OPPLYSNING
     C*
     C                   Z-ADD     FOKNR         FXKNR
     C     FRATXK        SETLL     FRATXT
     C     FOKNR         READE     FRATXT                                 31
     C     *IN31         IFEQ      *ON
     C                   MOVE      *OFF          *IN54
     C                   ELSE
     C                   MOVE      *ON           *IN54
     C                   ENDIF                                                  <*IN31
     C*
     C                   ENDIF                                                  <*IN27
     C                   MOVEL     DSNAAD        SFNAVN
     C*
     C*  HENT EVENTUELL VAREADR
     C*
     C     FOADRN        IFNE      *ZEROS
     C                   Z-ADD     FOKNR         WSKNR
     C                   MOVE      FOADRN        WSADRN
     C     VADRK         CHAIN     VADR                               30
     C     *IN30         IFEQ      *OFF
     C                   MOVEL     VADRNA        DSNAVN
     C                   MOVE      '/'           DSSK
     C                   MOVEL     VADRN3        DSSTPO
     C                   MOVEL     DSNAAD        SFNAVN
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <FOADRN
     C*
     C*  SJEKK OM DET FINNES FLERE VAREADRESSER (RØDBLINK)
     C*
     C                   MOVE      *OFF          *IN45
     C                   Z-ADD     FOKNR         WSKNR
     C                   MOVE      00001         Z001
     C     VAD01K        SETLL     VADR
     C     VAD01E        READE     VADR                                   97
     C     *IN97         IFEQ      *OFF
     C     VAD01E        READE     VADR                                   96
     C     *IN96         IFEQ      *OFF
     C                   MOVE      *ON           *IN45
     C                   ENDIF                                                  <*IN96
     C                   ENDIF                                                  <*IN97
     C*
     C                   WRITE     SUBFIL
     C                   ENDIF                                                  <*IN94
     C  N94              ENDDO
     C*
INT01C     XINTFN        IFEQ      'J'
INT01C     LINT1         CHAIN     CUNDL01                            33
INT01C  N33              MOVE      KNAVN         LENAVN
INT01C                   END
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYKUNDE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   Z-ADD     WSSUBN        XRECNO
     C                   EXFMT     BUNN
     C                   ENDIF
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C*
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   ENDIF
     C*
     C                   SETOFF                                       999830
     C*** AVSLUTT
     C     ST3A          TAG
     C     *IN03         IFEQ      *ON
     C                   EXSR      SUMMER
     C                   MOVE      ' '           W3MERK
     C                   MOVE      ' '           W3SAML
     C                   MOVE      'N'           W3AVS
     C                   MOVE      HEFR          W3FRA
     C                   MOVE      HEOT          W3OT
INT  C     HEOT          IFEQ      'HP'
INT  C                   MOVE      'H'           W3KDPL
INT  C                   ENDIF                                                  <HEOT
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     41            POSNBR
     C     AVSL          TAG
     C                   EXFMT     AVSLUTT
     C                   MOVE      *OFF          *IN30
     C     *IN04         IFEQ      *ON
     C                   EXSR      SØKDTA
     C                   GOTO      AVSL
     C                   END
     C     *IN12         IFEQ      *ON
     C                   GOTO      START3
     C                   ENDIF                                                  <*IN12
      *
INT??C     W3OT          IFEQ      'HP'
INT??C                   MOVE      'H'           W3KDPL
INT??C                   ENDIF                                                  <HEOT
     C     W3FRA         IFNE      *BLANKS
     C     KODFRK        CHAIN     KODTFR                             30
     C     *IN30         IFEQ      *ON
     C                   MOVE      'DIV2482'     MSGNR
     C                   Z-ADD     41            POSNBR
     C                   Z-ADD     18            LINNBR
     C                   GOTO      AVSL
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <W3FRA
      *
     C     W3UTL         IFNE      *BLANKS
     C     W3UTL         CHAIN     KODTU                              30
     C     *IN30         IFEQ      *ON
     C                   Z-ADD     41            POSNBR
     C                   Z-ADD     19            LINNBR
     C                   MOVE      'TRO0148'     MSGNR
     C                   GOTO      AVSL
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <WSUTL
     C     W3KDPL        IFNE      *BLANKS
     C                   MOVEL     W3KDPL        KFKOD
     C     KUFASK        CHAIN     KUFAST                             30
     C     *IN30         IFEQ      *ON
     C                   Z-ADD     41            POSNBR
     C                   Z-ADD     20            LINNBR
     C                   MOVE      'TRO0493'     MSGNR
     C                   GOTO      AVSL
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <W3KDPL
     C                   EXSR      GENOPD
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN03
     C*** FRISK OPP
     C     *IN05         IFEQ      *ON
     C                   MOVE      *ZEROS        SFLOP
     C                   GOTO      START
     C                   ENDIF                                                  <*IN05
     C*** LAGE
     C     *IN06         IFEQ      *ON
     C                   MOVE      *OFF          *IN54
     C                   MOVE      *OFF          *IN79
     C                   MOVE      'J'           WSSJN
     C                   MOVE      ' '           WSTJN
     C                   MOVE      'N'           WSMJN
     C                   MOVE      *ZEROS        WSKNR
     C                   MOVE      *ZEROS        WSADRN
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START5
     C                   ENDIF                                                  <*IN06
     C*** SØK
     C     *IN08         IFEQ      *ON
     C                   CLEAR                   VAREL2
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     05            POSNBR
     C                   GOTO      START6
     C                   ENDIF                                                  <*IN08
     C*** FORRIGE
     C     *IN12         IFEQ      *ON
     C                   GOTO      SLUTT
     C                   ENDIF                                                  <*IN12
     C*** BLA VIDERE
     C     *IN25         IFEQ      *ON
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C     *IN94         IFEQ      *OFF
     C     SELOP         IFNE      *ZEROS
     C                   MOVE      SFLOP         SELOP
     C     SEKEY         SETLL     FORDEL
     C                   ELSE
     C     SELEK         IFNE      *BLANKS
     C                   MOVE      SFLEK         SELEK
     C     SEKEY2        SETLL     FORDEL2
     C                   ELSE
     C     SEKNR         IFNE      *ZEROS
     C                   Z-ADD     SFKNR         SEKNR
     C     SEKEY1        SETLL     FORDEL1
     C                   ELSE
     C     SEMRK         IFNE      *BLANKS
     C                   MOVE      SFMRK         SEMRK
     C     SEKEY3        SETLL     FORDEL3
     C                   ENDIF                                                  <SEMRK
     C                   ENDIF                                                  <SEKNR
     C                   ENDIF                                                  <SELEK
     C                   ENDIF                                                  <SELOP
     C                   ENDIF                                                  <*IN94
     C     START4        TAG
     C     *IN94         IFEQ      *OFF
     C     SELOP         IFNE      *ZEROS
     C                   READ      FORDEL                                 94
     C                   ELSE
     C     SELEK         IFNE      *BLANKS
     C                   READ      FORDEL2                                94
     C                   ELSE
     C     SEKNR         IFNE      *ZEROS
     C                   READ      FORDEL1                                94
     C                   ELSE
     C     SEMRK         IFNE      *BLANKS
     C                   READ      FORDEL3                                94
     C                   ENDIF                                                  <SEMRK
     C                   ENDIF                                                  <SEKNR
     C                   ENDIF                                                  <SELEK
     C                   ENDIF                                                  <SELOP
     C                   GOTO      START1
     C                   ENDIF                                                  <*IN94
     C                   ENDIF                                                  <*IN25
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTS
     C                   ENDIF
     C                   GOTO      START3
     C*** NY
     C     START5        TAG
     C                   EXFMT     VARELI
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFA71A'
     C                   PARM                    WSUTL
     C                   Z-ADD     54            POSNBR
     C                   GOTO      START5
     C                   END
     C                   EXSR      SØKUNR
     C                   GOTO      START5
      * HVORFOR ALT DETTE ????
     C                   MOVE      *OFF          *IN30
     C                   MOVE      *OFF          *IN79
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYKUNDE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   Z-ADD     WSSUBN        XRECNO
     C                   ENDIF
     C                   GOTO      START5
     C                   ENDIF                                                  <*IN04
     C                   MOVEA     '00000'       *IN(86)
     C                   SETOFF                                           30
     C     *IN14         IFEQ      *ON
     C                   Z-ADD     WSKNR         XKNR              8 0
     C                   MOVE      *BLANKS       XMOT              8
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      ' '           UDELSY            1
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XKNR
     C                   PARM                    XMOT
     C                   PARM                    UFLAGG
     C                   PARM                    UDELSY
     C                   MOVE      *OFF          *IN30
     C                   MOVE      *OFF          *IN79
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYKUNDE
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   Z-ADD     WSSUBN        XRECNO
     C                   ENDIF
     C                   GOTO      START5
     C                   ENDIF                                                  <*IN14
     C     *IN03         IFEQ      *ON
     C                   GOTO      ST3A
     C                   END
     C     *IN12         IFEQ      *ON
     C                   Z-ADD     07            LINNBR
     C                   Z-ADD     2             POSNBR
     C                   EXSR      MOVBWS
     C                   GOTO      START3
     C                   ELSE
     C                   EXSR      TESTB1
     C   30              GOTO      START5
     C   54              GOTO      START5
     C                   ENDIF                                                  <*IN12
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     02            POSNBR
     C                   WRITE     SUBCTL
     C                   Z-ADD     WSSUBN        XRECNO
     C                   GOTO      START5
     C*** SØKING I REGISTER
     C     START6        TAG
     C                   EXFMT     VAREL2
     C     *IN12         IFEQ      *OFF
     C                   MOVE      SELOP         SFLOP
     C     SELOP         IFEQ      *ZEROS
     C     SELEK         ANDEQ     *BLANKS
     C     SEKNR         ANDEQ     *ZEROS
     C     SEMRK         ANDEQ     *BLANKS
     C                   MOVE      1             SELOP
     C                   ENDIF                                                  <SELOP
     C                   GOTO      START
     C                   ENDIF                                                  <*IN12
     C                   GOTO      START3
     C*
     C     SLUTT         TAG
     C                   MOVE      GMKDME        UKDME
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C*          N40 = NY
     C*           40 = ENDRING
     C*
     C*  TEST FOR GYLDIG KODE INTERNT KUNDENR
     C     WSLEK         IFNE      *BLANKS
INT01C     XINTFN        IFEQ      'J'                                          FASHIONET
INT01C     KINT1         CHAIN     KUNKO2                             30
INT01C                   ELSE
     C     KEYKU         CHAIN     KUNKO2                             30
INT01C                   END
     C*
     C* 06 OPPRETT LEVERANDØR
     C*
     C   06
     CAN 30              DO
     C     KUNKE2        CHAIN     CUNDL01                            33
     C   33              DO
     C                   MOVE      'JOV0770'     MSGNR
     C                   Z-ADD     64            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDDO                                                  <30
     C  N33              DO
     C* OPPRETT
     C                   MOVE      HEKNS         KUKUN1
     C                   Z-ADD     WSKNR         KUKUN2
     C                   MOVE      WSLEK         KUINTN
     C                   MOVE      SONAVN        KUALFA
     C                   WRITE     KUNKOR
     C                   SETOFF                                       30
     C                   ENDDO                                                  <N33
     C                   ENDDO                                                  <06 30
     C   30              DO
     C                   MOVE      'SHU0250'     MSGNR
     C                   Z-ADD     2             POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDDO                                                  <30
     C                   Z-ADD     KUKUN2        WSKNR
     C                   ENDIF                                                  <WSSK
     C*
     C*  TEST ANTALL KOLLI
     C*
     C     WSKLL         IFEQ      *ZERO
     C     WSKLL         ORLT      WSZML
     C                   Z-ADD     20            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      'SHU0787'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDIF                                                  <WSKLL
     C*
     C* TEST VEKT
     C*
     C     WSVKT         IFEQ      *ZERO
     C                   Z-ADD     25            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      'SPV0002'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDIF                                                  <WSVKT
     C*
     C*
     C*  TEST SAMLING J/N
     C*
     C     WSSJN         IFNE      'J'
     C     WSSJN         ANDNE     'N'
     C                   Z-ADD     54            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      'TRO0155'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDIF                                                  <WSUTL
     C*
     C*
     C*  TEST AVDELING INNLAND
     C*
     C     WSIAVD        IFNE      *ZEROS
     C     KODTAK        CHAIN     KODTA                              30
     C     *IN30         IFEQ      *ON
     C                   MOVE      'TRO0152'     MSGNR
     C                   Z-ADD     59            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <WSIAVD
     C*
     C*  TEST FOR GYLDIG KODE KUNDENR INTERNT
     C*
     C     KUNKE2        CHAIN     CUNDL01                            30
     C     *IN30         IFEQ      *ON
     C                   MOVE      'SPK0001'     MSGNR
     C                   Z-ADD     64            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <*IN30
     C*
     C*  TEST VAREADR
     C*
     C     WSADRN        IFNE      *ZEROS
     C     VADRK         CHAIN     VADR                               30
     C     *IN30         IFEQ      *ON
     C                   MOVE      'SPV0011'     MSGNR
     C                   Z-ADD     76            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <WSADRN
     C*   HENT NAVN/ADRESSE
     C                   MOVE      *BLANKS       DSNAAD
     C     KUNKE2        CHAIN     CUNDL01                            27
     C     *IN27         IFEQ      *OFF
     C                   MOVEL     KNAVN         DSNAVN
     C                   MOVE      '/'           DSSK
     C                   MOVE      POSTNR        DSPOST
     C                   MOVEL     ADR3          DSSTED
     C                   ENDIF                                                  <*IN27
     C*  BRUK VAREADRESSE DERSOM DET IKKE ER VALGT OG DET KUN FINNES EN VAREADR.
     C*  GI MELDING DERSOM DET ER FLERE
     C                   MOVE      *OFF          *IN79
     C     WSADRN        IFEQ      *ZEROS
     C                   MOVE      00001         Z001
     C     VAD01K        SETLL     VADR
     C     VAD01E        READE     VADR                                   97
     C     *IN97         IFEQ      *OFF
     C     VAD01E        READE     VADR                                   96
     C     *IN96         IFEQ      *ON
     C                   MOVE      VADRNR        WSADRN
     C                   ELSE
     C                   MOVE      *ON           *IN30
     C                   MOVE      *ON           *IN79
     C                   MOVE      'TRO0209'     MSGNR
     C                   Z-ADD     76            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <*IN96
     C                   ENDIF                                                  <*IN97
     C                   ENDIF                                                  <WSADRN
     C*  BRUK EVENTUELL VAREADRESSE
     C     WSADRN        IFNE      *ZEROS
     C                   MOVEL     VADRNA        DSNAVN
     C                   MOVE      '/'           DSSK
     C                   MOVEL     VADRN3        DSSTPO
     C                   MOVEL     DSNAAD        SFNAVN
     C                   MOVEL     DSNAAD        WSNAVN
     C                   ENDIF                                                  <WSADRN
     C                   MOVEL     DSNAAD        XSNAAD
     C*
     C*  TEST UTLEVERINGSFORBEHOLD
     C*
     C     WSUTL         IFNE      *BLANKS
     C     WSUTL         CHAIN     KODTU                              30
     C     *IN30         IFEQ      *ON
     C                   Z-ADD     51            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      'TRO0148'     MSGNR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <WSUTL
     C*
     C*  TEST ENHET/VARESLAG
     C*
     C     WSVSL         IFEQ      *BLANKS
     C                   Z-ADD     25            POSNBR
     C                   Z-ADD     22            LINNBR
     C                   MOVE      'SPV0005'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLTB
     C                   ENDIF                                                  <WSVSL
     C*
     C     *IN10         IFEQ      *OFF
     C     WSUTL         IFEQ      *BLANKS
INT  C     HEOT          ANDEQ     'D1'                                         *INTERSPED**
     C     SYKONT        ANDEQ     *ZEROS                                       *IKKE TOLLKR
     C     *IN40         ANDEQ     '0'                                          *NY
     C                   MOVE      '45'          WSUTL
     C                   MOVE      *ON           *IN30
     C                   Z-ADD     51            POSNBR
     C                   Z-ADD     21            LINNBR
     C                   MOVE      'TRO0160'     MSGNR
     C                   GOTO      SLTB
     C                   ENDIF                                                  <WSUTL
     C                   ELSE
     C                   MOVE      *BLANKS       WSUTL
     C                   ENDIF                                                  <*IN10
     C*
     C*
     C*** TEST PÅ KUNDE OPPLYSNING
     C*
     C                   Z-ADD     WSKNR         FXKNR
     C     FRATXK        SETLL     FRATXT
     C     WSKNR         READE     FRATXT                                 31
     C     *IN31         IFEQ      *ON
     C                   MOVE      *OFF          *IN54
     C                   ELSE
     C                   MOVE      *ON           *IN54
     C                   MOVE      *ON           *IN56
     C                   ENDIF                                                  <*IN31
     C*
     C   40WSKEY         CHAIN     FORDEL                             33
     C*
     C                   EXSR      MOVWKA
     C  N40              EXSR      HENTNR
     C  N40              WRITE     FORDR
     C   40              UPDATE    FORDR                                38
     C*
     C*  SJEKK OM DET FINNES FLERE VAREADRESSER (RØDBLINK)
     C*
     C                   MOVE      *OFF          *IN45
     C                   Z-ADD     FOKNR         WSKNR
     C                   MOVE      00001         Z001
     C     VAD01K        SETLL     VADR
     C     VAD01E        READE     VADR                                   97
     C     *IN97         IFEQ      *OFF
     C     VAD01E        READE     VADR                                   96
     C     *IN96         IFEQ      *OFF
     C                   MOVE      *ON           *IN45
     C                   ENDIF                                                  <*IN96
     C                   ENDIF                                                  <*IN97
     C*
     C                   EXSR      MOVWSF
     C     *IN40         IFEQ      *ON
     C                   MOVE      XSNAAD        SFNAVN
     C                   MOVE      XSNAAD        WSNAVN
     C*
     C     *IN56         IFEQ      *ON
     C                   MOVE      *ON           *IN54
     C                   ENDIF                                                  <*IN56
     C                   UPDATE    SUBFIL
     C                   MOVE      *OFF          *IN45
     C                   MOVE      *OFF          *IN54
     C                   MOVE      *OFF          *IN56
     C                   ELSE
     C                   MOVE      *ZEROS        SFAVDI
     C                   MOVE      *ZEROS        SFOPDI
     C                   MOVE      *ZEROS        SFAVDV
     C                   MOVE      *ZEROS        SFOPDV
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   MOVE      XSNAAD        SFNAVN
     C                   MOVE      XSNAAD        WSNAVN
     C*
     C     *IN56         IFEQ      *ON
     C                   MOVE      *ON           *IN54
     C                   ENDIF                                                  <*IN56
     C                   WRITE     SUBFIL
     C                   MOVE      *OFF          *IN45
     C                   MOVE      *OFF          *IN54
     C                   MOVE      *OFF          *IN56
     C                   ENDIF                                                  <*IN40
     C                   EXSR      MOVBWS
     C*
     C     SLTB          ENDSR
     C*
     C***********************************************
     C     HENTS         BEGSR
     C***********************************************
     C* MAN HAR VALGT OPTION PÅ VARELINJE OG MÅ TESTE OM 2/4
     C* ER LIK ENDRE ELLER SLETT
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     *OFF
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDDO
     C     ZRECNO        DIV       6             LINNBR
     C                   MVR                     XLIN              4 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     6             LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   ENDIF                                                  <XLIN
     C*
     C     WSNR          IFEQ      '2'
     C                   MOVE      ' '           WSNR
     C                   MOVE      *OFF          *IN56
     C     SFLEK         IFEQ      '*DELETE'
     C                   MOVE      'SPS0029'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <SFFRAN
     C     SFSTAT        IFEQ      'G'
     C     SFSTAT        OREQ      'I'
     C                   MOVE      'TRO0167'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <SFSTAT
     C                   EXSR      CHGST
     C     *IN12         IFEQ      *ON
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <*IN12
     C                   ENDIF                                                  <WSNR
     C*
     C     WSNR          IFEQ      '4'
     C                   MOVE      ' '           WSNR
     C     SFSTAT        IFEQ      'G'
     C     SFSTAT        OREQ      'I'
     C                   MOVE      'TRO0167'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <SFSTAT
     C     SFLEK         IFEQ      '*DELETE'
     C                   MOVE      'SPS0029'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <SFFRAN
     C                   EXSR      DLTST
     C     *IN12         IFEQ      *ON
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <*IN12
     C                   ENDIF                                                  <WSNR
     C* SE PÅ
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C     SFLEK         IFEQ      '*DELETE'
     C                   MOVE      'JOV0777'     MSGNR
     C                   MOVE      *ON           *IN30
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <SFLEK
     C                   EXSR      VISST
     C                   GOTO      SLHENT
     C                   ENDIF                                                  <WSNR
     C*
     C                   ENDDO
     C*
     C     SLHENT        TAG
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTST         BEGSR
     C***********************************************
     C                   MOVE      *ON           *IN99
     C                   EXFMT     VAREL3
     C     *IN12         IFEQ      *OFF
     C     SFKEY         CHAIN     FORDEL                             33
     C  N33              DELETE    FORDR
     C                   EXSR      MOVBSF
     C                   ENDIF                                                  <*IN12
     C     XLIN          IFEQ      0
     C                   Z-ADD     6             LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   ENDIF                                                  <XLIN
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISST         BEGSR
     C***********************************************
     C                   MOVE      *ON           *IN99
     C                   EXFMT     VAREL4
     C     XLIN          IFEQ      0
     C                   Z-ADD     6             LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   ENDIF                                                  <XLIN
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGST         BEGSR
     C***********************************************
     C                   EXSR      MOVSFW
     C                   MOVE      *ON           *IN99
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     2             POSNBR
     C     STCHG         TAG
     C*
     C*** TEST PÅ KUNDE OPPLYSNING
     C*
     C                   MOVE      *OFF          *IN45
     C*
     C                   Z-ADD     WSKNR         FXKNR
     C     FRATXK        SETLL     FRATXT
     C     WSKNR         READE     FRATXT                                 31
     C     *IN31         IFEQ      *ON
     C                   MOVE      *OFF          *IN54
     C                   ELSE
     C                   MOVE      *ON           *IN54
     C                   ENDIF                                                  <*IN31
     C*
     C*  SJEKK OM DET FINNES FLERE VAREADRESSER (RØDBLINK)
     C*
     C                   MOVE      *OFF          *IN45
     C                   MOVE      00001         Z001
     C     VAD01K        SETLL     VADR
     C     VAD01E        READE     VADR                                   97
     C     *IN97         IFEQ      *OFF
     C     VAD01E        READE     VADR                                   96
     C     *IN96         IFEQ      *OFF
     C                   MOVE      *ON           *IN45
     C                   ENDIF                                                  <*IN96
     C                   ENDIF                                                  <*IN97
     C*
     C*
     C                   EXFMT     VARELI
     C                   MOVEA     '0000'        *IN(87)
     C*  F4 SØK
     C     *IN04         IFEQ      *ON
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFA71A'
     C                   PARM                    WSUTL
     C                   Z-ADD     54            POSNBR
     C                   GOTO      STCHG
     C                   END
     C                   EXSR      SØKUNR
     C                   GOTO      STCHG
     C                   ENDIF                                                  <*IN04
     C*  F12 FORRIGE
     C     *IN12         IFEQ      *ON
     C*
     C*  SJEKK OM DET FINNES FLERE VAREADRESSER (RØDBLINK)
     C*
     C                   MOVE      *OFF          *IN45
     C                   Z-ADD     SFKNR         WSKNR
     C                   MOVE      00001         Z001
     C     VAD01K        SETLL     VADR
     C     VAD01E        READE     VADR                                   97
     C     *IN97         IFEQ      *OFF
     C     VAD01E        READE     VADR                                   96
     C     *IN96         IFEQ      *OFF
     C                   MOVE      *ON           *IN45
     C                   ENDIF                                                  <*IN96
     C                   ENDIF                                                  <*IN97
     C*
     C                   UPDATE    SUBFIL
     C                   EXSR      MOVBWS
     C                   GOTO      SLCHG
     C                   ENDIF                                                  <*IN12
     C*  F14 SE KUNDEOPPLYSNINGER
     C     *IN14         IFEQ      *ON
     C                   Z-ADD     WSKNR         XKNR
     C                   MOVE      *BLANKS       XMOT
     C                   MOVE      *ZEROS        UFLAGG            1 0
     C                   MOVE      ' '           UDELSY
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XKNR
     C                   PARM                    XMOT
     C                   PARM                    UFLAGG
     C                   PARM                    UDELSY
     C                   GOTO      STCHG
     C                   ENDIF                                                  <*IN14
     C*
     C                   SETOFF                                       30
     C                   EXSR      TESTB1
     C   30              GOTO      STCHG
     C   54              GOTO      STCHG
     C*
     C     XLIN          IFEQ      0
     C                   Z-ADD     6             LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   ENDIF                                                  <XLIN
     C*
     C     SLCHG         ENDSR
     C*
     C***********************************************
     C     MOVSFW        BEGSR
     C***********************************************
     C                   MOVE      SFLOP         WSLOP
     C                   MOVE      SFLEK         WSLEK
     C                   Z-ADD     SFKNR         WSKNR
     C                   MOVE      SFKLL         WSKLL
     C                   MOVE      SFVSL         WSVSL
     C                   MOVE      SFVKT         WSVKT
     C                   MOVE      SFM3          WSM3
     C                   MOVE      SFMRK         WSMRK
     C                   MOVE      SFUTL         WSUTL
     C                   MOVE      SFSJN         WSSJN
     C                   MOVE      SFTJN         WSTJN
     C                   MOVE      SFMJN         WSMJN
     C                   MOVE      SFKUDI        WSKUDI
     C                   MOVE      SFPALL        WSPALL
INT  C                   MOVE      SFZML         WSZML
     C                   MOVE      SFIAVD        WSIAVD
     C                   MOVE      SFADRN        WSADRN
     C                   MOVE      SFNAVN        WSNAVN
     C                   MOVE      SFNAVN        XFNAVN           30
     C                   MOVE      *ON           *IN40
     C                   Z-ADD     22            LINNBR
     C                   Z-ADD     25            POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWKA        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       FOSTAT
     C                   MOVE      WSLOP         FOLOP
     C                   MOVE      WSLEK         FOLEK
     C                   Z-ADD     WSKNR         FOKNR
     C                   MOVE      WSKLL         FOKLL
     C                   MOVE      WSVSL         FOVSL
     C                   MOVE      WSVKT         FOVKT
     C                   MOVE      WSM3          FOM3
     C                   MOVE      WSMRK         FOMRK
     C                   MOVE      WSUTL         FOUTL
     C                   MOVE      WSSJN         FOSJN
     C                   MOVE      WSTJN         FOTJN
     C                   MOVE      WSMJN         FOMJN
     C                   MOVE      WSPALL        FOPALL
INT  C                   MOVE      WSZML         FOZML
     C                   MOVE      WSADRN        FOADRN
     C                   MOVE      WSIAVD        FOAVDV
      * VED NY. 0 I REF IMP/INNLAND
     C  N40              MOVE      *ZEROS        FOAVDI
     C  N40              MOVE      *ZEROS        FOOPDI
     C  N40              MOVE      *ZEROS        FOOPDV
     C     WSKUDI        IFEQ      'J'
     C                   MOVE      9999          FOAVDI
     C                   MOVE      9999999       FOOPDI
     C                   ELSE
     C     FOAVDI        IFEQ      9999
     C     FOOPDI        ANDEQ     9999999
     C                   MOVE      *ZEROS        FOAVDI
     C                   MOVE      *ZEROS        FOOPDI
     C                   END
     C                   END
     C                   MOVE      FOAVDI        SFAVDI
     C                   MOVE      FOOPDI        SFOPDI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWSF        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       SFSTAT
     C                   MOVE      WSLOP         SFLOP
     C                   MOVE      WSLEK         SFLEK
     C                   Z-ADD     WSKNR         SFKNR
     C                   MOVE      WSKLL         SFKLL
     C                   MOVE      WSVSL         SFVSL
     C                   MOVE      WSVKT         SFVKT
     C                   MOVE      WSM3          SFM3
     C                   MOVE      WSMRK         SFMRK
     C                   MOVE      WSUTL         SFUTL
     C                   MOVE      WSSJN         SFSJN
     C                   MOVE      WSTJN         SFTJN
     C                   MOVE      WSMJN         SFMJN
     C                   MOVE      WSPALL        SFPALL
INT  C                   MOVE      WSZML         SFZML
     C                   MOVE      WSIAVD        SFIAVD
     C                   MOVE      WSADRN        SFADRN
     C                   MOVE      WSNAVN        SFNAVN
     C                   MOVE      WSKUDI        SFKUDI
     C*
     C                   ENDSR
     C***********************************************
     C     MOVFSF        BEGSR
     C***********************************************
INT01C     XO1004        IFEQ      'FASHION'
INT01C                   MOVE      'J'           XINTFN            1
INT01C                   ENDIF
     C                   MOVE      FOSTAT        SFSTAT
     C                   MOVE      FOLOP         SFLOP
     C                   MOVE      FOLEK         SFLEK
     C                   Z-ADD     FOKNR         SFKNR
     C                   MOVE      FOKLL         SFKLL
     C                   MOVE      FOVSL         SFVSL
     C                   MOVE      FOVKT         SFVKT
     C                   MOVE      FOM3          SFM3
     C                   MOVE      FOMRK         SFMRK
     C                   MOVE      FOUTL         SFUTL
     C                   MOVE      FOSJN         SFSJN
     C                   MOVE      FOTJN         SFTJN
     C                   MOVE      FOMJN         SFMJN
     C                   MOVE      FOPALL        SFPALL
     C                   MOVE      FOZML         SFZML
     C                   MOVE      FOAVDV        SFIAVD
     C                   MOVE      FOADRN        SFADRN
     C                   MOVE      FOAVDI        SFAVDI
     C                   MOVE      FOOPDI        SFOPDI
     C                   MOVE      FOAVDV        SFAVDV
     C                   MOVE      FOOPDV        SFOPDV
     C     FOAVDI        IFEQ      9999
     C     FOOPDI        ANDEQ     9999999
     C                   MOVE      'J'           SFKUDI
     C                   ELSE
     C                   MOVE      ' '           SFKUDI
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBSF        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       SFSTAT
     C                   MOVE      *ZEROS        SFLOP
     C                   MOVE      *BLANKS       SFLEK
     C                   MOVEL     '*DELETE'     SFLEK
     C                   MOVE      *ZEROS        SFKNR
     C                   MOVE      *BLANKS       SFNAVN
     C                   MOVE      *ZEROS        SFKLL
     C                   MOVE      *BLANKS       SFVSL
     C                   MOVE      *ZEROS        SFVKT
     C                   MOVE      *ZEROS        SFM3
     C                   MOVE      *BLANKS       SFMRK
     C                   MOVE      *BLANKS       SFUTL
     C                   MOVE      *BLANKS       SFSJN
     C                   MOVE      *BLANKS       SFTJN
     C                   MOVE      *BLANKS       SFMJN
     C                   MOVE      *ZEROS        SFPALL
     C                   MOVE      *ZEROS        SFZML
     C                   MOVE      *ZEROS        SFIAVD
     C                   MOVE      *ZEROS        SFADRN
     C                   MOVE      ' '           SFKUDI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVBWS        BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C                   MOVE      *ZEROS        WSLOP
     C                   MOVE      *BLANKS       WSLEK
     C                   MOVE      *ZEROS        WSKNR
     C                   MOVE      *ZEROS        WSKLL
     C                   MOVE      *ZEROS        WSVKT
     C                   MOVE      *ZEROS        WSM3
     C                   MOVE      *BLANKS       WSUTL
     C                   MOVE      *ZEROS        WSIAVD
     C                   MOVE      *ZEROS        WSADRN
     C                   MOVE      *BLANKS       WSNAVN
     C                   MOVE      *ZEROS        WSPALL
INT  C                   MOVE      *ZEROS        WSZML
     C                   MOVE      ' '           WSKUDI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SUMMER        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        FOKNR
     C                   MOVE      'J'           FOSJN
     C                   MOVE      *ZEROS        FOLOP
     C                   MOVE      *ZEROS        W3FVKT
     C                   MOVE      *ZEROS        W3FANT
     C                   MOVE      *ZEROS        W3DVKT
     C                   MOVE      *ZEROS        W3DANT
     C     FORKE1        SETLL     FORDEL1
     C* HEADKY = FOAVD/FOOPD
     C     SUM1          TAG
     C     HEADKY        READE     FORDEL1                                94
     C     *IN94         IFEQ      *OFF
     C                   ADD       FOVKT         W3FVKT
     C                   ADD       FOKLL         W3FANT
     C                   GOTO      SUM1
     C                   ELSE
     C     W3TVKT        SUB       W3FVKT        W3DVKT
     C     W3TANT        SUB       W3FANT        W3DANT
     C                   ENDIF                                                  <*IN94
     C                   ENDSR
     C*
     C***********************************************
     C     GENOPD        BEGSR
     C***********************************************
     C                   Z-SUB     1             YYKNR
     C                   MOVE      *ZEROS        SELOP
     C     SEKEY         SETLL     FORDEL
     C* HEADKY = FOAVD/FOOPD
     C     GENOP1        TAG
     C     HEADKY        READE     FORDEL                                 94
     C     *IN94         IFEQ      *OFF
     C* IKKE GENERER FORDELINGSOPPDRAG NÅR STATUS = G  (ALLEREDE GENERERT)
     C     FOSTAT        IFEQ      'G'
     C     FOSTAT        OREQ      'I'
INT01C     FOKNR         OREQ      0
     C                   GOTO      GENOP1
     C                   ENDIF                                                  <FOUTL
      *
     C     FOUTL         IFEQ      *BLANKS
     C                   MOVE      W3UTL         FOUTL
     C                   END
      *
     C                   MOVE      *ZEROS        UFBNR             3 0
     C* NÅR AVD/OPD ER 9999.("KUN DISTR."=J) GÅ RETT PÅ SKAPING AV     RT)
     C* DISTR.OPPDRAG BASERT PÅ FRAKTREV FORDELINGSLØPENR=FR.BREVSNR   RT)
     C     FOAVDI        IFEQ      9999
     C     FOOPDI        ANDEQ     9999999
     C     FOUTL         ANDEQ     *BLANKS
     C                   MOVE      FOAVDV        XXAVDV
     C                   MOVE      FOLOP         UFBNR
     C                   EXSR      GENIN
     C                   GOTO      GENOP1
     C                   ENDIF
     C* TILDEL NYTT OPPDRAGSNUMMER
     C     FOAVD         CHAIN     TELL                               33
     C     *IN33         IFEQ      *OFF
     C                   MOVE      TEOPDN        NYOPD
     C                   MOVE      FOAVD         NYAVD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   ENDIF                                                  <*IN33
     C*
     C                   MOVE      FOAVDV        XXAVDV
     C                   MOVE      FOUTL         X2UTL             2
     C                   MOVE      *BLANKS       X2KFT1            1
     C                   MOVE      *BLANKS       X2FT1            51
     C     FOUTL         IFNE      *BLANKS
     C     X2UTL         CHAIN     KODTU                              30
     C     *IN30         IFEQ      *OFF
     C                   MOVE      KUKD2         X2KFT1
     C                   MOVEL     KUTX          X2FT1
     C                   END
     C                   END
     C* SJEKK OM FORDELINGSOPPDRAG SKAL SLÅS SAMMEN
     C* J/N PÅ SISTE BILDE OVERSTYRER LINJEVALG
     C* NB!  GENSUM LESER ALLE PÅ SAMME VAREADRESSE NÅR W3SAML='J'
     C* NB!  LESER VIDERE PÅ SAMME VAREADRESSE NÅR W3SAML=' ' OG
     C* NB!  FOSJN='J'
     C     W3SAML        IFEQ      'J'
     C                   Z-ADD     0             XXKLL
     C                   Z-ADD     0             XXVKT
     C                   Z-ADD     0             XXM3
     C                   Z-ADD     0             XXPALL
     C                   Z-ADD     0             XXZML
     C* DUMMY PGA RECORDLOCK
     C                   UPDATE    FORDR
     C                   EXSR      GENSUM
     C                   ENDIF                                                  <W3SAML
     C* BLANK PÅ SISTE BILDE BEHOLDER LINJEVALG
     C     W3SAML        IFEQ      ' '
     C                   Z-ADD     FOKLL         XXKLL
     C                   Z-ADD     FOVKT         XXVKT
     C                   Z-ADD     FOM3          XXM3
     C                   Z-ADD     FOPALL        XXPALL
     C                   Z-ADD     FOZML         XXZML
     C     FOSJN         IFEQ      'J'
     C                   EXSR      GENSUM
     C                   ENDIF                                                  <FOSJN
     C* LEGG UT FRISØK NÅR DET IKKE ER SAMLING
     C     FOSJN         IFNE      'J'
     C                   MOVEL     FOMRK         XXMRK
     C                   EXSR      FRIMRK
     C                   ENDIF                                                  <FOSJN
     C* SETT STATUS = G  (OPPDRAG GENERERT)
     C                   MOVE      NYAVD         FOAVDI
     C                   MOVE      NYOPD         FOOPDI
     C     X2KFT1        IFEQ      'Y'
     C                   MOVE      '9999'        FOAVDV
     C                   MOVE      '9999999'     FOOPDV
     C                   MOVE      'G'           FOSTAT
     C                   ELSE
     C                   MOVE      *ZEROS        FOAVDV
     C                   MOVE      *ZEROS        FOOPDV
     C                   MOVE      'I'           FOSTAT
     C                   END
     C                   UPDATE    FORDR
     C                   ENDIF                                                  <W3SAML
     C*
     C                   EXSR      GENFO
     C*
     C                   GOTO      GENOP1
     C                   ENDIF                                                  <*IN94
INT01 *INT*SEND I JOBKØ OPPDATER AV LAGER
INT01C* Utfør kommandoen via QCMDEXEC
INT01C                   Z-ADD     1024          CMDLE            15 5
INT01C                   MOVEL     SBM029        SBMCMD
INT01C                   CALL      'QCMDEXC'                            33
INT01C                   PARM                    SBMCMD
INT01C                   PARM                    CMDLE
INT01 *INT*SEND I JOBKØ
     C                   ENDSR
     C*
     C***********************************************
     C     GENSUM        BEGSR
     C***********************************************
     C*
     C* GENERER FORDELINGSOPPDRAG - SAMLING
     C***********************************************
     C*
     C* HVIS SAMLING ER OVERSTYRT PÅ SISTE BILDE
     C* IKKE LEGG UT MERKING HER. DET VIL DA BLI DOBBELT
     C* PGA ENDRET LOGIKK
     C     W3SAML        IFNE      'J'
     C                   MOVEL     FOMRK         XXMRK
     C                   EXSR      FRIMRK
     C                   ENDIF                                                  <W3SAML
     C*
     C*SETT KEY
     C                   MOVE      FOAVD         YAVD
     C                   MOVE      FOOPD         YOPD
     C                   Z-ADD     FOKNR         YKNR
     C                   MOVE      FOADRN        YADRN
     C                   MOVE      FOSJN         YSJN
     C                   MOVE      FOLOP         YLOP
     C*
     C                   ADD       1             YLOP
     C* HVIS SAMLING IKKE ER OVERSTYRT PÅ SISTE BILDE
     C* LES PÅ NØKKEL AVD/OPPD/KNR/ADRNR/SJN
     C* HVIS SAMLING ER OVERSTYRT TIL 'J' PÅ SISTE BILDE
     C* LES PÅ NØKKEL AVD/OPPD/KNR/ADRNR
     C     W3SAML        IFNE      'J'
     C     FORKE4        SETLL     FORDEL4
     C                   ELSE
     C     FORK4F        SETLL     FORDEL4
     C                   ENDIF                                                  <W3SAML
     C     LES4          TAG
     C     W3SAML        IFNE      'J'
     C     FORK4E        READE     FORDEL4                                55
     C                   ELSE
     C     FORK4F        READE     FORDEL4                                55
     C                   ENDIF                                                  <W3SAML
     C     *IN55         IFEQ      *OFF
     C* STATUS G = FERDIG GENERERT, BÅDE IMP.OPPDR OG DISTRIB.
     C*  (ELLER HVIS FOAVDV/OPDV = 9999/9999999 SKAL IKKE!! DISTR. LAGES)
     C* STATUS I = KUN IMP.OPPD. ER GENERERT, DISTRIB. ENNå IKKE LAGET.
     C     FOSTAT        IFEQ      'G'
     C     FOSTAT        OREQ      'I'
     C                   UPDATE    FORDR4
     C                   GOTO      LES4
     C                   ENDIF                                                  <FOUTL
     C                   ADD       F4KLL         XXKLL
     C                   ADD       F4VKT         XXVKT
     C                   ADD       F4M3          XXM3
     C                   ADD       F4PALL        XXPALL
     C                   ADD       F4ZML         XXZML
     C                   MOVE      NYAVD         F4AVDI
     C                   MOVE      NYOPD         F4OPDI
     C     X2KFT1        IFEQ      'Y'
     C                   MOVE      '9999'        F4AVDV
     C                   MOVE      '9999999'     F4OPDV
     C                   MOVE      'G'           F4STAT
     C                   ELSE
     C                   MOVE      *ZEROS        F4AVDV
     C                   MOVE      *ZEROS        F4OPDV
     C                   MOVE      'I'           F4STAT
     C                   END
     C                   UPDATE    FORDR4
     C                   MOVEL     F4MRK         XXMRK
     C                   EXSR      FRIMRK
     C                   GOTO      LES4
     C                   ENDIF                                                  <*IN55
     C                   ENDSR
     C***********************************************
     C     GENFO         BEGSR
     C***********************************************
     C*
     C* GENERER FORDELINGSOPPDRAG
     C*
     C* IKKE GENERER NULLOPPDRAG
     C*
     C     XXKLL         IFEQ      *ZEROS
     C     XXVKT         ANDEQ     *ZEROS
     C                   GOTO      SLUTTG
     C                   ENDIF                                                  <XXKLL
     C* LES ORIGINALOPPDRAG
     C     HEADKY        CHAIN(N)  HEADF                              33
     C                   MOVE      NYOPD         HEOPD
INT  C                   MOVE      HEPOS1        DEPOS1            4 0
INT  C* TAR VARE P$ SELGER KUNDENR FOR SEINERE TEST P$ HEUGA
INT  C                   Z-ADD     HEKNS         HEUKNS            8 0
INT  C     W1ADK3        IFEQ      '**'
INT  C                   MOVEL     W2ADK3        HERFA
INT  C                   ENDIF
     C* ØKER HOVEDPOSISJON HVIS OMSORTER IKKE = 'N'
     C* ØKER UNDERPOSISJON HVIS OMSORTER = 'J'
     C     W3OMS         IFEQ      'J'
     C                   ADD       1             YYPOS2
     C                   MOVE      YYPOS2        HEPOS2
     C                   ELSE
     C                   MOVE      YYPOS1        HEPOS1
INT  C*                    ADD  1         YYPOS1
INT  C                   CALL      'SYFA10C'
INT  C                   PARM                    YYPOS1
     C                   MOVE      *ZEROS        HEPOS2
     C                   ENDIF                                                  <W3OMS
     C* FLYTTER OPPDRAGTYPE FRA SKJERM TIL HEADF
     C                   MOVE      W3OT          HEOT
     C*
     C* VERDI SOM FORTELLER AT DET ER ET FORD.OPPD(IMP-OPP)
     C                   MOVE      'FO'          TRSLAG
     C* LAG FORDELINGSOPPDRAG
     C* KJØPER ---> SELGER - HVIS BYTTE AVSENDER = J
     C     W3AVS         IFEQ      'J'
     C                   MOVE      HEKNK         HEKNS
     C                   MOVE      HENAK         HENAS
     C                   MOVE      HEADK1        HEADS1
     C                   MOVE      HEADK2        HEADS2
     C                   MOVE      HEADK3        HEADS3
     C* KJØPERS FMOT ---> SELGER* FMOT
     C                   MOVE      HEKNKF        HEKNSF
     C                   MOVE      HENAKF        HENASF
     C* KJØPERS KODER ---> SELGERS KODER
     C                   MOVE      HEANK         HEANS
     C                   MOVE      HEKDFK        HEKDFS
     C                   MOVE      HEVALK        HEVALS
     C                   ENDIF                                                  <W3AVS
     C* KJØPERS OPPLYSNINGER
     C                   Z-ADD     FOKNR         HEKNK
     C                   Z-ADD     FOKNR         HEKNKF
     C                   Z-ADD     FOKNR         SFKNR
     C                   MOVE      *BLANKS       DSADR3
     C     KUNKE3        CHAIN     CUNDL01                            27
     C     *IN27         IFEQ      *OFF
     C     FMOT          IFNE      *ZEROS
     C                   MOVE      FMOT          HEKNKF
     C                   END
INT  C* HEUGA - BRUK HEUGA VAREADRESSE UANSETT
INT  C     HEUKNS        IFEQ      158162
INT  C     FONAK         ANDNE     *BLANKS
INT  C                   MOVEL     FONAK         HENAK
INT  C                   MOVEL     FOADK1        HEADK1
INT  C                   MOVEL     FOADK2        HEADK2
INT  C                   MOVEL     FOADK3        HEADK3
INT  C                   ELSE
     C                   MOVEL     KNAVN         HENAKF
     C                   MOVEL     KNAVN         HENAK
     C                   MOVEL     ADR1          HEADK1
     C                   MOVEL     ADR2          HEADK2
     C                   MOVE      POSTNR        DSPNR3
     C                   MOVEL     ADR3          DSSTE3
     C                   MOVEL     DSADR3        HEADK3
INT  C                   ENDIF
     C                   ELSE
INT  C* HEUGA - BRUK HEUGA VAREADRESSE HVIS
INT  C* HEUGA - KUNDENR KJØPER ER NULL
INT  C     HEUKNS        IFEQ      158162
INT  C     FONAK         ANDNE     *BLANKS
INT  C                   MOVEL     FONAK         HENAK
INT  C                   MOVEL     FOADK1        HEADK1
INT  C                   MOVEL     FOADK2        HEADK2
INT  C                   MOVEL     FOADK3        HEADK3
INT  C                   ELSE
     C                   MOVE      *BLANKS       HENAK
     C                   MOVE      *BLANKS       HEADK1
     C                   MOVE      *BLANKS       HEADK2
     C                   MOVE      *BLANKS       HEADK3
INT  C                   ENDIF                                                  <HEUKNS
     C                   ENDIF                                                  <*IN27
     C*
     C*  HENT EVENTUELL VAREADR
     C*
     C     FOADRN        IFNE      *ZEROS
     C                   Z-ADD     FOKNR         WSKNR
     C                   MOVE      FOADRN        WSADRN
     C     VADRK         CHAIN     VADR                               30
     C     *IN30         IFEQ      *OFF
     C                   MOVE      VADRNA        HENAK
     C                   MOVE      VADRN1        HEADK1
     C                   MOVE      VADRN2        HEADK2
     C                   MOVE      VADRN3        HEADK3
     C                   ENDIF                                                  <*IN30
     C                   ENDIF                                                  <FOADRN
     C*
     C                   MOVEL     HEADK3        DSPOCH
     C                   MOVE      DSPOCH        WPNRMO            4 0
     C*
     C*  HENT BÆRER FRA AVDELINGSOPPLYSNINGER
     C*
     C     KODTK2        CHAIN     KODTA                              30
     C     *IN30         IFEQ      *OFF
     C                   MOVE      KOABÆR        HESTD
     C                   ELSE
     C                   MOVE      *ZEROS        HESTD
     C                   ENDIF                                                  <*IN30
     C*
     C     W3AUTF        IFEQ      'J'
     C                   MOVE      'X'           HEST
     C                   ELSE
     C                   MOVE      *BLANKS       HEST
     C                   END
     C                   MOVE      W3FRA         HEFR
     C                   Z-ADD     XXKLL         HENT
     C                   Z-ADD     XXVKT         HEVKT
     C     KODTVK        CHAIN     KODTV                              30
     C     *IN30         IFEQ      '0'
     C     XXM3          MULT      KOVKKG        HEFBV
     C     HEVKT         IFGT      HEFBV
     C                   Z-ADD     HEVKT         HEFBV
     C                   END
     C                   ELSE
     C                   Z-ADD     XXVKT         HEFBV
     C                   END
     C                   Z-ADD     XXM3          HEM3
     C                   MOVE      *ZEROS        HELM
     C                   MOVEL     FOMRK         HEGM1
     C                   MOVEL     FOVSL         HEVS1
     C                   MOVE      *BLANKS       HEPK1
     C                   MOVE      *BLANKS       HEPK2
     C                   MOVE      *BLANKS       HEPK3
     C                   MOVE      *BLANKS       HEPK4
     C                   MOVE      *BLANKS       HEPK5
     C                   MOVE      *BLANKS       HEPK6
     C                   MOVE      *BLANKS       HEPK7
     C                   MOVE      *BLANKS       HEPK8
     C                   MOVE      *BLANKS       HEPK9
     C     KODO2K        CHAIN     KODTOT2                            33
     C     *IN33         IFEQ      '0'
     C                   MOVE      KO2FB         HEPK1
     C                   MOVE      KO2FPS        HEPK2
     C                   MOVE      KO2KK         HEPK3
     C                   MOVE      KO2TI         HEPK4
     C                   END
      * FORDELINGSOPPDR. FÅR DAGENS DATO SOM FOSLAG PÅ O.DATO/REG.DATO
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          HEDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          HEDTÅ
     C                   END
     C                   MOVE      UMONTH        HEDTM
     C                   MOVE      UDAY          HEDTD
     C                   MOVE      HEDTOP        HEDTR
     C     KOAPOS        IFEQ      'J'
     C                   MOVE      *BLANKS       HESDVT
     C                   MOVEL     WPNRMO        HESDVT
     C                   MOVE      'NO'          HELKK
     C     WSSDTK        CHAIN     STED2D                             30
     C  N30              MOVE      ST2KO2        HESDT
     C                   ENDIF                                                  <KOAPOS
     C* MERKELAPP IKKE OVERSTYRT PÅ SISTE BILDE
     C     W3MERK        IFEQ      ' '
     C     FOMJN         IFEQ      'J'
     C                   MOVE      'X'           UKDME
     C                   ELSE
     C                   MOVE      ' '           UKDME
     C                   ENDIF                                                  <FOMJN
     C                   ENDIF                                                  <W3MERK
     C* MERKELAPP OVERSTYRT TIL 'J' PÅ SISTE BILDE
     C     W3MERK        IFEQ      'J'
     C                   MOVE      'X'           UKDME
     C                   ENDIF                                                  <W3MERK
     C* MERKELAPP OVERSTYRT TIL 'N' PÅ SISTE BILDE
     C     W3MERK        IFEQ      'N'
     C                   MOVE      ' '           UKDME
     C                   ENDIF                                                  <W3MERK
     C* LEGG UT FORDLINGSLØPENUMMER I HEADF FOR SORTERING I LOSSELISTE
     C     W3OMS         IFEQ      'J'
     C                   MOVEL     YYLOP         HELB
     C                   ELSE
     C                   MOVEL     FOLOP         HELB
     C                   ENDIF                                                  <W3OMS
      *
     C                   MOVE      X2UTL         HEKF
     C                   MOVE      X2KFT1        HEKFT1
     C                   MOVE      X2FT1         HEFT1
INT01C     XO1004        IFEQ      'FASHION'                                    FASHIONET
INT01C                   MOVEL     FO1004        HERFA
INT01C                   END
      *
      * VED UTL.FORBEH. SKRIV KK..
     C     HEKF          IFNE      *BLANKS
     C                   MOVE      'J'           HEPK3
     C                   END
      *FLYTTET OPPDR.SKRIV - TESTEN UTL.FORB->KK. GJELDER VEL FORD.OPPD
     C                   WRITE     HEADFR
      *  HVIS UTLEVERINGSFORBEHOLD SKRIV TIL UTL.FORB.H.-LOGG
     C     HEKF          IFNE      *BLANKS
     C                   EXSR      OPDLOG
     C                   END
      * AUTOMATISK GENERERING AV FAKTURAFORSLAG På FORDELINGS.OPPDRAG
     C     W3AUTF        IFEQ      'J'
     C                   MOVEL     FIFIRM        QDA01
     C                   MOVEL     HEAVD         QDA02
     C                   MOVEL     HEOPD         QDA03
     C                   MOVEL     'NY'          QDA04
     C                   MOVEL     ' '           QDA05
     C                   MOVE      *ZEROS        QDA06
     C                   MOVE      *ZEROS        QDA07
     C                   MOVE      *ZEROS        QDA08
     C                   MOVE      *ZEROS        QDA09
     C                   MOVEL     ' '           QDA10
     C                   MOVEL     ' '           QDA11
     C                   MOVE      *ZEROS        QDA12
     C                   MOVEL     KOVAVR        QDA13
     C                   MOVE      *BLANKS       QDA14
     C                   MOVE      *BLANKS       QDA15
     C                   MOVEL     '3'           QDA16
     C                   MOVEL     'A'           QDA17
     C                   MOVE      *BLANKS       QDA18
     C                   MOVEL     'SYFI10XQ'    QDTAQ            10
     C                   MOVEL     '*LIBL'       QLIB             10
     C                   Z-ADD     109           QRLEN             5 0
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QDTAQ
     C                   PARM                    QLIB
     C                   PARM                    QRLEN
     C                   PARM                    QDATA
     C                   END
      *
     C* GENERER FRAKTBREV
INT  C                   MOVE      '9'           TEST              1
INT  C                   MOVE      *BLANKS       DXMSG
INT  C                   MOVE      DEPOS1        DXPOS1
INT  C     W3OMS         IFEQ      'J'
INT  C                   MOVE      YYLOP         DXLOP
INT  C                   ELSE
INT  C                   MOVE      FOLOP         DXLOP
INT  C                   ENDIF                                                  <W3OMS
     C     W3KN14        IFNE      *ZEROS
     C                   MOVE      W3KN14        DXKN14
     C                   ELSE
     C                   MOVE      *ZEROS        DXKN14
     C                   ENDIF                                                  <W3KN14
     C                   EXSR      FBREV1
     C                   MOVE      *ZEROS        XXKLL
     C                   MOVE      *ZEROS        XXVKT
     C                   MOVE      *ZEROS        XXM3
     C                   MOVE      *ZEROS        XXPALL
     C                   MOVE      *ZEROS        XXZML
     C* GENERER INNLANDSOPPDRAG MED FAKTURALINJE
     C     HEKF          IFEQ      *BLANKS
     C                   EXSR      GENIN
     C                   END
INT  C     SLUTTG        TAG
     C                   ENDSR
     C*
     C***********************************************
     C     OPDLOG        BEGSR
     C***********************************************
     C                   MOVE      HEAVD         ULAVD
     C                   MOVE      HEOPD         ULOPD
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      XULTM         ULTID
     C                   MOVE      ZUSER         ULUSR
     C                   MOVE      HEKF          ULKF
     C                   MOVE      HEKFT1        ULKFT1
     C                   MOVE      HEFT1A        ULFT1A
     C                   MOVE      HEFT1B        ULFT1B
     C                   WRITE     UTLLOGR
      *
     C                   ENDSR
      *
     C******************************************
     C     GENIN         BEGSR
     C***********************************************
      * TOTALT OMSKREVET
     C                   MOVE      W3KDPL        UKDPL
     C                   CALL      'SYFO02'
     C                   PARM      HEAVD         UAVD              4 0
     C                   PARM      HEOPD         UOPD              7 0
     C                   PARM      XXAVDV        UAVDV             4 0
     C                   PARM                    UOPDV             7 0
     C     *IN10         PARM                    UIN10             1
     C                   PARM                    UKDPL             1
     C                   PARM                    FICURR
     C                   PARM                    UFBNR
      *
     C     FORDK         CHAIN     FORDEL                             33
     C                   MOVE      'G'           FOSTAT
     C                   MOVE      UAVDV         FOAVDV
     C                   MOVE      UOPDV         FOOPDV
     C                   UPDATE    FORDR
      *
     C                   ENDSR
     C*
     C******************************************
     C     FRIMRK        BEGSR
     C***********************************************
     C* OPPDATER FRI SØKEVEIER FOR MERKING
     C                   MOVE      NYAVD         FSAVD
     C                   MOVE      NYOPD         FSOPD
     C                   MOVE      'MRK'         FSKODE
     C                   MOVE      *BLANKS       FSSOK
     C                   MOVEL     XXMRK         FSSOK
     C     FSSOK         IFNE      *BLANKS
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C   33              MOVE      *BLANKS       FSDOKK
     C                   WRITE     FRISOKR
     C                   ENDIF                                                  <FSSOK
INT  C* OPPDATER FRI SØKEVEIER FOR MØLLER SENDINGSNUMMER
INT  C                   MOVE      NYAVD         FSAVD
INT  C                   MOVE      NYOPD         FSOPD
INT  C                   MOVE      'MSN'         FSKODE
INT  C                   MOVE      *BLANKS       FSSOK
INT  C                   MOVEL     FO1004        FSSOK
INT  C     FSSOK         IFNE      *BLANKS
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           FSDTOP
     C     FSKODE        CHAIN     KODFRI                             33
     C  N33              MOVE      KFSODK        FSDOKK
     C   33              MOVE      *BLANKS       FSDOKK
INT  C                   WRITE     FRISOKR
INT  C                   ENDIF                                                  <FSSOK
INT  C* OPPDATER FRI SØKEVEIER FOR INNLANDFRAKTBREV
INT  C*                    MOVE NYAVD     FSAVD
INT  C*                    MOVE NYOPD     FSOPD
INT  C*                    MOVE 'IFB'     FSKODE
INT  C*                    MOVE *BLANKS   FSSOK
INT  C*                    MOVELFO1004    FSSOK
INT  C*          FSSOK     IFNE *BLANKS
INT  C*                    WRITEFRISOKR
INT  C*                    ENDIF                           <FSSOK
INT  C* OPPDATER X-REF MELLOM IFTMIN OG IFTMCS
INT  C     FO1004        CHAIN(N)  EDICS1                             30
INT  C     *IN30         IFEQ      *ON
INT  C                   CLEAR                   EDICSR
INT  C                   MOVEL     FO1004        C1004
INT  C                   Z-ADD     NYAVD         CAVD
INT  C                   Z-ADD     NYOPD         COPD
INT  C                   WRITE     EDICSR
INT  C                   ENDIF
     C                   ENDSR
     C*
     C******************************************
     C     FBREV1        BEGSR
     C***********************************************
     C*
     C* GENERER FRAKTBREV
     C*
INT  C     KEYBAS        KLIST
INT  C                   KFLD                    HEAVD
INT  C                   KFLD                    HELKA
INT  C                   KFLD                    HESDF
INT  C     KEYBAS        CHAIN     BASEK                              77
INT  C  N77              MOVE      BAKKNR        KOAKNR
INT  C                   MOVE      *BLANKS       XTRNV            30
INT  C                   MOVE      *BLANKS       UKDE              1
S01  C*                  MOVE      *ZEROS        UTOLL             2 0
N01  C                   MOVE      *ZEROS        UTOLL             4 0
INT  C                   MOVE      DXMSG         WSMSG            62
INT  C                   MOVE      *ZEROS        UFLAGG            1 0
INT  C*
INT  C*  SENDES MED TOLLPOST INNLAND  ?????
INT  C*
     C                   MOVE      1             XFBNR
INT   *SJEKK OM NUMMER 1 ALLEREDE FINNES, SLETT DA !
INT  C     KEYDOK        KLIST
INT  C                   KFLD                    DFRI
INT  C                   KFLD                    DFAVD
INT  C                   KFLD                    DFOPD
INT  C                   KFLD                    DFFBNR
INT  C                   MOVE      'F'           DFRI
INT  C                   Z-ADD     HEAVD         DFAVD
INT  C                   Z-ADD     HEOPD         DFOPD
INT  C                   Z-ADD     1             DFFBNR
INT  C     KEYDOK        CHAIN     DOKUF                              77
INT  C     *IN77         IFEQ      *OFF
INT  C                   DELETE    DOKUFR
INT  C                   ENDIF                                                  <*IN77
INT  C                   CLEAR                   DOKUFR
INT  C                   MOVE      'F'           DFRI
INT  C                   Z-ADD     HEAVD         DFAVD
INT  C                   Z-ADD     HEOPD         DFOPD
INT  C                   Z-ADD     1             DFFBNR
INT  C                   Z-ADD     XXPALL        DFNTEU
INT  C* HVIS SAMLING IKKE ER OVERSTYRT PÅ SISTE BILDET,
INT  C* BEHOLD EKSISTERENDE LOGIKK
INT  C     W3SAML        IFEQ      ' '
INT  C* MØLLER - HVIS SAMLING = 'N' BRUK MOTTATTE SENDINGSNR.
INT  C* MØLLER - HVIS SAMLING = 'J' LAG NYTT SENDINGSNR.
INT  C     FOSJN         IFNE      'J'
INT  C                   MOVEL     FO1004        DF1004
INT  C                   ENDIF                                                  <FOSJN
INT  C                   ENDIF                                                  <W3SAML
INT  C* HEUGA  - HVIS SAMLING = 'N' LAG NYTT SENDINGSNR.
INT  C     FOSJN         IFEQ      'N'
INT  C     HEUKNS        ANDEQ     158162
INT  C                   MOVEL     *BLANKS       DF1004
INT  C                   ENDIF                                                  <FOSJN
S01  C**                   WRITEDOKUFR
INT   * FASHIONNET --> LAG NYTT SENDINGSNR.
INT  C                   MOVE      DF1004        XAN007            7
INT  C     XAN007        IFEQ      'FASHION'
INT  C                   MOVEL     *BLANKS       DF1004
INT  C                   ENDIF
INT  C                   MOVE      XXZML         DFNTLA
INT  C                   WRITE     DOKUFR
     C*
     C                   CALL      'SYFI10A'
     C                   PARM                    FIFIRM
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    XFBNR
     C                   PARM                    KOAKNR
     C                   PARM                    XTRNV
     C                   PARM                    UKDME
     C                   PARM                    UKDE
     C                   PARM                    UTOLL
     C                   PARM                    FILFB
     C                   PARM                    FILTB
     C                   PARM                    WSMSG
     C                   PARM                    UFLAGG
     C                   PARM                    TEST
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    FOAVD             4 0
     C                   PARM                    FOOPD             7 0
     C                   PARM                    UKNV              8 0
     C                   PARM                    UNAT             30
     C                   PARM                    UKDME             1
     C                   PARM                    UKDE              1
S01  C*                  PARM                    UTOLL             2 0
N01  C                   PARM                    UTOLL             4 0
     C                   MOVE      UKNV          WSKNR
     C                   MOVE      UKDME         GMKDME            1
      *--------------------------------------------------------------
      * DEFINERER NØKKEL TIL KUFAST
      *--------------------------------------------------------------
     C     KUFASK        KLIST
     C                   KFLD                    KFTYP
     C                   KFLD                    KFKOD
     C                   MOVEL     'PRODTYPE'    KFTYP
      *--------------------------------------------------------------
      * DEFINERER NØKKEL TIL KODTFR
      *--------------------------------------------------------------
     C     KODFRK        KLIST
     C                   KFLD                    YFRUNI
     C                   KFLD                    W3FRA
     C                   MOVE      'FR'          YFRUNI            2
      *--------------------------------------------------------------
     C     KODPI1        KLIST
     C                   KFLD                    YPIUNI
     C                   KFLD                    WPNRMO
     C     VADRK         KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    WSKNR
     C                   KFLD                    WSADRN
     C     VAD01K        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    WSKNR
     C                   KFLD                    Z001              5 0
     C     VAD01E        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    WSKNR
     C     KODTAK        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    WSIAVD
     C     KODTK2        KLIST
     C                   KFLD                    WSAUNI
     C                   KFLD                    HEAVD
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    HEAVD
     C                   MOVE      'V'           KOVUNI
     C     HEADKF        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     HEADKY        KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C     KODO2K        KLIST
     C                   KFLD                    XO2UNI
     C                   KFLD                    HEOT
     C                   MOVE      'O2Y'         XO2UNI            3
     C                   MOVE      *ZEROS        HEDTOP
     C     HEADKY        CHAIN(N)  HEADF                              33
     C     *IN33         IFEQ      *OFF
     C                   Z-ADD     HEVKT         W3TVKT
     C                   Z-ADD     HENT          W3TANT
     C                   MOVE      HEPOS1        YYPOS1
     C                   ENDIF                                                  <*IN33
INT01C     KINT1         KLIST
INT01C                   KFLD                    HEKNA
INT01C                   KFLD                    WSLEK
INT01C                   MOVE      'N'           XINTFN            1
     C*
     C     KEYKU         KLIST
     C                   KFLD                    HEKNS
     C                   KFLD                    WSLEK
     C     SFKEY         KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    SFLOP
     C     SEKEY         KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    SELOP
     C     SEKEY1        KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    SEKNR
     C     SEKEY2        KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    SELEK
     C     SEKEY3        KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    SEMRK
     C*
     C     FORKE1        KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    FOKNR
     C                   KFLD                    FOSJN
     C                   KFLD                    FOLOP
     C*
     C     FORKE4        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    YKNR
     C                   KFLD                    YADRN
     C                   KFLD                    YSJN
     C                   KFLD                    YLOP
     C*
     C     FORK4E        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    YKNR
     C                   KFLD                    YADRN
     C                   KFLD                    YSJN
     C*
     C     FORK4F        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    YOPD
     C                   KFLD                    YKNR
     C                   KFLD                    YADRN
     C*
     C     WSKEY         KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    WSLOP
     C     FORDK         KLIST
     C                   KFLD                    FOAVD
     C                   KFLD                    FOOPD
     C                   KFLD                    FOLOP
     C     WSSDTK        KLIST
     C                   KFLD                    HELKK
     C                   KFLD                    HESDVT
     C*
     C     *LIKE         DEFINE    FOOPD         YOPD
     C     *LIKE         DEFINE    FOAVD         YAVD
     C     *LIKE         DEFINE    FOKNR         YKNR
     C     *LIKE         DEFINE    FOADRN        YADRN
     C     *LIKE         DEFINE    FOSJN         YSJN
     C     *LIKE         DEFINE    FOLOP         YLOP
     C     *LIKE         DEFINE    DSNAAD        XSNAAD
     C*
     C     *LIKE         DEFINE    FIRMA         ZFIRMA
     C     *LIKE         DEFINE    FOAVDV        XXAVDV
     C     *LIKE         DEFINE    FOKNR         YYKNR
     C     *LIKE         DEFINE    FOLOP         YYLOP
     C     *LIKE         DEFINE    FOOPD         NYOPD
     C     *LIKE         DEFINE    FOAVD         NYAVD
     C     *LIKE         DEFINE    FOKLL         XXKLL
     C     *LIKE         DEFINE    FOVKT         XXVKT
     C     *LIKE         DEFINE    FOM3          XXM3
     C     *LIKE         DEFINE    FOPALL        XXPALL
     C     *LIKE         DEFINE    FOZML         XXZML
     C     *LIKE         DEFINE    FOMRK         XXMRK
     C     *LIKE         DEFINE    HEPOS1        YYPOS1
     C     *LIKE         DEFINE    HEPOS2        YYPOS2
     C     *LIKE         DEFINE    DFFBNR        XFBNR
     C                   MOVE      *ZEROS        YYPOS2
     C     KUNKEY        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    FOKNR
     C     LEVKEY        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    HEKNS
INT01C     LINT1         KLIST
INT01C                   KFLD                    ZFIRMA
INT01C                   KFLD                    HEKNA
     C     KUNKE2        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    WSKNR
     C     KUNKE3        KLIST
     C                   KFLD                    ZFIRMA
     C                   KFLD                    SFKNR
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
INT   *                    KFLD           XFXLNR
INT  C                   KFLD                    XHEUR
     C*
     C                   READ      FIRM                                   33
     C                   MOVE      FIFIRM        ZFIRMA
     C     LEVKEY        CHAIN     CUNDL01                            33
     C  N33              MOVE      KNAVN         LENAVN
     C*
     C                   MOVE      'A'           WSAUNI            1
     C                   MOVE      'PI '         YPIUNI            3
     C                   MOVEL     'M³ =    '    XMÅL
     C                   MOVE      ',   '        XMÅL
     C                   MOVE      *ZEROS        XFXLNR            2 0
INT  C                   MOVE      ' '           XHEUR             1
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     SØKUNR        BEGSR
     C***********************************************
     C*
     C     POSNBR        IFGE      76
     C     POSNBR        ANDLE     78
     C                   EXSR      SØKVAD
     C                   MOVEL     WSNAK         WSNAVN
     C                   Z-ADD     25            POSNBR
     C                   Z-ADD     22            LINNBR
     C                   GOTO      ENDSØK
     C                   ENDIF                                                  <POSNBR
     C*
     C     POSNBR        IFGE      64
     C     POSNBR        ANDLE     71
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNR             8 0
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN           30
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     76            POSNBR
     C                   ENDIF                                                  <POSNBR
     C*
     C     POSNBR        IFGE      2
     C     POSNBR        ANDLE     18
INT  C                   MOVE      WSKNR         XWSKNR            8 0
INT01C     XINTFN        IFEQ      'J'
INT01C                   Z-ADD     HEKNA         WSKNR
INT01C                   ELSE
     C                   Z-ADD     HEKNS         WSKNR
INT01C                   END
     C                   CALL      'SYFA81'
     C                   PARM                    WSKNR             8 0
     C     WSKNR         IFNE      *ZEROS
     C                   MOVE      *BLANKS       WSLEK
     C                   ENDIF                                                  <WSKNR
INT  C     WSKNR         IFEQ      *ZEROS
INT  C**???                Z-ADDWSKNR     XWSKNR  80
INT  C                   Z-ADD     XWSKNR        WSKNR
INT  C                   ENDIF                                                  <WSKNR
     C                   Z-ADD     21            LINNBR
     C                   Z-ADD     20            POSNBR
     C                   ENDIF                                                  <POSNBR
     C*
     C     KUNKE2        CHAIN     CUNDL01                            33
     C     *IN33         IFEQ      *OFF
     C                   MOVE      KNAVN         WSNAVN
     C                   ENDIF                                                  <*IN33
     C*
     C     WSADRN        IFNE      *ZEROS
     C     VADRK         CHAIN     VADR                               33
     C     *IN33         IFEQ      *OFF
     C                   MOVEL     WSNAK         WSNAVN
     C                   MOVEL     WXADRN        WSADRN
     C                   ENDIF                                                  <*IN33
     C                   ENDIF                                                  <WSADRN
     C*
     C     ENDSØK        TAG
     C                   ENDSR
     C*
     C***********************************************
     C     HENTNR        BEGSR
     C***********************************************
     C*
     C* HENTER NESTE LØPENUMMER FOR OPPDRAG
     C*
     C     HEADKY        CHAIN     LOPTEL                             33
     C   33              Z-ADD     1             FOLOPN               33
     C                   MOVE      FOLOPN        FOLOP
     C                   MOVE      FOLOPN        WSLOP
     C                   ADD       1             FOLOPN
     C   33              WRITE     LOPTR
     C  N33              UPDATE    LOPTR
     C                   ENDSR
     C*
     C***********************************************
     C     SØKVAD        BEGSR
     C***********************************************
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNR
     C                   PARM                    WSNAK            30
     C                   PARM                    WSADK1           30
     C                   PARM                    WSADK2           30
     C                   PARM                    WSADK3           30
     C                   PARM                    WSLAND            2
     C                   PARM                    WXADRN            5
     C*
     C                   MOVEL     WSNAK         WSNAVN
     C                   MOVEL     WXADRN        WSADRN
     C                   ENDSR
     C*
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     42
     C                   CALL      'SYFI10C'
     C                   PARM                    W3OT
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     43
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    W3FRA
     C                   PARM                    USPED
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      16
     C     POSNBR        ANDEQ     41
     C     *LIKE         DEFINE    KFTYP         XUTYP
     C     *LIKE         DEFINE    KFKOD         XUKOD
     C                   MOVE      *BLANKS       XUKOD
     C                   MOVEL     'PRODTYPE'    XUTYP
     C                   MOVE      'N'           UUPDAT            1
     C                   CALL      'SYKUKD'
     C                   PARM                    XUTYP
     C                   PARM                    UUPDAT            1
     C                   PARM                    XUKOD
     C                   MOVEL     XUKOD         W3KDPL
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     48
     C                   MOVE      *BLANKS       USØKKN           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    W3KN14
     C                   PARM                    FIFIRM
     C                   PARM                    USØKKN
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     41            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      18
     C     POSNBR        ANDGE     41
     C     POSNBR        ANDLE     42
     C                   CALL      'SYFA71A'
     C                   PARM                    W3UTL
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
