     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FTRAN      IF   E           K DISK
     FLLHEAD    UF   E           K DISK
     FLLHEAD05  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADR5)
     FLLHEAD08  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADR8)
     FLLHEAD09  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADR9)
     FLLHEAD10  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADRA)
     FLLHEAD11  IF   E           K DISK
     F                                     RENAME(LLHEADR:LLHEADRB)
     FLL060D    CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  LHMDT                  1      8  0
     D  LHMDTÅ                 1      4  0
     D  LHMDTM                 5      6  0
     D  LHMDTD                 7      8  0
     D                 DS
     D  WHMDT                  1      6  0
     D  WHMDTD                 1      2  0
     D  WHMDTM                 3      4  0
     D  WHMDTÅ                 5      6  0
     D                 DS
     D  WSMDT                  1      6  0
     D  WSMDTD                 1      2  0
     D  WSMDTM                 3      4  0
     D  WSMDTÅ                 5      6  0
     D                 DS
     D  W2MDT                  1      6  0
     D  W2MDTD                 1      2  0
     D  W2MDTM                 3      4  0
     D  W2MDTÅ                 5      6  0
     D                 DS
     D  X2MDT                  1      8  0
     D  X2MDTÅ                 1      4  0
     D  X2MDTM                 5      6  0
     D  X2MDTD                 7      8  0
     D                 DS
     D  LHODT                  1      8  0
     D  LHODTÅ                 1      4  0
     D  LHODTM                 5      6  0
     D  LHODTD                 7      8  0
     D                 DS
     D  WHODT                  1      6  0
     D  WHODTD                 1      2  0
     D  WHODTM                 3      4  0
     D  WHODTÅ                 5      6  0
     D                 DS
     D  WSODT                  1      6  0
     D  WSODTD                 1      2  0
     D  WSODTM                 3      4  0
     D  WSODTÅ                 5      6  0
     D                 DS
     D  W2ODT                  1      6  0
     D  W2ODTD                 1      2  0
     D  W2ODTM                 3      4  0
     D  W2ODTÅ                 5      6  0
     D                 DS
     D  X2ODT                  1      8  0
     D  X2ODTÅ                 1      4  0
     D  X2ODTM                 5      6  0
     D  X2ODTD                 7      8  0
     D                 DS
     D  LHTDT                  1      8  0
     D  LHTDTÅ                 1      4  0
     D  LHTDTM                 5      6  0
     D  LHTDTD                 7      8  0
     D                 DS
     D  WHTDT                  1      6  0
     D  WHTDTD                 1      2  0
     D  WHTDTM                 3      4  0
     D  WHTDTÅ                 5      6  0
     D                 DS
     D  WSTDT                  1      6  0
     D  WSTDTD                 1      2  0
     D  WSTDTM                 3      4  0
     D  WSTDTÅ                 5      6  0
     D                 DS
     D  W2TDT                  1      6  0
     D  W2TDTD                 1      2  0
     D  W2TDTM                 3      4  0
     D  W2TDTÅ                 5      6  0
     D                 DS
     D  X2TDT                  1      8  0
     D  X2TDTÅ                 1      4  0
     D  X2TDTM                 5      6  0
     D  X2TDTD                 7      8  0
     D                 DS
     D  LHBNA                  1     30
     D  WHBNA                  1     13
      *
     C                   EXSR      INIT
      *
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C     BG            TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      '0'           *IN30
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      BG
     C                   END
      *
     C                   MOVE      'DIV0000'     MSGNR
      *
     C     WSGRUP        IFGT      0
     C     CUN1KG        CHAIN     CUNDL01                            99
     C     *IN99         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      BG
     C                   END
     C                   END
      *
     C     CUN1KP        CHAIN     CUNDL01                            98
     C     *IN98         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPK0001'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      BG
     C                   END
      *
     C                   EXSR      HOVED
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   GOTO      BG
     C                   END
      *
     C     SLUTT         TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
      *
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
      *////////////////////////////////////////////////////////////
     C     CUN1KG        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSGRUP
     C     CUN1KP        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSPNR
     C     TRANK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSTN
     C     LH05K1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2PAK
     C     LH08K1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2MDT
     C     LH09K1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2ODT
     C     LH10K1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2TDT
     C     LH11K1        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2TN
     C                   KFLD                    X2ODT
     C     LH11K2        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
     C                   KFLD                    X2TN
     C     LHEADK        KLIST
     C                   KFLD                    WSGRUP
     C                   KFLD                    WSPNR
      *
     C     *LIKE         DEFINE    LHPAK         XXPAK
     C                   EVAL      XXPAK = '99999999999999999'
     C                   MOVEL     '99999999'    XXPAK1           10
     C                   MOVE      '99'          XXPAK1
     C                   MOVE      *ZEROS        W2MDT
     C                   MOVE      *ZEROS        W2ODT
     C                   MOVE      *ZEROS        W2TDT
      *
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     HOVED         BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      XXPAK         W2PAK
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   EXSR      FLYTT
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C                   EXSR      LESREC
      *
     C     START2        TAG
     C  N94              DO
     C                   DO        15
     C                   MOVE      LHMDTD        WHMDTD
     C                   MOVE      LHMDTM        WHMDTM
     C                   MOVE      LHMDTÅ        WHMDTÅ
     C                   MOVE      LHODTD        WHODTD
     C                   MOVE      LHODTM        WHODTM
     C                   MOVE      LHODTÅ        WHODTÅ
     C                   MOVE      LHTDTD        WHTDTD
     C                   MOVE      LHTDTM        WHTDTM
     C                   MOVE      LHTDTÅ        WHTDTÅ
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C                   EXSR      LESREC
     C  N94              ENDDO
     C                   ENDDO
      *
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     X2PAK         IFEQ      XXPAK1
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     5             POSNBR
     C                   ELSE
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   END
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C                   MOVE      'DIV0000'     MSGNR
      *** AVSLUTT
     C   03              GOTO      SLHOV
      *
     C   05              GOTO      START
      *
     C   12              GOTO      SLHOV
      *
     C   25              GOTO      START2
      *
     C     W2PAK         IFNE      *BLANKS
     C     W2TN          ORNE      0
     C     W2MDT         ORNE      0
     C     W2ODT         ORNE      0
     C     W2TDT         ORNE      0
     C                   GOTO      START
     C                   END
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
      *
     C     SLHOV         ENDSR
      *
     C***********************************************
     C     FLYTT         BEGSR
     C***********************************************
     C     *IN05         IFEQ      '0'
     C                   SELECT
     C     W2PAK         WHENNE    *BLANKS
     C                   MOVE      W2PAK         X2PAK            17
     C                   MOVE      *ZEROS        X2MDT
     C                   MOVE      *ZEROS        X2ODT
     C                   MOVE      *ZEROS        X2TDT
     C     W2MDT         WHENNE    0
     C                   MOVE      W2MDTD        X2MDTD
     C                   MOVE      W2MDTM        X2MDTM
     C     W2MDTÅ        IFGT      50
     C     W2MDTÅ        ADD       1900          X2MDTÅ
     C                   ELSE
     C     W2MDTÅ        ADD       2000          X2MDTÅ
     C                   END
     C                   MOVE      *BLANKS       X2PAK
     C                   MOVE      *ZEROS        X2TN
     C                   MOVE      *ZEROS        X2ODT
     C                   MOVE      *ZEROS        X2TDT
     C     W2TN          WHENNE    0
     C                   MOVE      W2TN          X2TN              8 0
     C     W2ODT         IFEQ      0
     C                   MOVE      *ZEROS        X2TDT
     C                   ELSE
     C                   MOVE      W2ODTD        X2ODTD
     C                   MOVE      W2ODTM        X2ODTM
     C     W2ODTÅ        IFGT      50
     C     W2ODTÅ        ADD       1900          X2ODTÅ
     C                   ELSE
     C     W2ODTÅ        ADD       2000          X2ODTÅ
     C                   END
     C                   END
     C                   MOVE      *BLANKS       X2PAK
     C                   MOVE      *ZEROS        X2MDT
     C                   MOVE      *ZEROS        X2TDT
     C     W2ODT         WHENNE    0
     C                   MOVE      W2ODTD        X2ODTD
     C                   MOVE      W2ODTM        X2ODTM
     C     W2ODTÅ        IFGT      50
     C     W2ODTÅ        ADD       1900          X2ODTÅ
     C                   ELSE
     C     W2ODTÅ        ADD       2000          X2ODTÅ
     C                   END
     C                   MOVE      *BLANKS       X2PAK
     C                   MOVE      *ZEROS        X2MDT
     C                   MOVE      *ZEROS        X2TN
     C                   MOVE      *ZEROS        X2TDT
     C                   OTHER
     C                   MOVE      W2TDTD        X2TDTD
     C                   MOVE      W2TDTM        X2TDTM
     C     W2TDTÅ        IFGT      50
     C     W2TDTÅ        ADD       1900          X2TDTÅ
     C                   ELSE
     C     W2TDTÅ        ADD       2000          X2TDTÅ
     C                   END
     C                   MOVE      *BLANKS       X2PAK
     C                   MOVE      *ZEROS        X2MDT
     C                   MOVE      *ZEROS        X2TN
     C                   MOVE      *ZEROS        X2ODT
     C                   ENDSL
     C                   END
     C                   MOVE      *BLANKS       W2PAK
     C                   MOVE      *ZEROS        W2MDT
     C                   MOVE      *ZEROS        W2TN
     C                   MOVE      *ZEROS        W2ODT
     C                   MOVE      *ZEROS        W2TDT
      *
     C                   ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
     C                   SELECT
     C     X2PAK         WHENNE    *BLANKS
     C     LH05K1        SETLL     LLHEAD05
     C     X2MDT         WHENNE    0
     C     LH08K1        SETLL     LLHEAD08
     C     X2TN          WHENNE    0
     C     LH11K1        SETLL     LLHEAD11
     C     X2ODT         WHENNE    0
     C     LH09K1        SETLL     LLHEAD09
     C                   OTHER
     C     LH10K1        SETLL     LLHEAD10
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
     C     STLES         TAG
     C                   SELECT
     C     X2PAK         WHENNE    *BLANKS
     C     X2PAK         IFEQ      XXPAK1
     C     LHEADK        READPE    LLHEAD05                               94
     C                   ELSE
     C     LHEADK        READE     LLHEAD05                               94
     C                   END
     C  N94LHSTA         CABEQ     'D'           STLES
     C     X2MDT         WHENNE    0
     C     LHEADK        READE     LLHEAD08                               94
     C     X2TN          WHENNE    0
     C     LH11K2        READE     LLHEAD11                               94
     C     X2ODT         WHENNE    0
     C     LHEADK        READE     LLHEAD09                               94
     C                   OTHER
     C     LHEADK        READE     LLHEAD10                               94
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C     WSNR          ANDEQ     '2'
     C                   EXSR      ENDRE
     C                   UPDATE    SUBFIL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C  N30              Z-ADD     5             LINNBR
     C  N30              Z-ADD     5             POSNBR
     C                   MOVE      '0'           *IN99
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     ENDRE         BEGSR
      *////////////////////////////////////////////////////////////
     C                   MOVE      '1'           *IN99
     C                   MOVE      ' '           WSNR
     C                   MOVE      LHTN          WSTN
     C                   MOVE      WHMDTD        WSMDTD
     C                   MOVE      WHMDTM        WSMDTM
     C                   MOVE      WHMDTÅ        WSMDTÅ
     C                   MOVE      WHODTD        WSODTD
     C                   MOVE      WHODTM        WSODTM
     C                   MOVE      WHODTÅ        WSODTÅ
     C                   MOVE      WHTDTD        WSTDTD
     C                   MOVE      WHTDTM        WSTDTM
     C                   MOVE      WHTDTÅ        WSTDTÅ
     C                   MOVE      LHMN01        WSMN01
     C                   MOVE      LHMN02        WSMN02
     C     LHOPR         COMP      'E'                                    50
      *
     C     STENDR        TAG
     C                   EXFMT     BILDE02
     C                   MOVEA     '0000'        *IN(87)
     C                   MOVE      '0'           *IN30
      *
     C   04              DO
     C                   MOVE      *ZEROS        UTN               8 0
     C                   CALL      'SYTR04A'
     C                   PARM                    UTN
     C     UTN           IFNE      0
     C                   MOVE      UTN           WSTN
     C                   END
     C                   GOTO      STENDR
     C                   END
     C   12              GOTO      SLENDR
     C                   EXSR      TESTB
     C   30              GOTO      STENDR
      *
     C     LHMN          CHAIN     LLHEAD                             33
     C                   MOVE      WSTN          LHTN
     C                   MOVE      WSMDTD        LHMDTD
     C                   MOVE      WSMDTM        LHMDTM
     C     WSMDTÅ        IFGT      50
     C     WSMDTÅ        ADD       1900          LHMDTÅ
     C                   ELSE
     C     WSMDTÅ        ADD       2000          LHMDTÅ
     C                   END
     C                   MOVE      WSODTD        LHODTD
     C                   MOVE      WSODTM        LHODTM
     C     WSODTÅ        IFGT      50
     C     WSODTÅ        ADD       1900          LHODTÅ
     C                   ELSE
     C     WSODTÅ        ADD       2000          LHODTÅ
     C                   END
     C     LHSTA         IFEQ      ' '
     C                   MOVE      WSTDTD        LHTDTD
     C                   MOVE      WSTDTM        LHTDTM
     C     WSTDTÅ        IFGT      50
     C     WSTDTÅ        ADD       1900          LHTDTÅ
     C                   ELSE
     C     WSTDTÅ        ADD       2000          LHTDTÅ
     C                   END
     C                   END
     C                   MOVE      WSMN01        LHMN01
     C                   MOVE      WSMN02        LHMN02
     C                   UPDATE    LLHEADR
      *
     C                   MOVE      WSMDTD        WHMDTD
     C                   MOVE      WSMDTM        WHMDTM
     C                   MOVE      WSMDTÅ        WHMDTÅ
     C                   MOVE      WSODTD        WHODTD
     C                   MOVE      WSODTM        WHODTM
     C                   MOVE      WSODTÅ        WHODTÅ
     C                   MOVE      WSTDTD        WHTDTD
     C                   MOVE      WSTDTM        WHTDTM
     C                   MOVE      WSTDTÅ        WHTDTÅ
      *
     C     SLENDR        ENDSR
      *
      *////////////////////////////////////////////////////////////
     C     TESTB         BEGSR
      *////////////////////////////////////////////////////////////
     C     TRANK         CHAIN     TRAN                               90
     C     *IN90         IFEQ      '1'
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPT0105'     ZMSGNO
     C                   END
      *
     C                   MOVE      WSODTD        UDD               2 0
     C                   MOVE      WSODTM        UMM               2 0
     C                   MOVE      WSODTÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      89
     C  N30*IN89         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
      *
     C                   MOVE      WSTDTD        UDD               2 0
     C                   MOVE      WSTDTM        UMM               2 0
     C                   MOVE      WSTDTÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      88
     C  N30*IN88         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
      *
     C                   MOVE      WSMDTD        UDD               2 0
     C                   MOVE      WSMDTM        UMM               2 0
     C                   MOVE      WSMDTÅ        UÅÅ               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      87
     C  N30*IN87         IFEQ      '1'
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     54            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
      *
     C     *IN30         IFEQ      '0'
     C                   MOVE      WSMDTD        LHMDTD
     C                   MOVE      WSMDTM        LHMDTM
     C     WSMDTÅ        IFGT      50
     C     WSMDTÅ        ADD       1900          LHMDTÅ
     C                   ELSE
     C     WSMDTÅ        ADD       2000          LHMDTÅ
     C                   END
     C                   MOVE      WSODTD        LHODTD
     C                   MOVE      WSODTM        LHODTM
     C     WSODTÅ        IFGT      50
     C     WSODTÅ        ADD       1900          LHODTÅ
     C                   ELSE
     C     WSODTÅ        ADD       2000          LHODTÅ
     C                   END
     C                   MOVE      WSTDTD        LHTDTD
     C                   MOVE      WSTDTM        LHTDTM
     C     WSTDTÅ        IFGT      50
     C     WSTDTÅ        ADD       1900          LHTDTÅ
     C                   ELSE
     C     WSTDTÅ        ADD       2000          LHTDTÅ
     C                   END
     C     LHMDT         IFGT      LHODT
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
     C  N30LHODT         IFGT      LHTDT
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
     C  N30LHMDT         IFGT      LHTDT
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   MOVE      '1'           *IN30
     C                   MOVE      'SPD0001'     ZMSGNO
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     37
     C                   MOVE      'SØKGRP  '    UTYPE             8
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRUP
     C                   PARM                    WSPNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     30
     C     POSNBR        ANDLE     37
     C                   MOVE      WSGRUP        UTYPE
     C                   CALL      'LL004R'
     C                   PARM                    UTYPE
     C                   PARM                    WSGRUP
     C                   PARM                    WSPNR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      *
