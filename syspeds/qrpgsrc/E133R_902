     H DATEDIT(*YMD)
     FEQUA902   IF   E           K DISK
     FEUNH      IF   E           K DISK
     FEDTM902   IF   E           K DISK
     FETSR902   IF   E           K DISK
     FETOD902   IF   E           K DISK
     FEFTX902   IF   E           K DISK
     FECTA902   IF   E           K DISK
     FERFF902   IF   E           K DISK
     FETDT902   IF   E           K DISK
     FELOC902   IF   E           K DISK
     FENAD902   IF   E           K DISK
     FEGID902   IF   E           K DISK
     FEGDS902   IF   E           K DISK
     FEMEA902   IF   E           K DISK
     FEDIM902   IF   E           K DISK
     FETMP902   IF   E           K DISK
     FEDGS902   IF   E           K DISK
     FEEQD902   IF   E           K DISK
     FEEQN902   IF   E           K DISK
     FECNT902   IF   E           K DISK
     FTELL      UF   E           K DISK
     FHEADF     IF A E             DISK
     FFREETXT   IF A E             DISK
     D A               S              1    DIM(79)
     D B               S              1    DIM(18)
     D                 DS
     D  HEDTOP                 1      8  0
     D  HEDTÅ                  1      4  0
     D  HEDTM                  5      6  0
     D  HEDTD                  7      8  0
      *________________________
      * DS for decimal handling
      *""""""""""""""""""""""""
     D                 DS
     D  ZDEC                   1      7  6
     D  ZDEC6                  2      7
     D  ZHEL                  11     22  0
     IMEAR
     I              MMN                         MEAMMN
      */////////////
      * MAIN LOGIC /
      */////////////
      *___________
      * Initiering
      *"""""""""""
     C                   EXSR      INIT
      *________
      * CONVERT
      *""""""""
     C                   EXSR      RTVDB
     C                   RETURN
      *////////////////////////////////////////////////////////////
      *                                                      INIT /
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
     C  N99
     CAN 99              READ      HEADF                                  99
     C  N99
     CAN 99              READ      FREETXT                                99
     C     KEYMS0        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
     C     KEYQUA        KLIST
     C                   KFLD                    ZUALTA
     C                   KFLD                    ZUALCO
     C     *LIKE         DEFINE    NMN           ZMN
     C     *LIKE         DEFINE    NGN           ZGN0
     C     *LIKE         DEFINE    NGN           ZGN1
     C     *LIKE         DEFINE    NGN           ZGN2
     C     *LIKE         DEFINE    NREP0         ZREPB0
     C     *LIKE         DEFINE    NREP0         ZREPC0
     C     *LIKE         DEFINE    NREP1         ZREPC1
     C     *LIKE         DEFINE    QUALTA        ZUALTA
     C     *LIKE         DEFINE    QUALCO        ZUALCO
     C     *LIKE         DEFINE    HESG          ÆSSG
     C     *LIKE         DEFINE    HEAVD         ÆSAVD
     C     *ENTRY        PLIST
     C                   PARM                    ZMN
     C                   PARM                    HEAVD
     C                   PARM                    HEOPD
     C                   PARM                    ÆSSG
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400    RTVDB /
      *////////////////////////////////////////////////////////////
     C     RTVDB         BEGSR
      *__________
      * INZ HEADF
      *""""""""""
     C                   Z-ADD     HEAVD         ÆSAVD
     C                   CLEAR                   HEADFR
     C                   Z-ADD     ÆSAVD         HEAVD
     C     HEAVD         CHAIN     TELL                               90
     C                   Z-ADD     TEOPDN        HEOPD
     C                   ADD       1             TEOPDN
     C                   UPDATE    TELLR
     C                   MOVE      'A'           HEUR
     C                   MOVE      'U'           HEST
     C                   MOVEL     ÆSSG          HESG
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          HEDTÅ
     C                   ELSE
     C     UYEAR         ADD       2000          HEDTÅ
     C                   END
     C                   MOVE      UMONTH        HEDTM
     C                   MOVE      UDAY          HEDTD
     C                   MOVE      HEDTOP        HEDTR
      *____________
      * INZ FREETXT
      *""""""""""""
     C                   Z-ADD     HEAVD         FRTAVD
     C                   Z-ADD     HEOPD         FRTOPD
     C                   Z-ADD     HEDTR         FRTDT
     C     *LIKE         DEFINE    FRTLI         WRTLI
     C                   Z-ADD     0             WRTLI
      *__________________
      * READ ALL SEGMENTS
      *""""""""""""""""""
     C                   EXSR      BGM00
     C                   EXSR      DTM00
     C                   EXSR      TSR00
     C                   EXSR      TOD00
     C                   EXSR      FTX00
     C                   EXSR      CTA00
     C                   EXSR      RFF02
     C                   EXSR      TDT06
     C                   EXSR      NAD07
     C                   EXSR      GID11
     C                   EXSR      EQD28
     C                   EXSR      CNT00
      *___________________
      * WRITE TO SYSPED400
      *"""""""""""""""""""
     C                   WRITE     HEADFR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * BGM00                                               BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
     C     ZMN           CHAIN     EUNH                               51
      *
     C                   MOVEL     U1004         HERFA
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM00                                               DTM00 /
      *////////////////////////////////////////////////////////////
     C     DTM00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EDTM902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EDTM902                                51
     C     *IN51         DOWEQ     '0'
      *
      *
     C     KEYMS0        READE     EDTM902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TSR00                                               TSR00 /
      *////////////////////////////////////////////////////////////
     C     TSR00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ETSR902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETSR902                                51
     C     *IN51         DOWEQ     '0'
      *
      *
     C     KEYMS0        READE     ETSR902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TOD00                                               TOD00 /
      *////////////////////////////////////////////////////////////
     C     TOD00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        CHAIN     ETOD902                            51
     C     *IN51         IFEQ      '0'
      *
     C                   MOVEL     T4053         HEFR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX00                                               FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EFTX902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EFTX902                                51
     C     *IN51         DOWEQ     '0'
      *
     C     F4451         IFEQ      'ICN'
     C                   MOVE      'K'           FRTKOD
     C                   ELSE
     C                   MOVE      ' '           FRTKOD
     C                   ENDIF
      *
     C     F4440A        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440A        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
      *
     C     F4440B        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440B        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
      *
     C     F4440C        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440C        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
      *
     C     F4440D        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440D        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
      *
     C     F4440E        IFNE      *BLANKS
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEL     F4440E        FRTTXT
     C                   WRITE     FREETXTR
     C                   ENDIF
      *
     C     KEYMS0        READE     EFTX902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * CTA00                                               CTA00 /
      *////////////////////////////////////////////////////////////
     C     CTA00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        CHAIN     ECTA902                            51
     C     *IN51         IFEQ      '0'
      *
      *
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF02                                               RFF02 /
      *////////////////////////////////////////////////////////////
     C     RFF02         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     2             ZGN0
     C     KEYMS0        SETLL     ERFF902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ERFF902                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     R1153         A(1)
     C                   MOVEL     '1153'        ZUALTA
     C                   MOVEL     R1153         ZUALCO
     C     KEYQUA        CHAIN     EQUA902                            52
     C     *IN52         IFEQ      '0'
     C                   MOVEA     QUALTX        A(1)
     C                   ENDIF
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEA     A             FRTTXT
     C                   WRITE     FREETXTR
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     R1154         A(1)
     C                   MOVEA     R2782         A(37)
     C                   ADD       1             WRTLI
     C                   Z-ADD     WRTLI         FRTLI
     C                   MOVEA     A             FRTTXT
     C                   WRITE     FREETXTR
      *
     C     KEYMS0        READE     ERFF902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TDT06                                               TDT06 /
      *////////////////////////////////////////////////////////////
     C     TDT06         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     6             ZGN0
     C     KEYMS0        SETLL     ETDT902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETDT902                                51
     C     *IN51         DOWEQ     '0'
      *
      *
     C                   Z-ADD     TREP0         ZREPB0
     C                   EXSR      LOC06
     C                   EXSR      DTM06
      *
     C     KEYMS0        READE     ETDT902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * NAD07                                               NAD07 /
      *////////////////////////////////////////////////////////////
     C     NAD07         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     7             ZGN0
     C     KEYMS0        SETLL     ENAD902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ENAD902                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   SELECT
     C     N3035         WHENEQ    'CZ'                                         GODSAVSENDER
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAS
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C                   MOVEL     N3042A        HEADS1
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C                   MOVEL     N3251         HEADS2
     C                   ENDIF
     C     N3164         IFNE      *BLANKS
     C                   MOVEL     N3164         HEADS3
     C                   ENDIF
     C     N3035         WHENEQ    'IV'                                         FAKTURAADR
     C     N3124A        IFNE      *BLANKS
     C                   MOVEL     N3124A        HENASF
     C                   MOVEL     N3124A        HENAA
     C                   ENDIF
     C     N3035         WHENEQ    'CN'                                         LEV.ADR
     C     N3035         OREQ      'DP'                                         LEV.ADR
     C     N3036A        IFNE      *BLANKS
     C                   MOVEL     N3036A        HENAK
     C                   ENDIF
     C     N3042A        IFNE      *BLANKS
     C                   MOVEL     N3042A        HEADK1
     C                   ENDIF
     C     N3251         IFNE      *BLANKS
     C                   MOVEL     N3251         HEADK2
     C                   ENDIF
     C     N3164         IFNE      *BLANKS
     C                   MOVEL     N3164         HEADK3
     C                   ENDIF
     C                   ENDSL
      *
     C                   Z-ADD     NREP0         ZREPB0
     C                   EXSR      CTA08
     C                   EXSR      RFF09
      *
     C     KEYMS0        READE     ENAD902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GID11                                               GID11 /
      *////////////////////////////////////////////////////////////
     C     GID11         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     11            ZGN0
     C     KEYMS0        SETLL     EGID902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EGID902                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     G7224A        A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          HENT
     C                   MOVEL     G4774A        HEVS1
     C                   MOVEL     G4774B        HEVS2
      *
     C                   Z-ADD     GREP0         ZREPB0
     C                   EXSR      GDS13
     C                   EXSR      MEA14
     C                   EXSR      DIM15
     C                   EXSR      TMP11
     C                   EXSR      RFF16
     C                   EXSR      DGS23
      *
     C     KEYMS0        READE     EGID902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * EQD28                                               EQD28 /
      *////////////////////////////////////////////////////////////
     C     EQD28         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     28            ZGN0
     C     KEYMS0        SETLL     EEQD902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EEQD902                                51
     C     *IN51         DOWEQ     '0'
      *
      *
     C                   Z-ADD     EREP0         ZREPB0
     C                   EXSR      EQN28
     C                   EXSR      DIM28
     C                   EXSR      FTX28
      *
     C     KEYMS0        READE     EEQD902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * CNT00                                               CNT00 /
      *////////////////////////////////////////////////////////////
     C     CNT00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     ECNT902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ECNT902                                51
     C     *IN51         DOWEQ     '0'
      *
     C     C6069A        IFEQ      '10 '
     C                   MOVE      *BLANKS       A
     C                   MOVEA     C6066A        A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          HENT
     C                   ENDIF
      *
     C     KEYMS0        READE     ECNT902                                51
     C  N51              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC06                                               LOC06 /
      *////////////////////////////////////////////////////////////
     C     LOC06         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     6             ZGN1
     C     KEYMS1        SETLL     ELOC902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ELOC902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM06                                               DTM06 /
      *////////////////////////////////////////////////////////////
     C     DTM06         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     6             ZGN1
     C     KEYMS1        SETLL     EDTM902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     EDTM902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * CTA08                                               CTA08 /
      *////////////////////////////////////////////////////////////
     C     CTA08         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     ECTA902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ECTA902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ECTA902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF09                                               RFF09 /
      *////////////////////////////////////////////////////////////
     C     RFF09         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     9             ZGN1
     C     KEYMS1        SETLL     ERFF902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ERFF902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF16                                               RFF16 /
      *////////////////////////////////////////////////////////////
     C     RFF16         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     ERFF902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ERFF902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GDS13                                               GDS13 /
      *////////////////////////////////////////////////////////////
     C     GDS13         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     13            ZGN1
     C     KEYMS1        SETLL     EGDS902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGDS902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C                   Z-ADD     FREP0         ZREPC0
     C                   Z-ADD     FREP1         ZREPC1
     C                   EXSR      FTX13
      *
     C     KEYMS1        READE     EGDS902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MEA14                                               MEA14 /
      *////////////////////////////////////////////////////////////
     C     MEA14         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     14            ZGN1
     C     KEYMS1        SETLL     EMEA902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMEA902                                53
     C     *IN53         DOWEQ     '0'
      *
     C     M6311         IFEQ      'GRO'
     C                   MOVE      *BLANKS       A
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   ADD       ZNUM          HEVKT
     C                   ENDIF
      *
     C     M6311         IFEQ      'VOL'
     C                   MOVE      *BLANKS       A
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   ADD       ZNUM          HEM3
     C                   ENDIF
      *
     C     KEYMS1        READE     EMEA902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DIM15                                               DIM15 /
      *////////////////////////////////////////////////////////////
     C     DIM15         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     15            ZGN1
     C     KEYMS1        SETLL     EDIM902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDIM902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     EDIM902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TMP11                                               TMP11 /
      *////////////////////////////////////////////////////////////
     C     TMP11         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     11            ZGN1
     C     KEYMS1        SETLL     ETMP902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETMP902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     ETMP902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DGS23                                               DGS23 /
      *////////////////////////////////////////////////////////////
     C     DGS23         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     23            ZGN1
     C     KEYMS1        SETLL     EDGS902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDGS902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C                   Z-ADD     DREP0         ZREPC0
     C                   Z-ADD     DREP1         ZREPC1
     C                   EXSR      FTX23
      *
     C     KEYMS1        READE     EDGS902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * EQN28                                               EQN28 /
      *////////////////////////////////////////////////////////////
     C     EQN28         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     28            ZGN1
     C     KEYMS1        SETLL     EEQN902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EEQN902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     EEQN902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DIM28                                               DIM28 /
      *////////////////////////////////////////////////////////////
     C     DIM28         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     28            ZGN1
     C     KEYMS1        SETLL     EDIM902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDIM902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     EDIM902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX13                                               FTX13 /
      *////////////////////////////////////////////////////////////
     C     FTX13         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     12            ZGN1
     C     KEYMS1        SETLL     EFTX902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX902                                53
     C     *IN53         DOWEQ     '0'
      *
     C     F4451         IFEQ      'AAA'
     C                   MOVEL     F4440A        HEGM1
     C                   MOVEL     F4440B        HEGM2
     C                   ELSE
     C     F4451         IFEQ      'AAQ'
     C                   MOVEL     F4440A        HEVS1
     C                   MOVEL     F4440A        HEVS2
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     EFTX902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX28                                               FTX28 /
      *////////////////////////////////////////////////////////////
     C     FTX28         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     28            ZGN1
     C     KEYMS1        SETLL     EFTX902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX902                                53
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS1        READE     EFTX902                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX23                                               FTX23 /
      *////////////////////////////////////////////////////////////
     C     FTX23         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     23            ZGN2
     C     KEYMS2        SETLL     EFTX902                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EFTX902                                54
     C     *IN53         DOWEQ     '0'
      *
      *
     C     KEYMS2        READE     EFTX902                                54
     C  N54              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Get numerical value                               GETNUM /
      *////////////////////////////////////////////////////////////
     C     GETNUM        BEGSR
     C                   MOVE      *ZEROS        ZHEL
     C                   MOVE      *ZEROS        ZDEC
     C                   MOVE      *ZEROS        B
     C                   Z-ADD     1             AX                2 0
     C                   Z-ADD     1             BX                2 0
      * Get Integer
     C     A(AX)         DOWGE     '0'
     C     ZHEL          MULT      10            ZHEL
     C                   MOVE      A(AX)         ZHEL
     C                   ADD       1             AX
     C                   ENDDO
      * Decimal point ?
     C     A(AX)         IFEQ      '.'
     C     A(AX)         OREQ      ','
     C                   ADD       1             AX
     C     A(AX)         DOWGE     '0'
     C                   MOVE      A(AX)         B(BX)
     C                   ADD       1             AX
     C                   ADD       1             BX
     C                   ENDDO
     C                   MOVEA     B             ZDEC6
     C                   ENDIF
      * Concatenate
     C                   Z-ADD     ZHEL          ZNUM             18 6
     C                   ADD       ZDEC          ZNUM
     C                   ENDSR
