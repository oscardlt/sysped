********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10027 * 01 YBC PTF10 ORDRETYPE
10172 * 02 SH  PTF10 norsk text til Track and trace
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT PROFORMAFAKTURA
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORER 29-32 41-49 51-99
      **************************************************************
      *
     FKODTFM    IF   E           K DISK
     FGSSSTK    IF   E           K DISK
     FCDBOAT    IF   E           K DISK    USROPN
     FHEADF     IF   E           K DISK    USROPN
     FGSS035W   UF   E           K DISK    USROPN
     FGSS035W2  IF A E           K DISK    USROPN
     FGSSGDF    IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FFAXSEN    IF   E           K DISK
     FFAXMANP   O  A E           K DISK    USROPN
     FFAXMANT   UF A E           K DISK
     Ffirm      IF   E           K DISK
     FTRACKF    O    E             DISK
     FGSSTRF    UF   E           K DISK
     FGSSORL22  UF   E           K DISK
     FGSSORF    IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF00)
     FGSSORL21  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF21)
     FGSSORL24  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF24)
     FGSSORL25  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF25)
     FGSS031W   UF A E           K DISK    USROPN
     FGSSPOF    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSSFF    IF   E           K DISK
     FGSS033P   O    E             PRINTER OFLIND(*IN27)
     F                                     USROPN
     D                 DS
     D  ORFT1                  1     30
     D  ORFT2                 31     60
     D  ORFT3                 61     90
     D  ORFT4                 91    120
     D  FT                     1    120
     D                                     DIM(4)
     D                 DS
     D  XCONO1                 1     20
     D  XCONO2                21     40
     D  XCONO3                41     60
     D  XCONO4                61     80
     D  XCONO5                81    100
     D  XCONO6               101    120
     D  CO                     1   1000    DIM(50)
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(GSS033P) -
     D                                     DEVTYPE(*IPDS) OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 80) -
     D                                     CPI(10) -
     D                                     OVRFLW(61) -
     D                                     COPIES(')
     D XCMD30          C                   CONST('OVRPRTF -
     D                                     FILE(GSS033P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 85) -
     D                                     LPI(6) -
     D                                     CPI(10) -
     D                                     FRONTMGN(0 0.4) -
     D                                     OVRFLW(61) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(QFAX/QFAXOUTQ) -
     D                                     FORMTYPE(*STD)')
     D XCMD30E         C                   CONST('OVRPRTF -
     D                                     FILE(GSS033P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 85) -
     D                                     LPI(6) -
     D                                     CPI(10) -
     D                                     OVRFLW(61) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D XCMD30B         C                   CONST('OVRPRTF -
     D                                     FILE(GSS033P) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(66 85) -
     D                                     LPI(6) -
     D                                     CPI(10) -
     D                                     OVRFLW(60) -
     D                                     OUTQ(FAX/FAXOUT) -
     D                                     FORMTYPE(*STD)')
     D XCMD40          C                   CONST('OVRPRTF -
     D                                     FILE(GSS033P) -
     D                                     PAGESIZE(72 85) -
     D                                     LPI(6) -
     D                                     CPI(10) -
     D                                     FRONTMGN(0 0,4) -
     D                                     OVRFLW(61) -
     D                                     DRAWER(3) -
     D                                     PRTTXT(')
     D XCMD41          C                   CONST('OUTQ(')
     D XCMD90          C                   CONST('CLRPFM FILE(GSS031W)-
     D                                      MBR(')
     D XXTXT01         C                   CONST('Printed manifest.')
     D XXTXT02         C                   CONST('Manifest No.')
N02  D XXTXT01l        C                   CONST('Skrevet manifest.')
n02  D XXTXT02l        C                   CONST('Manifest Nr.')
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  WSFAXN                 1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  3      8  0
     D  XIDAG8                 1      8  0
     D                 DS
     D  TRDTSÅ                 1      4  0
     D  TRDTSM                 5      6  0
     D  TRDTSD                 7      8  0
     D  TRDTS                  1      8  0
     D                 DS
     D  XTDTSD                 1      2  0
     D  XTDTSM                 3      4  0
     D  XTDTSÅ                 5      6  0
     D  XTDTS                  1      6  0
     D                 DS
     D  TRDTLÅ                 1      4  0
     D  TRDTLM                 5      6  0
     D  TRDTLD                 7      8  0
     D  TRDTL                  1      8  0
     D                 DS
     D  W3DTLD                 1      2  0
     D  W3DTLM                 3      4  0
     D  W3DTLÅ                 5      6  0
     D  W3DTL                  1      6  0
     D                 DS
     D  XTIME                  1     14  0
     D  XDAG                   7      8  0
     D  XMND                   9     10  0
     D  XAAR                  11     14  0
     D                 DS
     D  GDDSC                  1     55
     D  GDDSCX                 1     30
     D                SDS
     D  UJOBNM               244    253
     D  UUSER                254    263
     D                UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UBIUSI               101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
     D  UWCNAM               544    573
     D  UWFAXN               574    588
     D  UWRET                591    596
     D  UWTIME               598    603  0
     D  UWDATE               606    611  0
     D  UCOVP                612    612
     D  UCOV01               613    652
     D  UCOV02               653    692
     D  UCOV03               693    732
     D  UCOV04               733    772
     D  UCOV05               773    812
     D  UCOV06               813    852
     D  UCOV07               853    892
     D  UCOV08               893    932
     D  UEMAIL               933   1002
     D  UEMAIlj             1003   1003
      *
     C                   EXSR      INIT
      *
     C     UTNO          CHAIN     GSSTRF                             33
     C  N33UTYPE         IFEQ      'PRT'                                        1<-B
     C     UTYPE         OREQ      'CPY'
      *
     C     *IN50         IFEQ      '0'                                           2<-B
     C                   OPEN      GSS035W
     C     TRTNO         CHAIN     GSS035W                            28
     C  N28              OPEN      GSS035W2
     C  N28              MOVE      TRTNO         W32TNO
     C                   END                                                     2<-E
      *
     C  N50              MOVE      '3'           TRST
     C  N50              MOVE      XIDAG8        TRDTI
     C                   UPDATE    GSSTRFR
     C                   MOVE      TRDTSD        XTDTSD
     C                   MOVE      TRDTSM        XTDTSM
     C                   MOVE      TRDTSÅ        XTDTSÅ
      *
     C   50              EXSR      LESORD
      *
     C     TRFC          CHAIN     GSSFIF                             34
      *
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     UUTFAX        IFEQ      'J'                                           2<-B
     c     uemail        ifne      *blanks
     C     FAXSYS        IFEQ      'B'
     C                   MOVEL     XCMD30B       UCMD
     C                   ELSE
     C                   MOVEL     XCMD30e       UCMD
     C                   END
     c                   else
     C     FAXLIB        IFEQ      *BLANKS                                        3<-B
     C                   MOVEL     XCMD30        UCMD
     C                   ELSE                                                     3
     C     XCMD40        CAT       '.FAX':1      UCMD
     C                   CAT       WSFAXN:0      UCMD
     C                   CAT       ')':1         UCMD
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       FAXLIB:0      UCMD
     C                   CAT       '/':0         UCMD
     C                   CAT       FAXUTK:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                      3<-E
     c                   end
     C                   ELSE                                                    2
     C     XCMD11        CAT       UPRT:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       UCPY:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                     2<-E
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   OPEN      GSS033P
      *
     C                   MOVE      '0'           *IN27
     C                   WRITE     GSS033PA
      *
     C     *IN50         IFEQ      '0'                                           2<-B
     C     UTNO          SETLL     GSSORL22                           33
     C                   ELSE                                                    2
     C     *LOVAL        SETLL     GSS031W                            33
     C                   END                                                     2<-E
     C     STPRT         TAG
     C     *IN50         IFEQ      '0'                                           2<-B
     C     UTNO          READE     GSSORL22                               33
     C                   ELSE                                                    2
     C                   READ(N)   GSS031W                                33
     C                   END                                                     2<-E
N01   *
N01  C  N33              IF        UORDTYP <> ' '                                2<-B
N01  C                   IF        UORDTYP <> 'C' OR ORTYPE <> ' '
N01  C     ORTYPE        CABNE     UORDTYP       STPRT
N01  C                   END
N01  C                   END                                                     2<-E
N01   *
     C     *IN33         IFEQ      '1'                                           2<-B
     C     *IN50         IFEQ      '1'                                            3<-B
     C                   CLOSE     GSS031W
     C                   CLOSE     GSSORF
     C                   CLOSE     GSSORL21
     C                   CLOSE     GSSORL24
     C                   CLOSE     GSSORL25
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C  N50              MOVE      '3'           ORST
     C  N50              UPDATE    GSSORFR
      *
     C     ORSNO         CHAIN     GSSSFF                             34
     C   34              MOVE      ORSNM         SFNM
      *
     C     XCLNFC        IFEQ      0                                              3<-B
     C                   MOVE      ORCLNF        XCLNFC
     C                   MOVE      ORCURC        XVALC
     C                   ELSE                                                     3
     C     XCLNFC        IFNE      ORCLNF                                          4<B
     C   40              MOVE      XLCBLC        XTAMTC
     C                   WRITE     GSS033PE
     C                   MOVE      ORCLNF        XCLNFC
     C                   MOVE      *ZEROS        XTWTC
     C                   MOVE      *ZEROS        XTAMTC
     C                   MOVE      *ZEROS        XLCBLC
     C                   MOVE      ORCURC        XVALC
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C                   ADD       ORWT          XTWTC
     C                   ADD       ORWT          XTWT
     C     ORCLNT        IFEQ      0                                              3<-B
     C                   MOVE      ORCLNF        ORCLNT
     C                   END                                                      3<-E
     C     ORCLNF        IFGT      XCLNF                                          3<-B
     C     ORCLNT        IFGT      XCLNT                                           4<-B
     C     ORCLNT        SUB       ORCLNF        XCLI
     C                   ADD       1             XCLI
     C                   ADD       XCLI          XTCLI
     C                   MOVE      ORCLNF        XCLNF
     C                   MOVE      ORCLNT        XCLNT
     C                   END                                                       4<-E
     C                   ELSE                                                     3
     C     ORCLNT        IFGT      XCLNT                                           4<-B
     C     ORCLNT        SUB       XCLNT         XCLI
     C                   ADD       XCLI          XTCLI
     C                   MOVE      ORCLNT        XCLNT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     ORONO         SETLL     GSSPOF                             34
     C     ORONO         READE     GSSPOF                                 34
     C                   MOVE      *BLANKS       CO
     C                   MOVE      *ZEROS        XN                3 0
     C     *IN34         DOWEQ     '0'                                            3<-B
     C                   ADD       1             XN
     C                   MOVE      POCONO        CO(XN)
     C     ORONO         READE     GSSPOF                                 34
     C  N33              END                                                      3<-E
     C     XCONO4        COMP      *BLANKS                            3535
     C     XCONO5        COMP      *BLANKS                            3636
     C     XCONO6        COMP      *BLANKS                            3737
      *
     C                   ADD       ORAMT         XTAMTC
     C                   ADD       ORAMT         XTAMT
     C     KODVAK        CHAIN     VALUL01                            34
     C     VALKU2        IFNE      0                                              3<-B
     C                   Z-ADD     VALKU2        VALKU1
     C                   END                                                      3<-E
     C     ORAMT         MULT(H)   VALKU1        XBL              15 6
     C                   DIV(H)    OMRFAK        XBL
     C                   ADD(H)    XBL           XLCBLC           11 2
     C                   ADD(H)    XBL           XLCBL            11 2
     C     XVALC         IFEQ      *BLANKS                                        3<-B
     C                   MOVE      ORCURC        XVALC
     C                   ELSE                                                     3
     C  N40XVALC         IFNE      ORCURC                                          4<-B
     C                   MOVE      '1'           *IN40
     C                   MOVE      UCURR         XVALC
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C     XVAL          IFEQ      *BLANKS                                        3<-B
     C                   MOVE      ORCURC        XVAL
     C                   ELSE                                                     3
     C  N38XVAL          IFNE      ORCURC                                          4<-B
     C                   MOVE      '1'           *IN38
     C                   MOVE      UCURR         XVAL
     C                   END                                                       4<-E
     C                   END                                                      3<-E
      *
     C     ORONO         SETLL     GSSGDF
     C     ORONO         READE     GSSGDF                                 34
     C                   MOVE      *BLANKS       GDDSC1
     C                   MOVE      *BLANKS       GDDSC2
     C                   MOVE      *BLANKS       GDDSC3
     C                   MOVE      *BLANKS       GDDSC4
     C  N34              MOVE      GDDSCX        GDDSC1
     C  N34
     CAN 35ORONO         READE     GSSGDF                                 34
     C  N34
     CAN 35              MOVE      GDDSCX        GDDSC2
     C  N34
     CAN 36ORONO         READE     GSSGDF                                 34
     C  N34
     CAN 36              MOVE      GDDSCX        GDDSC3
     C  N34
     CAN 37ORONO         READE     GSSGDF                                 34
     C  N34
     CAN 37              MOVE      GDDSCX        GDDSC4
      *
     C     ORCLNF        COMP      ORCLNT                                 39
     C   27              DO                                                       3<-B
     C                   WRITE     GSS033PF
     C                   WRITE     GSS033PA
     C                   WRITE     GSS033PG
     C                   MOVE      '0'           *IN27
     C                   END                                                      3<-E
     C                   WRITE     GSS033PB
      *
     C     7             DO        50            XN
     C                   IF        CO(XN) <> *BLANKS
     C   27              DO                                                       3<-B
     C                   WRITE     GSS033PF
     C                   WRITE     GSS033PA
     C                   WRITE     GSS033PG
     C                   MOVE      '0'           *IN27
     C                   END                                                      3<-E
     C                   MOVE      CO(XN)        XCONOX
     C                   WRITE     GSS033PJ
     C                   END
     C                   ENDDO
      *
      *
     C     *IN28         IFEQ      '0'                                            3<-B
     C     *IN50         ANDEQ     '0'
     C     ORCLNF        ANDNE     0
     C                   MOVE      ORCLNF        XCLNF2
     C                   MOVE      ORCLNT        XCLNT2
     C     XCLNF2        IFEQ      0                                               4<-B
     C                   MOVE      XCLNF2        XCLNT2
     C                   END                                                       4<-E
     C     XCLNT2        DO        XCLNT2        W32CLN                            4<-B
     C     GW352K        CHAIN     GSS035W2                           34
     C   34              WRITE     GSS35WR2
     C                   ENDDO                                                     4<-E
     C                   END                                                      3<-E
      *
     C  N34ORONO         READE     GSSGDF                                 34
     C     *IN34         DOWEQ     '0'                                            3<-B
     C   27              DO                                                        4<-B
     C                   WRITE     GSS033PF
     C                   WRITE     GSS033PA
     C                   WRITE     GSS033PG
     C                   MOVE      '0'           *IN27
     C                   END                                                       4<-E
     C                   WRITE     GSS033PH
     C     ORONO         READE     GSSGDF                                 34
     C  N34              ENDDO                                                    3<-E
      *
     C     ORKDL1        IFEQ      'PI'
     C     ORKDL2        OREQ      'PI'
     C     ORKDL3        OREQ      'PI'
     C     1             DO        4             XN                3 0
     C     FT(XN)        IFNE      *BLANKS
     C                   MOVE      FT(XN)        XXFT
     C   27              DO                                                        4<-B
     C                   WRITE     GSS033PF
     C                   WRITE     GSS033PA
     C                   WRITE     GSS033PG
     C                   MOVE      '0'           *IN27
     C                   END                                                       4<-E
     C                   WRITE     GSS033PI
     C                   ENDIF
     C                   ENDDO
     C                   ENDIF
      *
      *
     C                   GOTO      STPRT
     C                   END                                                     2<-E
      *
     C     *IN40         IFEQ      '0'                                           2<-B
     C                   ELSE                                                    2
     C                   MOVE      XLCBLC        XTAMTC
     C                   END                                                     2<-E
     C   38              MOVE      XLCBL         XTAMT
      *
     C                   WRITE     GSS033PE
     C   27              DO                                                      2<-B
     C                   WRITE     GSS033PF
     C                   WRITE     GSS033PA
     C                   WRITE     GSS033PG
     C                   MOVE      '0'           *IN27
     C                   END                                                     2<-E
     C                   WRITE     GSS033PC
     C                   WRITE     GSS033PD
      *
     C                   EXSR      OPDLOGG
      *
     C                   CLOSE     GSS033P
      *
     C     *IN50         IFEQ      '0'                                           2<-B
     C                   OPEN      GSS035W2
     C     TRTNO         CHAIN     GSS035W                            33
     C     *IN33         IFEQ      '0'                                            3<-B
     C                   OPEN      CDBOAT
     C     TRBCD         CHAIN     CDBOAT                             33
     C                   CLOSE     CDBOAT
     C   33              MOVEL     TRBCD         CBNAB
     C                   MOVE      CBNAB         W3NAB
     C                   MOVE      TRAD1         W3AD1
     C                   MOVE      TRAD2         W3AD2
     C                   MOVE      TRAD3         W3AD3
     C                   MOVE      TRAD4         W3AD4
     C                   MOVE      TRAD5         W3AD5
     C                   MOVE      TRAD6         W3AD6
     C                   MOVE      TRFC          W3FC
     C                   MOVE      TRDTLD        W3DTLD
     C                   MOVE      TRDTLM        W3DTLM
     C                   MOVE      TRDTLÅ        W3DTLÅ
     C                   MOVE      XTCLI         W3CLT
     C                   MOVE      XTWT          W3VKT
     C                   OPEN      HEADF
     C     HEADFK        CHAIN     HEADF                              33
     C                   CLOSE     HEADF
     C                   MOVE      HESDT         W3SDT
     C                   UPDATE    GSS035WR
     C                   CLOSE     GSS035W
     C                   CALL      'GSS035R'
     C                   PARM                    UTNO2
     C                   END                                                      3<-E
     C                   CLOSE     GSS035W
     C                   END                                                     2<-E
      *
     C     UUTFAX        IFEQ      'J'                                           2-<B
     C                   EXSR      SNDFAX
     C                   END                                                     2<-E
      *
     C                   ELSE                                                   1
      *
     C                   MOVE      '4'           TRST
     C                   UPDATE    GSSTRFR
     C     UTNO          SETLL     GSSORL22                           33
     C     STCFM         TAG
     C     UTNO          READE     GSSORL22                               33
     C  N33              DO                                                      2<-B
     C                   MOVE      '4'           ORST
     C                   UPDATE    GSSORFR
     C                   CALL      'GSS032R'
     C                   PARM                    UTNO
     C                   PARM                    ORONO
     C                   GOTO      STCFM
     C                   END                                                     2<-E
      *
     C                   END                                                    1<-E
      *
     C     SLUTT         TAG
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     KODVAK        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    ORCURC
     C     HEADFK        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     GW352K        KLIST
     C                   KFLD                    W32TNO
     C                   KFLD                    W32CLN
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO2            11
     C                   PARM                    UTYPE             3
     C                   PARM                    UPRT             10
N01  C                   PARM                    UORDTYP           1
     C                   PARM                    UCPY              1
     C                   PARM                    UUTFAX            1
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
      *
     c                   read      firm                                   33
     C                   MOVE      UTNO2         UTNO             11 0
     C                   MOVEL     UTNO          HEAVD
     C                   MOVE      UTNO          HEOPD
     C                   TIME                    XTIME
     C                   MOVE      XAAR          XIDAGÅ
     C                   MOVE      XMND          XIDAGM
     C                   MOVE      XDAG          XIDAGD
     C     *LIKE         DEFINE    ORCLI         XCLI
     C     *LIKE         DEFINE    ORCLNF        XCLNF
     C     *LIKE         DEFINE    ORCLNT        XCLNT
     C     *LIKE         DEFINE    ORCLNF        XCLNF2
     C     *LIKE         DEFINE    ORCLNT        XCLNT2
     C     *LIKE         DEFINE    ORCLNF        XCLNFC
     C     *LIKE         DEFINE    ORONO         XONO
     C     *LIKE         DEFINE    ORONO         XONO1
     C     *LIKE         DEFINE    ORONO         XONO2
     C     *LIKE         DEFINE    ORONO         XONO3
     C     *LIKE         DEFINE    ORBCD         XBCD1
     C     *LIKE         DEFINE    ORBCD         XBCD2
     C     *LIKE         DEFINE    ORBCD         XBCD3
     C     UTYPE         COMP      'CPY'                                  50
      *
     C     UUTFAX        IFEQ      'J'
     C     UFIRM         CHAIN     FAXSEN                             33
     C                   END
      *
     C     UUTFAX        IFNE      'J'
     C     KEYST         KLIST
     C                   KFLD                    STRPRT
     C                   MOVE      UPRT          STRPRT
     C     KEYST         CHAIN     GSSSTK                             33
     C     *IN33         IFEQ      '0'
     C     STRF01        CHAIN     KODTFM                             33
     C                   END
     C                   END
     C                   ENDSR
      *
     C***********************************************
     C     LESORD        BEGSR
     C***********************************************
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C                   MOVEL     XCMD90        UCMD
     C     XCMD90        CAT       UJOBNM:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C                   OPEN      GSS031W
     C                   OPEN      GSSORF
     C                   OPEN      GSSORL21
     C                   OPEN      GSSORL24
     C                   OPEN      GSSORL25
      *
     C     UTNO          SETLL     GSSORL21                           33
     C     UTNO          SETLL     GSSORL24                           34
     C     UTNO          SETLL     GSSORL25                           35
     C     STLES         TAG
     C     UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C     UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C     UTNO          READE     GSSORL25                               35
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
      *
     C     *IN33         DOWEQ     '0'
     C     *IN34         OREQ      '0'
     C     *IN35         OREQ      '0'
     C     XONO          CHAIN     GSSORF                             36
N01  C                   IF        UORDTYP <> ' '
N01  C                   IF        UORDTYP <> 'C' OR ORTYPE <> ' '
N01  C     ORTYPE        CABNE     UORDTYP       STLES
N01  C                   END
N01  C                   END
     C                   WRITE     GSS031WR
     C     STLES2        TAG
     C                   SELECT
     C     XONO3         WHENEQ    XONO
     C  N35UTNO          READE     GSSORL25                               35
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C   35              GOTO      STLES2
     C     XONO2         WHENEQ    XONO
     C  N34UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C                   OTHER
     C  N33UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C                   ENDSL
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
     C  N33
     CORN34
     CORN35              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
     C     UWRET         IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     UWFAXN        FAXNRP
     C                   END
      *
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C     UWTIME        IFNE      *ZEROS
     C     UWDATE        IFNE      *ZEROS
     C                   MOVE      *BLANKS       PTIME
     C                   MOVEL     *BLANKS       PDATE
     C                   MOVEL     UWTIME        PTIME
     C                   MOVEL     UWDATE        PDATE
     C                   END
     C                   END
     C                   MOVE      'B'           UUKODE            1
     C                   MOVEL     'SHIPPROF'    DOKNAV           12
     C                   MOVE      'ORMA'        DOKNAV
     C                   MOVE      *ZEROS        FAXAVD            4
     C                   MOVE      *ZEROS        FAXOPD            7
     C                   MOVE      *ZEROS        FAXTUR            8
     C                   MOVEL     'GSS033P '    FILEN            10
     C     UCOVP         IFEQ      ' '
     C                   MOVE      'N'           UCOVP
     C                   END
     C     UCOVP         IFEQ      'Y'
     C                   MOVE      'J'           UCOVP
     C                   END
      *
     C     FAXSYS        IFEQ      'F'
     C     uemail        ORNE      *BLANKS
     C     FAXLIB        IFEQ      *BLANKS
     C                   MOVE      'N'           uemailj           1
     C     uemail        IFNE      *BLANKS
     c     cbnab         ifne      *blanks
     c                   movel     cbnab         emne             40
     c                   move      'Prof.invoice'emne
     c                   else
     c                   movel     'prof.invoice'emne
     c                   end
     C                   MOVE      'J'           uemailj
     c                   movel     uemail        uwcnam
     c                   movel     'EMAIL       'faxnrp
     C                   END
     C                   CALL      'GSS015C2'
     C                   PARM                    UCOVP
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    FAXNRP
     C                   PARM                    FILEN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   PARM                    uemail
     c                   parm                    emne
     C                   PARM                    uemailj
     C                   ELSE
      * VED FAX400 SENDER SYSTEMET AUTOMATISK FRA UTKØ
     C                   END
      *
     c     uemail        ifne      *blanks
     c                   movel     'MAIL'        faxnrp
     c                   movel     uemail        uwcnam
     c                   end
     C                   MOVEL     UQUSER        MAPPE            20
     C                   CALL      'FAX013'
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    UQJOB
     C                   PARM                    FAXNRP
     C                   PARM                    DOKNAV
     C                   PARM                    MAPPE
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UWCNAM
     C                   PARM                    FAXAVD
     C                   PARM                    FAXOPD
     C                   PARM                    FAXTUR
     C                   PARM                    UUKODE
     C                   END
      *
     C     FAXSYS        IFEQ      'B'
     C     uemail        ANDEQ     *BLANKS
     C     FIFIRM        CHAIN     FAXMANT                            33
     C   33              Z-ADD     1             UNIK
     C  N33              ADD       1             UNIK
     C   33              WRITE     FAXMANTR
     C  N33              UPDATE    FAXMANTR
     C                   EVAL      PRTFIL = 'GSS033P'
     C                   OPEN      FAXMANP
     C                   MOVE      UQNBR         JOBNR
     C                   EVAL      KNAVN = UWCNAM
     C                   EVAL      FINAVN = FIFT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           PUDATE
     C                   EXCEPT    SKRIV
     C                   CLOSE     FAXMANP
     C                   CALL      'GSS015C3'
     C                   PARM                    KNAVN
     C                   PARM                    FAXNRP
     C                   PARM                    UNIK
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    PRTFIL           10
     C                   PARM                    DOKNAV
     C                   PARM                    UCOVP
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   END
      *
     C                   ENDSR
      *
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   MOVE      UWRET         FAXRET
     C                   MOVE      UWFAXN        WSFAXN
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
      *=====================================================================
      *  Oppdater loggen
      *=====================================================================
     C     OPDLOGG       begsr
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVEL     UTNO          TTAVD
     C                   MOVE      UTNO          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'PS3'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTTEXT = XXTXT01
     C                   CAT       XXTXT02:10    TTTEXT
     C                   CAT       UTNO2:1       TTTEXT
n02  C                   EVAL      TTTEXl = XXTXT01l
n02  C                   CAT       XXTXT02l:10   TTTEXl
n02  C                   CAT       UTNO2:1       TTTEXl
     C                   WRITE     TRACKFR
      *
     C                   endsr
      *
      *
     OFAXMANR   EADD         SKRIV
     O                       UNIK
     O                       FAXNRP
     O                       PTIME
     O                       PDATE
     O                       KUNDNR
     O                       KNAVN
     O                       TIL
     O                       FRA
     O                       EMNE
     O                       FINAVN
     O                       JOBNR
     O                       PUDATE
