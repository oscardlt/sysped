      *
      ************************************************************
      *** PROGRAM SKAL LESE VALGBEGREPENE FOR Å SKRIVE         ***
      ***          PURRING AV UFAKTURERTE OPPDRAG              ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER     ***
      *** LEDIGE INDIKATORER 01 02 04-26                       ***
      *** LEDIGE INDIKATORER 28 29 31-98                       ***
      ************************************************************
     FSYPAR2FM  CF   E             WORKSTN
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                UDS
     D  UFIRM                  1      2
     D  UAVDF                 22     25  0
     D  UAVDT                 26     29  0
     D  UDTÅ                  30     31  0
     D  UDTM                  32     33  0
     D  UDTD                  34     35  0
     D  UDT                   30     35  0
     D  UA4                   36     36
      *
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPA4              1
     C                   PARM                    UPIN01            1
     C                   PARM                    UUFAKT            1
     C     UUFAKT        COMP      'J'                                2727
     C                   MOVE      '0'           UPIN01
     C*
     C                   MOVE      *ZEROS        WSDT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C   03              MOVE      '1'           UPIN01
     C   03              GOTO      SLUTT
     C*
     C     WSAVDF        COMP      WSAVDT                             99
     C   99              DO
     C                   SETON                                        30
     C                   MOVE      'SPA0003'     MSGNR
     C                   GOTO      START
     C                   END
     C*
     C                   MOVE      WSAVDF        UAVDF
     C                   MOVE      WSAVDT        UAVDT
     C     WSDT          IFEQ      0
     C                   MOVE      '490101'      UDT
     C                   ELSE
     C                   MOVE      WSDTD         UDTD
     C                   MOVE      WSDTM         UDTM
     C                   MOVE      WSDTÅ         UDTÅ
     C                   END
     C                   MOVE      WSA4          UA4
     C                   MOVE      WSA4          UPA4
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C*
     C                   ENDSR
     C*
