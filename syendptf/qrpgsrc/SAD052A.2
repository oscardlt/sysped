********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10024 * 02 YBC PTF10 FORHOLD BRUTTO/NETTO VEKT
10XXX * 03 YBC PTF10 IKKE TIL NY LINJE VED LINJE FINNES OG LINJESUM=0
10XXX * 04 YBC PTF10 VED ENDRING KAN MAN FJERNE FF-AVGIFT
10262 * 05 YBC PTF10 SATS ER UTVIDERT TIL 7.2
10XXX * 06 YBC PTF10 BEVARE SISTE REGISTRERTE FYLKEKODE
10318 * 07 YBC PTF10 VEKT ER ENDRET FRA 5.0 TIL 12.3
      *              VAREBESKRIVELSE ER ØKT FRA 15A TIL 30A
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 08 YBC PTF11 AVSENDERS KUNDENR ER SEKNK
11013 * 09 CB  PTF11 URSPRUNGSLAND TIL INTERNT BRUK VED FYLKESKODE=91
11016 * 10 YBC PTF11 OMBEREGNING
11XXX * 11 YBC PTF11 IKKE HENT VAREBESKRIVELSE FRA SOKTARI
11XXX * 12 YBC PTF11 GODTA TIDLIGST TARIFF NÅR OPPRINNELIG TARIFF ER SLETTET
      *              VED OMBEREGNING
11XXX * 13 YBC PTF11 SISTE 5 TEGN I SLTXT ER BRUKT TIL ANNET ENN TEKST
11XXX * 14 SH  PTF11 VISER TOTAL STATISTISK VERDI
11XXX * 15 SH  PTF11 DEFAULTVERDI FISKEEKSPORTØR
11XXX * 16 YBC PTF11 OMREGN BELØP FRA ZADV VED FLERE VALUTA
11XXX * 17 SH  PTF11 AVSENDERS KUNDENR ER SEKNK også ved lev vareregister
11XXX *        PTF11 + test z-fil av workvariable som ikke var fyllt opp
11XXX * 18 YBC PTF11 LENGDE PÅ BRUDD-NØKKEL ER UTVIDET TIL 21 LANG (ENDRING 7)
11132 * 19 YBC PTF11 3 DESIMALER PÅ KALKULATOR
11138 * 20 YBC PTF11 VIS STATUS PÅ FEILMELDING FRA TVINN. IND. 52
11XXX * 21 YBC PTF11 RETTELSE PÅ ENDRING 14
11176 * 22 YBC PTF11 TILLEGGSLINJER MED SAMME POST
11186 * 23 YBC PTF11 VIS TOTAL VEKT OG SUM AV LINJEVEKT
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12XXX * 24 YBC PTF12 OPPDATER SKJERMBILDE ETTER ENDRING
12XXX * 25 YBC PTF12 HENT INFO. FRA SAEH ETTER LEST ZAEH
12XXX * 26 YBC PTF12 ind 38 for tilleggs linje trengs ikke
12XXX * 27 YBC PTF12 Beregn vekt etter faktor fra første side
12064 * 28 YBC PTF12 FLERE BELØP ER ENDRET FOR Å TA STØRRE VERDI
XXXXX * 29 SH  PTF12 OPPDATERE SADL
12081 * 30 YBC PTF12 IKKE FYSISK SLETT NYE LINJER FRA TIDLIGERE OMB.
12XXX * 31 YBC PTF12 F21 -> fjern feil merking
12XXX * 32 YBC PTF12 F12 tilbake fra SAD052U
12XXX * 33 YBC PTF12 Feilretting ved test på landkode
12112 * 34 YBC PTF12 Sjekk om negativ verdi etter kalkulator, evt. endre til positiv
12XXX * 35 YBC PTF12 Test om TARI skal oppdateres
12185 * 36 YBC PTF12 Containernr med enhetskode = 'CONT'
12186 * 37 YBC PTF12 IND. 83 ER BRUKT FOR TEST PÅ CONTAINERNR
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL REGISTRERE TOLLDEKLARASJON (EKSPORT)      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER       ***
      *** LEDIGE INDIKATORER 01 02 16 18-20 23 24
      *** LEDIGE INDIKATORER 45-59 62-82
      ***        INDIKATORER 61 BRUKES FOR DUPKEY
      ***        INDIKATOR   28 PÅ = (DEKL.2=0,20,80) UTGÅR 04.2000!!!
      ***        INDIKATOR   27, 34 BRUKES FOR TVINN             ***
      ***        INDIKATOR   60 PÅ = SJØ-OPPDRAG                 ***
      ***        IND.  21,22,95 ER TATT I BRUK VED SJØ-OPPDRAG   ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.      ***
      ***   OG DEFINERES I PROGRAM                               ***
      **************************************************************
      *
N15  FSYPARL1   IF   E           K DISK
N02  FSAEHTL    IF   E           K DISK
     FSAEF      IF   E           K DISK
s29  F*ADL      IF A E           K DISK
N29  FSADL      UF A E           K DISK
     FSAEV      UF A E           K DISK
     FSAEV2     IF   E           K DISK    RENAME(SAEVR:SAEV2R)
     FSAEV4     IF   E           K DISK    RENAME(SAEVR:SAEV4R)
     FSAEV5     UF   E           K DISK    RENAME(SAEVR:SAEV5R)
     FKODTSA    IF   E           K DISK
     FKODTSC    IF   E           K DISK
     FKODTSE    IF   E           K DISK
     FKODTS2    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FTARI      UF   E           K DISK
S11  F*SOKTARI2  IF   E           K DISK
     FPONRN     IF   E           K DISK
     FSAEH      IF   E           K DISK
     FSADAVGE   IF   E           K DISK
     FHEADF     IF   E           K DISK
     FZAEVL01   UF   E           K DISK    RENAME(SAEVR:ZAEVR)
     FZAEVL02   UF   E           K DISK    RENAME(SAEVR:ZAEVR02)
     FZAEV      UF   E           K DISK    RENAME(SAEVR:ZAEVR00)
     FZAEHL02   IF   E           K DISK    RENAME(SAEHR:ZAEHR)
     FSAD052FA  CF   E             WORKSTN USROPN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     SFILE(SUBFIL2:ZRECN2)
     F                                     INFDS(FBAREA)
S18  D*BR              S             17    DIM(200)
N18  D BR              S             21    DIM(200)
     D LI              S              5  0 DIM(200)
N37  D XAN07           S              7
     D*
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  W2EH01                 1      4
     D  Y2EH01                 1      2
     D                 DS
     D  KO                     1      3
     D                                     DIM(3)
     D  TAORDK                 1      1
     D  TAEFTK                 2      2
     D  TAEFK                  3      3
     D                 DS
S05  D* TS                     1     15  2
S05  D*                                    DIM(3)
S05  D* TAORDB                 1      5  2
S05  D* TAEFTB                 6     10  2
S05  D* TAEFB                 11     15  2
N05  D  TS                     1     21  2 DIM(3)
N05  D  TAORDB                 1      7  2
N05  D  TAEFTB                 8     14  2
N05  D  TAEFB                 15     21  2
S07  D*                DS
S07  D* SVVT                   1     15
S07  D* SVVT2                  1     10
     D                 DS
     D  SVTOPL                 1     45
     D  SVTOA                  1     22
     D  SVTOB                 23     45
     D                 DS
     D  SVVNT                  1      8  0
     D  SVFYL                  9     10
     D  SVAVT                 11     11
     D  SVAVTS                12     14
S07  D* SVAVTP                15     17P 3
S07  D* SVBRUD                 1     17
N07  D  SVAVTP                15     21  3
N07  D  SVBRUD                 1     21
     D                 DS
     D  W2VNT                  1      8  0
     D  W2VNT4                 1      4  0
     D  W2FYL                  9     10
     D  W2AVT                 11     11
     D  W2AVTS                12     14
S07  D* W2AVTP                15     17P 3
S07  D* W2BRUD                 1     17
N07  D  W2AVTP                15     21  3
N07  D  W2BRUD                 1     21
S07  D*                DS
S07  D* XVNTM9                 1      9  0
S07  D* XVNTM7                 3      9  0
     D                 DS
     D  UAVD                   1      4  0
     D  UTDN                   5     11  0
     D  UUR                   12     12
     D  UWS                   13     22
     D  UTVIN                 23     23
S10   *** UIN28 = '1' -> PROSEDYRE = 0, 20, 80 (UTGÅR 04.2000!!)
S10  D* UIN28                 24     24
      *** UIN34 = '1' -> SENDES PÅ TVINN
     D  UIN34                 25     25
      *** UIN36 = '1' -> I SAD400
     D  UIN36                 26     26
     D  UBEL1                 28     40  2
     D  UVKB                  41     49  0
     D  UDP                   50     51  0
     D  UKNK                  52     59  0
     D  UTST                  60     60  0
     D  UPRE                  61     61
     D  UZUNIK                62     70  0
     D  UZREFF                71     87
     D  W2VSUM                88    100  2
     D  W2DIFF               101    113  2
     D  XLI                  114    118  0
     D  UNYZF                119    119
     D  UIN08                120    120
     D  USEDT                121    128  0
N23  D  W2VKB                129    141  3
N23  D  W2VDIF               142    154  3
      * OBS! HUSK INITIERE ALLE FELTER PÅ SAD052
S23  D* UPARM2                 1    128
N23  D  UPARM2                 1    512
     D                 DS
     D  UPARM3                 1    512
     D  UTFLAG                 1      1  0
     D  UTVLI                  2      6  0
     D  UTTOP1                 7     23
S36  D* UTCRE1                52     54
N36  D  UTCRE1                24     26
     D  UF11                  55     55
     D  UF21                  56     56
     D  UTIN37                57     57
     D  UTIN39                58     58
     D  UTIN60                59     59
     D  XXPRE                 60     60
S07  D* UTFULLMOD             61    140
S36  D* UTFULLMOD             61    212
N36  D  UTFULLMOD             61    240
N36  D  UTFT01               241    268
N36  D  UTEH01               437    440
N36  D  UTFULLMOD2           273    464
     D                UDS
     D  UVNT                 101    108
     D  UFYL                 109    110
     D  UAVT                 111    111
     D  UFT2                 115    131
     D  UEH01                132    135
S07  D* UVT                  136    150
S07  D* UTOPL                151    195
S07  D* UCREF                196    198
S07  D* UIN37                199    199
S07  D* UAVTP                200    204
S07  D* UAVTS                205    207
N07  D  UVT01                136    165
N07  D  UTOP1                166    182
N07  D  UCRE1                211    213
N07  D  UIN37                214    214
N07  D  UAVTP                215    221
N07  D  UAVTS                222    224
     C*
     C                   OPEN      SAD052FA
     C                   MOVE      *ZEROS        *IN
     C                   MOVE      UIN34         *IN34
     C                   MOVE      UIN36         *IN36
     C                   EXSR      INIT
     C   99
     CORN35              DO
     C                   EXSR      LESGML
     C                   GOTO      START5
     C                   END
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C  N31
     CANN32SAEV2K        SETLL     SAEV2
     C   31
     CANN32SAEV4K        SETLL     SAEV4
     C   32SAEV1K        SETLL     SAEV
     C     START1        TAG
     C  N31
     CANN32UAVD          READE     SAEV2                                  94
     C   31
     CANN32UAVD          READE     SAEV4                                  94
     C   32UAVD          READE     SAEV                                   94
     C  N94
     CAN 32              UPDATE    SAEVR
     C  N94UTDN          COMP      SVTDN                              9494
     C  N94
     CAN 32              MOVE      SVLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
S07  C*                  DO        15
N07  C                   DO        18
     C                   ADD       1             ZRECNO
     C     SVVNT         IFNE      0
     C     SVVKTB        ANDEQ     0
     C                   SETON                                        95
     C                   ELSE
     C                   MOVE      SVLI          XLI2              5 0
     C                   SETOFF                                       95
     C                   END
N20  C     SVERR         COMP      ' '                                5252
     C  N32              MOVE      SVLN          WXLN
     C   32              MOVE      SVLI          WXLN
S07  C*                  IF        SVNTM < 0
S07  C*                  EVAL      XVNTM9 = 9999999
S07  C*                  ELSE
S07  C*                  EVAL      XVNTM9 = SVNTM
S07  C*                  END
     C                   WRITE     SUBFIL
     C  N31
     CANN32UAVD          READE     SAEV2                                  94
     C   31
     CANN32UAVD          READE     SAEV4                                  94
     C   32UAVD          READE     SAEV                                   94
     C  N94
     CAN 32              UPDATE    SAEVR
     C  N94UTDN          COMP      SVTDN                              9494
     C  N94
     CAN 32              MOVE      SVLI          W3LI
     C  N94              END
     C                   END
     C     ZRECNO        CABLT     UTRECN        START2
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       989930
     C*
     C*** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START3
     C                   END
     C*
     C     START4        TAG
     C*** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C*** F17 ---> SOM F3 + BEHOLDE EN DEL OPPLYSN. FOR NESTE TOLLDEK.
     C   03
     COR 17              DO
     C                   EXSR      PRINT
     C*** F12 ---> AVBRYTTE F3/F17
     C   12              Z-ADD     4             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** F14 ---> SØK KUNDERS VAREREGISTER
     C   14              DO
     C                   EXSR      SØKVAR
     C  N03
     CANN17              GOTO      START
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** F9  ---> SETTE IND. 39 PÅ/AV FOR Å MERKERE KALKULATOR PÅ/AV
     C*** F10 ---> SETTE IND. 38 PÅ/AV FOR Å LAGE TILLEGGSLINJER
     C*** F15 ---> SETTE IND. 37 PÅ/AV FOR Å AUTOKOPIERE TILLEGGSOPPL.
     C   09
S26  C*R 10
     COR 15              DO
     C                   EXSR      SETIND
     C                   GOTO      START3
     C                   END
     C*
     C*** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              GOTO      START
     C*** F6  ---> LAGE NYE DETALJE LINJER
     C   06              GOTO      START5
     C*** F8  ---> VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C   08              GOTO      START7
      *
     C   18              DO
     C                   EXSR      TILUB
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     UTFLAG        CABEQ     1             START3
     C                   GOTO      START
     C                   END
      *
     C   19              DO
     C                   EXSR      REGTV
     C   12              GOTO      START3
     C                   GOTO      START
     C                   END
N31   * F21 = Fjern alle feil merking
N31  C                   IF        *IN21
N31  C     SAEHK         SETLL     SAEV
N31  C     SAEHK         READE     SAEV                                   33
N31  C                   DOW       *IN33 = *OFF
N31  C                   EVAL      SVERR = ' '
N31  C                   UPDATE    SAEVR
N31  C     SAEHK         READE     SAEV                                   33
N31  C                   ENDDO
N31  C                   GOTO      START
N31  C                   ENDIF
N10   *
N10  C   22              IF        UTDN < 0
N10  C     *LIKE         DEFINE    SVAVD         UAVDOMS
N10  C     *LIKE         DEFINE    SVTDN         UTDNOMS
N10  C                   MOVE      UAVD          UAVDOMS
N10  C                   MOVE      UTDN          UTDNOMS
N10  C                   MOVE      USG           USGOMS            3
N10  C                   MOVE      'OMS'         UTYPEOMS          3
N10  C                   CALL      'SAD054'
N10  C                   PARM                    UAVDOMS
N10  C                   PARM                    UTDNOMS
N10  C                   PARM                    USGOMS
N10  C                   PARM                    UTYPEOMS
N10  C                   GOTO      START
N10  C                   END
     C*
     C*** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94
     CAN 32SAEV1K        SETLL     SAEV
     C  N94
     CAN 32UAVD          READE     SAEV                                   94
     C  N94
     CAN 32              UPDATE    SAEVR
     C  N94
     CAN 32UTDN          COMP      SVTDN                              9494
     C                   GOTO      START2
     C                   END
     C*
     C*** SJEKKE OM BRUKER HAR VALGT OPSJONER. HIVS SÅ,T UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENTSR
     C     UTFLAG        CABEQ     9             START
N32  C     UTFLAG        CABEQ     1             START3
     C*** OPSJON 9 ---> LAGE TILLEGGSLINJER
     C  N98WSNR          IFEQ      '9'
     C                   MOVE      ' '           WSNR
     C                   UPDATE    SUBFIL
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   END
     C*** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
     C***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C*** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
     C***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
     C*
     C*** LAGE NYE DETALJE LINJER
     C     START5        TAG
N10  C                   SELECT
N10  C                   WHEN      WSNR = '9'
N10  C                   EVAL      XSVNYL = SVNYL
N10  C                   WHEN      UTDN < 0
N10  C                   EVAL      XSVNYL = 'J'
N10  C                   OTHER
N10  C                   EVAL      XSVNYL = ' '
N10  C                   ENDSL
N10  C                   IF        UTDN > 0
N10  C                   EVAL      *IN28 = *OFF
N10  C                   ELSE
N10  C     XSVNYL        COMP      'J'                                2828
N10  C                   END
S07  C* N38              Z-ADD     20            LINNBR
S07  C*  38              Z-ADD     21            LINNBR
S26  C* N38              Z-ADD     23            LINNBR
S26  C*  38              Z-ADD     24            LINNBR
N26  C                   Z-ADD     23            LINNBR
S26  C* N38
S26  C*NN39W2FYL         IFEQ      *BLANKS
N26  C  N39W2FYL         IFEQ      *BLANKS
     C                   Z-ADD     2             POSNBR
     C                   ELSE
     C                   Z-ADD     5             POSNBR
     C                   END
S26  C*  38              Z-ADD     6             POSNBR
     C   39              Z-ADD     14            POSNBR
     C                   EXSR      MOVB2
     C*
     C     START6        TAG
     C                   EXFMT     VARELI
S37  C*                  MOVEA     '0000000'     *IN(84)
N37  C                   MOVEA     '00000000'    *IN(83)
N33  C                   MOVE      '0'           *IN96
     C                   SETOFF                                       30
     C   11              MOVE      'J'           XF11
     C  N11              MOVE      'N'           XF11
     C   21              MOVE      'J'           XF21
     C  N21              MOVE      'N'           XF21
     C*
     C*** F14 ---> SØKE KUNDERS VAREREGISTER
     C   14              DO
     C                   EXSR      SØKVAR
     C                   MOVE      W3LIGM        W3LI
     C*** IKKE F3/F17 ---> BRUKER HAR IKKE BETT UTSKRIFT. VISE 1. SIDE
     C  N03
     CANN17              GOTO      START
     C                   GOTO      SLUTT
     C                   END
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START6
     C                   END
     C*
     C*** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C*** F17 ---> SOM F3 + BEHOLDE EN DEL OPPLYSN. FOR NESTE TOLLDEK.
     C   03
     COR 17              GOTO      START4
     C*
     C*** F9  ---> SETTE IND. 39 PÅ/AV FOR Å MERKERE KALKULATOR PÅ/AV
S26  C*** F10 ---> SETTE IND. 38 PÅ/AV FOR Å LAGE TILLEGGSLINJER
     C*** F15 ---> SETTE IND. 37 PÅ/AV FOR Å AUTOKOPIERE TILLEGGSOPPL.
     C   09
S26  C*R 10
     COR 15              DO
     C                   EXSR      SETIND
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C                   GOTO      START5
     C                   END
     C*
     C*** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START6
     C                   END
      *
     C   18              DO
     C                   EXSR      TILUB
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C     UTFLAG        CABEQ     1             START3
     C                   GOTO      START
     C                   END
     C*
     C*** F12 --> AVBRYTTE REGISTRERING AV NYE DETALJE LINJER.
     C*** SJEKK OM MAN HAR TASTET <DUP>-TAST
     C  N12              EXSR      SRDUP
     C*
     C  N12              DO
     C*** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
     C*** FEILMELDING.
     C                   EXSR      TESTB1
     C   30              GOTO      START6
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C*** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDSAE
     C   35              DO
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C*
     C*** VELGE SORTERINGSMÅTE OG START POST FOR SUBFIL
     C*** 31 PÅ    ---> SORTERE PÅ TARIFFNR. + LANDKODE     (SAEV2)
     C*** 32 PÅ    ---> SORTERE PÅ REGISTRERINGS REKKEFØLGE (SAEV)
     C*** 31,32 AV ---> SORTERE PÅ UTSKRIFTS REKKEFØLGE     (SAEV4)
     C     START7        TAG
     C                   MOVE      *ZEROS        W3VNT
     C                   EXFMT     VAREL2
     C   12              GOTO      START3
     C     W3LI          COMP      0                                  3232
     C  N32              DO
     C     W3VNT         COMP      0                                      31
     C                   END
     C   32              SETOFF                                       31
     C                   MOVE      W3LI          W3LIGM            5 0
     C                   MOVE      *ZEROS        UTRECN
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   EXSR      FLYDU2
     C                   CLOSE     SAD052FA
     C*                    SETON                     LR
     C                   RETURN
     C*
     C***********************************************
     C     SETIND        BEGSR
     C***********************************************
     C*** 09 = KALKULATOR PÅ/AV. BEHOLD FELLESOPPLYSNIGER PÅ LINJE
     C***      TOLLVERDI, BRUTTO- OG NETTO-VEKT SKAL REGISTRERES
     C*        BENYTT INDIKATOR 39   39 PÅ -> KALKULATOR PÅ
     C   09
     CAN 39              DO
     C                   SETOFF                                       39
     C                   GOTO      SLSETI
     C                   END
     C   09
     CANN39              DO
     C                   SETON                                        39
S26  C*                  SETOFF                                       38
     C                   GOTO      SLSETI
     C                   END
     C*
     C*** F15 ---> AUTO KOPIERING AV TILLEGGS OPPLYSNIGER
     C*            BENYTT INDIKATOR 37   37 PÅ -> AUTO KOPIERING
     C   15
     CAN 37              DO
     C                   SETOFF                                       37
     C                   GOTO      SLSETI
     C                   END
     C   15
     CANN37              DO
     C                   SETON                                        37
     C                   GOTO      SLSETI
     C                   END
     C*
     C     SLSETI        ENDSR
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C*
     C*** 37 PÅ(AUTODUP)
     C   37W2TOP1        IFEQ      *BLANKS
     C                   MOVE      YTOP1         W2TOP1
     C                   MOVE      YCRE1         W2CRE1
     C                   END
     C*
     C*** XSTK = 'J' ---> KREVE Å GI MENGDE.
     C                   MOVE      ' '           XSTK              1
     C*** TESTE OM INNTASTET TARIFFNR. ER RIKTIG.
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   89
N12  C                   MOVE      'N'           XTARIFFOK         1
N12  C  N89              IF        UTDN < 0
N12  C                   MOVE      'J'           XTARIFFOK
N12  C                   END
     C     *IN89         DOWEQ     '0'
     C     TADATO        IFLE      USEDT
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      USEDT
N01  C     TADTS         ANDGE     USEDT
     C                   LEAVE
     C                   ELSE
     C                   UPDATE    TARIR
     C                   END
     C     TARIK         READPE    TARI                                   89
     C  N89              ENDDO
N35  C  N89              MOVE      'J'           XOPDTARI
N35  C   89              MOVE      'N'           XOPDTARI          1
N12  C   89              IF        UTDN < 0 AND XTARIFFOK = 'J'
N12  C                   EVAL      *IN89 = *OFF
N12  C                   END
     C  N89
     CAN 13W2VT01        IFNE      *BLANKS
S07  C*                  MOVE      W2VT          TAALFA
N07  C                   EVAL      TAALFA = W2VT01
     C                   END
N35  C  N89              IF        XOPDTARI = 'J'
     C  N89              UPDATE    TARIR
N35  C                   END
     C  N89W2AVT         IFEQ      ' '
     C     W2VNT         SETLL     SADAVGE
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         DOWEQ     '0'
     C     AGDTF         IFLE      USEDT
     C     AGDTT         ANDGT     USEDT
     C                   LEAVE
     C                   END
     C     W2VNT         READE     SADAVGE                                33
     C  N33              ENDDO
     C  N33              MOVE      'X'           W2AVT
     C                   END
     C  N89              MOVE      TASTK         XSTK
     C   89              DO
     C                   SETON                                        30
S07  C*                  Z-ADD     20            LINNBR
N07  C                   Z-ADD     23            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   MOVE      'SPT0033'     MSGNR
     C                   END
     C*
     C*** TEST OPPRINNELSESFYLKE (/LAND HVIS UTENLANSKE TRANSIT VARER)
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C     UIN08         IFEQ      '0'
     C     W2FYL         ORNE      *BLANKS
     C     W2FYL         CHAIN     KODTSE                             90
     C   90
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'YBC0120'     MSGNR
     C                   END
     C                   END
     C                   ELSE
     C     KODS2K        CHAIN     KODTS2                             90
     C   90
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     2             POSNBR
     C                   MOVE      'JOV1017'     MSGNR
     C                   END
     C                   END
     C*
     C     STTB1         TAG
     C*** TEST VEKT
     C  N11
S26  C*NN21
S26  C*NN38W2VKTB        IFLE      0
N26  CANN21W2VKTB        IFLE      0
     C     W2VKTN        IFLE      0
     C                   SETON                                        88
     C                   ELSE
S27  C*    W2VKTN        MULT(H)   1.1           W2VKTB
N27  C     W2VKTN        DIV(H)    SEFVK         W2VKTB
     C                   END
     C                   ELSE
     C     W2VKTN        IFEQ      0
S02  C*    W2VKTB        MULT(H)   0.9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C     W2VKTB        IFLT      W2VKTN
     C                   SETON                                        88
     C                   END
     C                   END
     C*
     C   11
S26  C*R 21
S26  C*R 38              SETOFF                                       88
N26  COR 21              SETOFF                                       88
     C   88
     CANN30              DO
     C                   SETON                                        30
S07  C*                  Z-ADD     20            LINNBR
N07  C                   Z-ADD     23            LINNBR
E28  C                   Z-ADD     30            POSNBR
     C     W2VKTB        IFLT      W2VKTN
     C                   MOVE      'JOV1095'     MSGNR
     C                   ELSE
     C                   MOVE      'SPV0016'     MSGNR
     C                   END
     C                   END
     C*
S26  C*  38              GOTO      SLTB1
     C*
     C*** F11/21-> BEREGNE VEKT ETTER ANDEL AV BRUTTO VEKT. ANDELNØKKEL
     C***          ER TOLLVERDI/FAKTURASUM.
     C     XF11          IFEQ      'J'
     C     XF21          OREQ      'J'
     C     W2BELT        IFEQ      0
     C     UBEL1         OREQ      0
     C  N30              DO
     C                   SETON                                        3088
S07  C*                  Z-ADD     20            LINNBR
N07  C                   Z-ADD     23            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      'SPV0017'     MSGNR
     C                   END
     C                   ELSE
     C     W2BELT        DIV(H)    UBEL1         XWORK            16 5
     C     XWORK         MULT(H)   UVKB          W2VKTB                 3333
     C   33              Z-ADD     1             W2VKTB
S02  C*    W2VKTB        MULT(H)   0.9           W2VKTN
N02  C     W2VKTB        MULT(H)   SEFVK         W2VKTN
     C                   END
     C                   END
     C*
     C  N88
     CANN30W2VKTB        IFLE      0
     C                   SETON                                        8830
S03  C*                  Z-ADD     20            LINNBR
N03  C                   Z-ADD     23            LINNBR
E28  C                   Z-ADD     30            POSNBR
     C                   MOVE      'SPV0016'     MSGNR
     C                   END
     C*
     C     XSTK          IFEQ      'J'
     C     W2NTM         ANDEQ     0
     C                   SETON                                        87
     C  N30              DO
     C                   SETON                                        30
S03  C*                  Z-ADD     20            LINNBR
S03  C*                  Z-ADD     50            POSNBR
N03  C                   Z-ADD     23            LINNBR
E28  C                   Z-ADD     60            POSNBR
     C                   MOVE      'SPN0016'     MSGNR
     C                   END
     C                   END
N33   * Test opprinnelseslandkode hvis Fylkeskoden IKKE er 91
N33  C  N30W2FYL         IFNE      '91'
N33  C     W2LK          ANDNE     *BLANKS
N33  C                   EVAL      *IN30=*ON
N33  C                   EVAL      *IN96=*ON
N33  C                   EVAL      LINNBR=23
N33  C                   EVAL      POSNBR=89
N33  C                   EVAL      MSGNR='CBA0390'
N33  C                   ENDIF
N33   * Test Landkode
N33  C  N30W2LK          IFNE      *BLANKS
N33  C     KODS2K2       CHAIN     KODTS2                             96
N33  C                   IF        *IN96
N33  C                   EVAL      *IN30=*ON
N33  C                   EVAL      LINNBR=23
N33  C                   EVAL      POSNBR=89
N33  C                   EVAL      MSGNR='CBA0400'
N33  C                   ENDIF
N33  C                   ENDIF
     C*
     C*** TEST ENHETSKODE
     C   34W2EH01        IFNE      *BLANKS
N36  C     W2EH01        ANDNE     'CONT'
N36  C     W2EH01        ANDNE     'C.'
     C     W2EH01        ANDNE     'U.NR'
     C     W2EH01        ANDNE     'U-NR'
N36  C     W2EH01        ANDNE     'U.'
N36  C     W2EH01        ANDNE     'U-'
     C     Y2EH01        CHAIN     KODTSA                             84
     C  N30
     CAN 84              DO
     C                   SETON                                        30
     C                   MOVE      'SPE0002'     MSGNR
S07  C*                  Z-ADD     21            LINNBR
S07  C*                  Z-ADD     31            POSNBR
E07  C                   Z-ADD     24            LINNBR
N07  C                   Z-ADD     42            POSNBR
     C                   END
     C                   END
N37   *
N37  C                   IF        W2EH01 = 'CONT' OR W2EH01 = 'C.'
N37  C                   EXSR      SRTSTCONT
N37  C                   IF        *IN83
N37  C                   Z-ADD     24            LINNBR
N37  C                   Z-ADD     6             POSNBR
N37  C                   MOVE      *ON           *IN30
N37  C                   GOTO      SLTB1
N37  C                   END
N37  C                   END
     C*
     C*** TEST KODE FOR DOK./SERTIFIKAT
     C   34W2CRE1        IFNE      *BLANKS
     C     W2CRE1        CHAIN     KODTSC                             85
     C  N30
     CAN 85              DO
     C                   SETON                                        30
     C                   MOVE      'SPC0006'     MSGNR
S07  C*                  Z-ADD     22            LINNBR
S07  C*                  Z-ADD     52            POSNBR
N07  C                   Z-ADD     25            LINNBR
N07  C                   Z-ADD     57            POSNBR
     C                   END
     C                   END
     C*
     C   34
S26  C*NN38
     CANN30W2TOP1        IFNE      *BLANKS
     C     W2CRE1        ANDEQ     *BLANKS
     C                   SETON                                        3085
     C                   MOVE      'SPC0004'     MSGNR
S07  C*                  Z-ADD     22            LINNBR
S07  C*                  Z-ADD     52            POSNBR
N07  C                   Z-ADD     25            LINNBR
N07  C                   Z-ADD     57            POSNBR
     C                   END
N09   * Test opprinnelseslandkode hvis Fylkeskoden=91
N09  C*    W2FYL         IFEQ      '91'
N09  C*    W2LK          ANDEQ     *BLANKS
N09  C*                  EVAL      *IN30=*ON
N09  C*                  EVAL      *IN96=*ON
N09  C*                  EVAL      LINNBR=25
N09  C*                  EVAL      POSNBR=70
N09  C*                  EVAL      MSGNR='CBA0380'
N09  C*                  ENDIF
S33   * Test opprinnelseslandkode hvis Fylkeskoden IKKE er 91
S33  C*                  EVAL      *IN96=*OFF
S33  C*    W2FYL         IFNE      '91'
S33  C*    W2LK          ANDNE     *BLANKS
S33  C*                  EVAL      *IN30=*ON
S33  C*                  EVAL      *IN96=*ON
S33  C*                  EVAL      LINNBR=25
S33  C*                  EVAL      POSNBR=70
S33  C*                  EVAL      MSGNR='CBA0390'
S33  C*                  ENDIF
S33   * Test Landkode
S33  C*    W2LK          IFNE      *BLANKS
S33  C*    KODS2K2       CHAIN     KODTS2                             96
S33  C*                  IF        *IN96
S33  C*                  EVAL      *IN30=*ON
S33  C*                  EVAL      LINNBR=25
S33  C*                  EVAL      POSNBR=70
S33  C*                  EVAL      MSGNR='CBA0400'
S33  C*                  ENDIF
S33  C*                  ENDIF
      *
     C  N30              IF        ((SEFTG2 = '-') OR (SEFTG2 = 'M'))
     C     XFAKT         MULT(H)   W2VKTB        XBLJUS           15 5
     C     W2BELT        MULT(H)   SEVKU         XBLSTB           15 5
     C                   DIV(H)    KVAOMR        XBLSTB
     C                   IF        XBLSTB < XBLJUS
     C                   SETON                                        3088
S07  C*                  Z-ADD     20            LINNBR
N07  C                   Z-ADD     23            LINNBR
     C                   Z-ADD     14            POSNBR
     C                   MOVE      'YBC1939'     MSGNR
     C                   END
     C                   END
      *
     C  N30W2AVT         IFEQ      'X'                                          1<-B
     C     W2AVTP        IFEQ      0                                             2<-B
     C     W2AVTS        OREQ      *BLANKS
     C                   MOVE      *BLANKS       XAGSKV            3
     C                   MOVE      *ZEROS        XAGSAT            5 3
     C     XXPRE         IFEQ      'B'                                            3<-B
     C                   MOVE      'B'           XXPRE2            1
     C                   ELSE                                                     3
     C                   MOVE      ' '           XXPRE2
     C                   END                                                      3<-E
     C     W2VNT         SETLL     SADAVGE
     C     LESSAT        TAG
     C     W2VNT         READE     SADAVGE                                33
     C     *IN33         IFEQ      '0'                                            3<-B
     C     AGDTF         IFGT      USEDT                                           4<-B
     C     AGDTT         ORLE      USEDT
     C                   GOTO      LESSAT
     C                   END                                                       4<-E
     C     AGAKTK        IFNE      'I'                                             4<-B
     C     AGKD          ANDEQ     XXPRE2
     C     XAGSAT        IFEQ      0                                                5<-B
     C                   MOVE      AGSKV         XAGSKV
     C                   MOVE      AGSATS        XAGSAT
     C                   ELSE                                                       5
     C                   MOVE      *BLANKS       XAGSKV
     C                   MOVE      *ZEROS        XAGSAT
     C                   CALL      'SAD052D'
     C     W2VNT         PARM      W2VNT         UVNTS             8 0
     C                   PARM                    XAGSKV
     C                   PARM                    XAGSAT
     C                   PARM                    XXPRE2
     C                   PARM      USEDT         USEDT2            8 0
     C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   GOTO      LESSAT
     C                   END                                                      3<-E
     C     XAGSAT        IFNE      0                                              3<-B
     C                   MOVE      XAGSAT        W2AVTP
     C                   MOVE      XAGSKV        W2AVTS
     C                   ELSE                                                     3
     C     XXPRE2        IFEQ      'B'                                             4<-B
     C                   MOVE      ' '           XXPRE2
     C     W2VNT         SETLL     SADAVGE
     C                   GOTO      LESSAT
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C     SLTB1         ENDSR
     C*
     C***********************************************
     C     HENTSR        BEGSR
     C***********************************************
     C*** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
     C*** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
     C*** OPSJON 2 ---> ENDRE DETALJE LINJE.
     C*** OPSJON 4 ---> SLETTE DETALJE LINJE.
     C*** OPSJON 5 ---> VISE DETALJE LINJE
     C*** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C                   MOVE      *ZEROS        UTFLAG
     C                   MOVE      *ZEROS        UTRECN
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
S07  C*    ZRECNO        DIV       15            LINNBR
N07  C     ZRECNO        DIV       18            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
S07  C*                  Z-ADD     15            LINNBR
N07  C                   Z-ADD     18            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     WSNR          IFEQ      '4'
     C                   EXSR      DLTSAE
     C                   GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '5'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISSAE
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '2'
N10  C     SVNYL         ANDEQ     ' '
N10  C     WSNR          OREQ      '2'
N10  C     SVNYL         ANDEQ     'J'
     C                   SETON                                        99
N20  C     SVERR         COMP      ' '                                5252
     C                   MOVE      *BLANKS       WSNR
S24  C*                  UPDATE    SUBFIL
     C     SVBELT        IFNE      0
     C     SVVKTN        ORNE      0
     C                   EXSR      TILUB
     C     UTFLAG        IFEQ      5
     C                   MOVE      'YBC0656'     MSGNR
     C                   MOVE      '1'           *IN98
     C                   MOVE      '1'           *IN30
N24  C                   UPDATE    SUBFIL
     C                   GOTO      SLHENT
     C                   END
N24  C                   EVAL      W2LI = UTVLI
N24  C     SAEVK         CHAIN(N)  SAEV                               33
N24  C                   UPDATE    SUBFIL
     C                   Z-ADD     ZRECNO        UTRECN            5 0
     C     UTFLAG        CABEQ     9             SLHENT
N32  C     UTFLAG        CABEQ     1             SLHENT
N24  C                   ELSE
N24  C                   UPDATE    SUBFIL
     C                   END
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       3             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISSAE        BEGSR
     C***********************************************
     C     SAEVK2        CHAIN(N)  SAEV                               33
     C                   SETON                                        99
     C                   SETOFF                                       39
     C*** SVVKTB = 0    ->   DENNE VARELINJEN ER TILLEGGSVARELINJE
S26  C*    SVVNT         COMP      0                                  3838
S26  C*  38SVVKTB        COMP      0                                    3838
     C*
     C*                  EXFMT     VAREL3
     C                   EXFMT     BILDE
     C     XLIN          IFEQ      0
S07  C*                  Z-ADD     15            LINNBR
N07  C                   Z-ADD     18            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
N20  C     SVERR         COMP      ' '                                5252
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTSAE        BEGSR
     C***********************************************
     C*** DENNE SUBRUTINEN SKAL UTFØRE FØLGENDE OPERAJONER:
     C***   1. LESE DE LINJENE MED OPSJON 4 OG LEGGE NØKLER PÅ TABELL
     C***      (BR). TABELL (LI) INDIKERER OM DEN ER TILLEGGSLINJE.
     C***      (LI,?? = 0 ---> HOVED LINJE,
     C***       LI,?? > 0 ---> TILLEGGSLINJE LI,?? = LINJENR. PÅ FIL)
     C***   2. LESE DE LINJENE SOM ØNSKER Å SLETTE PÅ SUBFIL2.
     C***   3. VISE DEM PÅ SKJERMEN OG BE OM BEKREFTELSE FRA BRUKER.
     C***      SLETTE DE LINJENE ELLER AVBRYTTE SLETTING VED F12.
     C*
     C                   Z-ADD     ZRECNO        XRECN2            4 0
     C                   MOVE      *BLANKS       BR
     C                   MOVE      *ZEROS        LI
     C*** OPERASJON 1
     C                   MOVE      SVBRUD        BR(1)
     C                   MOVE      SVLI          LI(1)
     C                   Z-ADD     1             XN                3 0
     C     *IN98         DOWEQ     '0'                                          1<-B
     C     STDLT1        TAG
     C                   READC     SUBFIL                                 98
     C  N98WSNR          IFEQ      '4'                                           2<-B
     C                   MOVE      *ZEROS        XN2               3 0
     C     XN2           DOWLT     XN                                             3<-B
     C                   ADD       1             XN2
     C     BR(XN2)       IFEQ      SVBRUD                                          4<-B
     C     LI(XN2)       ANDEQ     0
     C                   GOTO      STDLT1
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   ADD       1             XN
     C                   MOVE      SVBRUD        BR(XN)
     C     SVVNT         IFNE      0                                              3<-B
     C     SVVKTB        ANDEQ     0
     C                   MOVE      SVLI          LI(XN)
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** OPERASJON 2
     C                   MOVE      '1'           *IN43
     C                   WRITE     SUBCTL2
     C                   MOVEA     '00'          *IN(43)
     C                   Z-ADD     *ZEROS        ZRECN2
     C                   MOVE      *ZEROS        XN2
     C     XN2           DOWLT     XN                                           1<-B
     C                   ADD       1             XN2
     C                   MOVE      BR(XN2)       SVBRUD
     C     SAEV21        SETLL     SAEV2
     C                   SETOFF                                       44
     C     STDLT2        TAG
     C     SAEV21        READE     SAEV2                                  44
     C  N44              DO                                                      2<-B
     C     LI(XN2)       IFEQ      SVREFL                                         3<-B
     C     LI(XN2)       OREQ      SVLI
     C                   ADD       1             ZRECN2
     C     SVVNT         IFNE      0                                               4<-B
     C     SVVKTB        ANDEQ     0
     C                   SETON                                        95
     C                   ELSE                                                      4
     C                   MOVE      SVLI          XLI2              5 0
     C                   SETOFF                                       95
     C                   END                                                       4<-E
     C                   WRITE     SUBFIL2
     C                   END                                                      3<-E
     C                   GOTO      STDLT2
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** OPERASJON 3
     C                   Z-ADD     1             ZRECN2
     C     STDLT3        TAG
     C                   MOVEA     '11'          *IN(41)
     C                   WRITE     SUBCTL2
     C                   EXFMT     BUNN2
     C   25              GOTO      STDLT3
     C   12              Z-ADD     XRECN2        ZRECNO
     C  N12              DO                                                     1<-B
     C                   MOVE      *ZEROS        ZRECN2
     C     STDLT4        TAG
     C                   ADD       1             ZRECN2
     C     ZRECN2        CHAIN     SUBFIL2                            98
     C  N98              DO                                                      2<-B
     C     SAEVK2        CHAIN     SAEV                               41
     C  N41              DO                                                       3<-B
     C                   SUB       SVBELT        W2VSUM
N23  C                   SUB       SVVKTB        W2VKB
N10  C                   IF        UTDN < 0 AND SVNYL <> 'J'                       4<-B
N30  C                   IF        SVNYL = 'N' OR SVNYL = 'D'                       5<-B
N30  C                   EVAL      SVNYL = 'D'
N30  C                   ELSE                                                       5
N10  C                   EVAL      SVNYL = 'S'
N30  C                   END                                                        5<-E
N10  C                   UPDATE    SAEVR
N10  C                   ELSE                                                      4
     C                   DELETE    SAEVR
N10  C                   END                                                       4<-E
     C*** SVREFL > 0 ==> DENNE ER EKSTRALINJE OG SENKE ANTALL EXTRA
     C***                LINJER HOVEDLINJE HAR MED EN.
     C     SVREFL        IFGT      0                                               4<-B
     C                   MOVE      SVREFL        W2LI
     C     SAEVK         CHAIN     SAEV                               33
     C  N33              ADD       1             SVREFL
     C  N33              UPDATE    SAEVR
     C                   END                                                       4<-E
     C                   GOTO      STDLT4
     C                   END                                                      3<-E
     C*** VED SLETTING HOVED LINJE TØMME VARIABLER SOM BEHOLDER NØKKEL-
     C*** FOR Å LAGE TILLEGGSLINJER.
     C                   MOVE      *ZEROS        YVNT
     C                   MOVE      *BLANKS       YFYL
     C                   MOVE      ' '           YAVT
     C                   MOVE      *ZEROS        YAVTP
     C                   MOVE      *BLANKS       YAVTS
     C                   MOVE      *ZEROS        YLN
N18  C                   GOTO      STDLT4
     C                   END                                                     2<-E
     C                   EXSR      MOVB1
     C     UBEL1         SUB       W2VSUM        W2DIFF
N23  C     UVKB          SUB       W2VKB         W2VDIF
     C     W2DIFF        COMP      0                                    3535
     C                   END                                                    1<-E
     C                   SETOFF                                       4198
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     NYSAE         BEGSR
     C***********************************************
     C*** BRUKER ØNSKER Å LAGE TILLEGGSLINJE. FLYTTE NØKKEL-DATA FRA
     C*** SUBFIL TIL VARIABLER Å BEHOLDE DEM TIL Å LAGE TILLEGGSLINJER.
     C                   MOVE      SVVNT         YVNT
     C                   MOVE      SVFYL         YFYL
     C                   MOVE      SVAVT         YAVT
     C                   MOVE      SVAVTP        YAVTP
     C                   MOVE      SVAVTS        YAVTS
S26  C*                  SETON                                        38
     C                   SETOFF                                       3940
N02  C                   MOVE      SVLN          YLN
     C     SVREFL        IFLE      0
     C                   MOVE      SVLI          XLI2
     C                   ELSE
     C                   MOVE      SVREFL        XLI2
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDSAE        BEGSR
     C***********************************************
     C                   CLEAR                   SAEVR
     C*** LESE LINJE FRA FIL OG OPPDATERE SUMMEN AV TOLLVERDIER.
     C*** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     SAEVK         CHAIN     SAEV                               33
     C  N33              SUB       SVBELT        W2VSUM
     C                   ADD       W2BELT        W2VSUM
     C     UBEL1         SUB       W2VSUM        W2DIFF
N23  C  N33              SUB       SVVKTB        W2VKB
N23  C                   ADD       W2VKB         W2VKB
N23  C     UVKB          SUB       W2VKB         W2VDIF
     C     W2DIFF        COMP      0                                    3535
     C*** FLYTTE INNTASTET DATA TIL FIL-VARIABLER OG OPPDATERE DEM.
     C                   EXSR      MOVWSV
     C  N33              UPDATE    SAEVR
     C*
     C   33              DO
     C     SVVT01        IFEQ      *BLANKS
     C     SVVNT         IFEQ      11
     C     SVVNT         OREQ      55
     C     ZAEHK         CHAIN     HEADF                              33
S07  C* N33              MOVEL     HEVS1         SVVT
N07  C  N33              EVAL      SVVT01 = HEVS1
     C                   END
     C     SVVT01        IFEQ      *BLANKS
S07  C*                  MOVE      TAALFA        SVVT
S11  C*    SVVNT         CHAIN     SOKTARI2                           34
S11  C* N34              EVAL      SVVT = BESKR1
S11  C*  34              EVAL      SVVT = TAALFA
N11  C   34              EVAL      SVVT01 = TAALFA
     C                   END
     C                   END
S02  C* N38              MOVE      *ZEROS        SVLN
S02  C* N38              MOVE      *ZEROS        YLN
S26  C* N38              MOVE      SVLI          SVLN
S26  C*  38              MOVE      YLN           SVLN
N26  C                   MOVE      SVLI          SVLN
N10  C                   EVAL      SVNYL = XSVNYL
     C                   WRITE     SAEVR
N02  C                   MOVE      SVLN          YLN
     C                   END
     C*
     C*** OPPDATERE PÅ SUBFIL
     C     SVVNT         IFNE      0
     C     SVVKTB        ANDEQ     0
     C                   SETON                                        95
     C                   ELSE
     C                   MOVE      SVLI          XLI2              5 0
     C                   SETOFF                                       95
     C                   END
     C  N32              MOVE      SVLN          WXLN
     C   32              MOVE      SVLI          WXLN
N20  C     SVERR         COMP      ' '                                5252
     C     XGENTV        IFNE      'J'
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSVW        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   SETOFF                                       39
     C*** SVVKTB = 0    ->   DENNE VARELINJEN ER TILLEGGSVARELINJE
S26  C*    SVVKTB        COMP      0                                    3838
S07  C* N38              Z-ADD     20            LINNBR
S07  C*  38              Z-ADD     21            LINNBR
S26  C* N38              Z-ADD     23            LINNBR
S26  C*  38              Z-ADD     24            LINNBR
S26  C* N38
S26  C*NN39              Z-ADD     2             POSNBR
S26  C*  38              Z-ADD     6             POSNBR
N26  C                   Z-ADD     23            LINNBR
N26  C  N39              Z-ADD     2             POSNBR
     C   39              Z-ADD     14            POSNBR
     C                   SETON                                        40
     C*
     C     W2TOP1        IFNE      *BLANKS
     C                   MOVE      W2TOP1        YTOP1
     C                   MOVE      W2CRE1        YCRE1
     C                   END
     C*
     C                   MOVE      SVLN          YLN               5 0
     C                   MOVE      SVLI          W2LI
     C                   MOVE      SVVNT         W2VNT
     C                   MOVE      SVVNT         W2VNTI
     C                   MOVE      SVFYL         W2FYL
     C                   MOVE      SVBELT        W2BELT
     C                   MOVE      SVVKTB        W2VKTB
     C                   MOVE      SVVKTN        W2VKTN
S07  C*                  IF        SVNTM < 0
S07  C*                  EVAL      W2NTM = SVNTM * -100
S07  C*                  ELSE
     C                   EVAL      W2NTM = SVNTM
S07  C*                  END
     C                   MOVE      SVAVT         W2AVT
     C                   MOVE      SVAVTS        W2AVTS
     C                   MOVE      SVAVTP        W2AVTP
     C                   MOVE      SVFT01        W2FT01
     C                   MOVE      SVNT01        W2NT01
     C                   MOVE      SVEH01        W2EH01
     C                   MOVE      SVVT01        W2VT01
     C                   MOVE      SVTOP1        W2TOP1
     C                   MOVE      SVCRE1        W2CRE1
N09  C                   MOVE      SVLK          W2LK
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWSV        BEGSR
     C***********************************************
S26  C*  33
S26  C*N 38              MOVE      SVLI          SVREFL
S26  C*  33
S26  C*NN38              MOVE      *ZEROS        SVREFL
N26  C   33              MOVE      *ZEROS        SVREFL
     C                   MOVE      UAVD          SVAVD
     C                   MOVE      UTDN          SVTDN
     C   21
     COR 22              MOVE      'B'           SV01
     C  N21
     CANN22              MOVE      ' '           SV01
     C                   MOVE      W2LI          SVLI
     C                   MOVE      W2VNT         SVVNT
     C                   MOVE      W2BELT        SVBELT
     C                   MOVE      W2FYL         SVFYL
     C                   MOVE      W2VKTB        SVVKTB
     C                   MOVE      W2VKTN        SVVKTN
S07  C*                  IF        W2NTM > 9999999
S07  C*                  EVAL      SVNTM = W2NTM / 100 * -1
S07  C*                  EVAL      XVNTM9 = 9999999
S07  C*                  ELSE
     C                   MOVE      W2NTM         SVNTM
S07  C*                  MOVE      W2NTM         XVNTM9
S07  C*                  END
     C                   MOVE      W2AVT         SVAVT
     C                   MOVE      W2AVTS        SVAVTS
     C                   MOVE      W2AVTP        SVAVTP
     C                   MOVE      W2FT01        SVFT01
     C                   MOVE      W2NT01        SVNT01
     C                   MOVE      W2EH01        SVEH01
     C                   MOVE      W2VT01        SVVT01
     C                   MOVE      W2TOP1        SVTOP1
     C                   MOVE      W2CRE1        SVCRE1
N09  C                   MOVE      W2LK          SVLK
N20  C                   MOVE      ' '           SVERR
     C*
     C                   MOVE      W2VNT         YVNT              8 0
     C                   MOVE      W2FYL         YFYL              2
N06  C                   IF        FYLKE = *BLANKS
N06  C                   MOVE      W2FYL         FYLKE
N06  C                   END
     C                   MOVE      W2AVT         YAVT              1
S07  C*                  MOVE      W2AVTP        YAVTP             5 3
N07  C                   MOVE      W2AVTP        YAVTP             7 3
     C                   MOVE      W2AVTS        YAVTS             3
S07  C*                  MOVE      W2FT          YFT              17
N07  C                   MOVE      W2FT01        YFT01            28
     C                   MOVE      W2EH01        YEH01             4
S07  C*                  MOVE      W2VT          YVT              15
N07  C                   MOVE      W2VT01        YVT01            30
     C     W2TOP1        IFNE      *BLANKS
     C                   MOVE      W2TOP1        YTOP1            17
     C                   MOVE      W2CRE1        YCRE1             3
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB1         BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       SV01
     C                   MOVE      *ZEROS        SVLI
     C                   MOVE      *ZEROS        SVVNT
     C                   MOVE      *BLANKS       SVFYL
     C                   MOVE      *ZEROS        SVBELT
     C                   MOVE      *ZEROS        SVVKTB
     C                   MOVE      *ZEROS        SVVKTN
     C                   MOVE      *ZEROS        SVNTM
S07  C*                  MOVE      *ZEROS        XVNTM9
     C                   MOVE      *BLANKS       SVAVT
     C                   MOVE      *BLANKS       SVAVTS
     C                   MOVE      *ZEROS        SVAVTP
     C                   MOVE      *BLANKS       SVFT01
     C                   MOVE      *ZEROS        SVNT01
     C                   MOVE      *BLANKS       SVEH01
     C                   MOVE      *BLANKS       SVVT01
     C                   MOVE      *BLANKS       SVTOP1
     C                   MOVE      *BLANKS       SVCRE1
     C                   MOVE      *ZEROS        SVLN
     C                   MOVE      *ZEROS        WXLN
N09  C                   MOVE      *BLANKS       SVLK
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
S26  C*  39
S26  C*R 38              DO
N26  C   39              DO
     C                   MOVE      YVNT          W2VNT
     C                   MOVE      YVNT          W2VNTI
     C                   MOVE      YFYL          W2FYL
     C                   MOVE      YAVT          W2AVT
     C                   MOVE      YAVTP         W2AVTP
     C                   MOVE      YAVTS         W2AVTS
     C                   MOVE      *ZEROS        W2BELT
     C                   END
     C*
S26  C* N39
S26  C*NN38              DO
N26  C  N39              DO
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *BLANKS       W2VNTI
     C                   MOVE      FYLKE         W2FYL
     C                   MOVE      *BLANKS       W2AVT
     C                   MOVE      *ZEROS        W2AVTP
     C                   MOVE      *BLANKS       W2AVTS
     C                   MOVE      W2DIFF        W2BELT
     C                   END
     C*
     C                   MOVE      *ZEROS        W2VKTB
     C                   MOVE      *ZEROS        W2VKTN
     C                   MOVE      *ZEROS        W2NTM
     C                   MOVE      *ZEROS        W2LI
N36  C                   IF        SEKDC = '1'
N36  C                   EVAL      UFT2 = W2FT01
N36  C                   EVAL      W2EH01 = 'CONT'
N36  C                   ELSE
     C                   MOVE      *BLANKS       W2FT01
N36  C                   END
     C                   MOVE      *ZEROS        W2NT01
N36  C                   IF        SEKDC = '1'
N36  C                   EVAL      W2EH01 = 'CONT'
N36  C                   ELSE
     C                   MOVE      *BLANKS       W2EH01
N36  C                   END
     C                   MOVE      *BLANKS       W2VT01
N15  C     SYVRDA        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2TOP1
     C                   MOVE      *BLANKS       W2CRE1
N15  C                   ELSE
N15  C                   MOVEL     SYVRDA        W2TOP1
N15  C                   MOVE      'REF'         W2CRE1
N15  C                   END
N09  C                   MOVE      *BLANKS       W2LK
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FINSUM        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XLI               5 0
     C                   MOVE      *ZEROS        W2LI
     C                   MOVE      *ZEROS        W2VSUM
N23  C                   MOVE      *ZEROS        W2VKB
     C                   MOVE      'N'           XHENTL            1
     C     SAEVK         SETLL     SAEV
     C                   SETOFF                                       33
     C                   SETON                                        99
     C*
     C     STFS          TAG
     C     UAVD          READE(N)  SAEV                                   33
     C  N33UTDN          COMP      SVTDN                              3333
     C  N33              DO
     C                   MOVE      SVLI          XLI
N10  C                   IF        SVNYL <> 'S'
N30  C                             AND SVNYL <> 'D'
     C                   ADD       SVBELT        W2VSUM
N23  C                   ADD       SVVKTB        W2VKB
N10  C                   END
     C                   SETOFF                                       99
     C                   GOTO      STFS
     C                   END
     C*
     C     UBEL1         SUB       W2VSUM        W2DIFF
N23  C     UVKB          SUB       W2VKB         W2VDIF
N03  C                   IF        *IN99 = *OFF AND W2VSUM = 0
N03  C                   EVAL      *IN35 = *ON
N03  C                   ELSE
     C     W2DIFF        COMP      0                                    3535
N03  C                   END
     C     XLI           IFEQ      0
     C     XHENTL        ANDEQ     'N'
     C                   MOVE      'J'           XHENTL
     C                   MOVE      UAVD          UAVD2             4
     C                   MOVE      UTDN          UTDN2             7
     C                   MOVE      USEDT         UDT2              8
     C                   MOVE      UKNK          UKNK2             8
     C                   CALL      'LL071R'
     C                   PARM                    UAVD2
     C                   PARM                    UTDN2
     C                   PARM                    UDT2
     C                   PARM                    UKNK2
     C                   PARM                    UOK               1
     C     UOK           IFEQ      'J'
     C     SAEVK         SETLL     SAEV
     C                   GOTO      STFS
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SRDUP         BEGSR
     C***********************************************
S26  C* N61
S26  C*NN38              DO
N26  C  N61              DO
     C     W2VNTI        IFEQ      '11      '
     C     W2VNTI        OREQ      '55      '
     C                   MOVEL     W2VNTI        XXVNTI            2
     C                   MOVE      '00000000'    W2VNTI
     C                   MOVE      XXVNTI        W2VNTI
     C                   END
     C                   TESTN                   W2VNTI               61
     C   61              MOVE      W2VNTI        W2VNT
     C  N61              MOVE      '99999999'    W2VNT
     C                   SETOFF                                       61
     C                   END
     C*
     C   61              MOVE      YVNT          W2VNT
     C     W2FYL         IFEQ      KDUKOD
     C                   MOVE      YFYL          W2FYL
     C                   END
     C                   MOVEL     W2FT01        XDUPKO            1
     C     XDUPKO        IFEQ      KDUKOD
     C                   MOVE      YFT01         W2FT01
     C                   END
     C                   MOVEL     W2EH01        XDUPKO
     C     XDUPKO        IFEQ      KDUKOD
     C                   MOVE      YEH01         W2EH01
     C                   END
     C                   MOVEL     W2VT01        XDUPKO
     C     XDUPKO        IFEQ      KDUKOD
     C                   MOVE      YVT01         W2VT01
     C                   END
     C                   MOVEL     W2TOP1        XDUPKO
     C     XDUPKO        IFEQ      KDUKOD
     C                   MOVE      YTOP1         W2TOP1
     C                   END
     C                   MOVEL     W2CRE1        XDUPKO
     C     XDUPKO        IFEQ      KDUKOD
     C                   MOVE      YCRE1         W2CRE1
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
N20   * TEST OM ALLE LINJER ER KLARGJORT (INGEN FEIL FRA TVINN ER IKKE GJENNOMGÅTT)
N20  C     ZAEHK         SETLL     SAEV
N20  C     ZAEHK         READE(N)  SAEV                                   33
N20  C                   DOW       *IN33 = *OFF
N20  C                   IF        SVERR <> ' '
N20  C                   LEAVE
N20  C                   END
N20  C     ZAEHK         READE(N)  SAEV                                   33
N20  C                   ENDDO
N20   *
N20  C                   IF        *IN33 = *OFF
N20  C                   EXFMT     VISMELD
N20  C                   EVAL      *IN12 = *ON
N20  C                   ELSE
     C   17              Z-ADD     2             UFLAGG            1 0
     C   03              Z-ADD     3             UFLAGG            1 0
     C                   CALL      'SAD052T'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C*
     C     UFLAGG        COMP      1                                      12
N20  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
S07  C*    LINNBR        IFEQ      20
S07  C*    POSNBR        ANDGE     68
S07  C*    POSNBR        ANDLE     70
N07  C     LINNBR        IFEQ      23
E28  C     POSNBR        ANDGE     83
E28  C     POSNBR        ANDLE     85
     C                   MOVE      'FF'          UAVGKD            2
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    UAVGKD
     C                   PARM                    W2AVTS
     C                   PARM                    UMOD
S07  C*                  Z-ADD     21            LINNBR
N07  C                   Z-ADD     24            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   GOTO      SLSØK
     C                   END
N09   * Søk landkode
S33  C*    LINNBR        IFEQ      25
S33  C*    POSNBR        ANDGE     70
S33  C*    POSNBR        ANDLE     71
N33  C     LINNBR        IFEQ      23
N33  C     POSNBR        ANDGE     89
N33  C     POSNBR        ANDLE     90
N09  C                   CALL      'SYFI10L'
N09  C                   PARM      W2LK          U2LK              2
N09  C                   PARM      'J'           USPED             1
N09  C     U2LK          IFNE      *BLANKS
N09  C                   EVAL      W2LK=U2LK
N09  C                   ENDIF
S33  C*                  Z-ADD     25            LINNBR
S33  C*                  Z-ADD     70            POSNBR
N33  C                   Z-ADD     24            LINNBR
N33  C                   Z-ADD     6             POSNBR
N09  C                   GOTO      SLSØK
N09  C                   ENDIF
      *
     C* KALKULATOR VERDI
S07  C*    LINNBR        IFEQ      20
N07  C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     14
     C     POSNBR        ANDLE     26
S19  C*                  Z-ADD     W2BELT        UNU132           13 2
N19  C                   Z-ADD     W2BELT        UNU133           13 3
     C                   CALL      'SYGE11'
S19  C*                  PARM                    UNU132
N19  C                   PARM                    UNU133
S19  C*                  Z-ADD     UNU132        W2BELT
N34  C                   IF        UNU133 < 0
N34  C                   Z-SUB(H)  UNU133        W2BELT
N34  C                   ELSE
N19  C                   Z-ADD(H)  UNU133        W2BELT
N34  C                   end
E28  C                   Z-ADD     30            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C* KALKULATOR BRUTTOVEKT
S07  C*    LINNBR        IFEQ      20
S07  C*    POSNBR        ANDGE     28
S07  C*    POSNBR        ANDLE     38
N07  C     LINNBR        IFEQ      23
E28  C     POSNBR        ANDGE     30
E28  C     POSNBR        ANDLE     43
S19  C*                  Z-ADD     W2VKTB        UNU132           13 2
N19  C                   Z-ADD     W2VKTB        UNU133           13 3
     C                   CALL      'SYGE11'
S19  C*                  PARM                    UNU132
N19  C                   PARM                    UNU133
S19  C*                  Z-ADD     UNU132        W2VKTB
N34  C                   IF        UNU133 < 0
N34  C                   Z-SUB(H)  UNU133        W2VKTB
N34  C                   ELSE
N19  C                   Z-ADD(H)  UNU133        W2VKTB
N34  C                   END
S07  C*                  Z-ADD     40            POSNBR
E28  C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C* KALKULATOR NETTOVEKT
S07  C*    LINNBR        IFEQ      20
S07  C*    POSNBR        ANDGE     40
S07  C*    POSNBR        ANDLE     48
N07  C     LINNBR        IFEQ      23
E28  C     POSNBR        ANDGE     45
E28  C     POSNBR        ANDLE     58
S19  C*                  Z-ADD     W2VKTN        UNU132           13 2
N19  C                   Z-ADD     W2VKTN        UNU133           13 3
     C                   CALL      'SYGE11'
S19  C*                  PARM                    UNU132
N19  C                   PARM                    UNU133
S19  C*                  Z-ADD     UNU132        W2VKTN
N34  C                   IF        UNU133 < 0
N34  C                   Z-SUB(H)  UNU133        W2VKTN
N34  C                   ELSE
N19  C                   Z-ADD(H)  UNU133        W2VKTN
N34  C                   END
S07  C*                  Z-ADD     50            POSNBR
E28  C                   Z-ADD     60            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C* KALKULATOR ANTALL
S07  C*    LINNBR        IFEQ      20
S07  C*    POSNBR        ANDGE     50
S07  C*    POSNBR        ANDLE     56
N07  C     LINNBR        IFEQ      23
E28  C     POSNBR        ANDGE     60
E28  C     POSNBR        ANDLE     69
S19  C*                  Z-ADD     W2NTM         UNU132           13 2
N19  C                   Z-ADD     W2NTM         UNU133           13 3
     C                   CALL      'SYGE11'
S19  C*                  PARM                    UNU132
N19  C                   PARM                    UNU133
S19  C*                  Z-ADD     UNU132        W2NTM
N34  C                   IF        UNU133 < 0
N34  C                   Z-SUB(H)  UNU133        W2NTM
N34  C                   ELSE
N19  C                   Z-ADD(H)  UNU133        W2NTM
N34  C                   END
S07  C*                  Z-ADD     58            POSNBR
E28  C                   Z-ADD     71            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C* KALKULATOR ANTALL
S07  C*    LINNBR        IFEQ      21
S07  C*    POSNBR        ANDGE     24
S07  C*    POSNBR        ANDLE     29
N07  C     LINNBR        IFEQ      24
N07  C     POSNBR        ANDGE     35
N07  C     POSNBR        ANDLE     40
S19  C*                  Z-ADD     W2NT          UNU132           13 2
N19  C                   Z-ADD     W2NT01        UNU133           13 3
     C                   CALL      'SYGE11'
S19  C*                  PARM                    UNU132
N19  C                   PARM                    UNU133
S19  C*                  Z-ADD     UNU132        W2NT
N34  C                   IF        UNU133 < 0
N34  C                   Z-SUB(H)  UNU133        W2NT01
N34  C                   ELSE
N19  C                   Z-ADD(H)  UNU133        W2NT01
N34  C                   END
S07  C*                  Z-ADD     31            POSNBR
N07  C                   Z-ADD     42            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
S07  C*    LINNBR        IFEQ      21
S07  C*    POSNBR        ANDGE     31
S07  C*    POSNBR        ANDLE     34
N07  C     LINNBR        IFEQ      24
N07  C     POSNBR        ANDGE     42
N07  C     POSNBR        ANDLE     45
     C                   MOVE      *BLANKS       W2EH01
     C                   CALL      'SAD052F'
     C                   PARM                    Y2EH01
S07  C*                  Z-ADD     36            POSNBR
N07  C                   Z-ADD     47            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
S07  C*    LINNBR        IFEQ      22
S07  C*    POSNBR        ANDGE     52
S07  C*    POSNBR        ANDLE     54
N07  C     LINNBR        IFEQ      25
N07  C     POSNBR        ANDGE     57
N07  C     POSNBR        ANDLE     59
     C                   MOVE      'N'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2CRE1
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
     C*
S26  C*  38
S26  C*R 39              GOTO      SLSØK
N26  C   39              GOTO      SLSØK
     C*
S07  C*    LINNBR        IFEQ      20
N07  C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     3
     C     UDP           IFNE      2
     C     UDP           ANDNE     4
     C     UDP           ANDNE     18
     C     UDP           ANDNE     81
     C     UDP           ANDNE     90
     C                   CALL      'SAD052H'
     C                   PARM                    W2FYL
     C                   ELSE
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    W2FYL
     C                   PARM                    USPED
     C                   END
     C                   Z-ADD     5             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
S07  C*    LINNBR        IFEQ      20
N07  C     LINNBR        IFEQ      23
     C     POSNBR        ANDGE     5
     C     POSNBR        ANDLE     12
     C                   CALL      'SAD062A'
     C                   PARM                    W2VNTI
     C     USEDT         PARM      USEDT         USEDT2            8 0
     C                   Z-ADD     14            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     SØKVAR        BEGSR
     C***********************************************
N10  C                   IF        UTDN > 0
     C                   CALL      'SAD052C'
     C     UPARM2        PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C*
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      2                                      17
     C     W2DIFF        COMP      0                                    3535
N10  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FLYDUP        BEGSR
     C***********************************************
     C                   SETOFF                                       33
     C                   TESTN                   UVNT                 33
     C   33              MOVE      UVNT          YVNT
     C  N33              MOVE      *ZEROS        YVNT
     C                   MOVE      UFYL          YFYL
     C                   MOVE      UAVT          YAVT
     C                   SETOFF                                       33
     C                   TESTN                   UAVTP                33
     C   33              MOVE      UAVTP         YAVTP
     C  N33              MOVE      *ZEROS        YAVTP
     C                   MOVE      UFT2          YFT01
     C                   MOVE      UEH01         YEH01
     C                   MOVE      UVT01         YVT01
     C                   MOVE      UTOP1         YTOP1
     C                   MOVE      UCRE1         YCRE1
     C     UIN37         COMP      '1'                                    37
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FLYDU2        BEGSR
     C***********************************************
     C                   MOVE      YVNT          UVNT
     C                   MOVE      YFYL          UFYL
     C                   MOVE      YAVT          UAVT
     C                   MOVE      YAVTP         UAVTP
     C                   MOVE      YAVTS         UAVTS
     C                   MOVE      YFT01         UFT2
     C                   MOVE      YEH01         UEH01
     C                   MOVE      YVT01         UVT01
     C                   MOVE      YTOP1         UTOP1
     C                   MOVE      YCRE1         UCRE1
     C                   MOVE      *IN37         UIN37
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SADLK         KLIST
s17  C*                  KFLD                    SEKNS
n17  C                   KFLD                    SEKNK
     C                   KFLD                    SLALFA
N31  C     SAEHK         KLIST
N31  C                   KFLD                    UAVD
N31  C                   KFLD                    UTDN
     C     SAEVK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W2LI
     C     SAEV1K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LI
     C     SAEVK1        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    XLI2
     C     SAEVK2        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    SVLI
     C     SAEV2K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3VNT
     C     SAEV21        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    SVVNT
     C                   KFLD                    SVFYL
     C                   KFLD                    SVAVT
     C                   KFLD                    SVAVTS
     C                   KFLD                    SVAVTP
     C     SAEV4K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LN
     C     SAEV5K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    XLI2
     C     ZAEHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     ZAEVK         KLIST
     C                   KFLD                    Y01               1
     C                   KFLD                    UZUNIK
     C                   KFLD                    UZREFF
     C     ZAEVKR        KLIST
     C                   KFLD                    UZUNIK
     C                   KFLD                    UZREFF
     C     TARIK         KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C     TARIKM        KLIST
     C                   KFLD                    W2VNT
     C                   KFLD                    X2TAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    W2FYL
N09  C     KODS2K2       KLIST
N09  C                   KFLD                    XS2UNI
N09  C                   KFLD                    W2LK
     C                   MOVE      'S2 '         XS2UNI            3
     C     KODVAK        KLIST
     C                   KFLD                    SEVAL1
     C                   KFLD                    SEDT
     C*
N14  C     KODVAK2       KLIST
N14  C                   KFLD                    SEVAL2
N14  C                   KFLD                    SEDT
     C     *ENTRY        PLIST
S23  C*    UPARM2        PARM      UPARM2        UPARM1          128
N23  C     UPARM2        PARM      UPARM2        UPARM1          512
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      *ZEROS        W2VSUM
     C                   MOVE      *ZEROS        W2DIFF
N23  C                   MOVE      *ZEROS        W2VKB
N23  C                   MOVE      *ZEROS        W2VDIF
     C                   MOVE      *ZEROS        XLI
N02  C     ZAEHK         CHAIN     SAEHTL                             33
N02  C   33              Z-ADD     0.9           SEFVK
      *
     C*** UUR = 'F' -> SJØSPEDISJON
     C     UUR           COMP      'F'                                    60
     C  N60UUR           COMP      'G'                                    60
N10  C     UTDN          COMP      0                                    51      51 PÅ -> OMBEREGNING
     C*
     C                   MOVE      'N'           XF11              1
     C                   MOVE      'N'           XF21              1
     C                   MOVE      *ZEROS        UTRECN
     C                   MOVE      *ZEROS        SVLI
     C                   MOVE      *BLANKS       X2TAR             3
N10  C                   MOVE      *BLANKS       XSVNYL            1
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *ZEROS        SVVNT
     C                   MOVE      *ZEROS        TAORDB
     C                   MOVE      *ZEROS        TAEFTB
     C                   MOVE      *ZEROS        TAEFB
S07  C*                  MOVE      *ZEROS        XVNTM9
     C                   EXSR      FLYDUP
     C*
     C     UPRE          IFEQ      'B'
     C                   MOVE      'B'           XXPRE             1
     C                   ELSE
     C                   MOVE      ' '           XXPRE
     C                   END
     C                   BITON     '345'         KDUKOD            1
     C                   BITOFF    '01267'       KDUKOD
     C                   MOVEA     '000'         *IN(37)
     C     ZAEHK         CHAIN     SAEH                               33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     SEADK3        PONRAL            4
     C     PONRAL        CHAIN     PONRN                              33
     C     *IN33         IFEQ      '0'
     C                   MOVEL     PONKNR        FYLKE             2
     C                   MOVEL     PONKNR        YFYL              2
     C                   MOVEL     PONKNR        UFYL              2
     C                   MOVEL     PONKNR        W2FYL             2
     C                   END
     C                   END
      *
N14  C                   EXSR      BERSV
N15  C     KEYPAR        KLIST
N15  C                   KFLD                    SEKNK
N15  C                   KFLD                    SYPAID
N15  C                   MOVEL     'FISKE'       SYPAID
N15  C     KEYPAR        CHAIN     SYPARL1                            33
     C     KODVAK        SETGT     KODTVAL2
     C     SEVAL1        READPE    KODTVAL2                               33
     C     SEBEL3        DIV(H)    SEVKB         XFAKT            15 5
      *
      *
     C     UZREFF        IFEQ      *BLANKS
     C     ZAEHK         CHAIN     ZAEHL02                            33
     C  N33              MOVE      SEUNIK        UZUNIK
     C  N33              MOVE      SEREFF        UZREFF
N25  C  N33ZAEHK         CHAIN     SAEH                               33
     C                   END
     C     UZUNIK        IFNE      0
     C     UZREFF        ANDNE     *BLANKS
      * UNYZF=J ---> GENERERE VARELINJER UT FRA Z-FIL
      * UNYZF=N ---> GENERERE KUN VARELINJER FOR DE SOM IKKE GENERERT
      *              FORRIGE GANG PGA. BRUDD
     C                   MOVE      UNYZF         XREGTV            1
     C                   EXSR      HZFIL
     C                   ELSE
     C                   EXSR      HZFIL2
     C                   END
      *
     C*
     C                   EXSR      FINSUM
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     LESGML        BEGSR
     C***********************************************
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     0             ZRECNO
     C                   MOVE      W3LIGM        W3LI
     C     SAEV2K        SETLL     SAEV2
     C     UAVD          READE     SAEV2                                  94
     C  N94UTDN          COMP      SVTDN                              9494
     C   94              MOVE      *BLANKS       WSNR
     C  N94              DO
     C                   DO        15
     C                   ADD       1             ZRECNO
     C     SVVNT         IFNE      0
     C     SVVKTB        ANDEQ     0
     C                   SETON                                        95
     C                   ELSE
     C                   MOVE      SVLI          XLI2              5 0
     C                   SETOFF                                       95
     C                   END
     C  N32              MOVE      SVLN          WXLN
S07  C*                  IF        SVNTM < 0
S07  C*                  EVAL      XVNTM9 = 9999999
S07  C*                  ELSE
S07  C*                  EVAL      XVNTM9 = SVNTM
S07  C*                  END
     C                   WRITE     SUBFIL
     C     UAVD          READE     SAEV2                                  94
     C  N94UTDN          COMP      SVTDN                              9494
     C  N94              END
     C                   END
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C*
     C                   ENDSR
     C*
      ******************************************
     C     HZFIL         BEGSR
      ******************************************
     C                   MOVE      *IN19         XIN19             1
     C                   MOVE      'J'           XGENTV            1
     C                   Z-ADD     99999         W2LI
     C     SAEVK         SETGT     SAEV
     C     ZAEHK         READPE    SAEV                                   33
     C   33              MOVE      *ZEROS        XLI
     C  N33              MOVE      SVLI          XLI
      *
     C     XREGTV        IFEQ      'J'
     C     ZAEVKR        SETLL     ZAEVL01
     C     XIN19         IFEQ      '0'
     C     ZAEVKR        READE     ZAEVL01                                33
     C                   ELSE
     C     ZAEVKR        READE(N)  ZAEVL01                                33
     C                   END
     C                   ELSE
     C     ZAEVK         SETLL     ZAEVL02
     C     ZAEVK         READE     ZAEVL02                                33
     C                   END
     C     *IN33         IFEQ      '0'
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '01'          *IN(93)
     C                   EXSR      MOVB2
     C                   WRITE     NYWRK
     C                   END
      *
     C     *IN33         DOWEQ     '0'
N17  C                   EXSR      MOVSVW
     C                   MOVE      ' '           SV01
     C                   MOVE      'N'           XOPDSL            1
     C     W2VNT         IFEQ      0                                              3<-B
     C     W2FT01        ANDNE     *BLANKS
S08  C*    SEKNS         ANDNE     0
N08  C     SEKNK         ANDNE     0
     C                   MOVEL     W2FT01        SLALFA
s29  C*    SADLK         CHAIN     SADL                               34
N29  C     SADLK         CHAIN(N)  SADL                               34
     C     *IN34         IFEQ      '0'                                             4<-B
     C                   MOVE      SLTANR        W2VNT
     C                   MOVE      SLTANR        W2VNTI
     C                   MOVE      *BLANKS       W2FT01
N29  C     SLTANR        CHAIN     TARI                               34
N29  C   34              MOVE      'U'           XOPDSL
     C                   ELSE                                                      4
     C                   MOVE      'J'           XOPDSL
     C                   END                                                       4<-E
     C                   MOVE      '0'           *IN34
     C                   END                                                      3<-E
S17  C*                  EXSR      MOVSVW
     C                   GOTO      STHZF3
     C     STHZF2        TAG
     C                   EXFMT     VARELI
S37  C*                  MOVEA     '0000000'     *IN(84)
N37  C                   MOVEA     '00000000'    *IN(83)
N33  C                   MOVE      '0'           *IN96
     C                   SETOFF                                       30
     C   11              MOVE      'J'           XF11
     C  N11              MOVE      'N'           XF11
     C   21              MOVE      'J'           XF21
     C  N21              MOVE      'N'           XF21
     C   12XREGTV        IFEQ      'J'
     C     XIN19         IFEQ      '0'
     C                   EXCEPT    DUMZAV
     C                   END
     C                   ELSE
     C                   EXCEPT    DUMZA2
     C                   END
     C   12              GOTO      SLHZF
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STHZF2
     C                   END
     C                   EXSR      SRDUP
      *
     C     STHZF3        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      STHZF2
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C                   EXSR      OPDSAE
      *
     C     XOPDSL        IFEQ      'J'
     C     SVFT01        ANDNE     *BLANKS
     C                   CLEAR                   SADLR
S08  C*                  MOVE      SEKNS         SLKNR
N08  C                   MOVE      SEKNK         SLKNR
     C                   MOVEL     SVFT01        SLALFA
     C                   MOVEL     SVVT01        SLTXT
N13  C                   MOVE      '     '       SLTXT
     C                   MOVEL     SVVNT         SLTANR
     C                   WRITE     SADLR
     C                   END
N29  C     XOPDSL        IFEQ      'U'
N29  C     SADLK         CHAIN     SADL                               34
N29  C     *IN34         IFEQ      '0'
N29  C                   MOVEL     SVVNT         SLTANR
N29  C                   UPDATE    sadlr
N29  c                   end
N29  c                   end
      *
     C                   MOVE      'O'           SV01
     C     XREGTV        IFEQ      'J'
     C     XIN19         IFEQ      '0'
     C                   EXCEPT    OPDZAV
     C     ZAEVKR        READE     ZAEVL01                                33
     C                   ELSE
     C     ZAEVKR        READE(N)  ZAEVL01                                33
     C                   END
     C                   ELSE
     C                   EXCEPT    OPDZA2
     C     ZAEVK         READE     ZAEVL02                                33
     C                   END
     C  N33              END
      *
     C     SLHZF         TAG
     C                   MOVE      'N'           XGENTV            1
      *
     C                   ENDSR
      *
      ******************************************
     C     HZFIL2        BEGSR
      ******************************************
     C                   MOVE      'J'           XGENTV            1
     C                   Z-ADD     99999         W2LI
     C     SAEVK         SETGT     SAEV
     C     ZAEHK         READPE    SAEV                                   33
     C   33              MOVE      *ZEROS        XLI
     C  N33              MOVE      SVLI          XLI
      *
     C     ZAEHK         SETLL     SAEF
     C     ZAEHK         READE     SAEF                                   33
     C     *IN33         DOWEQ     '0'                                          1<-B
     C     SFTXT         SETLL     ZAEV
     C     STHZ21        TAG
     C     SFTXT         READE     ZAEV                                   34
     C  N34SVAVD         IFGT      0                                             2<-B
     C                   UPDATE    ZAEVR00
     C                   GOTO      STHZ21
     C                   ELSE                                                    2
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '01'          *IN(93)
     C                   EXSR      MOVB2
     C                   WRITE     NYWRK
     C                   END                                                     2<-E
      *
     C     *IN34         DOWEQ     '0'                                           2<-B
     C                   EXSR      MOVSVW
N16   *
N16  C                   IF        SFVK28 <> SEVAL1
N16   * OMREGN BELØP PG. ULIKE VALUTAKODER
N16  C                   EVAL(H)   W2BELT = W2BELT * SFKR28 / SFOM28
N16  C                   END
N16   *
     C                   MOVE      'N'           XOPDSL            1
     C     W2VNT         IFEQ      0                                              3<-B
     C     W2FT01        ANDNE     *BLANKS
S08  C*    SEKNS         ANDNE     0
N08  C     SEKNK         ANDNE     0
     C                   MOVEL     W2FT01        SLALFA
S29  C*    SADLK         CHAIN     SADL                               34
N29  C     SADLK         CHAIN(N)  SADL                               34
     C     *IN34         IFEQ      '0'                                             4<-B
     C                   MOVE      SLTANR        W2VNT
     C                   MOVE      SLTANR        W2VNTI
     C                   MOVE      *BLANKS       W2FT01
N29  C     SLTANR        CHAIN     TARI                               34
N29  C   34              MOVE      'U'           XOPDSL
     C                   ELSE                                                      4
     C                   MOVE      'J'           XOPDSL
     C                   END                                                       4<-E
     C                   MOVE      '0'           *IN34
     C                   END                                                      3<-E
     C                   GOTO      STHZ23
     C     STHZ22        TAG
     C                   EXFMT     VARELI
S37  C*                  MOVEA     '0000000'     *IN(84)
N37  C                   MOVEA     '00000000'    *IN(83)
N33  C                   MOVE      '0'           *IN96
     C                   SETOFF                                       30
     C   11              MOVE      'J'           XF11
     C  N11              MOVE      'N'           XF11
     C   21              MOVE      'J'           XF21
     C  N21              MOVE      'N'           XF21
     C   12              UPDATE    ZAEVR00
     C   12              GOTO      SLHZ2
     C   04              DO                                                       3<-B
     C                   EXSR      SØKDTA
     C                   GOTO      STHZ22
     C                   END                                                      3<-E
     C                   EXSR      SRDUP
      *
     C     STHZ23        TAG
     C                   EXSR      TESTB1
     C   30              GOTO      STHZ22
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C                   EXSR      OPDSAE
     C                   UPDATE    ZAEVR00
      *
     C     XOPDSL        IFEQ      'J'
     C     SVFT01        ANDNE     *BLANKS
     C                   CLEAR                   SADLR
S08  C*                  MOVE      SEKNS         SLKNR
N08  C                   MOVE      SEKNK         SLKNR
     C                   MOVEL     SVFT01        SLALFA
     C                   MOVEL     SVVT01        SLTXT
N13  C                   MOVE      '     '       SLTXT
     C                   MOVEL     SVVNT         SLTANR
     C                   WRITE     SADLR
     C                   END
N29  C     XOPDSL        IFEQ      'U'
N29  C     SADLK         CHAIN     SADL                               34
N29  C     *IN34         IFEQ      '0'
N29  C                   MOVEL     SVVNT         SLTANR
N29  C                   UPDATE    sadlr
N29  c                   end
N29  c                   end
     C     STHZ24        TAG
     C     SFTXT         READE     ZAEV                                   34
     C  N34SVAVD         IFGT      0                                              3<-B
     C                   UPDATE    ZAEVR00
     C                   GOTO      STHZ24
     C                   END                                                      3<-E
     C  N34              END                                                     2<-E
     C     ZAEHK         READE     SAEF                                   33
     C  N33              END                                                    1<-E
      *
     C     SLHZ2         TAG
     C                   MOVE      'N'           XGENTV            1
      *
     C                   ENDSR
      *
      ******************************************
     C     REGTV         BEGSR
      ******************************************
     C     UZREFF        IFEQ      *BLANKS
     C     UZUNIK        OREQ      0
     C                   MOVE      '1'           *IN12
     C                   GOTO      SLRTV
     C                   END
      *
     C                   EXFMT     BEKREFT
     C   12              GOTO      SLRTV
      *
     C     ZAEHK         SETLL     SAEV
     C     ZAEHK         READE     SAEV                                   33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    SAEVR
     C     ZAEHK         READE     SAEV                                   33
     C                   ENDDO
      *
     C                   MOVE      *ZEROS        W2VSUM
     C                   Z-ADD     UBEL1         W2DIFF
N23  C                   MOVE      *ZEROS        W2VKB
N23  C                   Z-ADD     UBEL1         W2VDIF
     C                   MOVE      'J'           XREGTV            1
     C                   EXSR      HZFIL
      *
     C     SLRTV         ENDSR
      *
      ******************************************
     C     TILUB         BEGSR
      ******************************************
     C                   MOVE      *BLANKS       UPARM3
     C     *IN18         IFEQ      '1'
     C                   MOVE      *ZEROS        UTFLAG
     C                   MOVE      *ZEROS        UTVLI
     C                   ELSE
     C                   Z-ADD     2             UTFLAG
     C                   MOVE      SVLI          UTVLI
     C                   END
     C                   MOVE      YTOP1         UTTOP1
     C                   MOVE      YCRE1         UTCRE1
     C                   MOVE      YFULLMOD      UTFULLMOD
N36  C                   MOVE      YFULLMOD2     UTFULLMOD2
N36  C                   MOVE      YFT01         UTFT01
N36  C                   IF        SEKDC = '1' AND YEH01 = *BLANKS
N36  C                   MOVE      'CONT'        UTEH01
N36  C                   ELSE
N36  C                   MOVE      YEH01         UTEH01
N36  C                   END
     C                   MOVE      XF11          UF11
     C                   MOVE      XF21          UF21
     C                   MOVE      *IN37         UTIN37
     C                   MOVE      *IN39         UTIN39
     C                   MOVE      *IN60         UTIN60
     C                   MOVE      XF21          UF21
      *
     C                   CALL      'SAD052U'
S23  C*    UPARM2        PARM      UPARM2        UPARM           128
N23  C     UPARM2        PARM      UPARM2        UPARM           512
     C     UPARM3        PARM      UPARM3        UPAR31          512
     C                   MOVE      UTTOP1        UTOP1
     C                   MOVE      UTCRE1        UCRE1
S07  C*                  MOVE      UTFULLMOD     YFULLMOD         80
S36  C*                  MOVE      UTFULLMOD     YFULLMOD        152
N36  C                   MOVE      UTFULLMOD     YFULLMOD        180
N36  C                   MOVEL     UTFT01        UFT2
N36  C                   MOVE      UTEH01        UEH01
N36  C                   MOVE      UTFULLMOD2    YFULLMOD2       192
     C                   MOVE      UF11          XF11
     C                   MOVE      UF21          XF21
     C                   MOVE      UTIN37        *IN37
     C                   MOVE      UTIN39        *IN39
      *
     C                   ENDSR
N14   ************************************************************************
N14  C     BERSV         BEGSR
N14   ************************************************************************
N14   *
N14   * FAKTURASUM  XBEL1
N14   *
N14  C     KODVAK        SETGT     KODTVAL2
N14  C     SEVAL1        READPE    KODTVAL2                               33
N14   * HVIS IKKE FINNES, FORSØK PÅ SENERE DATO
N14  C   33KODVAK        SETLL     KODTVAL2
N14  C   33SEVAL1        READE     KODTVAL2                               33
N14   *
N14  C*
N14  C  N33SEBEL1        MULT      SEVKU         XWORK
N14  C  N33XWORK         DIV       KVAOMR        XBEL1            13 2
N14   *
N14   *
N14   * FAKTURASUM  XBEL2
N14   *
N21  C                   IF        SEVAL2 <> *BLANKS
N14  C     SEVAL2        IFEQ      SEVAL1
N14  C     SEBEL2        MULT      SEVKU         XWORK
N14  C     XWORK         DIV       KVAOMR        XBEL2            13 2
N14  C                   ELSE
N14  C     KODVAK2       SETGT     KODTVAL2
N14  C     SEVAL2        READPE    KODTVAL2                               33
N14   * HVIS IKKE FINNES, FORSØK PÅ SENERE DATO
N14  C   33KODVAK2       SETLL     KODTVAL2
N14  C   33SEVAL2        READE     KODTVAL2                               33
N14   *
N14  C  N33SEBEL2        MULT      KVAKRS        XWORK
N14  C  N33XWORK         DIV       KVAOMR        XBEL2            13 2
N14  C                   END
N21  C                   END
N14   *
N14   * STATISTISK VERDI  XBEL3
N14   *
N14   *  MINUS -/M ELLER +/P
N14  C     SEFTG2        IFEQ      '-'
N14  C     SEFTG2        OREQ      'M'
N14  C     XBEL1         SUB       XBEL2         XBEL3            13 2
N14  C                   ELSE
N14  C     XBEL1         ADD       XBEL2         XBEL3
N14  C                   END
N14  C                   ENDSR
N37   ***********************************************
N37  C     SRTSTCONT     BEGSR
N37   ***********************************************
N37  C                   SELECT
N37  C                   WHEN      W2FT01 = *BLANKS OR                          MANGLE CONTAINERNR
N37  C                             %SUBST(W2FT01:14:15) <> *BLANKS              FOR LANG CONTAINER
N37  C                   EVAL      *IN83 = *ON
N37  C                   WHEN      %SUBST(W2FT01:1:1) < 'A' AND                 FØRSTE 4 <> A-Z
N37  C                             %SUBST(W2FT01:1:1) > 'Z' OR
N37  C                             %SUBST(W2FT01:2:1) < 'A' AND
N37  C                             %SUBST(W2FT01:2:1) > 'Z' OR
N37  C                             %SUBST(W2FT01:3:1) < 'A' AND
N37  C                             %SUBST(W2FT01:3:1) > 'Z' OR
N37  C                             %SUBST(W2FT01:4:1) < 'A' AND
N37  C                             %SUBST(W2FT01:4:1) > 'Z'
N37  C                   EVAL      *IN83 = *ON
N37  C                   OTHER
N37   *
N37  C                   SELECT
N37  C                   WHEN      %SUBST(W2FT01:5:1) = ' ' OR                  FORMAT AAAA 123456 7
N37  C                             %SUBST(W2FT01:5:1) = '-'
N37  C                   EVAL      XAN07 = %SUBST(W2FT01:6:6)
N37  C                             + %SUBST(W2FT01:13:1)
N37  C                   WHEN      %SUBST(W2FT01:12:17) <> *BLANKS              FOR LANG CONTAINER
N37  C                   EVAL      *IN83 = *ON
N37  C                   OTHER                                                  FORMAT AAAA1234567
N37  C                   EVAL      XAN07 = %SUBST(W2FT01:5:7)
N37  C                   ENDSL
N37   *
N37  C     1             DO        7             XN                             TEST OM TALL
N37  C                   IF        %SUBST(XAN07:XN:1) < '0' OR
N37  C                             %SUBST(XAN07:XN:1) > '9'
N37  C                   EVAL      *IN83 = *ON                                  FEIL: IKKE TALL
N37  C                   LEAVE
N37  C                   END
N37   *
N37  C                   ENDDO
N37  C                   ENDSL
N37   *
N37  C                   IF        *IN71 = *OFF
N37  C                   IF        %SUBST(W2FT01:5:1) = ' ' OR                  FORMAT AAAA 123456 7
N37  C                             %SUBST(W2FT01:5:1) = '-'
N37  C                   EVAL      UCONNR = %SUBST(W2FT01:1:4)
N37  C                             + %SUBST(W2FT01:6:6)
N37  C                             + %SUBST(W2FT01:13:1)
N37  C                   ELSE
N37  C                   EVAL      UCONNR = W2FT01
N37  C                   END
N37  C                   CALL      'SYGE124'
N37  C                   PARM                    UCONNR           11
N37  C                   PARM                    UCTLSIF           1
N37  C                   PARM                    UOK               1
N37  C                   IF        UOK <> 'J'
N37  C                   EVAL      *IN83 = *ON
N37  C                   MOVE      'YBC2031'     MSGNR
N37  C                   END
N37  C                   ELSE
N37  C                   MOVE      'YBC2030'     MSGNR
N37  C                   END
N37   *
N37  C                   ENDSR
N37   *
     OZAEVR     E            OPDZAV
     O                       SV01
     O                       SVAVD
     O                       SVTDN
     O          E            DUMZAV
     OZAEVR02   E            OPDZA2
     O                       SV01
     O                       SVAVD
     O                       SVTDN
     O          E            DUMZA2
