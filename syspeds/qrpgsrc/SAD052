********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 TEST PÅ ANDREKOSTNAD HVIS LEV.BET. SIER
10XXX * 02 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 03 YBC PTF10 TOLLSTEDSKODE ER ENDRET 4.0
10XXX * 04 SH  PTF10 når kundenummer = 0  ikke chain
10006 * 05 SH  PTF10 *cr til *ce
10XXX * 06 YBC PTF10 SETT *INLR ON
10XXX * 07 YBC PTF10 PROSEDYRE = 81, BEST.LANDKODE = 'SJ'
10XXX * 08 YBC PTF10 SETT CURSOR PÅ RIKTIG POS. VED FEIL PÅ FAKT.NR
10XXX * 09 YBC PTF10 PROSEDYRE = 81, BEST.LANDKODE = 'NO'
10XXX * 10 SH  PTF10 eksportoppdrag med HETRI føres evt over (EDI)
10024 * 11 YBC PTF10 SAMSLÅING LINJER OG FORHOLD BRT/NET-VEKT
10XXX * 12 YBC PTF10 OPPDATER SIGNATUR
10XXX * 13 YBC PTF10 SUM AV FAKTURASUM OG KOSTNAD KAN IKKE VÆRE 0
10XXX * 14 YBC PTF10 HENT ADRESSE FRA KUNDE-REG. HVIS NAVN ER BLANK
10167 * 15 YBC PTF10 BLANK KURS VED VALUTAKODE ENDRING
10XXX * 16 YBC PTF10 SUMMEN AV FAKTURASUM OG KOSTNAD SKAL IKKE VÆRE 0
10XXX * 17 YBC PTF10 TEST DUA ETTER INNSTIKK
10XXX * 18 YBC PTF10 OPPDATER GAMMEL STATUS VED F12
10XXX * 19 SH  PTF10 låser deklarant
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11016 * 20 YBC PTF11 OMBEREGNING
11XXX * 21 YBC PTF11 IKKE KRAV PÅ GODSNR VED PROSEDYRE 20,21
11XXX * 22 YBC PTF11 KUTT TEST PÅ FØRST SIFFER TIL TOLLKREDIT
11XXX * 23 YBC PTF11 HENT FORTOLLINGSDATO FOR OMBEREGNING
11XXX * 24 YBC PTF11 OMBEREGNING VED STATUS=P AND IKKE SENDT FØR
11062 * 25 YBC PTF11 TEST FORMAT PÅ GODKJENNINGSDATO
11XXX * 26 YBC PTF11 OMBEREGNING: gamle kan være slettet
11XXX * 27 SH  PTF11 Se på arkiv fra BILDE01
11XXX * 28 YBC PTF11 HENT KURS OG OMREGNINGFAKTOR
11102 * 29 YBC PTF11 FEILMELDING DERSOM......
11132 * 30 YBC PTF11 3 DESIMALER PÅ KALKULATOR
11180 * 31 YBC PTF11 HENT BILNR OG LANDKODE FRA TUR
11186 * 32 YBC PTF11 VIS TOTAL VEKT OG SUM AV LINJEVEKT
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL REGISTRERE SAD-EKSPORT (HOVEDARK)      ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 05 06 09 11 14 16-26       ***
      *** LEDIGE INDIKATORER 27 37-??
      ***        INDIKATOR   28 PÅ = (DEKL.2=0,20,80) UTGÅR 04.2000!!
      ***        INDIKATOR   34 BRUKES FOR TVINN              ***
      ***        INDIKATOR   35 PÅ = SJØ-OPPDRAG              ***
      *** ALLE VARIABLER SOM STARTER MED 'X' ER ARBERDSVAR.   ***
      ***   OG DEFINERES I PROGRAM                            ***
      ***********************************************************
      *
     FFRISOL01  IF   E           K DISK    RENAME(FRISOKR:FRISOKR1)
     FFRISOK    UF A E           K DISK
     FFRATXT    IF   E           K DISK
     FTVINF     IF   E           K DISK
     FSYPTFF    IF   E           K DISK
N11  FSAEHTL    UF A E           K DISK
     FSAEH      UF A E           K DISK
     FSAEV      IF A E           K DISK
     FSTANDE    UF   E           K DISK
     FHEADF     IF   E           K DISK
     FBILLOF    IF   E           K DISK
N31  FTURER14   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   UF   E           K DISK
     FEDIM1     UF   E           K DISK
     FEDIM4     IF   E           K DISK    RENAME(EDIMR:EDIMR4)
     FKODTTST   IF   E           K DISK
     FKODTLB    IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FMULTKOD2  IF   E           K DISK
     FKODTSC    IF   E           K DISK
     FKODTSD    IF   E           K DISK
     FZEADL01   IF   E           K DISK    RENAME(HEADFR:ZEADHR1)
     FZEADL04   IF   E           K DISK    RENAME(HEADFR:ZEADHR4)
     FZAEHL01   UF   E           K DISK    RENAME(SAEHR:ZAEHR)
     FZAEFL01   UF   E           K DISK    RENAME(SADFR:ZADFR)
     FSAEF      IF A E           K DISK    USROPN
N20  FSAEHOM    UF A E           K DISK    USROPN
N20  F                                     RENAME(SAEHR:SAEHROM)
N20  FKODTSO    IF   E           K DISK    USROPN
     FSAD052FM  CF   E             WORKSTN USROPN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSFT31                 1      3
     D  WSFT32                 5     45
     D  WSFT3                  1     45
     D                 DS
     D  WSTREF                 1     35
     D  WSTR17                 1     17
     D                 DS
     D  TUBILN                 1     10
     D  TUBIL8                 1      8
     D                 DS
     D  TUHENG                 1     10
     D  TUHEN8                 1      8
     D                 DS
     D  ENGAD3                 1     30
     D  SYPOGE                 1      9
     D  ADR3                  11     34
     D                 DS
     D  SEDTÅF                 1      4  0
     D  SEDTMF                 5      6  0
     D  SEDTDF                 7      8  0
     D  SEFID                  1      8  0
     D                 DS
     D  ZEFIDÅ                 1      4  0
     D  ZEFIDM                 5      6  0
     D  ZEFIDD                 7      8  0
     D  ZEFID                  1      8  0
     D                 DS
     D  WSDTDF                 1      2  0
     D  WSDTMF                 3      4  0
     D  WSDTÅF                 5      6  0
     D  WSFID                  1      6  0
     D*** FØRST POS. AV KLBXXX I KODTLB ER TATT I BRUK
     D                 DS
     D  KLBXXX                 1     35
     D  KLBHAD                 2      2
N01  D  KLBANK                 3      3
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
     D                 DS
     D  SEAVD                  1      4  0
     D  SETDN                  5     11  0
     D  BLUR                  12     12
     D  UWS2                  13     22
     D  WSTVIN                23     23
     D  UIN28                 24     24
     D  UIN34                 25     25
     D  UIN36                 26     26
     D  SEBEL1                28     40  2
     D  SEVKB                 41     49  0
     D  SEDP                  50     51  0
     D  SEKNK                 52     59  0
     D  SETST                 60     60  0
     D  XPRE                  61     61
     D  HEUNIK                62     70  0
     D  HEREFF                71     87
     D  U2VSUM                88    101  2
     D  UDIFF                101    113  2
     D  U2LI                 114    118  0
     D  UNYZF                119    119
     D  UIN08                120    120
     D  USEDT                121    128  0
N32  D  U2VKB                129    141  3
N32  D  UVDIF                142    154  3
S32  D* UPARM2                 1    128
N32  D  UPARM2                 1    512
     IZAEHR
     I              SEST                        ZEST
     I              SEAVD                       ZEAVD
     I              SETDN                       ZETDN
     I              SEUR                        ZEUR
     I              SEDTY                       ZEDTY
     I              SEDP                        ZEDP
     I              SEKNS                       ZEKNS
     I              SENAS                       ZENAS
     I              SEADS1                      ZEADS1
     I              SEADS2                      ZEADS2
     I              SEADS3                      ZEADS3
     I              SENTK                       ZENTK
     I              SEVKB                       ZEVKB
     I              SEKDC                       ZEKDC
     I              SERG                        ZERG
     I              SEKNK                       ZEKNK
     I              SENAK                       ZENAK
     I              SEADK1                      ZEADK1
     I              SEADK2                      ZEADK2
     I              SEADK3                      ZEADK3
     I              SELKA                       ZELKA
     I              SETLF                       ZETLF
     I              SENAD                       ZENAD
     I              SELV                        ZELV
     I              SELVT                       ZELVT
     I              SETRID                      ZETRID
     I              SELKT                       ZELKT
     I              SEVAL1                      ZEVAL1
     I              SEBEL1                      ZEBEL1
     I              SEVKU                       ZEVKU
     I              SEKDH                       ZEKDH
     I              SETST                       ZETST
     I              SEBEL2                      ZEBEL2
     I              SEFTG2                      ZEFTG2
     I              SETRM                       ZETRM
     I              SEFIF                       ZEFIF
     I              SEFID                       ZEFID
     I              SEKTA                       ZEKTA
     I              SEKTB                       ZEKTB
     I              SEGN                        ZEGN
     I              SEFT1                       ZEFT1
     I              SEFT2                       ZEFT2
     I              SEFT3                       ZEFT3
     I              SEDST                       ZEDST
     I              SEDTG                       ZEDTG
     I              SETLL                       ZETLL
     I              SETLE                       ZETLE
     I              SESKI                       ZESKI
     I              SELS                        ZELS
     I              SEKDLS                      ZEKDLS
     I              SEDT                        ZEDT
     I              SELV2                       ZELV2
     I              SEKDDK                      ZEKDDK
     I              SEGKD                       ZEGKD
     I              SEGFT1                      ZEGFT1
     I              SEGFT2                      ZEGFT2
     I              SEPOS                       ZEPOS
     I              SEFTB                       ZEFTB
     I              SELKB                       ZELKB
     I              SEFTM                       ZEFTM
     I              SELKM                       ZELKM
     I              SEKDFT                      ZEKDFT
     I              SETARF                      ZETARF
     I              SELKAT                      ZELKAT
     I              SEVAL2                      ZEVAL2
     I              SEBEL3                      ZEBEL3
     I              SEWS                        ZEWS
     I              SEMF                        ZEMF
     I              SEMP                        ZEMP
     I              SEDTØ                       ZEDTØ
     I              SEBELD                      ZEBELD
     I              SEPKL                       ZEPKL
     I              SEKDV                       ZEKDV
     I              SE0035                      ZE0035
     I              SE3039                      ZE3039
     I              SEMI                        ZEMI
     I              SEKTC                       ZEKTC
     I              SEDTPL                      ZEDTPL
     I              SEUNIK                      ZEUNIK
     I              SEREFF                      ZEREFF
     C*
     C                   OPEN      SAD052FM
     C                   EXSR      INIT
N20  C                   IF        WSTDN < 0
N20  C                   EXSR      OPNFIL
N20  C     SAEHK         CHAIN(N)  SAEH                               33
N20  C                   SELECT
N20  C                   WHEN      SEST = 'Q'
N20  C     TVINMK        SETGT     EDIM1
N20  C     TVINMK        READPE    EDIM1                                  33
N20  C  N33MSR           IFEQ      'S'
N20  C     M1001         ANDEQ     '830'
N20  C                   DELETE    EDIMR
N20  C                   EVAL      SEST = ' '
N20  C                   GOTO      START0
N20  C                   END
N20  C                   EVAL      *INLR = *ON
N20  C                   RETURN
N20  C                   WHEN      SEST <> ' ' AND SEST <> 'M'
N24  C                             AND SEST <> 'P'
N20  C                   EVAL      *INLR = *ON
N20  C                   RETURN
N24  C                   WHEN      SEST = 'P' AND SEMF <> *BLANKS
N24  C                   EVAL      *INLR = *ON
N24  C                   RETURN
N20  C                   ENDSL
N20  C     START0        TAG
N23  C                   EXSR      HENTSADDT
N20  C     SAEHK         CHAIN(N)  SAEHOM                             33
N20  C                   EXSR      MOVW2
N20  C                   GOTO      START2
N20  C                   END
     C*...............................................
     C* BILDE-1 INNLESING AV OPDNR./TARIFFØR OSV.
     C*'''''''''''''''''''''''''''''''''''''''''''''''
     C     START         TAG
     C  N30
     CANN31              Z-ADD     10            LINNBR
     C  N30
     CAN 31              Z-ADD     9             LINNBR
     C  N30              Z-ADD     34            POSNBR
     C  N30WSSG          IFEQ      *BLANKS
     C                   Z-ADD     9             LINNBR
     C                   END
     C     FIURBE        COMP      'N'                                3535
     C                   EXFMT     BILDE01
     C                   MOVEA     '00'          *IN(98)
     C                   SETOFF                                       3095
     C*
     C   12              GOTO      SLUTT
     C*
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C*
N27  C*  17 = arkiv
N27  c     *in17         ifeq      '1'
N27  C     WSTDN         IFNE      0
N27  C                   CALL      'ARC003'
N27  C                   PARM                    UAVD
N27  C                   PARM                    WSTDN
N27  C                   PARM                    URUNDE           10
N27  c                   end
N27  C                   goto      start
N27  c                   end
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C   04UFLAGG        CABEQ     1             START
      *
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      *ZEROS        WSTDN
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *BLANKS       WSDTG
     C                   MOVE      *BLANKS       WSTLL
     C                   MOVE      *BLANKS       WSTLE
     C                   MOVEL     WSFIF         WSFIF3            3
     C     WSFIF3        IFEQ      'F15'
     C                   MOVE      *BLANKS       WSFIF
     C                   END
     C                   END
     C     WSBEL1        IFEQ      0
     C     WSTDN         ANDNE     0
     C     XMI           ANDEQ     ' '
     C                   MOVE      UAVD          UAVD2             4
     C                   MOVE      WSTDN         UTDN2             7
     C                   MOVE      'E'           UIE2              1
     C                   MOVE      USEDT         UDT2              8
     C                   MOVE      WSBEL1        UBEL12           13
     C                   MOVE      WSVAL1        UVAL12            3
     C                   MOVE      WSFIF         UFIF2            17
     C                   MOVE      WSFID         UFID2             6
     C                   MOVE      WSGN          UGN2             15
     C                   CALL      'LL070R'
     C                   PARM                    UAVD2
     C                   PARM                    UTDN2
     C                   PARM                    UIE2
     C                   PARM                    UDT2
     C                   PARM                    UBEL12
     C                   PARM                    UVAL12
     C                   PARM                    UFIF2
     C                   PARM                    UFID2
     C                   PARM                    UGN2
     C     UBEL12        IFNE      *ZEROS
     C                   MOVE      UBEL12        WSBEL1
     C                   MOVE      UVAL12        WSVAL1
     C                   MOVE      UFIF2         WSFIF
     C                   MOVE      UFID2         WSFID
     C                   MOVE      UGN2          WSGN
     C                   END
     C                   END
     C*===============================================
     C*
     C*...............................................
     C* BILDE-2 INNLESING AV HOVED OPPLYSNINGER AV SAD
     C*'''''''''''''''''''''''''''''''''''''''''''''''
     C     START2        TAG
     C  N30              Z-ADD     1             LINNBR
     C  N30              Z-ADD     49            POSNBR
     C     ST21          TAG
      *
     C                   EXSR      TSTOPL
N15  C                   EVAL      XXVAL1 = WSVAL1
N15  C                   EVAL      XXVKU  = WSVKU
      *
N20  C                   IF        WSTDN < 0
N20  C                   EXFMT     BILDEOM01
N20  C                   ELSE
     C                   EXFMT     BILDE02
N20  C                   END
     C                   MOVEA     '00000000'    *IN(92)
     C                   MOVEA     '00000000'    *IN(84)
     C                   MOVEA     '00000000'    *IN(76)
     C                   MOVEA     '00000000'    *IN(68)
S01  C*                  MOVEA     '000'         *IN(65)
N01  C                   MOVEA     '0000'        *IN(64)
N08  C                   MOVE      '0'           *IN(60)
N25  C                   MOVE      '0'           *IN59
     C                   SETOFF                                       30
N15   *
N15  C                   IF        XXVAL1 <> WSVAL1 AND XXVKU = WSVKU
N15  C                   EVAL      WSVKU  = 0
N15  C                   END
      *
     C   08WSTOLK        IFNE      'J'
     C                   GOTO      START2
     C                   END
     C*
     C*  04 = SØK AVSENDER/MOTTAKER
     C   04              DO
     C                   EXSR      SØKDT2
     C                   GOTO      ST21
     C                   END
     C*
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPES            1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPES
     C                   PARM                    UAVD
     C                   PARM                    WSTDN
     C                   PARM                    WSSG
     C                   GOTO      START2
     C                   END
     C*
     C*  10 = SE OPPLYSNIGER OM GODKJENNELSE FRA TOLLVESENET (KUN KOMMUNIKASJON)
     C   10              DO
     C                   EXSR      VISTOL
     C                   GOTO      START2
     C                   END
     C*
     C*  12 = AVBRYT, FRIGJØR E-MERKING OG GÅ TIL BILDE01
     C   12              DO
     C     SAEHK         CHAIN     SAEH                               33
     C     XNYTDK        IFEQ      'N'
N18  C                   IF        XSESTGML = 'Q' OR XSESTGML = 'K'
     C                   MOVE      ' '           SEST
N18  C                   ELSE
N18  C                   MOVE      XSESTGML      SEST
N18  C                   END
     C                   END
     C  N33              UPDATE    SAEHR
     C     UTYPE         IFEQ      'CR2'
     C                   MOVE      *ZEROS        WSTDN
     C                   GOTO      START
     C                   ELSE
     C                   GOTO      SLUTT
     C                   END
     C                   END
     C*
     C   14              DO
     C                   EXSR      VISOPL
     C                   GOTO      START2
     C                   END
     C*
     C*
     C   24              DO
     C                   EXSR      UTCMDL
     C                   GOTO      START2
     C                   END
     C*
     C*
     C*  15 = REGISTRER RUBR.28
     C   15              DO
     C                   EXSR      OPDSAE
     C                   Z-ADD     1             FLAGG
     C                   MOVE      USEDT         USEDT2            8
     C                   CALL      'RUBR28CE'
     C                   PARM      UAVD          XAVD              4 0
     C                   PARM      WSTDN         XTDN              7 0
     C                   PARM                    WSBEL1
     C                   PARM                    WSVAL1
     C                   PARM                    UKURS             7 3
     C                   PARM                    FLAGG
     C                   PARM                    USEDT2
     C     FLAGG         IFEQ      1
     C                   MOVE      *BLANKS       WSFIF
     C                   MOVEL     'F15  ER '    WSFIF
     C                   MOVE      'BENYTTET'    WSFIF
     C                   MOVE      '999999'      WSFID
     C     UKURS         IFNE      0
     C                   MOVE      UKURS         WSVKU
     C                   END
     C                   END
     C                   GOTO      START2
     C                   END
     C*
     C* ----------- T E S T   B I L D E 0 2 ----------
     C                   EXSR      TESTB2
     C   30              GOTO      START2
     C     XBEL1         IFLT      XBEL3
     C     WSFTG2        IFEQ      '-'
     C     WSFTG2        OREQ      'M'
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     55            POSNBR
     C                   MOVE      'YBC0876'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   GOTO      START2
     C                   END
     C                   END
     C*
     C* ----- INGEN FEIL HITTIL     OPPDATER SAE -----
     C                   EXSR      OPDSAE
     C*
     C*===============================================
     C*
     C                   EXSR      TOSAEV
     C   12              GOTO      START2
     C     UTYPE         IFEQ      'CR2'
     C     *IN17         OREQ      '1'
     C                   MOVE      *ZEROS        WSTDN
     C  N03              DO
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *ZEROS        WSBEL1
     C                   MOVE      *BLANKS       WSVAL1
     C                   MOVE      *ZEROS        WSVKU
     C                   MOVE      *ZEROS        WSNTK
     C                   MOVE      *BLANKS       WSKDLS
     C                   MOVE      *BLANKS       WSLS
     C                   MOVE      *ZEROS        WSBEL2
     C                   MOVE      *BLANKS       WSFTG2
     C                   MOVE      *BLANKS       WSVAL2
     C                   MOVE      *BLANKS       WSFIF
     C                   MOVE      *ZEROS        WSFID
     C                   MOVE      *ZEROS        WSVKB
     C                   MOVE      *BLANKS       WSDTG
     C                   MOVE      *BLANKS       WSTLL
     C                   MOVE      *BLANKS       WSTLE
     C                   GOTO      START2
     C                   END
     C                   GOTO      START
     C                   END
     C*
     C     SLUTT         TAG
N20  C                   IF        WSTDN < 0
N20  C                   EXSR      CLSFIL
N20  C                   ELSE
N18  C                   IF        XNYTDK = 'N'
N18  C     SAEHK         CHAIN     SAEH                               33
N18  C  N33              IF        SEST = ' '
N18  C                   EXSR      HENTGMLST
N18  C                   UPDATE    SAEHR
N18  C                   ELSE
N18  C                   UPDATE    SAEHR
N18  C                   END
N18  C                   END
N20  C                   END
     C                   CLOSE     SAD052FM
     C*                    SETON                     LR
N06  C                   EVAL      *INLR = *ON
     C                   RETURN
     C*
     C***********************************************
     C     SØKDT2        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     2
     C     POSNBR        ANDLE     31
     C                   CALL      'SOEKVADR'
     C                   PARM                    FIFIRM
     C                   PARM                    WSKNS
     C                   PARM                    WSNAS
     C                   PARM                    WSADS1
     C                   PARM                    WSADS2
     C                   PARM                    WSADS3
     C                   PARM                    ULKDUM            2
     C                   PARM                    UADRNR            5
     C                   Z-ADD     51            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
S02  C*                  EXSR      SØKUNR
N02  C                   CALL      'SOEKKUN'
N02  C                   PARM                    WSKNK
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    WSNAK
N02  C                   IF        WSKNK <> 0
N02  C                   EXSR      TESTKK
N02  C                   END
     C                   Z-ADD     62            POSNBR
     C                   GOTO      SLSØK2
     C                   END
N20   *
N20  C     LINNBR        IFEQ      2
N20  C     POSNBR        ANDGE     46
N20  C     POSNBR        ANDLE     49
N20  C     WSTDN         ANDLT     0
N20  C                   CALL      'SAD061OM'
N20  C                   PARM                    WSTYPE
N20  C                   Z-ADD     62            POSNBR
N20  C                   GOTO      SLSØK2
N20  C                   END
      *
      * FRISØK AVSENDER
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     1
     C     POSNBR        ANDLE     30
     C     WSNAS         ANDNE     *BLANKS
     C                   MOVE      WSNAK         NAVN             30
     C                   EXSR      FRISR
     C     KUNDE         IFNE      *ZEROS
     C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      *BLANKS       WSADK1
     C                   MOVE      *BLANKS       WSADK2
     C                   MOVE      *BLANKS       WSADK3
     C                   Z-ADD     KUNDE         WSKNK
     C                   EXSR      TESTKK
     C                   END
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     13
     C     POSNBR        ANDLE     20
S02  C*                  EXSR      SØKUNR
N02  C                   CALL      'SOEKKUN'
N02  C                   PARM                    WSKNS
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    WSNAS
N02  C                   IF        WSKNS <> 0
N02  C                   EXSR      TESTSS
N02  C                   END
     C                   Z-ADD     49            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      1
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   MOVE      'N'           UIMP              1
     C                   CALL      'SAD061E'
     C                   PARM                    WSDP
     C                   PARM                    UIMP
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKA
     C                   PARM                    USPED
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     56
     C     POSNBR        ANDLE     57
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKB
     C                   PARM                    USPED
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     62
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10G'
     C                   PARM                    WSLV
     C                   PARM                    USPED
     C                   Z-ADD     64            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKT
     C                   PARM                    USPED
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     53
     C                   MOVE      USEDT         PAEDT             8 0
     C                   CALL      'SAD061F'
     C                   PARM                    WSVAL1
     C                   PARM                    PAEDT
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     51
     C     POSNBR        ANDLE     52
     C                   MOVE      USEDT         PAEDT
     C                   CALL      'SAD061F'
     C                   PARM                    WSVAL2
     C                   PARM                    PAEDT
     C                   Z-ADD     55            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     47
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRM
S03  C*                  Z-ADD     60            POSNBR
N03  C                   Z-ADD     58            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C     LINNBR        IFEQ      11
S03  C*    POSNBR        ANDGE     60
N03  C     POSNBR        ANDGE     58
     C     POSNBR        ANDLE     61
     C                   CALL      'SAD061J'
     C                   PARM                    WSKDH
     C                   Z-ADD     63            POSNBR
     C                   GOTO      SLSØK2
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     64
     C     POSNBR        ANDLE     65
     C                   CALL      'SAD061P'
     C                   PARM                    WSKDLS
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     59            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C* KALKULATOR ANTALL
     C     LINNBR        IFEQ      2
     C     POSNBR        ANDGE     62
     C     POSNBR        ANDLE     68
S30  C*                  Z-ADD     WSNTK         UNU132           13 2
N30  C                   Z-ADD     WSNTK         UNU133           13 3
     C                   CALL      'SYGE11'
S30  C*                  PARM                    UNU132
N30  C                   PARM                    UNU133
S30  C*                  Z-ADD     UNU132        WSNTK
N30  C                   Z-ADD(H)  UNU133        WSNTK
     C                   Z-ADD     74            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C* KALKULATOR BRUTTOVEKT
     C     LINNBR        IFEQ      3
S30  C*    POSNBR        ANDGE     53
S30  C*    POSNBR        ANDLE     61
N30  C     POSNBR        ANDGE     50
N30  C     POSNBR        ANDLE     58
S30  C*                  Z-ADD     WSVKB         UNU132           13 2
N30  C                   Z-ADD     WSVKB         UNU133           13 3
     C                   CALL      'SYGE11'
S30  C*                  PARM                    UNU132
N30  C                   PARM                    UNU133
S30  C*                  Z-ADD     UNU132        WSVKB
N30  C                   Z-ADD(H)  UNU133        WSVKB
     C                   Z-ADD     2             POSNBR
     C                   Z-ADD     4             LINNBR
     C                   GOTO      SLSØK2
     C                   END
     C* KALKULATOR FAKTURASUM
     C     LINNBR        IFEQ      9
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     68
S30  C*                  Z-ADD     WSBEL1        UNU132           13 2
N30  C                   Z-ADD     WSBEL1        UNU133           13 3
     C                   CALL      'SYGE11'
S30  C*                  PARM                    UNU132
N30  C                   PARM                    UNU133
S30  C*                  Z-ADD     UNU132        WSBEL1
N30  C                   Z-ADD(H)  UNU133        WSBEL1
     C                   Z-ADD     73            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C* KALKULATOR ANDRE KOSTNADER
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     66
S30  C*                  Z-ADD     WSBEL2        UNU132           13 2
N30  C                   Z-ADD     WSBEL2        UNU133           13 3
     C                   CALL      'SYGE11'
S30  C*                  PARM                    UNU132
N30  C                   PARM                    UNU133
S30  C*                  Z-ADD     UNU132        WSBEL2
N30  C                   Z-ADD(H)  UNU133        WSBEL2
     C                   Z-ADD     68            POSNBR
     C                   GOTO      SLSØK2
     C                   END
     C*
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK2        ENDSR
     C*
     C***********************************************
     C     FRISR         BEGSR
     C***********************************************
      *
     C                   MOVE      *ZEROS        KUNDE
     C                   CALL      'SYGE22'
     C                   PARM                    NAVN             30
     C                   PARM                    KUNDE             8 0
      *
     C     UTFRI         ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        HEUNIK
     C                   MOVE      *BLANKS       HEREFF
N18  C                   MOVE      *BLANKS       XSESTGML          1
     C*** TEST OM DET ER SJØ-OPPDRAG
     C     FIURBE        IFNE      'N'
     C     BILLK         CHAIN     BILLOF                             33
     C   33              MOVE      WSUR          BLUR
     C     BLUR          COMP      'G'                                    35
     C                   ELSE
     C                   MOVE      *BLANKS       BLUR
     C                   SETOFF                                       35
     C                   END
     C     *IN04         IFEQ      '1'
     C     LINNBR        ANDEQ     7
     C                   CALL      'SYGE47R'
     C                   PARM      'B'           UHEUR             1
     C                   PARM                    EXTREF
     C                   MOVEL     EXTREF        WSTREF
     C                   EVAL      *IN04=*OFF
     C     EXTREF        IFEQ      *BLANKS
     C                   EVAL      *IN30=*ON
     C                   GOTO      SLTB1
     C                   ENDIF
     C                   ENDIF
     C     UTYPE         IFNE      'CPY'
     C     EXTREF        IFNE      *BLANKS
     C     UAVD          CHAIN(N)  STANDE                             99
     C  N99KODSIK        CHAIN     KOSIR                              99
     C  N99              DO
     C     EXTREFK       CHAIN     FRISOL01                           99
      *
      * allerede flyttet til sysped
      *
     C  N99              MOVE      FSOPD         WSTDN
     C  N99              MOVE      FSAVD         UAVD
      * Ny ekstern ref  - hent data
     C   99              DO
     C     SEEKST        ifeq      'J'
     c                   move      *zeros        nyopd             7 0
     C                   CALL      'SADEXT'
     C                   PARM                    UAVD
     C                   PARM                    EXTREF
     C                   PARM                    nyopd
     C                   PARM                    WSSG
     C                   MOVE      nyopd         WSTDN
     C                   MOVEL     EXTREF        WSTREF
     C     WSTDN         IFEQ      0
     C                   SETON                                        30
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SHU1172'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C                   END
     C                   END
     C                   END
     C                   END
     C                   End
     C*** TEST AVDELING
     C     UAVD          CHAIN(N)  STANDE                             95
     C  N95              DO
     C                   MOVE      *BLANKS       SEST
     C                   MOVE      *ZEROS        SETDN
     C     *LIKE         DEFINE    SETOLK        XTOLK
     C                   MOVE      SETOLK        XTOLK
     C                   END
     C   95              DO
     C                   MOVE      'SPA0001'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
     C*** TEST TARIFFØR
     C     KODSIK        CHAIN     KOSIR                              99
     C   99              DO
     C                   MOVE      'SPS0001'     MSGNR
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END
     C*
     C                   MOVE      'J'           XNYTDK            1
     C*** TEST OM TASTET TOLLDEKNR. ER RIKTIG
     C* WSTDN = 0  --> HENT STANDARD SAD-OPPLYSNINGER
     C     UTYPE         IFEQ      'CPY'                                        1<-B
     C     SAEHKK        CHAIN(N)  SAEH                               33
     C                   ELSE                                                   1
     C     WSTDN         IFNE      0                                             2<-B
     C     SAEHK         CHAIN     SAEH                               33
     C  N33SEST          IFNE      ' '                                            3<-B
     C     SEST          ANDNE     'K'
     C     SEST          ANDNE     'M'
     C     SEST          ANDNE     'U'
     C     SEST          COMP      'P'                                9898
     C   98SEST          COMP      'Q'                                9898
     C                   END                                                      3<-E
     C  N33
     CANN98SEWS          IFEQ      'A'                                            3<-B
     C     SEWS          COMP      UWS                                9898
     C                   END                                                      3<-E
      *
     C  N33
     CANN98              DO                                                       3<-B
     C                   EXSR      TSTM
     C   98              UPDATE    SAEHR
     C   98              GOTO      SLTB1
     C                   END                                                      3<-E
N18  C  N33
N18  CANN98              MOVE      SEST          XSESTGML
     C  N33
     CANN98              MOVE      'E'           SEST
     C  N33              UPDATE    SAEHR
     C  N33              MOVE      'N'           XNYTDK
     C   33HEADFK        CHAIN     HEADF                              98
      *
     C   98              DO                                                       3<-B
     C                   MOVE      'SPT0028'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   SETON                                        30
     C                   GOTO      SLTB1
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C*
     C*** TEST KOMMUNIKASJON
     C     XTOLK         COMP      'J'                                9696
     C   96WSTOLK        COMP      'J'                                    96
     C   96              DO
     C                   MOVE      'SPK0036'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTB1
     C                   END
     C* TEST OM DET SKAL SENDES PÅ TVINN  (34 ON = DENNE SENDES TVINN)
     C     WSTOLK        COMP      'J'                                    34
     C  N34              MOVE      'J'           WSTVIN
     C*
     C*** HENT OPPLYSNINGER FRA HEADF/DOKUF
     C  N30
     CAN 33              MOVE      WSTDN         UTDN
      *  04 = PLUKK FRA Z-FIL
     C  N30*IN04         IFEQ      '1'
     C                   CALL      'SAD052G'
     C                   PARM                    FIFIRM
     C                   PARM                    UZAVD
     C                   PARM                    UZTDN
     C                   PARM                    UZREFF
     C                   PARM                    UZUNIK
     C                   PARM                    UFLAGG
     C     UFLAGG        CABEQ     1             SLTB1
     C                   ELSE
     C   33WSTDN         IFEQ      0
     C                   MOVE      '0'           *IN31
     C                   ELSE
     C     HEADFK        CHAIN     ZEADL04                            31
     C                   END
     C   33*IN31         IFEQ      '1'
     C                   MOVE      *ZEROS        UZAVD             4 0
     C                   MOVE      *ZEROS        UZTDN             7 0
     C                   MOVE      *BLANKS       UZREFF           17
     C                   MOVE      *ZEROS        UZUNIK            9 0
     C                   ELSE
     C                   MOVE      HEAVD         UZAVD
     C                   MOVE      HEOPD         UZTDN
     C                   MOVE      HEREFF        UZREFF
     C                   MOVE      HEUNIK        UZUNIK
     C                   END
     C                   END
     C  N30
     CAN 33              EXSR      SRU1
     C  N30
     CAN 33
     CAN 35              MOVE      'G'           BLUR
     C*
     C*** FLYTT DATA FRA FIL-VARIABLER TIL WS-VARIABLER
     C  N30              EXSR      MOVW2
     C  N30*IN04         IFEQ      '1'
     C     HEREFF        ORNE      *BLANKS
     C                   MOVE      'J'           UNYZF                          NY FRA Z-FIL
     C                   EXSR      HZFIL
     C                   ELSE
     C                   MOVE      'N'           UNYZF
     C                   END
     C     USEDT         IFEQ      0
     C                   MOVE      WDT           USEDT
     C                   END
     C*
     C     SLTB1         ENDSR
     C*
     C***********************************************
     C     TSTM          BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        USEDT
      *
      * Test om det finnes sending i "postkasse"
     C     TVINMK        SETGT     EDIM1
     C     STTSTM        TAG
     C     TVINMK        READPE    EDIM1                                  98
     C  N98MSR           IFEQ      'S'
     C     M1001         ANDEQ     '830'
     C   10              DELETE    EDIMR
     C   10              GOTO      SLTSTM
     C                   UPDATE    EDIMR
     C                   MOVE      'SPT0043'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   ELSE
     C                   UPDATE    EDIMR
     C                   GOTO      STTSTM
     C                   END
      *
      * Test om det har fått tollkvittering
     C     TVIM4K        SETLL     EDIM4                              98
     C     STTST2        TAG
     C     TVI41K        READPE    EDIM4                                  98
     C  N98MST           IFEQ      'D'
     C     M1001         ORNE      '830'
     C                   GOTO      STTST2
     C                   ELSE
     C     M1N07         IFEQ      'DTK'
     C                   MOVE      'YBC0012'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     34            POSNBR
     C                   GOTO      SLTSTM
     C                   END
      *
     C     M1N07         IFEQ      'DUA'
     C     SEMI          ANDNE     'I'
     C     MMN           SETLL     TVINF
     C     MMN           READE     TVINF                                  33
     C     *IN33         DOWEQ     '0'
     C     F0078A        IFEQ      '951'
N17  C     F0078A        OREQ      '962'
     C                   MOVE      M0068A        USEDT
     C                   GOTO      SLTSTM
     C                   END
     C     MMN           READE     TVINF                                  33
     C  N33              ENDDO
     C                   MOVE      '0'           *IN33
     C                   MOVE      'YBC0012'     MSGNR
     C                   SETON                                        3098
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLTSTM
     C                   END
      *
     C     M1N07         IFEQ      'DFI'
     C     M0068C        ANDEQ     1
     C                   GOTO      STTST2
     C                   END
     C     M1N07         IFNE      'DII'
     C                   MOVE      M0068A        USEDT
     C                   END
     C                   END
     C                   MOVE      '0'           *IN98
     C*
     C     SLTSTM        ENDSR
     C*
N18   ***********************************************
N18  C     HENTGMLST     BEGSR
N18   ***********************************************
N18   *
N18  C     TVIM4K        SETLL     EDIM4                              33
N18  C     STHENT01      TAG
N18  C     TVI41K        READPE    EDIM4                                  33
N18  C  N33              SELECT
N18  C                   WHEN      MST = 'D' OR M1001 <> '830'
N18  C                   GOTO      STHENT01
N18  C                   WHEN      M1N07 = 'DUA'
N18  C                   MOVE      'U'           SEST
N18  C                   OTHER
N18  C                   MOVE      'M'           SEST
N18  C                   ENDSL
N18   *
N18  C                   ENDSR
N18   *
     C***********************************************
     C     TESTB2        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       XPRE              1
     C*  08                GOTO STB2F1
      *
     C*** TEST DEKLARASJONSTYPE
     C     WSDTY         COMP      'EU'                               9999
     C   99WSDTY         COMP      'EX'                               9999
     C*
     C*** TEST DEKLARASJONSKODE
     C     KODS9K        CHAIN     KOS9R                              98
     C*
     C*** TEST AVSENDER
     C     WSKNK         IFNE      0
     C                   EXSR      TESTKK
     C                   END
     C     PTFDT         IFLE      WDT80
     C     WSRG          COMP      *BLANKS                                65
     C                   END
     C  N96WSNAK         COMP      *BLANKS                                96
N20   *
N20  C                   IF        WSTDN < 0
N20  C     WSTYPE        CHAIN     KODTSO                             70
N20  C                   END
     C*
     C*** TEST ANTALL KOLLI
     C     WSNTK         COMP      0                                    9595
     C*
     C*** TEST TOLL/MVA  K/S/I
     C     WSSKI         COMP      'S'                                    33
     C   33WSKTC         IFEQ      ' '
     C                   MOVE      *ZEROS        WSKTA
     C                   MOVE      *ZEROS        WSKTB
     C                   END
     C     WSSKI         COMP      'K'                                    33
     C   33WSKTA         COMP      0                                  9494
     C     WSKTA         COMP      0                                      33
S22  C* N33WSKTC         IFEQ      '8'
S22  C*    WSKTC         OREQ      '9'
S22  C*                  MOVE      '1'           *IN33
S22  C*                  END
     C   33WSSKI         COMP      ' '                                    94
     C     HEKDFS        IFNE      'X'
     C     WSSKI         COMP      'K'                                3333
     C                   END
     C     HEKDFK        IFNE      'X'
     C   33WSSKI         COMP      'S'                                3333
     C                   END
     C   33WSSKI         COMP      ' '                                3333
     C   33WSSKI         COMP      'I'                                3333
     C   33              SETON                                        94
     C*
     C*** TEST BRUTTO VEKT
     C     WSVKB         COMP      0                                    9393
     C*
N07  C                   IF        WSDP = 81
S09  C*                  EVAL      WSLKB = 'SJ'
N09  C                   EVAL      WSLKB = 'NO'
N07  C                   END
     C*** TEST AVSENDER-LAND (IKKE KRAV VED ANNETE ENN.. SE UNDER)
     C     WSLKA         IFNE      *BLANKS
     C                   MOVE      WSLKA         XLANDK
     C     KODS2K        CHAIN     KOS2R                              67
     C   67              MOVE      '1'           AVLKFE            1
     C  N67WSLKAT        IFEQ      *BLANKS
     C                   MOVEL     KS2FTX        WSLKAT
     C                   END
     C                   END
      * KRAV OM UTFYLLING (FORSKJELLIG FRA NO) VED VISSE PROSED.
     C     *IN67         IFEQ      *OFF
     C     WSDP          IFEQ      2
     C     WSDP          OREQ      4
     C     WSDP          OREQ      81
     C     WSDP          OREQ      90
     C     WSTST         IFNE      1
     C     WSTST         ANDNE     2
     C     WSTST         ANDNE     3
     C     WSTST         ANDNE     9
     C                   SETON                                        66          TRTYPE
     C                   END
      * FRA-LAND MÅ VÆRE UTFYLT MED ANNET ENN "NO".
     C     WSLKA         COMP      '  '                                   67
     C  N67WSLKA         COMP      'NO'                                   67
      * TIL-LAND MÅ VÆRE UTFYLT MED  "NO".
N07  C                   IF        WSDP <> 81
     C  N67WSLKB         COMP      'NO'                               6767
N07  C                   END
     C   67              MOVE      '2'           AVLKFE
     C                   END
     C                   END
     C*
     C*** TEST BESTEMMELSESLAND
     C                   MOVE      WSLKB         XLANDK
     C     KODS2K        CHAIN     KOS2R                              92
     C   92              MOVE      'SPL0018'     MSGNR
     C  N92              MOVE      KS2PRE        XPRE              1
     C  N92WSDTY         IFEQ      'EU'
     C     KS2PRE        COMP      'A'                                9292
     C   92KS2PRE        COMP      'B'                                9292
     C   92KS2PRE        COMP      'C'                                9292
     C   92              MOVE      'YBC0013'     MSGNR
     C                   ELSE
     C     KS2PRE        COMP      'A'                                    92
     C  N92KS2PRE        COMP      'B'                                    92
     C  N92KS2PRE        COMP      'C'                                    92
     C   92              MOVE      'YBC0013'     MSGNR
     C                   END
     C  N92WSFTB         IFEQ      *BLANKS
     C                   MOVEL     KS2FTX        WSFTB
     C                   END
     C   08              GOTO      STB2F2
     C*
     C*** TEST CONT.
     C     WSKDC         COMP      '0'                                9090
     C   90WSKDC         COMP      '1'                                9090
     C*
     C     STB2F2        TAG
     C*** TEST MOTTAKER
     C     WSKNS         IFNE      0
     C                   EXSR      TESTSS
     C                   END
     C  N88WSNAS         COMP      *BLANKS                                88
     C  N88
     CAN 34WSADS1        COMP      *BLANKS                                71
     C  N88
     CAN 34
     CAN 71WSADS2        COMP      *BLANKS                                71
     C  N88
     CAN 34
     CAN 71WSADS3        COMP      *BLANKS                                71
     C   08              GOTO      STB2F3
     C*
     C*** TEST PKT. 21
     C     WSTRM         IFNE      20
     C     WSTRM         ANDNE     23
     C     WSTRM         ANDNE     50
     C     WSTRM         ANDNE     70
     C                   MOVE      WSLKT         XLANDK
     C     KODS2K        CHAIN     KOS2R                              87
     C                   END
     C*-------------------------------------------
     C*
     C*** TEST LEVERINGSVILKÅR
     C     KODLBK        CHAIN     KODTLB                             89
     C  N89              MOVE      KLBKT         XLV2              3
     C  N89WSLVT         IFEQ      *BLANKS
     C     KLBHAD        ANDNE     ' '
     C                   EXSR      HENTAD
     C                   END
     C  N89WSLVT         COMP      *BLANKS                                89
     C*
     C     STB2F3        TAG
     C     WSVAL1        IFEQ      *BLANKS
     C     WSBEL2        ANDNE     0
     C     WSVAL2        IFEQ      *BLANKS
     C                   MOVE      FICURR        WSVAL1
     C                   ELSE
     C                   MOVE      WSVAL2        WSVAL1
     C                   END
     C                   END
     C*** TEST FAKTURA SUM
     C                   MOVE      *ZEROS        XBEL1             9 0
     C     WSVAL1        IFNE      *BLANKS
     C     WSBEL1        ORNE      0
     C                   MOVE      WSVAL1        XVALKO
     C     KODVAK        SETGT     KODTVAL2
     C     WSVAL1        READPE    KODTVAL2                               85
N26  C   85              IF        WSTDN < 0
N26  C     KODVAK        SETLL     KODTVAL2
N26  C     WSVAL1        READE     KODTVAL2                               85
N26  C                   END
     C  N85WSVKU         IFEQ      0
     C                   MOVE      KVAKRS        WSVKU
     C                   END
     C  N85WSBEL1        DIV       KVAOMR        XWORK
     C  N85XWORK         MULT(H)   WSVKU         XBEL1
     C                   END
     C  N08WSBEL1        IFEQ      0
     C     WSTDN         ANDNE     0
     C                   MOVE      UAVD          UAVD2             4
     C                   MOVE      WSTDN         UTDN2             7
     C                   MOVE      'E'           UIE2              1
     C                   MOVE      USEDT         UDT2              8
     C                   MOVE      WSBEL1        UBEL12           13
     C                   MOVE      WSVAL1        UVAL12            3
     C                   MOVE      WSFIF         UFIF2            17
     C                   MOVE      WSFID         UFID2             6
     C                   MOVE      WSGN          UGN2             15
     C                   CALL      'LL070R'
     C                   PARM                    UAVD2
     C                   PARM                    UTDN2
     C                   PARM                    UIE2
     C                   PARM                    UDT2
     C                   PARM                    UBEL12
     C                   PARM                    UVAL12
     C                   PARM                    UFIF2
     C                   PARM                    UFID2
     C                   PARM                    UGN2
     C     UBEL12        IFNE      *ZEROS
     C                   MOVE      UBEL12        WSBEL1
     C                   MOVE      UVAL12        WSVAL1
     C                   MOVE      UFIF2         WSFIF
     C                   MOVE      UFID2         WSFID
     C                   MOVE      UGN2          WSGN
     C                   END
     C                   END
     C  N08WSTST         IFEQ      5
     C     WSBEL1        COMP      0                                    8686
     C                   END
N13   *
N13  C                   IF        WSFTG2 = 'M' OR WSFTG2 = '-'
N13  C                   IF        WSVAL2 = WSVAL1 AND WSBEL1 = WSBEL2
N13YBC                   EVAL      *IN86 = *ON
N13  C                   END
N13  C                   END
     C*
     C*** TEST VALUTAKODE TIL ANDRE KOSTNAD
     C     WSBEL2        IFEQ      0
     C                   MOVE      *BLANKS       WSVAL2
     C                   MOVE      *ZEROS        SEBEL2
     C                   MOVE      *ZEROS        XBEL3
     C                   ELSE
     C     WSVAL2        IFEQ      *BLANKS
     C                   MOVE      FICURR        WSVAL2
     C                   END
     C                   MOVE      WSVAL2        XVALKO
     C     KODVAK        SETGT     KODTVAL2
     C     WSVAL2        READPE    KODTVAL2                               84
N26  C   84              IF        WSTDN < 0
N26  C     KODVAK        SETLL     KODTVAL2
N26  C     WSVAL2        READE     KODTVAL2                               84
N26  C                   END
S26  C* N30              DO
N26  C  N84              DO
     C     WSBEL2        DIV       KVAOMR        XWORK            15 6
     C     XWORK         MULT(H)   KVAKRS        XBEL3             9 0
     C     WSFTG2        IFNE      '+'
     C     WSFTG2        ANDNE     'P'
     C     WSFTG2        ANDNE     'M'
     C                   MOVE      '-'           WSFTG2
     C                   END
     C                   END
     C                   END
N01   *
N01  C  N89              IF        ((KLBANK = 'J') AND (WSBEL2 = 0))
N01  C                   EVAL      *IN64 = *ON
N01  C                   END
     C*
     C*** TEST RUBR.28 (FINANSIELLE OPPLYSNINGER OG BANKDATA)
     C     WSFID         IFEQ      0
     C  N08              MOVE      '1'           *IN80
     C                   ELSE
     C                   MOVE      WSDTÅF        UÅÅ               2 0
     C                   MOVE      WSDTMF        UMM               2 0
     C                   MOVE      WSDTDF        UDD               2 0
     C     WSFID         IFNE      999999
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    FLAGG             1 0
     C     FLAGG         COMP      1                                      80
     C                   END
     C                   END
     C   08              GOTO      STB2F4
      *HVIS DATO UTFYLLT MÅ FAKTURANUMMER VÆRE DET OGSÅ
     C     WSFID         IFNE      0
     C     WSFIF         ANDEQ     *BLANKS
S08  C*                  SETON                                        80
N08  C                   SETON                                        60
     C                   END
     C*
     C*** TEST LAGRINGSTED
     C                   MOVE      KS9FTX        XAN01             1
     C                   IF        ((XAN01 = 'J') OR (WSKDLS <> *BLANKS))
     C     WSKDLS        CHAIN     KODTSD                             81
     C  N81WSLS          IFEQ      *BLANKS
     C                   MOVE      KSDTXT        WSLS
     C                   END
     C                   END
     C*
     C*-------------------------------------------------
     C     STTB2         TAG
     C*
     C*** TEST TRANSPORTMÅTE
     C     KODS4K        CHAIN     KOS4R                              83
     C*
     C*** TEST UTPASSERINGSTOLLSETED
     C     STB2F4        TAG
     C     WSKDH         IFNE      0
     C     WSTRM         ORNE      60
     C     WSTRM         ANDNE     70
     C     KODTSK        CHAIN     KODTTST                            82
     C  N82WSKDFT        IFEQ      *BLANKS
     C                   MOVEL     KTSNAV        WSKDFT
     C                   END
     C                   END
      *
      *** TEST OM MAN HAR OPPGITT GODSNR.
     C  N08WSDP          IFNE      90
     C     WSDP          ANDNE     91
N21  C     WSDP          ANDNE     20
N21  C     WSDP          ANDNE     21
     C     WSKDLS        IFEQ      'A '
     C     WSKDLS        OREQ      'B '
     C     WSKDLS        OREQ      'C '
     C     WSKDLS        OREQ      'D '
     C     WSGN          COMP      *BLANKS                                68
     C                   END
     C                   END
     C*
     C   08              DO
     C     WSFT1         IFEQ      *BLANKS
     C                   MOVEL     HEVS1         WSFT1
     C                   END
     C     WSFT1         COMP      *BLANKS                                70
     C     WSFT3         IFNE      *BLANKS
     C     WSFT31        CHAIN     KODTSC                             69
     C                   END
     C                   END
N20   *
N20  C                   IF        WSTDN < 0
N20  C     WSFT01        COMP      *BLANKS                                69
N20  C                   END
N25   * TEST FORMAT PÅ GODKJENNINGSDATO
N25  C                   IF        WSDTG <> *BLANKS
N25  C                   MOVE      *BLANKS       XAN02             2
N25  C                   IF        %SUBST(WSDTG:1:2) <> '20'
N25  C                   EVAL      *IN59 = *ON
N25  C                   ELSE
N25  C     '.'           SCAN      WSDTG                                  59
N25  C                   IF        *IN59 = *OFF
N25  C                   EVAL      XAN02 = %SUBST(WSDTG:3:2)
N25  C                   MOVE      XAN02         UÅÅ
N25  C                   EVAL      XAN02 = %SUBST(WSDTG:5:2)
N25  C                   MOVE      XAN02         UMM
N25  C                   EVAL      XAN02 = %SUBST(WSDTG:7:2)
N25  C                   MOVE      XAN02         UDD
N25  C                   CALL      'TESTDATO'
N25  C                   PARM                    UDD
N25  C                   PARM                    UMM
N25  C                   PARM                    UÅÅ
N25  C                   PARM                    FLAGG             1 0
N25  C     FLAGG         COMP      1                                      59
N25  C                   END
N25  C                   END
N25  C                   END
     C*
     C* HENT MESSAGE-TEKST UTFRA FEILINDIKATOR...
     C                   EXSR      HMSG
     C*
     C  N30WSTST         IFNE      0
     C                   SELECT
S22  C*    WSKTC         WHENEQ    '8'                                          MIDL. TOLLKR.NR
S22  C*    WSKTC         OREQ      '9'
S22  C*                  MOVE      'D'           WSKDDK
     C     WSKTA         WHENEQ    0                                            INGEN TOLLKR.NR
     C     WSKDDK        IFNE      'K'
     C                   MOVE      'D'           WSKDDK
     C                   END
     C     WSKDDK        WHENNE    'D'                                          TOLLKREDITNR
     C                   MOVE      ' '           WSKDDK
     C                   ENDSL
     C                   END
      *
     C                   ENDSR
     C*
     C***********************************************
     C     HENTAD        BEGSR
     C***********************************************
     C     KLBHAD        IFEQ      'A'
     C*
     C     WSADK3        IFNE      *BLANKS
     C                   MOVEL     WSADK3        WSLVT
     C                   ELSE
     C     WSADK2        IFNE      *BLANKS
     C                   MOVEL     WSADK2        WSLVT
     C                   ELSE
     C                   MOVEL     WSADK1        WSLVT
     C                   END
     C                   END
     C*
     C                   ELSE
     C* KLBHAD = 'M'
     C     WSADS3        IFNE      *BLANKS
     C                   MOVEL     WSADS3        WSLVT
     C                   ELSE
     C     WSADS2        IFNE      *BLANKS
     C                   MOVEL     WSADS2        WSLVT
     C                   ELSE
     C                   MOVEL     WSADS1        WSLVT
     C                   END
     C                   END
     C*
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     HMSG          BEGSR
     C***********************************************
     C   99              DO
     C                   MOVE      'SPD0013'     MSGNR
     C                   Z-ADD     1             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        30
     C                   END
     C   98
     CANN30              DO
     C                   MOVE      'SPD0010'     MSGNR
     C                   Z-ADD     1             LINNBR
     C                   Z-ADD     52            POSNBR
     C                   SETON                                        30
     C                   END
N20  C   70
N20  CANN30              IF        WSTDN < 0
N20  C                   MOVE      'YBC2009'     MSGNR
N20  C                   SETON                                        30
N20  C                   Z-ADD     2             LINNBR
N20  C                   Z-ADD     46            POSNBR
N20  C                   END
     C   95
     CANN30              DO
     C                   MOVE      'SPN0003'     MSGNR
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     62            POSNBR
     C                   SETON                                        30
     C                   END
     C   94
     CANN30              DO
     C     WSKTC         IFEQ      ' '
     C                   MOVE      'SPS0040'     MSGNR
     C                   ELSE
     C                   MOVE      'YBC0221'     MSGNR
     C                   END
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     74            POSNBR
     C                   SETON                                        30
     C                   END
     C   65
     CANN30              DO
     C                   MOVE      'YBC1828'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     2             LINNBR
     C                   Z-ADD     29            POSNBR
     C                   END
     C   96
     CANN30              DO
     C                   MOVE      'SPK0037'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
     C   93
     CANN30              DO
     C                   MOVE      'SPV0002'     MSGNR
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     50            POSNBR
     C                   SETON                                        30
     C                   END
     C   67
     CANN30              DO
     C     AVLKFE        IFEQ      '1'
     C                   MOVE      'SPL0001'     MSGNR                           FEIL LK...
     C                   ELSE
     C                   MOVE      'JOV1016'     MSGNR                           PROS 2/4...
     C                   END
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   SETON                                        30
     C                   END
     C   92
     CANN30              DO
     C*                    MOVE 'SPL0018' MSGNR
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     56            POSNBR
     C                   SETON                                        30
     C                   END
     C   90
     CANN30              DO
     C                   MOVE      'SPK0041'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     49            POSNBR
     C                   SETON                                        30
     C                   END
     C   89
     CANN30              DO
     C                   MOVE      'SPL0014'     MSGNR
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     60            POSNBR
     C                   SETON                                        30
     C                   END
     C   88
     CANN30              DO
     C                   MOVE      'SPK0038'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETON                                        30
     C                   END
     C   87
     CANN30              DO
     C                   MOVE      'SPL0019'     MSGNR
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C   71
     CANN30              DO
     C                   MOVE      'SPA0025'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   END
     C   85
     CANN30              MOVE      'SPV0014'     MSGNR
     C   86
     CANN85
     CANN30              MOVE      'SPB0005'     MSGNR
     C   86              SETON                                        85
     C   85
     CANN30              DO
     C                   Z-ADD     9             LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
     C   84
     CANN30              DO
     C                   MOVE      'SPV0013'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     51            POSNBR
     C                   SETON                                        30
     C                   END
N01  C   64
N01  CANN30              DO
N01  C                   MOVE      'YBC1958'     MSGNR
N01  C                   Z-ADD     10            LINNBR
N01  C                   Z-ADD     55            POSNBR
N01  C                   SETON                                        30
N01  C                   END
N16   *
N16  C  N30              IF        WSVAL1 = WSVAL2 AND
N16  C                             (WSFTG2 = '-' OR WSFTG2 = 'M')
N16  C                   IF        WSBEL1 <= WSBEL2
N16  C                   MOVE      'YBC1991'     MSGNR
N16  C                   EVAL      *IN64 = *ON
N16  C                   EVAL      *IN30 = *ON
N16  C                   Z-ADD     10            LINNBR
N16  C                   Z-ADD     55            POSNBR
N16  C                   END
N16  C                   END
N16   *
     C   66
     CANN30              DO
     C                   MOVE      'JOV1019'     MSGNR
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     80            POSNBR
     C                   SETON                                        30
     C                   END
     C   83
     CANN30              DO
     C                   MOVE      'SPT0030'     MSGNR
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     46            POSNBR
     C                   SETON                                        30
     C                   END
     C   82
     CANN30              DO
     C                   MOVE      'SPK0042'     MSGNR
     C                   Z-ADD     11            LINNBR
S03  C*                  Z-ADD     60            POSNBR
N03  C                   Z-ADD     58            POSNBR
     C                   SETON                                        30
     C                   END
     C   80
     CANN30              DO
     C                   MOVE      'SPD0011'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     49            POSNBR
     C                   END
N08  C   60
N08  CANN30              DO
N08  C                   MOVE      'YBC1973'     MSGNR
N08  C                   SETON                                        30
N08  C                   Z-ADD     12            LINNBR
N08  C                   Z-ADD     63            POSNBR
N08  C                   END
     C   81
     CANN30              DO
     C                   MOVE      'SPL0020'     MSGNR
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     64            POSNBR
     C                   SETON                                        30
     C                   END
     C   68
     CANN30              DO
     C                   MOVE      'JOV1018'     MSGNR
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     59            POSNBR
     C                   SETON                                        30
     C                   END
     C   70
     CANN30              DO
     C                   MOVE      'YBC0010'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   END
N20  C                   IF        WSTDN < 0
N20  C   69
N20  CANN30              DO
N20  C                   MOVE      'YBC2010'     MSGNR
N20  C                   SETON                                        30
N20  C                   Z-ADD     16            LINNBR
N20  C                   Z-ADD     9             POSNBR
N20  C                   END
N20  C                   ELSE
     C   69
     CANN30              DO
     C                   MOVE      'YBC0011'     MSGNR
     C                   SETON                                        30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     5             POSNBR
     C                   END
N20  C                   END
N25  C   59
N25  CANN30              DO
N25  C                   MOVE      'YBC2013'     MSGNR
N25  C                   SETON                                        30
N25  C                   Z-ADD     21            LINNBR
N25  C                   Z-ADD     36            POSNBR
N25  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVW2         BEGSR
     C***********************************************
     C                   MOVE      SEMI          XMI               1
     C                   MOVE      SEDTY         WSDTY
     C                   MOVE      EXTREF        WSTREF
     C                   MOVE      SEDP          WSDP
     C                   MOVE      SEKNK         WSKNK
     C                   MOVE      SERG          WSRG
     C                   MOVE      SENTK         WSNTK
     C                   MOVE      SESKI         WSSKI
     C                   MOVE      SEKDDK        WSKDDK
     C                   MOVE      SENAK         WSNAK
     C                   MOVE      SEADK1        WSADK1
     C                   MOVE      SEVKB         WSVKB
     C                   MOVE      SELKA         WSLKA
     C                   MOVE      SELKAT        WSLKAT
     C                   MOVE      SEADK2        WSADK2
     C                   MOVE      SELKB         WSLKB
     C                   MOVE      SEFTB         WSFTB
     C                   MOVE      SEADK3        WSADK3
     C                   MOVE      SEKNS         WSKNS
     C                   MOVE      SEKDC         WSKDC
     C                   MOVE      SELV          WSLV
     C                   MOVE      SELVT         WSLVT
     C                   MOVE      SENAS         WSNAS
     C                   MOVE      SELKT         WSLKT
     C                   MOVE      SETRID        WSTRID
     C                   MOVE      SEADS1        WSADS1
     C                   MOVE      SEVAL1        WSVAL1
     C                   MOVE      SEBEL1        WSBEL1
     C                   MOVE      SEVKU         WSVKU
     C                   MOVE      SEADS2        WSADS2
     C                   MOVE      SEVAL2        WSVAL2
     C                   MOVE      SEBEL2        WSBEL2
     C                   MOVE      SEFTG2        WSFTG2
     C                   MOVE      SETST         WSTST
     C                   MOVE      SEADS3        WSADS3
     C                   MOVE      SETRM         WSTRM
     C                   MOVE      SEKDH         WSKDH
     C                   MOVE      SEKDFT        WSKDFT
     C                   MOVE      SETLF         WSTLF
     C                   MOVE      SEFIF         WSFIF
     C                   MOVE      SEDTDF        WSDTDF
     C                   MOVE      SEDTMF        WSDTMF
     C                   MOVE      SEDTÅF        WSDTÅF
     C                   MOVE      SENAD         WSNAD
     C                   MOVE      SELS          WSLS
     C                   MOVE      SEKDLS        WSKDLS
     C                   MOVE      SEKTA         WSKTA
     C                   MOVE      SEKTB         WSKTB
     C                   MOVE      SEKTC         WSKTC
     C                   MOVE      SEGN          WSGN
     C                   MOVE      SEPOS         WSPOS
     C                   MOVE      SEFT1         WSFT1
     C                   MOVE      SEFT2         WSFT2
     C                   MOVE      SEFT3         WSFT3
     C*                  MOVE      SEGFT1        WSGFT1
     C*                  MOVE      SEGKD         WSGKD
     C*                  MOVE      SEGFT2        WSGFT2
     C                   MOVE      SEDTG         WSDTG
     C                   MOVE      SETLL         WSTLL
     C                   MOVE      SETLE         WSTLE
N11  C     SAEHK         CHAIN(N)  SAEHTL                             33
N11  C                   IF        *IN33
N11  C                   MOVE      'J'           WSSAM
N11  C                   Z-ADD     0,9           WSFVK
N11  C                   ELSE
N11  C                   MOVE      SESAM         WSSAM
N11  C                   MOVE      SEFVK         WSFVK
N11  C                   END
     C*
     C     KODSIK        CHAIN     KOSIR                              33
S12  C*    SETDN         IFEQ      0
S12  C*    SESG          OREQ      *BLANKS
     C                   MOVE      WSSG          SESG
S12  C*                  END
     C                   MOVE      KSINAV        SETARF
     C                   MOVE      UAVD          SEAVD
N20   *
N20  C                   IF        WSTDN < 0
N20  C     WSTOLK        COMP      'J'                                    34
N20  C                   eval      XSESTGML = SEST
N20  C                   EVAL      XNYTDK = 'N'
S23  C*                  EVAL      USEDT  = SEDT
N20  C                   EVAL      WSTYPE = SETYPE
N20  C                   EVAL      WSFT01 = SEFT01
N20  C                   EVAL      WSFT02 = SEFT02
N20  C                   EVAL      WSFT03 = SEFT03
N20  C                   EVAL      WSFT04 = SEFT04
N29  C                   EVAL      WSFT05 = SEFT05
N20  C                   END
N20   *
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVSAE        BEGSR
     C***********************************************
N11   * OPPDATER KODE FOR SAMSLÅING OG FORHOLDSTALL FOR BRUTTO OG NETTO VEKT
N11  C                   IF        *IN33
N11  C                   MOVE      WSSAM         SESAM
N11  C                   MOVE      WSFVK         SEFVK
N11  C                   WRITE     SAEHTLR
N11  C                   ELSE
N11  C     SAEHK         CHAIN     SAEHTL                             33
N11  C                   MOVE      WSSAM         SESAM
N11  C                   MOVE      WSFVK         SEFVK
N11  C   33              WRITE     SAEHTLR
N11  C  N33              UPDATE    SAEHTLR
N11  C                   EVAL      *IN33 = *OFF
N11  C                   END
N11   *
N11   *
     C                   MOVE      WSDTY         SEDTY
     C                   MOVE      WSDP          SEDP
     C                   MOVE      WSKNS         SEKNS
     C                   MOVE      WSNAS         SENAS
     C                   MOVE      WSADS1        SEADS1
     C                   MOVE      WSADS2        SEADS2
     C                   MOVE      WSADS3        SEADS3
     C                   MOVE      WSNTK         SENTK
     C                   MOVE      WSVKB         SEVKB
     C                   MOVE      WSKDC         SEKDC
     C                   MOVE      WSLKA         SELKA
     C                   MOVE      WSLKAT        SELKAT
     C                   MOVE      WSKNK         SEKNK
     C                   MOVE      WSRG          SERG
     C                   MOVE      WSNAK         SENAK
     C                   MOVE      WSADK1        SEADK1
     C                   MOVE      WSADK2        SEADK2
     C                   MOVE      WSADK3        SEADK3
     C     WSKDDK        IFEQ      'D'
     C                   MOVE      SEAVD         SEADK2
     C                   MOVE      SETDN         SEADK3
     C                   END
     C                   MOVE      WSTLF         SETLF
     C                   MOVE      WSNAD         SENAD
     C                   MOVE      WSLV          SELV
     C                   MOVE      WSLVT         SELVT
     C                   MOVE      WSTRID        SETRID
     C                   MOVE      WSLKT         SELKT
     C                   MOVE      WSVAL1        SEVAL1
     C                   MOVE      WSBEL1        SEBEL1
     C                   MOVE      WSVKU         SEVKU
     C                   MOVE      WSKDH         SEKDH
     C                   MOVE      WSTST         SETST
     C                   MOVE      WSBEL2        SEBEL2
     C                   MOVE      WSFTG2        SEFTG2
     C                   MOVE      WSTRM         SETRM
     C                   MOVE      WSFIF         SEFIF
     C     WSFID         IFEQ      999999
     C                   MOVEL     99999999      SEFID
     C                   ELSE
     C                   MOVE      WSDTDF        SEDTDF
     C                   MOVE      WSDTMF        SEDTMF
     C     WSDTÅF        IFGT      50
     C     WSDTÅF        ADD       1900          SEDTÅF
     C                   ELSE
     C     WSDTÅF        ADD       2000          SEDTÅF
     C                   END
     C                   END
     C                   MOVE      WSKTA         SEKTA
     C                   MOVE      WSKTB         SEKTB
     C                   MOVE      WSKTC         SEKTC
     C                   MOVE      WSGN          SEGN
     C                   MOVE      WSFT1         SEFT1
     C                   MOVE      WSFT2         SEFT2
     C                   MOVE      WSFT3         SEFT3
     C                   MOVE      WSDTG         SEDTG
     C                   MOVE      WSTLL         SETLL
     C                   MOVE      WSTLE         SETLE
     C                   MOVE      WSSKI         SESKI
     C                   MOVE      WSLS          SELS
     C                   MOVE      WSKDLS        SEKDLS
     C                   MOVE      XLV2          SELV2
     C                   MOVE      WSKDDK        SEKDDK
     C*                  MOVE      WSGKD         SEGKD
     C*                  MOVE      WSGFT1        SEGFT1
     C*                  MOVE      WSGFT2        SEGFT2
     C                   MOVE      WSPOS         SEPOS
     C                   MOVE      WSFTB         SEFTB
     C                   MOVE      WSLKB         SELKB
     C                   MOVE      WSKDFT        SEKDFT
     C                   MOVE      KSINAV        SETARF
     C                   MOVE      WSVAL2        SEVAL2
     C                   MOVE      XBEL3         SEBEL3
     C                   MOVE      UWS           SEWS
     C   08              MOVE      'I'           SEMI
     C*
S12  C*    SETDN         IFEQ      0
     C                   MOVE      WSSG          SESG
S12  C*                  END
N20   *
N20  C                   IF        WSTDN < 0
N20  C                   EVAL      SETYPE = WSTYPE
N20  C                   EVAL      SEFT01 = WSFT01
N20  C                   EVAL      SEFT02 = WSFT02
N20  C                   EVAL      SEFT03 = WSFT03
N20  C                   EVAL      SEFT04 = WSFT04
N29  C                   EVAL      SEFT05 = WSFT05
N20  C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTSS        BEGSR
     C***********************************************
     C                   MOVE      WSKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            88
N04  C  N88kundnr        comp      0                                      88
S14  C* N88              DO
N14  C  N88              IF        WSNAS = *BLANKS
     C                   MOVE      *BLANKS       WSADS3
     C                   MOVE      KNAVN         WSNAS
     C                   MOVE      ADR1          WSADS1
     C                   MOVE      ADR2          WSADS2
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          WSADS3
     C                   ELSE                                                     3
     C                   MOVE      ENGAD3        WSADS3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        WSADS3
     C                   MOVE      ADR3          WSADS3
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TESTKK        BEGSR
     C***********************************************
     C                   MOVE      WSKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            96
N04  C  N96kundnr        comp      0                                      96
     C  N96
     CAN 13              DO
     C     WSRG          IFNE      *BLANKS
     C                   MOVEL     WSRG          SYFORE
     c                   call      'SYGE29'
     c                   parm                    fifirm
     c                   parm                    wsknk
     c                   parm                    syrg
     C                   END
     C                   MOVEL     WSKTA         SYKONT
     C                   MOVE      WSKTB         SYKONT
     C                   MOVE      WSKTC         SYFR02
     C                   END
     C  N96              DO
     C                   UPDATE    KUNDR
     C     WSDTG         IFEQ      *BLANKS
     C     WSTLL         ANDEQ     *BLANKS
     C     WSTLE         ANDEQ     *BLANKS
     C     WSNAK         OREQ      *BLANKS
     C     WSADK1        ANDEQ     *BLANKS
     C     WSADK2        ANDEQ     *BLANKS
     C     WSADK3        ANDEQ     *BLANKS
     C                   MOVE      *BLANKS       WSADK3
     C                   MOVE      KNAVN         WSNAK
     C                   MOVE      ADR1          WSADK1
     C                   MOVE      ADR2          WSADK2
     C     POSTNR        IFEQ      0
     C     SYPOGE        IFEQ      *BLANKS
     C                   MOVEL     ADR3          WSADK3
     C                   ELSE                                                     3
     C                   MOVE      ENGAD3        WSADK3
     C                   END
     C                   ELSE
     C                   MOVEL     POSTNR        WSADK3
     C                   MOVE      ADR3          WSADK3
     C                   END
     C                   END
     C                   TESTN                   SYFOR9               96
     C   96SYFOR9        COMP      *ZEROS                             9696
     C                   MOVE      *BLANKS       WSRG
     C   96              MOVEL     SYFORE        WSRG
     C                   MOVE      '0'           *IN96
     C                   MOVEL     SYKONT        WSKTA
     C                   MOVE      SYKONT        WSKTB
     C                   MOVE      SYFR02        WSKTC
S22  C*    WSKTC         IFEQ      '8'
S22  C*    WSKTC         OREQ      '9'
S22  C*                  MOVE      'D'           WSKDDK
S22  C*                  END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDSAE        BEGSR
     C***********************************************
     C     WSTDN         IFEQ      0
     C     UAVD          CHAIN     STANDE                             33
     C                   MOVE      SETDN         WSTDN
     C                   ADD       1             SETDN
     C                   UPDATE    STANDER
     C                   END
     C*
     C     SAEHK         CHAIN     SAEH                               33
     C  N33XNYTDK        IFEQ      'J'
     C                   UPDATE    SAEHR
     C                   CLOSE     SAD052FM
     C                   RETURN
     C                   END
N20  C                   IF        WSTDN < 0
N20  C     SAEHK         CHAIN     SAEHOM                             33
N20  C                   END
     C                   EXSR      MOVSAE
     C*
     C                   MOVE      'E'           SEST
     C                   MOVE      BLUR          SEUR
     C   33              DO
     C                   MOVE      UAVD          SEAVD
     C                   MOVE      WSTDN         SETDN
     C                   MOVE      WSSG          SESG
     C                   MOVEL     WDT           SEDT
     C     SEMF          IFNE      'DTK'
     C  N34              MOVE      *BLANKS       SEMF
     C                   END
     C     UTYPE         IFEQ      'CPY'
     C     KAVD          ANDNE     0
     C                   MOVE      'J'           WSJNV
     C                   MOVE      'N'           WSJNF
     C                   EXFMT     BILDE06
      *
     C                   IF        WSJNV = 'J'
     C     SAEHKK        SETLL     SAEV                               33
     C     STOPDS        TAG
     C     SAEHKK        READE     SAEV                                   33
     C     *IN33         IFEQ      '0'
     C                   MOVE      SEAVD         SVAVD
     C                   MOVE      SETDN         SVTDN
     C                   WRITE     SAEVR
     C                   GOTO      STOPDS
     C                   END
     C                   END
      *
     C                   IF        WSJNF = 'J'
     C                   MOVE      'N'           XCPYSF            1
     C                   OPEN      SAEF
     C     SAEHKK        SETLL     SAEF                               33
     C     SAEHKK        READE     SAEF                                   33
     C                   DOW       *IN33 = *OFF                                   3<-B
     C                   MOVE      SEAVD         SFAVD
     C                   MOVE      SETDN         SFOPDN
     C                   MOVE      'J'           XCPYSF
     C                   WRITE     SADFR
     C     SAEHKK        READE     SAEF                                   33
     C                   ENDDO                                                    3<-E
     C                   CLOSE     SAEF
     C                   IF        XCPYSF = 'J'
     C     SAEHK         CHAIN     SAEH                               33
     C                   EVAL      WSFIF = 'F15  ER  BENYTTET'
     C                   EVAL      WSFID = 999999
     C                   EVAL      SEFIF = 'F15  ER  BENYTTET'
     C                   EVAL      SEFID = 99999999
     C                   UPDATE    SAEHR
     C                   END
     C                   END
      *
     C                   MOVE      *ZEROS        KAVD
     C                   END
     C                   WRITE     SAEHR
     C                   MOVE      'N'           XNYTDK
      * OPPDATER Z-FIL
     C     ZEREFF        IFNE      *BLANKS                                       2<-B
     C     ZEUNIK        ANDNE     0
     C     ZAEHK         CHAIN     ZAEHL01                            33
     C     *IN33         IFEQ      '0'                                            3<-B
     C                   MOVE      'O'           ZEST
     C                   MOVE      SEAVD         ZEAVD
     C                   MOVE      SETDN         ZETDN
     C                   MOVE      SEDT          ZEDTPL
     C                   UPDATE    ZAEHR
      * OPPDATER SADF
     C                   OPEN      SAEF
     C     ZAEHK         SETLL     ZAEFL01
     C     ZAEHK         READE     ZAEFL01                                33
     C     *IN33         DOWEQ     '0'                                             4<-B
     C                   MOVE      SEAVD         SFAVD
     C                   MOVE      SETDN         SFOPDN
N28  C                   IF        SFKR28 = 0 OR SFOM28 = 0
N28  C     KODVAKFAK     SETGT     KODTVAL2
N28  C     SFVK28        READPE    KODTVAL2                               33
N28  C  N33              EVAL      SFKR28 = KVAKRS
N28  C  N33              EVAL      SFOM28 = KVAOMR
N28  C                   END
     C                   UPDATE    ZADFR
     C                   WRITE     SADFR
     C     ZAEHK         READE     ZAEFL01                                33
     C  N33              END                                                       4<-E
     C                   CLOSE     SAEF
      *
     C                   END                                                      3<-E
     C                   MOVE      '1'           *IN33
     C                   END                                                     2<-E
      *
     C                   END
     C     SEMF          IFNE      'DTK'
     C  N33
     CANN34              MOVE      *BLANKS       SEMF
     C                   END
     C  N33              UPDATE    SAEHR
N20  C  N33              IF        WSTDN < 0
N20  C                   UPDATE    SAEHROM
N20  C                   END
     C     USEDT         IFEQ      0
     C                   MOVE      WDT           USEDT
     C                   END
      *
      * FOR DE SOM REGISTRERER EGEN REF
      *
     C     SEEKST        IFEQ      'R'
     C     EXTREF        ANDNE     WSTREF
N20  C     WSTDN         ANDGE     0
     C     EXTREFK2      CHAIN     frisok                             33
     C                   eval      fssok = wstref
     C   33              eval      fsavd = SEAVD
     C   33              eval      fsopd = SETDN
     C   33              eval      fskode = wskode
     C   33              eval      fsdtop = sedt
     c   33              write     frisokr
     c  n33              update    frisokr
     c                   end
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TOSAEV        BEGSR
     C***********************************************
      *
     C                   MOVE      *IN34         UIN34
     C                   MOVE      *IN08         UIN08
     C                   CALL      'SAD052A'
S32  C*                  PARM      UPARM2        UPARM1          128
N32  C                   PARM      UPARM2        UPARM1          512
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      'N'           UNYZF
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      2                                      17
     C     UFLAGG        COMP      3                                      03
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISTOL        BEGSR
     C***********************************************
      *________________________
      * Call på eksternt CL-pgm
      *""""""""""""""""""""""""
     C                   MOVE      '1'           WIN03
     C                   CALL      'SAD003'
     C                   PARM      SEAVD         XAVD
     C                   PARM      SETDN         XTDN
     C                   PARM                    WIN03
     C*
     C                   ENDSR
     C*
S02  C***********************************************
S02  C*    SØKUNR        BEGSR
S02  C***********************************************
S02  C*                  CALL      'SOEKUN'
S02  C*                  PARM                    FIFIRM
S02  C*                  PARM                    SOANTK
S02  C*                  PARM                    SOTXT1
S02  C*                  PARM                    WSKNK
S02  C*                  PARM                    SOTXT2
S02  C*                  PARM                    WSKNS
S02  C*                  PARM                    SOTXT3
S02  C*                  PARM                    SOKNR3
S02  C*                  PARM                    SOTXT4
S02  C*                  PARM                    SOKNR4
S02  C*                  PARM                    SOTXT5
S02  C*                  PARM                    SOKNR5
S02  C*                  PARM                    SOTXT6
S02  C*                  PARM                    SOKNR6
S02  C*                  PARM                    SOTXT7
S02  C*                  PARM                    SOKNR7
S02  C*                  PARM                    SOTXT8
S02  C*                  PARM                    SOKNR8
S02  C*    WSKNK         IFNE      0
S02  C*                  EXSR      TESTKK
S02  C*                  END
S02  C*    WSKNS         IFNE      0
S02  C*                  EXSR      TESTSS
S02  C*                  END
S02  C*
S02  C*                  ENDSR
S02  C*
     C***********************************************
     C     SRU1          BEGSR
     C***********************************************
     C                   MOVE      UTDN          WSTDN
     C     SAEHK         CHAIN     SAEH                               98
     C     *IN98         IFEQ      '0'
     C                   MOVE      *ZEROS        UZAVD
     C                   MOVE      *BLANKS       HEREFF
     C                   MOVE      'E'           SEST
     C                   UPDATE    SAEHR
     C                   GOTO      SLSRU
     C                   END
     C*
     C* HENT STANDARDVERDIER FOR AVDELING
     C     STANEK        CHAIN(N)  STANDE                             98
     C  N98              MOVE      *BLANKS       SEST
     C     BILLK         CHAIN     BILLOF                             98
     C   98              MOVE      *BLANKS       BLUR
     C* HENT FRA OPPDRAG
     C     HEADFK        CHAIN     HEADF                              98
     C                   MOVE      *ZEROS        WSTDN
     C*
     C  N98WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          WSSG
     C                   END
     C     SETARF        IFEQ      *BLANKS
     C     KODSIK        CHAIN     KOSIR                              97
     C  N97              MOVE      KSINAV        SETARF
     C                   END
     C*
     C*** START N98
     C  N98              DO
     C*
     C*.................................................
     C*** FLYTT DATA FRA HEADF TIL SADH
     C*                    MOVELHEGN      SEGN9
     C** MOTTAKER HENT NAVN/ADR FRA REGISTER - EVT FRA OPPDRAG
     C                   MOVE      HEKNK         SEKNS
     C                   MOVE      HEKNK         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            97
N04  C  N97kundnr        comp      0                                      97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        SEKNS
     C                   MOVE      HENAK         SENAS
     C                   MOVE      HEADK1        SEADS1
     C                   MOVE      HEADK2        SEADS2
     C                   MOVE      HEADK3        SEADS3
     C                   ELSE
     C                   MOVE      KNAVN         SENAS
     C                   MOVE      ADR1          SEADS1
     C                   MOVE      ADR2          SEADS2
     C                   MOVE      *BLANKS       SEADS3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADS3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADS3
     C                   MOVE      ADR3          SEADS3
     C                   END
     C                   END
     C                   MOVE      HEFR          SELV
     C     KODLBK        CHAIN     KODTLB                             97
     C  N97              MOVE      KLBKT         XLV2
     C*                    MOVE HETRI     SELKB
     C     HEUR          IFNE      'H'
N10  C                   MOVE      HETRI         SELKT
     C                   MOVE      HELKA         SELKB
     C                   ELSE
     C                   MOVE      HETRI         SELKB
     C                   END
     C                   MOVE      *BLANKS       SEFTB
     C*
     C                   MOVE      HEKNS         SEKNK
     C                   MOVE      HEKNS         KUNDNR
     C     KUND1K        CHAIN(N)  CUNDL01                            97
N04  C  N97kundnr        comp      0                                      97
     C   97              MOVE      'D'           DKUND
     C     DKUND         IFEQ      'D'
     C                   MOVE      *ZEROS        SEKNK
     C                   MOVE      *BLANKS       SERG
     C                   MOVE      *ZEROS        SEKTA
     C                   MOVE      *ZEROS        SEKTB
     C                   MOVE      ' '           SEKTC
     C                   MOVE      HENAS         SENAK
     C                   MOVE      HEADS1        SEADK1
     C                   MOVE      HEADS2        SEADK2
     C                   MOVE      HEADS3        SEADK3
     C                   ELSE
     C                   MOVE      KNAVN         SENAK
     C                   MOVE      ADR1          SEADK1
     C                   MOVE      ADR2          SEADK2
     C                   MOVE      *BLANKS       SEADK3
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          SEADK3
     C                   ELSE
     C                   MOVEL     POSTNR        SEADK3
     C                   MOVE      ADR3          SEADK3
     C                   TESTN                   SYFOR9               97
     C   97SYFOR9        COMP      *ZEROS                             9797
     C                   MOVE      *BLANKS       SERG
     C   97              MOVEL     SYFORE        SERG
     C                   MOVEL     SYKONT        SEKTA
     C                   MOVE      SYKONT        SEKTB
     C                   MOVE      SYFR02        SEKTC
     C                   END
     C                   END
     C*
     C                   Z-ADD     HENT          SENTK
     C                   Z-ADD     HEVKT         SEVKB
     C                   MOVE      UTDN          WSTDN
     C     WSSG          IFEQ      *BLANKS
     C                   MOVE      HESG          SESG
     C                   END
     C                   EVAL      SETRID=HEHAWB
N31  C                   IF        HEPRO <> 0
N31  C     HEPRO         CHAIN     TURER14                            33
N31  C  N33              IF        TULK <> *BLANKS
N31  C                   EVAL      SELKT  = TULK
N31  C                   END
N31  C  N33              IF        TUBILN <> *BLANKS
N31  C                   EVAL      SETRID = TUBILN
N31  C                   END
N31  C                   END
     C*
     C                   END
     C*
     C     SLSRU         TAG
     C                   SETOFF                                       9897
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C                   Z-ADD     7             UFLAGG            1 0
     C                   MOVE      *ZEROS        UDIFF
     C                   MOVE      *IN34         UIN34
     C                   MOVE      *IN36         UIN36
     C                   CALL      'SAD052T'
     C                   PARM      UPARM2        UPARM1
     C                   PARM                    UFLAGG
     C*
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
      ***********************************************
     C     HZFIL         BEGSR
      ***********************************************
     C     UZAVD         IFEQ      0
     C     UZREFF        ANDEQ     *BLANKS
     C     ZEAF1K        CHAIN     ZEADL01                            98
     C                   ELSE
     C                   MOVE      UZUNIK        HEUNIK
     C                   MOVE      UZREFF        HEREFF
     C                   MOVE      '0'           *IN98
     C                   END
      *
     C  N98ZAEHK         CHAIN(N)  ZAEHL01                            98
     C     *IN98         IFEQ      '0'                                          1<-B
     C                   MOVE      WSSG          SESG
     C     WSDTY         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEDTY         WSDTY
     C                   END                                                     2<-E
     C     WSDP          IFEQ      0                                             2<-B
     C                   MOVE      ZEDP          WSDP
     C                   END                                                     2<-E
     C     WSKNS         IFEQ      0                                             2<-B
     C     WSNAS         ANDEQ     *BLANKS
     C                   MOVE      ZEKNS         WSKNS
     C                   MOVE      ZENAS         WSNAS
     C                   MOVE      ZEADS1        WSADS1
     C                   MOVE      ZEADS2        WSADS2
     C                   MOVE      ZEADS3        WSADS3
     C                   END                                                     2<-E
     C     WSNTK         IFEQ      0                                             2<-B
     C                   MOVE      ZENTK         WSNTK
     C                   END                                                     2<-E
     C     WSSKI         IFEQ      ' '                                           2<-B
     C                   MOVE      ZESKI         WSSKI
     C                   END                                                     2<-E
     C     WSKDDK        IFEQ      ' '                                           2<-B
     C                   MOVE      ZEKDDK        WSKDDK
     C                   END                                                     2<-E
     C     WSVKB         IFEQ      0                                             2<-B
     C                   MOVE      ZEVKB         WSVKB
     C                   END                                                     2<-E
     C     WSKDC         IFEQ      ' '                                           2<-B
     C                   MOVE      ZEKDC         WSKDC
     C                   END                                                     2<-E
     C     WSKNK         IFEQ      0                                             2<-B
     C     WSNAK         ANDEQ     *BLANKS
     C                   MOVE      ZEKNK         WSKNK
     C                   MOVE      ZENAK         WSNAK
     C                   MOVE      ZEADK1        WSADK1
     C                   MOVE      ZEADK2        WSADK2
     C                   MOVE      ZEADK3        WSADK3
     C                   END                                                     2<-E
     C     WSRG          IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZERG          WSRG
     C                   END                                                     2<-E
     C     WSLKA         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZELKA         WSLKA
     C                   END                                                     2<-E
     C     WSLKAT        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZELKAT        WSLKAT
     C                   END                                                     2<-E
     C     WSTLF         IFEQ      *BLANKS                                       2<-B
     C     WSNAD         ANDEQ     *BLANKS
     C                   MOVE      ZETLF         WSTLF
     C                   MOVE      ZENAD         WSNAD
     C                   END                                                     2<-E
     C     WSLV          IFEQ      *BLANKS                                       2<-B
     C     WSLVT         ANDEQ     *BLANKS
     C                   MOVE      ZELV          WSLV
     C                   MOVE      ZELVT         WSLVT
     C                   END                                                     2<-E
     C     WSTRID        IFEQ      *BLANKS                                       2<-B
     C     WSLKT         ANDEQ     *BLANKS
     C                   MOVE      ZETRID        WSTRID
     C                   MOVE      ZELKT         WSLKT
     C                   END                                                     2<-E
     C     WSVAL1        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEVAL1        WSVAL1
     C                   END                                                     2<-E
     C     WSVAL1        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      FICURR        WSVAL1
     C                   END                                                     2<-E
     C     WSBEL1        IFEQ      0                                             2<-B
     C                   MOVE      ZEBEL1        WSBEL1
     C                   END                                                     2<-E
     C     WSVAL2        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEVAL2        WSVAL2
     C                   END                                                     2<-E
     C     WSVKU         IFEQ      0                                             2<-B
     C                   MOVE      ZEVKU         WSVKU
     C                   END                                                     2<-E
     C     WSTST         IFEQ      0                                             2<-B
     C                   MOVE      ZETST         WSTST
     C                   END                                                     2<-E
     C     WSBEL2        IFEQ      0                                             2<-B
     C                   MOVE      ZEBEL2        WSBEL2
     C                   END                                                     2<-E
     C     WSFTG2        IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEFTG2        WSFTG2
     C                   END                                                     2<-E
     C     WSTRM         IFEQ      0                                             2<-B
     C                   MOVE      ZETRM         WSTRM
     C                   END                                                     2<-E
     C     WSFIF         IFEQ      *BLANKS                                       2<-B
     C     WSFID         ANDEQ     0
     C                   MOVE      ZEFIF         WSFIF
     C                   MOVE      ZEFIDD        WSDTDF
     C                   MOVE      ZEFIDM        WSDTMF
     C                   MOVE      ZEFIDÅ        WSDTÅF
     C                   END                                                     2<-E
     C     WSKTA         IFEQ      0                                             2<-B
     C     WSKTB         ANDEQ     0
     C     WSKTC         ANDEQ     ' '
     C                   MOVE      ZEKTA         WSKTA
     C                   MOVE      ZEKTB         WSKTB
     C                   MOVE      ZEKTC         WSKTC
     C                   END                                                     2<-E
     C     WSGN          IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEGN          WSGN
     C                   END                                                     2<-E
     C     WSFT1         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEFT1         WSFT1
     C                   END                                                     2<-E
     C     WSFT2         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEFT2         WSFT2
     C                   END                                                     2<-E
     C     WSFT3         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEFT3         WSFT3
     C                   END                                                     2<-E
     C     WSLS          IFEQ      *BLANKS                                       2<-B
     C     WSKDLS        ANDEQ     *BLANKS
     C                   MOVE      ZELS          WSLS
     C                   MOVE      ZEKDLS        WSKDLS
     C                   END                                                     2<-E
     C     WSPOS         IFEQ      *BLANKS                                       2<-B
     C                   MOVE      ZEPOS         WSPOS
     C                   END                                                     2<-E
     C                   END                                                    1<-E
     C     WSFTB         IFEQ      *BLANKS                                       2<-B
     C     WSLKB         ANDEQ     *BLANKS
     C                   MOVE      ZEFTB         WSFTB
     C                   MOVE      ZELKB         WSLKB
     C                   END                                                     2<-E
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     EXTREFK       KLIST
     C                   KFLD                    WSKODE            3
     C                   KFLD                    EXTREF
s05  C*                  MOVEL     '*CR'         WSKODE
n05  C                   MOVEL     '*CE'         WSKODE
     C     EXTREFK1      KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    WSKODE            3
     C     EXTREFK2      KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   KFLD                    WSKODE            3
     C     FRATXK        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYI            1
     C                   MOVE      'L'           DELSYI
     C     FRAT2K        KLIST
     C                   KFLD                    FXKNR
     C                   KFLD                    DELSYB            1
     C     ZAEHK         KLIST
     C                   KFLD                    HEUNIK
     C                   KFLD                    HEREFF
     C     SAEHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     SAEHKK        KLIST
     C                   KFLD                    KAVD
     C                   KFLD                    KTDN
     C     STANEK        KLIST
     C                   KFLD                    UAVD
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     ZEADFK        KLIST
     C                   KFLD                    UZAVD
     C                   KFLD                    UZTDN
     C     ZEAF1K        KLIST
     C                   KFLD                    UZREFF
     C                   KFLD                    UZUNIK
     C     BILLK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTSK        KLIST
     C                   KFLD                    XTSUNI
     C                   KFLD                    WSKDH
     C     KODLBK        KLIST
     C                   KFLD                    XLBUNI
     C                   KFLD                    WSLV
     C     KODSIK        KLIST
     C                   KFLD                    XSIUNI
     C                   KFLD                    WSSG
     C     KODVAK        KLIST
     C                   KFLD                    XVALKO
     C                   KFLD                    USEDT
N28  C     KODVAKFAK     KLIST
N28  C                   KFLD                    SFVK28
N28  C                   KFLD                    USEDT
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    XLANDK
     C     KODS4K        KLIST
     C                   KFLD                    XS4UNI
     C                   KFLD                    WSTRM
     C     KODS9K        KLIST
     C                   KFLD                    XS9UNI
     C                   KFLD                    WSDP
     C     TVINMK        KLIST
     C                   KFLD                    YST
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C     TVIM4K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C                   KFLD                    MAX0B
     C                   KFLD                    MAX0C
     C                   KFLD                    MAX0D
     C     TVI41K        KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    UAVD
     C                   KFLD                    WSTDN
     C*
     C     *LIKE         DEFINE    SETDN         UTDN
     C     *LIKE         DEFINE    SESG          USG
     C     *LIKE         DEFINE    SEWS          UWS
N15  C     *LIKE         DEFINE    WSVAL1        XXVAL1
N15  C     *LIKE         DEFINE    WSVKU         XXVKU
     C     *ENTRY        PLIST
     C                   PARM                    UAVD
     C     WSTDN         PARM      WSTDN         UTDN
     C     WSSG          PARM                    USG
     C                   PARM                    UTYPE             3
     C     UWS2          PARM      UWS2          UWS
     C                   MOVE      *ZEROS        USEDT
     C                   MOVE      *ZEROS        SEAVD
     C                   MOVE      *ZEROS        SETDN
     C                   MOVE      *BLANKS       BLUR
     C                   MOVE      *BLANKS       WSTVIN
     C                   MOVE      '0'           UIN28
     C                   MOVE      '0'           UIN34
     C                   MOVE      '0'           UIN36
     C                   MOVE      *ZEROS        SEBEL1
     C                   MOVE      *ZEROS        SEVKB
     C                   MOVE      *ZEROS        SEDP
     C                   MOVE      *ZEROS        SEKNK
     C                   MOVE      *ZEROS        SETST
     C                   MOVE      *BLANKS       XPRE
     C                   MOVE      *ZEROS        HEUNIK
     C                   MOVE      *BLANKS       HEREFF
     C                   MOVE      *ZEROS        U2VSUM
     C                   MOVE      *ZEROS        UDIFF
N32  C                   MOVE      *ZEROS        U2VKB
N32  C                   MOVE      *ZEROS        UVDIF
     C                   MOVE      *ZEROS        U2LI
      *
     C     'TVI00004'    CHAIN     SYPTFF                             33
     C   33              MOVE      *ZEROS        PTFDT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C     UTYPE         IFEQ      'PRT'
     C     SAEHK         CHAIN     SAEH                               31
     C  N31              DO
     C                   MOVE      UWS           SEWS
     C                   MOVE      'K'           SEST
     C                   UPDATE    SAEHR
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C                   END
     C     UTYPE         COMP      'CHG'                                  31
N20  C  N31UTYPE         COMP      'OMB'                                  31
     C     UTYPE         COMP      'CHG'                                  32
N20  C  N32UTYPE         COMP      'OMB'                                  32
     C  N32UTYPE         COMP      'CPY'                                  32
     C     UTYPE         IFEQ      'CPY'
     C                   MOVE      UAVD          KAVD              4 0
     C                   MOVE      WSTDN         KTDN              7 0
     C                   MOVE      *ZEROS        WSTDN
     C                   END
      *
     C*
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      *ZEROS        KUNDNR            8 0
     C                   MOVE      'TST'         XTSUNI            3
     C                   MOVE      'LB'          XLBUNI            2
     C                   MOVE      'SI'          XSIUNI            2
     C                   MOVE      *BLANKS       XVALKO            3
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      *BLANKS       XLANDK            2
     C                   MOVE      'S4 '         XS4UNI            3
     C                   MOVE      'S9 '         XS9UNI            3
     C                   MOVE      ' '           YST               1
     C                   MOVE      '99999999'    MAX0B             8 0
     C                   MOVE      '999999'      MAX0C             6 0
     C                   MOVE      '99'          MAX0D             2 0
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      'N'           USPED             1
     C                   MOVE      *ZEROS        WSFT3
     C                   MOVE      *ZEROS        WSFID
     C                   MOVE      *ZEROS        SEFID
     C                   MOVE      *ZEROS        USEDT
     C*
     C*** AVSENDER-/UTFØRSELSLAND
     C*
S02  C*                  Z-ADD     3             SOANTK            1 0
S02  C*                  MOVE      'AVSENDER'    SOTXT1            8
S02  C*                  MOVE      'MOTTAKER'    SOTXT2            8
S02  C*                  MOVE      *BLANKS       SOTXT3            8
S02  C*                  MOVE      *BLANKS       SOTXT4            8
S02  C*                  MOVE      *BLANKS       SOTXT5            8
S02  C*                  MOVE      *BLANKS       SOTXT6            8
S02  C*                  MOVE      *BLANKS       SOTXT7            8
S02  C*                  MOVE      *BLANKS       SOTXT8            8
S02  C*                  MOVE      *ZEROS        SOKNR3            8 0
S02  C*                  MOVE      *ZEROS        SOKNR4            8 0
S02  C*                  MOVE      *ZEROS        SOKNR5            8 0
S02  C*                  MOVE      *ZEROS        SOKNR6            8 0
S02  C*                  MOVE      *ZEROS        SOKNR7            8 0
S02  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C     *LIKE         DEFINE    *IN12         WIN03
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C                   EXSR      UTCMDL
     C     FIURBE        IFEQ      'J'
     C     FIURBL        OREQ      'J'
     C                   MOVE      'G'           WSUR
     C                   END
     C     UAVD          CHAIN(N)  STANDE                             33
      * WSTOLK = J BETYR TVINN
      * WSTVIN = J BETYR SKRIVES NÅ
     C     SETOLK        IFEQ      'J'
     C                   MOVE      'J'           WSTOLK
     C     S0035         IFEQ      '2'
     C                   MOVE      'J'           WSTVIN
     C                   ELSE
     C                   MOVE      'N'           WSTVIN
     C                   END
     C                   ELSE
     C                   MOVE      'N'           WSTOLK
     C                   MOVE      'J'           WSTVIN
     C                   END
     C     HEADFK        SETLL     HEADF
     C                   READ      HEADF                                  36
     C                   MOVE      *IN36         UIN36             1
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C*
      *
      * henteventuell externrefkode
      *
     C     EXTREFK1      CHAIN(N)  frisok                             33
     C  N33              movel     fssok         EXTREF
     C  N33              movel     fssok         WSTREF
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     VISOPL        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
      * AVSENDER   ...
     C     POSNBR        IFGE      13
     C     POSNBR        ANDLE     20
     C     LINNBR        ANDEQ     2
     C     WSKNK         ANDGT     0
     C                   MOVE      WSKNK         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
      * MOTTAGER   ...
     C     WSKNS         IFGT      0
     C                   MOVE      WSKNS         XSKKNR
     C                   GOTO      STVISO
     C                   END
      *
      *
     C                   MOVE      'DIV1036'     MSGNR
     C                   SETON                                        30
     C                   GOTO      SLVISO
      *
     C     STVISO        TAG
     C                   MOVE      *ZEROS        UFLAGG
     C                   CALL      'FRITXTSK'
     C                   PARM                    FIFIRM
     C                   PARM                    XSKKNR            8 0
     C                   PARM                    XSKMOT            8
     C                   PARM                    UFLAGG
     C                   PARM                    DELSYI
      *
     C     SLVISO        ENDSR
      *
     C***********************************************
     C     TSTOPL        BEGSR
     C***********************************************
     C                   SETOFF                                       6162
      *** TEST OM SELGER OPPLYSNING. HVIS DET, SETT 61 PÅ
     C                   MOVE      WSKNS         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        61
      *
      *** TEST OM KJØPER OPPLYSNING. HVIS DET, SETT 62 PÅ
     C                   MOVE      WSKNK         FXKNR
     C     FRATXK        CHAIN     FRATXT                             33
     C   33FRAT2K        CHAIN     FRATXT                             33
     C  N33              SETON                                        62
      *
     C     seekst        comp      'R'                                6363
     C                   ENDSR
      *
     C***********************************************
     C     UTCMDL        BEGSR
     C***********************************************
     C     XCMD          IFEQ      0
     C                   MOVE      'DIV0032'     MSGLN1
     C   36              MOVE      'DIV0024'     MSGLN2
     C  N36              MOVE      'DIV0033'     MSGLN2
     C                   MOVE      'SHU0437'     MSGLN3
     C                   MOVE      'DIV0029'     MSGLN4
     C                   ADD       1             XCMD              2 0
     C                   ELSE
     C     XCMD          IFEQ      1
     C                   MOVE      'SHU0438'     MSGLN1
     C                   MOVE      'DIV0024'     MSGLN2
     C                   MOVE      'SHU0435'     MSGLN3
     C                   ADD       1             XCMD
     C                   ELSE
     C     XCMD          IFEQ      2
     C                   MOVE      'SHU0433'     MSGLN1
     C                   MOVE      'SHU0436'     MSGLN2
     C                   MOVE      'DIV0000'     MSGLN3
     C                   Z-ADD     0             XCMD
     C                   END
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
N20   ***********************************************
N20  C     OPNFIL        BEGSR
N20   ***********************************************
N20  C                   OPEN      SAEHOM
N20  C                   OPEN      KODTSO
N20   *
N20  C                   ENDSR
N20   *
N20   ***********************************************
N20  C     CLSFIL        BEGSR
N20   ***********************************************
N20  C                   CLOSE     SAEHOM
N20  C                   CLOSE     KODTSO
N20   *
N20  C                   ENDSR
N20   *
N23   ***********************************************
N23  C     HENTSADDT     BEGSR
N23   ***********************************************
N23   * HENT FORTOLLINGSDATO
N23  C                   EVAL      WSTDN = WSTDN * -1
N23  C                   EVAL      USEDT = SEDT
N23  C     TVIM4K        SETLL     EDIM4
N23  C     TVI41K        READPE    EDIM4                                  33
N23  C                   IF        *IN33
N23  C                   MOVE      *ZEROS        XAN02             2
N23  C                   IF        %SUBST(SEDTG:1:2) = '20'
N23  C                   EVAL      XAN02 = %SUBST(SEDTG:3:2)
N23  C                   MOVE      XAN02         UÅÅ
N23  C                   EVAL      XAN02 = %SUBST(SEDTG:7:2)
N23  C                   MOVE      XAN02         UMM
N23  C                   EVAL      XAN02 = %SUBST(SEDTG:9:2)
N23  C                   MOVE      XAN02         UDD
N23  C                   CALL      'TESTDATO'
N23  C                   PARM                    UDD
N23  C                   PARM                    UMM
N23  C                   PARM                    UÅÅ
N23  C                   PARM                    FLAGG             1 0
N23  C                   IF        FLAGG <> 1
N23  C                   MOVEL     SEDTG         USEDT
N23  C                   END
N23  C                   END
N23  C                   ELSE
N23  C                   DOW       *IN33 = *OFF
N23  C                   IF        M1N07 = 'DTK' OR M1N07 = 'DUA'
N23  C                   EVAL      USEDT = M0068A
N23  C                   LEAVE
N23  C                   END
N23  C     TVI41K        READPE    EDIM4                                  33
N23  C                   ENDDO
N23  C                   END
N23   *
N23  C                   EVAL      WSTDN = WSTDN * -1
N23   *
N23  C                   ENDSR
N23   *
