********************************************************************
      * Vis EN turs Header - Transportmodul                        *
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 JOV PTF10 Vis simulert LM/M3  ...
10XXX * 02 YBC PTF10 RETTELSE ETTER UTVIDELSE AV OPPDRAGSNR
      * 03 JOV PTF10 JUSTERING AVREGNING VISES (UNDER ANNET) (dds=vis THFAKT)
      * 04 jov PTF10 -rettelse ptf01 (ødelagte KODTA-KEY )
      * 05 sh  PTF10 oppdater HEKNT
      * 06 JOV PTF10 oppdater HEKNT skal være TRANSP.nr
      * 07 sh  PTF10 tar med kostnad ferje som ikke skal faktureres
10XXX * 08 sh  PTF10 track and trace på turnivå
10XXX * 09 JOV PTF10 vis PDA-status
10227 * 10 JOV PTF10 TILLAT KORTDATO
10261 * 11 YBC PTF10 VEKT/KUBIKK/KOLLI I TURER ER ENDRET TIL 9.0, 7.3 OG 7.0
10261 * 12 SH  PTF11 F19 print skilleark
10261 * 13 SH  PTF11 vet mottar regning ikke avregnet kollonne
10261 * 14 SH  PTF11 bringtms summere helmla/hepoen  - BRINGTMS-prosjekt.
10261 * 15 SH  PTF11 HENTE BUDSJETT / INNT
10261 * 16 SH  PTF11 alltid beregne avregning
10261 * 17 JOV PTF11 FØLFGEFEIL AV 16 - THTOT ER AVR-SUM KUN NÅR OVERFØRT
10261 * 18 SH  PTF11 tatt bort tollsted
10261 * 19 SH  PTF11 kilometerpris innført
10261 * 20 SH  PTF11 kilometerpris innført også for innland/eksport
********************************************************************
n08  FTRACKF    O  A E           K DISK
     FAVSLUTL2  IF   E           K DISK
     FVALUL01   IF   E           K DISK
     FKODTÅ     IF   E           K DISK
     FKODTA     IF   E           K DISK
N01  FKODTV     IF   E           K DISK
     FTURER     UF A E           K DISK
     FTILL      IF A E           K DISK
     FKOSTT     UF   E           K DISK
     FKOSBU     UF A E           K DISK
     FKOSBU2    IF   E           K DISK
     F                                     RENAME(KOSBUR:KOSB2R)
     FKOSBU9    UF   E           K DISK
     F                                     RENAME(KOSBUR:KOSB9R)
     FHEAD11    UF   E           K DISK
     F                                     RENAME(HEADFR:HEA11R)
     FHEADF     UF   E           K DISK
     FDISP      UF   E           K DISK
     FFAK2      IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTGE    IF   E           K DISK
     FDRIV      IF   E           K DISK
     FUNITL01   UF   E           K DISK
     FUNIT      IF   E           K DISK
     F                                     RENAME(UNITR:UNITPFR)
     FKODTAG    IF   E           K DISK
     FTELL      UF   E           K DISK
     FTELLRU    UF   E           K DISK
     FTRAN      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FSTED2D    IF   E           K DISK
     F                                     RENAME(STED2R:STEDDR)
     FTRAVH1    IF   E           K DISK
     FBILK      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FUNITFX1   IF   E           K DISK
     FSYTR88FA  CF   E             WORKSTN
     F                                     INFDS(FBAREA)
N08  D                SDS
N08  D  UUSR                 254    263
n08  D                 DS
n08  D  XULTID                 1     14  0
n08  D  XULTM                  1      6  0
n08  D  XULDD                  7      8  0
n08  D  XULMM                  9     10  0
n08  D  XULÅÅ                 11     14  0
n08  D                 DS
n08  D  ULÅÅ                   1      4  0
n08  D  ULMM                   5      6  0
n08  D  ULDD                   7      8  0
n08  D  ULDT                   1      8  0
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  TUDTÅ                  1      4  0
     D  TUDTM                  5      6  0
     D  TUDTD                  7      8  0
     D  TUDT                   1      8  0
     D                 DS
     D  WSDTDT                 1      2  0
     D  WSDTMT                 3      4  0
     D  WSDTÅT                 5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  TUDTÅT                 1      4  0
     D  TUDTMT                 5      6  0
     D  TUDTDT                 7      8  0
     D  TUDTT                  1      8  0
     D                 DS
     D  WSRCÅ                  1      4  0
     D  WSRACC                 1      2  0
     D  WSRAAR                 3      4  0
     D                 DS
     D  IÅRCÅ                  1      4  0
     D  IÅRCC                  1      2  0
     D  IÅRAAR                 3      4  0
     D                 DS
     D  FRAAAR                 1      4  0
     D  FRAMND                 5      6  0
     D  FRADAG                 7      8  0
     D  FRADAT                 1      8  0
     D                 DS
     D  TILAAR                 1      4  0
     D  TILMND                 5      6  0
     D  TILDAG                 7      8  0
     D  TILDAT                 1      8  0
     D                 DS
     D  DIDATF                 1      8  0
     D  DIFAAR                 1      4  0
     D  DIFMND                 5      6  0
     D  DIFDAG                 7      8  0
     D  DITIMF                 9     12  0
     D  DIFRA                  1     12  0
     D                 DS
     D  DIDATT                 1      8  0
     D  DITAAR                 1      4  0
     D  DITMND                 5      6  0
     D  DITDAG                 7      8  0
     D  DITIMT                 9     12  0
     D  DITIL                  1     12  0
     D                 DS
     D  MINDT                  1     12  0
     D  MINDAT                 1      8  0
     D  MINAAR                 1      4  0
     D  MINMND                 5      6  0
     D  MINDAG                 7      8  0
     D  MINTIM                 9     12  0
     D  MINSTE                13     17
     D  MINLK                 18     19
     D                 DS
     D  MAXDT                  1     12  0
     D  MAXDAT                 1      8  0
     D  MAXAAR                 1      4  0
     D  MAXMND                 5      6  0
     D  MAXDAG                 7      8  0
     D  MAXTIM                 9     12  0
     D  MAXSTE                13     17
     D  MAXLK                 18     19
     D                 DS
     D  DSTXT                  1     35
     D  DSTXTA                 1     10
     D  TUSTEF                11     15
     D  DSTXTB                17     17
     D  TUSTET                19     23
     D  TUNAT                 25     54
     D                 DS
     D  FAVT                   1     20
     D  FAVTX                  1     19
     D  FAVTXX                13     15
      * PARAMETERSTRENG FOR KALL PÅ SYKS12
     D                 DS
     D  P1DS                   1    256
     D  P1FLAG                 1      1
     D  P1BNR                  2      8  0
     D  P1AVD                  9     12  0
     D  P1TUNR                13     20  0
     D  P1OAVD                21     24  0
     D  P1OPD                 25     31  0
     D  P1BL                  32     44  2
     D                 DS
     D  UNRETU                 1     30
     D  UNPDA                  1      4
     D  UNSJNR                 5     12
     D                UDS
     D  UUSIGN                19     21
      *
     D AVRTXT          C                   CONST('AVREGNING HOVEDTRANS')
     D AVRTXD          C                   CONST('*AVR*DIREKTE KOSTN. ')
     D AVRTXF          C                   CONST('*AVF*FORDELT KOSTN. ')
     D AVRTGD          C                   CONST('*AGD*GODSKR DIREKTE ')
     D AVRTGF          C                   CONST('*AGF*GODSKR FORDELT ')
      *
     C     STARIN        TAG
     C                   EXSR      INIT
      * simuler alltid avregning
N16  C     uavd          ifne      0
n16  C     upro          andne     0
n16  C                   MOVE      'N'           XXVIS             1
n16  C                   EXSR      BEREGNA
n16  c                   end
      *
     C     START         TAG
     C                   EXSR      KDTFMT
     C     WSKVKT        ADD       WSTARA        WSTOV1
     C     TUTVKT        ADD       WSTARA        WSTOV2
     C                   EXSR      TSTMOB
     C                   EXFMT     BILDE
     C                   EXSR      KDTFMT
     C                   SETOFF                                       2930
     C                   MOVEA     '0000'        *IN(96)
     C                   MOVEA     '00000000'    *IN(70)
     C                   MOVEA     '00000'       *IN(79)
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
      *
     C   12              DO
     C     UPRO          IFNE      *ZEROS
     C     URUND         ANDNE     *ZEROS
     C                   EXSR      OPDTUR
     C                   END
     C                   Z-ADD     1             UFLAGG
     C                   GOTO      SLUTT
     C                   END
      *
      * 13 = MINUMUM
      *
     C   13MINDAT        IFNE      99999999
     C                   MOVE      MINDAG        WSDTD
     C                   MOVE      MINMND        WSDTM
     C                   MOVE      MINAAR        WSDTÅ
     C                   MOVE      MINTIM        WSTM
     C                   MOVE      MINSTE        WSSTEF
     C                   MOVE      MINLK         WSLKFR
     C                   MOVE      *BLANKS       WSSDF
     C                   EXSR      TSTSTF
     C                   GOTO      START
     C                   END
      *
      *
      * 14 = MAXIMUM
      *
     C   14MAXDAT        IFNE      *ZEROS
     C                   MOVE      MAXDAG        WSDTDT
     C                   MOVE      MAXMND        WSDTMT
     C                   MOVE      MAXAAR        WSDTÅT
     C                   MOVE      MAXTIM        WSTMT
     C                   MOVE      MAXSTE        WSSTET
     C                   MOVE      MAXLK         WSLKTO
     C                   MOVE      *BLANKS       WSSDT
     C                   EXSR      TSTSTT
     C                   GOTO      START
     C                   END
      *
      * SØK
      *
     C   04              DO
     C                   SETON                                        29
     C                   EXSR      SØKDTA
     C                   MOVEA     '0000'        *IN(96)
     C                   MOVEA     '00000000'    *IN(70)
     C                   MOVEA     '00000'       *IN(79)
     C                   GOTO      START
     C                   END
      *
      * Print skilleark F19
      *
n12  C   19              DO
n12  C                   EXSR      PRTSKILL
n12  C                   GOTO      START
n12  C                   END
      *
      *
      * SE ANDRE CMD-TASTER
      *
     C   24              DO
     C                   EXSR      UTCMDL
     C                   GOTO      START
     C                   END
      *
      * BEKREFTE REDIGERING AV RUNDTUR
      *
     C   23              DO
     C     F11           IFEQ      'J'
     C                   EXSR      NYRUND
     C                   END
     C     F15           IFEQ      'J'
     C     GMRUND        ANDNE     *ZEROS
     C                   MOVE      GMRUND        URUND
     C                   END
     C                   END
     C                   MOVE      'N'           F11               1
     C                   MOVE      'N'           F15               1
      *
      * FOR FØLGENDE TESTER MÅ TUR/RUNDTUR VÆRE TILDELT
      *
     C     UPRO          IFNE      *ZEROS
     C     URUND         ANDNE     *ZEROS
      *
     C   07              DO
     C                   EXSR      OPDTUR
     C                   MOVE      'T'           P1FLAG
     C                   MOVE      *ZEROS        P1BNR
     C                   MOVE      UAVD          P1AVD
     C                   MOVE      UPRO          P1TUNR
     C                   MOVE      *ZEROS        P1OAVD
     C                   MOVE      *ZEROS        P1OPD
     C                   MOVE      *ZEROS        P1BL
     C                   MOVE      P1DS          PARM1           256
     C                   CALL      'SYKS12'
     C                   PARM                    PARM1
      * TRANSP-BELØP KAN VÆRE ENDRET
     C     TURERK        CHAIN(N)  TURER                              33
     C     *IN33         IFEQ      '0'
     C                   MOVE      TUTVAL        WSTVAL
     C                   MOVE      TUTAKO        WSTAKO
     C                   MOVE      TUTBEL        WSTBEL
     C                   END
     C                   GOTO      START
     C                   END
      *
     C   06              DO
     C                   MOVE      'N'           UKOST             1
     C                   CALL      'SYTR17'
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   PARM                    URUND
     C                   PARM                    UKOST
     C                   GOTO      START
     C                   END
      *
     C   08              DO
     C                   CALL      'SYTR07'
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   GOTO      START
     C                   END
      *
     C   09              DO
     C                   CALL      'SYTR08'
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   GOTO      START
     C                   END
      * SE / SIMULERE AVREGNING
     C   10              DO
     C                   MOVE      'J'           XXVIS             1
     C                   EXSR      BEREGNA
     C                   GOTO      START
     C                   END
      *
      * FRITEKSTER
     C   18              DO
     C                   Z-ADD     0             UFLAGG
     C                   CALL      'SYTR31'
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   PARM                    UFLAGG            1 0
     C                   GOTO      START
     C                   END
      *
     C                   END
      *
     C   06
     COR 07
     COR 08
     COR 09
     COR 18
     COR 10              DO
     C                   MOVE      'DIV4030'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
      *
     C  N27              DO
      *
      * UTFØR EVT. PRISKONSTRUKSJON
      *
     C                   EXSR      PRIKON
     C                   EXSR      TESTB
     C   30              GOTO      START
      *
      * F15 = HENT BILENS RUNDTUR  82=RUNDTUR=0
      *
     C   15              DO
      *
      *
     C     GMRUND        IFNE      *ZEROS
     C                   MOVE      'DIV4032'     MSGNR
     C                   SETON                                        3082
     C                   MOVE      'J'           F15               1
     C                   MOVE      ' '           F11
     C                   GOTO      START
     C                   ELSE
     C                   MOVE      'DIV4029'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
     C                   END
      *
      * F11 = NY RUNDTUR PÅ BIL
      *
     C   11              DO
     C     Innlan        Ifeq      'J'
     C                   EXSR      NYRUND
     C                   else
     C                   MOVE      'DIV4031'     MSGNR
     C                   SETON                                        3082
     C                   MOVE      'J'           F11
     C                   MOVE      ' '           F15               1
     C                   GOTO      START
     C                   end
     C                   END
      *
     C     URUND         IFEQ      *ZEROS
     C                   MOVE      'DIV3808'     MSGNR
     C                   SETON                                        30
     C                   GOTO      START
     C                   END
      *
     C  N30              EXSR      OPDTUR
     C                   END
      *
      * SLUTT TESTER VED VEDLIKEHOLD N27
      *
     C  N05
     CANN03              GOTO      START
     C   03              Z-ADD     3             UFLAGG
     C  N03              EXSR      TILTUR
     C  N03              EXSR      SUMFRA
     C  N01
     CANN03              GOTO      STARIN
      *
     C     SLUTT         TAG
      *** VED VEDLIKEHOLD OPPDATERER STATUS PÅ TUR.
     C     *IN27         IFEQ      *OFF                                         B1
     C     TURERK        CHAIN     TURER                              33
     C                   MOVE      XST           TUST
     C  N33              UPDATE    TURERR
     C                   ELSE                                                   X1
      * OGSÅ NÅR USPØR=J KAN BELØP TIL TRANSP VÆRE ENDRET,
      * MEN KUN DA NÅR IKKE ALLEREDE AVREGNET
      * VED TRANSP. SOM SENDER FAKTURA. LEGG ALLTID UT I KOSBU.
     C     *IN32         IFEQ      *OFF                                          B2
     C     WSTBEL        ANDNE     TUTBEL
     C     WSTVAL        IFEQ      *BLANKS                                        B3
     C                   MOVE      FICURR        WSTVAL
     C                   END                                                      E3
     C     WSTAKO        IFEQ      *BLANKS                                        B3
     C                   MOVE      'A'           WSTAKO
     C                   END                                                      E3
     C     TURERK        CHAIN     TURER                              33
     C                   MOVE      WSTVAL        TUTVAL
     C                   MOVE      WSTAKO        TUTAKO
     C                   Z-ADD     WSTBEL        TUTBEL
     C  N33              UPDATE    TURERR
     C     VMINCR        IFEQ      1                                              B3
     C     VMINCR        OREQ      3                                              B3
     C                   EXSR      KOST
     C                   ELSE                                                     X3
      *
      * BYTTET TIL EN SOM AVREGNES?-SLETT EVT. TIDLIGERE UTLAGT I KOSBU
      *
     C     TUTREF        IFNE      *ZEROS                                          B4
     C                   Z-ADD     TUTREF        KTNR
     C     KTNR          CHAIN     KOSBU                              34
     C  N34              DELETE    KOSBUR
     C                   MOVE      *ZEROS        TUTREF
     C                   END                                                       E4
     C                   END                                                      E3
     C                   END                                                     E2
     C                   END                                                    E1
      *
     C     UPRO          IFEQ      *ZEROS
     C                   MOVE      *ZEROS        URUND
     C                   END
     C                   SETON                                        LR
      ******************************************
     C     TESTB         BEGSR
      ******************************************
     C     WSAVD         IFEQ      0
     C                   MOVE      UAVD          WSAVD
     C                   ELSE
     C     KODTAK        CHAIN     KODTA                              33
     C  N33              MOVE      WSAVD         UAVD
     C   33              MOVE      UAVD          WSAVD
     C     *IN33         IFEQ      '0'
     C     KOAIE         IFEQ      '1'
     C     KOAIE         OREQ      '2'
     C     KOAIE         OREQ      '3'
     C                   MOVE      'J'           INNLAN
     C                   ELSE
     C                   MOVE      'N'           INNLAN
     C                   END
     C                   END
     C                   END
      * TESTER PERIODE  (26 ON=STATUS ULIK ' ' - PROTECT/IKKE TEST)
     C     *IN26         IFEQ      *OFF
     C     WSRMND        IFLT      1
     C     WSRMND        ORGT      12
     C                   SETON                                        74
     C                   END
      *
     C  N74WSRAAR        IFGT      50
     C                   MOVE      19            WSRACC
     C                   ELSE
     C                   MOVE      20            WSRACC
     C                   END
     C     WSRCÅ         SUB       IÅRCÅ         DIFFYE            4 0
     C     DIFFYE        IFLT      -1
     C     DIFFYE        ORGT      1
     C                   SETON                                        74
     C                   END
      *--------------------------------------------------------------
      * DEFINERER NØKKEL TIL KODTÅ   ÅPNE PERIODER
      *--------------------------------------------------------------
     C     KODÅKE        KLIST
     C                   KFLD                    KOÅUNI
     C                   KFLD                    WSRACC
     C                   KFLD                    WSRAAR
     C                   KFLD                    WSRMND
     C                   MOVE      'Å'           KOÅUNI            1
     C   74              MOVE      'SPP0027'     MSGNR
     C  N74              DO
     C     KODÅKE        CHAIN     KODTÅ                              74
     C   74              MOVE      'SPP0001'     MSGNR
     C                   END
     C   74              Z-ADD     3             LINNBR
     C   74              Z-ADD     18            POSNBR
     C   74              SETON                                        30
     C                   END
      *
      * TESTER BILNUMMER
      *
     C     WSBILN        CHAIN     UNITL01                            76
N20  C     *in76         IFEQ      '0'
     C                   UPDATE    UNITR
     C                   MOVE      UNHØYD        WSHØYB
     C                   MOVE      UNTRME        WSBILK
      *
N20   *test type  sending
      *
N20  C                   exsr      testie
      * import
N20  C     TYPES         ifeq      '*IMP'
N19  C     unkmp         andne     0
N19  C                   MOVE      UNKMP         WSANT2
N19  C                   MOVE      UNVAL         WSTVAL
N19  C                   EVAL      WSENH1 = 'KM'
N19  C                   END
      * eksport
N20  C     TYPES         ifeq      '*EKS'
N19  C     unkmpe        andne     0
N19  C                   MOVE      UNKMPE        WSANT2
N19  C                   MOVE      UNVALE        WSTVAL
N19  C                   EVAL      WSENH1 = 'KM'
N19  C                   END
      * innland
N20  C     TYPES         ifeq      '*INN'
N19  C     unkmpi        andne     0
N19  C                   MOVE      UNKMPI        WSANT2
N19  C                   MOVE      UNVALI        WSTVAL
N19  C                   EVAL      WSENH1 = 'KM'
N19  C                   END
N20  C                   END
     C     WSTRMA        IFEQ      0
     C  N76              MOVE      UNTRMA        WSTRMA
     C                   END
     C  N76WSKNT2        IFEQ      *ZEROS
     C                   MOVE      UNTRAN        WSKNT2
     C                   END
     C     *IN76         IFEQ      *OFF
     C     UNPDA         IFEQ      'PDA:'
     C     UNSJNR        ANDGT     '00000000'
     C     UNSJNR        ANDLT     '99999999'
     C     WSSJN1        ANDEQ     *blanks
     C                   move      UNSJNR        WSSJA1
     C                   END
     C                   END
     C  N76              MOVE      UNLAND        WSLK
     C  N76              MOVE      UNRUND        GMRUND            8 0
      * FLYTTER OVER TILHENGER
     C  N76UNTILH        IFNE      *BLANKS
     C     WSHENG        ANDEQ     *BLANKS
     C                   MOVE      UNTILH        WSHENG
     C                   END
      * LEGGER OVER KAPASITETER
     C  N76              DO
     C                   Z-ADD     UNTARA        WSTARA
     C                   Z-ADD     UNVEKT        WSKVKT
     C     WSTARA        ADD       WSKVKT        WSTOV1
     C                   Z-ADD     UNM3          WSKAM3
     C                   Z-ADD     UNLM          WSKALM
     C                   END
      * LEGGER OVER HENGER
     C     WSHENG        CHAIN     UNITL01                            33
     C  N33              UPDATE    UNITR
     C  N33              MOVE      UNHØYD        WSHØYH
     C  N33
     CANN76              DO
     C                   ADD       UNTARA        WSTARA
     C                   ADD       UNVEKT        WSKVKT
     C                   ADD       UNTARA        WSTOV1
     C                   ADD       UNVEKT        WSTOV1
     C                   ADD       UNM3          WSKAM3
     C                   ADD       UNLM          WSKALM
     C                   MOVE      UNLAND        WSLKH
      * "HENGER" ER STEDSKODE BETYR AT DET ER RUTENR DISTRIBUSJON.
      * LEGG RUTE I FRA/TIL STEDSKODE, DAGENS DATO I FRA/TIL DATO
     C                   MOVEL     WSHENG        ST2KOD
     C     ST2KOD        CHAIN     STED2                              33
     C     *IN33         IFEQ      '0'                                           HENGER=RUTE
     C     WSSTEF        IFEQ      *BLANKS
     C                   MOVE      ST2KOD        WSSTEF
     C                   MOVE      ST2LK         WSLKFR
     C                   END
     C     WSSTET        IFEQ      *BLANKS
     C                   MOVE      ST2KOD        WSSTET
     C                   MOVE      ST2LK         WSLKTO
     C                   END
     C     WSDT          IFEQ      *ZEROS
     C                   MOVE      IDAG          WSDT
     C                   END
     C     WSDTT         IFEQ      *ZEROS
     C                   MOVE      IDAG          WSDTT
     C                   END
     C                   END
     C                   END
     C     WSBILN        COMP      *BLANKS                                76
     C   76
     CANN30              MOVE      'SPB0009'     MSGNR
     C   76
     CANN30              Z-ADD     4             LINNBR
     C   76
     CANN30              Z-ADD     18            POSNBR
     C   76              SETON                                        30
      *
      *** TEST LANDKODE BIL
      *
     C                   MOVE      'LK '         XLKUNI            3
     C     KODLKK        KLIST
     C                   KFLD                    XLKUNI
     C                   KFLD                    XLK               2
     C                   MOVE      WSLK          XLK
     C     KODLKK        CHAIN     KODTLKR                            77
     C   77
     CANN30              MOVE      'SPL0001'     MSGNR
     C   77
     CANN30              Z-ADD     4             LINNBR
     C   77
     CANN30              Z-ADD     29            POSNBR
     C   77              SETON                                        30
      *
      *
      *** TEST LANDKODE HENGER
      *
     C     WSHENG        IFNE      *BLANKS
     C     WSLKH         IFEQ      *BLANKS
     C                   MOVE      WSLK          WSLKH
     C                   END
     C                   MOVE      WSLKH         XLK
     C     KODLKK        CHAIN     KODTLKR                            78
     C   78
     CANN30              MOVE      'SPL0001'     MSGNR
     C   78
     CANN30              Z-ADD     4             LINNBR
     C   78
     CANN30              Z-ADD     43            POSNBR
     C   78              SETON                                        30
     C                   END
      *
      *          TESTER BILKODE
      * GJØRES NOE SENERE DA DENNE HENTES FRA BIL
      *
     C     WSBILK        CHAIN     BILK                               83
     C   83
     CANN30              Z-ADD     3             LINNBR
     C   83
     CANN30              Z-ADD     40            POSNBR
     C   83
     CANN30              MOVE      'DIV4014'     MSGNR
     C   83              SETON                                        30
      *
      *
      * TEST TRANSPORTØR
      *
      * FLYTTET SOM EGEN SR
     C                   EXSR      TSTTRA
      *
      *  TEST SJÅFØR 1
      *
     C     WSSJA1        IFNE      *ZEROS
     C     WSSJA1        CHAIN     DRIV                               70
     C  N70              MOVE      DRNAVN        WSSJN1
     C                   ELSE
     C     VMINCR        IFEQ      2
     C     WSSJN1        COMP      *BLANKS                                70
     C                   END
     C                   END
     C   70
     CANN30              MOVE      'SPD0020'     MSGNR
     C   70
     CANN30              Z-ADD     7             LINNBR
     C   70
     CANN30              Z-ADD     18            POSNBR
     C   70              SETON                                        30
      *
      *  TEST SJÅFØR 2
      *
     C     WSSJA2        IFNE      *ZEROS
     C     WSSJA2        CHAIN     DRIV                               71
     C  N71              MOVE      DRNAVN        WSSJN2
     C                   END
     C   71
     CANN30              MOVE      'SPD0021'     MSGNR
     C   71
     CANN30              Z-ADD     7             LINNBR
     C   71
     CANN30              Z-ADD     18            POSNBR
     C   71              SETON                                        30
      *
      *** TEST DATO  FRA
      *
N10  C                   IF        WSDT >0 AND WSDT <= 9999
N10  C                   MOVE      WSDT          TSTDAT            6 0
N10  C                   CALL      'TESTDATK'
N10  C                   PARM                    TSTDAT
N10  C                   MOVE      TSTDAT        WSDT
N10  C                   ENDIF
     C                   MOVE      WSDTÅ         UÅÅ               2 0
     C                   MOVE      WSDTM         UMM               2 0
     C                   MOVE      WSDTD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      UDD           FRADAG
     C                   MOVE      UMM           FRAMND
     C     WSDT          IFNE      *ZEROS
     C     UÅÅ           IFGT      50
     C     UÅÅ           ADD       1900          FRAAAR
     C                   ELSE
     C     UÅÅ           ADD       2000          FRAAAR
     C                   END
     C                   END
     C     UFLAGG        COMP      1                                      99
      * GODTAR 0 VED NY TUR
     C   99FRADAT        IFEQ      *ZEROS
     C     TUAO          COMP      *ZEROS                             9999
     C   99INNLAN        COMP      'J'                                9999
     C                   END
     C   99
     CANN30              MOVE      'SPD0001'     MSGNR
     C   99
     CANN30              Z-ADD     10            LINNBR
     C   99
     CANN30              Z-ADD     18            POSNBR
     C   99              SETON                                        30
     C                   EXSR      TSTSTF
      *** TEST DATO  TIL
N10  C                   IF        WSDTT>0 AND WSDTT<= 9999
N10  C                   MOVE      WSDTT         TSTDAT            6 0
N10  C                   CALL      'TESTDATK'
N10  C                   PARM                    TSTDAT
N10  C                   MOVE      TSTDAT        WSDTT
N10  C                   ENDIF
     C                   MOVE      WSDTÅT        UÅÅ               2 0
     C                   MOVE      WSDTMT        UMM               2 0
     C                   MOVE      WSDTDT        UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      UDD           TILDAG
     C                   MOVE      UMM           TILMND
     C     WSDTT         IFNE      *ZEROS
     C     UÅÅ           IFGT      50
     C     UÅÅ           ADD       1900          TILAAR
     C                   ELSE
     C     UÅÅ           ADD       2000          TILAAR
     C                   END
     C                   END
     C     UFLAGG        COMP      1                                      75
     C   75TILDAT        IFEQ      *ZEROS
     C     TUAO          COMP      *ZEROS                             7575
     C   75INNLAN        COMP      'J'                                7575
     C                   END
     C   75
     CANN30              MOVE      'SPD0001'     MSGNR
      *
      * FRADAT IKKE STØRRE ENN TILDAT
      *
     C  N75
     CANN99              DO
     C     FRADAT        COMP      TILDAT                             75
     C   75
     CANN30              MOVE      'SPD0002'     MSGNR
     C                   END
     C   75
     CANN30              Z-ADD     11            LINNBR
     C   75
     CANN30              Z-ADD     18            POSNBR
     C   75              SETON                                        30
      *
     C                   EXSR      TSTSTT
      * TESTER VALUTAKODE
      *
     C     WSTBEL        IFNE      *ZEROS
      *
     C     WSTVAL        IFEQ      *BLANKS
     C                   MOVE      FICURR        WSTVAL
     C                   END
      *
     C     WSTAKO        IFEQ      *BLANKS
     C                   MOVE      'A'           WSTAKO
     C                   END
      *
     C     VALKEY        CHAIN     VALUL01                            80
     C   80
     CANN30              MOVE      'SPV0001'     MSGNR
     C   80
     CANN30              Z-ADD     13            LINNBR
     C   80
     CANN30              Z-ADD     18            POSNBR
     C   80              SETON                                        30
      *
     C     WSTAKO        IFNE      'A'
     C     WSTAKO        IFNE      'E'
     C                   SETON                                          79
     C   79
     CANN30              MOVE      'SPB0010'     MSGNR
     C   79
     CANN30              Z-ADD     13            LINNBR
     C   79
     CANN30              Z-ADD     22            POSNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     C                   END
      * SLUTT VALUTATEST
      *
      * AVD.(ELLER AVD-ZERO) MÅ HA TELLEVERK FOR TUR
     C  N30UPRO          IFEQ      *ZEROS
     C     WSAVD         CHAIN(N)  TELL                               30
     C   30AVDZER        CHAIN(N)  TELL                               30
     C   30              MOVE      'JOV1079'     MSGNR
     C   30              Z-ADD     3             LINNBR
     C   30              Z-ADD     18            POSNBR
     C                   END
      * AVD.(ELLER AVD-ZERO) MÅ HA TELLEVERK FOR RUNDTUR
     C  N30URUND         IFEQ      *ZEROS
     C     WSAVD         CHAIN(N)  TELLRU                             30
     C   30AVDZER        CHAIN(N)  TELLRU                             30
     C   30              MOVE      'JOV1080'     MSGNR
     C   30              Z-ADD     3             LINNBR
     C   30              Z-ADD     18            POSNBR
     C                   END
      *
     C  N30URUND         IFEQ      *ZEROS
     C                   SETON                                            82
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   END
     C                   ENDSR
      ***********************************************
     C     TSTTRA        BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       WSAD1T           30
     C                   MOVE      *BLANKS       WSAD2T           30
     C                   MOVE      *BLANKS       WSAD3T           30
     C                   MOVE      WSKNT2        KUNDNR
     C     KUND1K        CHAIN     TRAN                               97
     C  N97              DO
N01  C                   select
N01  c     VMINCR        wheneq    0
N01  c                   eval      TRTYPE='Provisjonsavregning '
N01  c     VMINCR        wheneq    1
N01  c                   eval      TRTYPE='Sender faktura      '
N01  c     VMINCR        wheneq    2
N01  c                   eval      TRTYPE='Egen bil(ikke avr)  '
N01  c     VMINCR        wheneq    3
N01  c                   eval      TRTYPE='Sender fakt(iht avr)'
N01  c     VMINCR        wheneq    4
N01  c                   eval      TRTYPE='Avregn iht frakttab.'
N01  c     VMINCR        wheneq    5
N01  c                   eval      TRTYPE='Sender fakt(iht tab)'
N01  c                   endsl
     C                   MOVE      VMNAVN        WSNAT
      * HENT FULLSTENDIG NAVN/ADR VIA KUNDENR.
     C                   MOVE      VMTRKU        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            97
     C     *IN97         IFEQ      '0'
     C                   MOVE      ADR1          WSAD1T
     C                   MOVE      ADR2          WSAD2T
     C                   MOVE      *BLANKS       WSAD3T
     C     POSTNR        IFEQ      0
     C                   MOVEL     ADR3          WSAD3T
     C                   ELSE
     C                   MOVEL     POSTNR        WSAD3T
     C                   MOVE      ADR3          WSAD3T
     C                   END
     C                   END
     C                   END
     C   97
     CANN30              MOVE      'SPT0133'     MSGNR
     C     *IN97         IFEQ      '0'
      * SETT INDIKATOR FOR VISING PÅ BILDET
     C     VMTEXT        IFNE      *BLANKS
     C                   MOVE      '1'           *IN95
     C                   ELSE
     C                   MOVE      '0'           *IN95
     C                   END
      * FEILMELDING DERSOM STOPPKODE SATT
     C     VMSTOP        IFEQ      'J'
     C     VMSTOP        OREQ      'Y'
     C                   MOVE      '1'           *IN97
     C  N30              MOVE      'JOV0249'     MSGNR
     C                   END
     C                   END
     C   97
     CANN30              Z-ADD     6             LINNBR
     C   97
     CANN30              Z-ADD     18            POSNBR
     C   97              SETON                                        30
     C                   ENDSR
      ***********************************************
     C     TSTSTF        BEGSR
      ***********************************************
     c     Innlan        ifeq      'J'
     c     WSSTEF        andne     *blanks
     c     WSLKFR        andeq     *BLANKS
     c                   move      FILAND        WSLKFR
     c                   end
      * TEST/HENT STED FRA
     C     WSLKFR        IFEQ      *BLANKS
     C     WSSTEF        CHAIN     STED2                              72
     C  N72              MOVEL     ST2LK         WSLKFR
     C                   ELSE
     C     ST2DFK        CHAIN     STED2D                             72
     C                   END
      * GODTAR BLANKT STED VED NYTT OPPDRAG
     C   72WSSTEF        IFEQ      *BLANKS
     C     TUAO          COMP      *ZEROS                             7272
     C   72INNLAN        COMP      'J'                                7272
     C  N72              MOVE      *BLANKS       ST2NVN
     C  N72              MOVE      *BLANKS       ST2SOL
     C  N72              MOVE      *BLANKS       ST2LK
     C                   END
     C                   MOVE      *BLANKS       WSSDF
     C  N72              MOVEL     ST2NVN        WSSDF
     C  N72              MOVE      ST2SOL        WSSONF            5
     C  N72              MOVEL     ST2LK         WSSONF
     C   72
     CANN30              MOVE      'SPS0012'     MSGNR
     C   72
     CANN30              Z-ADD     10            LINNBR
     C   72
     CANN30              Z-ADD     46            POSNBR
     C   72              SETON                                        30
     C                   ENDSR
      ***********************************************
     C     TSTSTT        BEGSR
      ***********************************************
     c     Innlan        ifeq      'J'
     c     WSSTET        andne     *blanks
     c     WSLKTO        andeq     *BLANKS
     c                   move      FILAND        WSLKTO
     c                   end
      * TEST/HENT STED TIL
     C     WSLKTO        IFEQ      *BLANKS
     C     WSSTET        CHAIN     STED2                              73
     C  N73              MOVEL     ST2LK         WSLKTO
     C                   ELSE
     C     ST2DTK        CHAIN     STED2D                             73
     C                   END
     C   73WSSTET        IFEQ      *BLANKS
     C     TUAO          COMP      *ZEROS                             7373
     C   73INNLAN        COMP      'J'                                7373
     C  N73              MOVE      *BLANKS       ST2SOL
     C  N73              MOVE      *BLANKS       ST2NVN
     C  N73              MOVE      *BLANKS       ST2LK
     C                   END
     C                   MOVE      *BLANKS       WSSDT
     C  N73              MOVEL     ST2NVN        WSSDT
     C  N73              MOVE      ST2SOL        WSSONT            5
     C  N73              MOVEL     ST2LK         WSSONT
     C   73
     CANN30              MOVE      'SPS0013'     MSGNR
     C   73
     CANN30              Z-ADD     11            LINNBR
     C   73
     CANN30              Z-ADD     46            POSNBR
     C   73              SETON                                        30
     C                   ENDSR
      ***********************************************
     C     PRIKON        BEGSR
      ***********************************************
     C     WSTBEL        IFEQ      *ZEROS
     C     WSANT1        ANDNE     *ZEROS
     C     WSANT2        ANDNE     *ZEROS
     C     WSANT1        MULT      WSANT2        WSTBEL
     C                   MOVE      *ON           *IN30
     C                   ENDIF
     C                   ENDSR
      ***********************************************
     C     MOVTWS        BEGSR
      ***********************************************
     C     TURERK        CHAIN     TURER                              33
     C  N33              DO
     C                   MOVE      TUDTD         WSDTD
     C                   MOVE      TUDTM         WSDTM
     C                   MOVE      TUDTÅ         WSDTÅ
     C                   MOVE      TUKNT2        WSKNT2
     C                   MOVE      WSKNT2        KUNDNR
     C     KUND1K        CHAIN     TRAN                               97
N01  C     *IN97         IFEQ      '0'
N01  C                   select
N01  c     VMINCR        wheneq    0
N01  c                   eval      TRTYPE='Provisjonsavregning '
N01  c     VMINCR        wheneq    1
N01  c                   eval      TRTYPE='Sender faktura      '
N01  c     VMINCR        wheneq    2
N01  c                   eval      TRTYPE='Egen bil(ikke avr)  '
N01  c     VMINCR        wheneq    3
N01  c                   eval      TRTYPE='Sender fakt(iht avr)'
N01  c     VMINCR        wheneq    4
N01  c                   eval      TRTYPE='Avregn iht frakttab.'
N01  c     VMINCR        wheneq    5
N01  c                   eval      TRTYPE='Sender fakt(iht tab)'
N01  c                   endsl
N01  c                   end
     C     *IN97         IFEQ      '0'
     C     VMTEXT        ANDNE     *BLANKS
     C                   MOVE      '1'           *IN95
     C                   ELSE
     C                   MOVE      '0'           *IN95
     C                   END
     C                   MOVE      TUNAT         WSNAT
     C                   MOVE      TUAD1T        WSAD1T
     C                   MOVE      TUAD2T        WSAD2T
     C                   MOVE      TUAD3T        WSAD3T
     C                   MOVE      TUBILN        WSBILN
     C                   MOVE      TUBILN        GMBILN           10
     C                   MOVE      TULK          WSLK
     C                   MOVE      TUSDF         WSSDF
     C                   MOVE      TUSDT         WSSDT
     C                   MOVE      TUST          XST               1
     C                   MOVE      TURUND        URUND
     C                   MOVE      TURMND        WSRMND
     C                   MOVE      TURAAR        WSRAAR
     C                   MOVE      TURACC        WSRACC
     C                   MOVE      TUOPDT        WSOPDT
     C                   MOVE      TUHENG        WSHENG
     C                   MOVE      TUHENG        GMHENG           10
     C                   MOVE      TULKH         WSLKH
     C                   MOVE      TUCON1        WSCON1
     C                   MOVE      TULKC1        WSLKC1
     C                   MOVE      TUCON2        WSCON2
     C                   MOVE      TULKC2        WSLKC2
S11  C*                  MOVE      TUKVKT        WSKVKT
N11  C                   Z-ADD     TUKVKT        WSKVKT
     C                   MOVE      TUHØYB        WSHØYB
     C                   MOVE      TUHØYH        WSHØYH
S11  C*                  MOVE      TUTARA        WSTARA
N11  C                   Z-ADD     TUTARA        WSTARA
     C                   MOVE      TUBILK        WSBILK
     C                   MOVE      TUTRMA        WSTRMA
     C                   MOVE      TUSJA1        WSSJA1
     C                   MOVE      TUSJN1        WSSJN1
     C                   MOVE      TUSJA2        WSSJA2
     C                   MOVE      TUSJN2        WSSJN2
     C                   MOVE      TUTM          WSTM
     C                   MOVE      TUSTEF        WSSTEF
     C                   MOVEL     TUSONF        WSLKFR
     C                   MOVEL     TUSONF        WSSONF
     C                   MOVE      TUDTDT        WSDTDT
     C                   MOVE      TUDTMT        WSDTMT
     C                   MOVE      TUDTÅT        WSDTÅT
     C                   MOVE      TUTMT         WSTMT
     C                   MOVE      TUSTET        WSSTET
     C                   MOVEL     TUSONT        WSLKTO
     C                   MOVEL     TUSONT        WSSONT
s18  C*                  MOVE      TUTO1A        WSTO1A
s18  C*                  MOVE      TUTO1B        WSTO1B
     C                   MOVE      TUTVAL        WSTVAL
     C                   MOVE      TUTAKO        WSTAKO
     C                   MOVE      TUTBEL        WSTBEL
     C                   MOVE      TUKALM        WSKALM
     C                   MOVE      TUKAM3        WSKAM3
     C                   Z-ADD     TUANT1        WSANT1
     C                   Z-ADD     TUANT2        WSANT2
     C                   MOVE      TUENH1        WSENH1
     C                   MOVE      TUENH2        WSENH2
     C  N27              MOVE      'P'           TUST
      *
      * USPØR ER LIK C=KOPIER EN NY TUR SAMME RUNDTUR
      *
     C     USPØR         IFNE      'C'
     C                   UPDATE    TURERR
      * AVREGNET ELLER ING.FAKT. FØRT (ATTESTERT)?
     C     TUAVRE        IFEQ      'X'
      * AVREGNET...
     C     TUAVNR        IFNE      *ZEROS
     C     TURERK        CHAIN     TRAVH1                             32
     C   32              MOVE      *ZEROS        THFAKT
     C   32              MOVE      *ZEROS        THTOT
     C                   ELSE
      * INNG. FAKT. FØRT (ATTESTERT)....
     C                   MOVE      *ZEROS        THFAKT
     C                   MOVE      *ZEROS        THTOT
     C                   END
     C                   MOVE      '1'           *IN32
     C                   ELSE
      * IKKE AVREGNET/ATTESTERT
     C                   MOVE      '0'           *IN32
      *
      * SETTER PÅ 32 HVIS MELDT AVSLUTTET
      *
     C     TUPRO         CHAIN     AVSLUTL2                           33
     C  N33              MOVE      '1'           *IN32
     C                   END
     C                   ELSE
     C                   MOVE      ' '           XST               1
      *
     C     TILKEY        KLIST
     C                   KFLD                    GMLAVD
     C                   KFLD                    GMLPRO
      *
      * FLYTTER OVER TILLATELSER
      *
     C                   MOVE      UPRO          GMLPRO            8 0
     C                   MOVE      UAVD          GMLAVD            4 0
     C                   MOVE      UAVDCO        TUAVD
     C                   MOVE      UAVDCO        UAVD
     C                   MOVE      UAVDCO        WSAVD
     C                   MOVE      *BLANKS       WSOPDT
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *BLANKS       WSSDF
     C                   MOVE      *BLANKS       WSSDT
     C                   MOVE      *BLANKS       WSLKFR
     C                   MOVE      *BLANKS       WSLKTO
     C                   MOVE      *ZEROS        UPRO
     C                   MOVE      *ZEROS        TUPRO
     C                   MOVE      *BLANKS       WSTVAL
     C                   MOVE      *BLANKS       WSTAKO
     C                   MOVE      *ZEROS        WSTBEL
     C                   MOVE      *ZEROS        WSANT1
     C                   MOVE      *ZEROS        WSANT2
     C                   MOVE      *BLANKS       WSENH1
     C                   MOVE      *BLANKS       WSENH2
     C                   MOVE      *BLANKS       WSSTEF
     C                   MOVE      *ZEROS        WSTM
     C                   MOVE      *ZEROS        WSDTT
     C                   MOVE      *ZEROS        WSTMT
     C                   MOVE      *BLANKS       WSSTET
s18  C*                  MOVE      *BLANKS       WSTO1A
s18  C*                  MOVE      *BLANKS       WSTO1B
     C                   MOVE      *ZEROS        TUAO
     C                   MOVE      *ZEROS        TUTS
     C                   MOVE      *ZEROS        TUTVKT
     C                   MOVE      *ZEROS        TUTLM
     C                   MOVE      *ZEROS        TUTM3
     C                   MOVE      *BLANKS       TUST
     C                   MOVE      *BLANKS       TUTST1
     C                   MOVE      *BLANKS       TUTST2
     C                   MOVE      *BLANKS       TUTST3
     C                   MOVE      *BLANKS       TUTST4
     C                   MOVE      *BLANKS       TUTST5
     C                   MOVE      *ZEROS        TUTREF
     C                   MOVE      *BLANKS       TUAVRE
     C                   MOVE      *ZEROS        TUAVNR
     C                   MOVE      *ZEROS        TUANT1
     C                   MOVE      *ZEROS        TUANT2
     C                   MOVE      *ZEROS        TUKM
     C                   MOVE      *BLANKS       TUENH1
     C                   MOVE      *BLANKS       TUENH2
     C                   END
      *
     C                   END
     C                   ENDSR
      ***********************************************
     C     OPDTUR        BEGSR
      ***********************************************
     C     TURERK        CHAIN     TURER                              33
      *
      * HVIS F12-HOPP UT DERSOM GAMMEL TUR.
      * (MEN NY POST I TURER HVIS TURNR TILDELT MEN ENNÅ IKKE LAGRET)
      *
     C     *IN12         IFEQ      '1'
     C     *IN33         ANDEQ     '0'
     C                   update    turerr
     C                   GOTO      UTOPD
     C                   END
     C   33              DO
     C     UPRO          IFEQ      *ZEROS
     C                   MOVE      UAVD          TUAVD
     C     UAVD          CHAIN     TELL                               34
     C   34AVDZER        CHAIN     TELL                               34
     C  N34              MOVE      TETURN        TUPRO
     C  N34              ADD       1             TETURN
     C  N34              UPDATE    TELLR
     C                   MOVE      TUPRO         UPRO
      * FLYTTER TILLATELSER FRA GAMMEL TIL NY TUR
     C     KOPI          IFEQ      'J'
     C                   SETOFF                                       33
     C     TILKEY        SETLL     TILL
     C     *IN33         DOUEQ     '1'
     C     TILKEY        READE     TILL                                   33
     C  N33              MOVE      TUPRO         TIPRO
     C  N33              MOVE      TUAVD         TIAVD
     C  N33              WRITE     TILLR
     C                   END
     C                   END
      *
     C                   ELSE
     C                   MOVE      UPRO          TUPRO
     C                   END
     C                   MOVE      'P'           TUST
     C                   END
      *
     C                   MOVE      WSSONF        TUSONF
     C                   MOVE      WSSONT        TUSONT
     C     WSDT          IFEQ      *ZEROS
     C                   MOVE      *ZEROS        TUDT
     C                   ELSE
     C                   MOVE      WSDTD         TUDTD
     C                   MOVE      WSDTM         TUDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          TUDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          TUDTÅ
     C                   END
     C                   END
     C                   MOVE      WSKNT2        TUKNT2
     C                   MOVE      WSNAT         TUNAT
     C                   MOVE      WSAD1T        TUAD1T
     C                   MOVE      WSAD2T        TUAD2T
     C                   MOVE      WSAD3T        TUAD3T
     C                   MOVE      WSBILN        TUBILN
     C                   MOVE      WSLK          TULK
     C                   MOVE      WSSDF         TUSDF
     C                   MOVE      WSSDT         TUSDT
     C                   MOVE      WSRMND        TURMND
     C                   MOVE      WSRAAR        TURAAR
     C                   MOVE      WSRACC        TURACC
     C                   MOVE      WSOPDT        TUOPDT
     C                   MOVE      WSHENG        TUHENG
     C                   MOVE      WSLKH         TULKH
     C                   MOVE      WSCON1        TUCON1
     C                   MOVE      WSLKC1        TULKC1
     C                   MOVE      WSCON2        TUCON2
     C                   MOVE      WSLKC2        TULKC2
S11  C*                  MOVE      WSKVKT        TUKVKT
N11  C                   Z-ADD     WSKVKT        TUKVKT
     C                   MOVE      WSHØYB        TUHØYB
     C                   MOVE      WSHØYH        TUHØYH
S11  C*                  MOVE      WSTARA        TUTARA
N11  C                   Z-ADD     WSTARA        TUTARA
     C                   MOVE      WSBILK        TUBILK
     C                   MOVE      WSTRMA        TUTRMA
     C                   MOVE      WSSJA1        TUSJA1
     C                   MOVE      WSSJN1        TUSJN1
     C                   MOVE      WSSJA2        TUSJA2
     C                   MOVE      WSSJN2        TUSJN2
     C                   MOVE      WSTM          TUTM
     C                   MOVE      WSSTEF        TUSTEF
     C     WSDTT         IFEQ      *ZEROS
     C                   MOVE      *ZEROS        TUDTT
     C                   ELSE
     C                   MOVE      WSDTDT        TUDTDT
     C                   MOVE      WSDTMT        TUDTMT
     C     WSDTÅT        IFGT      50
     C     WSDTÅT        ADD       1900          TUDTÅT
     C                   ELSE
     C     WSDTÅT        ADD       2000          TUDTÅT
     C                   END
     C                   END
     C                   MOVE      WSSTET        TUSTET
     C                   MOVE      WSTMT         TUTMT
s18  C*                  MOVE      WSTO1A        TUTO1A
s18  C*                  MOVE      WSTO1B        TUTO1B
     C                   MOVE      WSTVAL        TUTVAL
     C                   MOVE      WSTAKO        TUTAKO
     C                   MOVE      WSTBEL        TUTBEL
     C                   MOVE      WSKALM        TUKALM
     C                   MOVE      WSKAM3        TUKAM3
     C                   MOVE      URUND         TURUND
     C                   Z-ADD     WSANT1        TUANT1
     C                   Z-ADD     WSANT2        TUANT2
     C                   MOVE      WSENH1        TUENH1
     C                   MOVE      WSENH2        TUENH2
      *
      * VED TRANSP. SOM SENDER FAKTURA. LEGG ALLTID UT I KOSBU.
      *
     C     VMINCR        IFEQ      1
     C     VMINCR        OREQ      3
     C                   EXSR      KOST
     C                   ELSE
      * BYTTET TIL EN SOM AVREGNES?-SLETT EVT. TIDLIGERE UTLAGT I KOSBU
     C     TUTREF        IFNE      *ZEROS
     C                   Z-ADD     TUTREF        KTNR
     C     KTNR          CHAIN     KOSBU                              34
     C  N34              DELETE    KOSBUR
     C                   MOVE      *ZEROS        TUTREF
     C                   END
     C                   END
      *
     C   33              MOVE      UUSIGN        TUSG
      *
      * FULLOAD VED USPØR=P
      * OG UAPD NE 0
      *
     C     FULLO         IFEQ      'F'
     C     OPDKEY        CHAIN     HEADF                              34
     C  N34              MOVE      TUPRO         HEPRO
     C  N34              MOVEL     TUBILN        HEHAWB
s06  C* N34              MOVE      VMTRKU        HEKNT
N06  C  N34              MOVE      TUKNT2        HEKNT
     C  N34              MOVE      TUTRMA        HETRM
     C  N34TUCON1        IFNE      *BLANKS
     C                   MOVE      1             HETRC
     C                   MOVEL     TUCON1        HETRCN
     C                   END
     C  N34              MOVE      TURUND        TRRUND
     C  N34              UPDATE    HEADFR
     C                   Z-ADD     HENT          TUTS
     C                   Z-ADD     HEVKT         TUTVKT
     C                   Z-ADD     HEM3          TUTM3
     C                   Z-ADD     HELM          TUTLM
N14  C                   Z-ADD     HELMLA        TUTLM2
N14  C                   Z-ADD     HEPOEN        TUPOEN
     C                   Z-ADD     1             TUAO
     C                   MOVE      ' '           FULLO
     C     OPDKEY        CHAIN     DISPR                              34
     C  N34              MOVE      TUAVD         DITUAV
     C  N34              MOVE      TUPRO         DITUR
     C  N34              MOVE      TURUND        DIRUND
     C  N34              MOVE      TUSG          DISIGN
     C  N34              UPDATE    DISPR
      *
     C                   EXSR      BUTADD
     C                   END
      *
     C   33              WRITE     TURERR
n08  c   33              exsr      ttsr
     C  N33              UPDATE    TURERR
      ******
      * OPPDATER - VERDIER FOR SIST KJØRTE TUR I UNITREGISTERET
      * DERSOM GAMMELT TURNR ER LAVERE ENN GJELDENDE TURNR I UNIT
      * MÅ DET VÆRE NOEN SOM ER INNE OG SER PÅ/ENDRER TUROPPLSYNING.
      * SKAL DA IKKE SETTE TILBAKE TURNR I UNIT TIL EN ELDRE TUR...
      * (RUNDTURSNR ER EN FELLES TELLER FOR ALLE AVD - SJEKK MOT DEN)
     C     TUBILN        CHAIN     UNITL01                            34
     C  N34TURUND        IFGE      UNRUND
     C                   MOVE      TURUND        UNRUND
     C                   MOVE      TUAVD         UNSAVD
     C                   MOVE      TUPRO         UNSPRO
     C                   END
     C  N34              UPDATE    UNITR
      *
     C     TUHENG        IFNE      *BLANKS
     C     TUHENG        CHAIN     UNITL01                            34
     C  N34TURUND        IFGE      UNRUND
     C                   MOVE      TURUND        UNRUND
     C                   MOVE      TUAVD         UNSAVD
     C                   MOVE      TUPRO         UNSPRO
     C                   END
     C  N34              UPDATE    UNITR
     C                   END
      * HVIS NOEN ENDRER PÅ EN ENHET SOM ALT ER OPPFØRT VIL HENVISNING TIL
      * SISTE TURNR I UNITREG. BLI MISSVISNEDE - HENT NESTSISTE
     C     GMBILN        IFNE      *BLANKS
     C     GMBILN        ANDNE     TUBILN
     C                   MOVE      'B'           BILHEN            1
     C                   CALL      'SYTR88F'
     C                   PARM                    GMBILN
     C                   PARM                    BILHEN
     C                   MOVE      TUBILN        GMBILN           10
      *
      * OPPDATERER BILER PÅ ENKELTOPPDRAG
      *
     C     FULLO         IFNE      'F'
     C                   EXSR      OPDBIL
     C                   END
     C                   END
     C     GMHENG        IFNE      *BLANKS
     C     GMHENG        ANDNE     TUHENG
     C                   MOVE      'H'           BILHEN            1
     C                   CALL      'SYTR88F'
     C                   PARM                    GMHENG
     C                   PARM                    BILHEN
     C                   MOVE      TUHENG        GMHENG           10
     C                   END
      *
     C     UTOPD         ENDSR
      ***********************************************
     C     BUTADD        BEGSR
      ***********************************************
      * GÅR IGJENNOM EVT. REKVISISJONER PÅ DETTE OPPDRAG OG LEGGER INN
      * TURNUMMER (FOR EVT Å KUNNE INNGÅ I TRANSPORTØRAVREGNING )
     C     UOPD          CABEQ     *ZEROS        UTBUTA
     C     KOSB9K        CHAIN     KOSBU9                             34
     C     *IN34         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC                           ALLTID TUREN...
     C     BUBILN        IFEQ      *BLANKS
     C                   MOVE      TUBILN        BUBILN
     C                   MOVE      TUBILK        BUBILK
     C                   MOVE      TUDT          BUFEDT
     C                   END
     C                   UPDATE    KOSB9R
     C     KOSB9K        READE     KOSBU9                                 34
     C  N34              END
      * OPPDATER TUR OGSÅ PÅ EVT. DUMMY/DUPREKV. PÅ OPPDRAGET
     C                   EXSR      BUTAD2
      *
     C     UTBUTA        ENDSR
      *
      ***********************************************
     C     BUTAD2        BEGSR
      ***********************************************
      * EVT. DUMMYREKVISISJONER (DUP)PÅ DETTE OPPDRAG-LEGGER INN TURNR
      * (FOR Å FÅ "TOTALBILDE" VED SPØRRING PÅ REKV - STATUS "*")
     C                   MOVE      'D'           YYST
     C     KOSB9K        CHAIN     KOSBU9                             34
     C     *IN34         DOWNE     '1'
     C                   MOVE      TUAVD         BUTAVD
     C                   MOVE      TUPRO         BUTUNR
     C                   MOVE      TURMND        BUPMN                          *PERIODE FØLGER
     C                   MOVE      TURAAR        BUPÅR                           ALLTID TUREN...
     C                   MOVE      TURACC        BUPCC                           ALLTID TUREN...
     C                   UPDATE    KOSB9R
     C     KOSB9K        READE     KOSBU9                                 34
     C  N34              END
     C                   ENDSR
      *
      ***********************************************
     C     NYRUND        BEGSR
      ***********************************************
      *
      * TILDELER NYTT RUNDTURSNUMMER
      *
     C     UAVD          CHAIN     TELLRU                             34
     C   34AVDZER        CHAIN     TELLRU                             34
     C  N34              MOVE      TERUND        URUND
     C  N34              ADD       1             TERUND
     C  N34              UPDATE    TELLRUR
      *
      * KAN DA OPPDATERE TURNUMMER UMIDDELBART HVIS LIK 0
      *
     C     UPRO          IFEQ      *ZEROS
     C                   MOVE      UAVD          TUAVD
     C     UAVD          CHAIN     TELL                               34
     C   34AVDZER        CHAIN     TELL                               34
     C  N34              MOVE      TETURN        TUPRO
     C  N34              ADD       1             TETURN
     C  N34              UPDATE    TELLR
     C  N34              MOVE      TUPRO         UPRO
     C                   END
      *
      * IKKE BEHOLD EN KOPIERT TURS PERIODE DERSOM NYTT RUNDTURSNR TILDELES
      *
     C     KOPI          IFEQ      'J'
     C                   MOVE      DEFMND        WSRMND
     C                   MOVE      DEFAAR        WSRAAR
     C                   MOVE      DEFACC        WSRACC
     C                   END
      *
     C                   ENDSR
      ***********************************************
     C     KOST          BEGSR
      ***********************************************
     C                   Z-ADD     TUTREF        KTNR
      *
      * TILDELER REFNUMMER
      *
     C     KTNR          CHAIN(N)  KOSBU                              34
     C   34              MOVE      *ZEROS        TUTREF
     C     TUTREF        IFEQ      *ZEROS
     C     'Å'           CHAIN     KOSTT                              34
     C  N34              ADD       1             KTNR
     C  N34              UPDATE    KOSTTR
     C                   END
      *
     C     KTNR          CHAIN     KOSBU                              34
     C   34              MOVE      ' '           BUST
     C     BUST          IFEQ      ' '
     C                   MOVE      KTNR          BUBNR
     C                   MOVE      WSRACC        BUPCC
     C                   MOVE      WSRAAR        BUPÅR
     C                   MOVE      WSRMND        BUPMN
     C                   MOVE      *ZEROS        BUTNR
     C                   MOVE      VMTRLE        BULNR
     C                   MOVE      WSTVAL        BUVAL
     C                   Z-ADD     WSTBEL        BUBL
     C                   MOVE      'FRA'         BUVK
     C                   MOVE      UUSIGN        BUSG
     C                   MOVE      UAVD          BUTAVD
     C                   MOVE      UPRO          BUTUNR
     C                   MOVE      *ZEROS        BUOAVD
     C                   MOVE      *ZEROS        BUOPD
     C                   MOVE      'E'           BUBLST
     C                   MOVE      WSTAKO        BUTYPE
     C                   MOVE      *BLANKS       BUTXT
     C                   MOVE      DSTXT         BUTXT
     C                   MOVE      WSBILK        BUBILK
     C                   MOVE      WSBILN        BUBILN
     C                   MOVE      TUDT          BUFEDT
     C                   MOVE      'T'           BUFER                          *AUTOM. FRA TUR/FERG
     C                   MOVE      *ZEROS        BUBNR2                         *FØRT BNR
     C                   MOVE      *ZEROS        BUBNR3                         *"SLAVE" AV.
     C                   MOVE      *ZEROS        BULNR3                         SLAVE-LØPENR
     C                   MOVE      *ZEROS        BUBLFD                         *FORDELT BEL
     C                   END
     C   34              WRITE     KOSBUR
     C  N34              UPDATE    KOSBUR
     C                   MOVE      KTNR          TUTREF
     C                   ENDSR
      ***********************************************
     C     SUMFRA        BEGSR
      ***********************************************
     C                   MOVE      *ZEROS        TOTIÅA
     C                   MOVE      *ZEROS        TOTIOA
     C                   MOVE      *ZEROS        TOTISA
     C                   MOVE      *ZEROS        TOTIÅG
     C                   MOVE      *ZEROS        TOTIOG
     C                   MOVE      *ZEROS        TOTISG
     C                   MOVE      *ZEROS        TOTKÅA
     C                   MOVE      *ZEROS        TOTKOA
     C                   MOVE      *ZEROS        TOTKSA
     C                   MOVE      *ZEROS        TOTKÅØ
     C                   MOVE      *ZEROS        TOTKOØ
     C                   MOVE      *ZEROS        TOTKSØ
     C                   MOVE      *ZEROS        TOTÅ
     C                   MOVE      *ZEROS        TOTO
     C                   MOVE      *ZEROS        TOTS
N01  C                   MOVE      *ZEROS        SIMLM
N01  C                   MOVE      *ZEROS        SIMM3
N01  C                   MOVE      *ZEROS        TUAO
N01  C                   MOVE      *ZEROS        TUTS
     C     DISKEY        KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C                   MOVE      *ZEROS        MINDT
     C                   MOVEL     '99999999'    MINDT
     C                   MOVE      *ZEROS        MAXDT
     C     STSUM1        TAG
     C     UPRO          SETLL     HEAD11
     C     STSUM2        TAG
     C                   SETOFF                                       33
     C     UPRO          READE(N)  HEAD11                                 33
     C  N33              DO                                                     1<-B
N01   * stoler ikke på TUAO/TUTS - reakkumulerer når en likevel leser alle oppdrag
N01  C                   Add       1             TUAO
N01  C                   Add       HENT          TUTS
N01   * Akkumulere simmulert LM / M3 utfra F-vekt med avdelingens faktor.
N01  c                   z-add     HEVKT         TMPFBV            9 0
N01  c     HELM          mult      KOVLKG        TMPFBV1           9 0
N01  c     HEM3          mult      KOVKKG        TMPFBV2           9 0
N01  c     TMPFBV1       ifgt      TMPFBV
N01  c                   z-add     TMPFBV1       TMPFBV
N01  c                   end
N01  c     TMPFBV2       ifgt      TMPFBV
N01  c                   z-add     TMPFBV2       TMPFBV
N01  c                   end
N01  c     TMPFBV        div       KOVLKG        TMPLM             5 3
N01  c     TMPFBV        div       KOVKKG        TMPM3             5 3
N01  C                   ADD       TMPLM         SIMLM
N01  C                   ADD       TMPM3         SIMM3
      * ENNÅ IKKE OVERFØRT HENTE-KOSTNAD VIA DUP
     C     TROPD1        IFNE      *ZEROS
     C     FAK2KI        SETLL     FAK2                               34
     C     FAK2KI        READE     FAK2                                   34
     C     *IN34         DOWEQ     '0'
     C     FAOPKO        IFEQ      ' '
     C     FASK          ANDEQ     'I'
     C     FAKDA         ANDNE     'I'
     C                   SUB       FABELN        TOTKÅØ
     C                   SUB       FABELN        TOTKSØ
     C                   SUB       FABELN        TOTÅ
     C                   SUB       FABELN        TOTS
     C                   END
     C     FAK2KI        READE     FAK2                                   34
     C                   END
     C                   END
      * ENNÅ IKKE OVERFØRT UTKJ-KOSTNAD VIA DUP
     C     TROPD2        IFNE      *ZEROS
     C     FAK2KU        SETLL     FAK2                               34
     C     FAK2KU        READE     FAK2                                   34
     C     *IN34         DOWEQ     '0'
     C     FAOPKO        IFEQ      ' '
     C     FASK          ANDEQ     'I'
     C     FAKDA         ANDNE     'I'
     C                   SUB       FABELN        TOTKÅØ
     C                   SUB       FABELN        TOTKSØ
     C                   SUB       FABELN        TOTÅ
     C                   SUB       FABELN        TOTS
     C                   END
     C     FAK2KU        READE     FAK2                                   34
     C                   END
     C                   END
     C     DISKEY        CHAIN(N)  DISP                               34
     C  N34              EXSR      MINMAX
      ***************************************************
      * Hent inntekter/kostnader fra fakt-linjer
      ***************************************************
     C     FAK2K         SETLL     FAK2                               33
     C     STSUM3        TAG
     C     FAK2K         READE     FAK2                                   33
     C   33              GOTO      STSUM2
     C     FAKDA         IFEQ      'D'                                           2<-B
     C     FAOPKO        OREQ      'D'                                           2<-B
     C                   GOTO      STSUM3
     C                   END                                                     2<-E
      ****************************************************
      * INNTEKTER
      ****************************************************
     C     KODGEK        CHAIN     KODTGE                             33
     C   33              MOVE      ' '           KGEAVR
     C     FAKDA         IFNE      'K'
     C     KGEAVR        IFEQ      'T'                                           2<-B
     C                   ADD       FABELN        TOTISA
     C     FAOPKO        IFLT      'O'
     C                   ADD       FABELN        TOTIÅA
     C                   ADD       FABELN        TOTÅ
     C                   ELSE
     C                   ADD       FABELN        TOTIOA
     C                   ADD       FABELN        TOTO
     C                   END
     C                   ELSE                                                    2<-E
     C                   ADD       FABELN        TOTISG
     C     FAOPKO        IFLT      'O'
     C                   ADD       FABELN        TOTIÅG
     C                   ADD       FABELN        TOTÅ
     C                   ELSE
     C                   ADD       FABELN        TOTIOG
     C                   ADD       FABELN        TOTO
     C                   END
     C                   END                                                     2<-E
     C                   ADD       FABELN        TOTS
      *********************
      * FØRTE KOSTNADER!!
      *********************
     C                   ELSE
N03   * avregningsjusteringer må regnes inn under øvrige
N03  c     THFAKT        ifne      *zeros
N03  c     THFAKT        andne     FAFAKT
N03  c                   move      *blanks       FAVT
N03  c                   end
     C     FAVT          IFNE      AVRTXT
     C     FAVTX         ANDNE     AVRTXD
     C     FAVTX         ANDNE     AVRTXF
S13  C*    FAVTXX        ANDNE     '*T*'
N13  C     FAVTXX        IFNE      '*T*'
     C                   ADD       FABELN        TOTKOØ
     C                   ADD       FABELN        TOTKSØ
     C                   ADD       FABELN        TOTO
     C                   ADD       FABELN        TOTS
      * ta med kostnad nå transportør sender regning
N13  C                   else
N13  C     vmincr        ifeq      1
N13  C     vmincr        oreq      5
N13  C                   ADD       FABELN        TOTKOØ
N13  C                   ADD       FABELN        TOTKSØ
N13  C                   ADD       FABELN        TOTO
N13  C                   ADD       FABELN        TOTS
N13  C                   END
N13  C                   END
     C                   END
     C                   END
     C                   GOTO      STSUM3
     C                   END                                                    1<-E
      *
      * Avregnings-kostnader...
     C     THTOT         IFNE      *ZEROS
N17  C     THST          ANDNE     ' '
     C     VMINCR        ifeq      1
     C     VMINCR        oreq      3
     C                   Z-ADD     0             TOTKOA
     c                   else
     C                   Z-SUB     THTOT         TOTKOA
     C                   END
     C                   ELSE
     C                   Z-ADD     TUTBEL        TMPBL            11 2
     C     TUTVAL        IFNE      FICURR
     C                   MOVE      TUTVAL        TMPVAL            3
     C                   EXSR      VALUT
     C                   END
N13  C     vmincr        ifne      1
N13  C     vmincr        andne     5
     C   32              Z-SUB     TMPBL         TOTKOA
N13  C                   END
     C  N32              Z-SUB     TMPBL         TOTKÅA
     C                   END
     C                   ADD       TOTKOA        TOTKSA
     C                   ADD       TOTKOA        TOTO
     C                   ADD       TOTKOA        TOTS
     C                   ADD       TOTKÅA        TOTKSA
     C                   ADD       TOTKÅA        TOTÅ
     C                   ADD       TOTKÅA        TOTS
      * Hent åpne forv. kostnader. på turnivå
     C     KOSBK2        SETLL     KOSBU2
     C     KOSBK2        READE     KOSBU2                                 33
     C     *IN33         DOWEQ     '0'
N07  C     BUVK          IFEQ      'FEI'
N07  C                   MOVE      'T'           BUFER
N07  C                   END
     C     BUBNR         IFNE      TUTREF
     C     BUFER         ANDNE     'F'
     C     BUVAL         IFNE      FICURR
     C                   MOVE      BUVAL         TMPVAL
     C                   Z-ADD     BUBL          TMPBL
     C                   EXSR      VALUT
     C                   Z-ADD     TMPBL         BUBL
     C                   END
     C                   SUB       BUBL          TOTKÅØ
     C                   SUB       BUBL          TOTKSØ
     C                   SUB       BUBL          TOTÅ
     C                   SUB       BUBL          TOTS
     C                   END
     C     KOSBK2        READE     KOSBU2                                 33
     C                   END
      * LEGG I AKKUMULERTE VERDIER I SKJERMVARIABLE 9.0
     C                   Z-ADD(H)  TOTIÅA        TOXIÅA
     C                   Z-ADD(H)  TOTIOA        TOXIOA
     C                   Z-ADD(H)  TOTISA        TOXISA
     C                   Z-ADD(H)  TOTIÅG        TOXIÅG
     C                   Z-ADD(H)  TOTIOG        TOXIOG
     C                   Z-ADD(H)  TOTISG        TOXISG
     C                   Z-ADD(H)  TOTKÅA        TOXKÅA
     C                   Z-ADD(H)  TOTKOA        TOXKOA
     C                   Z-ADD(H)  TOTKSA        TOXKSA
     C                   Z-ADD(H)  TOTKÅØ        TOXKÅØ
     C                   Z-ADD(H)  TOTKOØ        TOXKOØ
     C                   Z-ADD(H)  TOTKSØ        TOXKSØ
     C                   Z-ADD(H)  TOTÅ          TOXÅ
     C                   Z-ADD(H)  TOTO          TOXO
     C                   Z-ADD(H)  TOTS          TOXS
      *
     C                   ENDSR
     C***********************************************
     C     VALUT         BEGSR
     C***********************************************
     C*
     C     VALU1K        CHAIN     VALUL01                            39
     C  N39              DO
     C     VALKU2        IFNE      0
     C                   MOVE      VALKU2        VALKU1
     C                   END
     C     TMPBL         MULT      VALKU1        XWORK            15 4
     C     XWORK         DIV(H)    OMRFAK        TMPBL
     C                   END
     C                   ENDSR
      *
      ***********************************************
     C     TILTUR        BEGSR
      ***********************************************
     C                   Z-ADD     0             UFLAGG
     C   33              Z-ADD     1             UFLAGG
     C                   CALL      'SYTR88B'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UPRO
     C                   PARM                    URUND
     C                   PARM                    USPØR
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      01
     C     UFLAGG        COMP      3                                      03
     C     TURERK        CHAIN     TURER                              33
     C  N33
     CANN27              MOVE      ' '           TUST
     C  N33              UPDATE    TURERR
     C                   Z-ADD     0             XCMD
      *
     C                   ENDSR
      *
      ***********************************************
     C     SØKKUN        BEGSR
      ***********************************************
     C                   MOVE      WSKNT2        KUNDNR
     C     KUND1K        CHAIN     TRAN                               33
     C  N33              DO
     C                   MOVE      VMNAVN        WSNAT
     C                   END
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     TURERK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UPRO
     C     OPDKEY        KLIST
     C                   KFLD                    YAVD
     C                   KFLD                    UOPD
     C     KOSB9K        KLIST
     C                   KFLD                    YYST
     C                   KFLD                    YAVD
     C                   KFLD                    UOPD
     C     KOSBK2        KLIST
     C                   KFLD                    XXST
     C                   KFLD                    UPRO
     C                   MOVE      ' '           XXST              1
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     VALKEY        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    WSTVAL
     C     FAK2K         KLIST
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     FAK2KI        KLIST
     C                   KFLD                    TRAVD1
     C                   KFLD                    TROPD1
     C     FAK2KU        KLIST
     C                   KFLD                    TRAVD2
     C                   KFLD                    TROPD2
     C     ST2DFK        KLIST
     C                   KFLD                    WSLKFR
     C                   KFLD                    WSSTEF
     C     ST2DTK        KLIST
     C                   KFLD                    WSLKTO
     C                   KFLD                    WSSTET
     C                   MOVE      ' '           YYST              1
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    WSAVD
     C                   MOVE      'A'           YAUNI             1
N01  C     KODTVK        KLIST
s04  C*                  KFLD                    YAUNI
N04  C                   KFLD                    YVUNI
N01  C                   KFLD                    WSAVD
s04  C*                  MOVE      'V'           YAUNI             1
N04  C                   MOVE      'V'           YVUNI             1
     C     KODGEK        KLIST
     C                   KFLD                    YGEUNI
     C                   KFLD                    FAVK
     C                   MOVE      'GE'          YGEUNI            2
     C* VALUTAFIL
     C     VALU1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    TMPVAL
      *
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UPRO              8 0
     C                   PARM                    URUND             8 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UAVDCO            4 0
     C                   PARM                    USPØR             1
     C                   PARM                    UFLAGG            1 0
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      UAVD          YAVD              4 0
N01  C     KODTVK        CHAIN     KODTV                              33
N01  C   33              Z-ADD     1800          KOVLKG
N01  C   33              Z-ADD     300           KOVKKG
     C                   MOVE      'N'           INNLAN            1
     C     KODTAK        CHAIN     KODTA                              33
     C     *IN33         IFEQ      '0'
     C     KOAIE         IFEQ      '1'
     C     KOAIE         OREQ      '2'
     C     KOAIE         OREQ      '3'
     C                   MOVE      'J'           INNLAN            1
     c                   move      *ON           *IN50                          protect visse felt
     C                   END
     C                   END
     C     USPØR         COMP      'J'                                    27
     C     UPRO          COMP      0                                      28
     C                   MOVE      *ZEROS        MAXDT
     C                   MOVE      *ZEROS        MINDT
      *
     C                   MOVEL     '* TUR * '    DSTXTA
     C                   MOVE      '-'           DSTXTB
     C     UYEAR         IFGT      50
     C     UYEAR         ADD       1900          IÅRCÅ
     C                   ELSE
     C     UYEAR         ADD       2000          IÅRCÅ
     C                   END
      *
     C     INNLAN        IFEQ      'N'
     C     UDAY          IFLT      24
     C     UDAY          ANDGT     03
     C                   MOVE      UMONTH        DEFMND            2 0
     C                   MOVE      UYEAR         DEFAAR            2 0
     C     UYEAR         IFGT      50
     C                   MOVE      19            DEFACC            2 0
     C                   ELSE
     C                   MOVE      20            DEFACC
     C                   END
     C                   END
     C                   ELSE
     C     UDAY          IFLT      29
     C     UDAY          ANDGT     01
     C                   MOVE      UMONTH        DEFMND            2 0
     C                   MOVE      UYEAR         DEFAAR            2 0
     C     UYEAR         IFGT      50
     C                   MOVE      19            DEFACC            2 0
     C                   ELSE
     C                   MOVE      20            DEFACC
     C                   END
     C                   END
     C
     C                   END
     C   28              MOVE      DEFMND        WSRMND
     C   28              MOVE      DEFAAR        WSRAAR
     C   28              MOVE      DEFACC        WSRACC
      * Innland (ikke v/kopi) - dft transportør?  EN og kun EN bil foreslå denne
     C   28INNLAN        IFEQ      'J'
     C     USPØR         andne     'C'
     C     WSAVD         CHAIN     KODTAG                             33
     C     *in33         ifeq      *off
     C     AGDFTR        andne     *zeros
     C                   Move      AGDFTR        WSKNT2
     C                   MOVE      WSKNT2        KUNDNR
     C     KUND1K        CHAIN     TRAN                               97
     C     *in33         ifeq      *off
     C                   MOVE      VMNAVN        WSNAT
     C     WSKNT2        setll     UNIT
     C     WSKNT2        READE     UNIT                                   33
     c  N33              movel     UNBILN        WSBILN
     C  N33WSKNT2        READE     UNIT                                   33
     c  N33              movel     *blanks       WSBILN
     C                   end
     C                   end
     C                   end
     C     *LIKE         DEFINE    TEAVD         AVDZER
     C                   MOVE      *ZEROS        AVDZER
     C                   MOVE      *ZEROS        YPOS1             4 0
     C                   MOVE      ' '           YSK               1
     C                   MOVEL     UMONTH        IDAGMÅ            4 0
     C                   MOVE      UYEAR         IDAGMÅ
     C                   MOVEL     UDAY          IDAG              6 0
     C                   MOVE      IDAGMÅ        IDAG
      * INITIER AKKUMULATORE/DS-ER
     C                   MOVE      *ZEROS        TOTIÅA           13 2
     C                   MOVE      *ZEROS        TOTIOA           13 2
     C                   MOVE      *ZEROS        TOTISA           13 2
     C                   MOVE      *ZEROS        TOTIÅG           13 2
     C                   MOVE      *ZEROS        TOTIOG           13 2
     C                   MOVE      *ZEROS        TOTISG           13 2
     C                   MOVE      *ZEROS        TOTKÅA           13 2
     C                   MOVE      *ZEROS        TOTKOA           13 2
     C                   MOVE      *ZEROS        TOTKSA           13 2
     C                   MOVE      *ZEROS        TOTKÅØ           13 2
     C                   MOVE      *ZEROS        TOTKOØ           13 2
     C                   MOVE      *ZEROS        TOTKSØ           13 2
     C                   MOVE      *ZEROS        TOTÅ             13 2
     C                   MOVE      *ZEROS        TOTO             13 2
     C                   MOVE      *ZEROS        TOTS             13 2
      *
     C                   READ      FIRM                                   33
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTT
     C  N28              EXSR      MOVTWS
     C     *IN28         IFEQ      '0'
     C     UPRO          ANDNE     0
     C                   EXSR      SUMFRA
     C                   ENDIF
     C                   MOVE      'N'           KOPI              1
     C     USPØR         IFEQ      'C'
     C                   MOVE      'A'           USPØR
      * KOMMER INN VIA KOPIERING - DERSOM EN SENERE VELGER Å TILDELE
      * NYTT RUNDTURSNR - DEFAULTPERIODE SETTES INN (IKKE KOPIERT PERIODE)
     C                   MOVE      'J'           KOPI
     C                   END
     C                   Z-ADD     3             LINNBR
     C                   Z-ADD     18            POSNBR
      *HVIS IKKE AVREGNET TILLAT ENDRING AV AVTALT PRIS...
     C     USPØR         IFEQ      'J'
     C     *IN32         ANDEQ     *OFF
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   END
      * VED ENDRING AV TUR MED STATUS ULIK ' ' PROTECT/IKKE TEST PERIODE
     C                   MOVE      *OFF          *IN26
     C     *IN28         IFEQ      *OFF
     C     XST           ANDNE     ' '
     C                   MOVE      *ON           *IN26
     C                   END
      *
      * FULLOAD VED USPØR=F
      * OG UOPD NE 0
      *
     C     USPØR         IFEQ      'F'
     C     UOPD          IFNE      0
     C     UPRO          IFEQ      0
     C     OPDKEY        CHAIN(N)  DISP                               33
     C  N33OPDKEY        CHAIN(N)  HEADF                              33
     C  N33              DO
     C                   MOVE      DISTEF        WSSTEF
     C                   MOVE      DISTET        WSSTET
     C                   MOVEL     DISONF        WSLKFR
     C                   MOVEL     DISONT        WSLKTO
     C                   MOVE      DITIMF        WSTM
     C                   MOVE      DITIMT        WSTMT
     C                   MOVE      DIFAAR        WSDTÅ
     C                   MOVE      DIFMND        WSDTM
     C                   MOVE      DIFDAG        WSDTD
     C                   MOVE      DITAAR        WSDTÅT
     C                   MOVE      DITMND        WSDTMT
     C                   MOVE      DITDAG        WSDTDT
     C                   MOVE      HEOT          WSOPDT
     C                   Z-ADD     HENT          TUTS
     C                   Z-ADD     HEVKT         TUTVKT
     C                   Z-ADD     HEM3          TUTM3
     C                   Z-ADD     HELM          TUTLM
N14  C                   Z-ADD     HELMLA        TUTLM2
N14  C                   Z-ADD     HEPOEN        TUPOEN
     C                   Z-ADD     1             TUAO
     C                   MOVE      'F'           FULLO             1
     C                   END
     C                   END
     C                   END
     C                   END
      *
     C                   EXSR      UTCMDL
      * TESTER BILDET VED SPØRRING
      *
     C   27              DO
     C                   EXSR      TSTTRA
     C                   MOVEA     '0000'        *IN(96)
     C                   MOVEA     '00000000'    *IN(70)
     C                   MOVEA     '00000'       *IN(79)
     C                   END
      *
      * HENTE INNTEKTER
N15  C*    UPRO          IFNE      0
N15  C*                  MOVE      'T'           KODET
n15  c*                  call      'SYGE83'
n15  c*                  parm                    UPRO
n15  c*                  parm                    kodet             1
n15  c*                  parm                    WSINN            13 2
     C*                  Z-ADD     WSINN         TOTINN
N15  C*                  END
      *
      *
      * eller hente budsjett
      *
n15  c                   move      upro          uproa             8
N15  c                   call      'SYGE79TCL'
N15  c                   parm                    uproa
N15  c                   parm                    wstvalb           3
N15  c                   parm                    wstbelb          11 2
N15  c                   parm                    avtale            1
N15  C                   z-add     wstbelb       berbud
N15  c     wstako        ifeq      'E'
N15  c     avtale        andeq     'A'
N15  c                   move      wstvalb       wstval
N15  c                   move      wstbelb       wstbel
N15  c                   move      'E'           wstako
N15  c                   end
      *
     C                   ENDSR
      *
      ***********************************************
     C     TSTMOB        BEGSR
      ***********************************************
      *
      * HENT MOBILNR, SET IND 36 HVIS FLERE (POSTER I MOB/FAX)
     C                   MOVE      *BLANKS       WSMOBI
     C                   MOVE      *ZEROS        ANTMOB            3 0
      *
     C     WSBILN        IFNE      *BLANKS
     C     WSBILN        SETLL     UNITFX1
     C     WSBILN        READE     UNITFX1                                94
      *
     C     *IN94         DOWEQ     '0'
     C     UFMOB         IFNE      *BLANKS
     C     WSMOBI        ANDEQ     *BLANKS
     C                   MOVE      UFMOB         WSMOBI
     C                   END
     C                   ADD       1             ANTMOB
     C     WSMOBI        IFNE      *BLANKS
     C     ANTMOB        ANDGT     1
     C                   GOTO      UTMOB
     C                   END
     C     UFBILN        READE     UNITFX1                                94
     C  N94              END
     C                   END
      * MER ENN 1 - 36 ON
     C     UTMOB         TAG
     C     ANTMOB        COMP      1                                  36
      *
N09
N09  c                   eval      PDASTAT=*blanks
N09  C                   select
N09  C     TUTST4        wheneq    ' '
N09  C     TUSJA1        andne     *zeros
N09  C     'PDA'         SCAN      TUSJN1                                 94    Tildelt/ikke på PDA
N09  c   94              eval      PDASTAT='(Tildelt PDA-sjåfør)'
N09  C     TUTST4        wheneq    '1'
N09  c                   eval      PDASTAT='(1=Hentet til PDA)'
N09  C     TUTST4        wheneq    '2'
N09  c                   eval      PDASTAT='(2=Ferdig PDA)'
N09  C                   endsl
      *
     C                   ENDSR
      *
      *
      ***********************************************
     C     KDTFMT        BEGSR
      ***********************************************
     C                   MOVE      WSDTD         UDT1              2 0
     C                   MOVE      WSDTM         UDT2              2 0
     C                   MOVE      WSDTÅ         UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTD
     C                   MOVE      UDT2          WSDTM
     C                   MOVE      UDT3          WSDTÅ
     C                   MOVE      WSDTDT        UDT1              2 0
     C                   MOVE      WSDTMT        UDT2              2 0
     C                   MOVE      WSDTÅT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVE      UDT1          WSDTDT
     C                   MOVE      UDT2          WSDTMT
     C                   MOVE      UDT3          WSDTÅT
      *
     C                   ENDSR
      ***********************************************
     C     SØKDTA        BEGSR
      ***********************************************
     C                   Z-ADD     1             UFLAGG
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     40
     C     POSNBR        ANDLE     42
     C                   CALL      'SYTR21A'
     C                   PARM                    WSBILK
     C                   EXSR      TESTB
     C                   Z-ADD     60            POSNBR
     C                   Z-ADD     3             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     60
     C     POSNBR        ANDLE     61
     C                   CALL      'SYFI10C'
     C                   PARM                    WSOPDT
     C                   EXSR      TESTB
     C                   Z-ADD     79            POSNBR
     C                   Z-ADD     3             LINNBR
     C                   GOTO      SLSØK
     C                   END
     C* TRANSPORTMÅTE
     C     LINNBR        IFEQ      3
     C     POSNBR        ANDGE     79
     C     POSNBR        ANDLE     80
     C                   CALL      'SAD061I'
     C                   PARM                    WSTRMA
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     27
     C                   CALL      'SYTR19'
     C                   PARM                    WSBILN
      * VED VALG AV NY BIL BLANKES TRANSPORTØRNR
     C     WSBILN        IFNE      *BLANKS
     C                   MOVE      *ZEROS        WSKNT2
     C                   END
     C                   EXSR      TESTB
     C                   Z-ADD     32            POSNBR
     C                   Z-ADD     4             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     29
     C     POSNBR        ANDLE     30
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLK
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     4             LINNBR
     C                   Z-ADD     32            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     32
     C     POSNBR        ANDLE     41
     C                   CALL      'SYTR19'
     C                   PARM                    WSHENG
     C                   EXSR      TESTB
     C                   Z-ADD     18            POSNBR
     C                   Z-ADD     5             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     43
     C     POSNBR        ANDLE     44
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKH
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      4
     C     POSNBR        ANDGE     45
     C                   CALL      'SYTR09'
     C                   PARM                    WSBILN
     C                   PARM                    XXFAXN           15
     C                   PARM                    XXTEXT           20
     C                   PARM                    XXMODU            1
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     36
     C     POSNBR        ANDLE     37
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKC1
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     5             LINNBR
     C                   Z-ADD     40            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     58
     C     POSNBR        ANDLE     59
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKC2
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      6
     C                   CALL      'SYTR04A'
     C                   PARM                    WSKNT2
     C                   EXSR      SØKKUN
     C                   EXSR      TESTB
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      7
     C                   CALL      'SYTR18'
     C                   PARM                    WSSJA1
     C                   EXSR      TESTB
     C                   Z-ADD     8             LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C                   CALL      'SYTR18'
     C                   PARM                    WSSJA2
     C                   EXSR      TESTB
     C                   Z-ADD     10            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     50
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSTEF
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   EXSR      TESTB
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKFR
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     11            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     50
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    WSSTET
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   EXSR      TESTB
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     52
     C     POSNBR        ANDLE     53
     C                   MOVE      'J'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    WSLKTO
     C                   PARM                    USPED
     C                   EXSR      TESTB
     C                   Z-ADD     12            LINNBR
     C                   Z-ADD     18            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
s18  C*    LINNBR        IFEQ      12
s18  C*    POSNBR        ANDGE     27
s18  C*    POSNBR        ANDLE     28
s18  C*                  MOVE      *ZEROS        UTOLL             2 0
s18  C*                  CALL      'SYFI10H'
s18  C*                  PARM                    UTOLL
s18  C*    UTOLL         IFNE      0
s18  C*                  MOVE      UTOLL         WSTO1B
s18  C*                  END
s18  C*                  Z-ADD     13            LINNBR
s18  C*                  Z-ADD     18            POSNBR
s18  C*                  GOTO      SLSØK
s18  C*                  END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     20
     C                   MOVE      'J'           USØK              1
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSTVAL
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      13
     C     POSNBR        ANDGE     18
     C     POSNBR        ANDLE     20
     C                   MOVE      'J'           USØK              1
     C                   CALL      'V200SY'
     C                   PARM                    USØK
     C                   PARM                    WSTVAL
     C                   Z-ADD     22            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C     SLSØK         ENDSR
      ***********************************************
     C     UTCMDL        BEGSR
      ***********************************************
      * 27 ON=SPØRREMODUS
     C     XCMD          IFEQ      0
     C                   MOVE      'DIV0020'     MSGLN1
     C  N27              MOVE      'DIV0032'     MSGLN2
     C   27              MOVE      'DIV0000'     MSGLN2
     C                   MOVE      'DIV3804'     MSGLN3
     C                   MOVE      'DIV3795'     MSGLN4
     C     *IN50         IFEQ      *ON
     C     UPRO          ANDEQ     *ZEROS
     C                   MOVE      'JOV1447'     MSGLN4
     C                   END
     C                   MOVE      'DIV3796'     MSGLN5
     C                   MOVE      'DIV3797'     MSGLN6
     C                   MOVE      'DIV3798'     MSGLN7
     C                   MOVE      'DIV0029'     MSGLN8
     C                   ADD       1             XCMD              1 0
     C                   ELSE
     C     XCMD          IFEQ      1
     C                   MOVE      'DIV3800'     MSGLN1
     C  N27              MOVE      'DIV3809'     MSGLN2
     C   27              MOVE      'DIV0000'     MSGLN2
     C                   MOVE      'DIV0024'     MSGLN3
     C  N27              MOVE      'DIV3810'     MSGLN4
     C   27              MOVE      'DIV0000'     MSGLN4
     C  N27              MOVE      'DIV3811'     MSGLN5
     C   27              MOVE      'DIV0000'     MSGLN5
     C  N27              MOVE      'DIV4028'     MSGLN6
     C   27              MOVE      'DIV0000'     MSGLN6
     C                   MOVE      'DIV3572'     MSGLN7
s12  C*                  Z-ADD     0             XCMD
n12  C                   add       1             XCMD
n12  c                   else
n12  C     XCMD          IFEQ      2
n12  C                   Z-ADD     0             XCMD
n12  C                   MOVE      'DIV0000'     MSGLN1
n12  C                   MOVE      'DIV0000'     MSGLN2
n12  C                   MOVE      'DIV0000'     MSGLN3
n12  C                   MOVE      'SHU1470'     MSGLN4
n12  C                   MOVE      'DIV0000'     MSGLN5
n12  C                   MOVE      'DIV0000'     MSGLN6
n12  C                   MOVE      'DIV0000'     MSGLN7
n12  c                   end
     C                   END
     C                   END
      *
     C                   ENDSR
      *
      *
      ***********************************************
     C     MINMAX        BEGSR
      ***********************************************
     C     DIFRA         IFLT      MINDT
     C                   MOVE      DIFRA         MINDT
     C                   MOVE      DISTEF        MINSTE
     C                   MOVEL     DISONF        MINLK
     C                   END
     C     DITIL         IFGT      MAXDT
     C                   MOVE      DITIL         MAXDT
     C                   MOVE      DISTET        MAXSTE
     C                   MOVEL     DISONT        MAXLK
     C                   END
     C                   ENDSR
      ***********************************************
     C     OPDBIL        BEGSR
      ***********************************************
     C     TUPRO         SETLL     HEAD11
     C     STBIL         TAG
     C                   SETOFF                                       33
     C     *IN33         DOWEQ     '0'
     C     TUPRO         READE     HEAD11                                 33
     C     *IN33         IFEQ      '0'                                          1<-B
     C                   MOVEL     TUBILN        HEHAWB
s06  C* N34              MOVE      VMTRKU        HEKNT
N06  C                   MOVE      TUKNT2        HEKNT
     C                   MOVE      TUTRMA        HETRM
     C     TUCON1        IFNE      *BLANKS
     C                   MOVE      1             HETRC
     C                   MOVEL     TUCON1        HETRCN
     C                   END
     C                   UPDATE    HEA11R
     C                   ENDIF
     C                   ENDDO
     C                   ENDSR
n08  C***********************************************
n08  C     TTSR          BEGSR
n08  C***********************************************
n08   * OPPDRAG OPPRETTET (POST I FIL TRACKF)
n08  C                   MOVE      TUAVD         TTAVD
n08  C                   MOVE      TUPRO         TTTUR
n08  C                   MOVE      *zeros        TTOPD
n08  C                   TIME                    XULTID
n08  C                   MOVE      XULDD         ULDD
n08  C                   MOVE      XULMM         ULMM
n08  C                   MOVE      XULÅÅ         ULÅÅ
n08  C                   MOVE      'STR'         TTACTI
n08  C                   MOVE      ULDT          TTDATE
n08  C                   MOVE      XULTM         TTTIME
n08  C                   MOVE      TTDATE        TTDATL
n08  C                   MOVE      TTTIME        TTTIML
n08  C                   MOVE      UUSR          TTUSER
n08  C                   MOVEL     'Trip ent'    XYTEXT           16
n08  C                   MOVE      'ered    '    XYTEXT
n08  C                   MOVEL     XYTEXT        TTTEXT
n08  C                   MOVEL     'Tur oppr'    XYTEXT           16
n08  C                   MOVE      'ettet   '    XYTEXT
n08  C                   MOVEL     XYTEXT        TTTEXL
n08  C                   WRITE     TRACKFR
n08   *
n08  C                   ENDSR
n12  C*
n12   ***********************************************
n12  C     PRTSKILL      BEGSR
n12   ***********************************************
n12  C                   MOVE      '*T'          SCATYP            2
n12  C                   MOVEL     TUPRO         SCASTR           20
n12  C                   CALL      'ARCA000CL'
n12  C                   PARM                    SCATYP
n12  C                   PARM                    SCASTR
n12  C                   ENDSR
N16   ***********************************************
n16  C     BEREGNA       BEGSR
n16   ***********************************************
n16  C                   CALL      'SYTR12A'
n16  C                   PARM                    UAVD
n16  C                   PARM                    UPRO
n16  C                   PARM                    XXVIS
n16  C                   PARM                    N4                4 0
n16  C*                  PARM                    N5                5 0
n16  C                   PARM                    N7                7 0
n16  C                   PARM                    N8                8 0
N16   *Hvis ennå ikke avregnet, trtype  0 - hent avr.tall til estimert
n16  C  N32VMINCR        IFEQ      0
n16  C     VMINCR        OREQ      4
n16  C     TURERK        CHAIN     TRAVH1                             32
n16  C     *IN32         IFEQ      '0'
n16   * TREKK UT GAMMEL VERDI / NULL-STILL
n16  C                   SUB       TOTKÅA        TOTKSA
n16  C                   SUB       TOTKÅA        TOTÅ
n16  C                   SUB       TOTKÅA        TOTS
N16  C                   MOVE      *ZEROS        TOTKÅA
n16   * LEGG INN NY VERDI.......
n16  C                   Z-SUB     THTOT         TOTKÅA
n16  C                   ADD       TOTKÅA        TOTKSA
N16  C                   ADD       TOTKÅA        TOTÅ
n16  C                   ADD       TOTKÅA        TOTS
n16   * VERDIENE OVER I 9,0 SKJERMVARIABLE
n16  C                   Z-ADD(H)  TOTKÅA        TOXKÅA
n16  C                   Z-ADD(H)  TOTKSA        TOXKSA
n16  C                   Z-ADD(H)  TOTÅ          TOXÅ
n16  C                   Z-ADD(H)  TOTS          TOXS
n16  C                   END
n16  C                   MOVE      '0'           *IN32
n16  C                   END
n16   *
n16   * Dersom avregn.transportør og summer finnes. Rød om AvrBel foreløpig under beregnet kost
N16  c                   setoff                                       6061
n16  C     VMINCR        ifeq      0
n16  C     VMINCR        oreq      4
n16  C     BERBUD        ifne      0
n16  C     TOXKSA        andne     0
n16  c     TOXKSA        mult      -1            AvrBel            9 0
n16  c     AvrBel        iflt      BERBUD
n16  c                   seton                                        60        Rød / Revers
n16  c                   else
N16  c                   seton                                        61        Grønn / Revers
n16  C                   endif
n16  C                   endif
n16  C                   endif
N16   *
N16  C                   ENDSR
N20   ***********************************************
n20  C     TESTIE        BEGSR
n20   ***********************************************
n20   * fra eget land
N20  C     WSLK          IFEQ      FILAND
N20  C     WSLKTO        IFNE      FILAND
N20  C                   MOVE      '*EKS'        TYPES             4
N20  C                   ELSE
N20  C                   MOVE      '*INN'        TYPES
N20  C                   END
N20  C                   ELSE
N20  C     WSLKTO        IFEQ      FILAND
N20  C                   MOVE      '*IMP'        TYPES
N20  C                   ELSE
N20  C                   MOVE      '*TRA'        TYPES
N20  C                   END
N20  C                   END
N20  C                   ENDSR
