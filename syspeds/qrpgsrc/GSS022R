     H DECEDIT(',') debug(*yes)
********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 ny farlig godsfil   ....
10XXX * 02 YBC PTF10 BÅTKODE='*ALL' -> ENDELIG TRIP MED TRANSIT-LAYPUT
10XXX * 03 YBC PTF10 SKRIV UT FRITEKST FRA TRIP
10172 * 04 SH  PTF10 norsk text til Track and trace
10172 * 05 SH  PTF10 ENDRET AFP
10196 * 06 YBC PTF10 SORTERE ETTER ORDRE TYPE
10217 * 07 YBC PTF10 FLERE DEFAULT PRINTER
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 08 YBC PTF11 RETTE FEIL I ENDRING 06
11XXX * 09 SH  PTF11 starter arkivering
********************************************************************
      *
      **************************************************************
      *** PROGRAM SKAL SKRIVE UT PACKINGLISTE
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER
      *** LEDIGE INDIKATORER 01-26
      *** LEDIGE INDIKATORER 30-32 38 39 41-49 52-99
      **************************************************************
      *
N09  FARKTXT    IF   E           K DISK
N09  FFIRMARC   IF   E           K DISK
N09  FARKIVP    O  A E             DISK
     FKODTFM    IF   E           K DISK
     FGSSSTK    IF   E           K DISK
     FGSSGDF    IF   E           K DISK
     FGSSORL22  UF   E           K DISK
     FGSSORL26  UF   E           K DISK
     F                                     RENAME(GSSORFR:GSSORF26)
     FGSSORF    IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF00)
     FGSSORL21  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF21)
     FGSSORL24  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF24)
     FGSSORL25  IF   E           K DISK    USROPN
     F                                     RENAME(GSSORFR:GSSORF25)
     FGSS022W   UF A E           K DISK    USROPN
     FGSS031W   UF A E           K DISK    USROPN
     FGSSPOF    IF   E           K DISK
     FGSSSFF    IF   E           K DISK
     FGSSFIF    IF   E           K DISK
     FGSSTRF    UF   E           K DISK
     FGSSOLF    IF   E           K DISK
     FGSSLGL03  IF   E           K DISK
     FGSSFGF    IF   E           K DISK
N01  FGSSDGF    IF   E           K DISK
     FGSSBIF    IF   E           K DISK
     FCDBOAT    IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FFAXSEN    IF   E           K DISK
     FFAXMANP   O  A E           K DISK    USROPN
     FFAXMANT   UF A E           K DISK
     FFIRM      IF   E           K DISK
     FTRACKF    O    E             DISK
     FGSS022P   O    E             PRINTER OFLIND(*IN27)
     F                                     USROPN
     D                 DS
     D  ORFT1                  1     30
     D  ORFT2                 31     60
     D  ORFT3                 61     90
     D  ORFT4                 91    120
     D  FT                     1    120    DIM(4)
N03  D                 DS
N03  D  TRFT1                  1     70
N03  D  TRFT2                 71    140
N03  D  TRFT3                141    210
N03  D  TRFT4                211    280
N03  D  TFT                    1    280    DIM(4)
     D                 DS
     D  XCONO1                 1     20
     D  XCONO2                21     40
     D  XCONO3                41     60
     D  XCONO4                61     80
     D  XCONO5                81    100
     D  XCONO6               101    120
     D  CO                     1   1000    DIM(50)
     D                 DS
     D  POLNO                  1      2  0
     D  XLN                    1      2  0
     D UCMD            DS          1024
     D                 DS
     D XCMD11          C                   CONST('OVRPRTF -
     D                                     FILE(GSS022P) -
     D                                     OUTQ(')
     D XCMD21          C                   CONST('PAGESIZE(72 120) -
     D                                     CPI(15) -
     D                                     OVRFLW(63) -
     D                                     COPIES(')
     D XCMD21P         C                   CONST('DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
S05  D*                                    FRONTMGN(0 0.15) -
N05  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(63) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(0) -
     D                                     FORMTYPE(*STD) -
     D                                     COPIES(')
     D XCMD30          C                   CONST('OVRPRTF -
     D                                     FILE(GSS022P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
S05  D*                                    FRONTMGN(0 0.15) -
N05  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(63) -
     D                                     DRAWER(3) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(QFAX/QFAXOUTQ) -
     D                                     FORMTYPE(*STD)')
     D XCMD30e         C                   CONST('OVRPRTF -
     D                                     FILE(GSS022P) -
     D                                     DEV(FAX3812) -
     D                                     DEVTYPE(*AFPDS) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
N05  D                                     FRONTMGN(0.1 0.25) -
     D                                     OVRFLW(63) -
     D                                     PAGRTT(0) -
     D                                     OUTQ(OUTMAIL) -
     D                                     FORMTYPE(*STD)')
     D XCMD30B         C                   CONST('OVRPRTF -
     D                                     FILE(GSS022P) -
     D                                     DEVTYPE(*SCS) -
     D                                     PAGESIZE(66 125) -
     D                                     LPI(6) -
     D                                     CPI(10) -
     D                                     OVRFLW(60) -
     D                                     OUTQ(FAX/FAXOUT) -
     D                                     FORMTYPE(*STD)')
     D XCMD40          C                   CONST('OVRPRTF -
     D                                     FILE(GSS022P) -
     D                                     PAGESIZE(72 125) -
     D                                     LPI(6) -
     D                                     CPI(15) -
     D                                     FRONTMGN(0 0,15) -
     D                                     OVRFLW(63) -
     D                                     DRAWER(3) -
     D                                     PRTTXT(')
     D XCMD41          C                   CONST('OUTQ(')
     D XCMD90          C                   CONST('CLRPFM FILE(GSS022W)-
     D                                      MBR(')
     D XCMD91          C                   CONST('CLRPFM FILE(GSS031W)-
     D                                      MBR(')
     D XXTXT01         C                   CONST('Printed packinglist.')
     D XXTXT02         C                   CONST('Packinglist No.')
N04  D XXTXT01L        C                   CONST('Skrevet pakkliste.')
N04  D XXTXT02L        C                   CONST('Pakkliste Nr.')
     D                 DS
     D  F1                     1     21
     D                                     DIM(21)
     D  FAXNRP                 1     21
     D                 DS
     D  F2                     1     15
     D                                     DIM(15)
     D  WSFAXN                 1     15
     D  FAX05A                 1      4
     D                 DS
     D  F3                     1      6
     D                                     DIM(6)
     D  FAXRET                 1      6
     D  FAX05B                 1      4
     D                 DS
     D  KNAVN                  1     30
     D  KNAVNX                 1     30
     D                 DS
     D  XTIME                  1     14  0
     D  XTID4                  1      4  0
     D  XTID6                  1      6  0
     D  XDAG                   7      8  0
     D  XMND                   9     10  0
     D  XAAR                  11     14  0
     D                 DS
     D  XIDAGÅ                 1      4  0
     D  XIDAGM                 5      6  0
     D  XIDAGD                 7      8  0
     D  XIDAG                  1      8  0
     D                 DS
     D  TRDTLÅ                 1      4  0
     D  TRDTLM                 5      6  0
     D  TRDTLD                 7      8  0
     D  TRDTL                  1      8  0
     D                 DS
     D  XTDTLD                 1      2  0
     D  XTDTLM                 3      4  0
     D  XTDTLÅ                 5      6  0
     D  XTDTL                  1      6  0
     D                 DS
     D  TRDTSÅ                 1      4  0
     D  TRDTSM                 5      6  0
     D  TRDTSD                 7      8  0
     D  TRDTS                  1      8  0
     D                 DS
     D  XTDTSD                 1      2  0
     D  XTDTSM                 3      4  0
     D  XTDTSÅ                 5      6  0
     D  XTDTS                  1      6  0
     D                 DS
     D  ORDTLÅ                 1      4  0
     D  ORDTLM                 5      6  0
     D  ORDTLD                 7      8  0
     D  ORDTL                  1      8  0
     D                 DS
     D  XODTLD                 1      2  0
     D  XODTLM                 3      4  0
     D  XODTLÅ                 5      6  0
     D  XODTL                  1      6  0
     D                SDS
     D  UJOBNM               244    253
     D  UUSER                254    263
     D                UDS
     D  UFIRM                  1      2
     D  UCURR                  3      5
     D  UUSID                101    110
     D  UBICGR               111    112
     D  UBICNO               113    120  0
     D  UBIFC                121    123
     D  UBIPRT               124    133
     D  UBIPRM               134    143
N07  D  UBIPRP               149    158
N07  D  UBIPRI               159    168
     D  UWCNAM               544    573
     D  UWFAXN               574    588
     D  UWRET                591    596
     D  UWTIME               598    603  0
     D  UWDATE               606    611  0
     D  UCOVP                612    612
     D  UCOV01               613    652
     D  UCOV02               653    692
     D  UCOV03               693    732
     D  UCOV04               733    772
     D  UCOV05               773    812
     D  UCOV06               813    852
     D  UCOV07               853    892
     D  UCOV08               893    932
     D  UEMAIL               933   1002
     D  Uemailj             1003   1003
      *
     C                   EXSR      INIT
      *
     C     UTNO          CHAIN     GSSTRF                             33
     C  N33UTYPE         IFEQ      'PRT'
     C     UTYPE         OREQ      'CPY'
     C                   IF        TRST < '2'
     C  N50              MOVE      '1'           TRST
     C  N50              MOVE      XIDAG         TRDTP
     C                   END
     C                   UPDATE    GSSTRFR
     C                   MOVE      TRDTLD        XTDTLD
     C                   MOVE      TRDTLM        XTDTLM
     C                   MOVE      TRDTLÅ        XTDTLÅ
     C                   MOVE      TRDTSD        XTDTSD
     C                   MOVE      TRDTSM        XTDTSM
     C                   MOVE      TRDTSÅ        XTDTSÅ
      * IND. 28 PÅ BETYR TRANSITT
     C     TRBCD         COMP      *BLANKS                                28
N02  C  N28TRBCD         COMP      '*ALL'                                 28
     C  N28TRLOCF        COMP      *BLANKS                                28
      *
     C   50              EXSR      LESORD
      *
     C     TRFC          CHAIN     GSSFIF                             33
     C     CUND1K        CHAIN     CUNDL01                            33
     C     TRBCD         COMP      *BLANKS                                40
N02  C  N40TRBCD         COMP      '*ALL'                                 40
     C  N40TRBCD         CHAIN     CDBOAT                             33
     C                   TIME                    XTIME
      *
     C                   IF        UPRT = 'WEB'
     C                   ELSE
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
n09   * inger override ved arkiv
N09  c     UUTFAX        IFNE      'A'
     C     UUTFAX        IFEQ      'J'                                          1<-B
     c     uemail        ifne      *blanks
     C                   MOVEL     XCMD30e       UCMD
     c                   else
     C     FAXLIB        IFEQ      *BLANKS                                       2<-B
     C     FAXSYS        IFEQ      'B'
     C                   MOVEL     XCMD30B       UCMD
     C                   ELSE
     C                   MOVEL     XCMD30        UCMD
     C                   END
     C                   ELSE                                                    2
     C     XCMD40        CAT       '.FAX':1      UCMD
     C                   CAT       WSFAXN:0      UCMD
     C                   CAT       ')':1         UCMD
     C                   CAT       XCMD41:0      UCMD
     C                   CAT       FAXLIB:0      UCMD
     C                   CAT       '/':0         UCMD
     C                   CAT       FAXUTK:0      UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                     2<-E
     c                   end
     C                   ELSE
     C     XCMD11        CAT       UPRT:0        UCMD
     C                   CAT       ')':0         UCMD
     C     STRF01        IFEQ      '*PDF '
     C                   CAT       XCMD21P:1     UCMD
     C                   CAT       UCPY:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   ELSE
     C                   CAT       XCMD21:1      UCMD
     C                   CAT       UCPY:0        UCMD
     C                   CAT       ')':0         UCMD
     C                   END                                                    1<-E
     C                   END                                                    1<-E
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   END
N09  C                   END
      *
     C                   OPEN      GSS022P
      *
     C                   MOVE      '0'           *IN27
     c     ucpy          ifgt      '1'
     c     stresc        andeq     '¤    '
     c                   write     gss022co
     c                   end
     C                   WRITE     GSS022PA
      *
N06  C                   MOVE      *BLANKS       XORDRETYPE        1
N06  C     STPRT0        TAG
     C     *IN50         IFEQ      '0'
     C  N28UTNO          SETLL     GSSORL22                           33
     C   28UTNO          SETLL     GSSORL26                           33
     C                   ELSE
     C  N28*LOVAL        SETLL     GSS031W                            33
     C   28*LOVAL        SETLL     GSS022W                            33
     C                   END
     C     STPRT         TAG
     C     *IN50         IFEQ      '0'
     C  N28UTNO          READE     GSSORL22                               33
     C   28UTNO          READE     GSSORL26                               33
     C                   ELSE
     C  N28              READ(N)   GSS031W                                33
     C   28              READ(N)   GSS022W                                33
     C                   END
N06   *
N06  C                   IF        *IN33
S08  C*                  SELECT
N08  C  N50              SELECT
N06  C                   WHEN      XORDRETYPE = *BLANKS
N06  C                   EVAL      XORDRETYPE = 'C'
N06  C                   GOTO      STPRT0
N06  C                   WHEN      XORDRETYPE = 'C'
N06  C                   EVAL      XORDRETYPE = 'T'
N06  C                   GOTO      STPRT0
N08  C                   WHEN      XORDRETYPE = 'T'
N08  C                   EVAL      XORDRETYPE = 'X'
N08  C                   GOTO      STPRT0
N06  C                   OTHER
N06  C                   ENDSL
N06  C                   ELSE
N06  C  N50              IF        ORTYPE <> XORDRETYPE
N06  C  N28              UPDATE    GSSORFR
N06  C   28              UPDATE    GSSORF26
N06  C                   GOTO      STPRT
N06  C                   END
N06  C                   END
N06   *
     C     *IN33         IFEQ      '1'
     C     *IN50         IFEQ      '1'
     C   28              CLOSE     GSS022W
     C  N28              CLOSE     GSS031W
     C                   CLOSE     GSSORF
     C                   CLOSE     GSSORL21
     C                   CLOSE     GSSORL24
     C                   CLOSE     GSSORL25
     C                   END
     C                   ELSE
     C     *IN50         IFEQ      '0'
     C                   IF        ORST < '2'
     C                   MOVE      '1'           ORST
     C                   END
     C  N28              UPDATE    GSSORFR
     C   28              UPDATE    GSSORF26
     C                   END
      *
     C                   MOVE      ORDTLD        XODTLD
     C                   MOVE      ORDTLM        XODTLM
     C                   MOVE      ORDTLÅ        XODTLÅ
      *
     C                   MOVE      *BLANKS       CO
     C     ORONO         SETLL     GSSPOF                             34
     C     ORONO         READE     GSSPOF                                 34
     C     *IN34         DOWEQ     '0'
     C                   MOVE      POCONO        CO(XLN)
     C     ORONO         READE     GSSPOF                                 34
     C  N34              END
     C   40ORBCD         CHAIN     CDBOAT                             34
     C   40
     CAN 34              MOVE      *BLANKS       CBNAB
     C   40
     CAN 34              MOVEL     ORBCD         CBNAB
     C     XCONO4        COMP      *BLANKS                            3535
     C     XCONO5        COMP      *BLANKS                            3636
     C     XCONO6        COMP      *BLANKS                            3737
      *
     C     ORSNO         CHAIN     GSSSFF                             34
     C   34              MOVE      ORSNM         SFNM
     C   27              DO
     C                   WRITE     GSS022PD
     C                   WRITE     GSS022PA
     C                   WRITE     GSS022PD
     C                   MOVE      '0'           *IN27
     C                   END
     C                   EXSR      SJEKSECUR
     C                   WRITE     GSS022PB
      *
     C     7             DO        50            XN2               3 0
     C                   IF        CO(XN2) <> *BLANKS
     C   27              DO
     C                   WRITE     GSS022PD
     C                   WRITE     GSS022PA
     C                   WRITE     GSS022PD
     C                   MOVE      '0'           *IN27
     C                   END
     C                   MOVE      CO(XN2)       XCONOX
     C                   WRITE     GSS022PG
     C                   END
     C                   ENDDO
      *
     C     ORONO         SETLL     GSSGDF
     C     ORONO         READE     GSSGDF                                 34
     C     *IN34         DOWEQ     '0'
     C   27              DO
     C                   WRITE     GSS022PD
     C                   WRITE     GSS022PA
     C                   WRITE     GSS022PD
     C                   MOVE      '0'           *IN27
     C                   END
     C                   WRITE     GSS022PE
     C     ORONO         READE     GSSGDF                                 34
     C  N34              ENDDO
      *
     C     ORKDL1        IFEQ      'PL'
     C     ORKDL2        OREQ      'PL'
     C     ORKDL3        OREQ      'PL'
     C     1             DO        4             XN                1 0
     C     FT(XN)        IFNE      *BLANKS
     C                   MOVE      FT(XN)        XXFT
     C   27              DO
     C                   WRITE     GSS022PD
     C                   WRITE     GSS022PA
     C                   WRITE     GSS022PD
     C                   MOVE      '0'           *IN27
     C                   END
     C                   WRITE     GSS022PF
     C                   ENDIF
     C                   ENDDO
     C                   ENDIF
      *
     C                   GOTO      STPRT
     C                   END
N03   *
N03  C                   IF        TRKDL1 = 'PL' OR
N03  C                             TRKDL2 = 'PL' OR
N03  C                             TRKDL3 = 'PL'
N03  C     1             DO        4             XN
N03  C                   IF        TFT(XN) <> *BLANKS
N03  C                   EVAL      XTRFT = TFT(XN)
N03  C   27              DO
N03  C                   WRITE     GSS022PD
N03  C                   WRITE     GSS022PA
N03  C                   WRITE     GSS022PD
N03  C                   MOVE      '0'           *IN27
N03  C                   ENDDO
N03  C                   WRITE     GSS022PH
N03  C                   END
N03  C                   ENDDO
N03  C                   END
      *
     C                   WRITE     GSS022PC
     C                   CLOSE     GSS022P
      *
     C                   EXSR      OPDLOGG
      *
     C     UUTFAX        IFEQ      'J'
     C                   EXSR      SNDFAX
     C                   END
      *
     C                   ELSE
      *
     C     UTNO          SETLL     GSSORL22                           33
     C     STCFM         TAG
     C     UTNO          READE     GSSORL22                               33
     C  N33              DO
     C                   MOVE      '2'           ORST
     C     TRBCD         IFEQ      *BLANKS
     C     TRLOCT        ORNE      *BLANKS
     C                   MOVE      ORLC2         ORLC3
     C                   MOVE      ORLC          ORLC2
     C                   MOVE      'ONWAY'       ORLC
     C                   MOVE      ORDTL2        ORDTL3
     C                   MOVE      ORDTL         ORDTL2
     C                   MOVE      TRDTL         ORDTL
     C                   END
     C                   UPDATE    GSSORFR
     C                   GOTO      STCFM
     C                   END
     C                   MOVE      '2'           TRST
     C                   UPDATE    GSSTRFR
      *
     C                   END
      *
     C     SLUTT         TAG
N09  c     UTYPE         ifeq      'PRT'
N09  c     UUTFAX        andne     'A'
N09  c     UUTFAX        andne     'J'
N09  c                   exsr      arkivsr
N09  c                   end
      *
     C                   MOVE      '1'           *INLR
     C                   RETURN
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    TRCNO
     C     GSSLGL03K1    KLIST
     C                   KFLD                    XLGFTYP1
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'UNSEC'       XLGFTYP1          5
     C     GSSLGL03K2    KLIST
     C                   KFLD                    XLGFTYP2
     C                   KFLD                    OLONO
     C                   KFLD                    LGLNO
     C                   MOVE      'SECUR'       XLGFTYP2          5
      *
     C     *ENTRY        PLIST
     C                   PARM                    UTNO2            11
     C                   PARM                    UTYPE             3
     C                   PARM                    UCPY              1
     C                   PARM                    UPRT             10
     C                   PARM                    UUTFAX            1
     C                   PARM                    UQJOB            10
     C                   PARM                    UQUSER           10
     C                   PARM                    UQNBR             6
      *
      *
     C                   IF        UPRT = 'WEB'
     C     *LOVAL        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     UPRT          CHAIN     GSSBIF                             33
     C                   MOVE      FIFIRM        UFIRM
     C                   MOVE      'NOK'         UCURR
     C                   MOVE      BICGR         UBICGR
     C                   MOVE      BICNO         UBICNO
     C                   MOVE      BIFC          UBIFC
     C                   END
     C                   MOVE      UTNO2         UTNO             11 0
     C                   TIME                    XTIME
     C                   MOVE      XAAR          XIDAGÅ
     C                   MOVE      XMND          XIDAGM
     C                   MOVE      XDAG          XIDAGD
     C                   MOVE      *ZEROS        TRDTL
     C                   MOVE      *ZEROS        TRDTS
     C                   MOVE      *ZEROS        ORDTL
     C     *LIKE         DEFINE    ORONO         XONO
     C     *LIKE         DEFINE    ORONO         XONO1
     C     *LIKE         DEFINE    ORONO         XONO2
     C     *LIKE         DEFINE    ORONO         XONO3
     C     *LIKE         DEFINE    ORBCD         XBCD1
     C     *LIKE         DEFINE    ORBCD         XBCD2
     C     *LIKE         DEFINE    ORBCD         XBCD3
     C     UTYPE         COMP      'CPY'                                  50
N09  C     UUTFAX        COMP      'A'                                    51
     C  N50UCPY          IFEQ      '0'
     C                   MOVE      '1'           UCPY
     C                   END
      *
     C     UUTFAX        IFEQ      'J'
     C     UFIRM         CHAIN     FAXSEN                             33
     C                   END
      *
     C     UUTFAX        IFNE      'J'
     C     KEYST         KLIST
     C                   KFLD                    STRPRT
     C                   MOVE      UPRT          STRPRT
     C     KEYST         CHAIN     GSSSTK                             33
     C     *IN33         IFEQ      '0'
     C     STRF01        CHAIN     KODTFM                             33
      *
      * string for antall kopier ved tcp-ip
     c     ucpy          ifgt      '1'
     c     stresc        andeq     '¤    '
     c                   move      *blanks       strico           70
     C     strico        CAT       stresc:0      strico
     C     strico        CAT       '&l':0        strico
     C     strico        CAT       ucpy:0        strico
     C     strico        CAT       'X':0         strico
     c                   end
      *
      * ¤1B(¤1B(s0p15h6v0s0b0T'
     C     stresc        ifne      *blanks
N05  C     stresc        andne     '*PDF'
     c                   move      *blanks       stri01           70
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(':0         stri01
     C     stri01        CAT       stresc:0      stri01
     C     stri01        CAT       '(s0p15h6v0':0stri01
     C     stri01        CAT       's0b0T':0     stri01
     c                   end
      *
      *
     C                   END
     C                   END
      *
s09  c                   read      firm                                   33
     C                   ENDSR
      *
     C***********************************************
     C     LESORD        BEGSR
     C***********************************************
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD
     C     *IN28         IFEQ      '1'
     C     XCMD90        CAT       UJOBNM:0      UCMD
     C                   ELSE
     C     XCMD91        CAT       UJOBNM:0      UCMD
     C                   END
     C                   CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
      *
     C     *IN28         IFEQ      '1'
     C                   OPEN      GSS022W
     C                   ELSE
     C                   OPEN      GSS031W
     C                   END
     C                   OPEN      GSSORF
     C                   OPEN      GSSORL21
     C                   OPEN      GSSORL24
     C                   OPEN      GSSORL25
      *
     C     UTNO          SETLL     GSSORL21                           33
     C     UTNO          SETLL     GSSORL24                           34
     C     UTNO          SETLL     GSSORL25                           35
     C     STLES         TAG
     C     UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C     UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C     UTNO          READE     GSSORL25                               35
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
      *
     C     *IN33         DOWEQ     '0'
     C     *IN34         OREQ      '0'
     C     *IN35         OREQ      '0'
     C     XONO          CHAIN     GSSORF                             36
     C     *IN28         IFEQ      '1'
     C                   WRITE     GSS022WR
     C                   ELSE
     C                   WRITE     GSS031WR
     C                   END
     C     STLES2        TAG
     C                   SELECT
     C     XONO3         WHENEQ    XONO
     C  N35UTNO          READE     GSSORL25                               35
     C  N35              MOVE      ORONO         XONO3
     C  N35              MOVE      ORBCD         XBCD3
     C   35              Z-ADD     9999999       XONO3
     C   35              MOVE      '99999'       XBCD3
     C   35              GOTO      STLES2
     C     XONO2         WHENEQ    XONO
     C  N34UTNO          READE     GSSORL24                               34
     C   34              Z-ADD     9999999       XONO2
     C   34              MOVE      '99999'       XBCD2
     C  N34              MOVE      ORONO         XONO2
     C  N34              MOVE      ORBCD         XBCD2
     C                   OTHER
     C  N33UTNO          READE     GSSORL21                               33
     C   33              Z-ADD     9999999       XONO1
     C   33              MOVE      '99999'       XBCD1
     C  N33              MOVE      ORONO         XONO1
     C  N33              MOVE      ORBCD         XBCD1
     C                   ENDSL
     C                   SELECT
     C     XBCD3         WHENLT    XBCD1                                        XBCD3 ER MINST
     C     XBCD3         ANDLT     XBCD2
     C                   MOVE      XONO3         XONO
     C     XBCD2         WHENLT    XBCD1                                        XBCD2 ER MINST
     C     XBCD2         ANDLT     XBCD3                                        XBCD2 ER MINST
     C                   MOVE      XONO2         XONO
     C     XBCD1         WHENLT    XBCD2                                        XBCD1 ER MINST
     C     XBCD1         ANDLT     XBCD3
     C                   MOVE      XONO1         XONO
     C     XBCD1         WHENEQ    XBCD2                                        XBCD1=XBCD2
     C     XBCD1         ANDLT     XBCD3                                        XBCD3 ER STØRST
     C     XONO2         IFLT      XONO1                                        ORD2<ORD1
     C                   MOVE      XONO2         XONO
     C                   ELSE
     C                   MOVE      XONO1         XONO
     C                   END
     C     XBCD2         WHENEQ    XBCD3                                        XBCD2=XBCD3
     C     XBCD2         ANDLT     XBCD1                                        XBCD1 ER STØRST
     C     XONO3         IFLT      XONO2                                        ORD3<ORD2
     C                   MOVE      XONO3         XONO
     C                   ELSE
     C                   MOVE      XONO2         XONO
     C                   END
     C     XBCD3         WHENEQ    XBCD1                                        XBCD3=XBCD1
     C     XBCD3         ANDLT     XBCD2                                        XBCD2 ER STØRST
     C     XONO1         IFLT      XONO3                                        ORD3<ORD1
     C                   MOVE      XONO1         XONO
     C                   ELSE
     C                   MOVE      XONO3         XONO
     C                   END
     C                   OTHER                                                  XBCD1,2,3 ER LIKE
     C                   SELECT
     C     XONO3         WHENLT    XONO1
     C     XONO3         ANDLT     XONO2
     C                   MOVE      XONO3         XONO
     C     XONO2         WHENLT    XONO1
     C                   MOVE      XONO2         XONO
     C                   OTHER
     C                   MOVE      XONO1         XONO
     C                   ENDSL
     C                   ENDSL
     C  N33
     CORN34
     CORN35              END
      *
     C                   ENDSR
      *
     C***********************************************
     C     SNDFAX        BEGSR
     C***********************************************
     C     UWRET         IFNE      *BLANKS
     C                   EXSR      FAXFIX
     C                   ELSE
     C                   MOVEL     UWFAXN        FAXNRP
     C                   END
      *
     C                   MOVE      '*CURRENT'    PTIME             8
     C                   MOVE      '*CURRENT'    PDATE             8
     C     UWTIME        IFNE      *ZEROS
     C     UWDATE        IFNE      *ZEROS
     C                   MOVE      *BLANKS       PTIME
     C                   MOVEL     *BLANKS       PDATE
     C                   MOVEL     UWTIME        PTIME
     C                   MOVEL     UWDATE        PDATE
     C                   END
     C                   END
     C                   MOVE      'B'           UUKODE            1
     C                   MOVEL     'SHIPPACK'    DOKNAV           12
     C                   MOVE      'INGL'        DOKNAV
     C                   MOVE      *ZEROS        FAXAVD            4
     C                   MOVE      *ZEROS        FAXOPD            7
     C                   MOVE      *ZEROS        FAXTUR            8
     C                   MOVEL     'GSS022P '    FILEN            10
     C     UCOVP         IFEQ      ' '
     C                   MOVE      'N'           UCOVP
     C                   END
      *
     C     FAXSYS        IFEQ      'F'
     C     FAXLIB        IFEQ      *BLANKS
     c     uemail        orne      *blanks
     c     uemail        ifne      *blanks
     c                   movel     'MAIL        'FAXNRP
     c                   movel     uemail        uwcnam
     c                   move      'J'           uemailj
     c                   movel     'Packinglist 'emne             40
     c                   end
     C                   CALL      'GSS015C2'
     C                   PARM                    UCOVP
     C                   PARM                    UQJOB
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    FAXNRP
     C                   PARM                    FILEN
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   PARM                    uemail
     C                   PARM                    emne
     C                   PARM                    uemailj
     C                   ELSE
      * VED FAX400 SENDER SYSTEMET AUTOMATISK FRA UTKØ
     C                   END
      *
     C                   MOVEL     UQUSER        MAPPE            20
     C                   CALL      'FAX013'
     C                   PARM                    UQUSER
     C                   PARM                    UQNBR
     C                   PARM                    UQJOB
     C                   PARM                    FAXNRP
     C                   PARM                    DOKNAV
     C                   PARM                    MAPPE
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    UWCNAM
     C                   PARM                    FAXAVD
     C                   PARM                    FAXOPD
     C                   PARM                    FAXTUR
     C                   PARM                    UUKODE
     C                   END
      *
     C     FAXSYS        IFEQ      'B'
     C     FIFIRM        CHAIN     FAXMANT                            33
     C   33              Z-ADD     1             UNIK
     C  N33              ADD       1             UNIK
     C   33              WRITE     FAXMANTR
     C  N33              UPDATE    FAXMANTR
     C                   EVAL      PRTFIL = 'GSS022P'
     C                   OPEN      FAXMANP
     C                   MOVE      UQNBR         JOBNR
     C                   EVAL      KNAVN = UWCNAM
     C                   EVAL      FINAVN = FIFT
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVEL     WDT           PUDATE
     C                   EXCEPT    SKRIV
     C                   CLOSE     FAXMANP
     C                   CALL      'GSS015C3'
     C                   PARM                    KNAVN
     C                   PARM                    FAXNRP
     C                   PARM                    UNIK
     C                   PARM                    PTIME
     C                   PARM                    PDATE
     C                   PARM                    PRTFIL           10
     C                   PARM                    DOKNAV
     C                   PARM                    UCOVP
     C                   PARM                    UCOV01
     C                   PARM                    UCOV02
     C                   PARM                    UCOV03
     C                   PARM                    UCOV04
     C                   PARM                    UCOV05
     C                   PARM                    UCOV06
     C                   PARM                    UCOV07
     C                   PARM                    UCOV08
     C                   END
      *
     C                   ENDSR
      *
     C*****************************************************
     C     FAXFIX        BEGSR
     C*****************************************************
     C                   MOVE      UWRET         FAXRET
     C                   MOVE      UWFAXN        WSFAXN
     C                   Z-ADD     1             A1                2 0
     C                   Z-ADD     1             A2                2 0
     C                   Z-ADD     1             A3                2 0
     C                   DO        6
     C     F3(A3)        IFNE      *BLANKS
     C                   MOVEL     F3(A3)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A3
     C                   END
     C                   DO        15
     C     F2(A2)        IFNE      *BLANKS
     C                   MOVEL     F2(A2)        F1(A1)
     C                   ADD       1             A1
     C                   END
     C                   ADD       1             A2
     C                   END
     C                   ENDSR
      *
      *=====================================================================
      *  Oppdater loggen
      *=====================================================================
     C     OPDLOGG       begsr
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
      *
     C                   MOVEL     UTNO          TTAVD
     C                   MOVE      UTNO          TTOPD
     C                   MOVE      WDT           TTDATE
     C                   MOVE      WTM           TTTIME
     C                   MOVE      WDT           TTDATL
     C                   MOVE      WTM           TTTIML
     C                   MOVE      'PS1'         TTACTI
     C                   MOVE      UUSER         TTUSER
     C                   EVAL      TTTEXT = XXTXT01
     C                   CAT       XXTXT02:10    TTTEXT
     C                   CAT       UTNO2:1       TTTEXT
n04  C                   EVAL      TTTEXL = XXTXT01L
n04  C                   CAT       XXTXT02L:10   TTTEXL
n04  C                   CAT       UTNO2:1       TTTEXL
     C                   WRITE     TRACKFR
      *
     C                   endsr
      *
     C***********************************************
     C     SJEKSECUR     BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       XSECUR
     C     ORONO         SETLL     GSSOLF
     C     ORONO         READE     GSSOLF                                 33
     C                   DOW       *IN33 = *OFF
     C                   MOVE      OLLNO         LGLNO
      * SJEKK OM KOLLI ER IKKE "SECURED"
     C     GSSLGL03K1    CHAIN     GSSLGL03                           33
     C                   IF        *IN33 = *OFF
     C                   MOVE      'U'           XSECUR
     C                   LEAVE
     C                   ELSE
      * SJEKK OM KOLLI ER "SECURED"
     C     GSSLGL03K2    CHAIN     GSSLGL03                           33
     C  N33              IF        XSECUR = *BLANKS
     C                   MOVE      'S'           XSECUR
     C                   END
     C                   END
     C     ORONO         READE     GSSOLF                                 33
     C  N33              ENDDO
      *
      * SJEKK OM FARLIG GODS
     C     ORONO         CHAIN     GSSFGF                             33
N01  C   33ORONO         CHAIN     GSSDGF                             33
     C  N33              MOVE      '1'           *IN(29)
     C   33              MOVE      '0'           *IN(29)
      *
     C                   ENDSR
      *
n09   **********************************************************************
n09  C     arkivsr       begsr
n09   **********************************************************************
     c*                  dump
n09  C     FIFIRM        CHAIN     FIRMARC                            33
n09  C     *IN33         IFEQ      '0'
n09  C     'pl'          chain     arktxt                             33
n09  C     *IN33         IFEQ      '0'
n09  C     arkjn         andeq     'J'
n09   *
n09  C                   MOVE      FIFIRM        ARFIRM
n09  C                   MOVEl     UTNO2         ARAVD
n09  C                   MOVE      UTNO2         AROPD
n09  C                   MOVE      'pl'          ARTYPE
n09  C                   MOVE      UUSER         ARUSER
n09  C                   MOVE      XIDAG         ARDATE
n09  C                   MOVE      XTID6         ARTIME
n09  C                   MOVE      TRCNO         ARKUND
n09  C                   WRITE     ARKIVR
     c                   move      'N'           arnei             1
     C                   CALL      'ARC002CLC'
     c                   parm                    artype
     c                   parm                    aruser
     c                   PARM                    arnei
n09  C                   END
n09  C                   END
n09  C                   ENDSR
     OFAXMANR   EADD         SKRIV
     O                       UNIK
     O                       FAXNRP
     O                       PTIME
     O                       PDATE
     O                       KUNDNR
     O                       KNAVN
     O                       TIL
     O                       FRA
     O                       EMNE
     O                       FINAVN
     O                       JOBNR
     O                       PUDATE
