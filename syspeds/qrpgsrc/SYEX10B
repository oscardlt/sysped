********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 02 SH  PTF10 SØKe leveringsadresse
********************************************************************
      *
      ***************************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE CMR-FRAKTBREV (LAND-EKSPORT)  ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER        ***
      *** LEDIGE INDIKATORER 07-11 13-15 17-26                    ***
      *** LEDIGE INDIKATORER 30 35-99                             ***
      *** INDIKATOR 29 PÅ --> KALLE FRA SPØRRING PÅ OPD (SYFM21B) ***
      ***           29 AV --> KALLE FRA REGISTRERING              ***
      *** (29AV OG) 32 AV --> KALLE FRA SYEX10  (REG. TRANSP.OPD) ***
      *** (29AV OG) 32 PÅ --> KALLE FRA SYTR10  (REG. TRANSP.OPD) ***
      *** INDIKATOR 28 PÅ --> SETT ALARM PÅ (MELDING FRA SYEX10)  ***
      ***           28 AV -->     ""     AV (INGEN MELDING)       ***
      ***************************************************************
      *
     FDOKEC     UF A E           K DISK
     FHEADF     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FVADR      if   E           K DISK
     FKODTLB    IF   E           K DISK
     FKODTFR    IF   E           K DISK
E01  FSYEX10FB  CF   E             WORKSTN INFDS(FBAREA)
N01  D FBAREA          DS
N01  D  WSCLOC               370    371B 0
N01  D  WSSUBN               378    379B 0
     D                 DS
     D  DCDT                   1      8  0
     D  DCDTÅ                  1      4  0
     D  DCDTM                  5      6  0
     D  DCDTD                  7      8  0
     D                 DS
     D  WSDT                   1      6  0
     D  WSDTD                  1      2  0
     D  WSDTM                  3      4  0
     D  WSDTÅ                  5      6  0
     D* KOMPLETT NAVN/ADRESSE KJØPER FRA OPPDRAG (LEV.ADR)
     D                 DS
     D  HENAK                  1     30
     D  HEADK1                31     60
     D  HEADK2                61     90
     D  HEADK3                91    120
     D  XADK31                91     94
     D  XADK32                96    120
     D  DSHENA                 1    120
     D* KOMPLETT NAVN/ADRESSE MOTTAKER PÅ CMR
     D                 DS
     D  WSNAM                  1     30
     D  WSADM1                31     60
     D  WSADM2                61     90
     D  WSADM3                91    120
     D  DSCMNA                 1    120
     D* "FRANKATURSTED" AVSENDER
     D                 DS
     D  HEADS3                 1     30
     D  XADS31                 1      4
     D  XADS32                 6     30
     D* IMCO
     D                 DS
     D  IMCDS                  1     17
     D  IMCDS1                 1      5
     D  TRFA11                 6     12
     D  IMCDS2                13     13
     D  TRFA12                14     17
     D                 DS
     D  FLP1DS                 1     10
     D  TRFLP1                 6      8  0
     D* ADR-CLASSIFIED
     D                 DS
     D  ADRDS                  1     17
     D  ADRDS1                 1      5
     D  TRFA21                 6     12
     D  ADRDS2                13     13
     D  TRFA22                14     17
     D                 DS
     D  FLP2DS                 1     10
     D  TRFLP2                 6      8  0
     D                 DS
     D  NOTADR                 1     18
     D  NOTAD1                 1      8
     D  NOTAD2                 9     16
     D  NOTAD3                17     18
     D                 DS
     D  KLBXXX                 1     35
     D  KLBHAD                 2      2
N01  D                UDS
N01  D  FIFIRM                 1      2
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE01
     C                   EXSR      KDTFMT
     C                   SETOFF                                       27
     C   01              Z-ADD     1             UFLAGG
     C   01              GOTO      SLUTT
     C   02              Z-ADD     2             UFLAGG
     C   02              GOTO      SLUTT
     C   03
     CAN 29              Z-ADD     3             UFLAGG
     C   03
     CAN 29              GOTO      SLUTT
     C   06
     CAN 29              GOTO      SLUTT
     C   12
     CAN 29              Z-ADD     9             UFLAGG
     C   12
     CANN29              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
      * KOLLI-ID-MERKELAPPER (FR.BREV 1, VARELINJE 0)
     C     *IN13         IFEQ      *ON
     C                   MOVE      *ZEROS        ULINR             2 0
     C                   Z-ADD     1             UFBNR             3 0
     C                   MOVE      *BLANK        UVIS              1
     C   29              MOVE      'J'           UVIS              1
     C                   CALL      'SYFA10B'
     C                   PARM                    UAVD
     C                   PARM                    UOPD
     C                   PARM                    UFBNR
     C                   PARM                    ULINR
     C                   PARM                    UVIS
     C                   GOTO      START
     C                   ENDIF
     C   04              EXSR      SØKKUN
     C*
     C                   EXSR      TESTB
     C  N03
     CANN05
     CANN16              GOTO      START
     C*
     C                   EXSR      OPDDOK
     C   03              Z-ADD     3             UFLAGG
     C   05              Z-ADD     5             UFLAGG
     C   16              Z-ADD     6             UFLAGG
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C******************************************
     C     TESTB         BEGSR
     C******************************************
     C*
     C* TEST AVSENDER
     C     WSKNA         IFNE      0
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      XMSG          WSNAA
     C  N33              MOVE      KNAVN         WSNAA
     C                   END
     C*
     C* TEST MOTTAGER
     C     WSKNM         IFNE      0
     C                   MOVE      WSKNM         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              DO
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSADM1
     C                   MOVE      ADR2          WSADM2
     C                   MOVE      *BLANKS       WSADM3
     C     POSTNR        IFEQ      0
     C     sypoge        ifne      *blanks
     C                   move      *blanks       wsadm3
     C     wsadm3        CAT       sypoge:0      WSadm3
     C     wsadm3        cat       adr3:1        wsadm3
     c                   else
     C                   MOVEL     ADR3          WSADM3
     c                   end
     C                   ELSE
     C                   MOVEL     POSTNR        WSADM3
     C                   MOVE      ADR3          WSADM3
     C                   END
     C                   END
     C                   END
     C*
     C* TEST FRAKTFØRER
     C     WSKNFF        IFNE      0
     C                   MOVE      WSKNFF        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      XMSG          WSNAFF
     C  N33              MOVE      KNAVN         WSNAFF
     C                   END
     C* HENT FRANKATURTEKST (ENGELSK)
     C     KODFRK        CHAIN     KODTFR                             33
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVHFW        BEGSR
     C***********************************************
     C* FRA ORDINÆR EKSPORTMODUL
     C  N32HEKNA         IFEQ      0
     C                   MOVE      HENAK         WSNAM
     C                   MOVE      HEADK1        WSADM1
     C                   MOVE      HEADK2        WSADM2
     C                   MOVE      HEADK3        WSADM3
     C                   ELSE
     C* AGENT ER DEFAULT MOTTAKER
     C                   MOVE      HEKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            34
     C  N34              DO
     c     vadr1k        chain     vadr                               34
     c     *in34         ifeq      '0'
     C                   MOVE      VADRNA        WSNAm
     C                   MOVE      VADRN1        WSADm1
     C                   MOVE      VADRN2        WSADm2
     C                   MOVE      VADRN3        WSADm3
     c                   else
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSADM1
     C                   MOVE      ADR2          WSADM2
     C                   MOVE      *BLANKS       WSADM3
     C     POSTNR        IFEQ      0
     C     sypoge        ifne      *blanks
     C                   move      *blanks       wsadm3
     C     wsadm3        CAT       sypoge:0      wsadm3
     C     wsadm3        cat       adr3:1        wsadm3
     c                   else
     C                   MOVEL     ADR3          WSADM3
     c                   end
     C                   ELSE
     C                   MOVEL     POSTNR        WSADM3
     C                   MOVE      ADR3          WSADM3
     C                   END
     C                   END
     C                   END
     C* LEV.ADR.??
     C     HEKNA         IFNE      HEKNK
     C                   MOVE      HENAK         WSNAL
     C                   MOVE      HEADK1        WSADL1
     C                   MOVE      HEADK2        WSADL2
     C                   MOVE      HEADK3        WSADL3
     C                   END
     C                   END
     C* FRA TRANSPORT MODUL
     C   32HEKNK         IFEQ      0
     C                   MOVE      HENAK         WSNAM
     C                   MOVE      HEADK1        WSADM1
     C                   MOVE      HEADK2        WSADM2
     C                   MOVE      HEADK3        WSADM3
     C                   ELSE
     C                   MOVE      HEKNK         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            34
     C  N34              DO
     c     vadr1k        chain     vadr                               34
     c     *in34         ifeq      '0'
     C                   MOVE      VADRNA        WSNAm
     C                   MOVE      VADRN1        WSADm1
     C                   MOVE      VADRN2        WSADm2
     C                   MOVE      VADRN3        WSADm3
     c                   else
     C                   MOVE      KNAVN         WSNAM
     C                   MOVE      ADR1          WSADM1
     C                   MOVE      ADR2          WSADM2
     C                   MOVE      *BLANKS       WSADM3
     C     POSTNR        IFEQ      0
     C     sypoge        ifne      *blanks
     C                   move      *blanks       wsadm3
     C     wsadm3        CAT       sypoge:0      wsadm3
     C     wsadm3        cat       adr3:1        wsadm3
     c                   else
     C                   MOVEL     ADR3          WSADM3
     c                   end
     C                   ELSE
     C                   MOVEL     POSTNR        WSADM3
     C                   MOVE      ADR3          WSADM3
     C                   END
     C                   END
     C                   END
     C* LEV.ADR?
     C     DSHENA        IFNE      DSCMNA
     C                   MOVE      HENAK         WSNAL
     C                   MOVE      HEADK1        WSADL1
     C                   MOVE      HEADK2        WSADL2
     C                   MOVE      HEADK3        WSADL3
     C                   END
     C                   END
     C* IMCO M.M.
     C* ANTALL LEDIGE FOR FORT.AGENT ER ENTEN 3 ELLER 2
     C                   Z-ADD     2             ANTLED            1 0
     C* NOT ADR.CLASIFIED?
     C     TRFA11        IFEQ      *BLANKS                                      B2
     C     TRFA21        ANDEQ     *BLANKS
     C                   MOVEL     NOTADR        WSAI1
     C                   ELSE                                                   X2
     C*IMCO?
     C     TRFA11        IFNE      *BLANKS                                       B3
     C                   MOVEL     IMCDS         WSAI1
     C* FLASH.POINT??
     C     TRFLP1        IFNE      *ZEROS                                         B4
     C                   MOVE      FLP1DS        WSAI1
     C                   END                                                      E4
     C                   END                                                     E3
     C* A-CLASSIFIED?
     C     TRFA21        IFNE      *BLANKS                                       B3
     C                   MOVEL     ADRDS         WSAI2
     C* FLASH.POINT??
     C     TRFLP2        IFNE      *ZEROS                                         B4
     C                   MOVE      FLP2DS        WSAI2
     C                   END                                                      E4
     C                   END                                                     E3
     C* LINJE 2 UTFYLLT MEN 1 BLANK - BYTT.
     C     WSAI1         IFEQ      *BLANKS                                       B3
     C     WSAI2         ANDNE     *BLANKS
     C                   MOVE      WSAI2         WSAI1
     C                   MOVE      *BLANKS       WSAI2
     C                   ADD       1             ANTLED
     C                   END                                                     E3
     C                   END                                                    E2
     C   32              DO                                                     B1
     C* FORTOLLINGSAGENT???
     C     HEKNA         IFNE      *ZEROS                                       B2
     C                   MOVE      HEKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            34
     C  N34              DO                                                      B3
     C                   MOVEL     KNAVN         WSAIXX           25
     C     ANTLED        IFEQ      3                                              B4
     C                   MOVEL     'VERZ:'       WSAI2
     C                   MOVE      WSAIXX        WSAI2
     C                   ELSE                                                     X4
     C                   MOVEL     'VERZ:'       WSAI3
     C                   MOVE      WSAIXX        WSAI3
     C                   END                                                      E4
     C     ANTLED        IFEQ      3                                              B4
     C                   MOVEL     ADR2          WSAIXX           25
     C                   MOVE      WSAIXX        WSAI3
     C                   END                                                      E4
     C     POSTNR        IFEQ      0                                              B4
     C     sypoge        ifne      *blanks
     C                   move      *blanks       WSAI4
     C     WSAI4         CAT       sypoge:0      WSAI4
     C     WSAI4         cat       adr3:1        WSAI4
     c                   else
     C                   MOVEL     ADR3          WSAI4
     c                   end
     C                   ELSE                                                     X4
     C                   MOVEL     POSTNR        WSAI4
     C                   MOVE      ADR3          WSAI4
     C                   END                                                      E4
     C                   MOVEL     WSAI4         WSAIXX
     C                   MOVE      *BLANKS       WSAI4
     C                   MOVE      WSAIXX        WSAI4
     C                   END                                                     E3
     C                   END                                                    E2
     C                   END                                                    E1
     C* FRANKATURKODE
     C                   MOVE      HEFR          WSFR
     C* HENT FRANKATURTEKST (ENGELSK)
     C     KODFRK        CHAIN     KODTFR                             34
     C* HENT REGEL FOR EVT. DEFAULT FRANKATURSTED
     C     KODLBK        CHAIN     KODTLB                             34
     C  N34KLBHAD        IFEQ      'A'
     C     XADS31        IFGE      '0000'
     C     XADS31        ANDLE     '9999'
     C                   MOVEL     XADS32        WSFRFT
     C                   ELSE
     C                   MOVEL     HEADS3        WSFRFT
     C                   END
     C                   END
     C  N34KLBHAD        IFEQ      'M'
     C     XADK31        IFGE      '0000'
     C     XADK31        ANDLE     '9999'
     C                   MOVEL     XADK32        WSFRFT
     C                   ELSE
     C                   MOVEL     HEADK3        WSFRFT
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVDCW        BEGSR
     C***********************************************
     C                   MOVE      DCKNA         WSKNA
     C     WSKNA         IFNE      0
     C                   MOVE      WSKNA         KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      XMSG          WSNAA
     C  N33              MOVE      KNAVN         WSNAA
     C                   END
     C                   MOVE      DCKNM         WSKNM
     C                   MOVE      DCNAM         WSNAM
     C                   MOVE      DCNAL         WSNAL
     C                   MOVE      DCADM1        WSADM1
     C                   MOVE      DCADL1        WSADL1
     C                   MOVE      DCADM2        WSADM2
     C                   MOVE      DCADL2        WSADL2
     C                   MOVE      DCADM3        WSADM3
     C                   MOVE      DCADL3        WSADL3
     C                   MOVE      DCAI1         WSAI1
     C                   MOVE      DCVL1         WSVL1
     C                   MOVE      DCAI2         WSAI2
     C                   MOVE      DCVL2         WSVL2
     C                   MOVE      DCAI3         WSAI3
     C                   MOVE      DCVL3         WSVL3
     C                   MOVE      DCAI4         WSAI4
     C                   MOVE      DCFR          WSFR
     C     KODFRK        CHAIN     KODTFR                             33        *HENT TEKST
     C                   MOVE      DCFRFT        WSFRFT
     C                   MOVE      DCKNFF        WSKNFF
     C     WSKNFF        IFNE      0
     C                   MOVE      WSKNFF        KUNDNR
     C     KUND1K        CHAIN     CUNDL01                            33
     C   33              MOVE      XMSG          WSNAFF
     C  N33              MOVE      KNAVN         WSNAFF
     C                   END
     C                   MOVE      DCFT          WSFT
     C                   MOVE      DCVAL         WSVAL
     C                   MOVE      DCBEL         WSBEL
     C                   MOVE      DCDTD         WSDTD
     C                   MOVE      DCDTM         WSDTM
     C                   MOVE      DCDTÅ         WSDTÅ
     c                   move      dcr12a        wsr12a
     c                   move      dcr12b        wsr12b
     c                   move      dcr12c        wsr12c
     c                   move      dcr13a        wsr13a
     c                   move      dcr13b        wsr13b
     c                   move      dcr13c        wsr13c
     c                   move      dcr13d        wsr13d
     c                   move      dcmlap        wsmlap
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     OPDDOK        BEGSR
     C***********************************************
     C     DOKECK        CHAIN     DOKEC                              33
     C*
     C   33              DO
     C                   MOVE      UAVD          DCAVD
     C                   MOVE      UOPD          DCOPD
     C                   END
     C*
     C                   MOVE      ' '           DCST
     C                   MOVE      HESG          DCSG
     C                   MOVE      WSKNA         DCKNA
     C                   MOVE      WSKNM         DCKNM
     C                   MOVE      WSNAM         DCNAM
     C                   MOVE      WSNAL         DCNAL
     C                   MOVE      WSADM1        DCADM1
     C                   MOVE      WSADL1        DCADL1
     C                   MOVE      WSADM2        DCADM2
     C                   MOVE      WSADL2        DCADL2
     C                   MOVE      WSADM3        DCADM3
     C                   MOVE      WSADL3        DCADL3
     C                   MOVE      WSAI1         DCAI1
     C                   MOVE      WSVL1         DCVL1
     C                   MOVE      WSAI2         DCAI2
     C                   MOVE      WSVL2         DCVL2
     C                   MOVE      WSAI3         DCAI3
     C                   MOVE      WSVL3         DCVL3
     C                   MOVE      WSAI4         DCAI4
     C                   MOVE      WSFR          DCFR
     C                   MOVE      WSFRFT        DCFRFT
     C                   MOVE      WSKNFF        DCKNFF
     C                   MOVE      WSFT          DCFT
     C                   MOVE      WSVAL         DCVAL
     C                   MOVE      WSBEL         DCBEL
     C     WSDT          IFEQ      0
     C                   MOVE      *ZEROS        DCDT
     C                   ELSE
     C                   MOVE      WSDTD         DCDTD
     C                   MOVE      WSDTM         DCDTM
     C     WSDTÅ         IFGT      50
     C     WSDTÅ         ADD       1900          DCDTÅ
     C                   ELSE
     C     WSDTÅ         ADD       2000          DCDTÅ
     C                   END
     C                   END
     c                   move      wsr12a        dcr12a
     c                   move      wsr12b        dcr12b
     c                   move      wsr12c        dcr12c
     c                   move      wsr13a        dcr13a
     c                   move      wsr13b        dcr13b
     c                   move      wsr13c        dcr13c
     c                   move      wsr13d        dcr13d
     c                   move      wsmlap        dcmlap
     C*
     C   33              WRITE     DOKECR
     C  N33              UPDATE    DOKECR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S01  C*                  CALL      'SOEKUN'
S01  C*                  PARM                    UFIRM
S01  C*                  PARM                    SOANTK
S01  C*                  PARM                    SOTXT1
S01  C*                  PARM                    WSKNA
S01  C*                  PARM                    SOTXT2
S01  C*                  PARM                    WSKNM
S01  C*                  PARM                    SOTXT3
S01  C*                  PARM                    WSKNFF
S01  C*                  PARM                    SOTXT4
S01  C*                  PARM                    SOKNR4
S01  C*                  PARM                    SOTXT5
S01  C*                  PARM                    SOKNR5
S01  C*                  PARM                    SOTXT6
S01  C*                  PARM                    SOKNR6
S01  C*                  PARM                    SOTXT7
S01  C*                  PARM                    SOKNR7
S01  C*                  PARM                    SOTXT8
S01  C*                  PARM                    SOKNR8
N01   *
N01  C     WSCLOC        DIV       256           LINNBR
N01  C                   MVR                     POSNBR
N01   *
N01  C     LINNBR        IFEQ      4
N01  C     POSNBR        ANDGE     28
N01  C     POSNBR        ANDLE     35
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNM
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    WSNAM
N01  C                   Z-ADD     5             LINNBR
N01  C                   Z-ADD     43            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      3
N01  C     POSNBR        ANDGE     28
N01  C     POSNBR        ANDLE     35
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNFF
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     4             LINNBR
N01  C                   Z-ADD     28            POSNBR
N01  C                   END
N01   *
N01  C     LINNBR        IFEQ      2
N01  C     POSNBR        ANDGE     28
N01  C     POSNBR        ANDLE     35
N01  C                   MOVE      *BLANKS       UKNAVN           30
N01  C                   CALL      'SOEKKUN'
N01  C                   PARM                    WSKNA
N01  C                   PARM                    FIFIRM
N01  C                   PARM                    UKNAVN
N01  C                   Z-ADD     3             LINNBR
N01  C                   Z-ADD     28            POSNBR
N01  C                   END
N01  C     LINNBR        IFEQ      5
N02  C     POSNBR        ANDGE     43
N02  C     POSNBR        ANDLE     72
N02  C     WSKNM         ANDNE     *zeros
N02  C                   CALL      'SOEKVADR'
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    WSKNM
N02  C                   PARM                    WSNAL
N02  C                   PARM                    WSADl1
N02  C                   PARM                    WSADl2
N02  C                   PARM                    WSADl3
N02  C                   PARM                    WSLAND            2
N02  C                   PARM                    UADRNR            5
N02  C                   END
     C                   SETON                                        27
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     DOKECK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     HEADFK        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UOPD
     C     KUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     vadr1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C                   KFLD                    vadrnr
     c                   Z-ADD     1             vadrnr
     C     KODLBK        KLIST
     C                   KFLD                    YLBUNI
     C                   KFLD                    WSFR
     C                   MOVE      'LB'          YLBUNI            2
     C     KODFRK        KLIST
     C                   KFLD                    YFRUNI
     C                   KFLD                    WSFR
     C                   MOVE      'FR'          YFRUNI            2
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UOPD              7 0
     C                   PARM                    UMSG             62
     C                   PARM                    UFLAGG            1 0
     C     UMSG          COMP      *BLANKS                            2828
     C     UFLAGG        COMP      9                                      29
     C                   Z-ADD     0             UFLAGG
     C                   MOVE      *ZEROS        DCDT
     C                   MOVE      *ZEROS        WSDT
     C*
     C     HEADFK        CHAIN     HEADF                              33
     C  N33HEUR          IFEQ      'H'                                          *TRANSP.MODUL
     C                   SETON                                        32        *--> 32 ON
     C                   END
     C     DOKECK        CHAIN(N)  DOKEC                              33
     C*
     C* IF REQUEST AND NOT FOUND RETRN
     C*
     C   29
     CAN 33              SETON                                        LR
     C   29
     CAN 33              RETURN
     C* DATASTRUKTURER FOR FARLIG GODS KOMMENTAR I AVSEND. INFO.
     C                   MOVE      'ADR: '       ADRDS1
     C                   MOVE      '-'           ADRDS2
     C                   MOVE      'IMC: '       IMCDS1
     C                   MOVE      '-'           IMCDS2
     C                   MOVEL     'FLP: '       FLP1DS
     C                   MOVEL     'FLP: '       FLP2DS
     C                   MOVE      'NOT ADR '    NOTAD1
     C                   MOVE      'CLASSIFI'    NOTAD2
     C                   MOVE      'ED'          NOTAD3
     C   33              EXSR      MOVHFW
     C  N33              EXSR      MOVDCW
     C*
     C*
S01  C*                  Z-ADD     3             SOANTK            1 0
S01  C*                  MOVE      'DIV0638'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    SOTXT1            8
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*                  MOVE      'DIV0639'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    SOTXT2            8
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*                  MOVE      'DIV0640'     XMSGNR
S01  C*                  Z-ADD     3             XLEVEL
S01  C*                  Z-ADD     0             XRETUR
S01  C*                  Z-ADD     8             XMSGL
S01  C*                  CALL      'SUBR23R3'
S01  C*                  PARM                    XMSGNR
S01  C*                  PARM                    SOTXT3            8
S01  C*                  PARM                    XLEVEL
S01  C*                  PARM                    XRETUR
S01  C*                  PARM                    XMSGL
S01  C*                  MOVE      *BLANKS       SOTXT4            8
S01  C*                  MOVE      *BLANKS       SOTXT5            8
S01  C*                  MOVE      *BLANKS       SOTXT6            8
S01  C*                  MOVE      *BLANKS       SOTXT7            8
S01  C*                  MOVE      *BLANKS       SOTXT8            8
S01  C*                  MOVE      *ZEROS        SOKNR4            8 0
S01  C*                  MOVE      *ZEROS        SOKNR5            8 0
S01  C*                  MOVE      *ZEROS        SOKNR6            8 0
S01  C*                  MOVE      *ZEROS        SOKNR7            8 0
S01  C*                  MOVE      *ZEROS        SOKNR8            8 0
     C                   MOVE      'DIV0637'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     30            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XMSG             30
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSDT          XDTFMT            4 0
     C                   MOVEL     WSDT          UDT1              2 0
     C                   MOVEL     XDTFMT        UDT2              2 0
     C                   MOVE      XDTFMT        UDT3              2 0
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   MOVEL     UDT1          WSDT
     C                   MOVEL     UDT2          XDTFMT
     C                   MOVE      UDT3          XDTFMT
     C                   MOVE      XDTFMT        WSDT
     C*
     C                   ENDSR
     C*
