********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 endret litt på awbnummer markelapp
10XXX * 02 SH  PTF10 F = AFP skal ha samme som P=PDF
10XXX * 03 CB  PTF10 Rettelse på feil endring 01
10XXX * 04 SH  PTF10 D=dobbeltsidig utskrift
10XXX * 05 SH  PTF10 TD FLASH
10XXX * 06 SH  PTF10 overstyre dato
10172 * 07 SH  PTF10 other charges utvidet fra 6-9 gebyr + sum agent
10172 * 08 SH  PTF10 adresselinje 3  ved utlending
10172 * 09 SH  PTF10 desimaler due agent
10172 * 10 SH  PTF10 feil ved TLF nummer
10172 * 11 SH  PTF10 OVERSTYRE FLYFRAKTMERKELAPP
      * ------------------------------------------------------------
10172 * 12 SH  PTF11 riktig avdeling til arkiv
10172 * 13 SH  PTF11 fullt sett ved epost
10172 * 14 SH PTF11 Utkrift av merkelapp
10172 * 15 SH PTF11 handling info lapp
10172 * 16 SH PTF11 merkelapp til arkiv
10172 * 17 SH PTF11 feil i 14
10172 * 18 SH PTF12 henter fra freetxt
12217 * 19 SH  PTF12 calltype B ARKIVERING type an = fullt sett
12217 * 20 SH  PTF12 arkivendring
12217 * 21 SH  PTF12 sidebruddproblem
********************************************************************
     FFREETXT2  IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E             DISK
     FDOKEQM    IF   E           K DISK
     FHEAD19    IF   E           K DISK
     FSAMLB     IF   E           K DISK
     FDOKEF     UF   E           K DISK
     FDOKEM     UF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FELOGO     IF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTASID  IF   E           K DISK
     FKODTW     IF   E           K DISK
     FTELLA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTFS    IF   E           K DISK
     FKODTDIS   IF   E           K DISK
     FFIRM      IF   E           K DISK
     FCNFF      UF   E             DISK    USROPN
     FISUL01    IF   E           K DISK    USROPN
     FPARL01    IF   E           K DISK    USROPN
     FLABF      IF A E             DISK    USROPN
     FDOLAF     UF A E             DISK
     F                                     INFDS(DOLADS)
     FSYEF44P   O    E             PRINTER
     FMERKL1    O    F   50        PRINTER
     F                                     FORMLEN(18)
     F                                     FORMOFL(18)
     FMERKL2    O    F   50        PRINTER
     F                                     FORMLEN(24)
     F                                     FORMOFL(24)
     FDOKOTHM   UF A E           K DISK
     D KA1             S              4  0 DIM(6)
     D WR1             S              1    DIM(9)
     D WR2             S              1    DIM(17)
     D WR3             S              1    DIM(30)
     D AR1             S              1    DIM(30)
     D AR2             S              1    DIM(30)
     D                 DS
     D  TEAC11                 1      1
     D  TEAC21                 2      2
     D  TEAC34                 3      6
     D  TEAC74                 7     10
     D  TEAACC                 1     10
n06  D                 DS
n06  D  PRDATO                 1      6
n06  D  PRDD                   1      2
n06  D  PRMM                   3      4
n06  D  PRAA                   5      6
     D                 DS
     D  KFAC11                 1      1
     D  KFAC21                 2      2
     D  KFAC34                 3      6
     D  KFAC74                 7     10
     D  KFSAC                  1     10
     D                 DS
     D  KFS012                 1      2
     D  KFS031                 3      3
     D  KFS041                 4      4
     D  KFS051                 5      5
     D  KFS064                 6      9
     D  KFS101                10     10
     D  KFS114                11     14
     D  XKFSAC                 1     14
     D                 DS
     D  ELT1                   1     22
     D  ALT1                   1     22
     D  ELT117                 1     17
     D                 DS
     D  KOWXXX                 1     41
     D  KOWFET                 1      1
     D                 DS
     D  XAWBI2                 1     15
     D  AAWBI2                 1     15
     D                 DS
     D  DFROA1                 1      3
     D  ZFROA1                 1      3
     D  DFROA2                 4      6
     D  ZFROA2                 4      6
     D  DFROA3                 7      9
     D  ZFROA3                 7      9
     D  XFRAFL                10     39
     D  ZFRAFL                10     39
     D  DFBLT                 40     48  2
     D  ZFBLT                 40     48  2
     D  DFBLA                 49     57  2
     D  ZFBLA                 49     57  2
     D  XCACOL                58     66  2
     D  YCACOL                58     66  2
     D  XCAPRE                67     75  2
     D  YCAPRE                67     75  2
     D  KNAVN                 76    105
     D  XAWBI1               106    122
     D  ZAWBI1               106    122
     D  AAWBI1               106    122
     D  BAWBI1               106    122
     D                 DS
     D  SMSD                   1      3
     D  XSDT                   1      5
     D                 DS
     D  DFSDF                  1      3
     D  XSDF                   1      5
     D                 DS
     D  XSD                    1      3
     D  XLNR                   4      6  0
     D  YESAML                 1      6
     D                 DS
     D  XARKB                  5      6  0
     D  XARKH                  8      9  0
     D  XARK                   1     10
     D                 DS
     D  XAWB41                 1      4  0
     D  XAWB42                 6      9  0
     D  XAWB9                  1      9
     D                 DS
     D  XPAR1H                 1      2  0
     D  XPAR1D                 4      5  0
     D  XPAR2H                 7      8  0
     D  XPAR2D                10     11  0
     D  XPAR                   1     11
     D                 DS
     D  XFLY1                  1      3
     D  FL                     1      3
     D                                     DIM(3)
     D                 DS
     D  KA                     1     24
     D                                     DIM(6)
     D  DFNT1                  1      4
     D  DFNT2                  5      8
     D  DFNT3                  9     12
     D  DFNT4                 13     16
     D  DFNT5                 17     20
     D  DFNT6                 21     24
     D                 DS
     D  VE                     1     42  1
     D                                     DIM(6)
     D  DFVKT1                 1      7  1
     D  DFVKT2                 8     14  1
     D  DFVKT3                15     21  1
     D  DFVKT4                22     28  1
     D  DFVKT5                29     35  1
     D  DFVKT6                36     42  1
     D                 DS
     D  RA                     1      6
     D                                     DIM(6)
     D  DFRC1                  1      1
     D  DFRC2                  2      2
     D  DFRC3                  3      3
     D  DFRC4                  4      4
     D  DFRC5                  5      5
     D  DFRC6                  6      6
     D                 DS
     D  IT                     1     24
     D                                     DIM(6)
     D  DFCOM1                 1      4
     D  DFCOM2                 5      8
     D  DFCOM3                 9     12
     D  DFCOM4                13     16
     D  DFCOM5                17     20
     D  DFCOM6                21     24
     D                 DS
     D  FV                     1     42  1
     D                                     DIM(6)
     D  DFFBV1                 1      7  1
     D  DFFBV2                 8     14  1
     D  DFFBV3                15     21  1
     D  DFFBV4                22     28  1
     D  DFFBV5                29     35  1
     D  DFFBV6                36     42  1
     D                 DS
     D  MI                     1      6
     D                                     DIM(6)
     D  DFRK1                  1      1
     D  DFRK2                  2      2
     D  DFRK3                  3      3
     D  DFRK4                  4      4
     D  DFRK5                  5      5
     D  DFRK6                  6      6
     D                 DS
     D  PR                     1     48  2
     D                                     DIM(6)
     D  DFRPR1                 1      8  2
     D  DFRPR2                 9     16  2
     D  DFRPR3                17     24  2
     D  DFRPR4                25     32  2
     D  DFRPR5                33     40  2
     D  DFRPR6                41     48  2
     D                 DS
     D  BE                     1     60  2
     D                                     DIM(6)
     D  DFBLT1                 1     10  2
     D  DFBLT2                11     20  2
     D  DFBLT3                21     30  2
     D  DFBLT4                31     40  2
     D  DFBLT5                41     50  2
     D  DFBLT6                51     60  2
     D                 DS
     D  VA                     1    250
     D                                     DIM(10)
     D  DFVS1                  1     25
     D  DFVS2                 26     50
     D  DFVS3                 51     75
     D  DFVS4                 76    100
     D  DFVS5                101    125
     D  DFVS6                126    150
     D  DFVS7                151    175
     D  DFVS8                176    200
     D  DFVS9                201    225
     D  DFVS10               226    250
     D                 DS
     D  KOAIAT                 1      7  0
     D  XIAT1                  1      2  0
     D  XIAT2                  3      3  0
     D  XIAT3                  4      7  0
     D                 DS
     D  DFROB1                 1      7
     D  XROB12                 1      2
     D                 DS
     D  DFROB2                 1      7
     D  XROB22                 1      2
     D                 DS
     D  DFROB3                 1      7
     D  XROB32                 1      2
     D                 DS
     D  HEGN                   1     15
     D  XGN1                   5      5
     D  XGN2                   6      6
     D  XGN3                   7      7
     D  XGN4                   8      8
     D  XGN5                   9      9
     D  XGN6                  10     10
     D  XGN7                  11     11
     D  XGN8                  12     12
     D  XGN9                  13     13
     D  XGN10                 14     14
     D  XGN11                 15     15
     D  XGN                    8     15
     D  WHEGN3                 5      7
     D  WHEGN8                 8     15
     D                 DS
     D  HEHAWB                 1      9
     D  XHAWB                  4      9  0
     D  XHAWB1                 4      4  0
     D  XHAWB2                 5      5  0
     D  XHAWB3                 6      6  0
     D  XHAWB4                 7      7  0
     D  XHAWB5                 8      8  0
     D  XHAWB6                 9      9  0
     D                 DS
     D  HESDF                  1      5
     D  XSDF1                  1      1
     D  XSDF2                  2      2
     D  XSDF3                  3      3
     D                 DS
     D  WRK2T3                 1    142
     D  WRK2A                  1     65
     D  WRK2B                 66    130
     D  WRK2C                131    142
     D                 DS
     D  DFCCPP                 1      2
     D  WDFCP1                 1      1
     D  WDFCP2                 2      2
     D                 DS
     D  FIN                    1    245
     D                                     DIM(7)
     D  DFINF1                 1     35
     D  DFINF2                36     70
     D  DQINF3                71    105
     D  DQINF4               106    140
     D  DQINF5               141    175
     D  DQINF6               176    210
     D  DQINF7               211    245
     D                 DS
     D  DATT1                  1      2
     D  DATT2                  3      4
     D  DATT3                  5      6
     D  DATT                   1      6
     D                 DS
     D  SMMAWB                 1     11  0
     D  W03AWB                 1      3  0
     D                 DS
s15  D* HWBKOL                 1      4
s15  D  ZHESDF                 1      3
s15  D* WEHAWB                 5     13
n15  D  WEHAWB                 4     12
     D  DESKOL                14     17
     D  ZHESDT                18     20
     D  HWBDET                 1     20
     D                 DS
     D  XULTID                 1     14  0
     D  XULTM                  1      6  0
     D  XULDD                  7      8  0
     D  XULMM                  9     10  0
     D  XULÅÅ                 11     14  0
     D                 DS
     D  ULÅÅ                   1      4  0
     D  ULMM                   5      6  0
     D  ULDD                   7      8  0
     D  ULDT                   1      8  0
     D                 DS
     D  AWBDES                 1     14
     D  WHESDT                 4      6
     D                 DS
     D  ROUTIN                 1     15
     D  WWA                    1      3
     D  WWB                    5     10
     D  WWC                   11     11
     D  WWD                   12     13
     D                 DS
     D  WARECA                 1      9  0
     D                 DS            14
N18  D                 DS
N18  D  T25                    1    275    DIM(11)
N18  D  DFQS7                  1     25
N18  D  DFQS8                 26     50
N18  D  DFQS9                 51     75
N18  D  DFQS10                76    100
N18  D  DQVS11               101    125
N18  D  DQVS12               126    150
N18  D  DQVS13               151    175
N18  D  DQVS14               176    200
N18  D  DQVS15               201    225
N18  D  DQVS16               226    250
N18  D  DQVS17               251    275
N18  D                 DS
N18  D  FRTTXT                 1     70
N18  D  FRTTXT76               1     76
     D PRICAR          C                   CONST('PRIORITY CARGO')
     D EUROPE          C                   CONST('EuropeXpress')
N05  D TDFLAS          C                   CONST('TD flash      ')
     D                 DS            11
     D NUM             C                   CONST(' 0123456789')
      * Get recordnumber from file
     D DOLADS          DS
     D  DORECN               397    400B 0
     D                SDS
     D  WUSER                254    263
     D                UDS
N11  D  UPRT68               981    990
N11  D  UPT68                991   1000
     IDOLAR
     I              LAISTX                      DOISTX
      *
     C                   EXSR      INIT
     C   33              GOTO      SLUTT
      *
     C                   EXSR      PRINT
      * PDFUTSKRIFT
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        OREQ      'F'
N05  C     CALLTY        OREQ      'D'
     C     CALLTY        OREQ      'A'
N19  C     CALLTY        oreq      'B'
     c                   z-add     1             kopinr            2 0
     C                   exsr      ovlsr
     C                   END
n13   * fullt setyt ved epost
n13  C     UKODE         IFEQ      'M'
s19  C*    CALLTY        ANDEQ     'F'
n19  C     CALLTY        IFEQ      'F'
N19  C     CALLTY        oreq      'B'
n13  C                   SETON                                        27
N13  c                   z-add     2             kopinr            2 0
N13  C                   exsr      ovlsr0
N13  C                   GOTO      SLUTT
N13  C                   END
n19  C                   end
      * KUN 1 KOPI VED MAIL/FAX OG IKKE TDVIS
     C* ikke MERKELAPPER SKAL SKRIVES
      * PÅ DE ENKELTE HAWBER
      * ingen oppdatring
     C     UKODE         IFEQ      'O'
     C                   SETON                                        27
      * KOPI2-9 VED PDF UTSKRIFT
      * PDFUTSKRIFT
     C     CALLTY        IFEQ      'P'
N01  C     CALLTY        OREQ      'F'
N05  C     CALLTY        OREQ      'D'
N19  C     CALLTY        oreq      'B'
     c                   z-add     2             kopinr            2 0
     C                   exsr      ovlsr0
     C                   ELSE
     C                   EXSR      PRINT
     C                   END
     C                   SETOFF                                       27
      *
      * UTFØRER RUTINER FOR Å SENDE FRAKTBREV ELEKTRONISK
      *
     C     DFCMN         IFEQ      'J'
     C     DFCMN         OREQ      'Y'
     C     DFCMN         OREQ      'j'
     C     DFCMN         OREQ      'y'
     C                   EXSR      OPNFIL                                       <Åpne filer
     C     *IN90         IFEQ      '0'
     C                   EXSR      WRTFWB                                       <Write inhouse
     C                   ENDIF                                                  <*IN90
     C                   EXSR      CLOFIL                                       <Lukk filer
     C                   ENDIF                                                  <DFCMN
      *
     C     DOKEMK        CHAIN     DOKEM                              33
     C  N33              DO
     C                   MOVE      'P'           DFST
     C                   MOVE      KOSFNV        DFNAS
     C                   UPDATE    DOKEMR
     C                   MOVE      DFNTT         XFNTT             4 0
     C                   MOVE      DFVKTT        XFVKTT            7 1
     C                   END
     C     UULAPP        ifne      0
     C                   EXSR      PRINT2
     C                   end
      *
     C     FIFIRM        CHAIN     FIRMARC                            33
     C  N33'am'          chain     arktxt                             33
     C     *IN33         IFEQ      '0'
     C     arkjn         andeq     'J'
     C                   MOVE      FIFIRM        ARFIRM
s12  C*                  MOVE      *zeros        ARAVD
s12  C*                  MOVE      heavd         ARAVD
s12  C                   MOVE      uavdu         ARAVD
     C                   MOVE      *zeros        AROPD
     C                   MOVEL     YESAML        ARUNDE
     C                   MOVE      'am'          ARTYPE
     C                   MOVE      WUSER         ARUSER
     C                   TIME                    XULTID
     C                   MOVE      XULDD         ULDD
     C                   MOVE      XULMM         ULMM
     C                   MOVE      XULÅÅ         ULÅÅ
     C                   MOVE      ULDT          ARDATE
     C                   MOVE      XULTM         ARTIME
     C                   WRITE     ARKIVR
N19  C                   MOVE      'an'          ARTYPE
N19  C                   WRITE     ARKIVR
     C                   END
     C                   END
     C     SLUTT         TAG
     C                   MOVE      XPRANT        UPRANT
     C                   SETON                                        LR
     C                   RETURN
      *
      ******************************************
     C     PRINT         BEGSR
      ******************************************
      *
     C     KOAIAT        COMP      *ZEROS                             6767
     C   27              GOTO      TAG01
     C     DFCCPP        COMP      'CC'                                   70
     C  N70              Z-ADD     KDSBL4        XTDUA             9 2
N07  C  N70              exsr      sumotha
N07  C  N70              add       WSBLAG        XTDUA             9 2
     C   70              MOVE      *ZEROS        XTDUA
      *
     C                   SETON                                        77
     C                   MOVE      *ZEROS        XDISBL            5 0
     C     DFFSN         CHAIN     ELOGO                              33
     C     KODFSK        CHAIN     KODTFS                             33
     C                   MOVE      *BLANKS       XKFSAC
     C     KFAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      KFAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      KFAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      KFAC74        KFS114
     C                   ELSE
     C                   MOVEL     KFSAC         XKFSAC
     C                   END
     C     KODTWK        CHAIN     KODTW                              33
     C     KOWLAS        IFNE      ' '
     C     TELLAK        CHAIN     TELLA                              33
     C  N33TEAACC        IFNE      *BLANKS
     C     TEAC11        IFEQ      'C'
     C                   MOVE      '60'          KFS012
     C                   MOVE      '-'           KFS031
     C                   MOVE      TEAC21        KFS041
     C                   MOVE      '-'           KFS051
     C                   MOVE      TEAC34        KFS064
     C                   MOVE      '/'           KFS101
     C                   MOVE      TEAC74        KFS114
     C                   ELSE
     C                   MOVE      *BLANKS       XKFSAC
     C                   MOVEL     TEAACC        XKFSAC
     C                   END
     C                   END
     C                   END
     C     KOWFET        COMP      'J'                                    46
      *
     C     KODSFK        CHAIN     KODTSF                             33
     C     XROB12        COMP      KFSKD2                             7979
      *
     C     XSDF          CHAIN     STED2                              66
     C  N66              MOVE      ST2NVN        XFRAFL           30
     C  N66              MOVEL     ST2NVN        XFRAF2           15
     C     XSDT          CHAIN     STED2                              66
     C                   MOVEL     ST2NVN        WW2NVN
      *
     C     DFBELF        COMP      0                                      40
      *
      * SKAL BELØP MOT CARRIER PÅ MOTSATT SIDE
      * MED HENSYN TIL CC/PP
      *
     C                   MOVE      *ZEROS        XCAPRE
     C                   MOVE      *ZEROS        XCACOL
      *
     C   70DFKDDC        IFEQ      'P'
     C                   Z-ADD     DFBLDC        XCAPRE            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
     C  N70DFKDDC        IFEQ      'C'
     C                   Z-ADD     DFBLDC        XCACOL            9 2
     C                   MOVE      *ZEROS        DFBLDC
     C                   END
      *
     C   70XCAPRE        COMP      *ZEROS                             35
     C  N70XCACOL        COMP      *ZEROS                             35
      *
      * HOPPES HIT VED PRINT AV 2. SIDE FLYFRAKT
      *
     C     TAG01         TAG
      *
      * HENTE TILLEGGSOPPLYSNINGER
      *
     C     DOKEQK        CHAIN     DOKEQM                             88
     C   88              DO
     C                   MOVE      *BLANKS       DQNA
     C                   MOVE      *BLANKS       DQAD1
     C                   MOVE      *BLANKS       DQAD2
     C                   MOVE      *BLANKS       DQAD3
     C                   MOVE      *BLANKS       DQAD4
     C                   MOVE      *BLANKS       DQINFD
     C                   MOVE      *BLANKS       DQINF3
     C                   MOVE      *BLANKS       DQINF4
     C                   MOVE      *BLANKS       DQINF5
     C                   MOVE      *BLANKS       DQINF6
     C                   MOVE      *BLANKS       DQINF7
     C                   MOVE      *BLANKS       DQINF8
     C                   MOVE      *BLANKS       DQINF9
     C                   MOVE      *BLANKS       DQVS11
     C                   MOVE      *BLANKS       DQVS12
     C                   MOVE      *BLANKS       DQVS13
     C                   END
     C  N88              DO
     C                   MOVE      DQNA          XNAK
     C                   MOVE      DQAD1         XADK1
     C                   MOVE      DQAD2         XADK2
     C                   MOVE      DQAD3         XADK3
     C                   MOVEL     DQINFD        WPINFD
     C                   END
     C                   MOVEL     DFINFC        WPINFC
     C                   EXSR      ZSTART
     C                   move      uavdu         uavd40            4 0
     C     UAVD40        CHAIN     KODTASID                           75
     C   75              MOVE      *BLANKS       KSIDNR
     C                   WRITE     PRT2
     C                   WRITE     PRTDE0
      *
     C                   Z-ADD     1             XN                2 0
      *
     C     STARP         TAG
     C                   MOVE      KA(XN)        XWRKKA            4
     C     NUM           CHECK     KA(XN)        NUMCHK            1 0
     C     NUMCHK        IFGT      0
     C                   MOVE      *OFF          *IN30
     C                   ELSE
     C                   MOVE      *ON           *IN30
     C                   ENDIF
      *
     C     VE(XN)        IFGT      *ZEROS
     C                   MOVE      'K'           XKILOA            1
     C                   ELSE
     C                   MOVE      *BLANKS       XKILOA
     C                   END
      *
      * BASISPRISBEREGNING KUN 1. GANG
      *
      *
     C     MI(XN)        COMP      'P'                                    32
     C                   MOVE      *OFF          *IN28
     C                   EXSR      MOVKA
     C                   WRITE     PRTDE2
     C     MI(1)         IFEQ      'P'
     C     XN            ANDEQ     4
     C                   WRITE     PRIO2
N21  C                   add       1             xn
     C                   END
     C     MI(1)         IFEQ      'X'
     C     XN            ANDEQ     4
     C                   WRITE     PRIO3
     C                   END
     C                   MOVE      XWRKKA        KA(XN)
     C                   ADD       1             XN
     C     XN            COMP      6                                  33
     C  N33              GOTO      STARP
      *
S18  C*                  WRITE     PRTDE3
n18  c                   move      DFVS7         DFqS7
n18  c                   move      DFVS8         DFqS8
n18  c                   move      DFVS9         DFqS9
n18  c                   move      DFVS10        DFqS10
N18  c                   exsr      fri
      *
      * FINNER DISPURSMENTFEE
      *
     C   27              GOTO      TAG02
      *
     C     XTDUA         IFNE      0
     C   70XTDUA         COMP      KDSBL1                               33
     C   70
     CAN 33              Z-ADD     KDSBL2        XDISBL            5 0
     C   70
     CANN33XTDUA         MULT      KDSPRO        XDISBL
     C   70
     CANN33XDISBL        COMP      KDSBL3                               34
     C   70
     CANN33
     CAN 34              Z-ADD     KDSBL3        XDISBL
     C                   END
      *
      * SJEKKER OM IKKE DISP-FEE SKAL VÆRE MED
      *
     C     KODLKK        CHAIN     KODTLK                             33
     C     KLKDIS        COMP      'N'                                    34
     C   34              MOVE      *ZEROS        XDISBL
      *
     C                   ADD       XDISBL        DFBLDC            9 2
      * LEGG TIL RECORD FOR DISP-FEE I DOKOTH
     C                   MOVEL     'DB'          WO1331
     C     OTHKEY        CHAIN     DOKOTHM                            66
     C  N66DFBLDC        SUB       DO1333        DFBLDC
     C  N66              DELETE    DOKOTR
     C     XDISBL        IFGT      0
     C                   CLEAR                   DOKOTR
     C                   MOVE      DFSD          DOSD
     C                   MOVE      DFLNR         DOLNR
      * SKJEKK COLLECT PREPAID
     C     DFCCPP        IFEQ      'CC'
     C                   MOVEL     'C'           DO1322
     C                   ELSE
     C     DFCCPP        IFEQ      'PP'
     C                   MOVEL     'P'           DO1322
     C                   ENDIF                                                  <WSCCPP
     C                   ENDIF                                                  <WSCCPP
     C                   MOVEL     'DB'          DO1331
     C                   MOVEL     'C'           DO1332
     C                   Z-ADD     XDISBL        DO1333
     C                   WRITE     DOKOTR
     C                   ENDIF
      *
      * MC     SKAL DUE CARRIER
      *
     C     DFBLT         ADD       DFBLDC        XBELTO            9 2
     C                   ADD       DFBLA         XBELTO
     C                   ADD       DFBLAV        XBELTO
     C                   ADD       XTDUA         XBELTO
     C     DFBLA         COMP      *ZEROS                             36
     C     DFBLAV        COMP      *ZEROS                             37
     C     XTDUA         COMP      *ZEROS                             38
     C     DFBLDC        COMP      *ZEROS                             39
     C     XDISBL        COMP      *ZEROS                             41
      *
     C     TAG02         TAG
      *
     C                   EXSR      KDTFMT
     C                   EXSR      EDTOTH
     C  N70              WRITE     PRTTO2
     C   70              WRITE     PRTTO3
      *
     C     SLPRIN        ENDSR
      *
      ******************************************
     C     MOVKA         BEGSR
      ******************************************
     C                   Z-ADD     1             X3                1 0
     C     X3            DOWLE     6
     C                   MOVE      KA(X3)        TESTSH            1
     C     TESTSH        IFGE      '0'
     C     TESTSH        ANDLE     '9'
     C                   MOVE      KA(X3)        KA1(X3)
     C                   ELSE
     C                   MOVEA     *ZEROS        KA1(X3)
     C                   END
     C                   ADD       1             X3
     C                   END
      *
      *
     C                   MOVE      KA1(XN)       KA1CXN            4 0
     C                   MOVE      KA(XN)        KACXN             4
     C                   MOVE      VE(XN)        VECXN             7 1
     C                   MOVE      RA(XN)        RACXN             1
     C                   MOVE      IT(XN)        ITCXN             4
     C                   MOVE      FV(XN)        FVCXN             7 1
     C                   MOVE      PR(XN)        PRCXN             8 2
     C                   MOVE      BE(XN)        BECXN            10 2
     C                   MOVE      VA(XN)        VACXN            25
     C                   ENDSR
      *
      ********************************************************************D260
     C     ZSTART        BEGSR
      ********************************************************************
      *
      *  ZSTART - DEFINERER ARKET UTSEENDE
      *
     C                   MOVE      DFSDF         XFRA9             7
     C                   MOVEL     XFRA9         XAWBI1           17
     C                   MOVEL     DFFSN         XAWBI1
     C                   MOVE      XAWB9         XAWBI1
     C                   MOVEL     DFFSN         XAWBI2           15
     C                   MOVE      XAWB9         XAWBI2
      *
     C                   ENDSR
      *
      ******************************************
     C     PRINT2        BEGSR
      ******************************************
      * Hele SR er skrevet om. Alle linjer merket selv om noen
      *
     C                   EXSR      OPNPRT
     C     YESAML        SETLL     HEAD19
     C     YESAML        READE     HEAD19                                 94
     C     *IN94         DOWEQ     *OFF
      *
     C     DOKEFK        CHAIN     DOKEF                              94
     C     *IN94         IFEQ      *OFF
     C     DFKDME        IFEQ      'S'
N14  C     UPT68         IFEQ      'PDF'
N14  C                   exsr      printmp
N14  C                   SETON                                        5051
N14  C                   else
     C     FITDVI        IFEQ      'J'
     C                   EXSR      PRINT3
     C     *IN90         IFEQ      '0'
     C                   EXSR      SNDTA2
     C                   ENDIF
     C                   ELSE
     C                   EXSR      PRINT4
     C                   SETON                                        5051
     C                   ENDIF                                                  <FITDVI
     C                   ENDIF                                                  >DFKDME
N14  C                   ENDIF                                                  <*IN77
     C     DFKDME        IFEQ      'J'
     C     DFKDME        OREQ      'B'
     C     DFROA3        IFNE      *BLANKS
     C                   MOVEL     XSDT          XFLY1
     C                   MOVE      DFROA1        XFLY2             3
     C                   MOVE      DFROA2        XFLY3             3
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY3
     C     DFROA2        IFNE      *BLANKS
     C                   MOVE      DFROA2        XFLY1
     C                   MOVE      DFROA1        XFLY2
     C                   ELSE
     C                   MOVE      *BLANKS       XFLY2
     C                   MOVE      DFROA1        XFLY1
     C                   END
     C                   END
     C                   Z-ADD     1             XANTL             3 0
     C     XANTL         DOWLE     DFNTT
     C                   EXCEPT    MLAP
     C     DFKDME        IFEQ      'B'
     C                   EXCEPT    MLAP2
     C                   END
     C                   ADD       1             XANTL
     C                   ENDDO
s14  C*                  MOVE      'P'           DFKDME
s14  C*                  UPDATE    DOKEFR
     C                   ENDIF                                                  <DFKDME
n17  C                   MOVE      'P'           DFKDME
n17  C                   UPDATE    DOKEFR
     C                   ENDIF                                                  <*IN94
s17  C*                  MOVE      'P'           DFKDME
s17  C*                  UPDATE    DOKEFR
N20  C                   EXSR      ARKLAPP
     C     YESAML        READE     HEAD19                                 94
      *
     C                   ENDDO
     C                   EXSR      CLOPRT
     C                   ENDSR
      ******************************************
     C     PRINT3        BEGSR
      ******************************************
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVE      DFFSN         WNHEG3            3 0
     C     WNHEG3        CHAIN     ISUL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     ISPART        LAPAID
     C                   MOVEL     'LAI'         LAMEID
      * HENT PRINTER NAVN
s11  C*                  CALL      'SYGE01'
s11  C*                  PARM                    DFAVD
s11  C*                  PARM      068           WUSKNR            3 0
s11  C*                  PARM                    WOPNVN           10
s11  C*                  PARM                    WOPTY            10
s11  C*                  PARM                    WOPHEA            1
s11  C*                  PARM                    WKOPFM
      * NÅ GJELDER UDS STYRINGEN AV PRINTER
N11  C                   MOVEL     UPRT68        WOPNVN           10
N11  C                   MOVEL     UPT68         WOPTY            10
     C                   MOVEL     WOPNVN        LAPRID
     C     ISPART        CHAIN     PARL01                             90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   MOVEL     LABNAM        LAISTX
     C     1             CHAIN     CNFF                               90
     C     *IN90         CABEQ     '1'           ENDPR3
     C                   ADD       1             CNRECN
     C                   UPDATE    CNFR
     C                   Z-ADD     CNRECN        LARECN
     C     DFRK1         IFEQ      'P'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE                                                   <WHEGN3
     C     DFRK1         IFEQ      'X'
     C     DFRK2         OREQ      'X'
     C     DFRK3         OREQ      'X'
     C     DFRK4         OREQ      'X'
     C     DFRK5         OREQ      'X'
     C     DFRK6         OREQ      'X'
     C                   MOVEL     EUROPE        LASERC
N05  C                   ELSE                                                   <WHEGN3
N05  C     DFRK1         IFEQ      'Z'
N05  C     DFRK2         OREQ      'Z'
N05  C     DFRK3         OREQ      'Z'
N05  C     DFRK4         OREQ      'Z'
N05  C     DFRK5         OREQ      'Z'
N05  C     DFRK6         OREQ      'Z'
N05  C                   MOVEL     TDFLAS        LASERC
     C                   ELSE
     C                   MOVEL     *BLANKS       LASERC
N05  C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     SMSDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     SMSD          LADCTY
      * DE 2 SOM ER * UT FÅR VERDI TIDLIGERE I SR OPNPRT
      *                    Z-ADDDFNTT     LANUMP
      *                    Z-ADDDFVKTT    LAWGHT
     C                   MOVE      *BLANKS       LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3
     C                   MOVEL     HEADK3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     SMROA1        IFNE      *BLANKS
     C                   MOVEL     SMROA1        WWA
     C                   MOVEL     SMROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     SMROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     SMROA2        WWA
     C                   MOVEL     SMROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     SMROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     SMROA3        WWA
     C                   MOVEL     SMROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN          WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
s15  C*                  MOVEL     'HWB:'        HWBKOL
s01  C*                  MOVEL     HEHAWB        WEH06             6
s01  C*                  MOVEL     WEH06         WEHAWB
n01  C                   MOVEL     HEHAWB        WEHAWB
S03  C*                  MOVEL     SMSDF         WEHAWB
     C                   MOVEL     'DES:'        DESKOL
     C                   MOVEL     HESDT         ZHESDT
N15  C                   MOVEL     HESDF         ZHESDF
     C                   MOVEL     HWBDET        LAHAIN
     C     DFNTT         MULT      UULAPP        LANUMC
     C                   Z-ADD     DFNTT         LAHNUM
     C                   Z-ADD     DFVKTT        LAHWGT
     C                   MOVE      'H'           LAHCDE
      *
     C                   WRITE     LABR
      *
     C     ENDPR3        ENDSR
      ******************************************
     C     OPNPRT        BEGSR
      ******************************************
     C                   OPEN      CNFF                                 90
     C  N90              OPEN      PARL01                               90
     C  N90              OPEN      ISUL01                               90
     C  N90              OPEN      LABF                                 90
     C                   CLEAR                   DOLAR
      * TAR VARE PÅ VERDIER FRA MAWB
     C                   Z-ADD     DFNTT         LANUMP
     C                   Z-ADD     DFVKTT        LAWGHT
      *
     C                   ENDSR
     C******************************************
     C     CLOPRT        BEGSR
     C******************************************
     C                   CLOSE     CNFF                                 90
     C  N90              CLOSE     PARL01                               90
     C  N90              CLOSE     ISUL01                               90
     C  N90              CLOSE     LABF                                 90
      *
     C                   ENDSR
     C***********************************************
     C     SNDTA2        BEGSR
     C***********************************************
     C                   MOVEL     'SMADTARQ'    QTNAME           10
     C                   MOVEL     '*LIBL'       QTLIB            10
     C                   Z-ADD     9             QTLEN             5 0
     C                   MOVE      *BLANKS       QTFIEL            9
     C                   Z-ADD     LARECN        WARECA
     C                   MOVE      WARECA        QTFIEL
     C                   Z-ADD     9             QKILEN            3 0
     C                   MOVE      *BLANKS       QKEY              9
     C                   MOVEL     'LAI'         QKEY
     C                   CALL      'QSNDDTAQ'
     C                   PARM                    QTNAME
     C                   PARM                    QTLIB
     C                   PARM                    QTLEN
     C                   PARM                    QTFIEL
     C                   PARM                    QKILEN
     C                   PARM                    QKEY
     C*
     C                   ENDSR
     C******************************************
     C     PRINT4        BEGSR
     C******************************************
     C                   OPEN      ISUL01                               90
     C  N90              OPEN      PARL01                               90
     C                   MOVE      DFFSN         WNHEG3            3 0
     C     WNHEG3        CHAIN     ISUL01                             90
     C  N90ISPART        CHAIN     PARL01                             90
     C                   CLOSE     ISUL01                               90
     C                   CLOSE     PARL01                               90
      * LABEL PRINT MED BARCODE STANDARD SYSPED400
      * HENT PRINTER NAVN
s11  C*                  CALL      'SYGE01'
s11  C*                  PARM                    DFAVD
s11  C*                  PARM      068           WUSKNR            3 0
s11  C*                  PARM                    WOPNVN           10
s11  C*                  PARM                    WOPTY            10
s11  C*                  PARM                    WOPHEA            1
s11  C*                  PARM                    WKOPFM
      * NÅ GJELDER UDS STYRINGEN AV PRINTER
N11  C                   MOVEL     UPRT68        WOPNVN           10
N11  C                   MOVEL     UPT68         WOPTY            10
      * SJEKK OM DET ER KORREKT PRINTER ANGITT I PAPIRTYPE
     C     WOPTY         IFEQ      'ZEBRA 95'
     C     WOPTY         OREQ      'STRIPE  '
     C     WOPTY         OREQ      'ELTRON  '
     C     *IN90         IFEQ      *ON
     C     LABNAM        OREQ      *BLANKS
     C                   MOVEL     FIKRTN        DOISTX
     C                   ELSE
     C                   MOVEL     LABNAM        DOISTX
     C                   ENDIF
     C                   MOVEL     WOPNVN        LAPRID
     C     DFNTT         MULT      UULAPP        LANUMC
     C                   MOVEL     *BLANKS       LAISTX
     C     DFRK1         IFEQ      'P'
     C     DFRK2         OREQ      'P'
     C     DFRK3         OREQ      'P'
     C     DFRK4         OREQ      'P'
     C     DFRK5         OREQ      'P'
     C     DFRK6         OREQ      'P'
     C                   MOVEL     PRICAR        LASERC
     C                   ELSE                                                   <WHEGN3
     C     DFRK1         IFEQ      'X'
     C     DFRK2         OREQ      'X'
     C     DFRK3         OREQ      'X'
     C     DFRK4         OREQ      'X'
     C     DFRK5         OREQ      'X'
     C     DFRK6         OREQ      'X'
     C                   MOVEL     EUROPE        LASERC
N05  C                   ELSE                                                   <WHEGN3
N05  C     DFRK1         IFEQ      'Z'
N05  C     DFRK2         OREQ      'Z'
N05  C     DFRK3         OREQ      'Z'
N05  C     DFRK4         OREQ      'Z'
N05  C     DFRK5         OREQ      'Z'
N05  C     DFRK6         OREQ      'Z'
N05  C                   MOVEL     TDFLAS        LASERC
     C                   ELSE
     C                   MOVEL     *BLANKS       LASERC
N05  C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   ENDIF                                                  <DFRK1
     C                   MOVEL     SMSDF         WHESDT
     C                   MOVEL     WHEGN3        AWBDES
     C                   MOVE      WHEGN8        AWBDES
     C                   MOVEL     AWBDES        LAAWBC
     C                   MOVEL     HESDT         LADCTY
     C                   MOVE      *BLANKS       LAHAIN
     C                   MOVEL     HENAS         LASHP1
     C                   MOVEL     HEADS1        LASHP2
     C                   MOVEL     HEADS2        LASHP3
     C                   MOVEL     HEADS3        LASHP4
     C                   MOVEL     HENAK         LACNE1
     C                   MOVEL     HEADK1        LACNE2
     C                   MOVEL     HEADK2        LACNE3
     C                   MOVEL     HEADK3        LACNE4
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     *BLANKS       LARTN1
     C                   MOVEL     *BLANKS       LARTN2
     C                   MOVEL     *BLANKS       LARTN3
     C     SMROA1        IFNE      *BLANKS
     C                   MOVEL     SMROA1        WWA
     C                   MOVEL     SMROB1        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC1        WWD
     C                   MOVEL     ROUTIN        LARTN1
     C                   ENDIF
     C     SMROA2        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     SMROA2        WWA
     C                   MOVEL     SMROB2        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC2        WWD
     C                   MOVEL     ROUTIN        LARTN2
     C                   ENDIF
     C     SMROA3        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ROUTIN
     C                   MOVEL     SMROA3        WWA
     C                   MOVEL     SMROB3        WWB
     C                   MOVEL     '/'           WWC
     C                   MOVEL     SMROC3        WWD
     C                   MOVEL     ROUTIN        LARTN3
     C                   ENDIF
     C                   MOVE      HEGN          WWAWB            11 0
     C                   Z-ADD     WWAWB         LAAWBN
     C                   Z-ADD     WWAWB         LAAWB2
s15  C*                  MOVEL     'HWB:'        HWBKOL
n15  C                   MOVEL     SMSDF         ZHESDF
     C                   MOVEL     HEHAWB        WEHAWB
s15  C*                  MOVEL     SMSDF         WEHAWB
     C                   MOVEL     'DES:'        DESKOL
     C                   MOVEL     SMSD          ZHESDT
     C                   MOVEL     HWBDET        LAHAIN
     C     DFNTT         MULT      UULAPP        LANUMC
     C                   Z-ADD     DFNTT         LAHNUM
     C                   Z-ADD     DFVKTT        LAHWGT
     C                   MOVE      'H'           LAHCDE
     C                   Z-ADD     DFAVD         LAAVD
     C                   Z-ADD     DFOPD         LAOPD
     C                   MOVE      DFSG          LASIGN
      *
     C                   WRITE     DOLAR
      *
     C                   CALL      'SYLA01C'
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    WOPTY
     C                   PARM                    WOPNVN
      *
     C     DORECN        CHAIN     DOLAR                              90
     C     *IN90         IFEQ      *OFF
     C                   DELETE    DOLAR
     C                   ENDIF
      *
     C                   ENDIF                                                  <WOPTY
      *
     C     ENDPR4        ENDSR
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     TELLAK        KLIST
     C                   KFLD                    YTAUNI
     C                   KFLD                    DFFSN
     C                   KFLD                    KOWLAS
     C     DOKEQK        KLIST
     C                   KFLD                    DQRI
     C                   KFLD                    USD
     C                   KFLD                    ULNR
     C                   MOVE      'Q'           DQRI
     C     KODLKK        KLIST
     C                   KFLD                    YLKUNI
     C                   KFLD                    ST2LKX            2
     C     SAMLBK        KLIST
     C                   KFLD                    USD
     C                   KFLD                    ULNR
     C     DOKEMK        KLIST
     C                   KFLD                    YRIM
     C                   KFLD                    USD
     C                   KFLD                    ULNR
     C     DOKEFK        KLIST
     C                   KFLD                    YRIF
     C                   KFLD                    HEAVD
     C                   KFLD                    HEOPD
     C     KUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    YKN
     C     KODTAK        KLIST
     C                   KFLD                    YAUNI
     C                   KFLD                    UAVD
     C     KODSFK        KLIST
     C                   KFLD                    YSFUNI
     C                   KFLD                    DFSG
     C     KODFSK        KLIST
     C                   KFLD                    YFSUNI
     C                   KFLD                    DFFSN
     C     KODTWK        KLIST
     C                   KFLD                    YWUNI
     C                   KFLD                    UAVD
     C     OTHKEY        KLIST
     C                   KFLD                    USD
     C                   KFLD                    ULNR
     C                   KFLD                    WO1331
     C     *LIKE         DEFINE    DO1331        WO1331
     C                   MOVEL     'DB'          WO1331
n07  C     OTHKEY2       KLIST
n07  C                   KFLD                    USD
n07  C                   KFLD                    ULNR
n18  C     FREETK        KLIST
n18  C                   KFLD                    HEAVD
N18  C                   KFLD                    HEOPD
N18  C                   KFLD                    XXSKKO            1
n18  C     FREETK2       KLIST
n18  C                   KFLD                    FRAVD             4 0
N18  C                   KFLD                    FROPD             7 0
N18  C                   KFLD                    XXSKKO            1
N18  C                   MOVE      'N'           XXSKKO
      *
     C     *ENTRY        PLIST
     C                   PARM                    UPRANT            2
     C                   PARM                    UKODE             1
     C                   PARM                    UAVDU             4
     C                   PARM                    USD               3
     C                   PARM                    ULNRU             3
     C                   PARM                    UULAPU            3
     C                   PARM                    CALLTY            1
N06  C                   PARM                    UDATO             6
N06  c                   move      udato         prdato
     C                   READ      FIRM                                   33
     C                   MOVE      UAVDU         UAVD              4 0
     C                   MOVE      ULNRU         ULNR              3 0
     C                   MOVE      UULAPU        UULAPP            3 0
      *
     C                   MOVE      'W'           YWUNI             1
     C                   MOVE      'AE'          YTAUNI            2
     C                   MOVE      'F'           YRIF              1
     C                   MOVE      'M'           YRIM              1
     C                   MOVE      'A'           YAUNI             1
     C                   MOVE      'LK '         YLKUNI            3
     C                   MOVE      'SF'          YSFUNI            2
     C                   MOVE      'FS'          YFSUNI            2
     C                   MOVE      USD           XSD
     C                   MOVE      ULNR          XLNR
     C                   MOVE      *ZEROS        YKN               8 0
     C                   MOVE      *ZEROS        XPRANT            2 0
     C                   MOVEL     WUSER         WWUSER           17
s11  C*                  MOVE      *BLANKS       WKOPFM            5
     C                   MOVEL     *BLANKS       PGID             17
     C                   MOVEL     *BLANKS       PGIDNE           35
     C                   MOVEL     *BLANKS       PGPACP           17
     C                   MOVEL     *BLANKS       PGPACA           35
     C                   MOVEL     *BLANKS       PGCPAI           17
     C                   MOVEL     *BLANKS       PGCPAA           35
     C                   MOVEL     *BLANKS       PGMTM1            1
     C                   MOVEL     *BLANKS       PGMTM2            1
     C                   MOVEL     *BLANKS       PGMTM3            1
     C                   MOVE      *ZEROS        KOAIAT
      *
     C                   SETOFF                                       27
     C                   MOVEL     '    -   '    XAWBI2
      *
     C     KODTAK        CHAIN     KODTA                              33
     C                   MOVE      *BLANKS       XIAT4             5
     C     KOAIA2        IFNE      *ZEROS
     C                   MOVEL     '/'           XIAT4
     C                   MOVE      KOAIA2        XIAT4
     C                   END
     C     'DISPU'       CHAIN     KODTDIS                            33
     C     SAMLBK        CHAIN     SAMLB                              33
      *
      * AGENT ER MOTTAGER
      *
     C  N33              DO
     C                   MOVE      SMMAWB        XAWB8             8 0
     C                   MOVEL     XAWB8         XAWB41
     C                   MOVE      XAWB8         XAWB42
     C                   END
     C                   MOVE      SMKNS         YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C                   MOVE      KNAVN         XNAK             30
     C                   MOVE      ADR1          XADK1            30
     C                   MOVE      ADR2          XADK2            30
     C                   MOVE      *BLANKS       XADK3            30
     C     POSTNR        IFNE      0
     C                   MOVE      ADR3          XADK3
     C                   MOVEL     POSTNR        XADK3
     C                   ELSE
     C     sypoge        ifeq      *blanks
     C                   MOVEL     ADR3          XADK3
     c                   else
     c                   move      *blanks       xadk3n
     c                   movel     sypoge        XADK3N           40
     C     XADK3N        CAT       adr3:1        XADK3N
     c                   movel     xadk3n        xadk3
     c                   end
     C                   END
     C                   MOVE      TLF           AGTLF            15
     C     AGTLF         COMP      *BLANKS                            8989
      *
     C                   MOVE      *BLANKS       KJLAND
     C     DQAD4         IFEQ      *BLANKS
     C                   MOVE      SYLAND        ST2LKX
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        KJLAND           30
     C                   END
      *
      * KUNDEN STÅR SELV SOM AVSENDER
      * ELLER COLOADER
      *
     C                   MOVE      KOAKNR        YKN
     C     KUND1K        CHAIN     CUNDL01                            33
     C  N33              move      knavn         znavn            30
     C     DOKEMK        CHAIN(N)  DOKEM                              33
     C     DFXX3A        IFNE      *ZEROS
     C     DFXX3A        ANDNE     *BLANKS
     C                   MOVE      DFXX3A        YKN
     C                   MOVE      *ZEROS        KOAIAT
     C                   END
      *
     C     KUND1K        CHAIN     CUNDL01                            33
      *
     C                   MOVEL     ADR3          WWPLAC           24
     C                   MOVE      *BLANKS       SELAND
     C                   MOVE      SYLAND        ST2LKX
N08  C                   MOVE      *BLANKS       AADK3            30
N08  C     POSTNR        IFNE      0
N08  C                   MOVE      ADR3          AADK3
N08  C                   MOVEL     POSTNR        AADK3
N08  C                   ELSE
N08  C     sypoge        ifeq      *blanks
N08  C                   MOVEL     ADR3          AADK3
N80  c                   else
N08  c                   move      *blanks       xadk3n
N08  c                   movel     sypoge        XADK3N           40
N08  C     XADK3N        CAT       adr3:1        XADK3N
N08  c                   movel     xadk3n        AADK3
N08  c                   end
N08  c                   end
     C     KODLKK        CHAIN     KODTLK                             33
     C  N33              MOVE      KLKNVN        SELAND           30
s10  C*    TLF           COMP      *BLANKS                            8888
n10  C     TLF           COMP      *BLANKS                            8787
      *** OBS INDIKATOR 33 BRUKES AV HOVEDRUTINE - MÅ IKKE ØDELEGGES
     C     DOKEMK        CHAIN     DOKEM                              33
     C  N33              UPDATE    DOKEMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     KDTFMT        BEGSR
      ***********************************************
n06  c     prdato        ifne      *blanks
n06  c     prdato        ANDNE     *ZEROS
n06  C                   MOVE      prdd          UDT1              2 0
n06  C                   MOVE      prmm          UDT2              2 0
n06  C                   MOVE      praa          UDT3              2 0
n06  c                   else
     C                   MOVE      UDAY          UDT1              2 0
     C                   MOVE      UMONTH        UDT2              2 0
     C                   MOVE      UYEAR         UDT3              2 0
n06  c                   end
     C                   CALL      'DATOFMT'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
      *
     C                   ENDSR
      ***********************************************
     C     OPNFIL        BEGSR
      ***********************************************
      * DUMMY READ AV FILER
     C  N90
     CAN 90              READ      LABF                                   90
     C  N90              OPEN      CNFF                                 90
     C  N90              OPEN      ISUL01                               90
     C* HVIS ALT GIKK GREIT KAN RUTINEN UTFØRES
     C     OPNF99        ENDSR
     C***********************************************
     C     WRTFWB        BEGSR
     C***********************************************
     C     W03AWB        IFGT      *ZEROS
     C     W03AWB        CHAIN     ISUL01                             90
     C     *IN90         IFEQ      '0'
     C                   MOVEL     ISPART        PGID
     C                   ELSE
     C                   MOVEL     *BLANKS       PGID
     C                   ENDIF
     C     1             CHAIN(N)  CNFF                               90
     C     *IN90         IFEQ      *OFF
     C     CNCOD1        ANDEQ     'Y'
     C                   MOVEL     'CCS'         PGID
     C                   ENDIF
     C                   CALL      'TDV12R'
     C                   PARM                    SMSD
     C                   PARM                    SMLNR
     C                   PARM                    PGID
     C                   PARM                    PGIDNE
     C                   PARM                    PGPACP
     C                   PARM                    PGPACA
     C                   PARM                    PGCPAI
     C                   PARM                    PGCPAA
     C                   PARM                    PGMTM1
     C                   PARM                    PGMTM2
     C                   PARM                    PGMTM3
      *
     C                   ENDIF
      *
     C                   ENDSR
      ***********************************************
     C     CLOFIL        BEGSR
      ***********************************************
      * CLOSER FILER
     C                   CLOSE     CNFF                                 90
     C                   CLOSE     ISUL01                               90
      *
     C                   ENDSR
      ***********************************************
     C     CHKNUM        BEGSR
      ***********************************************
     C                   MOVE      *OFF          *IN91
     C                   Z-ADD     30            ÆX                3 0
     C                   Z-ADD     30            ÆY                3 0
     C                   MOVEA     *BLANKS       AR1
     C                   MOVEA     *BLANKS       AR2
     C                   MOVEA     WRK           AR1
     C     WRK           CABEQ     *BLANKS       CHK99                    92
      * POSISJONER TIL SISTE TEGN I FELTET
     C     AR1(ÆX)       DOWEQ     *BLANK
     C                   SUB       1             ÆX
     C                   ENDDO
      * ERSTATT BLANK MED NULL OG SJEKK OM DET BARE ER TALL
     C     ÆX            DOWGT     0
     C     AR1(ÆX)       IFEQ      *BLANK
     C                   MOVE      '0'           AR1(ÆX)
     C                   ENDIF
     C     AR1(ÆX)       IFGE      '0'
     C     AR1(ÆX)       ANDLE     '9'
     C                   MOVE      AR1(ÆX)       AR2(ÆY)
     C                   SUB       1             ÆX
     C                   SUB       1             ÆY
     C                   ELSE                                                   <AR1,ÆX
      * FELTET INNEHOLDER IKKE BARE TALL. 91 BLIR SATT PÅ
     C                   MOVE      *ON           *IN91
     C                   GOTO      CHK99
     C                   END                                                    <AR1,ÆX
     C                   ENDDO                                                  <ÆX
      * FYLL OPP RESTEN AV FELTET MED NULL
     C     ÆY            DOWGT     0
     C                   MOVE      '0'           AR2(ÆY)
     C                   SUB       1             ÆY
     C                   ENDDO
      *
     C                   MOVEA     AR2           WRK              30
      *
     C     CHK99         ENDSR
      *
     C***********************************************
     C     EDTOTH        BEGSR
     C***********************************************
      * EDITER 2 STRENGER MED OTHER CHARGES
     C                   Z-ADD     ULNR          WLNR              3 0
     C                   CALL      'SYGE17R'
     C                   PARM                    USD
     C                   PARM                    WLNR
     C                   PARM                    DFFTO
     C                   PARM                    DFFT
N07  C                   PARM                    DFFT3
     C                   ENDSR
     c*****************************************************
     c     ovlsr0        begsr
     c*****************************************************
     C                   MOVEL     'AW  '        OVL04             4
     C                   DO        9
     C                   EXSR      PRINT
     C                   MOVE      kopinr        OVL04
     C                   MOVEL     OVL04         AW01
     C                   write     ovl
     C                   ADD       1             KOPINR
n19   *  BAKSIDE
n19   *  OVLBAK
n19   *
n19  c     callty        ifeq      'B'
n19  C                   WRITE     BAKSIDE
n19  C                   WRITE     ovlbak
n19  C                   end
     C                   END
     c                   endsr
     c*****************************************************
     c     ovlsr         begsr
     c*****************************************************
     C                   MOVEL     'AW  '        OVL04             4
     C                   MOVE      kopinr        OVL04
     C                   MOVEL     OVL04         AW01
     C                   write     ovl
n19   *  BAKSIDE
n19   *  OVLBAK
n19   *
n19  c     callty        ifeq      'B'
n19  C                   WRITE     BAKSIDE
n19  C                   WRITE     ovlbak
n19  C                   end
     c                   endsr
n07  C***********************************************
n07  C     SUMOTHA       BEGSR
n07  C***********************************************
s09  C*                  Z-ADD     0             WSBLAG            9 0
n09  C                   Z-ADD     0             WSBLAG            9 2
n07   *
n07   * SUMMER OTHER CHARGES DUE CARRIER
n07   *
n07  C     OTHKEY2       SETLL     DOKOTHM
n07  C     OTHKEY2       READE(N)  DOKOTHM                                66
n07  C     *IN66         DOWEQ     *OFF
n07   *
n07  C     DO1332        IFEQ      'A'
n07  C                   ADD       DO1333        WSBLAG
n07  C                   ENDIF
n07   *
n07  C     OTHKEY2       READE(N)  DOKOTHM                                66
n07  C  N66              ENDDO
n07  C                   ENDSR
N14   ******************************************
N14  C     PRINTMP       BEGSR
N14   ******************************************
N14   * merkelapper i pdf
N14   *
N14  c                   move      dfavd         dfavda            4
N14  c                   move      dfopd         dfopda            7
N14  c                   move      dflop         dflopa            3
N14  c                   move      hesaml        dfsama            6
N14  c                   call      'SYEF14MCL'
N14  c                   parm                    dfavda
N14  c                   parm                    dfopda
N14  c                   parm                    dflopa
N14  c                   parm                    dfsama
N14  C                   PARM                    UPRT68
s20  C*                  EXSR      ARKLAPP
N14  c                   endsr
N16   ******************************************
N16  C     ARKLAPP       BEGSR
N16   ******************************************
N16  C     'al'          chain     arktxt                             33
N16  C     *IN33         IFEQ      '0'
N16  C     arkjn         andeq     'J'
N16  c     heavd         andne     0
N16  C                   MOVE      FIFIRM        ARFIRM
N16  C                   MOVE      HEAVD         ARAVD
N16  C                   MOVE      HEOPD         AROPD
N16  C                   MOVEL     DFLOP         ARUNDE
N16  C                   MOVE      'al'          ARTYPE
N16  C                   MOVE      WUSER         ARUSER
N16  C                   TIME                    XULTID
N16  C                   MOVE      XULDD         ULDD
N16  C                   MOVE      XULMM         ULMM
N16  C                   MOVE      XULÅÅ         ULÅÅ
N16  C                   MOVE      ULDT          ARDATE
N16  C                   MOVE      XULTM         ARTIME
N16  C                   WRITE     ARKIVR
N16  C                   END
N16  C                   ENDSR
N18  c**************************************************
N18  c     fri           begsr
N18  c**************************************************
N18  C*
N18  c                   setoff                                       94
N18  C     YESAML        SETLL     HEAD19
N18  c     *in94         doweq     '0'
n18  C     YESAML        READE     HEAD19                                 94
N18  c     *in94         ifeq      '0'
n18  C     FREETK        chain     FREETXT2                           55
n18  c     *in55         ifeq      '0'
N18  c                   seton                                        94
n18  c                   move      heavd         fravd
n18  c                   move      heopd         fropd
n18  c                   end
n18  c                   end
n18  c                   end
N18  C                   z-add     0             nrv               2 0
n18  C*
N18  C* SKRIVER FRIE LINJER
n18  C     FREETK2       SETLL     FREETXT2
n18  C     FRIST         TAG
n18  C     FREETK2       READE     FREETXT2                               91
n18  C  N91nrv           iflt      10
n18  c  N91              eval      FRTTXT76 = FRTTXT
N18  c  N91              add       1             nrv
n18  c  N91T25(nrv)      ifne      *blanks
n18  c                   move      t25(nrv)      FRTTXT76
n18  c                   end
N18  C  N91              write     prtfrt
N18  C  N91              GOTO      FRIST
n18  c                   end
n18   *
n18   * skriver eventuellt resten av varetekstene
N18   *
n18  c                   add       1             nrv
N18  c     nrv           iflt      18
N18  c     12            sub       nrv           nre               2 0
n18  c     nrv           do        nre           nrv
n18  c     t25(nrv)      ifne      *blanks
N18  c                   MOVEL     t25(nrv)      TX25
n18  c     nrv           ifne      11
N18  C                   WRITE     PRTDE3
N18  c                   move      *blanks       TX25
n18  c                   end
N18  c                   end
N18  c                   end
N18  c                   end
N18  c                   endsr
     OMERKL1    E            MLAP             06
     O                       XGN1                 5
     O                       XGN2                 7
     O                       XGN3                 9
     O                       XGN4                12
     O                       XGN5                14
     O                       XGN6                16
     O                       XGN7                18
     O                       XGN8                21
     O                       XGN9                23
     O                       XGN10               25
     O                       XGN11               27
     O                       XFNTT         Z     36
     O                       XFVKTT        4     46
     O          E            MLAP             09
     O                       FL(1)                5
     O                       FL(2)                7
     O                       FL(3)                9
     O                       XFLY2               36
     O                       XFLY3               45
     O          E            MLAP             12
     O                       XSDF1                5
     O                       XSDF2                7
     O                       XSDF3                9
     O                       XHAWB1              11
     O                       XHAWB2              13
     O                       XHAWB3              15
     O                       XHAWB4              17
     O                       XHAWB5              19
     O                       XHAWB6              21
     O                       DFNTT         Z     36
     O                       DFVKTT        4     46
     OMERKL2    E            MLAP2            04
     O                       HENAK               35
     O          E            MLAP2            06
     O                       HEADK1              35
     O          E            MLAP2            08
     O                       HEADK2              35
     O          E            MLAP2            10
     O                       HEADK3              35
