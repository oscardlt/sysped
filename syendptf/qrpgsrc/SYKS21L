********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
      ***********************************************************
      *** PROGRAM Som viser logg kostnadsbilag                ***
      ***********************************************************
      *
     Ffirm      IF   E           K DISK
     Fkosta     IF   E           K DISK
     Fkostl     IF   E           K DISK
     Flevel01   IF   E           K DISK
     Fsyks21fl  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                SDS
     D  UUSER                254    263
n11  D                 DS
N11  D  LODATO                 1      8  0
N11  D  LOAA                   3      4
N11  D  LOMM                   5      6
N11  D  LODG                   7      8
n11  D                 DS
N11  D  LODAT6                 1      6  0
N11  D  LODG6                  1      2
N11  D  LOMM6                  3      4
N11  D  LOAA6                  5      6
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
n24  C     KEYS          SETLL     KOSTl
     C     START1        TAG
S04  C     KEYS          READE     kostl                                  94
      *
     C     START2        TAG
      *
N15  C                   DOW       *IN94 = *OFF
     C                   ADD       1             ZRECNO
     c                   move      LOAA          LOAA6
     c                   move      LOMM          LOMM6
     c                   move      LODG          LODG6
     C                   WRITE     SUBFIL
     c     Next          tag
     C     KEYS          READE     KOSTL                                  94
     c                   end
      *
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   IF        ZRECNO > 1
     C                   EVAL      ZRECNO = 1
     C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   END
     c   03              goto      slutt
     c   12              goto      slutt
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C*
     C                   GOTO      START3
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     c     keys          klist
     c                   kfld                    kabnr
     C     *ENTRY        PLIST
     C                   PARM                    UKABNR            7
     C                   move      ukabnr        kabnr
     c                   read      firm                                   33
     c     kabnr         chain     kosta                              33
     C     leveke        KLIST
     C                   kfld                    fifirm
     C                   KFLD                    KALNR
     c     kalnr         ifne      *zeros
     c     leveke        chain     level01                            33
     c                   else
     c                   eval      lnavn='*Direkte hovedbok'
     c                   end
     C                   MOVE      *ZEROS        LODATO
     C                   MOVE      *ZEROS        LODAT6
     C                   ENDSR
     C*
