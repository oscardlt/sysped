/* ØKT EMNE TIL 80                            */
/* PTF 2109-2005 ØKT FRA 30 TIL 50 POSISJONER */
             PGM        PARM(&PARM)
             DCL        VAR(&BANE1) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE2) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE3) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE4) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE5) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE6) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE7) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE8) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BANE9) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN10) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN11) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN12) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN13) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN14) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN15) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN16) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN17) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN18) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN19) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN20) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN21) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN22) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN23) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN24) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN25) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN26) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN27) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN28) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN29) TYPE(*CHAR) LEN(140)
             DCL        VAR(&BAN30) TYPE(*CHAR) LEN(140)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&DIST) TYPE(*CHAR) LEN(1) /* DISTLISTE */
             DCL        VAR(&MANAUT) TYPE(*CHAR) LEN(1) VALUE('M')
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(4360)
             DCL        VAR(&RPLNA) TYPE(*CHAR) LEN(8) +
                          VALUE('*CURRENT')
             DCL        VAR(&RPLAD) TYPE(*CHAR) LEN(8)
             DCL        VAR(&DISTL) TYPE(*CHAR) LEN(6) /* DISTLISTE */
             DCL        VAR(&EPOST) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO30) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EPO70) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPOSTF) TYPE(*CHAR) LEN(70)
             DCL        VAR(&CVP1) TYPE(*CHAR) LEN(80)
             DCL        VAR(&CVP2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP3) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP4) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP5) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP6) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP7) TYPE(*CHAR) LEN(40)
             DCL        VAR(&CVP8) TYPE(*CHAR) LEN(40)
             DCL        VAR(&IE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&QUSER) TYPE(*CHAR) LEN(40)
             DCL        VAR(&EPO01) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO02) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO03) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO04) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO05) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO06) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO07) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO08) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO09) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO10) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO11) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO12) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO13) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO14) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO15) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO16) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO17) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO18) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO19) TYPE(*CHAR) LEN(70)
             DCL        VAR(&EPO20) TYPE(*CHAR) LEN(70)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NBR) TYPE(*CHAR) LEN(6)
             DCL        VAR(&UNIK) TYPE(*CHAR) LEN(10) /* Unikkode */
/*                      */
             RTVJOBA    USER(&QUSER)
             CHGVAR     VAR(&EPOST) VALUE(%SST(&PARM 1 70))
             CHGVAR     VAR(&CVP1) VALUE(%SST(&PARM 71 80))
             CHGVAR     VAR(&BANE1) VALUE(%SST(&PARM 151 140))
             CHGVAR     VAR(&BANE2) VALUE(%SST(&PARM 291 140))
             CHGVAR     VAR(&BANE3) VALUE(%SST(&PARM 431 140))
             CHGVAR     VAR(&BANE4) VALUE(%SST(&PARM 571 140))
             CHGVAR     VAR(&BANE5) VALUE(%SST(&PARM 711 140))
             CHGVAR     VAR(&BANE6) VALUE(%SST(&PARM 851 140))
             CHGVAR     VAR(&BANE7) VALUE(%SST(&PARM 991 140))
             CHGVAR     VAR(&BANE8) VALUE(%SST(&PARM 1131 140))
             CHGVAR     VAR(&BANE9) VALUE(%SST(&PARM 1271 140))
             CHGVAR     VAR(&BAN10) VALUE(%SST(&PARM 1411 140))
             CHGVAR     VAR(&BAN11) VALUE(%SST(&PARM 1551 140))
             CHGVAR     VAR(&BAN12) VALUE(%SST(&PARM 1691 140))
             CHGVAR     VAR(&BAN13) VALUE(%SST(&PARM 1831 140))
             CHGVAR     VAR(&BAN14) VALUE(%SST(&PARM 1971 140))
             CHGVAR     VAR(&BAN15) VALUE(%SST(&PARM 2111 140))
             CHGVAR     VAR(&BAN16) VALUE(%SST(&PARM 2251 140))
             CHGVAR     VAR(&BAN17) VALUE(%SST(&PARM 2391 140))
             CHGVAR     VAR(&BAN18) VALUE(%SST(&PARM 2531 140))
             CHGVAR     VAR(&BAN19) VALUE(%SST(&PARM 2671 140))
             CHGVAR     VAR(&BAN20) VALUE(%SST(&PARM 2811 140))
             CHGVAR     VAR(&BAN21) VALUE(%SST(&PARM 2951 140))
             CHGVAR     VAR(&BAN22) VALUE(%SST(&PARM 3091 140))
             CHGVAR     VAR(&BAN23) VALUE(%SST(&PARM 3231 140))
             CHGVAR     VAR(&BAN24) VALUE(%SST(&PARM 3371 140))
             CHGVAR     VAR(&BAN25) VALUE(%SST(&PARM 3511 140))
             CHGVAR     VAR(&BAN26) VALUE(%SST(&PARM 3651 140))
             CHGVAR     VAR(&BAN27) VALUE(%SST(&PARM 3791 140))
             CHGVAR     VAR(&BAN28) VALUE(%SST(&PARM 3931 140))
             CHGVAR     VAR(&BAN29) VALUE(%SST(&PARM 4071 140))
             CHGVAR     VAR(&BAN30) VALUE(%SST(&PARM 4211 140))
             CHGVAR     VAR(&UNIK) VALUE(%SST(&PARM 4351 10))
/*                      */
             RTVDTAARA  DTAARA(FIRMDT (141 10)) RTNVAR(&LIB)
/*                      */
             CHGVAR     VAR(&EPO30) VALUE(&EPOST)
             CHGVAR     VAR(&EPO70) VALUE(&EPOST)
             CHGVAR     VAR(&RPLNA) VALUE(&QUSER)
             RTVNETA    SYSNAME(&RPLAD)
/*                      */
             OVRDBF     FILE(ARKSRC) TOFILE(&LIB/ARKSRC) MBR(&UNIK)
/*                      */
/*                      */
/* HENT REPLYADRESSE    */
/*                      */
/*                      */
             CALL       PGM(EPOS04) PARM(&QUSER &RPLNA &RPLAD &EPOSTF)
/*                      */
/*                                       */
             ADDLIBLE   LIB(MMAIL)
             MONMSG     MSGID(CPF0000)
/*                                     */
/* UTEN DISTRIBUSJONSLISTE             */
/*                                     */
             CHGVAR     VAR(&DIST) VALUE(%SST(&EPOST 1 1))
             CHGVAR     VAR(&DISTL) VALUE(%SST(&EPO70 2 6))
             IF         COND(&DIST *NE '*') THEN(DO)
/*                                     */
/* SEND SOM VEDLEGG                    */
/*                                     */
             IF         COND(&BANE1 *NE '            ') THEN(DO)
             EMLSTMF    SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO30/&EPO70/*TO) +
                          STMF(&BANE1 &BANE2 &BANE3 &BANE4 &BANE5 +
                          &BANE6 &BANE7 &BANE8 &BANE9 &BAN10 +
                          &BAN11 &BAN12 &BAN13 &BAN14 &BAN15 +
                          &BAN16 &BAN17 &BAN18 &BAN19 &BAN20 +
                          &BAN21 &BAN22 &BAN23 &BAN24 &BAN25 +
                          &BAN26 &BAN27 &BAN28 &BAN29 &BAN30) +
                          MSGM(&LIB/ARKSRC/&UNIK) EDTMSGM(*NO)
             RMVLIBLE   LIB(MMAIL)
             RETURN
             ENDDO
/*                                     */
/* SEND SOM LINK                       */
/*                                     */
             EMLMSG     SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO30/&EPO70/*TO) +
                          TXTF(&LIB/ARKSRC) TXTMBR(&UNIK)
/*                      */
/*                      */
             RMVLIBLE   LIB(MMAIL)
             RETURN
             ENDDO
/*                      */
/*                      */
/*                                       */
/*                                     */
/*  SENDING VED DISTRIBUSJONSLISTE     */
/*                                     */
/*                                     */
             CALL       PGM(EPODIS2) PARM(&DISTL &EPO01 &EPO02 &EPO03 +
                          &EPO04 &EPO05 &EPO06 &EPO07 &EPO08 &EPO09 +
                          &EPO10 &EPO11 &EPO12 &EPO13 &EPO14 &EPO15 +
                          &EPO16 &EPO17 &EPO18 &EPO19 &EPO20)
/*                                     */
/*  SENDING TIL MOTTAGER 01            */
/*                                     */
             IF         COND(&EPO01 *NE '*NONE                    ') +
                          THEN(DO)
             CHGVAR     VAR(&EPO30) VALUE(&EPO01)
             CHGVAR     VAR(&EPO70) VALUE(&EPO01)
/*                                     */
/* SEND SOM VEDLEGG                    */
/*                                     */
             IF         COND(&BANE1 *NE '            ') THEN(DO)
             EMLSTMF    SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO01/&EPO01/*TO +
                          &EPO02/&EPO02/*TO &EPO03/&EPO03/*TO +
                          &EPO04/&EPO04/*TO &EPO05/&EPO05/*TO +
                          &EPO06/&EPO06/*TO &EPO07/&EPO07/*TO +
                          &EPO08/&EPO08/*TO &EPO09/&EPO09/*TO +
                          &EPO10/&EPO10/*TO &EPO11/&EPO11/*TO +
                          &EPO12/&EPO12/*TO &EPO13/&EPO13/*TO +
                          &EPO14/&EPO14/*TO &EPO15/&EPO15/*TO +
                          &EPO16/&EPO16/*TO &EPO17/&EPO17/*TO +
                          &EPO18/&EPO18/*TO &EPO19/&EPO19/*TO +
                          &EPO20/&EPO20/*TO) STMF(&BANE1 &BANE2 +
                          &BANE3 &BANE4 &BANE5 &BANE6 &BANE7 &BANE8 +
                          &BANE9 &BAN10 &BAN11 &BAN12 &BAN13 &BAN14 +
                          &BAN15 &BAN16 &BAN17 &BAN18 &BAN19 &BAN20 +
                          &BAN21 &BAN22 &BAN23 &BAN24 &BAN25 &BAN26 +
                          &BAN27 &BAN28 &BAN29 &BAN30) +
                          MSGM(&LIB/ARKSRC/&UNIK) EDTMSGM(*NO)
             GOTO       CMDLBL(UT)
             ENDDO
/*                                     */
             EMLMSG     SUBJECT(&CVP1) FROMNAME(&RPLNA) +
                          FROMADDR(&EPOSTF) TO(&EPO01/&EPO01/*TO +
                          &EPO02/&EPO02/*TO &EPO03/&EPO03/*TO +
                          &EPO04/&EPO04/*TO &EPO05/&EPO05/*TO +
                          &EPO06/&EPO06/*TO &EPO07/&EPO07/*TO +
                          &EPO08/&EPO08/*TO &EPO09/&EPO09/*TO +
                          &EPO10/&EPO10/*TO &EPO11/&EPO11/*TO +
                          &EPO12/&EPO12/*TO &EPO13/&EPO13/*TO +
                          &EPO14/&EPO14/*TO &EPO15/&EPO15/*TO +
                          &EPO16/&EPO16/*TO &EPO17/&EPO17/*TO +
                          &EPO18/&EPO18/*TO &EPO19/&EPO19/*TO +
                          &EPO20/&EPO20/*TO) TXTF(&LIB/ARKSRC) +
                          TXTMBR(&UNIK)
                          ENDDO
UT:          RMVLIBLE   LIB(MMAIL)
                          ENDPGM
