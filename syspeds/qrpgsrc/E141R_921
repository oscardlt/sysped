     H DATEDIT(*YMD)
     FEDIM      IF   E           K DISK
     FEDTM921   IF   E           K DISK
     FEDOC921   IF   E           K DISK
     FEEQD921   IF   E           K DISK
     FEFTX921   IF   E           K DISK
     FEGDS921   IF   E           K DISK
     FEGID921   IF   E           K DISK
     FELOC921   IF   E           K DISK
     FEMEA921   IF   E           K DISK
     FEMOA921   IF   E           K DISK
     FENAD921   IF   E           K DISK
     FEPCI921   IF   E           K DISK
     FEPIA921   IF   E           K DISK
     FERFF921   IF   E           K DISK
     FESEL921   IF   E           K DISK
     FETCC921   IF   E           K DISK
     FETDT921   IF   E           K DISK
     FETMD921   IF   E           K DISK
     FVAADVH    O  A E             DISK
     FVAADVV    O  A E             DISK
     D A               S              1    DIM(79)
     D B               S              1    DIM(18)
      *________________________
      * DS for decimal handling
      *""""""""""""""""""""""""
     D                 DS
     D  ZDEC                   1      7  6
     D  ZDEC6                  2      7
     D  ZHEL                  11     22  0
     D                 DS
     D  WMN2                   1      9  0
     D                 DS
     D  WTIME                  1     14  0
     D  WTID                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  W≈≈                   11     14  0
     D                 DS
     D  WDATO                  1      8  0
     D  W≈                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
      */////////////
      * MAIN LOGIC /
      */////////////
      *___________
      * Initiering
      *"""""""""""
     C                   EXSR      INIT
      *________
      * CONVERT
      *""""""""
     C                   EXSR      BGM00
     C                   EXSR      FTX00
     C                   EXSR      RFF03
     C                   EXSR      TDT08
     C                   EXSR      NAD10
     C                   EXSR      EQD34
     C                   EXSR      GID16
     C                   WRITE     VAADVHR
      *
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      * BGM00                                               BGM00 /
      *////////////////////////////////////////////////////////////
     C     BGM00         BEGSR
      *__________________
      * CLEAR HEADINGFILE
      *""""""""""""""""""
     C                   CLEAR                   VAADVHR
      *____________
      * INIT FIELDS
      *""""""""""""
     C                   MOVEL     M1004         VHSREF
     C                   Z-ADD     MSN           VHSN
     C                   Z-ADD     MMN           VHMN
     C                   MOVEL     WDATO         VHDT
     C                   MOVEL     WTID          VHTM
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GDS18                                               GID18 /
      *////////////////////////////////////////////////////////////
     C     GDS18         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     18            ZGN1
     C     KEYMS1        SETLL     EGDS921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EGDS921                                52
     C     *IN51         DOWEQ     '0'
      *
     C                   Z-ADD     GREP0         ZREPC0
     C                   Z-ADD     GREP1         ZREPC1
     C                   EXSR      FTX18
      *
     C     KEYMS1        READE     EGDS921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * GID16                                               GID16 /
      *////////////////////////////////////////////////////////////
     C     GID16         BEGSR
      *___________________
      * READ CONSIGNEMENTS
      *"""""""""""""""""""
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     16            ZGN0
     C     KEYMS0        SETLL     EGID921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EGID921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   EXSR      RTVDB
      *
     C     KEYMS0        READE     EGID921                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DOC23                                               DOC23 /
      *////////////////////////////////////////////////////////////
     C     DOC23         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     23            ZGN1
     C     KEYMS1        SETLL     EDOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDOC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     D1004         VVCABL
      *
     C     KEYMS1        READE     EDOC921                                52
     C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM08                                               DTM08 /
      *////////////////////////////////////////////////////////////
     C     DTM08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     EDTM921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EDTM921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     D2005         IFEQ      '133'
     C                   MOVEL     D2380         VHETD
     C                   ELSE
     C     D2005         IFEQ      '132'
     C                   MOVEL     D2380         VHETA
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     EDTM921                                52
     C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * DTM14                                               DTM14 /
      *////////////////////////////////////////////////////////////
     C     DTM14         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     14            ZGN2
     C     KEYMS2        SETLL     EDTM921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EDTM921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   SELECT
     C     N3035         WHENEQ    'NI '
     C                   MOVEL     D2380         VHNIH
     C     N3035         WHENEQ    'DS '
     C                   MOVEL     D2380         VHDSH
     C                   ENDSL
      *
     C     KEYMS2        READE     EDTM921                                53
     C  N53              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * EQD34                                               EQD34 /
      *////////////////////////////////////////////////////////////
     C     EQD34         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     34            ZGN0
     C     KEYMS0        SETLL     EEQD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EEQD921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   MOVEL     E8260         VHCONO
     C                   MOVEL     E8154         VHCOTY
      *
     C                   Z-ADD     NREP0         ZREPB0
     C                   EXSR      TMD34
     C                   EXSR      MEA34
     C                   EXSR      SEL34
      *
     C     KEYMS0        READE     EEQD921                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX00                                               FTX00 /
      *////////////////////////////////////////////////////////////
     C     FTX00         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     0             ZGN0
     C     KEYMS0        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     EFTX921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   SELECT
     C     VHFTXA        WHENEQ    *BLANKS
     C                   MOVEL     F4440A        VHFTXA
     C                   MOVEL     F4440B        VHFTXB
     C                   MOVEL     F4440C        VHFTXC
     C                   MOVEL     F4440D        VHFTXD
     C                   MOVEL     F4440E        VHFTXE
     C     VHFTXF        WHENEQ    *BLANKS
     C                   MOVEL     F4440A        VHFTXF
     C                   MOVEL     F4440B        VHFTXG
     C                   MOVEL     F4440C        VHFTXH
     C                   MOVEL     F4440D        VHFTXI
     C                   MOVEL     F4440E        VHFTXJ
     C     VHFTXK        WHENEQ    *BLANKS
     C                   MOVEL     F4440A        VHFTXK
     C                   MOVEL     F4440B        VHFTXL
     C                   MOVEL     F4440C        VHFTXM
     C                   MOVEL     F4440D        VHFTXN
     C                   MOVEL     F4440E        VHFTXO
     C     VHFTXP        WHENEQ    *BLANKS
     C                   MOVEL     F4440A        VHFTXP
     C                   MOVEL     F4440B        VHFTXQ
     C                   MOVEL     F4440C        VHFTXR
     C                   MOVEL     F4440D        VHFTXS
     C                   MOVEL     F4440E        VHFTXT
     C     VHFTXU        WHENEQ    *BLANKS
     C                   MOVEL     F4440A        VHFTXU
     C                   MOVEL     F4440B        VHFTXV
     C                   MOVEL     F4440C        VHFTXW
     C                   MOVEL     F4440D        VHFTXX
     C                   MOVEL     F4440E        VHFTXY
     C                   ENDSL
      *
     C     KEYMS0        READE     EFTX921                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX16                                               FTX16 /
      *////////////////////////////////////////////////////////////
     C     FTX16         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EFTX921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     F4451         WHENEQ    'AAA'
     C                   MOVEL     F4440A        VVPRDA
     C     F4451         WHENEQ    'PAC'
     C                   MOVEL     F4440A        VVPACA
     C     F4451         WHENEQ    'AAS'
     C                   MOVEL     F4440A        VVAASA
     C                   MOVEL     F4440B        VVAASB
     C                   MOVEL     F4440C        VVAASC
     C                   MOVEL     F4440D        VVAASD
     C                   MOVEL     F4440E        VVAASE
     C                   ENDSL
      *
     C     KEYMS1        READE     EFTX921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * FTX18                                               FTX18 /
      *////////////////////////////////////////////////////////////
     C     FTX18         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     18            ZGN2
     C     KEYMS2        SETLL     EFTX921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EFTX921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   SELECT
     C     F4451         WHENEQ    'AAA'
     C                   MOVEL     F4440A        VVGODA
     C                   MOVEL     F4440B        VVGODB
     C                   MOVEL     F4440C        VVGODC
     C                   MOVEL     F4440D        VVGODD
     C                   MOVEL     F4440E        VVGODE
     C                   ENDSL
      *
     C     KEYMS2        READE     EFTX921                                53
     C  N53              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Get numerical value                               GETNUM /
      *////////////////////////////////////////////////////////////
     C     GETNUM        BEGSR
     C                   MOVE      *ZEROS        ZHEL
     C                   MOVE      *ZEROS        ZDEC
     C                   MOVE      *ZEROS        B
     C                   Z-ADD     1             AX                2 0
     C                   Z-ADD     1             BX                2 0
      * Get Integer
     C     A(AX)         DOWGE     '0'
     C     ZHEL          MULT      10            ZHEL
     C                   MOVE      A(AX)         ZHEL
     C                   ADD       1             AX
     C                   ENDDO
      * Decimal point ?
     C     A(AX)         IFEQ      '.'
     C     A(AX)         OREQ      ','
     C                   ADD       1             AX
     C     A(AX)         DOWGE     '0'
     C                   MOVE      A(AX)         B(BX)
     C                   ADD       1             AX
     C                   ADD       1             BX
     C                   ENDDO
     C                   MOVEA     B             ZDEC6
     C                   ENDIF
      * Concatenate
     C                   Z-ADD     ZHEL          ZNUM             18 6
     C                   ADD       ZDEC          ZNUM
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *                                                      INIT /
      *////////////////////////////////////////////////////////////
     C     INIT          BEGSR
     C     KEYMS0        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN0
     C     KEYMS1        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN1
     C                   KFLD                    ZREPB0
     C     KEYMS2        KLIST
     C                   KFLD                    ZMN
     C                   KFLD                    ZGN2
     C                   KFLD                    ZREPC0
     C                   KFLD                    ZREPC1
      *
     C     *LIKE         DEFINE    NMN           ZMN
     C     *LIKE         DEFINE    NGN           ZGN0
     C     *LIKE         DEFINE    NGN           ZGN1
     C     *LIKE         DEFINE    NGN           ZGN2
     C     *LIKE         DEFINE    NREP0         ZREPB0
     C     *LIKE         DEFINE    NREP0         ZREPC0
     C     *LIKE         DEFINE    NREP0         ZREPC1
     C     *LIKE         DEFINE    VVVN          ZVVN
      * INIT WORKFIELDS
     C     *ENTRY        PLIST
     C                   PARM                    WMN1              9
     C                   MOVEL     WMN1          WMN2
     C                   Z-ADD     WMN2          ZMN
     C                   Z-ADD     0             ZVVN
      * Get msg and interchange values
     C     ZMN           CHAIN     EDIM                               51
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
     C                   Z-ADD     W≈≈           W≈
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC08                                               LOC08 /
      *////////////////////////////////////////////////////////////
     C     LOC08         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     8             ZGN1
     C     KEYMS1        SETLL     ELOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     L3227         IFEQ      '33 '
     C                   MOVEL     L3225         VHLODA
     C                   MOVEL     L3224         VHLODB
     C                   ELSE
     C     L3227         IFEQ      '34 '
     C                   MOVEL     L3225         VHLOLA
     C                   MOVEL     L3224         VHLOLB
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     ELOC921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * LOC16                                               LOC16 /
      *////////////////////////////////////////////////////////////
     C     LOC16         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     ELOC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ELOC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     L3227         IFEQ      '88 '
     C                   MOVEL     L3225         VVLOOA
     C                   MOVEL     L3224         VVLOOB
     C                   ELSE
     C     L3227         IFEQ      '8  '
     C                   MOVEL     L3225         VVLODA
     C                   MOVEL     L3224         VVLODB
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     ELOC921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MOA28                                               MOA28 /
      *////////////////////////////////////////////////////////////
     C     MOA28         BEGSR
     C                   MOVE      '0'           *IN53
     C                   Z-ADD     28            ZGN2
     C     KEYMS2        SETLL     EMOA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS2        READE     EMOA921                                53
     C     *IN53         DOWEQ     '0'
      *
     C                   MOVEA     M5004         A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          VVFRCA
     C                   MOVEL     M6345         VVFRCC
      *
     C     KEYMS2        READE     EMOA921                                53
     C  N53              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MEA19                                               MEA19 /
      *////////////////////////////////////////////////////////////
     C     MEA19         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     19            ZGN1
     C     KEYMS1        SETLL     EMEA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMEA921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   SELECT
     C     M6311         WHENEQ    'WT '
     C                   Z-ADD     ZNUM          VVWT
     C     M6311         WHENEQ    'VOL'
     C                   Z-ADD     ZNUM          VVVO
     C     M6311         WHENEQ    'CT '
     C                   Z-ADD     ZNUM          VVCT
     C                   ENDSL
      *
     C     KEYMS1        READE     EMEA921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * MEA34                                               MEA34 /
      *////////////////////////////////////////////////////////////
     C     MEA34         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     34            ZGN1
     C     KEYMS1        SETLL     EMEA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EMEA921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEA     M6314         A
     C                   EXSR      GETNUM
     C                   SELECT
     C     M6311         WHENEQ    'WT '
     C                   Z-ADD     ZNUM          VHEQWT
     C     M6311         WHENEQ    'VOL'
     C                   Z-ADD     ZNUM          VHEQVO
     C                   ENDSL
      *
     C     KEYMS1        READE     EMEA921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * NAD10                                               NAD10 /
      *////////////////////////////////////////////////////////////
     C     NAD10         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     10            ZGN0
     C     KEYMS0        SETLL     ENAD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ENAD921                                51
     C     *IN51         DOWEQ     '0'
      *
     C                   SELECT
     C     N3035         WHENEQ    'NI'
     C                   MOVEL     N3039         VHNIA
     C                   MOVEL     N3124A        VHNIB
     C                   MOVEL     N3124B        VHNIC
     C                   MOVEL     N3124C        VHNID
     C                   MOVEL     N3124D        VHNIE
     C                   MOVEL     N3124E        VHNIF
     C     N3035         WHENEQ    'DS'
     C                   MOVEL     N3039         VHDSA
     C                   MOVEL     N3124A        VHDSB
     C                   MOVEL     N3124B        VHDSC
     C                   MOVEL     N3124C        VHDSD
     C                   MOVEL     N3124D        VHDSE
     C                   MOVEL     N3124E        VHDSF
     C                   ENDSL
      *
     C                   Z-ADD     NREP0         ZREPB0
     C                   EXSR      RFF14
      *
      *
     C     KEYMS0        READE     ENAD921                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * NAD17                                               NAD17 /
      *////////////////////////////////////////////////////////////
     C     NAD17         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     17            ZGN1
     C     KEYMS1        SETLL     ENAD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ENAD921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     N3035         WHENEQ    'CZ'
     C                   MOVEL     N3039         VVCZA
     C                   MOVEL     N3124A        VVCZB
     C                   MOVEL     N3124B        VVCZC
     C                   MOVEL     N3124C        VVCZD
     C                   MOVEL     N3124D        VVCZE
     C                   MOVEL     N3124E        VVCZF
     C     N3035         WHENEQ    'CN'                                         LEV.ADR
     C                   MOVEL     N3039         VVCNA
     C                   MOVEL     N3124A        VVCNB
     C                   MOVEL     N3124B        VVCNC
     C                   MOVEL     N3124C        VVCND
     C                   MOVEL     N3124D        VVCNE
     C                   MOVEL     N3124E        VVCNF
      *
     C                   ENDSL
      *
     C     KEYMS1        READE     ENAD921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * PCI22                                               PCI22 /
      *////////////////////////////////////////////////////////////
     C     PCI22         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     22            ZGN1
     C     KEYMS1        SETLL     EPCI921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EPCI921                                52
     C     *IN52         IFEQ      '0'
      *
     C                   MOVEL     P7102A        VVPCIA
     C                   MOVEL     P7102B        VVPCIB
     C                   MOVEL     P7102C        VVPCIC
     C                   MOVEL     P7102D        VVPCID
     C                   MOVEL     P7102E        VVPCIE
     C                   MOVEL     P7102F        VVPCIF
     C                   MOVEL     P7102G        VVPCIG
     C                   MOVEL     P7102H        VVPCIH
     C                   MOVEL     P7102I        VVPCII
     C                   MOVEL     P7102J        VVPCIJ
      *
     C                   ENDIF
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * PIA16                                               PIA16 /
      *////////////////////////////////////////////////////////////
     C     PIA16         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     16            ZGN1
     C     KEYMS1        SETLL     EPIA921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     EPIA921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     P7140A        VVPRNO
     C                   MOVEL     P7140B        VVPRIA
     C                   MOVEL     P7140C        VVPRIB
     C                   MOVEL     P7140D        VVPRIC
     C                   MOVEL     P7140E        VVPRID
      *
     C     KEYMS1        READE     EPIA921                                52
     C  N52              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF03                                               RFF03 /
      *////////////////////////////////////////////////////////////
     C     RFF03         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     3             ZGN0
     C     KEYMS0        SETLL     ERFF921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ERFF921                                51
     C     *IN51         DOWEQ     '0'
      *
     C     R1153         IFEQ      'SRN'
     C                   MOVEL     R1154         VHSREF
     C                   ENDIF
      *
     C     KEYMS0        READE     ERFF921                                51
     C  N51              ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF14                                               RFF14 /
      *////////////////////////////////////////////////////////////
     C     RFF14         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     14            ZGN1
     C     KEYMS1        SETLL     ERFF921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     N3035         IFEQ      'NI '
     C                   MOVEL     R1154         VHNIG
     C                   ELSE
     C     N3035         IFEQ      'DS '
     C                   MOVEL     R1154         VHDSG
     C                   ENDIF
     C                   ENDIF
      *
     C                   Z-ADD     RREP0         ZREPC0
     C                   Z-ADD     RREP1         ZREPC1
     C                   EXSR      DTM14
      *
     C     KEYMS1        READE     ERFF921                                52
     C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RFF21                                               RFF21 /
      *////////////////////////////////////////////////////////////
     C     RFF21         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     21            ZGN1
     C     KEYMS1        SETLL     ERFF921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ERFF921                                52
     C     *IN52         DOWEQ     '0'
      *
     C     N3035         IFEQ      'ON '
     C                   MOVEL     R1154         VVRFON
     C                   ELSE
     C     N3035         IFEQ      'BN '
     C                   MOVEL     R1154         VVRFBN
     C                   ENDIF
     C                   ENDIF
      *
     C     KEYMS1        READE     ERFF921                                52
     C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * RETREIVE INFO FROM EDIFACT DATABASE TO SYSPED400    RTVDB /
      *////////////////////////////////////////////////////////////
     C     RTVDB         BEGSR
      *__________________
      * INIT. DATAFELTER
      *""""""""""""""""""
     C                   CLEAR                   VAADVVR
     C                   Z-ADD     VHETA         VVETA
     C                   Z-ADD     VHMN          VVMN
     C                   ADD       1             ZVVN
     C                   Z-ADD     ZVVN          VVVN
     C                   MOVEA     G1496         A
     C                   EXSR      GETNUM
     C                   Z-ADD     ZNUM          VVSEQN
     C                   MOVEL     VHSREF        VVSREF
     C                   MOVEL     VHCONO        VVCONO
     C                   MOVEA     G7224A        A
     C                   EXSR      GETNUM
     C                   ADD       ZNUM          VVPACN
     C                   ADD       ZNUM          VVCT
     C                   MOVEL     G7064A        VVPACT
      *__________________
      * READ ALL SEGMENTS
      *""""""""""""""""""
     C                   Z-ADD     GREP0         ZREPB0
     C                   EXSR      LOC16
     C                   EXSR      PIA16
     C                   EXSR      FTX16
     C                   EXSR      NAD17
     C                   EXSR      GDS18
     C                   EXSR      MEA19
     C                   EXSR      RFF21
     C                   EXSR      PCI22
     C                   EXSR      DOC23
     C                   EXSR      TCC28
      *________________
      * WRITE TO VARNER
      *""""""""""""""""
     C                   WRITE     VAADVVR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SEL34                                               SEL34 /
      *////////////////////////////////////////////////////////////
     C     SEL34         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     34            ZGN1
     C     KEYMS1        SETLL     ESEL921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ESEL921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   SELECT
     C     VHSELA        WHENEQ    *BLANKS
     C                   MOVEL     S9308         VHSELA
     C     VHSELB        WHENEQ    *BLANKS
     C                   MOVEL     S9308         VHSELB
     C     VHSELC        WHENEQ    *BLANKS
     C                   MOVEL     S9308         VHSELC
     C                   ENDSL
      *
     C     KEYMS1        READE     ESEL921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TCC28                                               TCC28 /
      *////////////////////////////////////////////////////////////
     C     TCC28         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     28            ZGN1
     C     KEYMS1        SETLL     ETCC921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETCC921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   Z-ADD     TREP0         ZREPC0
     C                   Z-ADD     TREP1         ZREPC1
     C                   EXSR      MOA28
      *
     C     KEYMS1        READE     ETCC921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TDT08                                               TDT08 /
      *////////////////////////////////////////////////////////////
     C     TDT08         BEGSR
     C                   MOVE      '0'           *IN51
     C                   Z-ADD     8             ZGN0
     C     KEYMS0        SETLL     ETDT921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS0        READE     ETDT921                                51
     C     *IN51         DOWEQ     '0'
      *
     C     T8051         IFEQ      '20 '
      *
     C                   MOVEL     T8028         VHVOY
     C                   MOVEL     T3127         VHCARI
     C                   MOVEL     T3128         VHCARN
     C                   MOVEL     T8212         VHCARV
      *
     C                   Z-ADD     TREP0         ZREPB0
     C                   EXSR      DTM08
     C                   EXSR      LOC08
      *
     C                   ENDIF
      *
     C     KEYMS0        READE     ETDT921                                51
     C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * TMD34                                               TMD34 /
      *////////////////////////////////////////////////////////////
     C     TMD34         BEGSR
     C                   MOVE      '0'           *IN52
     C                   Z-ADD     34            ZGN1
     C     KEYMS1        SETLL     ETMD921                                20
     C     *IN20         IFEQ      '1'
     C     KEYMS1        READE     ETMD921                                52
     C     *IN52         DOWEQ     '0'
      *
     C                   MOVEL     T8335         VHMOTY
      *
     C     KEYMS1        READE     ETMD921                                52
     C  N52              ENDDO
     C                   ENDIF
     C                   ENDSR
