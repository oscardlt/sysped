********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10001 * 01 YBC PTF10 KLARGJØR TIL EKSTERN REFERANSE
10XXX * 02 YBC PTF10 SØK KUN EN KUNDE AV GANGEN
10XXX * 03 YBC PTF10 BRUKER KODE *CN OG 132 BREDD
10XXX * 04 YBC PTF10 KUN VIS OPPDRAG MED SAMMMEN START-REF.
10XXX * 05 YBC PTF10 SØKING PÅ ALLE AVDELINGER BRUKER EGNE FILER
10017 * 06 YBC PTF10 SKILLE TET-EKSPORT OG FORHÅNDSVARSLING IMPORT
10210 * 07 YBC PTF10 VIS ALLE IKKE GJENNOMFØRTE TET FØRST
10XXX * 08 YBC PTF10 OPSJON 18 = NOTISBLOKK
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11XXX * 09 YBC PTF11 TEST STATUS VED KANSELLERING
11128 * 10 YBC PTF11 VEKT ER ENDRET FRA 9.0 TIL 11.3
11129 * 11 YBC PTF11 NYE KODER FOR FORHÅNDSVARSEL FRA JUNI 2016
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
12156 * 12 YBC PTF12 Vis ikke avsluttet transitt
12XXX * 13 YBC PTF12 Feilretting på endring 12
12231 * 14 YBC PTF12 Søk via mottakersnavn
12XXX * 15 YBC PTF12 Opsjon 35 for printe T-dok som mottar KUN IE28
12XXX * 16 SH  PTF12 Vise frist på rullebildet WSDT2
12288 * 17 CB  PTF12 Vise garantibelöp på rullebildet
12289 * 18 CB  PTF12 Bytt ut LF TRUH15 til TRUH16
12290 * 19 CB  PTF12 Liste frister garantibelöp
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL ARBEIDE MED EL. TRANSITTERING UT       ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 07 09-14 17-24             ***
      *** LEDIGE INDIKATORER 31 32 34-39 50-89 95             ***
      ***********************************************************
      *
N19  H DftActGrp( *No )
     FTVINF     O  A E             DISK    USROPN
N15  FARKIVL15  IF A E           K DISK
     FTRUGH     UF   E           K DISK
     FTRUH      IF   E           K DISK
     FTRUHOPD   UF   E           K DISK    RENAME(TRUHR:TRUHROPD)
     FTRUH01    IF   E           K DISK    RENAME(TRUHR:TRUH01R)
     FTRUH02    IF   E           K DISK    RENAME(TRUHR:TRUH02R)
     FTRUH03    IF   E           K DISK    RENAME(TRUHR:TRUH03R)
     FTRUH04    IF   E           K DISK    RENAME(TRUHR:TRUH04R)
     FTRUH05    IF   E           K DISK    RENAME(TRUHR:TRUH05R)
     FTRUH07    IF   E           K DISK    RENAME(TRUHR:TRUH07R)
     FTRUH08    IF   E           K DISK    RENAME(TRUHR:TRUH08R)
     FTRUH09    IF   E           K DISK    RENAME(TRUHR:TRUH09R)
N07  FTRUH11    IF   E           K DISK    RENAME(TRUHR:TRUH11R)
N05  FTRUH12    IF   E           K DISK    RENAME(TRUHR:TRUH12R)
N05  FTRUH13    IF   E           K DISK    RENAME(TRUHR:TRUH13R)
N05  FTRUH14    IF   E           K DISK    RENAME(TRUHR:TRUH14R)
S18  F*RUH15    IF   E           K DISK    RENAME(TRUHR:TRUH145)
N18  FTRUH16    IF   E           K DISK    RENAME(TRUHR:TRUH145)
     FTRUSTD    IF   E           K DISK
N01  FFRISOL01  IF   E           K DISK
N03  FFRISOK    IF   E           K DISK    RENAME(FRISOKR:FRISOKR0)
N07  FKALENDER  IF   E           K DISK
     FKODTA     IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FEDIC      UF   E             DISK
     FEDIM      O  A E           K DISK    USROPN
     FEDIM2     IF   E           K DISK    RENAME(EDIMR:EDIMR2)
     FEDIM4     IF   E           K DISK    RENAME(EDIMR:EDIMR4)
     FFIRM      IF   E           K DISK
     FFREETXT2  UF A E           K DISK
     FSTS       IF A E           K DISK
     FFIRMARC   IF   E             DISK
     FTR010D    CF   E             WORKSTN SFILE(SUBFIL:ZRECNO)
N02  F                                     INFDS(FBAREA)
     ‚*__________
     ‚* Variabler
     ‚*""""""""""
     d file_o          s               *
     d rc              s             10i 0
     d data            s          30000a   varying
     d codepage        s              5a   varying
     ‚*___________________________
     ‚* IFS Stream file funksjoner
     ‚*"""""""""""""""""""""""""""
     dopen             pr              *   extproc( '_C_IFS_fopen' )
     d                                 *   value options( *string )
     d                                 *   value options( *string )

     dfputs            pr            10i 0 extproc( '_C_IFS_fputs' )
     d                                 *   value options( *string )
     d                                 *   value

     dclose            pr            10i 0 extproc( '_C_IFS_fclose' )
     d                                 *   value
     ‚*  Prototype for 'SAD62R5'
     d SYGE39B         pr                  extpgm('SYGE39B')
     d wfilnam2_                           like(wfilnam2)
N02  D FBAREA          DS
N02  D  WSCLOC               370    371B 0
N02  D  WSSUBN               378    379B 0
     D                 DS
     D  WAFT1                  1     50
     D  WAFT2                 51    100
     D  WAFT3                101    150
     D  WAFT4                151    200
     D  WAFT5                201    250
     D  FT                     1    250    DIM(5)
     D  FT2501                 1    250
     D                 DS
     D  WADT                   1      6  0
     D  WADTD                  1      2  0
     D  WADTM                  3      4  0
     D  WADTÅ                  5      6  0
     D                 DS
     D  FRTDT                  1      8  0
     D  FRTDTÅ                 1      4  0
     D  FRTDTM                 5      6  0
     D  FRTDTD                 7      8  0
     D                 DS
     D  XDTDD                  1      2  0
     D  XDTMM                  3      4  0
     D  XDTÅÅ                  5      6  0
     D  WSDT                   1      6  0
     D                 DS
     D  XDTÅÅ2                 1      4  0
     D  XDTMM2                 5      6  0
     D  XDTDD2                 7      8  0
     D  XDT                    1      8  0
     D                 DS
     D  XDTSD                  1      2  0
     D  XDTSM                  3      4  0
     D  XDTSÅ                  5      6  0
     D  WSDTS                  1      6  0
N12  D                 DS
N12  D  XDTAD                  1      2  0
N12  D  XDTAM                  3      4  0
N12  D  XDTAA                  5      6  0
N12  D  WSDTA                  1      6  0
     D                 DS
     D  XDTSÅ2                 1      4  0
     D  XDTSM2                 5      6  0
     D  XDTSD2                 7      8  0
     D  XDTS                   1      8  0
N12  D                 DS
N12  D  XDTAA2                 1      4  0
N12  D  XDTAM2                 5      6  0
N12  D  XDTAD2                 7      8  0
N12  D  XDTA                   1      8  0
     D                 DS
     D  XDTKD                  1      2  0
     D  XDTKM                  3      4  0
     D  XDTKÅ                  5      6  0
     D  WSDTK                  1      6  0
     D                 DS
     D  XDTKÅ2                 1      4  0
     D  XDTKM2                 5      6  0
     D  XDTKD2                 7      8  0
     D  XDTK                   1      8  0
     D                 DS
     D  XDTTD                  1      2  0
     D  XDTTM                  3      4  0
     D  XDTTÅ                  5      6  0
     D  WSDTT                  1      6  0
     D                 DS
     D  XDTTÅ2                 1      4  0
     D  XDTTM2                 5      6  0
     D  XDTTD2                 7      8  0
     D  XDTT                   1      8  0
     D                 DS
     D  THDTÅ                  1      4  0
     D  THDTM                  5      6  0
     D  THDTD                  7      8  0
     D  THDT                   1      8  0
N12  D                 DS
N12  D  THDDTA                 1      4  0
N12  D  THDDTM                 5      6  0
N12  D  THDDTD                 7      8  0
N12  D  THDDT                  1      8  0
     D                 DS
     D  WSDTD2                 1      2  0
     D  WSDTM2                 3      4  0
     D  WSDTÅ2                 5      6  0
     D  WSDT2                  1      6  0
N16  D                 DS
N16  D  WSDTD2F                1      2  0
N16  D  WSDTM2F                3      4  0
N16  D  WSDTÅ2F                5      6  0
N16  D  WSDT2F                 1      6  0
S03  D*                DS
S03  D* THNAK                  1     30
S03  D* WSNAK                  1     10
N03  D                 DS
N03  D  FSSOK                  1     35
N03  D  FSSOK17                1     17
     D                 DS
S10  D* THVKB                  1      9  0
S10  D* THVKB7                 3      9  0
N10  D  THVKB                  1     11  3
N10  D  THVKB7                 2      8  0
     D                 DS
     D  XNODI                  1      8
     D  XMMDD                  9     12
     D  XLØPNR                13     18
     D  XMLRN                  1     18
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18  0
     D  USG                   19     21
     D                SDS
     D  UUSER                254    263
N14  D UC              C                   CONST('ABCDEFGHIJKLMNOPQRST-
N14  D                                     UVWXYZÆØÅ')
N14  D LC              C                   CONST('abcdefghijklmnopqrst-
N14  D                                     uvwxyzæøå')
N14  D  VARI           S             30A   VARYING
N17  D editw           C                    '  .   .   . 0 '
N19  d wzrecno         s              4P 0
N19  d hex25           s              1    inz(x'25')
N19  d wfilnam         s            256
N19  d wfilnam2        s            512
N19  D Edidta          ds           256    DTAARA('EDIDTA')
N19  D  Uelibf               171    180
      *
     C                   EXSR      INIT
     C                   GOTO      START
      *
     C     START0        TAG
     C                   EXFMT     BILDE01
     C                   MOVEA     '0000'        *IN(96)
     C                   SETOFF                                       30
      *
     C   03              GOTO      SLUTT
     C   04              DO
     C                   EXSR      SØKKUN
     C                   GOTO      START0
     C                   END
      *
     C                   EXSR      TESTB1
     C   30              GOTO      START0
      *
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   MOVE      *ZEROS        XNAVD             4 0
     C                   MOVE      *ZEROS        XNTDN             7 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   EXSR      SETKEY
     C     START1        TAG
     C     WSAAVD        IFEQ      0
N12  C     *IN48         OREQ      *ON
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
      *
     C     START2        TAG
      *
     C  N94              DO
S03  C*                  DO        16
N03  C                   DO        19
     C                   ADD       1             ZRECNO
S03  C*  40              EVAL      WSNAK = FSSOK
     C                   EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   MOVE      ZRECNO        XRECN2            5 0
     C     WSAAVD        IFEQ      0
N12  C     *IN48         OREQ      *ON
     C                   EXSR      LESRAL
     C                   ELSE
     C                   EXSR      LESREC
     C                   END
     C  N94              END
     C                   END
      *
     C                   MOVE      ZRECNO        XRECNO            5 0
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C  N27              DO
     C                   MOVE      '1'           *IN27
     C                   GOTO      START0
     C                   END
     C                   EXFMT     NYVARE
     C                   ELSE
     C                   WRITE     BUNN
     C                   EXFMT     SUBCTL
     C                   END
      *
      *** AVSLUTT
     C                   MOVE      '0'           *IN30
     C                   MOVEA     '00'          *IN(98)
     C   03              GOTO      SLUTT
     C   05              GOTO      START
     C     START4        TAG
     C   06              DO
     C                   EXSR      CRTTRH
     C                   GOTO      START3
     C                   END
N19  C   09              DO
N19  C                   EXSR      LISTUT
N19  C                   GOTO      START3
N19  C                   ENDDO
N02  C   08
N02  COR 12              EXSR      SETCUR
     C   08              GOTO      START0
     C   12              GOTO      START0
     C   15              DO
     C                   CALL      'TR014C'
     C                   GOTO      START3
     C                   END
     C   16              DO
     C                   EXSR      CRTTR2
     C                   GOTO      START
     C                   END
     C   24              DO
     C                   EXSR      CMDFT2
     C                   GOTO      START3
     C                   END
      *
     C   23              DO
     C     *IN(70)       IFEQ      '0'
     C                   MOVEA     '1'           *IN(70)
     C                   ELSE
     C                   MOVEA     '0'           *IN(70)
     C                   END
     C                   GOTO      START3
     C                   ENDDO
      *
      *** BLA VIDERE
     C   25              DO
     C                   Z-ADD     XRECNO        ZRECNO
     C     TRHKN         CHAIN     TRUH                               33
     C   33              DO
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTÅ         WSDTÅ2
     C                   END
     C                   SETOFF                                       25
     C                   GOTO      START2
     C                   END
      *
     C     W2NR          IFNE      0                                            1<-B
     C     W2TDN         ORNE      0
     C     W2SG          ORNE      *BLANKS
     C     W2DTT         ORNE      0
     C     W2TRNR        ORNE      *BLANKS
     C     W2ST          ORNE      *BLANKS
N03  C     W2SOK         ORNE      *BLANKS
N14  C     W2NAK         ORNE      *BLANKS
     C     W2NR          IFEQ      0                                             2<-B
     C                   EXSR      NYSØK
     C                   GOTO      START
     C                   ELSE                                                    2
     C     W2NR          COMP      1                                      06
     C     W2NR          COMP      11                                     16
     C   06
     COR 16              DO                                                       3<-B
     C     W2AVD         IFNE      0                                               4<-B
     C                   MOVE      W2AVD         WSAAVD
     C                   END                                                       4<-B
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   GOTO      START4
     C                   END                                                      3<-E
     C     W2TDN         IFEQ      0                                              3<-B
     C                   SETON                                        9830
     C                   MOVE      'YBC0046'     MSGNR
     C                   ELSE                                                     3
     C                   EXSR      NYTDN
     C                   END                                                      3<-E
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
N03  C                   MOVE      *BLANKS       W2SOK
     C                   GOTO      START3
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C                   GOTO      START3
      *
     C     SLUTT         TAG
     C     WSAAVD        IFNE      0
     C                   MOVE      WSAAVD        UAVD
     C                   END
     C     WSSG          IFNE      *BLANKS
     C                   MOVE      WSSG          USG
     C                   END
      *
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     HMLRN         BEGSR
     C***********************************************
     C     THTRNR        IFEQ      *BLANKS
     C                   MOVE      '0'           *IN55
     C                   MOVE      'N'           XMRN
     C     EDIM2K        SETLL     EDIM2
     C     STHML         TAG
     C     EDIM2A        READPE    EDIM2                                  33
     C     *IN33         IFEQ      '0'
     C     M1001         CABNE     'TET'         STHML
     C                   IF        M1225 = '999'
     C                   EVAL      WSMLRN = M0068
     C                   ELSE
     C                   MOVEL     M0068         XNODI
     C                   MOVE      M0068A        XMMDD
     C                   MOVE      M0068B        XLØPNR
     C                   MOVE      XMLRN         WSMLRN
     C                   END
     C                   ELSE
     C                   MOVE      *BLANKS       WSMLRN
     C                   END
     C                   ELSE
     C                   MOVE      '1'           *IN55
     C                   MOVE      'J'           XMRN
     C                   MOVE      THTRNR        WSMLRN
     C                   END
     C     THLSTL        IFGT      0
     C                   MOVE      'J'           WSPLL
     C                   ELSE
     C                   MOVE      'N'           WSPLL
     C                   END
N03   *
N03  C                   IF        *IN40 = *OFF
N03  C     FRISOKK       CHAIN     FRISOK                             33
N03  C   33              EVAL      FSSOK = *BLANKS
N03  C                   END
N17  C                   IF        *IN48 = *ON
N17  C                   EVAL      FSSOK17 = *BLANKS
N17  C*                  EVAL      FSSOK17=%editw(THGBL:editw)
N17  C                   EVAL      FSSOK17= THGVK + %editw(THGBL:editw)
N17  C                   ENDIF
      *
     C                   ENDSR
      *
     C***********************************************
     C     SJEKKMRK      BEGSR
     C***********************************************
      *
      * SJEKK MERKING
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C  N33              MOVE      '1'           *IN29
     C   33              MOVE      '0'           *IN29
N08   * SJEKK MERKING
N08  C     TRHKOP        CHAIN(N)  FREETXT2                           33
N08  C  N33              MOVE      '1'           *IN36
N08  C   33              MOVE      '0'           *IN36
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYSØK         BEGSR
     C***********************************************
     C                   CLEAR                   BILDE01
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          WSAAVD
     C                   ELSE
     C                   MOVE      W2AVD         WSAAVD
     C                   END
     C     W2TDN         IFNE      0                                            1<-B
     C                   MOVE      W2TDN         WSTDN
     C                   ELSE                                                   1
     C     W2SG          IFNE      *BLANKS                                       2<-B
     C                   MOVE      W2SG          WSSG
     C                   MOVE      W2DTT         WSDTT
     C                   MOVE      W2ST          WSST
     C                   ELSE                                                    2
     C     W2DTT         IFNE      0                                              3<-B
     C                   MOVE      W2DTT         WSDT
N14  C                   EVAL      WSNAK = W2NAK
     C                   ELSE                                                     3
     C     W2TRNR        IFNE      *BLANKS                                         4<-B
     C                   MOVE      W2TRNR        WSTRNR
     C                   ELSE                                                      4
N03  C     W2SOK         IFNE      *BLANKS                                          5<-B
N03  C                   EVAL      WSSOK = W2SOK
N03  C                   ELSE                                                       5
N14  C     W2NAK         IFNE      *BLANKS                                           6<-B
N14  C                   EVAL      WSNAK = W2NAK
N14  C                   ELSE                                                        6
     C                   MOVE      W2ST          WSST
N14  C                   END                                                         6<-E
N03  C                   END                                                        5<-E
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      *ZEROS        W2NR
     C                   MOVE      *ZEROS        W2AVD
     C                   MOVE      *ZEROS        W2TDN
     C                   MOVE      *BLANKS       W2SG
     C                   MOVE      *ZEROS        W2DTT
     C                   MOVE      *BLANKS       W2TRNR
     C                   MOVE      *BLANKS       W2ST
N03  C                   MOVE      *BLANKS       W2SOK
N14  C                   MOVE      *BLANKS       W2NAK
      *
     C                   MOVEA     '0000'        *IN(96)
     C                   EXSR      TESTB1
      *
     C                   ENDSR
      *
     C***********************************************
     C     NYTDN         BEGSR
     C***********************************************
     C     W2AVD         IFEQ      0
     C                   MOVE      UAVD          W2AVD
     C                   END
     C     WRK2K         CHAIN(N)  TRUHOPD                            98
     C   98              DO
     C                   MOVE      'YBC0047'     MSGNR
     C                   GOTO      SLTDN
     C                   END
     C                   MOVE      '1'           *IN90
      *
     C                   SELECT
     C     W2NR          WHENEQ    2
     C                   EXSR      CHGTRH
     C     W2NR          WHENEQ    3
     C                   EXSR      CPYTRH
     C     W2NR          WHENEQ    5
     C                   EXSR      DSPTRH
     C     W2NR          WHENEQ    6
     C                   EXSR      PRTTRH
     C     W2NR          WHENEQ    8
     C                   EXSR      DSPWEB
     C     W2NR          WHENEQ    9
     C                   EXSR      DSPTVI
     C     W2NR          WHENEQ    12
     C                   EXSR      faxmail
     C     W2NR          WHENEQ    14
     C                   EXSR      CSLTRH
     C     W2NR          WHENEQ    51
     C                   EXSR      arkivs
     C                   ENDSL
      *
     C     SLTDN         TAG
     C   98              MOVE      '1'           *IN30
     C                   MOVE      '0'           *IN90
     C                   MOVE      *ZEROS        W2NR
     C  N98              MOVE      *ZEROS        W2AVD
     C  N98              MOVE      *ZEROS        W2TDN
      *
     C                   ENDSR
      *
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       MSGNR
     C                   MOVEA     '000'         *IN(90)
     C                   MOVEA     '00'          *IN(98)
     C     *IN98         DOWEQ     '0'                                          1<-B
     C                   READC     SUBFIL                                 98
     C     *IN98         IFEQ      '0'                                           2<-B
     C                   SELECT
     C     WSNR          WHENEQ    2
     C                   MOVE      '1'           *IN99
     C                   EXSR      CHGTRH
     C     WSNR          WHENEQ    3
     C                   MOVE      '1'           *IN99
     C                   EXSR      CPYTRH
     C     WSNR          WHENEQ    5
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTRH
     C     WSNR          WHENEQ    6
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTTRH
     C     WSNR          WHENEQ    8
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPWEB
     C     WSNR          WHENEQ    9
     C                   MOVE      '1'           *IN99
     C                   EXSR      DSPTVI
N08  C     WSNR          WHENEQ    18
N08  C                   EXSR      WRKFT
     C     WSNR          WHENEQ    10
     C                   EXSR      FRIGIG
     C     WSNR          WHENEQ    14
     C                   MOVE      '1'           *IN99
     C                   EXSR      CSLTRH
     C     WSNR          WHENEQ    16
     C                   MOVE      '1'           *IN99
     C                   EXSR      PRTTRH2
N15  C     WSNR          WHENEQ    35
N15  C                   MOVE      '1'           *IN99
N15  C                   EXSR      OPDARKIV
     C     WSNR          WHENEQ    51
     C                   MOVE      '1'           *IN99
     C                   EXSR      arkivs
     C     WSNR          WHENEQ    12
     C                   MOVE      '1'           *IN99
     C                   EXSR      faxmail
     C     WSNR          WHENEQ    99
     C                   MOVE      '1'           *IN99
     C                   EXSR      MRKST
     C                   ENDSL
     C                   END                                                     2<-E
     C                   END                                                    1<-E
      *
     C     SLHENT        TAG
     C   98
     CANN99              DO
     C                   MOVE      'DIV0012'     MSGNR
     C                   MOVE      '1'           *IN30
     C                   END
     C                   MOVE      '0'           *IN99
      *
     C                   ENDSR
      *
     C***********************************************
     C     SØKKUN        BEGSR
     C***********************************************
S02  C*                  CALL      'SOEKUN'
S02  C*                  PARM                    FIFIRM
S02  C*                  PARM                    SOANTK
S02  C*                  PARM                    SOTXT1
S02  C*                  PARM                    WSKNS
S02  C*                  PARM                    SOTXT2
S02  C*                  PARM                    WSKNK
S02  C*                  PARM                    SOTXT3
S02  C*                  PARM                    SOKNR3
S02  C*                  PARM                    SOTXT4
S02  C*                  PARM                    SOKNR4
S02  C*                  PARM                    SOTXT5
S02  C*                  PARM                    SOKNR5
S02  C*                  PARM                    SOTXT6
S02  C*                  PARM                    SOKNR6
S02  C*                  PARM                    SOTXT7
S02  C*                  PARM                    SOKNR7
S02  C*                  PARM                    SOTXT8
S02  C*                  PARM                    SOKNR8
N02   *
N02  C     WSCLOC        DIV       256           LINNBR
N02  C                   MVR                     POSNBR
N02   *
N02  C     LINNBR        IFEQ      12
N02  C     POSNBR        ANDGE     35
N02  C     POSNBR        ANDLE     42
N02  C                   MOVE      *BLANKS       UKNAVN           30
N02  C                   CALL      'SOEKKUN'
N02  C                   PARM                    WSKNK
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    UKNAVN
N02  C                   Z-ADD     55            POSNBR
N02  C                   END
N02   *
N02  C     LINNBR        IFEQ      11
N02  C     POSNBR        ANDGE     35
N02  C     POSNBR        ANDLE     42
N02  C                   MOVE      *BLANKS       UKNAVN           30
N02  C                   CALL      'SOEKKUN'
N02  C                   PARM                    WSKNS
N02  C                   PARM                    FIFIRM
N02  C                   PARM                    UKNAVN
N02  C                   Z-ADD     55            POSNBR
N02  C                   END
      *
     C                   ENDSR
      *
N02   ***********************************************
N02  C     SETCUR        BEGSR
N02   ***********************************************
N02  C                   Z-ADD     35            POSNBR
N02  C                   SELECT
N02  C                   WHEN      WSSOK  <> *BLANKS
N02  C                   Z-ADD     8             LINNBR
N02  C                   WHEN      WSDT   <> 0
N02  C                   Z-ADD     9             LINNBR
N02  C                   WHEN      WSTDN  <> 0
N02  C                   Z-ADD     10            LINNBR
N02  C                   WHEN      WSKNS  <> 0
N02  C                   Z-ADD     11            LINNBR
N02  C                   WHEN      WSKNK  <> 0
N02  C                   Z-ADD     12            LINNBR
N02  C                   WHEN      WSSG   <> *BLANKS
N02  C                   Z-ADD     13            LINNBR
N02  C                   WHEN      WSTRNR <> *BLANKS
N02  C                   Z-ADD     14            LINNBR
N02  C                   WHEN      WSST   <> *BLANKS
S12  C*                  Z-ADD     15            LINNBR
N12  C                   Z-ADD     16            LINNBR
N12  C                   WHEN      WSAKT  <> *BLANKS
N12  C                   Z-ADD     18            LINNBR
N14  C                   WHEN      WSNAK  <> *BLANKS
N14  C                   Z-ADD     15            LINNBR
N02  C                   OTHER
N02  C                   Z-ADD     8             LINNBR
N02  C                   ENDSL
N02   *
N02  C                   ENDSR
N02   *
     C***********************************************
     C     DSPTRH        BEGSR
     C***********************************************
     C                   MOVE      'DSP'         XTYPE             3
     C                   CALL      'TR011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    THSG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        IFEQ      3
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CHGTRH        BEGSR
     C***********************************************
     C                   MOVE      'CHG'         XTYPE             3
     C                   CALL      'TR011C'
     C                   PARM      THAVD         XAVD
     C                   PARM      THTDN         XTDN
     C                   PARM                    UPRO
     C                   PARM                    THSG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     TRHKOP        CHAIN(N)  TRUHOPD                            33
      * HVIS HELE.GN ER UTFYLT, VIS SISTE DEL, ELLERS  1. DEL.
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CPYTRH        BEGSR
     C***********************************************
     C                   MOVE      'CPY'         XTYPE             3
     C     *LIKE         DEFINE    THAVD         XAVD
     C     *LIKE         DEFINE    THTDN         XTDN
     C                   MOVE      THAVD         XAVD
     C                   MOVE      THTDN         XTDN
     C                   CALL      'TR011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              UPDATE    SUBFIL
     C     XTDN          IFNE      0
     C     XAVD          IFNE      THAVD
     C     XTDN          ORNE      THTDN
     C     TRHKKP        CHAIN(N)  TRUHOPD                            33
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTÅ         WSDTÅ2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      HMLRN
     C  N90              EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTTRH        BEGSR
     C***********************************************
     C                   MOVE      'CRT'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'TR011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     XAVD          IFNE      0
     C     XTDN          ANDNE     0
     C     TRHKKP        CHAIN(N)  TRUHOPD                            33
     C  N33              DO
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTÅ         WSDTÅ2
     C                   ADD       1             XRECN2
     C                   MOVE      XRECN2        ZRECNO
     C                   EXSR      HMLRN
     C                   EXSR      SJEKKMRK
     C                   WRITE     SUBFIL
     C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     CRTTR2        BEGSR
     C***********************************************
     C                   MOVE      'CR2'         XTYPE             3
     C     WSAAVD        IFEQ      0
     C                   MOVE      UAVD          XAVD
     C                   ELSE
     C                   MOVE      WSAAVD        XAVD
     C                   END
     C                   MOVE      *ZEROS        XTDN
     C                   CALL      'TR011C'
     C                   PARM                    XAVD
     C                   PARM                    XTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
      *
     C     WSAAVD        IFEQ      0
     C                   MOVE      XAVD          UAVD
     C                   ELSE
     C                   MOVE      XAVD          WSAAVD
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTTRH        BEGSR
     C***********************************************
     C     THST          IFEQ      ' '
     C     THST          OREQ      'P'
     C     THST          OREQ      'Z'
     C     THTRNR        IFNE      *BLANKS
     C                   EXSR      TSTIE29
     C     XIE29         CABEQ     'N'           SLPRTTRH
     C                   MOVE      'PRT'         XTYPE             3
     C                   CALL      'TR011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
     C     TRHKOP        CHAIN(N)  TRUHOPD                            33
     C                   CALL      'TR014C'
     C                   END
     C                   END
     C     SLPRTTRH      TAG
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     PRTTRH2       BEGSR
     C***********************************************
     C                   IF        (((THST = ' ') OR
     C                               (THST = 'C')) OR
     C                               (THST = 'N'))
     C                   MOVEL     THTRNR        XAN08             8
     C                   IF        (((XAN08 = *BLANKS) OR
     C                               (XAN08 = 'NØDPROS.')) OR
     C                               (XAN08 = 'NØDPROSE'))
     C                   CALL      'TR027R'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   IF        *IN90 = *OFF
     C                   MOVE      *ZEROS        WSNR
     C     TRHKOP        CHAIN(N)  TRUHOPD                            33
     C  N33              MOVE      THTRNR        WSMLRN
     C                   END
     C                   END
     C                   END
      *
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TSTIE29       BEGSR
     C***********************************************
     C                   MOVE      'N'           XIE29             1
     C     EDIM4K1       SETLL     EDIM4
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   DOW       *IN33 = *OFF
     C                   IF        ((MST <> 'D') AND (M1001 = 'TET'))
     C                   IF        (((M1N07 = '029') OR
     C                               (M1N07 = '045')) OR
     C                               (M1N07 = 'CTL'))
     C                   MOVE      'J'           XIE29
     C                   END
     C                   LEAVE
     C                   END
     C     EDIM4K2       READPE    EDIM4                                  33
     C                   ENDDO
      *
     C                   ENDSR
      *
     C***********************************************
     C     DSPWEB        BEGSR
     C***********************************************
     C                   EVAL      Overskr = 'Søk på MRNnr (eksport) på WEB '
     C                   EVAL      WebType = 'MRNNR'
     C                   EVAL      WebSok  = THTRNR
     C                   CALL      'WEBLINKR'
     C                   PARM                    Overskr          40
     C                   PARM                    WebType           5
     C                   PARM                    WebSok           50
      *
     C  N90              MOVE      *ZEROS        WSNR
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
     C***********************************************
     C     DSPTVI        BEGSR
     C***********************************************
     C                   MOVE      '2'           WIN03             1
     C                   CALL      'SAD003'
     C                   PARM      THAVD         THAVD
     C                   PARM      THTDN         THTDN
     C                   PARM                    WIN03
     C     WIN03         IFEQ      '1'
     C                   MOVE      '1'           *INLR
     C                   RETURN
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
N08   ***********************************************
N08  C     WRKFT         BEGSR
N08   ***********************************************
N08  C                   Z-ADD     0             UFLAGG
N08  C                   CALL      'SYFA31CL'
N08  C                   PARM      THAVD         UAVD2
N08  C                   PARM      THTDN         UOPD2
N08  C                   PARM                    UFLAGG
N08   *
N08  C  N90              MOVE      *ZEROS        WSNR
N08  C  N90XMRN          COMP      'J'                                    55
N08  C  N90              EXSR      SJEKKMRK
N08  C  N90              UPDATE    SUBFIL
N08   *
N08  C                   ENDSR
N08   *
     C***********************************************
     C     FRIGIG        BEGSR
     C***********************************************
     C                   IF        ((((THST = 'P') AND                          IE29 ELLER IE45
     C                                (THGBL > 0)) AND
     C                               ((THGKD <= 1) OR (THGKD = 9))) OR
     C                               ((THST = 'M') AND (THGBL > 0)))            CONTRL-MELDING
     C                   EXSR      TSTIE29
     C     XIE29         CABEQ     'N'           SLFRIGIG
      *
     C     STFRIGIG      TAG
     C                   EXFMT     BILDE03
     C   12              GOTO      SLFRIGIG
     C  N10              GOTO      STFRIGIG
     C     TRHKOP        CHAIN     TRUHOPD                            33
     C                   Z-SUB     THGBL         THGBL
     C                   IF        M1N07 <> 'CTL'
     C                   MOVE      'Z'           THST
     C                   END
     C                   UPDATE    TRUHROPD
     C     THGFT1        CHAIN     TRUGH                              33
     C  N33              ADD       THGBL         TGGBLB
     C  N33              UPDATE    TRUGHR
     C                   CLEAR                   EDIMR
     C                   EVAL      M0004 = UUSER
     C                   EVAL      M0010 = UUSER
     C                   EVAL      M0062 = 'FRIGI GARANTI'
     C                   EVAL      M0065 = 'TEFRIG'
     C                   EVAL      M0068 = WSFT
     C                   EVAL      M1001 = 'TET'
     C                   EVAL      M1225 = '999'
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   OPEN      EDIM
     C                   EVAL      MMN   = CMN
     C                   EVAL      MSR   = 'S'
     C                   EVAL      MST   = 'C'
     C                   EVAL      MAVD  = THAVD
     C                   EVAL      MTDN  = THTDN
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   MOVE      WDT           M0068A
     C                   WRITE     EDIMR
     C                   CLOSE     EDIM
     C                   OPEN      TVINF
     C                   EVAL      FMN   = CMN
     C                   EVAL      FLN   = 1
     C                   MOVE      'PP'          F0077
     C                   EVAL      F0078A = 'BRUKER:'
     C                   CAT       UUSER:1       F0078A
     C                   EVAL      F0078B = 'DATO  :'
     C                   CAT       WDT:1         F0078B
     C                   EVAL      F0078C = 'TID   :'
     C                   CAT       WTM:1         F0078C
     C                   EVAL      F0078D = 'KOMM. :'
     C                   CAT       WSFT          F0078D
     C                   WRITE     TVINFF
     C                   CLOSE     TVINF
     C                   END
      *
     C     SLFRIGIG      TAG
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CSLTRH        BEGSR
     C***********************************************
     C     THTRNR        IFNE      *BLANKS
N09  C                   IF        THST = 'P' OR THST = 'U'
     C                   MOVE      'CSL'         XTYPE             3
     C                   CALL      'TR011C'
     C                   PARM                    THAVD
     C                   PARM                    THTDN
     C                   PARM                    UPRO
     C                   PARM                    USG
     C                   PARM                    XTYPE
N06  C                   PARM                    UIE
     C                   PARM                    UFLAGG            1 0
N09  C                   END
     C                   END
     C  N90              MOVE      *ZEROS        WSNR
     C  N90XMRN          COMP      'J'                                    55
     C  N90              EXSR      SJEKKMRK
     C  N90              UPDATE    SUBFIL
      *
     C                   ENDSR
      *
      ***********************************************
     C     MRKST         BEGSR
      ***********************************************
     C                   MOVE      *BLANKS       FT
     C                   MOVE      *ZEROS        XN                3 0
     C                   MOVE      *BLANKS       WAUSER
     C                   MOVE      *ZEROS        WADT
     C     THGBL         COMP      0                                    8989
     C                   MOVE      'N'           WAFGAR
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE(N)  FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C     WAUSER        IFEQ      *BLANKS
     C                   MOVE      FRTTXT        WAUSER
     C                   MOVE      FRTDTÅ        WADTÅ
     C                   MOVE      FRTDTM        WADTM
     C                   MOVE      FRTDTD        WADTD
     C                   END
     C                   ADD       1             XN
     C                   MOVEL     FRTTXT        FT(XN)
     C     FRT2K         READE     FREETXT2                               33
     C  N33              ENDDO
     C                   MOVE      THST          WAST
     C                   MOVE      FT2501        FT2502          250
      *
     C     STMRK         TAG
     C                   EXFMT     BILDE02
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
     C   12              GOTO      SLMRK
      *
     C     WAFT1         IFEQ      *BLANKS
     C                   MOVE      '1'           *IN90
     C                   MOVE      '1'           *IN30
     C                   MOVE      'YBC1864'     MSGNR
     C                   GOTO      STMRK
     C                   END
      *
     C     FT2501        IFNE      FT2502
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C     FRT2K         SETLL     FREETXT2
     C     FRT2K         READE     FREETXT2                               33
     C     *IN33         DOWEQ     '0'
     C                   DELETE    FREETXTR
     C     FRT2K         READE     FREETXT2                               33
     C  N33              ENDDO
      *
     C                   MOVE      THAVD         FRTAVD
     C                   MOVE      THTDN         FRTOPD
     C                   MOVE      WDT           FRTDT
     C     1             DO        5             XN
     C     FT(XN)        IFNE      *BLANKS
     C                   Z-ADD     XN            FRTLI
     C                   MOVEL     FT(XN)        FRTTXT
     C                   MOVE      UUSER         FRTTXT
     C                   WRITE     FREETXTR
     C                   END
     C                   ENDDO
     C                   END
      *
     C     THST          IFNE      WAST
     C     WAFGAR        OREQ      'J'
     C     TRHKOP        CHAIN     TRUHOPD                            33
     C                   MOVE      WAST          THST
      *
     C                   IF        THGBL > 0
     C                   Z-SUB     THGBL         THGBL
     C     THGFT1        CHAIN     TRUGH                              33
     C                   ADD       THGBL         TGGBLB
S12  C*                  UPDATE    TRUGHR
S13  C*  33              UPDATE    TRUGHR
N13  C  N33              UPDATE    TRUGHR
     C                   CLEAR                   EDIMR
     C                   EVAL      M0004 = UUSER
     C                   EVAL      M0010 = UUSER
     C                   EVAL      M0062 = 'FRIGI GARANTI'
     C                   EVAL      M0065 = 'TEFRIG'
     C                   EVAL      M0068 = WSFT
     C                   EVAL      M1001 = 'TET'
     C                   EVAL      M1225 = '999'
     C     1             CHAIN     EDIC                               33
     C                   ADD       1             CMN
     C                   UPDATE    EDICR
     C                   OPEN      EDIM
     C                   EVAL      MMN   = CMN
     C                   EVAL      MSR   = 'S'
     C                   EVAL      MST   = 'C'
     C                   EVAL      MAVD  = THAVD
     C                   EVAL      MTDN  = THTDN
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           MDT
     C                   MOVE      WTM           MTM
     C                   MOVE      WDT           M0068A
     C                   WRITE     EDIMR
     C                   CLOSE     EDIM
     C                   OPEN      TVINF
     C                   EVAL      FMN   = CMN
     C                   EVAL      FLN   = 1
     C                   MOVE      'PP'          F0077
     C                   EVAL      F0078A = 'BRUKER:'
     C                   CAT       UUSER:1       F0078A
     C                   EVAL      F0078B = 'DATO  :'
     C                   CAT       WDT:1         F0078B
     C                   EVAL      F0078C = 'TID   :'
     C                   CAT       WTM:1         F0078C
     C                   EVAL      F0078D = 'KOMM. :'
     C                   CAT       WSFT          F0078D
     C                   WRITE     TVINFF
     C                   CLOSE     TVINF
     C                   END
      *
     C                   UPDATE    TRUHROPD
     C     STMRK2        TAG
     C                   MOVE      WDT           SSDT
     C                   MOVE      WTM           SSTM
     C     STSK          CHAIN     STS                                33
     C     *IN33         IFEQ      '0'
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   GOTO      STMRK2
     C                   END
     C                   MOVE      THAVD         SSAVD
     C                   MOVE      THTDN         SSOPD
     C                   MOVE      UUSER         SSUSR
     C                   MOVE      THSG          SSSG
     C                   MOVE      'R'           SSRTYP
     C                   MOVE      THST          SSSTG
     C                   MOVE      WAST          SSSTN
     C                   WRITE     STSR
     C                   END
      *
     C     SLMRK         TAG
     C                   MOVE      *BLANKS       WSNR
     C                   EXSR      SJEKKMRK
     C                   UPDATE    SUBFIL
      *
     C                   ENDSR
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       KOANVN
     C     WSAAVD        IFNE      0
     C     WSTDN         ORNE      0
     C     WSAAVD        CHAIN     TRUSTD                             99
     C  N99KODTAK        CHAIN     KODTA                              99
     C   99              MOVE      'SPA0001'     MSGNR
     C   99              SETON                                        30
     C   99              GOTO      SLTB1
     C                   MOVE      WSAAVD        UAVD
     C                   END
      *
S01  C*                  MOVEA     '00000000'    *IN(42)
N01  C                   MOVEA     '000000000'   *IN(41)
      *
N01  C     WSSOK         comp      *BLANKS                            4040
N04  C   40              EVAL      WSSOKMAX = %TRIM(WSSOK)
N04  C                             + '9999999999999999999999999999999999'
N01  C   40              GOTO      STTB1
     C     WSDT          COMP      *ZEROS                             4141
N14  C  N41WSNAK         COMP      *BLANKS                            4141
     C   41              GOTO      STTB1
     C     WSTDN         COMP      *ZEROS                             4242
     C   42              GOTO      STTB1
     C     WSKNS         COMP      *ZEROS                             4343
     C   43              GOTO      STTB1
     C     WSKNK         COMP      *ZEROS                             4444
     C   44              GOTO      STTB1
     C     WSSG          COMP      *BLANKS                            4545
     C   45              GOTO      STTB1
     C     WSTRNR        COMP      *BLANKS                            4646
     C   46              GOTO      STTB1
     C     WSST          COMP      *BLANKS                            4949
     C   49              GOTO      STTB1
N12  C     WSAKT         COMP      *BLANKS                            4848
N12  C   48              GOTO      STTB1
      *
     C                   MOVE      'DIV0064'     MSGNR
     C                   SETON                                        3098
N12  C                   EVAL      LINNBR = 9
     C                   GOTO      SLTB1
      *
     C     STTB1         TAG
     C   43              MOVE      WSKNS         KUNDNR
     C   43KUNDK         CHAIN     CUNDL01                            97
     C   97              MOVE      'SPK0035'     MSGNR
     C   44              MOVE      WSKNK         KUNDNR
     C   44KUNDK         CHAIN     CUNDL01                            96
     C   96
     CANN97              MOVE      'SPK0035'     MSGNR
     C   97
     COR 96              SETON                                        30
      *
     C     SLTB1         ENDSR
      *
     C***********************************************
     C     SETKEY        BEGSR
     C***********************************************
N07   *
N07  C                   IF        XSTART = 'J'
N07  C     USG           SETLL     TRUH11
N07  C                   CALL      'SYGE15C'
N07  C                   PARM                    WDT               8
N07  C                   PARM                    WTM               6
N07  C                   MOVE      WDT           XIGAAR            8 0
N07  C     XIGAAR        CHAIN     KALENDER                           33
N07  C                   READP     KALENDER                               33
N07  C                   MOVE      KADATE        XIGAAR
N07  C                   GOTO      SLSETKEY
N07  C                   END
N07   *
     C   41              DO
     C     WSDT          IFEQ      0
     C                   MOVE      *ZEROS        XDT
     C                   ELSE
     C                   MOVE      XDTDD         XDTDD2
     C                   MOVE      XDTMM         XDTMM2
     C     XDTÅÅ         ADD       2000          XDTÅÅ2
     C                   END
     C                   END
     C   44              DO
     C                   SELECT
     C     WSDTK         WHENEQ    0
     C                   MOVE      *ZEROS        XDTK
     C                   OTHER
     C                   MOVE      XDTKD         XDTKD2
     C                   MOVE      XDTKM         XDTKM2
     C     XDTKÅ         ADD       2000          XDTKÅ2
     C                   ENDSL
     C                   END
     C   43              DO
     C     WSDTS         IFEQ      0
     C                   MOVE      *ZEROS        XDTS
     C                   ELSE
     C                   MOVE      XDTSD         XDTSD2
     C                   MOVE      XDTSM         XDTSM2
     C     XDTSÅ         ADD       2000          XDTSÅ2
     C                   END
     C                   END
     C   45              DO
     C     WSDTT         IFEQ      0
     C                   MOVE      *ZEROS        XDTT
     C                   ELSE
     C     WSDTT         IFEQ      999999
     C                   MOVE      99999999      XDTT
     C                   ELSE
     C                   MOVE      XDTTD         XDTTD2
     C                   MOVE      XDTTM         XDTTM2
     C     XDTTÅ         ADD       2000          XDTTÅ2
     C                   END
     C                   END
     C                   END
N12  C   48              DO
N12  C     WSDTA         IFEQ      0
N12  C                   MOVE      *ZEROS        XDTA
N12  C                   ELSE
N12  C     WSDTA         IFEQ      999999
N12  C                   MOVE      99999999      XDTA
N12  C                   ELSE
N12  C                   MOVE      XDTAD         XDTAD2
N12  C                   MOVE      XDTAM         XDTAM2
N12  C     XDTAA         ADD       2000          XDTAA2
N12  C                   END
N12  C                   END
N12  C                   END
      *
     C     WSAAVD        IFEQ      0
     C     *IN46         ANDEQ     '0'
N12  C     *IN48         OREQ      '1'
S05  C*                  Z-ADD     1             YAVD              4 0
     C                   EXSR      MINTRL
     C                   ELSE
     C                   EXSR      MINTRE
     C                   END
      *
N07  C     SLSETKEY      TAG
     C                   ENDSR
      *
     C***********************************************
     C     MINTRE        BEGSR
     C***********************************************
      * SET KEY NÅR SØK KUN I EN !!!!  AVDELING
N01  C   40FR1KEY        SETLL     FRISOL01
     C   41TRH1K         SETLL     TRUH01
     C   42TRHK          SETLL     TRUH
     C   43TRH3K         SETLL     TRUH03
     C   44TRH2K         SETLL     TRUH02
     C   45WSDTT         IFEQ      999999
     C     TRH4K         SETGT     TRUH04
     C                   ELSE
     C     TRH4K         SETLL     TRUH04
     C                   END
     C   46WSTRNR        SETLL     TRUH05
     C   49TRH8K         SETLL     TRUH08
      *
     C                   ENDSR
      *
     C***********************************************
     C     MINTRL        BEGSR
     C***********************************************
      * SET KEY NÅR SØK I ALLE !!  AVDELINGER
N01  C   40FR1KEY        SETLL     FRISOL01
     C   41TRH9K         SETLL     TRUH09
S05  C*  43TRHA3K        SETLL     TRUH03
S05  C*  44TRHA2K        SETLL     TRUH02
N05  C   43TRHA3K        SETLL     TRUH13
N05  C   44TRHA2K        SETLL     TRUH12
     C   45WSDTT         IFEQ      999999
S05  C*    TRHA4K        SETGT     TRUH04
N05  C     TRHA4K        SETGT     TRUH14
     C                   ELSE
S05  C*    TRHA4K        SETLL     TRUH04
N05  C     TRHA4K        SETLL     TRUH14
     C                   END
     C   49WSST          SETLL     TRUH07
S18  C*  48XDTA          SETLL     TRUH15
N18  C   48XDTA          SETLL     TRUH16
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESREC        BEGSR
     C***********************************************
N07   *
N11  C     STLESREC      TAG
N07  C                   IF        XSTART = 'J'
N07  C     USG           READE     TRUH11                                 94
N07  C  N94THDT          COMP      XIGAAR                             94
N07  C  N94              GOTO      SLLESREC
N07  C                   EVAL      *IN94 = *OFF
N07  C                   EVAL      XSTART = 'N'
N07  C                   EXSR      SETKEY
N07  C                   END
N07   *
      * LES REC NÅR SØK KUN I EN !!!!  AVDELING
     C     STLREC        TAG
N01  C   40              DOW       *IN94 = *OFF
N01  C     FR1KEYE       READE     FRISOL01                               94
N04  C  N94WSSOKMAX      COMP      FSSOK                                94
N01  C  N94TRUHKFRI      CHAIN     TRUH                               33
N01  C  N94
N01  CANN33              LEAVE
N01  C                   ENDDO
     C   41WSAAVD        READE     TRUH01                                 94
N14  C   41
N14  CANN94              IF        WSNAK <> *BLANKS
N14  C     LC:UC         XLATE     THNAK         X_THNAK          30
N14  C     ' '           CHECKR(E) WSNAK         NUM               2 0
N14  C                   EVAL      %len(VARI) = NUM
N14  C     NUM           SUBST     WSNAK:1       VARI
N14  C     VARI          SCAN      X_THNAK                                33
N14  C  N33              GOTO      STLREC
N14  C                   END
     C   42WSAAVD        READE     TRUH                                   94
     C   43WSAAVD        READE     TRUH03                                 94
     C   43
     CANN94WSKNS         COMP      THKNS                              9494
     C   44WSAAVD        READE     TRUH02                                 94
     C   44
     CANN94WSKNK         COMP      THKNK                              9494
     C   45WSDTT         IFEQ      999999
     C     WSAAVD        READPE    TRUH04                                 94
     C  N94WSSG          COMP      THSG                               9494
     C                   ELSE
     C     WSAAVD        READE     TRUH04                                 94
     C  N94WSSG          COMP      THSG                               9494
     C  N94              IF        WSST <> *BLANKS
     C     WSST          CABNE     THST          STLREC
     C                   END
     C                   END
     C   46              READ      TRUH05                                 94
     C   49TRH8K         READE     TRUH08                                 94
N07  C     SLLESREC      TAG
     C  N94              DO
N06  C                   IF        UIE = 'I'
S11  C*    THDK          CABNE     'SS'          STLREC
S11  C*    THBLK         CABNE     'NO'          STLREC
N11  C                   IF        THDK<>'SS' AND THDK<>'ENTRY' AND THDK<>'EXIT'
N11  C                   IF        XSTART = 'J'
N11  C                   GOTO      STLESREC
N11  C                   ELSE
N11  C                   GOTO      STLREC
N11  C                   END
N11  C                   END
N06  C                   END
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTÅ         WSDTÅ2
     C                   MOVE      THAVD         XNAVD
     C                   MOVE      THTDN         XNTDN
N16  C                   move      *zeros        wsdt2f
N16  C     thst          ifne      'D'
N16  C     thst          andne     'Z'
N16  C     thst          andne     'S'
N16  C                   MOVE      THDDTD        WSDTD2F
N16  C                   MOVE      THDDTM        WSDTM2F
N16  C                   MOVE      THDDTA        WSDTÅ2F
N16  C                   END
     C                   END
      *
     C                   ENDSR
      *
     C***********************************************
     C     LESRAL        BEGSR
     C***********************************************
      * LES REC NÅR SØK I ALLE !!  AVDELINGER
     C     STLRAL        TAG
N01  C   40              DOW       *IN94 = *OFF
N01  C     FR1KEYE       READE     FRISOL01                               94
N04  C  N94WSSOKMAX      COMP      FSSOK                                94
N01  C  N94TRUHKFRI      CHAIN     TRUH                               33
N01  C  N94
N01  CANN33              LEAVE
N01  C                   ENDDO
     C   41              READ      TRUH09                                 94
N14  C   41
N14  CANN94              IF        WSNAK <> *BLANKS
N14  C     LC:UC         XLATE     THNAK         X_THNAK          30
N14  C     ' '           CHECKR(E) WSNAK         NUM               2 0
N14  C                   EVAL      %len(VARI) = NUM
N14  C     NUM           SUBST     WSNAK:1       VARI
N14  C     VARI          SCAN      X_THNAK                                33
N14  C  N33              GOTO      STLRAL
N14  C                   END
S05  C*  43YAVD          READE     TRUH03                                 94
S05  C*  43
S05  C*NN94WSKNS         COMP      THKNS                              9494
N05  C   43WSKNS         READE     TRUH13                                 94
S05  C*  44YAVD          READE     TRUH02                                 94
S05  C*  44
S05  C*NN94WSKNK         COMP      THKNK                              9494
N05  C   44WSKNK         READE     TRUH12                                 94
     C   45WSDTT         IFEQ      999999
S05  C*    YAVD          READPE    TRUH04                                 94
S05  C* N94WSSG          COMP      THSG                               9494
N05  C     WSSG          READPE    TRUH14                                 94
     C                   ELSE
S05  C*    YAVD          READE     TRUH04                                 94
S05  C* N94WSSG          COMP      THSG                               9494
N05  C     WSSG          READE     TRUH14                                 94
     C                   END
     C   49WSST          READE     TRUH07                                 94
S18  C*  48              READ      TRUH15                                 94
N18  C   48              READ      TRUH16                                 94
N12  C   48
N12  CANN94              IF        WSAAVD <> 0 AND WSAAVD <> THAVD
N12  C                   GOTO      STLRAL
N12  C                   END
N12  C   48
N12  CANN94              IF        WSAKTK ='X' AND THST <> 'P' AND THST <> 'N'
N12  C                   GOTO      STLRAL
N12  C                   END
     C  N94              DO
     C  N94              IF        WSST <> *BLANKS
     C     WSST          CABNE     THST          STLRAL
     C                   END
N06  C                   IF        UIE = 'I'
S11  C*    THBLK         CABNE     'SS'          STLRAL
S11  C*    THBLK         CABNE     'NO'          STLRAL
N11  C                   IF        THDK<>'SS' AND THDK<>'ENTRY' AND THDK<>'EXIT'
N11  C                   GOTO      STLRAL
N11  C                   END
N06  C                   END
N12  C                   IF        *IN48
N12  C                   MOVE      THDDTD        WSDTD2
N12  C                   MOVE      THDDTM        WSDTM2
N12  C                   MOVE      THDDTA        WSDTÅ2
N12  C                   ELSE
     C                   MOVE      THDTD         WSDTD2
     C                   MOVE      THDTM         WSDTM2
     C                   MOVE      THDTÅ         WSDTÅ2
N12  C                   END
N16  C                   move      *zeros        wsdt2f
N16  C     thst          ifne      'D'
N16  C     thst          andne     'Z'
N16  C     thst          andne     'S'
N16  C                   MOVE      THDDTD        WSDTD2F
N16  C                   MOVE      THDDTM        WSDTM2F
N16  C                   MOVE      THDDTA        WSDTÅ2F
N16  C                   END
     C                   MOVE      THAVD         XNAVD
     C                   MOVE      THTDN         XNTDN
     C                   END
S05  C*  94YAVD          IFLT      9999
S05  C*    *IN40         ANDEQ     '0'
S05  C*    *IN41         ANDEQ     '0'
S05  C*                  ADD       1             YAVD
S05  C*    YAVD          SETLL     TRUSTD
S05  C*                  READ      TRUSTD                                 33
S05  C* N33              DO
S05  C*                  MOVE      THAVD         YAVD
S05  C*                  EXSR      MINTRL
S05  C*                  SETOFF                                       94
S05  C*                  GOTO      STLRAL
S05  C*                  END
S05  C*                  END
      *
     C                   ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N06  C     *ENTRY        PLIST
N06  C                   PARM                    UIE               1
N06   *
     C     TRHK          KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSTDN
     C     TRHKN         KLIST
     C                   KFLD                    XNAVD
     C                   KFLD                    XNTDN
     C     TRHKOP        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     TRHKKP        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     WRK2K         KLIST
     C                   KFLD                    W2AVD
     C                   KFLD                    W2TDN
     C     TRHKOX        KLIST
     C                   KFLD                    XAVD
     C                   KFLD                    XTDN
     C     TRH1K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    XDT
     C     TRH2K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     TRH3K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     TRH4K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     TRH5K         KLIST
     C                   KFLD                    WSTRNR
     C     TRH8K         KLIST
     C                   KFLD                    WSAAVD
     C                   KFLD                    WSST
     C     TRH9K         KLIST
     C                   KFLD                    XDT
     C     KUNDK         KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    KUNDNR
     C     KODTAK        KLIST
     C                   KFLD                    XUNIK
     C                   KFLD                    WSAAVD
     C     TRHA2K        KLIST
S05  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNK
     C                   KFLD                    XDTK
     C     TRHA3K        KLIST
S05  C*                  KFLD                    YAVD
     C                   KFLD                    WSKNS
     C                   KFLD                    XDTS
     C     TRHA4K        KLIST
S05  C*                  KFLD                    YAVD
     C                   KFLD                    WSSG
     C                   KFLD                    XDTT
     C     EDIM2K        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    X0068A
     C     EDIM2A        KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     EDIM4K1       KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    MAX0B
     C     EDIM4K2       KLIST
     C                   KFLD                    XSR1
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C     FRT2K         KLIST
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    FRTKOD
     C     STSK          KLIST
     C                   KFLD                    SSDT
     C                   KFLD                    SSTM
     C                   KFLD                    THAVD
     C                   KFLD                    THTDN
     C                   KFLD                    UUSER
N01  C     TRUHKFRI      KLIST
N01  C                   KFLD                    FSAVD
N01  C                   KFLD                    FSOPD
N01  C     FR1KEY        KLIST
N01  C                   KFLD                    WSKODE
N01  C                   KFLD                    WSSOK
N01  C     FR1KEYE       KLIST
N01  C                   KFLD                    WSKODE
N03  C     FRISOKK       KLIST
N03  C                   KFLD                    THAVD
N03  C                   KFLD                    THTDN
N03  C                   KFLD                    WSKODE
      *
     C     *LIKE         DEFINE    THPRO         UPRO
N01  C     *LIKE         DEFINE    FSKODE        WSKODE
S03  C*                  MOVEL     '*CR'         WSKODE
N03  C                   MOVEL     '*CN'         WSKODE
     C                   MOVE      'A'           XUNIK             1
S02  C*                  Z-ADD     2             SOANTK            1 0
S02  C*                  MOVE      'AVSENDER'    SOTXT1            8
S02  C*                  MOVE      'MOTTAKER'    SOTXT2            8
S02  C*                  MOVE      *BLANKS       SOTXT3            8
S02  C*                  MOVE      *BLANKS       SOTXT4            8
S02  C*                  MOVE      *BLANKS       SOTXT5            8
S02  C*                  MOVE      *BLANKS       SOTXT6            8
S02  C*                  MOVE      *BLANKS       SOTXT7            8
S02  C*                  MOVE      *BLANKS       SOTXT8            8
S02  C*                  MOVE      *ZEROS        SOKNR3            8 0
S02  C*                  MOVE      *ZEROS        SOKNR4            8 0
S02  C*                  MOVE      *ZEROS        SOKNR5            8 0
S02  C*                  MOVE      *ZEROS        SOKNR6            8 0
S02  C*                  MOVE      *ZEROS        SOKNR7            8 0
S02  C*                  MOVE      *ZEROS        SOKNR8            8 0
      *
N04  C                   MOVE      *BLANKS       WSSOKMAX         35
     C                   MOVE      *ZEROS        WSDT
     C                   MOVE      *ZEROS        WSDTS
     C                   MOVE      *ZEROS        WSDTK
     C                   MOVE      *ZEROS        WSDTT
N12  C                   MOVE      *ZEROS        WSDTA
N12  C                   MOVE      'X'           WSAKTK
N16  C                   MOVE      *ZEROS        WSDT2F
     C                   MOVE      *ZEROS        XDT
     C                   MOVE      *ZEROS        XDTS
     C                   MOVE      *ZEROS        XDTK
     C                   MOVE      *ZEROS        XDTT
     C                   MOVE      *ZEROS        THDT
     C                   MOVE      *ZEROS        WSDT2
N14  C                   MOVE      *BLANKS       WSNAK
     C                   MOVE      99999999      X0068A            8 0
     C                   MOVE      'N'           FRTKOD
     C                   MOVE      'R'           XSR1              1
     C                   MOVE      '99999999'    MAX0B             8 0
N06  C     UIE           COMP      'I'                                    28
      *
     C                   MOVE      UAVD          WSAAVD
     C     KODTAK        CHAIN     KODTA                              30
     C                   MOVE      USG           WSSG
     C                   MOVE      '999999'      WSDTT
     C                   SETON                                        45
N07  C                   MOVE      'J'           XSTART            1
      *
     C     FIFIRM        SETLL     FIRM                               30
     C                   READ      FIRM                                   30
      *
     C                   EXSR      CMDFT2
     C                   ENDSR
      *
      *
      ***********************************************
     C     CMDFT2        BEGSR
      ***********************************************
     C                   SELECT
     C     XMSG13        WHENEQ    0
     C                   ADD       1             XMSG13            1 0
     C                   MOVE      'DIV0020'     MSGF31
     C                   MOVE      'DIV0021'     MSGF32
     C                   MOVE      'DIV0022'     MSGF33
      *
     C     XMSG13        WHENEQ    1
     C                   add       1             XMSG13
     C                   MOVE      'DIV0023'     MSGF31
     C                   MOVE      'SHU1037'     MSGF32
     C                   MOVE      'YBC0034'     MSGF33
      *
     C     XMSG13        WHENEQ    2
     C                   Z-ADD     0             XMSG13
S19  C*                  MOVE      'DIV0000'     MSGF31
N19  C                   MOVE      'CBA0411'     MSGF31
     C                   MOVE      'DIV0000'     MSGF32
     C                   MOVE      'YBC0033'     MSGF33
     C                   ENDSL
      *
     C                   ENDSR
      *
      *
N15   ***********************************************
N15  C     OPDARKIV      BEGSR
N15   ***********************************************
N15  C  N90              move      *zeros        wsnr
N15  C  N90              update    subfil
N15  C                   IF        THST = 'U' AND THENKL = 'J'
N15  C     TRHKOP        CHAIN     ARKIVL15                           33
N15  C                   IF        *IN33
N15  C     TRHKOP        CHAIN     TRUHOPD                            33
N15  C                   IF        *IN33 = *OFF
N15  C                   EVAL      THPKL = 'J'
N15  C                   UPDATE    TRUHROPD
N15  C                   EVAL      ARTYPE = 'te'
N15  C                   EVAL      ARFIRM = FIFIRM
N15  C                   EVAL      ARAVD  = THAVD
N15  C                   EVAL      AROPD  = THTDN
N15  C                   EVAL      ARUSER = UUSER
N15  C                   WRITE     ARKIVR
N15  C                   CALL      'ARC002CL'
N15  C                   PARM                    ARTYPE
N15  C                   PARM                    ARUSER
N15  C                   PARM                    UAN01             1
N15  C                   END
N15  C                   END
N15  C                   END
N15   *
N15  C                   ENDSR
N15   *
      ***********************************************
     C     ARKIVS        BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
     C  N90              update    subfil
     C                   CALL      'ARC003'
     C                   PARM      THAVD         UAVD2             4 0
     C                   PARM      THTDN         UOPD2             7 0
     C                   PARM                    URUNDE           10
     C                   ENDSR
      ***********************************************
     C     FAXMAIL       BEGSR
      ***********************************************
     C  N90              move      *zeros        wsnr
     C  N90              update    subfil
     C                   CALL      'FAX031CLAD'
     C                   PARM      THAVD         UAVD2             4 0
     C                   PARM      THTDN         UOPD2             7 0
     C                   ENDSR
       //**********************************************
       begsr listut;
         //**********************************************
       //
         // Åpne dataarea
         in edidta;
         //___________________________________
         // Lag streng for katalognavn/filnavn
         //"""""""""""""""""""""""""""""""""""
         wfilnam = *blanks;
         wfilnam = '/' + %trimr(uelibf)
         + '/EDISE/TEMP/'
         + %trimr(wdt) + %trimr(wtm) + '.csv';
         //_____________________________
         // Lag fil og set codepage (pc)
         //"""""""""""""""""""""""""""""
         codepage = '819';
         file_o = open( %trimr( wfilnam )
         : 'w, codepage=' + codepage );

         rc = close( file_o );
         //________________________________________
         // Åpne fil, med tegnkonvertering for jobb
         //""""""""""""""""""""""""""""""""""""""""
         file_o = open( %trimr( wfilnam )
         : 'w' );
           // Skriv overskrift
           data = 'Avdeling;Dekl.no;Signatur;Dato;' +
                 'MRN/LRN;Status;Mottaker;Bruttovekt;' +
                 'Kolli;T;L;Valuta;Garantibeløp;Frist' + hex25;
           rc = fputs(data : file_o);
       //
         wzrecno=1;
         *in98=*off;
         chain wzrecno subfil;
         *in98 = not %found;
         dow *in98 = *off;
           wzrecno=wzrecno+1;
           chain wzrecno subfil;
       //
             data = %editc(thavd:'X')+';'+
                   %editc(thtdn:'X')+';'+
                   %trimr(thsg)+';'+
                   %editc(wsdt2:'X')+';'+
                   %trimr(wsmlrn)+';'+
                   %trimr(thst)+';'+
                   %trimr(thnak)+';'+
                   %editc(thvkb7:'X')+';'+
                   %editc(thntk:'X')+';'+
                   %trimr(thenkl)+';'+
                   %trimr(wspll)+';'+
                   %trimr(thgvk)+';'+
                   %editc(thgbl:'X')+';'+
                   %editc(wsdt2f:'X')+ hex25;
             rc = fputs(data : file_o);
       //
           *in98 = not %found;
         enddo;
           //Steng fil
           rc = close( file_o );
           //Vis fil
         read firmarc;
             wfilnam2 = 'http://' + %trimr(arcpad) +
                   %trimr(wfilnam);
         SYGE39B ( wfilnam2 );
       endsr;
      /end-free
