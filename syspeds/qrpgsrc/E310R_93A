      * SEND IFCSUM BASERT PÅ HENTEOPPDRAG INNLAND..
      *****************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
      * 01 JOV PTF10 R38-tekst også fra Oppdrags notisblokk (R / G)
********************************************************************
     FE307F     IF   E           K DISK
     FHEADF     IF   E           K DISK
     FDOKUF     UF   E           K DISK
     FDOK29     UF   E           K DISK
     FDOK36     UF   E           K DISK
N01  FFREETXT2  IF   E           K DISK
     FFIRM      IF   E             DISK
     FCUNDL01   IF   E           K DISK
     FDOKUFM    IF   E           K DISK
     FECNI93A   O  A E             DISK
     FEDTM93A   O  A E             DISK
     FEFTX93A   O  A E             DISK
     FEGID93A   O  A E             DISK
     FENAD93A   O  A E             DISK
     FEMEA93A   O  A E             DISK
     FEPCI93A   O  A E             DISK
     FERFF93A   O  A E             DISK
     FETDT93A   O  A E             DISK
     FETSR93A   O  A E             DISK
     FEMOA93A   O  A E             DISK
     FETOD93A   O  A E             DISK
      *___________________________
      * Arrays for string handling
      *"""""""""""""""""""""""""""
     D TX              S             70    DIM(26)
     D                 DS
     D  WTIME                  1     14  0
     D  WTID                   1      6  0
     D  WDD                    7      8  0
     D  WMM                    9     10  0
     D  WÅÅ                   11     14  0
     D                 DS
     D  WDATO                  1      8  0
     D  WÅ                     1      4  0
     D  WM                     5      6  0
     D  WD                     7      8  0
     D                 DS
     D  W1004                  1     12
     D  WUAVD                  1      4  0
     D  WUPRO                  5     12  0
     D  WUKNA                 13     20  0
     D  WUMN                  21     29  0
     D                 DS
     D  W1004B                 1     20
     D  DF1004                 1     35
     D                 DS
     D  HEADS3                 1     30
     D  XAVSPN                 1      4
     D  XAVSST                 6     30
     D                 DS
     D  HEADK3                 1     30
     D  XMOTPN                 1      4
     D  XMOTST                 6     30
     D                 DS
     D  WKUNDN                 1      8  0
     D                 DS
     D  WADR                   1     30
     D  W3251                  1      5
     D  W3164A                 6     10
     D  W3164B                11     30
     D  W3164                  6     30
      *____________________________________
      * DS for leftjustify numericel fields
      *""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN153                  1     15  3
     D  ØA153H                 1     12
     D  ØA153X                 5     12
     D  ØA153D                13     15
     D                 DS
     D  ØA12                   1     12
     D  Ø12                    1     12
     D                                     DIM(12)                              Num edit
     D                 DS
     D  HEVS1                  1     25
     D  HEVS1A                 1      3
     D  HEVS1B                 5     25
     D                 DS
     D  HEVS2                  1     25
     D  HEVS2A                 1      3
     D  HEVS2B                 5     25
      */////////////
      * MAIN LOGIC /
      */////////////
     C                   EXSR      SRINIT
     C                   EXSR      SRA                                          CONSIGNMENT
     C                   EXSR      SRB                                          TRIP
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      * SR for init                                        SRINIT /
      *////////////////////////////////////////////////////////////
     C     SRINIT        BEGSR
      * INPUT PARAMETERS
     C     *ENTRY        PLIST
     C                   PARM                    WMN               9 0
     C                   PARM                    WANTO
     C                   MOVE      WMN           WUMN
      * HENTE DAGENS DATO OG TID
     C                   TIME                    WTIME
     C                   Z-ADD     WÅÅ           WÅ
     C                   Z-ADD     WDD           WD
     C                   Z-ADD     WMM           WM
      * INIT AV ARBEIDSFELT
     C     *LIKE         DEFINE    CREP0         WREP0
     C     *LIKE         DEFINE    CREP1         WREP1
     C     *LIKE         DEFINE    CREP2         WREP2
     C     *LIKE         DEFINE    CREP3         WREP3
     C     *LIKE         DEFINE    CREP4         WREP4
     C     *LIKE         DEFINE    CREP5         WREP5
     C     *LIKE         DEFINE    CREP6         WREP6
     C     *LIKE         DEFINE    CREP7         WREP7
     C     *LIKE         DEFINE    CREP8         WREP8
     C                   Z-ADD     0             ØX                2 0                      --I
     C                   MOVE      *BLANKS       ØAN              12            Num alpha
     C                   Z-ADD     1             WEPOS1            4 0
     C                   READ      FIRM                                   51
      * DEF AV KEYS
     C     R29KEY        KLIST
     C                   KFLD                    DFAVD
     C                   KFLD                    DFOPD
     C                   KFLD                    DFFBNR
N01  C     FreeKey       KLIST
N01  C                   KFLD                    DFAVD
N01  C                   KFLD                    DFOPD
N01  C                   KFLD                    FRTKOD
     C     KUNKEY        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WKUNDN
     C     HEADKY        KLIST
     C                   KFLD                    EFAVD
     C                   KFLD                    EFOPD
     C     DOKUKY        KLIST
     C                   KFLD                    WFRI
     C                   KFLD                    EFAVD
     C                   KFLD                    EFOPD
     C                   KFLD                    EFFBNR
     C                   MOVE      'F'           WFRI              1
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR CONSIGNEMENT INFORMATION                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_____________
      * Get tripinfo
      *"""""""""""""
      *
     C                   READ      E307F                                  51
     C     *IN51         DOWEQ     '0'
      *
     C     HEADKY        CHAIN     HEADF                              77
      *
     C     DOKUKY        CHAIN     DOKUF                              78
     C     *IN78         IFEQ      *OFF
     C                   MOVE      'P'           DFST
     C                   MOVE      ' '           DFVEN
     C                   UPDATE    DOKUFR
     C                   ENDIF
      *
     C                   ADD       1             WANTO             5 0
     C                   ADD       DFNT          WENT              9 0
     C                   ADD       DFVKT         WEVKT            11 0
     C                   ADD       DFLM          WELM              7 2
     C                   ADD       DFM3          WEM3             11 3
      *
     C                   Z-ADD     WANTO         WREP0
     C                   EXSR      CNI15
      *
     C     SRA1          TAG
     C                   READ      E307F                                  51
     C  N51              ENDDO
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR TRIP ONFORMATION                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
     C                   EXSR      RFF01
     C                   EXSR      TDT05
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  CNI15 /
      *////////////////////////////////////////////////////////////
     C     CNI15         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   CNIR
      *_______________
      * Other segments
      *"""""""""""""""
     C                   EXSR      TSR15
     C                   EXSR      MOA15
     C                   EXSR      FTX15
     C                   EXSR      TOD17
     C                   EXSR      RFF18
     C                   EXSR      NAD25
     C                   EXSR      GID31
      *______
      * CNI15
      *""""""
      * 1490 Consolidation item number
     C                   Z-ADD     WANTO         ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           C1490
      * 1004 Document/message number
     C                   MOVEL     W1004B        W17              17
     C                   MOVEL     '401'         W20              20
     C                   MOVE      W17           W20
     C                   MOVEL     W20           C1004
      * Write record
     C                   Z-ADD     WUMN          CMN
     C                   Z-ADD     15            CGN
     C                   Z-ADD     WREP0         CREP0
     C                   WRITE     CNIR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM01 /
      *////////////////////////////////////////////////////////////
     C     DTM01         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   DTMR
     C                   Z-ADD     WUMN          DMN
     C                   Z-ADD     1             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
      *
     C                   MOVEL     '171'         D2005
     C                   MOVE      WDATO         TUDT              8 0
     C                   MOVEL     TUDT          D2380
     C                   MOVEL     '102'         D2379
     C                   Z-ADD     WREP1         DREP1
     C                   WRITE     DTMR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  DTM05 /
      *////////////////////////////////////////////////////////////
     C     DTM05         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   DTMR
     C                   Z-ADD     WUMN          DMN
     C                   Z-ADD     5             DGN
     C                   Z-ADD     WREP0         DREP0
     C                   Z-ADD     WREP1         DREP1
      *_______________
      * Departure date
      *"""""""""""""""
     C     TUDT          IFGT      0
     C                   MOVEL     '186'         D2005
     C                   MOVEL     TUDT          D2380
     C     D2380         CAT       '0000':0      D2380
     C                   MOVEL     '203'         D2379
     C                   Z-ADD     WREP1         DREP1
     C                   WRITE     DTMR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  FTX31 /
      *////////////////////////////////////////////////////////////
     C     FTX31         BEGSR
     C                   Z-ADD     1             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   FTXR
     C                   Z-ADD     WUMN          FMN
     C                   Z-ADD     31            FGN
     C                   Z-ADD     WREP0         FREP0
     C                   Z-ADD     WREP1         FREP1
     C                   Z-ADD     WREP2         FREP2
      *__________________
      * Goods description
      *""""""""""""""""""
     C                   MOVEL     'AAA'         F4451
     C                   MOVEL     HEVS1         F4440A
     C                   WRITE     FTXR
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  GID31 /
      *////////////////////////////////////////////////////////////
     C     GID31         BEGSR
     C                   Z-ADD     1             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
      *_______________
      * Other segments
      *"""""""""""""""
     C     HEVS1B        IFNE      *BLANKS
     C                   EXSR      FTX31
     C                   END
     C                   EXSR      MEA34
     C                   EXSR      PCI37
      *___________________
      * Goods item details
      *"""""""""""""""""""
     C                   CLEAR                   GIDR
     C                   MOVEL     '99999'       G1496                          goods item no
     C*                  Z-ADD     HENT          ØN153
     C                   Z-ADD     DFNT          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           G7224A
     C                   MOVEL     'KLL'         G7065A                         type of pack
     C                   Z-ADD     WUMN          GMN
     C                   Z-ADD     31            GGN
     C                   Z-ADD     WREP0         GREP0
     C                   Z-ADD     WREP1         GREP1
     C                   WRITE     GIDR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MEA34 /
      *////////////////////////////////////////////////////////////
     C     MEA34         BEGSR
     C                   Z-ADD     1             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
      *_________________________
      * Consignment gross weight
      *"""""""""""""""""""""""""
     C                   CLEAR                   MEAR
     C                   Z-ADD     WUMN          MMN
     C                   Z-ADD     34            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   Z-ADD     WREP2         MREP2
     C                   MOVEL     'WT '         M6311
     C                   MOVEL     'G  '         M6313
     C                   MOVEL     'KGM'         M6411
     C*                  Z-ADD     HEVKT         ØN153
     C                   Z-ADD     DFVKT         ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   WRITE     MEAR
      *_______
      * Volume
      *"""""""
     C*    HEM3          IFGT      0
     C     DFM3          IFGT      0
     C                   CLEAR                   MEAR
     C                   Z-ADD     WUMN          MMN
     C                   Z-ADD     34            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP2         MREP2
     C                   MOVEL     'VOL'         M6311
     C                   MOVEL     'MTQ'         M6411
     C*                  Z-ADD     HEM3          ØN153
     C                   Z-ADD     DFM3          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   WRITE     MEAR
     C                   ENDIF
      *_______________
      * Loading meters
      *"""""""""""""""
     C*    HELM          IFGT      0
     C     DFLM          IFGT      0
     C                   CLEAR                   MEAR
     C                   Z-ADD     WUMN          MMN
     C                   Z-ADD     34            MGN
     C                   Z-ADD     WREP0         MREP0
     C                   Z-ADD     WREP1         MREP1
     C                   ADD       1             WREP2
     C                   Z-ADD     WREP2         MREP2
     C                   MOVEL     'LMT'         M6311
     C                   MOVEL     'M'           M6411
     C*                  Z-ADD     HELM          ØN153
     C                   Z-ADD     DFLM          ØN153
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           M6314
     C                   ADD       1             WREP2
     C                   WRITE     MEAR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  NAD25 /
      *////////////////////////////////////////////////////////////
     C     NAD25         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
      *__________
      * CONSIGNOR
      *""""""""""
     C                   CLEAR                   NADR
     C                   ADD       1             WREP1
     C                   MOVEL     'CZ'          N3035
     C**   HEKNS         IFNE      *ZEROS
     C**                 MOVEL     HEKNS         N3039
     C                   MOVEL     *BLANKS       N3039
     C                   MOVEL     '73926'       N3039
     C**                 MOVEL     '91'          N3055
     C                   MOVEL     '87'          N3055
     C**                 END
     C**                 MOVEL     HENAS         N3036A                         party
     C**                 MOVEL     HEADS1        N3042A                         street
     C**                 MOVEL     XAVSST        N3164                          city
     C**                 MOVEL     XAVSPN        N3251                          postnr
     C                   MOVEL     'SEARUNNER SH'W3036A           24
     C                   MOVE      'IPPING A/S  'W3036A
     C                   MOVEL     W3036A        N3036A                         party
     C                   MOVEL     'GRØNLANDSLEI'W3042A           24
     C                   MOVE      'RET 31      'W3042A
     C                   MOVEL     W3042A        N3042A                         street
     C                   MOVEL     'OSLO        'N3164                          city
     C                   MOVEL     '0135        'N3251                          postnr
     C                   MOVEL     'NO'          N3207                          land
      *
     C                   Z-ADD     WUMN          NMN
     C                   Z-ADD     25            NGN
     C                   Z-ADD     WREP0         NREP0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         NREP1
     C                   WRITE     NADR
      *__________
      * CONSIGNEE
      *""""""""""
     C                   CLEAR                   NADR
     C                   ADD       1             WREP1
     C                   MOVEL     'CN'          N3035
     C     HEKNK         IFNE      *ZEROS
     C*                  MOVEL     HEKNK         N3039
     C                   MOVEL     *BLANKS       N3039
     C                   MOVEL     '91'          N3055
     C                   END
     C*                  MOVEL     HENAK         N3036A                         party
     C*                  MOVEL     HEADK1        N3042A                         street
     C*                  MOVEL     XMOTST        N3164                          city
     C*                  MOVEL     XMOTPN        N3251                          postnr
     C                   MOVEL     DFNAVL        N3036A                         party
     C                   MOVEL     DFAD1L        N3042A                         street
     C                   MOVEL     DFADUL        N3164                          city
     C                   MOVEL     DFPOUL        N3251                          postnr
     C                   MOVEL     'NO'          N3207                          land
      *
     C                   Z-ADD     WUMN          NMN
     C                   Z-ADD     25            NGN
     C                   Z-ADD     WREP0         NREP0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         NREP1
     C                   WRITE     NADR
      *__________
      * ANNEN FRAKTBETALER
      *""""""""""
     C     HEFR          IFEQ      'A  '
     C                   CLEAR                   NADR
     C                   ADD       1             WREP1
     C                   MOVEL     'IV'          N3035
     C                   Z-ADD     HEKNSF        WKUNDN
     C     KUNKEY        CHAIN     CUNDL01                            20
     C     *IN20         IFEQ      '1'
     C                   MOVEL     HENASF        N3036A                         party
     C                   ELSE
     C                   MOVEL     HEKNSF        N3039
     C                   MOVEL     '91'          N3055
     C                   MOVEL     KNAVN         N3036A                         party
     C                   MOVEL     ADR1          N3042A                         street
     C                   MOVEL     ADR3          N3164                          city
     C                   MOVEL     POSTNR        N3251                          postnr
     C                   ENDIF
     C                   MOVEL     'NO'          N3207                          land
      *
     C                   Z-ADD     WUMN          NMN
     C                   Z-ADD     25            NGN
     C                   Z-ADD     WREP0         NREP0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         NREP1
     C                   WRITE     NADR
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  PCI37 /
      *////////////////////////////////////////////////////////////
     C     PCI37         BEGSR
     C                   Z-ADD     1             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
      * KOLLI-ID...
     C     DFMKEY        KLIST
     C                   KFLD                    FMRI
     C                   KFLD                    FMAVD
     C                   KFLD                    FMOPD
     C                   KFLD                    FMFBNR
     C                   KFLD                    FMLINR
     C                   MOVE      'F'           FMRI
     C                   MOVE      HEAVD         FMAVD
     C                   MOVE      HEOPD         FMOPD
     C                   Z-ADD     1             FMFBNR
     C                   MOVE      *ZEROS        FMLINR
      *
     C                   Z-ADD     0             PCIANT            2 0
     C     DFMKEY        SETLL     DOKUFM
     C                   CLEAR                   PCIR
     C     DFMKEY        READE     DOKUFM                                 33
     C     *IN33         DOWEQ     '0'
     C     FMST          IFEQ      'I'
     C     FMST          OREQ      'E'
     C                   ADD       1             PCIANT
     C                   Z-ADD     WUMN          PMN
     C                   Z-ADD     37            PGN
     C                   Z-ADD     WREP0         PREP0
     C                   Z-ADD     WREP1         PREP1
     C                   Z-ADD     WREP2         PREP2
      *
     C                   MOVEL     FMMRK1        W18              18
     C                   MOVEL     '00'          W20              20
     C                   MOVE      W18           W20
     C                   MOVEL     W20           FMMRK1
      *
     C     PCIANT        IFEQ      1
     C                   MOVEL     FMMRK1        P7102A
     C                   ENDIF
     C     PCIANT        IFEQ      2
     C                   MOVEL     FMMRK1        P7102B
     C                   ENDIF
     C     PCIANT        IFEQ      3
     C                   MOVEL     FMMRK1        P7102C
     C                   ENDIF
     C     PCIANT        IFEQ      4
     C                   MOVEL     FMMRK1        P7102D
     C                   ENDIF
     C     PCIANT        IFEQ      5
     C                   MOVEL     FMMRK1        P7102E
     C                   ENDIF
     C     PCIANT        IFEQ      6
     C                   MOVEL     FMMRK1        P7102F
     C                   ENDIF
     C     PCIANT        IFEQ      7
     C                   MOVEL     FMMRK1        P7102G
     C                   ENDIF
     C     PCIANT        IFEQ      8
     C                   MOVEL     FMMRK1        P7102H
     C                   ENDIF
     C     PCIANT        IFEQ      9
     C                   MOVEL     FMMRK1        P7102I
     C                   ENDIF
     C     PCIANT        IFEQ      10
     C                   MOVEL     FMMRK1        P7102J
     C                   WRITE     PCIR
     C                   Z-ADD     0             PCIANT
     C                   ENDIF
     C                   END
     C     DFMKEY        READE     DOKUFM                                 33
     C                   END
     C     PCIANT        IFGT      0
     C                   WRITE     PCIR
     C                   ENDIF
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF01 /
      *////////////////////////////////////////////////////////////
     C     RFF01         BEGSR
     C                   Z-ADD     1             WREP0
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   RFFR
      *
      * Key
     C                   Z-ADD     WUMN          RMN
     C                   Z-ADD     1             RGN
     C                   Z-ADD     WREP0         RREP0
      * Data
     C                   MOVEL     'FF'          R1153
     C                   CALL      'SYGE15'
     C                   PARM                    WSENDN           20
     C                   MOVEL     '401'         WSENDN           20
     C                   MOVEL     WSENDN        R1154
      * Write record
     C                   WRITE     RFFR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF18 /
      *////////////////////////////////////////////////////////////
     C     RFF18         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
      * FORWARDER REFERENCE
     C                   CLEAR                   RFFR
     C                   Z-ADD     WUMN          RMN
     C                   Z-ADD     18            RGN
     C                   Z-ADD     WREP0         RREP0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         RREP1
     C                   MOVEL     'CU'          R1153
     C                   MOVEL     HEAVD         R1154
     C     R1154         CAT       '/':0         R1154
     C                   MOVEL     HEOPD         WFOPDA            7
     C     R1154         CAT       WFOPDA:0      R1154
     C     R1154         CAT       '/':0         R1154
     C     R1154         CAT       HESG:0        R1154
     C                   WRITE     RFFR
      * CUSTOMER REFERENCE
     C     HERFA         IFNE      *BLANKS
     C                   CLEAR                   RFFR
     C                   Z-ADD     WUMN          RMN
     C                   Z-ADD     18            RGN
     C                   Z-ADD     WREP0         RREP0
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         RREP1
     C                   MOVEL     'CU'          R1153
     C                   MOVEL     HERFA         R1154
     C                   WRITE     RFFR
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  RFF29 /
      *////////////////////////////////////////////////////////////
     C     RFF29         BEGSR
     C                   Z-ADD     1             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   RFFR
      *
     C*                    EXSR DTM01
      * Key
     C                   Z-ADD     WUMN          RMN
     C                   Z-ADD     29            RGN
     C                   Z-ADD     WREP0         RREP0
     C                   Z-ADD     WREP1         RREP1
     C                   Z-ADD     WREP2         RREP2
      * Data
     C                   MOVE      'ACL'         R1153
     C                   MOVEL     HEAVD         WEREF             9
     C                   MOVE      HEPRO         WEREF
     C                   MOVEL     WEREF         R1154
      * Write record
     C                   WRITE     RFFR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TDT05 /
      *////////////////////////////////////////////////////////////
     C     TDT05         BEGSR
     C                   Z-ADD     1             WREP0
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   TDTR
      *______
      * TDT05
      *""""""
     C                   MOVEL     '10 '         T8051
     C                   MOVEL     '3  '         T8067
     C                   MOVEL     *BLANKS       TUBILN           10
     C                   MOVEL     TUBILN        T8212
      *_____________
      * Write record
      *"""""""""""""
     C                   Z-ADD     WUMN          TMN
     C                   Z-ADD     5             TGN
     C                   Z-ADD     WREP0         TREP0
     C                   WRITE     TDTR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TSR15 /
      *////////////////////////////////////////////////////////////
     C     TSR15         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   TSRR
     C                   Z-ADD     WUMN          TMN
     C                   Z-ADD     15            TGN
     C                   Z-ADD     WREP0         TREP0
      *__________________
      * TRANSP. SERVICE REQUIREMENTS
      *""""""""""""""""""
      * ADR-MERKING LAGER FARLIG-GODS-FLAGG
     C     TRFA21        IFNE      *BLANKS
     C                   MOVEL     'RMD'         T7085
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         TREP1
     C                   WRITE     TSRR
     C                   END
      * IMD-MERKING LAGER VARM-GODS-FLAGG
     C     TRFA11        IFNE      *BLANKS
     C                   MOVEL     'ZHO'         T7085
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         TREP1
     C                   WRITE     TSRR
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  MOA15 /
      *////////////////////////////////////////////////////////////
     C     MOA15         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   MOAR
     C                   Z-ADD     WUMN          MMN
     C                   Z-ADD     15            MGN
     C                   Z-ADD     WREP0         MREP0
      *__________________
      * MONETARY AMOUNT
      *""""""""""""""""""
      * AGENT-BELØP FINNES SOM REKV PÅ UTKJØRINGSSIDEN
      *
     C                   ENDSR
      *
      *////////////////////////////////////////////////////////////
      *  Fritekst                                           FTX15 /
      *////////////////////////////////////////////////////////////
     C     FTX15         BEGSR
      *
     C****>              Z-ADD     0             WREP0
      *
     C                   CLEAR                   TX
      * Hent faste tekster til R-38
     C                   CALL      'SYFA12F'
     C                   PARM                    FIFIRM
     C                   PARM                    DFAVD
     C                   PARM                    DFOPD
     C                   PARM                    DFFBNR
     C                   PARM                    U38TXT          700
     C                   MOVEA     U38TXT        TX
      * Finn antall brukte array-element
     C                   Z-ADD     10            X                 3 0
     C     TX(X)         DOWEQ     *BLANKS
     C                   SUB       1             X
     C     X             CABEQ     0             UTFAS
     C                   END
     C     UTFAS         TAG
      *
      * Fyll opp videre i array med "ordinær fritekst"
     C     R29KEY        SETLL     DOK29
     C     R29KEY        READE     DOK29                                  90
     C     *IN90         DOWEQ     *OFF
      *
     C                   ADD       1             X
     C                   MOVEL     D29TXT        TX(X)
     C     R29KEY        READE     DOK29                                  90
     C                   ENDDO
N01   * Linjer til R38 - TIL KUNDE - fra Oppdrags notisblokk R
N01  C                   MOVE      'R'           FRTKOD
N01  C     FreeKey       Setll     FREETXT2
N01  C     FreeKey       Reade     FREETXT2                               90
N01  C     *IN90         DOWEQ     *OFF
N01  C                   ADD       1             X
N01  C                   MOVEL     FRTTXT        TX(X)
N01  C     FreeKey       Reade     FREETXT2                               90
N01  C                   END
      * Klargjør felt for å legge ut FTX-ICN_segment
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   FTXR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     15            FGN
     C                   Z-ADD     WREP0         FREP0
     C                   MOVEL     'ICN'         F4451
      * Legg ut segment
     C     X             IFGT      0
     C                   EXSR      FTX15B
     C                   END
      *
      * R36 fritekst sendes som "SIC" (Senders Instr. to Carrier)
     C                   Z-ADD     0             X
     C                   CLEAR                   TX
     C     R29KEY        SETLL     DOK36
     C     R29KEY        READE     DOK36                                  90
     C     *IN90         DOWEQ     *OFF
      *
     C                   ADD       1             X
     C                   MOVEL     D36TXT        TX(X)
     C     R29KEY        READE     DOK36                                  90
     C                   ENDDO
N01   * Linjer til R38 - TIL TRANSP- fra Oppdrags notisblokk G
N01  C                   MOVE      'G'           FRTKOD
N01  C     FreeKey       Setll     FREETXT2
N01  C     FreeKey       Reade     FREETXT2                               90
N01  C     *IN90         DOWEQ     *OFF
N01  C                   ADD       1             X
N01  C                   MOVEL     FRTTXT        TX(X)
N01  C     FreeKey       Reade     FREETXT2                               90
N01  C                   END
      * Klargjør felt for å legge ut FTX-SIC_segment
     C                   CLEAR                   FTXR
     C                   Z-ADD     WMN           FMN
     C                   Z-ADD     15            FGN
     C                   Z-ADD     WREP0         FREP0
     C                   MOVEL     'SIC'         F4451
      *
     C     X             IFGT      0
     C                   EXSR      FTX15B
     C                   END
      *
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Skriv fritekst fra array til segment (5 og 5)      FTX15B/
      *////////////////////////////////////////////////////////////
     C     FTX15B        BEGSR
      * Når SR er kalt - Alltid minst ett segment a 5. linjer,
     C                   Z-ADD     1             XA                3 0
     C     STRFTX        TAG
     C     XA            ADD       1             XB                3 0
     C     XA            ADD       2             XC                3 0
     C     XA            ADD       3             XD                3 0
     C     XA            ADD       4             XE                3 0
     C*
     C                   Z-ADD     WREP0         FREP0
     C     TX(XA)        IFEQ      *BLANKS
     C                   EVAL      TX(XA) = '.'
     C                   ENDIF
     C                   MOVEL     TX(XA)        F4440A
     C                   MOVEL     TX(XB)        F4440B
     C                   MOVEL     TX(XC)        F4440C
     C                   MOVEL     TX(XD)        F4440D
     C                   MOVEL     TX(XE)        F4440E
     C                   WRITE     FTXR
      * Flere??
     C     XE            IFLT      X
     C                   ADD       5             XA
     C                   GOTO      STRFTX
     C                   END
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      * SR                                                  TOD17 /
      *////////////////////////////////////////////////////////////
     C     TOD17         BEGSR
     C                   Z-ADD     0             WREP1
     C                   Z-ADD     0             WREP2
     C                   Z-ADD     0             WREP3
     C                   Z-ADD     0             WREP4
     C                   Z-ADD     0             WREP5
     C                   Z-ADD     0             WREP6
     C                   Z-ADD     0             WREP7
     C                   Z-ADD     0             WREP8
     C                   CLEAR                   TODR
     C                   Z-ADD     WUMN          TMN
     C                   Z-ADD     17            TGN
     C                   Z-ADD     WREP0         TREP0
      *__________________
      * Terms of delivery
      *""""""""""""""""""
     C                   MOVEL     '5'           T4055
     C                   SELECT
     C     HEFR          WHENEQ    'M  '
     C                   MOVEL     'CC '         T4053
     C     HEFR          WHENEQ    'A  '
     C                   MOVEL     'TP '         T4053
     C                   OTHER
     C                   MOVEL     'PP '         T4053
     C                   ENDSL
     C                   ADD       1             WREP1
     C                   Z-ADD     WREP1         TREP1
     C                   WRITE     TODR
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Leftjustify num.fields                              SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Move correct value into alpha 12-field
     C                   MOVE      *ZEROS        ØA12
     C     ØA153D        IFEQ      '000'                                        <-------------I
     C                   MOVE      ØA153H        ØA12                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA153X        ØA12                                         I
     C                   MOVE      ',   '        ØA12                                         I
     C                   MOVE      ØA153D        ØA12                                         I
     C                   END                                                    <-------------I
      * search from left and find first sign over 0
     C     1             DO        11            ØX                             <-------------I
     C     Ø12(ØX)       IFNE      '0'                                           <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   END                                                     <-----------II
     C                   END                                                    <-------------I
     C     SRNE1         TAG
      * Leftjustify to a new field
     C     ØA153D        IFNE      '000'                                        <-------------I
     C                   SUB       1             ØX                                           I
     C                   ENDIF                                                  <-------------I
     C                   MOVE      *BLANKS       ØAN
     C                   MOVEA     Ø12(ØX)       ØAN
      *
     C                   ENDSR
