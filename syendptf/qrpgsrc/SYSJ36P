********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 sh  PTF12 INNFØRT TIL DATO   .....
12XXX * 02 sh  PTF12 ikke oppdater hvis linje har tildato
********************************************************************
      ***********************************************************
      *** PROGRAM SKAL prisendre    FRAKTAVTALER (CONTAINER)
     FCDTRAFL2  IF   E           K DISK
     FKALENDER  IF   E           K DISK
     FKODTLK    IF   E           K DISK
     FKODTLKRE  IF   E           K DISK
     F                                     RENAME(KODTLKR:KODTLKR2)
     FKODTVA    IF   E           K DISK
     FKODTFR    IF   E           K DISK
     FKODTOTY   IF   E           K DISK
     FSTED2     IF   E           K DISK
     FCDCON4    IF   E           K DISK
     FCFRAT     UF A E           K DISK
     FCFRATPJ   O  A E           K DISK
     FFIRM      IF   E           K DISK
     FCUNDL01   IF   E           K DISK
     FSYSJ36pfm CF   E             WORKSTN
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  W2DATF                 1      8  0
     D  W2AAR2                 1      4  0
     D  W2MND2                 5      6  0
     D  W2DAG2                 7      8  0
     D                 DS
     D  WKDATF                 1      8  0
     D  WKAAR2                 1      4  0
     D  WKMND2                 5      6  0
     D  WKDAG2                 7      8  0
N01  D                 DS
N01  D  W2DATT                 1      8  0
N01  D  W2AAR2T                1      4  0
N01  D  W2MND2T                5      6  0
N01  D  W2DAG2T                7      8  0
N01  D                 DS
N01  D  WKDATT                 1      8  0
N01  D  WKAAR2T                1      4  0
N01  D  WKMND2T                5      6  0
N01  D  WKDAG2T                7      8  0
     D                 DS
     D  TY                     1     10
     D                                     DIM(5)
     D  TYA                    1     10
     D  TY01                   1      2
     D  TY02                   3      4
     D  TY03                   5      6
     D  TY04                   7      8
     D  TY05                   9     10
      *
     C                   EXSR      INIT
      *
     C     START         TAG
     C                   EXFMT     VARELI
     C                   MOVEA     '00000000'    *IN(83)
     C                   SETOFF                                       30
      *
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
      *
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      START
     C                   END
      *
     C  N12              EXSR      TESTB1
     C   12              GOTO      SLUTT
     C   30              goto      start
n01  c                   z-add     0             ante
     c                   exsr      selectsr
s02  c*    w2datf        ifeq      0
s02  c*    w2datt        andne     0
s02  c*                  move      'J'           hst
s02  c*                  exsr      selectsr
s02  c*                  move      ' '           hst
s02  c*                  end
     C                   GOTO      START
     C     SLUTT         TAG
     C                   exsr      ferdig
     C                   SETON                                        LR
     C                   RETURN
      *
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     c                   z-add     25            posnbr
      *brutto / kunde  B/K
     c                   setoff                                       93
     c     wsbrku        ifne      'B'
     c     wsbrku        andne     'K'
     c                   seton                                        3093
     C                   MOVE      'SHU1872'     MSGNR
     C                   Z-ADD     4             LINNBR
     C                   end
      *
     c                   setoff                                       92
     C     WSBRKU        IFEQ      'K'
     c     wsknr         andne     99999999
     C     CUND1K        CHAIN     CUNDL01                            92
     c   92              do
     C  N30              MOVE      'SPK0001'     MSGNR
     C  N30              Z-ADD     5             LINNBR
     c                   seton                                        30
     C                   END
     C                   END
      *
      *
     C     WSBRKU        IFEQ      'B'
     c     kundnr        andne     0
     C  N30              MOVE      'SHU1873'     MSGNR
     C  N30              Z-ADD     5             LINNBR
     C                   seton                                        3092
     C                   END
      *
      * trafikk
      *
     c                   setoff                                       91
     c     w2tra         ifne      '*   '
     C     w2tra         andne     '    '
     C     CDTRAFK       CHAIN     CDTRAFL2                           91
     c  N91W2TRA         comp      *blanks                                91
     C   91              do
     C  N30              MOVE      'SHU1880'     MSGNR
     C  N30              Z-ADD     6             LINNBR
     C                   SETON                                        30
     c                   end
     c                   end
      *
      * frankatur
      *
     c                   setoff                                       90
     c     w2fran        ifne      '*  '
     C     KODFRK        CHAIN     KODTFR                             90
     C   90              do
     C  N30              MOVE      'SPF0006'     MSGNR
     C  N30              Z-ADD     7             LINNBR
     C                   SETON                                        30
     c                   end
     c                   end
      *
      * oppdragstype
      *
     c                   setoff                                       89
     C     W2OPDT        IFNE      '* '
     C     KODOTK        CHAIN     KODTOTY                            89
     C   89              do
     C  N30              MOVE      'SPO0007'     MSGNR
     C  N30              Z-ADD     8             LINNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *   Kode S/K
      *
     c                   setoff                                       88
     C     W2SK          ifne      'S'
     C     W2SK          andne     'K'
     C     W2SK          andne     '*'
     C  N30              MOVE      'SPS0032'     MSGNR
     C  N30              Z-ADD     9             LINNBR
     C                   SETON                                        8830
     c                   end
      *
      * FRA STED.
      *
     c                   setoff                                       87
     c     w2fra         ifne      '*    '
     C     W2FRA         CHAIN     STED2                              87
     c   87              do
     C  N30              MOVE      'SPS0030'     MSGNR
     C  N30              Z-ADD     10            LINNBR
     C                   SETON                                        30
     c                   end
     c                   end
      *
      *
      * til STED.
      *
     c                   setoff                                       86
     c     w2til         ifne      '*    '
     C     W2TIL         CHAIN     STED2                              86
     C   86              DO
     C  N30              Z-ADD     11            LINNBR
     C  N30              MOVE      'SPS0030'     MSGNR
     C                   SETON                                        30
     C                   END
     C                   END
      *
      * containertype
      *
     c                   setoff                                       85
     c     w2type        ifne      '* '
     C     W2TYPE        CHAIN     CDCON4                             85
     C   85              DO
     C  N30              MOVE      'SPK0131'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *
      * containertype 2
      *
     c                   setoff                                       84
     c     w2typ2        ifne      '* '
     C     W2TYP2        CHAIN     CDCON4                             84
     C   84              DO
     C  N30              MOVE      'SPK0131'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     c  N30              z-add     28            posnbr
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *
      * containertype 3
      *
     c                   setoff                                       83
     c     w2typ3        ifne      '* '
     C     W2TYP3        CHAIN     CDCON4                             83
     C   83              DO
     C  N30              MOVE      'SPK0131'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     c  N30              z-add     31            posnbr
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *
      * containertype 4
      *
     c                   setoff                                       82
     c     w2typ4        ifne      '* '
     C     W2TYP4        CHAIN     CDCON4                             82
     C   82              DO
     C  N30              MOVE      'SPK0131'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     c  N30              z-add     34            posnbr
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *
      * containertype 5
      *
     c                   setoff                                       81
     c     w2typ5        ifne      '* '
     C     W2TYP5        CHAIN     CDCON4                             81
     C   81              DO
     C  N30              MOVE      'SPK0131'     MSGNR
     C  N30              Z-ADD     12            LINNBR
     c  N30              z-add     37            posnbr
     C                   SETON                                        30
     C                   END
     C                   END
      *
      *** TEST LANDKODE fra
      *
     c                   setoff                                       80
     C     W2LANF        IFNE      '* '
     C                   MOVE      W2LANF        WSLKA             2
     C     KODLKK        CHAIN     KODTLKR                            80
     C   80              DO
     C  N30              MOVE      'SPL0001'     MSGNR
     C  N30              z-add     13            linnbr
     C                   SETON                                        30
     c                   end
     c                   end
     C*
      *
      *** TEST LANDKODE til
      *
     c                   setoff                                       79
     C     W2LANT        IFNE      '* '
     C                   MOVE      W2LANT        WSLKA
     C     KODLKK        CHAIN     KODTLKR                            79
     C   79              DO
     C  N30              z-add     14            linnbr
     C  N30              MOVE      'SPL0001'     MSGNR
     C                   SETON                                        30
     c                   end
     c                   end
      *
      *** TEST REGION   fra
      *
     c                   setoff                                       78
     C     W2REGF        IFNE      '* '
     C     W2REGF        CHAIN     KODTLKRE                           78
     C  n78W2REGF        COMP      *BLANKS                                78
     C   78              DO
     C  N30              MOVE      'SHU1878'     MSGNR
     C  N30              z-add     15            linnbr
     C                   SETON                                        30
     c                   end
     c                   end
     C*
      *
      *0* TEST REGION   TIL
      *
     c                   setoff                                       77
     C     W2REGT        IFNE      '* '
     C     W2REGT        CHAIN     KODTLKRE                           77
     C  n77W2REGT        COMP      *BLANKS                                77
     C   77              DO
     C  N30              MOVE      'SHU1878'     MSGNR
     C  N30              z-add     16            linnbr
     C                   SETON                                        30
     c                   end
     c                   end
     C*
     C*
      *
      * test dato fra
      *
N01  C                   SETOFF                                       76
n01  c     w2datF        ifne      *zeros
     c     W2DATF        chain     kalender                           76
     C   76              DO
     C  N30              Z-ADD     20            LINNBR
     C  N30              MOVE      'SPD0001'     MSGNR
     C                   SETON                                        30
     C                   END
N01  C                   END
n01  c                   setoff                                       68
n01  c     w2datt        ifne      *zeros
n01  c     W2DATT        chain     kalender                           68
N01  c  n68w2datt        ifle      w2datf
n01  c                   seton                                        68
N01  C                   END
n01  C   68              DO
n01  C  N30              Z-ADD     20            LINNBR
n01  C  N30              Z-ADD     39            POSNBR
n01  C  N30              MOVE      'SPD0001'     MSGNR
n01  C                   SETON                                        30
N01  C                   END
N01  C                   END
      *
      * valutakode
      *
     C                   SETOFF                                       73
     C     W2PRIS        ifne      0
     C     KODVAK        CHAIN     KODTVA                             73
     C   73              DO
     C  N30              Z-ADD     21            LINNBR
     C  N30              Z-ADD     25            posNBR
     C  N30              MOVE      'SPV0001'     MSGNR
     C                   SETON                                        30
     C                   END
     C                   END
      *
     c                   setoff                                       72
     C     W2PRIS        ifne      0
     c     w2prpm        andne     '+'
     c     w2prpm        andne     '-'
     C  N30              Z-ADD     21            LINNBR
     C  N30              Z-ADD     30            posnbr
     C  N30              MOVE      'SHU1874'     MSGNR
     c                   seton                                        7230
     c                   end
      *
      * begge endringer kan ikke være 0
      *
S01  c*                  setoff                                       71
S01  C*    W2PRIS        ifeq      0
S01  C*    W2PROS        andeq     0
S01  C* N30              MOVE      'SHU1875'     MSGNR
S01  C* N30              Z-ADD     21            LINNBR
S01  C* N30              Z-ADD     33            posNBR
S01  c*                  seton                                        7130
S01  c*                  end
      *
      *
      * begge endringer kan ikke være utfyllt
      *
     C     W2PRIS        ifgt      0
     C     W2PROS        andgt     0
     C  N30              Z-ADD     21            LINNBR
     C  N30              Z-ADD     33            posNBR
     C  n30              MOVE      'SHU1876'     MSGNR
     c                   seton                                        7130
     c                   end
      *
      *
      * + eller - når prosent er tastet
      *
     c                   setoff                                       72
     C     W2PROS        ifne      0
     c     w2prop        andne     '+'
     c     w2prop        andne     '-'
     C  N30              Z-ADD     22            LINNBR
     C  N30              Z-ADD     25            LINNBR
     C  N30              MOVE      'SHU1874'     MSGNR
     c                   seton                                        7230
     c                   end
      *
     C                   EXSR      MOVWCF
      *
     C     SLTB1         ENDSR
      *
      *
      *
     C***********************************************
     C     MOVWCF        BEGSR
     C***********************************************
     C                   MOVE      WSKNR         FTKNR
     C                   MOVE      W2FRAN        FTFRAN
     C                   MOVE      W2TRA         FTTRA
     C                   MOVE      W2OPDT        FTOPDT
     C                   MOVE      W2FRA         FTFRA
     C                   MOVE      W2TIL         FTTIL
     C                   MOVE      W2SK          FTSK
     C                   MOVE      W2TYPE        FTTYPE
     C                   MOVE      W2PRIS        FTPRIS
     C                   MOVE      W2VAL         FTVAL
n01  c     W2DATF        IFNE      *ZEROS
     C                   MOVE      W2DATF        FTDF
N01  C                   end
n01  c     W2DATT        IFNE      *ZEROS
N01  C                   MOVE      W2DATT        FTDT
N01  C                   END
      *
     C                   ENDSR
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     LINNBR        IFEQ      5
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     32
     C                   EXSR      SOKKUN
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      6
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     28
     C                   CAll      'SYSJ17A'
     C                   PARM                    KN0               8 0
     C                   PARM                    W2TRA
     C                   Z-ADD     7             LINNBR
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      7
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     27
     C                   CALL      'SYFI10G'
     C                   PARM                    W2FRAN
     C                   PARM                    USPED
     C                   Z-ADD     8             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      8
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     26
     C                   CALL      'SYFI10C'
     C                   PARM                    W2OPDT
     C                   Z-ADD     9             LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      10
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2FRA
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     11            LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      11
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     29
     C                   MOVE      *BLANKS       UNVN
     C                   MOVE      *BLANKS       ULK
     C                   CALL      'SYFI10F'
     C                   PARM                    W2TIL
     C                   PARM                    UNVN             30
     C                   PARM                    ULK               2
     C                   Z-ADD     12            LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      12
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     26
     C                   CALL      'SYSJ02X'
     C                   PARM                    W2TYPE
     C                   Z-ADD     14            LINNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     25
     C     POSNBR        ANDLE     27
     C                   CALL      'V200SY'
     C                   PARM                    USOK
     C                   PARM                    W2VAL
     C                   GOTO      SLSØK
     C                   END
      *
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
      *
     C                   Z-ADD     25            POSNBR
      *
     C     SLSØK         ENDSR
      *
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
N02  C                   MOVE      ' '           UHST              1
N02  C     W2KNRK        KLIST
N02  c                   kfld                    UHST
N02  C                   KFLD                    WSKNR
     C     KODVAK        KLIST
     C                   KFLD                    KVAUNI
     C                   KFLD                    W2VAL
     C     KODFRK        KLIST
     C                   KFLD                    KFRUNI
     C                   KFLD                    W2FRAN
     C     KODOTK        KLIST
     C                   KFLD                    KO1UNI
     C                   KFLD                    W2OPDT
     C     KODLKK        KLIST
     C                   KFLD                    XLKUNI
     C                   KFLD                    WSLKA
     C     CUND1K        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    WSKNR
     C     CDTRAFK       KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    W2TRA
      *
      *
     C                   MOVE      'VA'          KVAUNI
     C                   MOVE      'FR'          KFRUNI
     C                   MOVE      'OTY'         KO1UNI
     C                   MOVE      'LK '         XLKUNI            3
      *
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
      *
     C                   MOVE      'J'           USPED             1
     C                   MOVE      'J'           USOK              1
     c                   move      *zeros        w2datf
N01  c                   move      *zeros        w2datt
     C                   ENDSR
      *
     C***********************************************
     C     SOKKUN        BEGSR
     C***********************************************
      *
     C                   MOVE      *BLANKS       USØKNV           30
     C                   CALL      'SOEKKUN'
     C                   PARM                    WSKNR
     C                   PARM                    FIFIRM
     C                   PARM                    USØKNV           30
      *
      *
     C                   ENDSR
      *
      *
     C***********************************************
     C     SELECTSR      BEGSR
     C***********************************************
s01  c*                  z-add     0             ante
     C     CFRATK        KLIST
     C                   KFLD                    HST               1
     C                   KFLD                    WSKNR
     C     CFRATKA       KLIST
     C                   KFLD                    HST               1
      *
     C                   SETOFF                                       33
     C     WSBRKU        IFEQ      'B'
     C                   Z-ADD     0             WSKNR
     C                   END
     C     WSKNR         IFEQ      99999999
     C                   MOVE      'ALLE'        MODE              4
     C                   Z-ADD     1             WSKNR
     C                   END
     C     CFRATK        SETLL     CFRAT
     C     *IN33         DOWEQ     '0'
     c     NESTE         TAG
     C     MODE          IFEQ      'ALLE'
     C     CFRATKA       READE     CFRAT                                  33
     C                   ELSE
     C     CFRATK        READE     CFRAT                                  33
     C                   END
     C     *IN33         IFEQ      '0'
N02   *
N02  C* kun avtaler med tildato = 0 skal oppdateres
N02   *
N02  C     FTDT          IFNE      0
N02  C                   GOTO      NESTE
N02  C                   END
      *
     C* W2TRA = TRAFIKK
      *
     C     W2TRA         IFNE      '*   '
     C     FTTRA         ANDNE     W2TRA
     C                   GOTO      NESTE
     C                   END
      *
      * FRANKATUR
      *
     C     W2FRAN        IFNE      '*  '
     C     FTFRAN        ANDNE     W2FRAN
     C                   GOTO      NESTE
     C                   END
      *
      * OPPDRAGSTYPE
      *
     C     W2OPDT        IFNE      '* '
     C     FTOPDT        ANDNE     W2OPDT
     C                   GOTO      NESTE
     C                   END
      *
      * OPPDRAGSTYPE
      *
     C     W2OPDT        IFNE      '* '
     C     FTOPDT        ANDNE     W2OPDT
     C                   GOTO      NESTE
     C                   END
      *
      * S/K
      *
     C     W2SK          IFNE      '*'
     C     FTSK          ANDNE     W2SK
     C                   GOTO      NESTE
     C                   END
      *
      * FRA STED
      *
     C     W2FRA         IFNE      '*    '
     C     FTFRA         ANDNE     W2FRA
     C                   GOTO      NESTE
     C                   END
      *
      * TIL STED
      *
     C     W2TIL         IFNE      '*    '
     C     FTTIL         ANDNE     W2TIL
     C                   GOTO      NESTE
     C                   END
      *
      * CONTAINERTYPER
      *
     C     W2TYPE        IFNE      '* '
     C                   MOVE      W2TYPE        TY01
     C                   END
      *
     C     W2TYP2        IFNE      '* '
     C                   MOVE      W2TYP2        TY02
     C                   END
      *
      *
     C     W2TYP3        IFNE      '* '
     C                   MOVE      W2TYP3        TY03
     C                   END
      *
      *
     C     W2TYP4        IFNE      '* '
     C                   MOVE      W2TYP4        TY04
     C                   END
      *
      *
     C     W2TYP5        IFNE      '* '
     C                   MOVE      W2TYP5        TY05
     C                   END
     C     TYA           IFNE      *BLANKS
     C     FTTYPE        LOOKUP    TY                                     34
     C  N34              GOTO      NESTE
     C                   END
      *
      * LAND FRA
      *
     C     W2LANF        IFNE      '* '
     C     FTFRA         CHAIN     STED2                              34
     C   34              GOTO      NESTE
     C     W2LANF        IFNE      ST2LK
     C                   GOTO      NESTE
     C                   END
     C                   END
      *
      * LAND TIL
      *
     C     W2LANT        IFNE      '* '
     C     FTTIL         CHAIN     STED2                              34
     C   34              GOTO      NESTE
     C     W2LANT        IFNE      ST2LK
     C                   GOTO      NESTE
     C                   END
     C                   END
      *
      * REGION FRA
      *
     C     KEYLK         KLIST
     C                   KFLD                    UNI
     C                   KFLD                    ST2LK
     C                   MOVE      'LK '         UNI               3
     C     W2REGF        IFNE      '* '
     C     FTFRA         CHAIN     STED2                              34
     C   34              GOTO      NESTE
     C     KEYLK         CHAIN     KODTLK                             34
     C     FTFRA         CHAIN     STED2                              34
     C     W2REGF        IFNE      KLKLK2
     C                   GOTO      NESTE
     C                   END
     C                   END
      *
      * REGION TIL
      *
     C     W2REGT        IFNE      '* '
     C     FTTIL         CHAIN     STED2                              34
     C   34              GOTO      NESTE
     C     KEYLK         CHAIN     KODTLK                             34
     C     FTTIL         CHAIN     STED2                              34
     C     W2REGT        IFNE      KLKLK2
     C                   GOTO      NESTE
     C                   END
     C                   END
     c     w2val         ifne      ftval
n01  c     w2pris        ifne      0
n01  c     w2pros        andne     0
     c                   goto      neste
n01  c                   end
     c                   end
      * ny dato  høyere enn gammel dato
      * da skal gammel post ha J i FTHST
     c     w2datf        ifgt      ftdf
     c                   move      'J'           fthst
     c                   update    cfratr
     c                   move      '1'           fthst
     c                   end
      * ny dato  mindre enn gammel dato
      * da skal gammel post være uendret
      * bortsett fra eventuell til dato
     c     w2datf        iflt      ftdf
n01  c     W2DATF        ANDNE     0
n01  c     w2datt        ifne      0
n01  c                   move      w2datt        ftdt
n01  c                   end
     c                   update    cfratr
     c                   move      'J'           fthst
     c                   end
     c
      *
      * ny pris valutaøk
      *
     C     W2PRIS        IFNE      *ZEROS
     C     W2PRPM        IFEQ      '+'
     C                   ADD       W2PRIS        FTPRIS
     C                   ELSE
     C                   SUB       W2PRIS        FTPRIS
     C                   END
     C                   END
      *
      * ny pris prosentøk
      *
     C     W2PROS        IFNE      0
     C     W2PRIS        MULT      W2PROS        ENDREV            7 0
     C     W2PROP        IFEQ      '+'
     C                   ADD       ENDREV        FTPRIS
     C                   ELSE
     C                   SUB       ENDREV        FTPRIS
     C                   END
     C                   END
      *
      * ikke ny post ved uendret dato
      *
     c     w2datf        ifeq      ftdf
n01  c     W2DATF        OREQ      0
n01  c     w2datt        ifne      0
n01  c                   move      w2datt        ftdt
n01  c                   end
     c                   update    cfratr
     c                   else
     C                   Z-Add     W2DATF        FTDF
N01  C                   Z-Add     W2DATT        FTDT
     c                   write     cfratr
     c                   end
     c                   ADD       1             ante
     C                   WRITE     CFRATPJR
     c
      *
     C                   ENDIF
     C                   ENDDO
     C     ANTE          IFNE      0
     C                   Z-ADD     0             W2PROS
     C                   Z-ADD     0             W2PRIS
     C                   END
     C                   ENDSR
      ****************************************************
     c     ferdig        begsr
      ****************************************************
     c                   move      '1'           hst
     c                   setoff                                       33
     C     CFRATKA       SETLL     CFRAT
     C     *IN33         DOWEQ     '0'
     C     CFRATKA       READE     CFRAT                                  33
     c     *in33         ifeq      '0'
     c                   move      ' '           fthst
     c                   update    cfratr
     c                   endif
     c                   enddo
     c                   endsr
