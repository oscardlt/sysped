     FSVI026D   CF   E             WORKSTN
     F                                     SFILE(SVI026DA:ZRECNO)
     FSVIHE     IF   E           K DISK
     FSVXHE     IF   E           K DISK
     D                UDS
     D  SVIHE_DTA              1     80
     D  SVXHE_DTA              1     80
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   MOVE      '1'           *INLR
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVIHE_SYA
     C                   PARM                    UVIHE_SYO
     C                   PARM                    UTYPE             6
      *________________
      * Arbetsvariablar
      *""""""""""""""""
     C     *LIKE         DEFINE    ZRECNO        WRECNO
     C     *LIKE         DEFINE    SVIHE_SYA     UVIHE_SYA
     C     *LIKE         DEFINE    SVIHE_SYO     UVIHE_SYO
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVIHE_SYA
     C                   KFLD                    UVIHE_SYO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Bearbeide Formater                                   SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR

     C     SRB1          TAG
      *______________
      * Tømme Subfile
      *""""""""""""""
     C                   EVAL      *IN93=*ON
     C                   WRITE     SVI026DB
     C                   MOVEA     '000'         *IN(93)
     C                   Z-ADD     *ZERO         ZRECNO
     C                   Z-ADD     *ZERO         WRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C                   SELECT
     C                   WHEN      UTYPE = 'NCTS-E'
     C     KEYA          SETLL     SVXHE
     C     KEYA          READE     SVXHE                                  94
     C                   OTHER
     C     KEYA          SETLL     SVIHE
     C     KEYA          READE     SVIHE                                  94
     C                   ENDSL

     C     *IN94         DOWEQ     '0'
     C                   ADD       1             ZRECNO
     C                   WRITE     SVI026DA
     C                   SELECT
     C                   WHEN      UTYPE = 'NCTS-E'
     C     KEYA          READE     SVXHE                                  94
     C                   OTHER
     C     KEYA          READE     SVIHE                                  94
     C                   ENDSL
     C  N94              ENDDO

     C     ZRECNO        IFEQ      0
     C                   ADD       1             ZRECNO
     C                   WRITE     SVI026DA
     C                   ENDIF
     C                   EVAL      WRECNO=ZRECNO
     C                   EVAL      ZRECNO=1
      *_______________
      * Behandle bilde
      *"""""""""""""""
     C     SRB3          TAG

     C                   MOVEA     '11'          *IN(91)
     C  N30              EVAL      ZMSGNO='SY00000'
     C                   WRITE     SVI026DØ
     C                   WRITE     SVI026DC
     C                   EXFMT     SVI026DB
     C                   EVAL      *IN30=*OFF

     C     *IN03         IFEQ      '0'
     C     *IN12         ANDEQ     '0'

     C                   MOVEA     '00'          *IN(91)
      *_____________
      * F5=Frisk opp
      *"""""""""""""
     C     *IN05         CABEQ     '1'           SRB1
      *_______
      * Valg ?
      *"""""""
     C                   EVAL      *IN52=*OFF
     C                   EVAL      *IN95=*OFF

     C     *IN03         CABEQ     '1'           SRB9
     C     *IN12         CABEQ     '1'           SRB3
     C                   GOTO      SRB1

     C                   ENDIF

     C     SRB9          ENDSR
