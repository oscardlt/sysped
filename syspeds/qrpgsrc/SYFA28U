********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11XXX * 01 SH  PTF11 utgangspunkt fra avdeling
11XXX * 02 SH  PTF11 dupliser skriver
********************************************************************
      *
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE SIGNATURS PRINTERSTYRING  ***
      *
n01  FKODTP     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FKODTPUSR  UF A E           K DISK
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E           K DISK
     FUTSKRS    IF   E           K DISK
     FSYFA28UFM CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D LN              S              2  0 DIM(20)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  KOPLPI                 1      2  0
     D  KOPLP2                 2      2  0
     D                 DS
     D  KOPDRAW                1      7
     D  KOPDR3                 1      3
     D                 DS
     D  KOPCOPI                1      6
     D  KOPCO2                 1      2
     D                 DS
     D  UTPTXT                 1     30
     D  UTTX22                 1     22
     D                UDS
     D  USYSPR               201    210
     C*
     C                   EXSR      INIT
     C*
     C*
     C* VEDLIKEHOLD AV PRINTERSTYRING
     C* HENTE UTSKRIFTTYPER
     C     START3        TAG
     C                   EXSR      HENTP
     C*
     C*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     C     ST1           TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   Z-ADD     *ZEROS        YLNR              3 0
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     KODTPK        SETLL     KODTPUSR
     C     ST2           TAG
     C     WSSG          READE(N)  KODTPUSR                               94
     C  N94WSSG          COMP      KOPUSR                             9494
      *
     C     ST3           TAG
      *
     C  N94              DO
     C                   DO        14
     C     KOPLNR        CHAIN     UTSKRS                             94
     C                   ADD       1             ZRECNO
     C                   WRITE     SUBFIL
     C     ST31          TAG
     C     WSSG          READE(N)  KODTPUSR                               94
     C  N94WSSG          COMP      KOPUSR                             9494
     C  N94              Z-ADD     KOPLNR        YLNR
     C  N94              END
     C                   END
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C     ST4           TAG
     C                   MOVEA     '11'          *IN(91)
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       98
     C*
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C*
     C*** FRISK OPP
     C   05              GOTO      ST1
     C*** SØK FRA UTSKRIFT TYPE
     C   08              GOTO      ST7
     C*** GÅ TIL SLUTT
     C   12              GOTO      SLUTT
     C*
     C*** BLA VIDERE
     C   25              DO
     C                   SETOFF                                       25
     C                   Z-ADD     YRECNO        ZRECNO
     C  N94KODTP3        SETLL     KODTPUSR
     C  N94WSSG          READE(N)  KODTPUSR                               94
     C                   GOTO      ST3
     C                   END
     C*
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
N02  C  N98              GOTO      ST1
     C                   END
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C                   GOTO      ST4
     C*
     C*** SØK FRA UTSKRIFTTYPE
     C     ST7           TAG
     C                   EXFMT     VAREL2
     C   12              GOTO      ST4
     C                   GOTO      ST1
     C*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C                   Z-ADD     0             LINNBR
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       14            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C     W2NR          IFEQ      '2'
     C                   SETON                                        99
     C                   EXSR      CHGP
     C   12              GOTO      SLHENT
     C                   END
     C     W2NR          IFEQ      '9'
     C                   SETON                                        99
     C                   EXSR      DUPLIS
     C   12              GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   SETOFF                                       99
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGP          BEGSR
     C***********************************************
     C                   MOVE      KOPTY         W2PTY
     C                   MOVE      KOPNVN        W2PNVN
     C                   MOVE      KOPLNR        WSPLNR
     C                   MOVE      KOPHEA        W2PHEA
     C                   MOVE      KOPFM         W2PFM
     C                   MOVE      KOPLAS        W2PLAS
     C                   MOVE      KOPLPI        W2LPI
     C                   movel     KOPDRAW       W2DRAW
     C                   movel     KOPOUTB       W2DRAU
     C                   movel     KOPCOPI       W2COPY
     C                   movel     KOPFOV1       W2FOV1
     C*
     C     STCHG         TAG
     C                   EXFMT     VARELI
     C                   MOVE      '0'           *IN90
     C                   MOVE      '0'           *IN30
     C                   MOVE      '0'           *IN70
     C   12              GOTO      SLCHG
     C     *IN04         IFEQ      '1'
     C                   MOVE      'S'           MODE              1
     C                   CALL      'SYFA08'
     C                   PARM                    MODE
     C                   PARM                    W2PFM
     C                   END
     C*
     C     W2PFM         IFNE      *BLANKS
     C     W2PFM         CHAIN     KODTFM                             90
     C   90              DO
     C                   MOVE      'SHU0559'     MSGNR
     C                   SETON                                        30
     C                   GOTO      STCHG
     C                   END
     C                   END
     C     W2PLAS        IFNE      'J'
     C     W2PLAS        ANDNE     'N'
     C     W2PLAS        ANDNE     ' '
     C     W2PLAS        ANDNE     'A'
     C     W2PLAS        ANDNE     'P'                                          PDF/Infoprint
     C     W2PLAS        ANDNE     'F'                                          AFP-direkte
     C     W2PLAS        ANDNE     'D'                                          AFP-direkte
     C                   MOVE      'SHU0560'     MSGNR
     C                   SETON                                        3070
     C                   GOTO      STCHG
     C                   END
      *
     C     W2PTY         IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVEL     '*STD'        W2PTY
     C                   END
     C     W2PNVN        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       W2PNVN
     C*                    MOVE USYSPR    W2PNVN
     C                   MOVEL     '*JOB'        W2PNVN
     C                   END
     C*
     C     KODTPK        CHAIN     KODTPUSR                           33
     C                   MOVE      W2PNVN        KOPNVN
     C                   MOVE      W2PHEA        KOPHEA
     C                   MOVE      W2PFM         KOPFM
     C                   MOVE      W2PLAS        KOPLAS
     C                   MOVE      W2PTY         KOPTY
     C                   MOVE      W2LPI         KOPLPI
     C                   movel     W2DRAW        KOPDRAW
     C                   movel     W2DRAU        KOPOUTB
     C                   movel     W2COPY        KOPCOPI
     C                   movel     W2FOV1        KOPFOV1
     C                   UPDATE    KOPUSRR
     C*
     C     SLCHG         TAG
     C     XLIN          IFEQ      0
     C                   Z-ADD     14            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   MOVE      ' '           W2NR
     C                   UPDATE    SUBFIL
     C                   MOVE      *BLANKS       W2PTY
     C                   MOVE      *BLANKS       W2PNVN
     C                   MOVE      *BLANKS       W2PHEA
     C                   MOVE      *BLANKS       W2PFM
     C                   MOVE      *BLANKS       W2PLAS
     C                   MOVE      *BLANKS       W2LPI
     C*
     C                   movel     *BLANKS       W2DRAW
     C                   movel     *BLANKS       W2DRAU
     C                   movel     *BLANKS       W2COPY
     C                   movel     *BLANKS       W2FOV1
     C                   ENDSR
N02  C***********************************************
N02  C     DUPLIS        BEGSR
N02  C***********************************************
N02  C                   setoff                                       33
N02  C                   MOVE      kopnvn        pnavn            10
N02  C                   move      *zeros        WSPLNR
N02  C     KODTPK        SETLL     KODTPUSR
N02  C     *in33         doweq     '0'
N02  C     WSSG          READE     KODTPUSR                               33
N02  C     *in33         ifeq      '0'
N02  C                   MOVE      Pnavn         kopnvn
N02  C                   UPDATE    kopusrr
N02  C                   endif
N02  c                   enddo
N02  C                   ENDSR
     C*
     C*
     C*
     C***********************************************
     C     HENTP         BEGSR
     C***********************************************
     C                   MOVE      80            WSPLNR            3 0
     C     WSPLNR        SETLL     UTSKRS
     C     STHP          TAG
     C                   SETOFF                                       33
     C                   READ      UTSKRS                                 33
     C  N33utpnr         comp      99                                 33
     C  N33              DO
     C                   MOVE      UTPNR         WSPLNR
     C     KODTPK        CHAIN     KODTPUSR                           33
     C                   MOVE      WSSG          KOPUSR
     C                   MOVE      WSPLNR        KOPLNR
s01  C*  33              MOVE      *BLANKS       KOPNVN
s01  C*  33              MOVEL     '*JOB'        KOPNVN
s01  C*  33              MOVE      ' '           KOPHEA
s01  C*  33              MOVE      UTPTY         KOPTY
s01  C*  33              MOVE      *BLANKS       KOPFM
s01  C*  33              MOVE      *BLANKS       KOPLAS
s01  C*  33              MOVE      *BLANKS       KOPLPI
s01  C*  33              movel     *blanks       KOPDRAW
s01  C*  33              movel     *blanks       KOPOUTB
s01  C*  33              movel     *blanks       KOPCOPI
s01  C*  33              movel     *blanks       KOPFOV1
n01  c   33avdkey        chain     kodtp                              34
     C   33              WRITE     KOPUSRR
     C  N33              UPDATE    KOPUSRR
     C                   GOTO      STHP
     C                   END
     C                   MOVE      *ZEROS        WSPLNR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     PMOVE         BEGSR
     C***********************************************
     C                   MOVE      WSSG          KOPUSR
     C                   MOVE      WSPLNR        KOPLNR
     C                   MOVE      XPNVN         KOPNVN
     C                   MOVE      XPHEA         KOPHEA
     C                   MOVE      XPTY          KOPTY
     C                   MOVE      XPFM          KOPFM
     C                   MOVE      XPLAS         KOPLAS
     C                   MOVE      XLPI          KOPLPI
     C                   MOVEL     XDRAW         KOPDRAW
     C                   MOVEL     XDRAU         KOPOUTB
     C                   MOVEL     XCOPY         KOPCOPI
     C                   MOVE      XFOV1         KOPFOV1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVEP         BEGSR
     C***********************************************
     C                   MOVE      KOPLNR        WSPLNR
     C                   MOVE      KOPNVN        XPNVN            10
     C                   MOVE      KOPHEA        XPHEA             1
     C                   MOVE      KOPTY         XPTY             10
     C                   MOVE      KOPFM         XPFM              5
     C                   MOVE      KOPLAS        XPLAS             1
     C                   MOVE      KOPLPI        XLPI              1 0
     C                   movel     KOPDRAW       XDRAW             2
     C                   movel     KOPOUTB       XDRAU             2
     C                   movel     KOPCOPI       XCOPY             2
     C                   movel     KOPFOV1       XFOV1             9
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
n01  C     AVDKEY        KLIST
n01  C                   KFLD                    KODE
n01  C                   KFLD                    avdel             4 0
n01  C                   KFLD                    utpnr
n01  C                   MOVE      'P'           KODE              1
     C     KODSFK        KLIST
     C                   KFLD                    WSSFUN
     C                   KFLD                    WSSG
     C                   MOVE      'SF'          WSSFUN            2
     C     KODTPK        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    WSPLNR
     C     KODTP3        KLIST
     C                   KFLD                    WSSG
     C                   KFLD                    YLNR
     C*
      *
     C     *ENTRY        PLIST
     C                   PARM                    USG               3
N01  C                   PARM                    uavd              4
     c                   move      usg           wssg              3
n01  c                   move      uavd          avdel             4 0
n01  c                   move      *zeros        koplpi
     C     KODSFK        CHAIN     KODTSF                             98
     C*
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C*
     C                   ENDSR
     C*
