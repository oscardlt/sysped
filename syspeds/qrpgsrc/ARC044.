********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 SH  PTF10 rettet feil i dette program
10XXX * 02 SH  PTF10 arc009cl nye parametre
10XXX * 03 SH  PTF10 merge J/N
      *
N03  Ffirmarc   IF   E           K DISK
     FSADH      IF   E           K DISK
     FSAEH      IF   E           K DISK
     FARUSERL1  IF   E           K DISK
     FARKTXT    IF   E           K DISK
     FARKEPO    UF A E           K DISK
     Ffirm      IF   E           K DISK
     FARKIVL02  IF   E           K DISK
     FARKVEDK   IF   E           K DISK
     FCUNDC03   IF   E           K DISK
     D                SDS
     D  UUSR                 254    263
     D                 DS
     D  uuvedl                 1     60
     D  V01                    1      2
     D  V02                    3      4
     D  V03                    5      6
     D  V04                    7      8
     D  V05                    9     10
     D  V06                   11     12
     D  V07                   13     14
     D  V08                   15     16
     D  V09                   17     18
     D  V10                   19     20
     D  V11                   21     22
     D  V12                   23     24
     D  V13                   25     26
     D  V14                   27     28
     D  V15                   29     30
     D  V16                   31     32
     D  V17                   33     34
     D  V18                   35     36
     D  V19                   37     38
     D  V20                   39     40
     D  V21                   41     42
     D  V22                   43     44
     D  V23                   45     46
     D  V24                   47     48
     D  V25                   49     50
     D  V26                   51     52
     D  V27                   53     54
     D  V28                   55     56
     D  V29                   57     58
     D  V30                   59     60
     D  ako                    1     60
     D                                     DIM(30)
      *
     C     *entry        plist
     c                   parm                    avd               4 0
     c                   parm                    opd               7 0
     c                   parm                    typein            2
      *
     C                   READ      FIRM                                   33
      *
N03  C                   READ      FIRMARC                                33
      *
     C     KEYVED        KLIST
     C                   KFLD                    FIFIRM
     C                   KFLD                    ARKUND
     C                   KFLD                    ARTYPE
     c     mailk         klist
     c                   kfld                    fifirm
     c                   kfld                    mail30
     c                   kfld                    tuknt             8 0
     C     KEYHEA        KLIST
     C                   KFLD                    ARAVD
     C                   KFLD                    AROPD
      *
     c     key           klist
     c                   kfld                    stat              1
     c                   kfld                    avd
     c                   kfld                    opd
     c                   kfld                    artype            2
     c                   move      'A'           stat              1
     c                   move      'si'          artype
     c     key           chain     ARKIVL02                           33
     c  N33keyhea        chain     sadh                               33
     C  N33              MOVE      'I'           TDTYP             1
     c     *in33         ifeq      '1'
     c                   move      'se'          artype
     c     key           chain     ARKIVL02                           33
     c  N33keyhea        chain     saeh                               33
     C  N33              MOVE      'E'           TDTYP             1
     c                   end
     c  N33              exsr      pdfsad
     C                   SETON                                        LR
     C                   RETURN
     C***********************************************
     C     PDFSad        BEGSR
     C***********************************************
     C     ARTYPE        CHAIN     ARKTXT                             33
     c                   move      arkund        tuknt
      * SKJEKK OM AVTALE OM VEDLEGG
N01  C                   MOVE      ARKVED        uuvedl
     C     KEYVED        CHAIN     ARKVEDK                            33
     C     *IN33         IFEQ      '0'
N01  C                   MOVE      AVKVED        uuvedl
N01  C                   END
N01  C     UUVEDL        IFNE      *blanks
     C     TYPEIN        LOOKUP    ako                                    30
S01  C* N30              DO
N01  C   30              DO
      *
S01  C*    *IN33         IFEQ      '0'
     C
     C                   MOVE      ARTXT         MAIL16           16
     C                   MOVEL     '*'           MAIL16
     c                   movel     MAIL16        mail30           30
     c                   moveL     artxt         wstex1           30
     c                   setoff                                       44
     c     mailk         chain     cundc03                            44
     c     *in(44)       ifeq      '0'
      *
N03  C     CMERGE        IFNE      ' '
N03  C                   MOVE      CMERGE        ARCMRG
N03  C                   END
      * coverpage
      *
     C                   move      *blanks       wscvp1
     C                   eval      wscvp1='Tolldokument:'
     C     TDTYP         IFEQ      'I'
     C     wscvp1        cat       SITLE:1       wscvp1
     C     wscvp1        cat       SITLL:0       wscvp1
     c                   else
     C     wscvp1        cat       SETLE:1       wscvp1
     C     wscvp1        cat       SETLL:0       wscvp1
     c                   end
     C                   MOVE      ARAVD         AAVD              4
     C                   MOVE      AROPD         AOPD              7
     C     CEMAIL        CHAIN     ARUSERL1                           33
     C                   CALL      'ARC002V'
     C                   PARM                    ARTYPE
     C                   PARM                    Aavd
     C                   PARM                    Aopd
     C                   PARM                    ARKVED
     C                   PARM                    CLIVE
     C                   PARM                    arinek
     C                   PARM                    tuknt
      *
N02  C                   MOVE      tuknt         AKUN              8
N02  C                   MOVE      *ZEROS        ATUR              8
     c                   call      'ARC009CL'
     c                   parm                    CEMAIL
     c                   parm                    wscvp1           80
     c                   parm                    wscvp2           40
     c                   parm                    wscvp3           40
     c                   parm                    wscvp4           40
     C                   parm                    wscvp5           40
     C                   parm                    wscvp6           40
     C                   parm                    wscvp7           40
     C                   parm                    wscvp8           40
     C                   parm                    ARINEK
N02  C                   PARM                    AAVD
N02  C                   PARM                    AOPD
N02  C                   PARM                    ATUR              8
N02  C                   PARM                    AKUN              8
N03  C                   PARM                    ARCMRG            1
     c                   eval      wscvp3 = '.'
s01  c*                  end
     c                   end
     c                   end
     c                   end
     C                   ENDSR
     C*
