********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
12XXX * 01 YBC PTF12 Ordinær sats = 0 -> Beregningsmåte settes til F
********************************************************************
      * 21069060, 21069093, 21069098, 35019010, 35022090 dobbel sats
     H DFTACTGRP(*NO)
      *
      ***********************************************************
      *** PROGRAM SKAL KONVERTER TOLLSATS FRA TVINN           ***
      ***********************************************************
      *
     FXMLRCAF   IF   E           K DISK
     FXMLRCVF   IF   E           K DISK
     FTARINY    UF A E           K DISK
     FTARI      IF   E           K DISK    RENAME(TARIR:TARIRG)
     F                                     PREFIX(G_)
     FTARIKAP   IF   F   19     4AIDISK    KEYLOC(1)
     FKODTS2    IF   E           K DISK
      *
     D                sds
     D ZUSER                 254    263
     D                UDS
     D  UDATO                101    108  0
     D                 ds
     D xsats82                 1      8  2
     D xsats                   2      8  2
      *  Prototype for syti07r
     d syti07r         pr
     d usn_                                like(usn)
     d uok_                                like(uok)
      *  *ENTRY Interface for Main Procedure
     d syti07r         pi
     d usn                            9
     d uok                            1
      *  Prototype for 'SYGE15C'
     d syge15c         pr                  extpgm('SYGE15C')
     d wdt_                                like(wdt)
     d wtm_                                like(wtm)
      *----------------------------------------------------------------------
      * Stand Alone Fields - TOP
      *----------------------------------------------------------------------
     d wdt             s              8
     d wtm             s              6
     d xidag           s              8s 0
     d xan08           s              8A
     d xlandgr         s              5A
     d xenhet          s              1A
     d xfomdato        s              8s 0
     d pfomdato        s              8s 0
     d xtomdato        s              8s 0
     d ptomdato        s              8s 0
     d x1_xrlev1       s                   like(xrlev1)
     d x1_xrlev2       s                   like(xrlev2)
     d x2_xrlev1       s                   like(xrlev1)
     d x2_xrlev2       s                   like(xrlev2)
     d x2_xrlev3       s                   like(xrlev3)
     d x3_xrlev1       s                   like(xrlev1)
     d x3_xrlev2       s                   like(xrlev2)
     d x3_xrlev3       s                   like(xrlev3)
     d x3_xrlev4       s                   like(xrlev4)
     d x4_xrlev1       s                   like(xrlev1)
     d x4_xrlev2       s                   like(xrlev2)
     d x4_xrlev3       s                   like(xrlev3)
     d x4_xrlev4       s                   like(xrlev4)
     d x4_xrlev5       s                   like(xrlev5)
     d x5_xrlev1       s                   like(xrlev1)
     d x5_xrlev2       s                   like(xrlev2)
     d x5_xrlev3       s                   like(xrlev3)
     d x5_xrlev4       s                   like(xrlev4)
     d x5_xrlev5       s                   like(xrlev5)
     d x5_xrlev6       s                   like(xrlev6)
     d x_tatanr        s                   like(tatanr)
     d x_taalfa        s                   like(taalfa)
     d x_tatxt         s                   like(tatxt)
     d x_taordk        s                   like(taordk)
     d x_taordb        s                   like(taordb)
     d x_taeftk        s                   like(taeftk)
     d x_taeftb        s                   like(taeftb)
     d x_taefk         s                   like(taefk)
     d x_taefb         s                   like(taefb)
     d x_tastk         s                   like(tastk)
     d x_taenhe        s                   like(taenhe)
     d x_taeØsk        s                   like(taeØsk)
     d x_taeØsb        s                   like(taeØsb)
     d x_tatsjk        s                   like(tatsjk)
     d x_tatsjb        s                   like(tatsjb)
     d x_tatyrk        s                   like(tatyrk)
     d x_tatyrb        s                   like(tatyrb)
     d x_taisrk        s                   like(taisrk)
     d x_taisrb        s                   like(taisrb)
     d x_taellk        s                   like(taellk)
     d x_taellb        s                   like(taellb)
     d x_tabulk        s                   like(tabulk)
     d x_tabulb        s                   like(tabulb)
     d x_tapolk        s                   like(tapolk)
     d x_tapolb        s                   like(tapolb)
     d x_taromk        s                   like(taromk)
     d x_taromb        s                   like(taromb)
     d x_taungk        s                   like(taungk)
     d x_taungb        s                   like(taungb)
     d x_taslok        s                   like(taslok)
     d x_taslob        s                   like(taslob)
     d x_tamulk        s                   like(tamulk)
     d x_tamulb        s                   like(tamulb)
     d x_taoulk        s                   like(taoulk)
     d x_taoulb        s                   like(taoulb)
     d x_tagrlk        s                   like(tagrlk)
     d x_tagrlb        s                   like(tagrlb)
     d x_tafÆrk        s                   like(tafÆrk)
     d x_tafÆrb        s                   like(tafÆrb)
     d x_taistk        s                   like(taistk)
     d x_taistb        s                   like(taistb)
     d x_tamark        s                   like(tamark)
     d x_tamarb        s                   like(tamarb)
     d x_tamexk        s                   like(tamexk)
     d x_tamexb        s                   like(tamexb)
     d x_tavgak        s                   like(tavgak)
     d x_tavgab        s                   like(tavgab)
     d x_tan01k        s                   like(tan01k)
     d x_tan01b        s                   like(tan01b)
     d x_tan02k        s                   like(tan02k)
     d x_tan02b        s                   like(tan02b)
     d x_tan03k        s                   like(tan03k)
     d x_tan03b        s                   like(tan03b)
     d x_tan04k        s                   like(tan04k)
     d x_tan04b        s                   like(tan04b)
     d x_tan05k        s                   like(tan05k)
     d x_tan05b        s                   like(tan05b)
     d x_tan06k        s                   like(tan06k)
     d x_tan06b        s                   like(tan06b)
     d x_tan07k        s                   like(tan07k)
     d x_tan07b        s                   like(tan07b)
     d x_tan08k        s                   like(tan08k)
     d x_tan08b        s                   like(tan08b)
     d x_tan09k        s                   like(tan09k)
     d x_tan09b        s                   like(tan09b)
     d x_tan10k        s                   like(tan10k)
     d x_tan10b        s                   like(tan10b)
     d x_tan11k        s                   like(tan11k)
     d x_tan11b        s                   like(tan11b)
     d x_tan12k        s                   like(tan12k)
     d x_tan12b        s                   like(tan12b)
     d x_tan13k        s                   like(tan13k)
     d x_tan13b        s                   like(tan13b)
     d x_tan14k        s                   like(tan14k)
     d x_tan14b        s                   like(tan14b)
     d x_tan15k        s                   like(tan15k)
     d x_tan15b        s                   like(tan15b)
     d x_tan16k        s                   like(tan16k)
     d x_tan16b        s                   like(tan16b)
     d x_tan17k        s                   like(tan17k)
     d x_tan17b        s                   like(tan17b)
     d x_tan18k        s                   like(tan18k)
     d x_tan18b        s                   like(tan18b)
     d x_tan19k        s                   like(tan19k)
     d x_tan19b        s                   like(tan19b)
     d x_tan20k        s                   like(tan20k)
     d x_tan20b        s                   like(tan20b)
     d x_tan21k        s                   like(tan21k)
     d x_tan21b        s                   like(tan21b)
     d x_tan22k        s                   like(tan22k)
     d x_tan22b        s                   like(tan22b)
     d x_tan23k        s                   like(tan23k)
     d x_tan23b        s                   like(tan23b)
     d x_tan24k        s                   like(tan24k)
     d x_tan24b        s                   like(tan24b)
     d x_tan25k        s                   like(tan25k)
     d x_tan25b        s                   like(tan25b)
     d x_tan26k        s                   like(tan26k)
     d x_tan26b        s                   like(tan26b)
     d p_taordk        s                   like(taordk)
     d p_taordb        s                   like(taordb)
     d p_taeftk        s                   like(taeftk)
     d p_taeftb        s                   like(taeftb)
     d p_taefk         s                   like(taefk)
     d p_taefb         s                   like(taefb)
     d p_tastk         s                   like(tastk)
     d p_taenhe        s                   like(taenhe)
     d p_taeØsk        s                   like(taeØsk)
     d p_taeØsb        s                   like(taeØsb)
     d p_tatsjk        s                   like(tatsjk)
     d p_tatsjb        s                   like(tatsjb)
     d p_tatyrk        s                   like(tatyrk)
     d p_tatyrb        s                   like(tatyrb)
     d p_taisrk        s                   like(taisrk)
     d p_taisrb        s                   like(taisrb)
     d p_taellk        s                   like(taellk)
     d p_taellb        s                   like(taellb)
     d p_tabulk        s                   like(tabulk)
     d p_tabulb        s                   like(tabulb)
     d p_tapolk        s                   like(tapolk)
     d p_tapolb        s                   like(tapolb)
     d p_taromk        s                   like(taromk)
     d p_taromb        s                   like(taromb)
     d p_taungk        s                   like(taungk)
     d p_taungb        s                   like(taungb)
     d p_taslok        s                   like(taslok)
     d p_taslob        s                   like(taslob)
     d p_tamulk        s                   like(tamulk)
     d p_tamulb        s                   like(tamulb)
     d p_taoulk        s                   like(taoulk)
     d p_taoulb        s                   like(taoulb)
     d p_tagrlk        s                   like(tagrlk)
     d p_tagrlb        s                   like(tagrlb)
     d p_tafÆrk        s                   like(tafÆrk)
     d p_tafÆrb        s                   like(tafÆrb)
     d p_taistk        s                   like(taistk)
     d p_taistb        s                   like(taistb)
     d p_tamark        s                   like(tamark)
     d p_tamarb        s                   like(tamarb)
     d p_tamexk        s                   like(tamexk)
     d p_tamexb        s                   like(tamexb)
     d p_tavgak        s                   like(tavgak)
     d p_tavgab        s                   like(tavgab)
     d p_tan01k        s                   like(tan01k)
     d p_tan01b        s                   like(tan01b)
     d p_tan02k        s                   like(tan02k)
     d p_tan02b        s                   like(tan02b)
     d p_tan03k        s                   like(tan03k)
     d p_tan03b        s                   like(tan03b)
     d p_tan04k        s                   like(tan04k)
     d p_tan04b        s                   like(tan04b)
     d p_tan05k        s                   like(tan05k)
     d p_tan05b        s                   like(tan05b)
     d p_tan06k        s                   like(tan06k)
     d p_tan06b        s                   like(tan06b)
     d p_tan07k        s                   like(tan07k)
     d p_tan07b        s                   like(tan07b)
     d p_tan08k        s                   like(tan08k)
     d p_tan08b        s                   like(tan08b)
     d p_tan09k        s                   like(tan09k)
     d p_tan09b        s                   like(tan09b)
     d p_tan10k        s                   like(tan10k)
     d p_tan10b        s                   like(tan10b)
     d p_tan11k        s                   like(tan11k)
     d p_tan11b        s                   like(tan11b)
     d p_tan12k        s                   like(tan12k)
     d p_tan12b        s                   like(tan12b)
     d p_tan13k        s                   like(tan13k)
     d p_tan13b        s                   like(tan13b)
     d p_tan14k        s                   like(tan14k)
     d p_tan14b        s                   like(tan14b)
     d p_tan15k        s                   like(tan15k)
     d p_tan15b        s                   like(tan15b)
     d p_tan16k        s                   like(tan16k)
     d p_tan16b        s                   like(tan16b)
     d p_tan17k        s                   like(tan17k)
     d p_tan17b        s                   like(tan17b)
     d p_tan18k        s                   like(tan18k)
     d p_tan18b        s                   like(tan18b)
     d p_tan19k        s                   like(tan19k)
     d p_tan19b        s                   like(tan19b)
     d p_tan20k        s                   like(tan20k)
     d p_tan20b        s                   like(tan20b)
     d p_tan21k        s                   like(tan21k)
     d p_tan21b        s                   like(tan21b)
     d p_tan22k        s                   like(tan22k)
     d p_tan22b        s                   like(tan22b)
     d p_tan23k        s                   like(tan23k)
     d p_tan23b        s                   like(tan23b)
     d p_tan24k        s                   like(tan24k)
     d p_tan24b        s                   like(tan24b)
     d p_tan25k        s                   like(tan25k)
     d p_tan25b        s                   like(tan25b)
     d p_tan26k        s                   like(tan26k)
     d p_tan26b        s                   like(tan26b)
     D UP              C                   CONST('ABCDEFGHIJKLMNOPQRST-
     D                                     UVWXYZÆØÅ')
     D LO              C                   CONST('abcdefghijklmnopqrst-
     D                                     uvwxyzæøå')
     ITARIKAP   NS  02
     I                                  5   19  NYALFA

      *----------------------------------------------------------------------
      /free

       exsr init;

       exsr srxml1;

       *inlr = *on;
       return;

       //**********************************************                ------
       begsr srxml1;
       //**********************************************

         X1_XRLEV1 = 1;
         X1_XRLEV2 = 0;

         chain (xrsn:x1_xrlev1:x1_xrlev2) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'versjon';
           when xrnv = 'vare';
             exsr srxml2;
           endsl;
           x1_xrlev1 = x1_xrlev1 + 1;
           chain (xrsn:x1_xrlev1:x1_xrlev2) xmlrcvf;
         enddo;

         endsr;

       //**********************************************
       begsr srxml2;
       //**********************************************

         clear tarir;

         x2_xrlev1 = xrlev1;
         x2_xrlev2 = 1;
         x2_xrlev3 = 0;

         chain (xrsn:x2_xrlev1:x2_xrlev2:x2_xrlev3) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'id';
             x_tatanr = %dec(xrverd:8:0);
           //if x_tatanr = 8112092;
           //  x_tatanr = %dec(xrverd:8:0);
           //endif;
           when xrnv = 'enhet';
             select;
             when xrverd = 'Kg' or xrverd = 'K';
               x_taordk = 'V';
             when xrverd = 'P';
               x_taordk = 'P';
             when xrverd = 'S';
               x_taordk = 'A';
             endsl;
           when xrnv = 'enhetBeskrivelse';
           when xrnv = 'annenEnhet';
             if xrverd <> *blanks;
               x_tastk = 'J';
               x_taenhe = xrverd;
             endif;
           when xrnv = 'annenEnhetBeskrivelse';
           when xrnv = 'avtalesatser';
             exsr srxml3;
           endsl;
           x2_xrlev2 = x2_xrlev2 + 1;
           chain (xrsn:x2_xrlev1:x2_xrlev2:x2_xrlev3) xmlrcvf;
         enddo;

         if uok = 'J' and xfomdato <= xidag;
           exsr opdtar;
         endif;

       endsr;

       //**********************************************
       begsr srxml3;
       //**********************************************

         uok = 'J';

         x3_xrlev1 = xrlev1;
         x3_xrlev2 = xrlev2;
         x3_xrlev3 = 1;
         x3_xrlev4 = 0;

         chain (xrsn:x3_xrlev1:x3_xrlev2:x3_xrlev3:x3_xrlev4) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'avtale';
             exsr srxml4;
           endsl;
           x3_xrlev3 = x3_xrlev3 + 1;
           chain (xrsn:x3_xrlev1:x3_xrlev2:x3_xrlev3:x3_xrlev4) xmlrcvf;
         enddo;

       endsr;

       //**********************************************
       begsr srxml4;
       //**********************************************

         x4_xrlev1 = xrlev1;
         x4_xrlev2 = xrlev2;
         x4_xrlev3 = xrlev3;
         x4_xrlev4 = 1;
         x4_xrlev5 = 0;

         chain (xrsn:x4_xrlev1:x4_xrlev2:x4_xrlev3:x4_xrlev4:x4_xrlev5)
               xmlrcvf;
         dow %found;
           select;
           when xrnv = 'landgruppe';
             xlandgr = xrverd;
           when xrnv = 'sats';
             exsr srxml5;
             leave;
           endsl;
           x4_xrlev4 = x4_xrlev4 + 1;
           chain (xrsn:x4_xrlev1:x4_xrlev2:x4_xrlev3:x4_xrlev4:x4_xrlev5)
                 xmlrcvf;
         enddo;

       endsr;

       //**********************************************
       begsr srxml5;
       //**********************************************

         x5_xrlev1 = xrlev1;
         x5_xrlev2 = xrlev2;
         x5_xrlev3 = xrlev3;
         x5_xrlev4 = xrlev4;
         x5_xrlev5 = 1;
         x5_xrlev6 = 0;

         chain (xrsn:x5_xrlev1:x5_xrlev2:x5_xrlev3:x5_xrlev4:x5_xrlev5
               :x5_xrlev6) xmlrcvf;
         dow %found;
           select;
           when xrnv = 'satsVerdi';
             xsats82 = %dec(xrverd:8:2);
             //if xlandgr = 'TALL';
             //  x_taordb = xsats;
             //endif;
           when xrnv = 'satsEnhet';
             select;
N01          when xsats = 0;
N01            xenhet = 'F';
             when xrverd = 'K';
               xenhet = 'V';
             when xrverd = 'S' or xrverd = 'L';
               xenhet = 'A';
             when xrverd = 'P';
               xenhet = 'P';
             when xrverd = 'H';
               xenhet = 'W';
S01        //when xsats = 0;
S01        //  xenhet = 'F';
             other;
               xenhet = 'V';
             endsl;
             if xlandgr = 'TALL';
               if (x_tatanr = 21069060 or x_tatanr = 21069093 or
                   x_tatanr = 21069098 or x_tatanr = 35019010 or
                   x_tatanr = 35022090) and xenhet = 'P';
                 p_taordk = xenhet;
                 p_taordb = xsats;
               else;
                 x_taordk = xenhet;
                 x_taordb = xsats;
               endif;
             endif;
           when xrnv = 'fomdato';
             if xlandgr = 'TALL';
               xan08 = %subst(xrverd:1:4) + %subst(xrverd:6:2)
                     + %subst(xrverd:9:2);
               if (x_tatanr = 21069060 or x_tatanr = 21069093 or
                   x_tatanr = 21069098 or x_tatanr = 35019010 or
                   x_tatanr = 35022090) and xenhet = 'P';
                 pfomdato = %dec(xan08:8:0);
               else;
                 xfomdato = %dec(xan08:8:0);
               endif;
             endif;
           when xrnv = 'tomdato';
             if xlandgr = 'TALL';
               if (x_tatanr = 21069060 or x_tatanr = 21069093 or
                   x_tatanr = 21069098 or x_tatanr = 35019010 or
                   x_tatanr = 35022090) and xenhet = 'P';
                 if xrverd = *blanks;
                   ptomdato = 0;
                 else;
                   xan08 = %subst(xrverd:1:4) + %subst(xrverd:6:2)
                         + %subst(xrverd:9:2);
                   ptomdato = %dec(xan08:8:0);
                 endif;
               else;
                 if xrverd = *blanks;
                   xtomdato = 0;
                 else;
                   xan08 = %subst(xrverd:1:4) + %subst(xrverd:6:2)
                         + %subst(xrverd:9:2);
                   xtomdato = %dec(xan08:8:0);
                 endif;
               endif;
             endif;
           endsl;
           x5_xrlev5 = x5_xrlev5 + 1;
           chain (xrsn:x5_xrlev1:x5_xrlev2:x5_xrlev3:x5_xrlev4:x5_xrlev5
                 :x5_xrlev6) xmlrcvf;
         enddo;

         if (x_tatanr = 21069060 or x_tatanr = 21069093 or
             x_tatanr = 21069098 or x_tatanr = 35019010 or
             x_tatanr = 35022090) and xenhet = 'P';
           select;
           //when xlandgr = 'TALL';            //Alle land/ordinær
           //  x_taordb = xsats;
           when xlandgr = 'TEF';             //EU-land
             if xenhet = *blanks;
               p_taefk = p_taordk;
             else;
               p_taefk = xenhet;
             endif;
             p_taefb = xsats;
           when xlandgr = 'TEFT';            //EFTA-land
             if xenhet = *blanks;
               p_taeftk = p_taordk;
             else;
               p_taeftk = xenhet;
             endif;
             p_taeftb = xsats;
           when xlandgr = 'TIST';            //IN, LK, TH. India, Srilanka, Thailand
             if xenhet = *blanks;
               p_taistk = p_taordk;
             else;
               p_taistk = xenhet;
             endif;
             p_taistb = xsats;
           when xlandgr = 'TGCC';            //SA, AE, QA, BH, KW, OM. Gulf-land
             if xenhet = *blanks;
               p_tan13k = p_taordk;
             else;
               p_tan13k = xenhet;
             endif;
             p_tan13b = xsats;
           when xlandgr = 'TGS1';            //Minst utviklede land
             if xenhet = *blanks;
               p_tamulk = p_taordk;
             else;
               p_tamulk = xenhet;
             endif;
             p_tamulb = xsats;
           when xlandgr = 'TGS2';            //Ordinære utviklingsland
             if xenhet = *blanks;
               p_taoulk = p_taordk;
             else;
               p_taoulk = xenhet;
             endif;
             p_taoulb = xsats;
           when xlandgr = 'TGS7' or xlandgr = 'TGS8' or xlandgr = 'TGS9';  //BW, NA, SZ
             if xenhet = *blanks;
               p_tan11k = p_taordk;
             else;
               p_tan11k = xenhet;
             endif;
             p_tan11b = xsats;
           when xlandgr = 'TGSP';            //GSP-land, lavere mellominnteksland
             if xenhet = *blanks;
               p_tan12k = p_taordk;
             else;
               p_tan12k = xenhet;
             endif;
             p_tan12b = xsats;
           when xlandgr = 'TH';              //GL. Grønland
             if xenhet = *blanks;
               p_tagrlk = p_taordk;
             else;
               p_tagrlk = xenhet;
             endif;
             p_tagrlb = xsats;
           when xlandgr = 'TI';              //FO, Færøyene
             if xenhet = *blanks;
               p_tafÆrk = p_taordk;
             else;
               p_tafÆrk = xenhet;
             endif;
             p_tafÆrb = xsats;
           when xlandgr = 'TOES';            //EØS-land
             if xenhet = *blanks;
               p_taeØsk = p_taordk;
             else;
               p_taeØsk = xenhet;
             endif;
             p_taeØsb = xsats;
           when xlandgr = 'TSAC';            //BW, NA, SZ, ZA, LS. SACU-land
             if xenhet = *blanks;
               p_tan02k = p_taordk;
             else;
               p_tan02k = xenhet;
             endif;
             p_tan02b = xsats;
           when xlandgr = 'TTYR';            //TR, Tyrkia
             if xenhet = *blanks;
               p_tatyrk = p_taordk;
             else;
               p_tatyrk = xenhet;
             endif;
             p_tatyrb = xsats;
           when xlandgr = 'TXI';             //PS. Vestbreddeb og Gazastripen
             if xenhet = *blanks;
               p_tavgak = p_taordk;
             else;
               p_tavgak = xenhet;
             endif;
             p_tavgab = xsats;
           when xlandgr = 'TSZ';             //Swaziland
             if xenhet = *blanks;
               p_tatsjk = p_taordk;
             else;
               p_tatsjk = xenhet;
             endif;
             p_tatsjb = xsats;
           when xlandgr = 'TCL';             //Chile
             if xenhet = *blanks;
               p_tabulk = p_taordk;
             else;
               p_tabulk = xenhet;
             endif;
             p_tabulb = xsats;
           when xlandgr = 'TMK';             //Nord-Makedonia
             if xenhet = *blanks;
               p_tapolk = p_taordk;
             else;
               p_tapolk = xenhet;
             endif;
             p_tapolb = xsats;
           when xlandgr = 'TKR';             //SØR-KOREA
             if xenhet = *blanks;
               p_taromk = p_taordk;
             else;
               p_taromk = xenhet;
             endif;
             p_taromb = xsats;
           when xlandgr = 'TRS';             //Serbia
             if xenhet = *blanks;
               p_tan05k = p_taordk;
             else;
               p_tan05k = xenhet;
             endif;
             p_tan05b = xsats;
           when xlandgr = 'TAL';             //Albania
             if xenhet = *blanks;
               p_tan06k = p_taordk;
             else;
               p_tan06k = xenhet;
             endif;
             p_tan06b = xsats;
           when xlandgr = 'TUA';             //UKRAINA
             if xenhet = *blanks;
               p_tan07k = p_taordk;
             else;
               p_tan07k = xenhet;
             endif;
             p_tan07b = xsats;
           when xlandgr = 'TJO';             //Jordan
             if xenhet = *blanks;
               p_taungk = p_taordk;
             else;
               p_taungk = xenhet;
             endif;
             p_taungb = xsats;
           when xlandgr = 'TTN';             //TUNISIA
             if xenhet = *blanks;
               p_taslok = p_taordk;
             else;
               p_taslok = xenhet;
             endif;
             p_taslob = xsats;
           when xlandgr = 'TMA';             //Marokko
             if xenhet = *blanks;
               p_tamark = p_taordk;
             else;
               p_tamark = xenhet;
             endif;
             p_tamarb = xsats;
           when xlandgr = 'TPE';             //Peru
             if xenhet = *blanks;
               p_tan08k = p_taordk;
             else;
               p_tan08k = xenhet;
             endif;
             p_tan08b = xsats;
           when xlandgr = 'TME';             //Montenegro
             if xenhet = *blanks;
               p_tan09k = p_taordk;
             else;
               p_tan09k = xenhet;
             endif;
             p_tan09b = xsats;
           when xlandgr = 'THK';             //Hongkong
             if xenhet = *blanks;
               p_tan10k = p_taordk;
             else;
               p_tan10k = xenhet;
             endif;
             p_tan10b = xsats;
           when xlandgr = 'TMX';             //Mexico
             if xenhet = *blanks;
               p_tamexk = p_taordk;
             else;
               p_tamexk = xenhet;
             endif;
             p_tamexb = xsats;
           when xlandgr = 'TLB';             //Libanon
             if xenhet = *blanks;
               p_tan01k = p_taordk;
             else;
               p_tan01k = xenhet;
             endif;
             p_tan01b = xsats;
           when xlandgr = 'TEG';             //Egypt
             if xenhet = *blanks;
               p_tan03k = p_taordk;
             else;
               p_tan03k = xenhet;
             endif;
             p_tan03b = xsats;
           when xlandgr = 'TCA';             //Canada
             if xenhet = *blanks;
               p_tan04k = p_taordk;
             else;
               p_tan04k = xenhet;
             endif;
             p_tan04b = xsats;
           when xlandgr = 'TPA';             //Panama
             if xenhet = *blanks;
               p_tan14k = p_taordk;
             else;
               p_tan14k = xenhet;
             endif;
             p_tan14b = xsats;
           when xlandgr = 'TCR';             //Costa Rica
             if xenhet = *blanks;
               p_tan15k = p_taordk;
             else;
               p_tan15k = xenhet;
             endif;
             p_tan15b = xsats;
           when xlandgr = 'TCO';             //Columbia
             if xenhet = *blanks;
               p_tan16k = p_taordk;
             else;
               p_tan16k = xenhet;
             endif;
             p_tan16b = xsats;
           when xlandgr = 'TBA';             //BOSNIA-HERCEGOVINA
             if xenhet = *blanks;
               p_tan17k = p_taordk;
             else;
               p_tan17k = xenhet;
             endif;
             p_tan17b = xsats;
           when xlandgr = 'TGE';             //Georgia
             if xenhet = *blanks;
               p_tan18k = p_taordk;
             else;
               p_tan18k = xenhet;
             endif;
             p_tan18b = xsats;
           when xlandgr = 'TIL';             //Israel
             if xenhet = *blanks;
               p_taisrk = p_taordk;
             else;
               p_taisrk = xenhet;
             endif;
             p_taisrb = xsats;
           when xlandgr = 'TPH';             //Filippinene
             if xenhet = *blanks;
               p_tan19k = p_taordk;
             else;
               p_tan19k = xenhet;
             endif;
             p_tan19b = xsats;
           when xlandgr = 'TGB';             //Storbritania
             if xenhet = *blanks;
               p_tan20k = p_taordk;
             else;
               p_tan20k = xenhet;
             endif;
             p_tan20b = xsats;
           when xlandgr = 'TID';             //Indonesia
             if xenhet = *blanks;
               p_tan22k = p_taordk;
             else;
               p_tan22k = xenhet;
             endif;
             p_tan22b = xsats;
           when xlandgr = 'TEC';             //ECUADOR
             if xenhet = *blanks;
               p_tan23k = p_taordk;
             else;
               p_tan23k = xenhet;
             endif;
             p_tan23b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               p_tan24k = p_taordk;
             else;
               p_tan24k = xenhet;
             endif;
             p_tan24b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               p_tan25k = p_taordk;
             else;
               p_tan25k = xenhet;
             endif;
             p_tan25b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               p_tan26k = p_taordk;
             else;
               p_tan26k = xenhet;
             endif;
             p_tan26b = xsats;
           endsl;
         else;
           select;
           //when xlandgr = 'TALL';            //Alle land/ordinær
           //  x_taordb = xsats;
           when xlandgr = 'TEF';             //EU-land
             if xenhet = *blanks;
               x_taefk = x_taordk;
             else;
               x_taefk = xenhet;
             endif;
             x_taefb = xsats;
           when xlandgr = 'TEFT';            //EFTA-land
             if xenhet = *blanks;
               x_taeftk = x_taordk;
             else;
               x_taeftk = xenhet;
             endif;
             x_taeftb = xsats;
           when xlandgr = 'TIST';            //IN, LK, TH. India, Srilanka, Thailand
             if xenhet = *blanks;
               x_taistk = x_taordk;
             else;
               x_taistk = xenhet;
             endif;
             x_taistb = xsats;
           when xlandgr = 'TGCC';            //SA, AE, QA, BH, KW, OM. Gulf-land
             if xenhet = *blanks;
               x_tan13k = x_taordk;
             else;
               x_tan13k = xenhet;
             endif;
             x_tan13b = xsats;
           when xlandgr = 'TGS1';            //Minst utviklede land
             if xenhet = *blanks;
               x_tamulk = x_taordk;
             else;
               x_tamulk = xenhet;
             endif;
             x_tamulb = xsats;
           when xlandgr = 'TGS2';            //Ordinære utviklingsland
             if xenhet = *blanks;
               x_taoulk = x_taordk;
             else;
               x_taoulk = xenhet;
             endif;
             x_taoulb = xsats;
           when xlandgr = 'TGS7' or xlandgr = 'TGS8' or xlandgr = 'TGS9';  //BW, NA, SZ
             if xenhet = *blanks;
               x_tan11k = x_taordk;
             else;
               x_tan11k = xenhet;
             endif;
             x_tan11b = xsats;
           when xlandgr = 'TGSP';            //GSP-land, lavere mellominnteksland
             if xenhet = *blanks;
               x_tan12k = x_taordk;
             else;
               x_tan12k = xenhet;
             endif;
             x_tan12b = xsats;
           when xlandgr = 'TH';              //GL. Grønland
             if xenhet = *blanks;
               x_tagrlk = x_taordk;
             else;
               x_tagrlk = xenhet;
             endif;
             x_tagrlb = xsats;
           when xlandgr = 'TI';              //FO, Færøyene
             if xenhet = *blanks;
               x_tafÆrk = x_taordk;
             else;
               x_tafÆrk = xenhet;
             endif;
             x_tafÆrb = xsats;
           when xlandgr = 'TOES';            //EØS-land
             if xenhet = *blanks;
               x_taeØsk = x_taordk;
             else;
               x_taeØsk = xenhet;
             endif;
             x_taeØsb = xsats;
           when xlandgr = 'TSAC';            //BW, NA, SZ, ZA, LS. SACU-land
             if xenhet = *blanks;
               x_tan02k = x_taordk;
             else;
               x_tan02k = xenhet;
             endif;
             x_tan02b = xsats;
           when xlandgr = 'TTYR';            //TR, Tyrkia
             if xenhet = *blanks;
               x_tatyrk = x_taordk;
             else;
               x_tatyrk = xenhet;
             endif;
             x_tatyrb = xsats;
           when xlandgr = 'TXI';             //PS. Vestbreddeb og Gazastripen
             if xenhet = *blanks;
               x_tavgak = x_taordk;
             else;
               x_tavgak = xenhet;
             endif;
             x_tavgab = xsats;
           when xlandgr = 'TSZ';             //Swaziland
             if xenhet = *blanks;
               x_tatsjk = x_taordk;
             else;
               x_tatsjk = xenhet;
             endif;
             x_tatsjb = xsats;
           when xlandgr = 'TCL';             //Chile
             if xenhet = *blanks;
               x_tabulk = x_taordk;
             else;
               x_tabulk = xenhet;
             endif;
             x_tabulb = xsats;
           when xlandgr = 'TMK';             //Nord-Makedonia
             if xenhet = *blanks;
               x_tapolk = x_taordk;
             else;
               x_tapolk = xenhet;
             endif;
             x_tapolb = xsats;
           when xlandgr = 'TKR';             //SØR-KOREA
             if xenhet = *blanks;
               x_taromk = x_taordk;
             else;
               x_taromk = xenhet;
             endif;
             x_taromb = xsats;
           when xlandgr = 'TRS';             //Serbia
             if xenhet = *blanks;
               x_tan05k = x_taordk;
             else;
               x_tan05k = xenhet;
             endif;
             x_tan05b = xsats;
           when xlandgr = 'TAL';             //Albania
             if xenhet = *blanks;
               x_tan06k = x_taordk;
             else;
               x_tan06k = xenhet;
             endif;
             x_tan06b = xsats;
           when xlandgr = 'TUA';             //UKRAINA
             if xenhet = *blanks;
               x_tan07k = x_taordk;
             else;
               x_tan07k = xenhet;
             endif;
             x_tan07b = xsats;
           when xlandgr = 'TJO';             //Jordan
             if xenhet = *blanks;
               x_taungk = x_taordk;
             else;
               x_taungk = xenhet;
             endif;
             x_taungb = xsats;
           when xlandgr = 'TTN';             //TUNISIA
             if xenhet = *blanks;
               x_taslok = x_taordk;
             else;
               x_taslok = xenhet;
             endif;
             x_taslob = xsats;
           when xlandgr = 'TMA';             //Marokko
             if xenhet = *blanks;
               x_tamark = x_taordk;
             else;
               x_tamark = xenhet;
             endif;
             x_tamarb = xsats;
           when xlandgr = 'TPE';             //Peru
             if xenhet = *blanks;
               x_tan08k = x_taordk;
             else;
               x_tan08k = xenhet;
             endif;
             x_tan08b = xsats;
           when xlandgr = 'TME';             //Montenegro
             if xenhet = *blanks;
               x_tan09k = x_taordk;
             else;
               x_tan09k = xenhet;
             endif;
             x_tan09b = xsats;
           when xlandgr = 'THK';             //Hongkong
             if xenhet = *blanks;
               x_tan10k = x_taordk;
             else;
               x_tan10k = xenhet;
             endif;
             x_tan10b = xsats;
           when xlandgr = 'TMX';             //Mexico
             if xenhet = *blanks;
               x_tamexk = x_taordk;
             else;
               x_tamexk = xenhet;
             endif;
             x_tamexb = xsats;
           when xlandgr = 'TLB';             //Libanon
             if xenhet = *blanks;
               x_tan01k = x_taordk;
             else;
               x_tan01k = xenhet;
             endif;
             x_tan01b = xsats;
           when xlandgr = 'TEG';             //Egypt
             if xenhet = *blanks;
               x_tan03k = x_taordk;
             else;
               x_tan03k = xenhet;
             endif;
             x_tan03b = xsats;
           when xlandgr = 'TCA';             //Canada
             if xenhet = *blanks;
               x_tan04k = x_taordk;
             else;
               x_tan04k = xenhet;
             endif;
             x_tan04b = xsats;
           when xlandgr = 'TPA';             //Panama
             if xenhet = *blanks;
               x_tan14k = x_taordk;
             else;
               x_tan14k = xenhet;
             endif;
             x_tan14b = xsats;
           when xlandgr = 'TCR';             //Costa Rica
             if xenhet = *blanks;
               x_tan15k = x_taordk;
             else;
               x_tan15k = xenhet;
             endif;
             x_tan15b = xsats;
           when xlandgr = 'TCO';             //Columbia
             if xenhet = *blanks;
               x_tan16k = x_taordk;
             else;
               x_tan16k = xenhet;
             endif;
             x_tan16b = xsats;
           when xlandgr = 'TBA';             //BOSNIA-HERCEGOVINA
             if xenhet = *blanks;
               x_tan17k = x_taordk;
             else;
               x_tan17k = xenhet;
             endif;
             x_tan17b = xsats;
           when xlandgr = 'TGE';             //Georgia
             if xenhet = *blanks;
               x_tan18k = x_taordk;
             else;
               x_tan18k = xenhet;
             endif;
             x_tan18b = xsats;
           when xlandgr = 'TIL';             //Israel
             if xenhet = *blanks;
               x_taisrk = x_taordk;
             else;
               x_taisrk = xenhet;
             endif;
             x_taisrb = xsats;
           when xlandgr = 'TPH';             //Filippinene
             if xenhet = *blanks;
               x_tan19k = x_taordk;
             else;
               x_tan19k = xenhet;
             endif;
             x_tan19b = xsats;
           when xlandgr = 'TGB';             //Storbritania
             if xenhet = *blanks;
               x_tan20k = x_taordk;
             else;
               x_tan20k = xenhet;
             endif;
             x_tan20b = xsats;
           when xlandgr = 'TID';             //Indonesia
             if xenhet = *blanks;
               x_tan22k = x_taordk;
             else;
               x_tan22k = xenhet;
             endif;
             x_tan22b = xsats;
           when xlandgr = 'TEC';             //ECUADOR
             if xenhet = *blanks;
               x_tan23k = x_taordk;
             else;
               x_tan23k = xenhet;
             endif;
             x_tan23b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               x_tan24k = x_taordk;
             else;
               x_tan24k = xenhet;
             endif;
             p_tan24b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               x_tan25k = x_taordk;
             else;
               x_tan25k = xenhet;
             endif;
             x_tan25b = xsats;
           when xlandgr = '???';             //???
             if xenhet = *blanks;
               x_tan26k = x_taordk;
             else;
               x_tan26k = xenhet;
             endif;
             x_tan26b = xsats;
           endsl;
         endif;

       endsr;

       //**********************************************
       begsr opdtar;
       //**********************************************

         chain (x_tatanr) tari;
         if %found and g_taalfa <> *blanks;
           x_taalfa = g_taalfa;
           x_tatxt  = g_tatxt;
         else;
      /end-free
     C                   MOVEL     X_TATANR      TANR4             4 0
     C     TANR4         CHAIN     TARIKAP                            33
     C  N33              MOVE      NYALFA        X_TAALFA
      /free
         endif;

N01
N01      chain (x_tatanr: g_tatar: xfomdato) tari;
N01      if %found and g_tadts <> 0;
N01      // Finnes med samme startdato som er avsluttet. Ikke oppdatere
N01      else;
N01
         if x_tatanr = 21069060 or x_tatanr = 21069093 or
            x_tatanr = 21069098 or x_tatanr = 35019010 or
            x_tatanr = 35022090;
           setll (x_tatanr) tariny;
           reade (x_tatanr) tariny;
           dow not %eof;
             if taordk = 'V';
               leave;
             endif;
             update tarir;
             reade (x_tatanr) tariny;
           enddo;
         else;
           chain (x_tatanr) tariny;
         endif;
         tatanr = x_tatanr;
         tadato = xfomdato;
         tadts  = xtomdato;
         tadtr  = xidag;
         taalfa = x_taalfa;
         tatxt  = x_tatxt;
         taordk = x_taordk;
         taordb = x_taordb;
         taeftk = x_taeftk;
         taeftb = x_taeftb;
         taefk  = x_taefk;
         taefb  = x_taefb;
         tastk  = x_tastk;
         taenhe = x_taenhe;
         taeØsk = x_taeØsk;
         taeØsb = x_taeØsb;
         tatsjk = x_tatsjk;
         tatsjb = x_tatsjb;
         tatyrk = x_tatyrk;
         tatyrb = x_tatyrb;
         taisrk = x_taisrk;
         taisrb = x_taisrb;
         taellk = x_taellk;
         taellb = x_taellb;
         tabulk = x_tabulk;
         tabulb = x_tabulb;
         tapolk = x_tapolk;
         tapolb = x_tapolb;
         taromk = x_taromk;
         taromb = x_taromb;
         taungk = x_taungk;
         taungb = x_taungb;
         taslok = x_taslok;
         taslob = x_taslob;
         tamulk = x_tamulk;
         tamulb = x_tamulb;
         taoulk = x_taoulk;
         taoulb = x_taoulb;
         tagrlk = x_tagrlk;
         tagrlb = x_tagrlb;
         tafÆrk = x_tafÆrk;
         tafÆrb = x_tafÆrb;
         taistk = x_taistk;
         taistb = x_taistb;
         tamark = x_tamark;
         tamarb = x_tamarb;
         tamexk = x_tamexk;
         tamexb = x_tamexb;
         tavgak = x_tavgak;
         tavgab = x_tavgab;
         tan01k = x_tan01k;
         tan01b = x_tan01b;
         tan02k = x_tan02k;
         tan02b = x_tan02b;
         tan03k = x_tan03k;
         tan03b = x_tan03b;
         tan04k = x_tan04k;
         tan04b = x_tan04b;
         tan05k = x_tan05k;
         tan05b = x_tan05b;
         tan06k = x_tan06k;
         tan06b = x_tan06b;
         tan07k = x_tan07k;
         tan07b = x_tan07b;
         tan08k = x_tan08k;
         tan08b = x_tan08b;
         tan09k = x_tan09k;
         tan09b = x_tan09b;
         tan10k = x_tan10k;
         tan10b = x_tan10b;
         tan11k = x_tan11k;
         tan11b = x_tan11b;
         tan12k = x_tan12k;
         tan12b = x_tan12b;
         tan13k = x_tan13k;
         tan13b = x_tan13b;
         tan14k = x_tan14k;
         tan14b = x_tan14b;
         tan15k = x_tan15k;
         tan15b = x_tan15b;
         tan16k = x_tan16k;
         tan16b = x_tan16b;
         tan17k = x_tan17k;
         tan17b = x_tan17b;
         tan18k = x_tan18k;
         tan18b = x_tan18b;
         tan19k = x_tan19k;
         tan19b = x_tan19b;
         tan20k = x_tan20k;
         tan20b = x_tan20b;
         tan21k = x_tan21k;
         tan21b = x_tan21b;
         tan22k = x_tan22k;
         tan22b = x_tan22b;
         tan23k = x_tan23k;
         tan23b = x_tan23b;
         tan24k = x_tan24k;
         tan24b = x_tan24b;
         tan25k = x_tan25k;
         tan25b = x_tan25b;
         tan26k = x_tan26k;
         tan26b = x_tan26b;
         if x_tatanr = 21069060 or x_tatanr = 21069093 or
            x_tatanr = 21069098 or x_tatanr = 35019010 or
            x_tatanr = 35022090;
           if not %eof;
             update tarir;
           else;
             write tarir;
           endif;
         else;
           if %found;
             update tarir;
           else;
             write tarir;
           endif;
         endif;
N01
N01      endif;
N01
N01      chain (x_tatanr: g_tatar: pfomdato) tari;
N01      if %found and g_tadts <> 0;
N01      // Finnes med samme startdato som er avsluttet. Ikke oppdatere
N01      else;

         if x_tatanr = 21069060 or x_tatanr = 21069093 or
            x_tatanr = 21069098 or x_tatanr = 35019010 or
            x_tatanr = 35022090;
         // Oppdater prosent fortolling
           setll (x_tatanr) tariny;
           reade (x_tatanr) tariny;
           dow not %eof;
             if taordk = 'P';
               leave;
             endif;
             update tarir;
             reade (x_tatanr) tariny;
           enddo;

           tatanr = x_tatanr;
           tadato = pfomdato;
           tadts  = ptomdato;
           tadtr  = xidag;
           taalfa = x_taalfa;
           tatxt  = x_tatxt;
           taordk = p_taordk;
           taordb = p_taordb;
           taeftk = p_taeftk;
           taeftb = p_taeftb;
           taefk  = p_taefk;
           taefb  = p_taefb;
           tastk  = p_tastk;
           taenhe = p_taenhe;
           taeØsk = p_taeØsk;
           taeØsb = p_taeØsb;
           tatsjk = p_tatsjk;
           tatsjb = p_tatsjb;
           tatyrk = p_tatyrk;
           tatyrb = p_tatyrb;
           taisrk = p_taisrk;
           taisrb = p_taisrb;
           taellk = p_taellk;
           taellb = p_taellb;
           tabulk = p_tabulk;
           tabulb = p_tabulb;
           tapolk = p_tapolk;
           tapolb = p_tapolb;
           taromk = p_taromk;
           taromb = p_taromb;
           taungk = p_taungk;
           taungb = p_taungb;
           taslok = p_taslok;
           taslob = p_taslob;
           tamulk = p_tamulk;
           tamulb = p_tamulb;
           taoulk = p_taoulk;
           taoulb = p_taoulb;
           tagrlk = p_tagrlk;
           tagrlb = p_tagrlb;
           tafÆrk = p_tafÆrk;
           tafÆrb = p_tafÆrb;
           taistk = p_taistk;
           taistb = p_taistb;
           tamark = p_tamark;
           tamarb = p_tamarb;
           tamexk = p_tamexk;
           tamexb = p_tamexb;
           tavgak = p_tavgak;
           tavgab = p_tavgab;
           tan01k = p_tan01k;
           tan01b = p_tan01b;
           tan02k = p_tan02k;
           tan02b = p_tan02b;
           tan03k = p_tan03k;
           tan03b = p_tan03b;
           tan04k = p_tan04k;
           tan04b = p_tan04b;
           tan05k = p_tan05k;
           tan05b = p_tan05b;
           tan06k = p_tan06k;
           tan06b = p_tan06b;
           tan07k = p_tan07k;
           tan07b = p_tan07b;
           tan08k = p_tan08k;
           tan08b = p_tan08b;
           tan09k = p_tan09k;
           tan09b = p_tan09b;
           tan10k = p_tan10k;
           tan10b = p_tan10b;
           tan11k = p_tan11k;
           tan11b = p_tan11b;
           tan12k = p_tan12k;
           tan12b = p_tan12b;
           tan13k = p_tan13k;
           tan13b = p_tan13b;
           tan14k = p_tan14k;
           tan14b = p_tan14b;
           tan15k = p_tan15k;
           tan15b = p_tan15b;
           tan16k = p_tan16k;
           tan16b = p_tan16b;
           tan17k = p_tan17k;
           tan17b = p_tan17b;
           tan18k = p_tan18k;
           tan18b = p_tan18b;
           tan19k = p_tan19k;
           tan19b = p_tan19b;
           tan20k = p_tan20k;
           tan20b = p_tan20b;
           tan21k = p_tan21k;
           tan21b = p_tan21b;
           tan22k = p_tan22k;
           tan22b = p_tan22b;
           tan23k = p_tan23k;
           tan23b = p_tan23b;
           tan24k = p_tan24k;
           tan24b = p_tan24b;
           tan25k = p_tan25k;
           tan25b = p_tan25b;
           tan26k = p_tan26k;
           tan26b = p_tan26b;

           if not %eof;
             update tarir;
           else;
             write tarir;
           endif;

         endif;
N01
N01      endif;

         x_tatanr = 0;
         xfomdato = 0;
         xtomdato = 0;
         x_taalfa = *blanks;
         x_tatxt  = *blanks;
         x_taordk = *blanks;
         x_taordb = 0;
         x_taeftk = *blanks;
         x_taeftb = 0;
         x_taefk  = *blanks;
         x_taefb  = 0;
         x_tastk  = *blanks;
         x_taenhe = *blanks;
         x_taeØsk = *blanks;
         x_taeØsb = 0;
         x_tatsjk = *blanks;
         x_tatsjb = 0;
         x_tatyrk = *blanks;
         x_tatyrb = 0;
         x_taisrk = *blanks;
         x_taisrb = 0;
         x_taellk = *blanks;
         x_taellb = 0;
         x_tabulk = *blanks;
         x_tabulb = 0;
         x_tapolk = *blanks;
         x_tapolb = 0;
         x_taromk = *blanks;
         x_taromb = 0;
         x_taungk = *blanks;
         x_taungb = 0;
         x_taslok = *blanks;
         x_taslob = 0;
         x_tamulk = *blanks;
         x_tamulb = 0;
         x_taoulk = *blanks;
         x_taoulb = 0;
         x_tagrlk = *blanks;
         x_tagrlb = 0;
         x_tafÆrk = *blanks;
         x_tafÆrb = 0;
         x_taistk = *blanks;
         x_taistb = 0;
         x_tamark = *blanks;
         x_tamarb = 0;
         x_tamexk = *blanks;
         x_tamexb = 0;
         x_tavgak = *blanks;
         x_tavgab = 0;
         x_tan01k = *blanks;
         x_tan01b = 0;
         x_tan02k = *blanks;
         x_tan02b = 0;
         x_tan03k = *blanks;
         x_tan03b = 0;
         x_tan04k = *blanks;
         x_tan04b = 0;
         x_tan05k = *blanks;
         x_tan05b = 0;
         x_tan06k = *blanks;
         x_tan06b = 0;
         x_tan07k = *blanks;
         x_tan07b = 0;
         x_tan08k = *blanks;
         x_tan08b = 0;
         x_tan09k = *blanks;
         x_tan09b = 0;
         x_tan10k = *blanks;
         x_tan10b = 0;
         x_tan11k = *blanks;
         x_tan11b = 0;
         x_tan12k = *blanks;
         x_tan12b = 0;
         x_tan13k = *blanks;
         x_tan13b = 0;
         x_tan14k = *blanks;
         x_tan14b = 0;
         x_tan15k = *blanks;
         x_tan15b = 0;
         x_tan16k = *blanks;
         x_tan16b = 0;
         x_tan17k = *blanks;
         x_tan17b = 0;
         x_tan18k = *blanks;
         x_tan18b = 0;
         x_tan19k = *blanks;
         x_tan19b = 0;
         x_tan20k = *blanks;
         x_tan20b = 0;
         x_tan21k = *blanks;
         x_tan21b = 0;
         x_tan22k = *blanks;
         x_tan22b = 0;
         x_tan23k = *blanks;
         x_tan23b = 0;
         x_tan24k = *blanks;
         x_tan24b = 0;
         x_tan25k = *blanks;
         x_tan25b = 0;
         x_tan26k = *blanks;
         x_tan26b = 0;
         pfomdato = 0;
         ptomdato = 0;
         p_taordk = *blanks;
         p_taordb = 0;
         p_taeftk = *blanks;
         p_taeftb = 0;
         p_taefk  = *blanks;
         p_taefb  = 0;
         p_tastk  = *blanks;
         p_taenhe = *blanks;
         p_taeØsk = *blanks;
         p_taeØsb = 0;
         p_tatsjk = *blanks;
         p_tatsjb = 0;
         p_tatyrk = *blanks;
         p_tatyrb = 0;
         p_taisrk = *blanks;
         p_taisrb = 0;
         p_taellk = *blanks;
         p_taellb = 0;
         p_tabulk = *blanks;
         p_tabulb = 0;
         p_tapolk = *blanks;
         p_tapolb = 0;
         p_taromk = *blanks;
         p_taromb = 0;
         p_taungk = *blanks;
         p_taungb = 0;
         p_taslok = *blanks;
         p_taslob = 0;
         p_tamulk = *blanks;
         p_tamulb = 0;
         p_taoulk = *blanks;
         p_taoulb = 0;
         p_tagrlk = *blanks;
         p_tagrlb = 0;
         p_tafÆrk = *blanks;
         p_tafÆrb = 0;
         p_taistk = *blanks;
         p_taistb = 0;
         p_tamark = *blanks;
         p_tamarb = 0;
         p_tamexk = *blanks;
         p_tamexb = 0;
         p_tavgak = *blanks;
         p_tavgab = 0;
         p_tan01k = *blanks;
         p_tan01b = 0;
         p_tan02k = *blanks;
         p_tan02b = 0;
         p_tan03k = *blanks;
         p_tan03b = 0;
         p_tan04k = *blanks;
         p_tan04b = 0;
         p_tan05k = *blanks;
         p_tan05b = 0;
         p_tan06k = *blanks;
         p_tan06b = 0;
         p_tan07k = *blanks;
         p_tan07b = 0;
         p_tan08k = *blanks;
         p_tan08b = 0;
         p_tan09k = *blanks;
         p_tan09b = 0;
         p_tan10k = *blanks;
         p_tan10b = 0;
         p_tan11k = *blanks;
         p_tan11b = 0;
         p_tan12k = *blanks;
         p_tan12b = 0;
         p_tan13k = *blanks;
         p_tan13b = 0;
         p_tan14k = *blanks;
         p_tan14b = 0;
         p_tan15k = *blanks;
         p_tan15b = 0;
         p_tan16k = *blanks;
         p_tan16b = 0;
         p_tan17k = *blanks;
         p_tan17b = 0;
         p_tan18k = *blanks;
         p_tan18b = 0;
         p_tan19k = *blanks;
         p_tan19b = 0;
         p_tan20k = *blanks;
         p_tan20b = 0;
         p_tan21k = *blanks;
         p_tan21b = 0;
         p_tan22k = *blanks;
         p_tan22b = 0;
         p_tan23k = *blanks;
         p_tan23b = 0;
         p_tan24k = *blanks;
         p_tan24b = 0;
         p_tan25k = *blanks;
         p_tan25b = 0;
         p_tan26k = *blanks;
         p_tan26b = 0;

       endsr;

       //**********************************************
       begsr init;
       //**********************************************

         xrsn = %dec(usn:9:0);
         syge15c ( wdt : wtm );
         xidag = %dec(wdt:8:0);
         udato = xidag;
         xsats82 = 0;
         uok = 'N';

       endsr;

      /end-free
