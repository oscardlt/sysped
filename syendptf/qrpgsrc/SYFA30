********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
P090xx* 01 sh  PTF9  endre fakturanummer mulig ved f10
P090xx* 02 sh  PTF10 tillate kostnadsføring periodsplitt
P090xx* 03 sh  PTF11 løsning 1 informasjoner
P090xx* 04 sh  PTF12 1. andregangsreg
P090xx* 05 sh  PTF12 kan velge V=visma.net i økonomisystem
12141 * 06 YBC PTF12 SLETTERUTINE
      * 07 JOV PTF12 Ved F14 - tillegsparameter - hopp ut etterpå (uten lagring)
********************************************************************
      *
n03  FFIRMl1    UF A E           K DISK
s01  F*ELLFA    IF A E           K DISK
n01  FTELLFA    UF A E           K DISK
n02  FFIRMKOS   UF A E           K DISK
N06  FFIRMSR    UF A E           K DISK
     FFIRKID    UF A E           K DISK
     FFIRM      UF A E           K DISK
     FFIRSTA    UF A E           K DISK
     FFIRTR     UF A E           K DISK
     FKODTV     UF A E           K DISK
     FFIRFB     UF A E           K DISK
     FFIRKU     UF A E           K DISK
     FSYFA30FM  CF   E             WORKSTN
     D                 DS
     D  WTAX                   1      4  2
     D  XTAX                   1      4  4
     D                 DS
     D  WSTAX2                 1      4  2
     D  XTAX2                  1      4  4
     D                 DS
     D  WSTDD                  1      2  0
     D  WSTDM                  3      4  0
     D  WSTDÅ                  5      6  0
     D  WSTAXD                 1      6  0
     D                 DS
     D  FITDÅ                  1      4  0
     D  FITDM                  5      6  0
     D  FITDD                  7      8  0
     D  FITAXD                 1      8  0
     D                 DS            40
     D QCMDA           C                   CONST('CHGDTAARA DTAARA(FIR-
     D                                     MDT (1 160)) VALUE(')
     D                 DS             1
     D QCMDC           C                   CONST(X'7D')
     D                 DS
     D  QCMDB                  1    160
     D  FIFIRM                 1      2
     D  FIFT                   3     47
     D  FIKDUL                48     48
     D  FILTB                 49     49
     D  FILFB                 50     50
     D  FIUPS                 51     54  2
     D  FIUPM                 55     56  0
     D  FIKDT                 57     57  0
     D  FIATK                 58     59  0
     D  FIURLI                60     60
     D  FIURLE                61     61
     D  FIURFI                62     62
     D  FIURFE                63     63
     D  FIURFL                64     64
     D  FIURBI                65     65
     D  FIURBE                66     66
     D  FIURBL                67     67
     D  FIURSI                68     68
     D  FIURSE                69     69
     D  YYFNR                 70     75  0
     D  FIMVAS                76     78  2
     D  FIVALK                79     79
     D  FICURR                80     82
     D  FITAX                 83     86  4
     D  FIDTFM                87     87  0
     D  FIDECI                88     88  0
     D  FIECON                89     89
     D  FIAVTE                90     90
     D  FIKONT                91     91
     D  FILAND                92     93
     D  FITDVI                94     94
     D  FISTFN                95     96
     D  FISTFE                97     98
     D  FISTFT                99    100
     D  FILE12               101    102
     D  FILE22               103    104
     D  FILE11               105    105
     D  FILE21               106    106
     D  FILE31               107    107
     D  FILE41               108    108
     D  FITRAN               109    109
     D  FIKRTN               110    129
     D  FITAX2               130    133  4
     D  UITAXD               134    139  0
     D  FISADK               140    140
     D  FILIBF               141    150
     D  FILIBO               151    160
      *
     C     KODTVK        KLIST
     C                   KFLD                    KOVUNI
     C                   KFLD                    KOVAVD
     C                   MOVE      'V'           KOVUNI
     C                   MOVE      *ZEROS        KOVAVD
      *
     C     *ENTRY        PLIST
     C*** UIN01 = '1' -> PROGRAM KALLES FRA SAD400
     C                   PARM                    UIN01             1
     C                   PARM                    UVALK             1
     C                   PARM                    UDTFM             3
     C     UIN01         COMP      '1'                                    31
     C*
     C                   MOVE      *ZEROS        WTAX
     C                   MOVE      *ZEROS        WSTAX2
     C                   MOVE      *ZEROS        WSTAXD
     C                   MOVE      *ZEROS        FITAXD
     C                   CLEAR                   FIRMR
     C*
     C                   EXSR      HENT
     C     START         TAG
     C                   EXSR      KDTFMT
     C                   EXFMT     BILDE01
     C                   EXSR      KDTFMT
     C                   SETOFF                                       30
N01  C     *in10         ifeq      '1'
n01  c     fifirm        chain     tellfa                             33
n01  c     wsfnr         ifeq      *zeros
n01  c  n33              update    tellfar
n01  c                   move      fifnr         wsfnr
n01  c                   else
n01  c     fifirm        chain     tellfa                             33
n01  c                   move      wsfnr         fifnr
n01  c  n33              update    tellfar
n01  c   33              write     tellfar
n01  c                   end
n01  c                   goto      start
n01  c                   end
     C*
     C   12              GOTO      SLUTT
     C*
     C     WSFIRM        COMP      *BLANKS                                99
     C   99              MOVE      'SPF0019'     MSGNR
     C     WSFT          COMP      *BLANKS                                98
     C   98
     CANN99              MOVE      'SPF0020'     MSGNR
     C                   MOVE      WSTDÅ         UÅÅ               2 0
     C                   MOVE      WSTDM         UMM               2 0
     C                   MOVE      WSTDD         UDD               2 0
     C                   CALL      'TESTDATO'
     C                   PARM                    UDD
     C                   PARM                    UMM
     C                   PARM                    UÅÅ
     C                   PARM                    UFLAGG            1 0
     C     UFLAGG        COMP      1                                      97
     C   99
     COR 98              SETON                                        30
     C   97
     CANN30              MOVE      'SPD0001'     MSGNR
     C   97              SETON                                        30
     C   99
     COR 97
     COR 98              GOTO      START
     C   31              GOTO      START2
      *
n02  c     fifirm        chain(n)  firmkos                            33
n02  c  n33              move      tillat        wstill
n02  c  n33              move      interr        wsinte
n02  c   33              move      'N'           wstill
     C     FEILB2        TAG
     C                   EXFMT     BILDE02
     C                   SETOFF                                       30
     C   12              GOTO      SLUTT
     C     WSSADK        IFNE      'N'
     C     WSTAX2        ANDNE     0
     C     WSTAXD        ANDNE     0
     C                   SETON                                        30
     C                   MOVE      'SHU0354'     MSGNR
     C                   GOTO      FEILB2
     C                   END
n02  C     WStill        IFEQ      'Y'
n02  C     wsinte        ANDEQ     0
n02  C                   SETON                                        30
n02  C                   MOVE      'SHU1242'     MSGNR
n02  C                   GOTO      FEILB2
n02  C                   END
      *
n02  c     fifirm        chain     firmkos                            33
n02  c                   move      wstill        tillat
n02  c                   move      wsinte        interr
n02  c  n33              update    firmkosr
n02  c   33              write     firmkosr
     C*
     C                   EXFMT     BILDE03
     C   12              GOTO      SLUTT
N06   *
N06  C     FIFIRM        CHAIN(N)  FIRMSR                             33
N06  C                   EVAL      WSNOYF = SRNOYF
N06  C                   EVAL      WSNOYP = SRNOYP
N06  C                   EVAL      WSSEYF = SRSEYF
N06  C                   EVAL      WSSEYP = SRSEYP
N06  C                   EVAL      WSDKYF = SRDKYF
N06  C                   EVAL      WSDKYP = SRDKYP
N06   *
     c     B4tag         TAG
     C                   EXFMT     BILDE04
N06  C                   MOVEA     '00000000'    *IN(92)
N06  C                   MOVE      '0'           *IN30
     C   12              GOTO      SLUTT
      * generelle parametre på firmanivå (blank i kund/avd/user= firma) i fil SYPARF
     C     *IN14         IFEQ      *ON
     C                   CALL      'SYPR03R'
     C                   PARM                    UKUNDA            8
     C                   PARM                    UAVDA             4
     C                   PARM                    XXSER            10
     C                   PARM                    XXLAGG            1
S07  C*                  GOTO      B4TAG
N07  C                   GOTO      SLUTT
     C                   END
N06   * TEST ANTALL ÅR PÅ SLETTERUTINE
N06  C                   IF        WSNOYF = 0
N06  C                   EVAL      *IN97 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06  C                   IF        WSNOYP = 0
N06  C                   EVAL      *IN96 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06  C                   IF        WSSEYF = 0
N06  C                   EVAL      *IN95 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06  C                   IF        WSSEYP = 0
N06  C                   EVAL      *IN94 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06  C                   IF        WSDKYF = 0
N06  C                   EVAL      *IN93 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06  C                   IF        WSDKYP = 0
N06  C                   EVAL      *IN92 = *ON
N06  C                   EVAL      *IN30 = *ON
N06  C                   EVAL      MSGNR = 'YBC2029'
N06  C                   GOTO      B4TAG
N06  C                   END
N06   *
     C     START2        TAG
     C                   EXSR      OPDFIR
     C*
     C     SLUTT         TAG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KODTV                              90
     C  N90              DO
     C                   MOVE      KOVPRO        WSPRO
     C                   MOVE      KOVK1         WSVK1
     C                   MOVE      KOVK2         WSVK2
     C                   MOVE      KOVK3         WSVK3
     C                   MOVE      KOVK4         WSVK4
     C                   MOVE      KOVK5         WSVK5
     C                   MOVE      KOVK6         WSVK6
     C                   MOVE      KOVK7         WSVK7
     C                   MOVE      KOVK8         WSVK8
     C                   MOVE      KOVK9         WSVK9
     C                   MOVE      KOVK10        WSVK10
     C                   MOVE      KOVK11        WSVK11
     C                   END
      *
     C                   MOVE      *BLANKS       UVALK
     C                   MOVE      *BLANKS       WSFIRM
     C     WSFIRM        SETLL     FIRM                               90
     C                   READ(N)   FIRM                                   90
     C     *IN90         IFEQ      '1'
     C                   SELECT
     C     UDTFM         WHENEQ    'DMY'
     C                   Z-ADD     1             WDTFM
     C     UDTFM         WHENEQ    'MDY'
     C                   Z-ADD     1             WDTFM
     C     UDTFM         WHENEQ    'YMD'
     C                   Z-ADD     1             WDTFM
     C                   OTHER
     C                   Z-ADD     1             WDTFM
     C                   ENDSL
     C                   ELSE
s01  C*    FIFIRM        CHAIN     TELLFA                             33
N01  C     FIFIRM        CHAIN(N)  TELLFA                             33
     C                   MOVE      FIFIRM        WSFIRM
     C                   MOVE      FIFT          WSFT
     C                   MOVE      FIKDUL        WSKDUL
     C                   MOVE      FILFB         WSLFB
     C                   MOVE      FIUPS         WSUPS
     C                   MOVE      FIUPM         WSUPM
     C                   MOVE      FIKDT         WSKDT
     C                   MOVE      FIVALK        WSVALK
     C                   MOVE      FIURLI        WSURLI
     C                   MOVE      FIURLE        WSURLE
     C                   MOVE      FIURFI        WSURFI
     C                   MOVE      FIURFE        WSURFE
     C                   MOVE      FIURFL        WSURFL
     C                   MOVE      FIURBI        WSURBI
     C                   MOVE      FIURBE        WSURBE
     C                   MOVE      FIURBL        WSURBL
     C                   MOVE      FIURSI        WSURSI
     C                   MOVE      FIURSE        WSURSE
     C                   MOVE      FITRAN        WSTRAN
     C                   MOVE      FIFNR         WSFNR
     C                   MOVE      FICURR        WCURR
     C                   MOVE      FITAX         XTAX
     C                   MOVE      FITAX2        XTAX2
     C                   MOVE      FITDD         WSTDD
     C                   MOVE      FITDM         WSTDM
     C                   MOVE      FITDÅ         WSTDÅ
     C                   MOVE      FISADK        WSSADK
     C                   MOVE      FIDTFM        WDTFM
     C                   MOVE      FIDECI        WDECI
     C                   MOVE      FIECON        WSECON
     C                   MOVE      FIAVTE        WSAVTE
     C                   MOVE      FIKONT        WSKONT
     C                   MOVE      FILAND        WSLAND
     C                   MOVE      FILIBF        WSLIBF
     C                   MOVE      FILIBO        WSLIBO
     C                   MOVE      FITDVI        WSTDVI
     C                   MOVE      FISTFN        WSSTFN
     C                   MOVE      FISTFE        WSSTFE
     C                   MOVE      FISTFT        WSSTFT
     C                   MOVE      FILE11        WSLE11
     C                   MOVE      FILE21        WSLE12
     C                   MOVE      FILE31        WSLE31
     C                   MOVE      FILE41        WSLE41
     C                   MOVE      FIKRTN        WSKRTN
     C                   MOVE      INNUTL        WSIU
     C                   MOVE      ZIPCOD        WSZIP
     C     WSFIRM        SETLL     FIRFB
     C                   READ(N)   FIRFB                                  91
     C                   MOVE      FIFBNR        WSFBNR
     C                   MOVE      FITPNR        WSTPNR
     C                   MOVE      FIRECN        WSRECN
     C                   MOVE      FISNLA        WSSNLA
     C                   MOVE      FISNLE        WSSNLE
     C                   MOVE      FIRECM        WSRECM
     C                   MOVE      FIIDLA        WSIDLA
     C                   MOVE      FIIDLE        WSIDLE
     C                   MOVE      FIIDNR        WSIDNR
     C                   MOVE      FIIDMX        WSIDMX
     C     WSFIRM        SETLL     FIRKU
     C                   READ(N)   FIRKU                                  91
     C                   MOVE      FIKUFR        WSKUFR
     C                   MOVE      FIKUTI        WSKUTI
     C                   MOVE      FIKUNE        WSKUNE
     C     WSFIRM        SETLL     FIRSTA
     C                   READ(N)   FIRSTA                                 91
     C                   MOVE      FISTA         WSSTA
     C                   MOVE      FISTB         WSSTB
     C                   MOVE      FISTC         WSSTC
     C                   MOVE      FISTD         WSSTD
     C                   MOVE      FISTE         WSSTE
     C                   MOVE      FISTF         WSSTF
     C                   MOVE      FISTG         WSSTG
     C                   MOVE      FISTH         WSSTH
     C                   MOVE      FISTI         WSSTI
     C                   MOVE      FISTJ         WSSTJ
     C                   MOVE      FISTK         WSSTK
     C                   MOVE      FISTL         WSSTL
     C                   MOVE      FISTM         WSSTM
     C                   MOVE      FISTN         WSSTN
     C                   MOVE      FISTO         WSSTO
     C                   MOVE      FISTP         WSSTP
     C                   MOVE      FISTQ         WSSTQ
     C                   MOVE      FISTR         WSSTR
     C                   MOVE      FISTS         WSSTS
     C                   MOVE      FISTT         WSSTT
     C                   MOVE      FISTU         WSSTU
     C                   MOVE      FISTV         WSSTV
     C                   MOVE      FISTW         WSSTW
     C                   MOVE      FISTX         WSSTX
     C                   MOVE      FISTY         WSSTY
     C                   MOVE      FISTZ         WSSTZ
     C                   MOVE      FISTNR        WSSTNR
     C     WSFIRM        SETLL     FIRTR
     C                   READ(N)   FIRTR                                  91
     C                   MOVE      FAVREG        AVREGN
     C                   MOVE      FFERK         FERJEK
     C                   MOVE      FOPPDR        OPPDRG
     C                   MOVE      FIBISE        WSBISE
     C                   MOVE      FIKONV        WSKONV
     C                   MOVE      FIBRUT        WSBRUT
     C                   END
     C     WSFIRM        CHAIN(N)  FIRKID                             91
     C  N91              MOVE      'J'           WSKID8
     C   91              MOVE      'N'           WSKID8
     C*
n03  C     WSFIRM        SETLL     FIRML1
n03  C                   READ(N)   FIRML1                                 91
n03  C                   MOVE      L1KJOR        WSKJOR
n03  C                   MOVE      L1STDN        WSSTDN
n03  C                   MOVE      L1DATN        WSDATN
n04  C                   MOVE      L1FOAN        WSFOAN
     C                   ENDSR
     C***********************************************
     C     OPDFIR        BEGSR
     C***********************************************
     C     KODTVK        CHAIN     KODTV                              99
     C                   MOVE      WSPRO         KOVPRO
     C                   MOVE      WSVK1         KOVK1
     C                   MOVE      WSVK2         KOVK2
     C                   MOVE      WSVK3         KOVK3
     C                   MOVE      WSVK4         KOVK4
     C                   MOVE      WSVK5         KOVK5
     C                   MOVE      WSVK6         KOVK6
     C                   MOVE      WSVK7         KOVK7
     C                   MOVE      WSVK8         KOVK8
     C                   MOVE      WSVK9         KOVK9
     C                   MOVE      WSVK10        KOVK10
     C                   MOVE      WSVK11        KOVK11
     C  N99              UPDATE    KOVR
     C   99              WRITE     KOVR
      *
     C     WSFIRM        CHAIN     FIRM                               99
     C   99
     CANN90              DO
      * FIRMAKODE ER BYTTET - SLETT ALLE POSTER...
     C     FIFIRM        CHAIN     FIRM                               99
     C  N99              DELETE    FIRMR
     C     FIFIRM        CHAIN     FIRSTA                             99
     C  N99              DELETE    FIRSTAR
     C     FIFIRM        CHAIN     FIRTR                              99
     C  N99              DELETE    FIRTRR
     C     FIFIRM        CHAIN     FIRFB                              99
     C  N99              DELETE    FIRFBR
     C     FIFIRM        CHAIN     FIRKU                              99
     C  N99              DELETE    FIRKUR
N03  C     FIFIRM        CHAIN     FIRML1                             99
N03  C  N99              DELETE    FIRML1R
     C     WSFIRM        CHAIN     FIRM                               99
     C                   END
     C     WSFIRM        CHAIN     FIRSTA                             92
     C     WSFIRM        CHAIN     FIRTR                              93
     C     WSFIRM        CHAIN     FIRFB                              94
     C     WSFIRM        CHAIN     FIRKU                              95
N03  C     WSFIRM        CHAIN     FIRML1                             96
     C                   MOVE      WSFIRM        FIFIRM
     C                   MOVE      WSFT          FIFT
     C                   MOVE      WSKDUL        FIKDUL
     C                   MOVE      'N'           FILTB
     C                   MOVE      WSLFB         FILFB
     C                   MOVE      WSUPS         FIUPS
     C                   MOVE      WSUPM         FIUPM
     C                   MOVE      WSKDT         FIKDT
     C*
     C                   MOVE      WSVALK        FIVALK
     C                   MOVE      WSVALK        UVALK
     C  N31              DO
     C                   MOVE      WSURLI        FIURLI
     C                   MOVE      WSURLE        FIURLE
     C                   MOVE      WSURFI        FIURFI
     C                   MOVE      WSURFE        FIURFE
     C                   MOVE      WSURFL        FIURFL
     C                   MOVE      WSURBI        FIURBI
     C                   MOVE      WSURBE        FIURBE
     C                   MOVE      WSURBL        FIURBL
     C                   MOVE      WSURSI        FIURSI
     C                   MOVE      WSURSE        FIURSE
     C                   MOVE      WSTRAN        FITRAN
     C                   END
     C   31              DO
     C                   MOVE      'N'           FIURLI
     C                   MOVE      'N'           FIURLE
     C                   MOVE      'N'           FIURFI
     C                   MOVE      'N'           FIURFE
     C                   MOVE      'N'           FIURFL
     C                   MOVE      'N'           FIURBI
     C                   MOVE      'N'           FIURBE
     C                   MOVE      'N'           FIURBL
     C                   MOVE      'J'           FIURSI
     C                   MOVE      'J'           FIURSE
     C                   MOVE      'N'           FITRAN
     C                   END
     C                   MOVE      WCURR         FICURR
     C                   MOVE      XTAX          FITAX
     C                   MOVE      XTAX2         FITAX2
     C                   MOVE      WSTDD         FITDD
     C                   MOVE      WSTDM         FITDM
     C     WSTDÅ         IFGT      50
     C     WSTDÅ         ADD       1900          FITDÅ
     C                   ELSE
     C     WSTDÅ         ADD       2000          FITDÅ
     C                   END
     C                   MOVE      WSSADK        FISADK
     C                   MOVE      WDTFM         FIDTFM
     C                   MOVE      WDECI         FIDECI
     C                   MOVE      WSECON        FIECON
     C                   MOVE      WSAVTE        FIAVTE
     C                   MOVE      WSKONT        FIKONT
     C                   MOVE      'N'           FIKONT
     C                   MOVE      WSLAND        FILAND
     C                   MOVE      WSLIBF        FILIBF
     C                   MOVE      WSLIBO        FILIBO
     C                   MOVE      WSTDVI        FITDVI
     C                   MOVE      WSSTFN        FISTFN
     C                   MOVE      WSSTFE        FISTFE
     C                   MOVE      WSSTFT        FISTFT
     C                   MOVE      WSLE11        FILE11
     C                   MOVE      WSKRTN        FIKRTN
     C                   MOVE      WSLE12        FILE21
     C                   MOVE      WSLE31        FILE31
     C                   MOVE      WSLE41        FILE41
     C                   MOVE      WSSTA         FISTA
     C                   MOVE      WSSTB         FISTB
     C                   MOVE      WSSTC         FISTC
     C                   MOVE      WSSTD         FISTD
     C                   MOVE      WSSTE         FISTE
     C                   MOVE      WSSTF         FISTF
     C                   MOVE      WSSTG         FISTG
     C                   MOVE      WSSTH         FISTH
     C                   MOVE      WSSTI         FISTI
     C                   MOVE      WSSTJ         FISTJ
     C                   MOVE      WSSTK         FISTK
     C                   MOVE      WSSTL         FISTL
     C                   MOVE      WSSTM         FISTM
     C                   MOVE      WSSTN         FISTN
     C                   MOVE      WSSTO         FISTO
     C                   MOVE      WSSTP         FISTP
     C                   MOVE      WSSTQ         FISTQ
     C                   MOVE      WSSTR         FISTR
     C                   MOVE      WSSTS         FISTS
     C                   MOVE      WSSTT         FISTT
     C                   MOVE      WSSTU         FISTU
     C                   MOVE      WSSTV         FISTV
     C                   MOVE      WSSTW         FISTW
     C                   MOVE      WSSTX         FISTX
     C                   MOVE      WSSTY         FISTY
     C                   MOVE      WSSTZ         FISTZ
     C                   MOVE      WSSTNR        FISTNR
     C                   MOVE      AVREGN        FAVREG
     C                   MOVE      FERJEK        FFERK
     C                   MOVE      OPPDRG        FOPPDR
     C                   MOVE      WSBISE        FIBISE
     C                   MOVE      WSKONV        FIKONV
     C                   MOVE      WSBRUT        FIBRUT
     C                   MOVE      WSFBNR        FIFBNR
     C                   MOVE      WSTPNR        FITPNR
     C                   MOVE      WSRECN        FIRECN
     C                   MOVE      WSSNLA        FISNLA
     C                   MOVE      WSSNLE        FISNLE
     C                   MOVE      WSRECM        FIRECM
     C                   MOVE      WSIDLA        FIIDLA
     C                   MOVE      WSIDLE        FIIDLE
     C                   MOVE      WSIDNR        FIIDNR
     C                   MOVE      WSIDMX        FIIDMX
     C                   MOVE      WSIU          INNUTL
     C                   MOVE      WSZIP         ZIPCOD
     C   99              WRITE     FIRMR
     C  N99              UPDATE    FIRMR
     C                   MOVE      *BLANKS       FIFT
     C                   MOVE      *BLANKS       FIKRTN
     C                   MOVE      FITAXD        UITAXD
     C     QCMDA         CAT(P)    QCMDC:0       QCMDD           256
     C     QCMDD         CAT       QCMDB:0       QCMDD
     C     QCMDD         CAT       QCMDC:0       QCMDD
     C     QCMDD         CAT       ')':0         QCMDD
     C                   Z-ADD     256           QCMDL            15 5
     C                   CALL      'QCMDEXC'
     C                   PARM                    QCMDD
     C                   PARM                    QCMDL
     C   92              WRITE     FIRSTAR
     C  N92              UPDATE    FIRSTAR
     C   93              WRITE     FIRTRR
     C  N93              UPDATE    FIRTRR
     C   94              WRITE     FIRFBR
     C  N94              UPDATE    FIRFBR
     C                   MOVE      WSKUFR        FIKUFR
     C                   MOVE      WSKUTI        FIKUTI
     C                   MOVE      WSKUNE        FIKUNE
     C   95              WRITE     FIRKUR
     C  N95              UPDATE    FIRKUR
N03  C                   move      wsfirm        L1FIRM
N03  C                   MOVE      WSKJOR        L1KJOR
N03  C                   MOVE      WSSTDN        L1STDN
N03  C                   MOVE      WSDATN        L1DATN
n04  C                   MOVE      WSFOAN        L1FOAN
N03  C   96              WRITE     FIRML1R
N03  C  N96              UPDATE    FIRML1R
     C* KID 8 LANG
     C     FIFIRM        CHAIN     FIRKID                             91
     C     WSKID8        IFEQ      'N'
     C  N91              DELETE    FIRKIDR
     C                   ELSE
     C     WSKID8        IFEQ      'J'
     C   91              Z-ADD     1000000       FIKID8
     C   91              WRITE     FIRKIDR
     C  N91              UPDATE    FIRKIDR
     C                   END
     C                   END
N06   *
N06  C     FIFIRM        CHAIN     FIRMSR                             33
N06  C                   EVAL      SRNOYF = WSNOYF
N06  C                   EVAL      SRNOYP = WSNOYP
N06  C                   EVAL      SRSEYF = WSSEYF
N06  C                   EVAL      SRSEYP = WSSEYP
N06  C                   EVAL      SRDKYF = WSDKYF
N06  C                   EVAL      SRDKYP = WSDKYP
N06  C                   IF        *IN33
N06  C                   EVAL      SRFIRM = FIFIRM
N06  C                   WRITE     FIRMSRR
N06  C                   ELSE
N06  C                   UPDATE    FIRMSRR
N06  C                   END
N06   *
     C                   ENDSR
     C***********************************************
     C     KDTFMT        BEGSR
     C***********************************************
     C                   MOVE      WSTDD         UDT1              2 0
     C                   MOVE      WSTDM         UDT2              2 0
     C                   MOVE      WSTDÅ         UDT3              2 0
     C                   CALL      'DATOFMT2'
     C                   PARM                    UDT1
     C                   PARM                    UDT2
     C                   PARM                    UDT3
     C                   PARM                    WDTFM
     C                   MOVE      UDT1          WSTDD
     C                   MOVE      UDT2          WSTDM
     C                   MOVE      UDT3          WSTDÅ
     C                   ENDSR
      *
