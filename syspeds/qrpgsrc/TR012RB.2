      *
      ***********************************************************
      *** PROGRAM SKAL OVERFØRE SAD-LINJER TIL TET            ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01-26                            ***
      *** LEDIGE INDIKATORER 27-32 34-99                      ***
      ***********************************************************
     FSAEH      IF   E           K DISK
     FSAEV4     IF   E           K DISK
     FTRUV      O  A E             DISK
     FTRUVAM    O  A E             DISK
     FCUNDL01   IF   E           K DISK
     D                 DS
     D  TVVKTB                 1      9  0
     D  TVVKTB123              1     12  3
     D                 DS
     D  TVVKTN                 1      9  0
     D  TVVKTN123              1     12  3
     D                 DS
     D  SYRG                   1     14
     D  SYFOR9                 1      9
     D  SYFORE                 1     11
      *
     C                   EXSR      INIT
      *
     C                   MOVE      *ZEROS        XLN               5 0
     C     SAEHK         SETLL     SAEV4
     C     SAEHK         READE     SAEV4                                  33
     C                   DOW       *IN33 = *OFF
     C                   SELECT
     C                   WHEN      XLN = 0
     C                   EXSR      SRHENT                                       HENT DATA FRA SAEV
     C                   WHEN      SVLN = XLN
     C                   EXSR      SRSUM                                        SUMMERE VEKT
     C                   OTHER
     C                   ADD       0,5           TVVKTB123
     C                   ADD       0,5           TVVKTN123
     C                   WRITE     TRUVR
     C                   EXSR      SRHENT                                       HENT DATA FRA SAEV
     C                   ENDSL
     C     SAEHK         READE     SAEV4                                  33
     C                   ENDDO
      *
     C                   IF        TVLI <> 0
     C                   ADD       0,5           TVVKTB123
     C                   ADD       0,5           TVVKTN123
     C                   WRITE     TRUVR
     C                   END
      *
     C                   SETON                                        LR
      *
      ***********************************************
     C     SRHENT        BEGSR
      ***********************************************
     C                   MOVE      SVLN          XLN
     C                   ADD       1             TVLI
     C                   MOVE      SVVNT         TVVNT
     C                   Z-ADD     SVVKTB        TVVKTB123
     C                   Z-ADD     SVVKTN        TVVKTN123
     C                   Z-ADD     SVNTM         TVNTEH
     C                   MOVEL     SVFT          TVMN
     C                   MOVE      SVNT          TVNT
     C                   MOVEL     SVEH          TVEH
     C                   MOVEL     SVVT          TVVT
     C                   EVAL      TVDTY = '830'
     C                   EVAL      TVDREF = %TRIM(SETLE) + ' ' + %TRIM(SETLL)
     C                   EXSR      HADR12
      *
     C                   ENDSR
      *
      ***********************************************
     C     SRSUM         BEGSR
      ***********************************************
     C                   ADD       SVVKTB        TVVKTB123
     C                   ADD       SVVKTN        TVVKTN123
     C                   ADD       SVNTM         TVNTEH
      *
     C                   ENDSR
      *
      ***********************************************
     C     HADR12        BEGSR
      ***********************************************
     C                   MOVE      SEKNK         TVKNS
     C                   MOVE      SENAK         TVNAS
     C                   MOVE      SEADK1        TVADS1
     C                   MOVEL     SEADK3        TVPNS
     C                   MOVEL     SEADK3        TVPSS
     C                   MOVEL     'NO'          TVSKS
     C                   MOVEL     'NO'          TVLKS
     C     SEKNK         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       TVTINS
     C                   ELSE                                                   1
     C                   MOVE      SEKNK         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   EVAL      TVTINS = *BLANKS
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))   3<-B
     C                   EVAL      TVTINS = TVLKS + SYFOR9
     C                   ELSE                                                     3
     C                   EVAL      TVTINS = *BLANKS
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      TVTINS = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C                   MOVE      SEKNS         TVKNK
     C                   MOVE      SENAS         TVNAK
     C                   MOVE      SEADS1        TVADK1
     C                   MOVEL     SEADS3        TVPNK
     C                   MOVEL     SEADS3        TVPSK
     C                   MOVEL     'NO'          TVSKK
     C                   MOVEL     SELKB         TVLKK
     C     SEKNS         IFEQ      0                                            1<-B
     C                   MOVE      *BLANKS       TVTINK
     C                   ELSE                                                   1
     C                   MOVE      SEKNS         KUNDNR
     C     CUND1K        CHAIN     CUNDL01                            34
     C                   EVAL      TVTINK = *BLANKS
     C  N34              SELECT                                                  2<-B
     C                   WHEN      EORI = *BLANKS                                2
     C                   IF        ((SYFOR9 <> *BLANKS) AND (SYFOR9 <> *ZEROS))   3<-B
     C                   EVAL      TVTINK = TVLKK + SYFOR9
     C                   ELSE                                                     3
     C                   EVAL      TVTINK = *BLANKS
     C                   END                                                      3<-E
     C                   OTHER                                                   2
     C                   EVAL      TVTINK = EORI
     C                   ENDSL                                                   2<-E
     C                   END                                                    1<-E
      *
     C     TVADS1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADS1
     C                   END                                                    1<-E
     C     TVADK1        IFEQ      *BLANKS                                      1<-B
     C                   MOVEL     '.'           TVADK1
     C                   END                                                    1<-E
      *
     C                   WRITE     TRUVAMR
      *
     C                   ENDSR
      *
      ***********************************************
     C     INIT          BEGSR
      ***********************************************
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4
     C                   PARM                    UTDN              7
     C                   PARM                    UAVD2             4
     C                   PARM                    UTDN2             7
      *
     C     CUND1K        KLIST
     C                   KFLD                    UFIRM
     C                   KFLD                    KUNDNR
     C     SAEHK         KLIST
     C                   KFLD                    SEAVD
     C                   KFLD                    SETDN
     C                   MOVE      UAVD2         SVAVD
     C                   MOVE      UTDN2         SVTDN
      *
     C                   MOVE      UAVD          TVAVD
     C                   MOVE      UTDN          TVTDN
     C                   MOVE      UAVD2         TVAVD2
     C                   MOVE      UTDN2         TVTDN2
     C     SAEHK         CHAIN     SAEH                               33
      *
     C                   ENDSR
