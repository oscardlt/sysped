     FSVIH      IF   E           K DISK
     FSVIV      IF   E           K DISK
     FSVIVA     IF   E           K DISK
     FSVIVA2    IF   E           K DISK    RENAME(SVIVAR:SVIVAR2)
     FSVI007PT  O    E             PRINTER OFLIND(*IN27) USROPN
     FKODTP     IF   E           K DISK
     FKODTFM    IF   E           K DISK
     FFIRM      IF   E             DISK
     FARKTXT    IF   E           K DISK
     FFIRMARC   IF   E           K DISK
     FARKIVP    O  A E           K DISK
     FSVI006F   UF A E           K DISK
     D                SDS
     D  ZUSER                254    263
      *________________________________________
      * DS for å venstrestille numeriske felter
      *""""""""""""""""""""""""""""""""""""""""
     D                 DS
     D  ØN184                  1     18  4
     D  ØA184H                 1     14
     D  ØA184X                 7     14
     D  ØA184D                15     18
     D                 DS
     D  ØA13                   1     13
     D  Ø13                    1     13
     D                                     DIM(13)                              Num edit
     D                 DS
     D  XR32                   1      7S 2
     D  XR32H                  1      5S 0
     D  XR32D                  6      7
      *//////////////
      *  Hodelogikk /
      *//////////////
     C                   EXSR      SRA
     C                   EXSR      SRB
     C                   EXSR      SRC
     C                   EVAL      *INLR=*ON
      *////////////////////////////////////////////////////////////
      *  Initiering                                           SRA /
      *////////////////////////////////////////////////////////////
     C     SRA           BEGSR
      *_________________
      * Input parametrer
      *"""""""""""""""""
     C     *ENTRY        PLIST
     C                   PARM                    UVIHASYAV         4
     C                   PARM                    UVIHASYOP         7
     C                   PARM                    CALLTYP           1
     C                   MOVE      UVIHASYAV     UVIH_SYAV
     C                   MOVE      UVIHASYOP     UVIH_SYOP
      *___________________
      * Definiere Workfelt
      *"""""""""""""""""""
     C     *LIKE         DEFINE    SVIH_SYAV     UVIH_SYAV
     C     *LIKE         DEFINE    SVIH_SYOP     UVIH_SYOP
     C     *LIKE         DEFINE    KOPUNI        UOPUNI
     C     *LIKE         DEFINE    KOPAVD        UOPAVD
     C     *LIKE         DEFINE    KOPLNR        UOPLNR
     C     *LIKE         DEFINE    KFMSD         UFMSD
     C     *LIKE         DEFINE    W03A          X03A
     C     *LIKE         DEFINE    WP1R31A       WR31A
     C     *LIKE         DEFINE    WP1R31A       WR31
     C     *LIKE         DEFINE    WP1R32        WR32
     C     *LIKE         DEFINE    WP1R33A       WR33A
     C     *LIKE         DEFINE    WP1R33B       WR33B
     C     *LIKE         DEFINE    WP1R33C       WR33C
     C     *LIKE         DEFINE    WP1R33D       WR33D
     C     *LIKE         DEFINE    WP1R33E       WR33E
     C     *LIKE         DEFINE    WP1R31B       WR31B
     C     *LIKE         DEFINE    WP1R31C       WR31C
     C     *LIKE         DEFINE    WP1R31D       WR31D
     C     *LIKE         DEFINE    WP1R31E       WR31E
     C     *LIKE         DEFINE    WP1R34A       WR34A
     C     *LIKE         DEFINE    WP1R34B       WR34B
     C     *LIKE         DEFINE    WP1R35        WR35
     C     *LIKE         DEFINE    WP1R36        WR36
     C     *LIKE         DEFINE    WP1R31F       WR31F
     C     *LIKE         DEFINE    WP1R31G       WR31G
     C     *LIKE         DEFINE    WP1R31H       WR31H
     C     *LIKE         DEFINE    WP1R31I       WR31I
     C     *LIKE         DEFINE    WP1R37A       WR37A
     C     *LIKE         DEFINE    WP1R37B       WR37B
     C     *LIKE         DEFINE    WP1R38        WR38
     C     *LIKE         DEFINE    WP1R39        WR39
     C     *LIKE         DEFINE    WP1R31J       WR31J
     C     *LIKE         DEFINE    WP1R31K       WR31K
     C     *LIKE         DEFINE    WP1R31L       WR31L
     C     *LIKE         DEFINE    WP1R31M       WR31M
     C     *LIKE         DEFINE    WP1R40        WR40
     C     *LIKE         DEFINE    WP1R31N       WR31N
     C     *LIKE         DEFINE    WP1R31O       WR31O
     C     *LIKE         DEFINE    WP1R44A       WR44A
     C     *LIKE         DEFINE    WP1R44A       WR44
     C     *LIKE         DEFINE    WP1R41        WR41
     C     *LIKE         DEFINE    WP1R42        WR42
     C     *LIKE         DEFINE    WP1R44B       WR44B
     C     *LIKE         DEFINE    WP1R44C       WR44C
     C     *LIKE         DEFINE    WP1R44D       WR44D
     C     *LIKE         DEFINE    WP1R44E       WR44E
     C     *LIKE         DEFINE    WP1R44F       WR44F
     C     *LIKE         DEFINE    WP1R44G       WR44G
     C     *LIKE         DEFINE    WP1R44H       WR44H
     C     *LIKE         DEFINE    WP1R44I       WR44I
     C     *LIKE         DEFINE    WP1R46        WR46
     C     *LIKE         DEFINE    WP1R47A1      WR47A1
     C     *LIKE         DEFINE    WP1R47A1      WR47A
     C     *LIKE         DEFINE    WP1R47B1      WR47B1
     C     *LIKE         DEFINE    WP1R47B1      WR47B
     C     *LIKE         DEFINE    WP1R47C1      WR47C1
     C     *LIKE         DEFINE    WP1R47C1      WR47C
     C     *LIKE         DEFINE    WP1R47D1      WR47D1
     C     *LIKE         DEFINE    WP1R47D1      WR47D
     C     *LIKE         DEFINE    WP1R47A2      WR47A2
     C     *LIKE         DEFINE    WP1R47B2      WR47B2
     C     *LIKE         DEFINE    WP1R47C2      WR47C2
     C     *LIKE         DEFINE    WP1R47D2      WR47D2
     C     *LIKE         DEFINE    WP1R47A3      WR47A3
     C     *LIKE         DEFINE    WP1R47B3      WR47B3
     C     *LIKE         DEFINE    WP1R47C3      WR47C3
     C     *LIKE         DEFINE    WP1R47D3      WR47D3
     C     *LIKE         DEFINE    WP2R47D3      WR47D3
     C     *LIKE         DEFINE    WP1R47A4      WR47A4
     C     *LIKE         DEFINE    WP1R47B4      WR47B4
     C     *LIKE         DEFINE    WP1R47C4      WR47C4
     C     *LIKE         DEFINE    WP1R47D4      WR47D4
     C     *LIKE         DEFINE    WP1R47A5      WR47A5
     C     *LIKE         DEFINE    WP1R47B5      WR47B5
     C     *LIKE         DEFINE    WP1R47C5      WR47C5
     C     *LIKE         DEFINE    WP1R47D5      WR47D5
     C     *LIKE         DEFINE    WP1R47A6      WR47A6
     C     *LIKE         DEFINE    WP1R47B6      WR47B6
     C     *LIKE         DEFINE    WP1R47C6      WR47C6
     C     *LIKE         DEFINE    WP1R47D6      WR47D6
     C     *LIKE         DEFINE    WP1R47A7      WR47A7
     C     *LIKE         DEFINE    WP1R47B7      WR47B7
     C     *LIKE         DEFINE    WP1R47C7      WR47C7
     C     *LIKE         DEFINE    WP1R47D7      WR47D7
     C     *LIKE         DEFINE    WP1R47A8      WR47A8
     C     *LIKE         DEFINE    WP1R47B8      WR47B8
     C     *LIKE         DEFINE    WP1R47C8      WR47C8
     C     *LIKE         DEFINE    WP1R47D8      WR47D8
     C     *LIKE         DEFINE    WP1R47A9      WR47A9
     C     *LIKE         DEFINE    WP1R47B9      WR47B9
     C     *LIKE         DEFINE    WP1R47C9      WR47C9
     C     *LIKE         DEFINE    WP1R47D9      WR47D9
     C     *LIKE         DEFINE    WP1R47T       WR47T
      *__________________
      * Definiere Nøkkler
      *""""""""""""""""""
     C     KEYA          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C     KEYB          KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C                   KFLD                    SVIV_SYLI
     C     KEYP          KLIST
     C                   KFLD                    UOPUNI
     C                   KFLD                    UOPAVD
     C                   KFLD                    UOPLNR
     C     KEYF          KLIST
     C                   KFLD                    KOPFM
     C                   KFLD                    UFMSD
     C     KEY006        KLIST
     C                   KFLD                    UVIH_SYAV
     C                   KFLD                    UVIH_SYOP
     C                   KFLD                    SVIVA_ABK
      *_____________
      * Init av felt
      *"""""""""""""
     C                   CALL      'SYGE15C'
     C                   PARM                    WDT               8
     C                   PARM                    WTM               6
     C                   MOVE      WDT           WDT80             8 0
     C                   EVAL      UOPUNI='P'
     C                   EVAL      UOPAVD=UVIH_SYAV
     C                   EVAL      UOPLNR=252
     C                   EVAL      UFMSD=1
     C                   Z-ADD     1024          UCMDL            15 5
     C                   MOVE      *BLANKS       UCMD           1024
      *_________________________________
      * Tøm arbetsfil før avgifter total
      *"""""""""""""""""""""""""""""""""
      * Delete av gamla arbetsposter i arbetsfil
     C                   EVAL      *IN53=*OFF
     C     KEYA          SETLL     SVI006F
     C     KEYA          READE     SVI006F                                53
     C     *IN53         DOWEQ     *OFF
     C                   DELETE    SVI006FR
     C     KEYA          READE     SVI006F                                53
     C                   ENDDO
      * Summera avgifter och lægg ut i arbetsfil
     C                   EVAL      *IN53=*OFF
     C     KEYA          SETLL     SVIVA2
     C     KEYA          READE     SVIVA2                                 53
     C     *IN53         DOWEQ     *OFF

     C     SVIVA_ABK     IFNE      '1MT'
     C     KEY006        CHAIN     SVI006F                            54
     C                   IF        *IN54
     C                   EVAL      SVI006F_A=SVIVA_SAV
     C                   EVAL      SVI006F_O=SVIVA_SOP
     C                   EVAL      SVI006F_K=SVIVA_ABK
     C                   EVAL      SVI006F_B=SVIVA_ABB
     C                   WRITE     SVI006FR
     C                   ELSE
     C                   ADD       SVIVA_ABB     SVI006F_B
     C                   UPDATE    SVI006FR
     C                   ENDIF
     C                   ENDIF

     C     KEYA          READE     SVIVA2                                 53
     C                   ENDDO
      *______________________________________
      * Hente firmaopplysninger fra spedisjon
      *""""""""""""""""""""""""""""""""""""""
     C                   READ      FIRM
      *_____________________
      * Hente printerstyring
      *"""""""""""""""""""""
     C     KEYP          CHAIN     KODTP
     C     KEYF          CHAIN     KODTFM
      *_______________
      * Printerstyring
      *"""""""""""""""
     C     CALLTYP       IFEQ      'A'
     C                   EVAL      UCMD='OVRPRTF FILE(SVI007PT) OUTQ(OUTMAIL'
     C                             + ') OVRSCOPE(*JOB) FRONTOVL(SVIT38 0.00 0'
     C                             + '.15)'
     C                   ELSE
     C                   EVAL      UCMD='OVRPRTF FILE(SVI007PT) OUTQ('
     C     UCMD          CAT       KOPNVN:0      UCMD
     C     UCMD          CAT       ')':0         UCMD
     C                   CALL      'QCMDEXC'                            33
     C                   PARM                    UCMD
     C                   PARM                    UCMDL
     C                   ENDIF
     C                   OPEN      SVI007PT
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Læs varuposter                                       SRB /
      *////////////////////////////////////////////////////////////
     C     SRB           BEGSR
      * HEAD
     C     KEYA          CHAIN     SVIH                               51
      * Hur många varuposter och totalt antal sidor ?
     C                   EXSR      ANTSID
      * Init
     C                   EVAL      X03A    =   1
     C                   EVAL      WR32    =   *ZEROS
      * Læs varupost
     C     KEYA          SETLL     SVIV
     C     KEYA          READE     SVIV                                   51
     C     *IN51         DOWEQ     *OFF

     C                   ADD       1             WR32

     C                   EXSR      SRBA
     C
     C                   IF        WR32 > 1
     C     WR32          DIV       3             XR32
     C                   SELECT
     C     XR32D         WHENEQ    '66'
     C                   EXSR      FLYTT1
     C     XR32D         WHENEQ    '00'
     C                   EXSR      FLYTT2
     C     XR32D         WHENEQ    '33'
     C                   EXSR      FLYTT3
     C                   ENDSL
     C                   IF        *IN61
     C                   WRITE     SVI007PTA
     C                   EVAL      *IN61=*OFF
     C                   ENDIF
     C                   ENDIF

     C                   ENDDO

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt variabler fra fil til arbetsfelt              SRBA /
      *////////////////////////////////////////////////////////////
     C     SRBA          BEGSR
      * Clear
     C                   EXSR      FLYTT0
      * R31 Godsmærkning
     C                   EVAL      WR31=SVIV_GODM
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_GOD2
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_GOD3
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_GOD4
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_GOD5
     C                   EXSR      SR31
      * R31 Containernummer
     C                   EVAL      WR31=SVIV_CO01
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO02
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO03
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO04
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO05
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO06
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO07
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO08
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO09
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO10
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO11
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO12
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO13
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO14
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO15
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO16
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO17
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO18
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO19
     C                   EXSR      SR31
     C                   EVAL      WR31=SVIV_CO20
     C                   EXSR      SR31
      * R31 Antal slag och beskrivning
     C                   EVAL      ØN184=SVIV_KOTA
     C                   EXSR      SRNE
     C                   EVAL      WR31=%trim(ØAN)
     C                             + ' ' + %trim(SVIV_KOSL) + ' ' + SVIV_VASL
     C                   EXSR      SR31

     C     SVIV_KOT2     IFGT      *ZEROS
     C     SVIV_KOS2     ORNE      *BLANKS
     C     SVIV_VAS2     ORNE      *BLANKS
     C                   EVAL      ØN184=SVIV_KOT2
     C                   EXSR      SRNE
     C                   EVAL      WR31=%trim(ØAN)
     C                             + ' ' + %trim(SVIV_KOS2) + ' ' + SVIV_VAS2
     C                   EXSR      SR31
     C                   ENDIF

     C     SVIV_KOT3     IFGT      *ZEROS
     C     SVIV_KOS3     ORNE      *BLANKS
     C     SVIV_VAS3     ORNE      *BLANKS
     C                   EVAL      ØN184=SVIV_KOT3
     C                   EXSR      SRNE
     C                   EVAL      WR31=%trim(ØAN)
     C                             + ' ' + %trim(SVIV_KOS3) + ' ' + SVIV_VAS3
     C                   EXSR      SR31
     C                   ENDIF

     C     SVIV_KOT4     IFGT      *ZEROS
     C     SVIV_KOS4     ORNE      *BLANKS
     C     SVIV_VAS4     ORNE      *BLANKS
     C                   EVAL      ØN184=SVIV_KOT4
     C                   EXSR      SRNE
     C                   EVAL      WR31=%trim(ØAN)
     C                             + ' ' + %trim(SVIV_KOS4) + ' ' + SVIV_VAS4
     C                   EXSR      SR31
     C                   ENDIF

      * R32
     C                   EVAL      WR32=SVIV_VANO
      * R33
     C                   MOVEL     SVIV_VATA     WR33A
     C                   MOVE      SVIV_VATA     WR33B
     C                   EVAL      WR33C=SVIV_VATI
     C                   EVAL      WR33D=SVIV_VAT4
     C                   EVAL      WR33E=SVIV_VAT5
      * R34
     C                   EVAL      WR34A=SVIV_ULKD
      * R35
     C                   EVAL      ØN184=SVIV_BRUT
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR35
      * R36
     C                   EVAL      WR36=SVIV_FOKD
      * R37
     C                   EVAL      WR37A=SVIV_EUP1
     C                   MOVEL     SVIV_EUP2     WR37B
      * R38
     C                   EVAL      ØN184=SVIV_NETO
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR38
      * R39
     C                   EVAL      WR39=SVIV_KVOT
      * R40
     C                   EVAL      WR40=SVIV_TIK1
     C     WR40          CAT       SVIV_TIT1:1   WR40
     C     WR40          CAT       SVIV_TIX1:1   WR40
      * R41
     C                   EVAL      ØN184=SVIV_ANKV
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR41
     C                   IF        WR41='0'
     C                   EVAL      WR41=*BLANKS
     C                   ENDIF
      * R42
     C                   EVAL      ØN184=SVIV_FABL
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR42
      * R44 Særskilda upplysningar
     C                   EVAL      WR44=SVIV_SUKO
     C     WR44          CAT       SVIV_SUTX:1   WR44
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT2
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT3
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT4
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT5
     C                   EXSR      SR44
     C                   EVAL      WR44=SVIV_SUK6
     C     WR44          CAT       SVIV_SUT6:1   WR44
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT7
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT8
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUT9
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUTA
     C                   EXSR      SR44
     C                   EVAL      WR44=SVIV_SUKB
     C     WR44          CAT       SVIV_SUTB:1   WR44
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUTC
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUTD
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUTE
     C                   EXSR      SR44
     C                   EVAL      WR44='      ' + SVIV_SUTF
     C                   EXSR      SR44
      * R44 Bilagda handlingar
     C     SVIV_BIT1     CAT       SVIV_BII1:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT2     CAT       SVIV_BII2:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT3     CAT       SVIV_BII3:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT4     CAT       SVIV_BII4:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT5     CAT       SVIV_BII5:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT6     CAT       SVIV_BII6:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT7     CAT       SVIV_BII7:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT8     CAT       SVIV_BII8:1   WR44
     C                   EXSR      SR44
     C     SVIV_BIT9     CAT       SVIV_BII9:1   WR44
     C                   EXSR      SR44
      * R46
     C                   EVAL      ØN184=SVIV_STVA
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR46
      * R47
     C                   EXSR      SRSVIVA
      * Les neste post
     C     KEYA          READE     SVIV                                   51
      * Siste post ?
     C                   IF        *IN51
     C   51              EVAL      *IN61 = *ON
     C                   EXSR      SR47TOT
     C                   ENDIF
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Avslutt                                              SRC /
      *////////////////////////////////////////////////////////////
     C     SRC           BEGSR

     C                   CLOSE     SVI007PT

     C     CALLTYP       IFNE      'A'
     C                   EXSR      ARKSR
     C                   ENDIF

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Antal varuposter oc antal sidor                   ANTSID /
      *////////////////////////////////////////////////////////////
     C     ANTSID        BEGSR
     C     KEYA          SETLL     SVIV
     C     KEYA          READE     SVIV                                   51
     C     *IN51         DOWEQ     *OFF
     C                   ADD       1             XSIDT             5 0
     C     KEYA          READE     SVIV                                   51
     C                   ENDDO
     C     XSIDT         DIV       3             XR32
     C                   EVAL      XSIDT=*ZEROS
     C                   SELECT
     C     XR32D         WHENEQ    '66'
     C     XR32H         ADD       2             XSIDT
     C     XR32D         WHENEQ    '00'
     C     XR32H         ADD       1             XSIDT
     C     XR32D         WHENEQ    '33'
     C     XR32H         ADD       1             XSIDT
     C                   ENDSL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Clear                                             FLYTT0 /
      *////////////////////////////////////////////////////////////
     C     FLYTT0        BEGSR
     C                   EVAL      WR31A   =   *BLANKS
     C                   EVAL      WR33A   =   *BLANKS
     C                   EVAL      WR33B   =   *BLANKS
     C                   EVAL      WR33C   =   *BLANKS
     C                   EVAL      WR33D   =   *BLANKS
     C                   EVAL      WR33E   =   *BLANKS
     C                   EVAL      WR31B   =   *BLANKS
     C                   EVAL      WR31C   =   *BLANKS
     C                   EVAL      WR31D   =   *BLANKS
     C                   EVAL      WR31E   =   *BLANKS
     C                   EVAL      WR34A   =   *BLANKS
     C                   EVAL      WR34B   =   *BLANKS
     C                   EVAL      WR35    =   *BLANKS
     C                   EVAL      WR36    =   *BLANKS
     C                   EVAL      WR31F   =   *BLANKS
     C                   EVAL      WR31G   =   *BLANKS
     C                   EVAL      WR31H   =   *BLANKS
     C                   EVAL      WR31I   =   *BLANKS
     C                   EVAL      WR37A   =   *BLANKS
     C                   EVAL      WR37B   =   *BLANKS
     C                   EVAL      WR38    =   *BLANKS
     C                   EVAL      WR39    =   *BLANKS
     C                   EVAL      WR31J   =   *BLANKS
     C                   EVAL      WR31K   =   *BLANKS
     C                   EVAL      WR31L   =   *BLANKS
     C                   EVAL      WR31M   =   *BLANKS
     C                   EVAL      WR40    =   *BLANKS
     C                   EVAL      WR31N   =   *BLANKS
     C                   EVAL      WR31O   =   *BLANKS
     C                   EVAL      WR44A   =   *BLANKS
     C                   EVAL      WR41    =   *BLANKS
     C                   EVAL      WR42    =   *BLANKS
     C                   EVAL      WR44B   =   *BLANKS
     C                   EVAL      WR44C   =   *BLANKS
     C                   EVAL      WR44D   =   *BLANKS
     C                   EVAL      WR44E   =   *BLANKS
     C                   EVAL      WR44F   =   *BLANKS
     C                   EVAL      WR44G   =   *BLANKS
     C                   EVAL      WR44H   =   *BLANKS
     C                   EVAL      WR44I   =   *BLANKS
     C                   EVAL      WR46    =   *BLANKS
     C                   EVAL      WR47A1  =   *BLANKS
     C                   EVAL      WR47B1  =   *BLANKS
     C                   EVAL      WR47C1  =   *BLANKS
     C                   EVAL      WR47D1  =   *BLANKS
     C                   EVAL      WR47A2  =   *BLANKS
     C                   EVAL      WR47B2  =   *BLANKS
     C                   EVAL      WR47C2  =   *BLANKS
     C                   EVAL      WR47D2  =   *BLANKS
     C                   EVAL      WR47A3  =   *BLANKS
     C                   EVAL      WR47B3  =   *BLANKS
     C                   EVAL      WR47C3  =   *BLANKS
     C                   EVAL      WR47D3  =   *BLANKS
     C                   EVAL      WR47D3  =   *BLANKS
     C                   EVAL      WR47A4  =   *BLANKS
     C                   EVAL      WR47B4  =   *BLANKS
     C                   EVAL      WR47C4  =   *BLANKS
     C                   EVAL      WR47D4  =   *BLANKS
     C                   EVAL      WR47A5  =   *BLANKS
     C                   EVAL      WR47B5  =   *BLANKS
     C                   EVAL      WR47C5  =   *BLANKS
     C                   EVAL      WR47D5  =   *BLANKS
     C                   EVAL      WR47A6  =   *BLANKS
     C                   EVAL      WR47B6  =   *BLANKS
     C                   EVAL      WR47C6  =   *BLANKS
     C                   EVAL      WR47D6  =   *BLANKS
     C                   EVAL      WR47A7  =   *BLANKS
     C                   EVAL      WR47B7  =   *BLANKS
     C                   EVAL      WR47C7  =   *BLANKS
     C                   EVAL      WR47D7  =   *BLANKS
     C                   EVAL      WR47A8  =   *BLANKS
     C                   EVAL      WR47B8  =   *BLANKS
     C                   EVAL      WR47C8  =   *BLANKS
     C                   EVAL      WR47D8  =   *BLANKS
     C                   EVAL      WR47A9  =   *BLANKS
     C                   EVAL      WR47B9  =   *BLANKS
     C                   EVAL      WR47C9  =   *BLANKS
     C                   EVAL      WR47D9  =   *BLANKS
     C                   EVAL      WR47T   =   *BLANKS
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt variabler til skriverfil post-1             FLYTT1 /
      *////////////////////////////////////////////////////////////
     C     FLYTT1        BEGSR
      * Clear første gang
     C                   CLEAR                   SVI007PTA
     C                   EVAL      WTUID=SVIH_TUID
     C                   EVAL      W07=%trim(%editc(SVIH_SYAV:'Z'))
     C                             + '/' + %trim(%editc(SVIH_SYOP:'Z'))
     C                             + '/' + SVIH_SYSG
     C                   EVAL      WMTYP=SVIH_MTYP
     C                   EVAL      W08EORI=SVIH_MOEO
     C                   EVAL      W01A=SVIH_DEK1
     C                   EVAL      W01B=SVIH_DEK2
     C                   EVAL      W08A=SVIH_MONA
     C                   EVAL      W08B=SVIH_MOA1
     C                   EVAL      W08C=SVIH_MOA2
     C                   MOVEL     SVIH_MOPN     W08D
     C     W08D          CAT       SVIH_MOPA:1   W08D
     C                   MOVEL     SVIH_MOLK     W08E
     C                   IF        WR32 > 1
     C                   ADD       1             X03A
     C                   EVAL      W03A      =   X03A
     C                   ENDIF
     C                   EVAL      W03B      =   XSIDT
      * varepostvariabler
     C                   EVAL      WP1R31A   =   WR31A
     C                   EVAL      WP1R32    =   WR32
     C                   EVAL      WP1R33A   =   WR33A
     C                   EVAL      WP1R33B   =   WR33B
     C                   EVAL      WP1R33C   =   WR33C
     C                   EVAL      WP1R33D   =   WR33D
     C                   EVAL      WP1R33E   =   WR33E
     C                   EVAL      WP1R31B   =   WR31B
     C                   EVAL      WP1R31C   =   WR31C
     C                   EVAL      WP1R31D   =   WR31D
     C                   EVAL      WP1R31E   =   WR31E
     C                   EVAL      WP1R34A   =   WR34A
     C                   EVAL      WP1R34B   =   WR34B
     C                   EVAL      WP1R35    =   WR35
     C                   EVAL      WP1R36    =   WR36
     C                   EVAL      WP1R31F   =   WR31F
     C                   EVAL      WP1R31G   =   WR31G
     C                   EVAL      WP1R31H   =   WR31H
     C                   EVAL      WP1R31I   =   WR31I
     C                   EVAL      WP1R37A   =   WR37A
     C                   EVAL      WP1R37B   =   WR37B
     C                   EVAL      WP1R38    =   WR38
     C                   EVAL      WP1R39    =   WR39
     C                   EVAL      WP1R31J   =   WR31J
     C                   EVAL      WP1R31K   =   WR31K
     C                   EVAL      WP1R31L   =   WR31L
     C                   EVAL      WP1R31M   =   WR31M
     C                   EVAL      WP1R40    =   WR40
     C                   EVAL      WP1R31N   =   WR31N
     C                   EVAL      WP1R31O   =   WR31O
     C                   EVAL      WP1R44A   =   WR44A
     C                   EVAL      WP1R41    =   WR41
     C                   EVAL      WP1R42    =   WR42
     C                   EVAL      WP1R44B   =   WR44B
     C                   EVAL      WP1R44C   =   WR44C
     C                   EVAL      WP1R44D   =   WR44D
     C                   EVAL      WP1R44E   =   WR44E
     C                   EVAL      WP1R44F   =   WR44F
     C                   EVAL      WP1R44G   =   WR44G
     C                   EVAL      WP1R44H   =   WR44H
     C                   EVAL      WP1R44I   =   WR44I
     C                   EVAL      WP1R46    =   WR46
     C                   EVAL      WP1R47A1  =   WR47A1
     C                   EVAL      WP1R47B1  =   WR47B1
     C                   EVAL      WP1R47C1  =   WR47C1
     C                   EVAL      WP1R47D1  =   WR47D1
     C                   EVAL      WP1R47A2  =   WR47A2
     C                   EVAL      WP1R47B2  =   WR47B2
     C                   EVAL      WP1R47C2  =   WR47C2
     C                   EVAL      WP1R47D2  =   WR47D2
     C                   EVAL      WP1R47A3  =   WR47A3
     C                   EVAL      WP1R47B3  =   WR47B3
     C                   EVAL      WP1R47C3  =   WR47C3
     C                   EVAL      WP1R47D3  =   WR47D3
     C                   EVAL      WP2R47D3  =   WR47D3
     C                   EVAL      WP1R47A4  =   WR47A4
     C                   EVAL      WP1R47B4  =   WR47B4
     C                   EVAL      WP1R47C4  =   WR47C4
     C                   EVAL      WP1R47D4  =   WR47D4
     C                   EVAL      WP1R47A5  =   WR47A5
     C                   EVAL      WP1R47B5  =   WR47B5
     C                   EVAL      WP1R47C5  =   WR47C5
     C                   EVAL      WP1R47D5  =   WR47D5
     C                   EVAL      WP1R47A6  =   WR47A6
     C                   EVAL      WP1R47B6  =   WR47B6
     C                   EVAL      WP1R47C6  =   WR47C6
     C                   EVAL      WP1R47D6  =   WR47D6
     C                   EVAL      WP1R47A7  =   WR47A7
     C                   EVAL      WP1R47B7  =   WR47B7
     C                   EVAL      WP1R47C7  =   WR47C7
     C                   EVAL      WP1R47D7  =   WR47D7
     C                   EVAL      WP1R47A8  =   WR47A8
     C                   EVAL      WP1R47B8  =   WR47B8
     C                   EVAL      WP1R47C8  =   WR47C8
     C                   EVAL      WP1R47D8  =   WR47D8
     C                   EVAL      WP1R47A9  =   WR47A9
     C                   EVAL      WP1R47B9  =   WR47B9
     C                   EVAL      WP1R47C9  =   WR47C9
     C                   EVAL      WP1R47D9  =   WR47D9
     C                   EVAL      WP1R47T   =   WR47T
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt variabler til skriverfil post-2             FLYTT2 /
      *////////////////////////////////////////////////////////////
     C     FLYTT2        BEGSR
     C                   EVAL      WP2R31A   =   WR31A
     C                   EVAL      WP2R32    =   WR32
     C                   EVAL      WP2R33A   =   WR33A
     C                   EVAL      WP2R33B   =   WR33B
     C                   EVAL      WP2R33C   =   WR33C
     C                   EVAL      WP2R33D   =   WR33D
     C                   EVAL      WP2R33E   =   WR33E
     C                   EVAL      WP2R31B   =   WR31B
     C                   EVAL      WP2R31C   =   WR31C
     C                   EVAL      WP2R31D   =   WR31D
     C                   EVAL      WP2R31E   =   WR31E
     C                   EVAL      WP2R34A   =   WR34A
     C                   EVAL      WP2R34B   =   WR34B
     C                   EVAL      WP2R35    =   WR35
     C                   EVAL      WP2R36    =   WR36
     C                   EVAL      WP2R31F   =   WR31F
     C                   EVAL      WP2R31G   =   WR31G
     C                   EVAL      WP2R31H   =   WR31H
     C                   EVAL      WP2R31I   =   WR31I
     C                   EVAL      WP2R37A   =   WR37A
     C                   EVAL      WP2R37B   =   WR37B
     C                   EVAL      WP2R38    =   WR38
     C                   EVAL      WP2R39    =   WR39
     C                   EVAL      WP2R31J   =   WR31J
     C                   EVAL      WP2R31K   =   WR31K
     C                   EVAL      WP2R31L   =   WR31L
     C                   EVAL      WP2R31M   =   WR31M
     C                   EVAL      WP2R40    =   WR40
     C                   EVAL      WP2R31N   =   WR31N
     C                   EVAL      WP2R31O   =   WR31O
     C                   EVAL      WP2R44A   =   WR44A
     C                   EVAL      WP2R41    =   WR41
     C                   EVAL      WP2R42    =   WR42
     C                   EVAL      WP2R44B   =   WR44B
     C                   EVAL      WP2R44C   =   WR44C
     C                   EVAL      WP2R44D   =   WR44D
     C                   EVAL      WP2R44E   =   WR44E
     C                   EVAL      WP2R44F   =   WR44F
     C                   EVAL      WP2R44G   =   WR44G
     C                   EVAL      WP2R44H   =   WR44H
     C                   EVAL      WP2R44I   =   WR44I
     C                   EVAL      WP2R46    =   WR46
     C                   EVAL      WP2R47A1  =   WR47A1
     C                   EVAL      WP2R47B1  =   WR47B1
     C                   EVAL      WP2R47C1  =   WR47C1
     C                   EVAL      WP2R47D1  =   WR47D1
     C                   EVAL      WP2R47A2  =   WR47A2
     C                   EVAL      WP2R47B2  =   WR47B2
     C                   EVAL      WP2R47C2  =   WR47C2
     C                   EVAL      WP2R47D2  =   WR47D2
     C                   EVAL      WP2R47A3  =   WR47A3
     C                   EVAL      WP2R47B3  =   WR47B3
     C                   EVAL      WP2R47C3  =   WR47C3
     C                   EVAL      WP2R47D3  =   WR47D3
     C                   EVAL      WP2R47D3  =   WR47D3
     C                   EVAL      WP2R47A4  =   WR47A4
     C                   EVAL      WP2R47B4  =   WR47B4
     C                   EVAL      WP2R47C4  =   WR47C4
     C                   EVAL      WP2R47D4  =   WR47D4
     C                   EVAL      WP2R47A5  =   WR47A5
     C                   EVAL      WP2R47B5  =   WR47B5
     C                   EVAL      WP2R47C5  =   WR47C5
     C                   EVAL      WP2R47D5  =   WR47D5
     C                   EVAL      WP2R47A6  =   WR47A6
     C                   EVAL      WP2R47B6  =   WR47B6
     C                   EVAL      WP2R47C6  =   WR47C6
     C                   EVAL      WP2R47D6  =   WR47D6
     C                   EVAL      WP2R47A7  =   WR47A7
     C                   EVAL      WP2R47B7  =   WR47B7
     C                   EVAL      WP2R47C7  =   WR47C7
     C                   EVAL      WP2R47D7  =   WR47D7
     C                   EVAL      WP2R47A8  =   WR47A8
     C                   EVAL      WP2R47B8  =   WR47B8
     C                   EVAL      WP2R47C8  =   WR47C8
     C                   EVAL      WP2R47D8  =   WR47D8
     C                   EVAL      WP2R47A9  =   WR47A9
     C                   EVAL      WP2R47B9  =   WR47B9
     C                   EVAL      WP2R47C9  =   WR47C9
     C                   EVAL      WP2R47D9  =   WR47D9
     C                   EVAL      WP2R47T   =   WR47T
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Flytt variabler til skriverfil post-3             FLYTT3 /
      *////////////////////////////////////////////////////////////
     C     FLYTT3        BEGSR
     C                   EVAL      *IN61     =   *ON
     C                   EVAL      WP3R31A   =   WR31A
     C                   EVAL      WP3R32    =   WR32
     C                   EVAL      WP3R33A   =   WR33A
     C                   EVAL      WP3R33B   =   WR33B
     C                   EVAL      WP3R33C   =   WR33C
     C                   EVAL      WP3R33D   =   WR33D
     C                   EVAL      WP3R33E   =   WR33E
     C                   EVAL      WP3R31B   =   WR31B
     C                   EVAL      WP3R31C   =   WR31C
     C                   EVAL      WP3R31D   =   WR31D
     C                   EVAL      WP3R31E   =   WR31E
     C                   EVAL      WP3R34A   =   WR34A
     C                   EVAL      WP3R34B   =   WR34B
     C                   EVAL      WP3R35    =   WR35
     C                   EVAL      WP3R36    =   WR36
     C                   EVAL      WP3R31F   =   WR31F
     C                   EVAL      WP3R31G   =   WR31G
     C                   EVAL      WP3R31H   =   WR31H
     C                   EVAL      WP3R31I   =   WR31I
     C                   EVAL      WP3R37A   =   WR37A
     C                   EVAL      WP3R37B   =   WR37B
     C                   EVAL      WP3R38    =   WR38
     C                   EVAL      WP3R39    =   WR39
     C                   EVAL      WP3R31J   =   WR31J
     C                   EVAL      WP3R31K   =   WR31K
     C                   EVAL      WP3R31L   =   WR31L
     C                   EVAL      WP3R31M   =   WR31M
     C                   EVAL      WP3R40    =   WR40
     C                   EVAL      WP3R31N   =   WR31N
     C                   EVAL      WP3R31O   =   WR31O
     C                   EVAL      WP3R44A   =   WR44A
     C                   EVAL      WP3R41    =   WR41
     C                   EVAL      WP3R42    =   WR42
     C                   EVAL      WP3R44B   =   WR44B
     C                   EVAL      WP3R44C   =   WR44C
     C                   EVAL      WP3R44D   =   WR44D
     C                   EVAL      WP3R44E   =   WR44E
     C                   EVAL      WP3R44F   =   WR44F
     C                   EVAL      WP3R44G   =   WR44G
     C                   EVAL      WP3R44H   =   WR44H
     C                   EVAL      WP3R44I   =   WR44I
     C                   EVAL      WP3R46    =   WR46
     C                   EVAL      WP3R47A1  =   WR47A1
     C                   EVAL      WP3R47B1  =   WR47B1
     C                   EVAL      WP3R47C1  =   WR47C1
     C                   EVAL      WP3R47D1  =   WR47D1
     C                   EVAL      WP3R47A2  =   WR47A2
     C                   EVAL      WP3R47B2  =   WR47B2
     C                   EVAL      WP3R47C2  =   WR47C2
     C                   EVAL      WP3R47D2  =   WR47D2
     C                   EVAL      WP3R47A3  =   WR47A3
     C                   EVAL      WP3R47B3  =   WR47B3
     C                   EVAL      WP3R47C3  =   WR47C3
     C                   EVAL      WP3R47D3  =   WR47D3
     C                   EVAL      WP3R47D3  =   WR47D3
     C                   EVAL      WP3R47A4  =   WR47A4
     C                   EVAL      WP3R47B4  =   WR47B4
     C                   EVAL      WP3R47C4  =   WR47C4
     C                   EVAL      WP3R47D4  =   WR47D4
     C                   EVAL      WP3R47A5  =   WR47A5
     C                   EVAL      WP3R47B5  =   WR47B5
     C                   EVAL      WP3R47C5  =   WR47C5
     C                   EVAL      WP3R47D5  =   WR47D5
     C                   EVAL      WP3R47A6  =   WR47A6
     C                   EVAL      WP3R47B6  =   WR47B6
     C                   EVAL      WP3R47C6  =   WR47C6
     C                   EVAL      WP3R47D6  =   WR47D6
     C                   EVAL      WP3R47A7  =   WR47A7
     C                   EVAL      WP3R47B7  =   WR47B7
     C                   EVAL      WP3R47C7  =   WR47C7
     C                   EVAL      WP3R47D7  =   WR47D7
     C                   EVAL      WP3R47A8  =   WR47A8
     C                   EVAL      WP3R47B8  =   WR47B8
     C                   EVAL      WP3R47C8  =   WR47C8
     C                   EVAL      WP3R47D8  =   WR47D8
     C                   EVAL      WP3R47A9  =   WR47A9
     C                   EVAL      WP3R47B9  =   WR47B9
     C                   EVAL      WP3R47C9  =   WR47C9
     C                   EVAL      WP3R47D9  =   WR47D9
     C                   EVAL      WP3R47T   =   WR47T
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Ordna R31                                           SR31 /
      *////////////////////////////////////////////////////////////
     C     SR31          BEGSR
     C                   SELECT
     C     WR31A         WHENEQ    *BLANKS
     C                   EVAL      WR31A=WR31
     C     WR31B         WHENEQ    *BLANKS
     C                   EVAL      WR31B=WR31
     C     WR31C         WHENEQ    *BLANKS
     C                   EVAL      WR31C=WR31
     C     WR31D         WHENEQ    *BLANKS
     C                   EVAL      WR31D=WR31
     C     WR31E         WHENEQ    *BLANKS
     C                   EVAL      WR31E=WR31
     C     WR31F         WHENEQ    *BLANKS
     C                   EVAL      WR31F=WR31
     C     WR31G         WHENEQ    *BLANKS
     C                   EVAL      WR31G=WR31
     C     WR31H         WHENEQ    *BLANKS
     C                   EVAL      WR31H=WR31
     C     WR31I         WHENEQ    *BLANKS
     C                   EVAL      WR31I=WR31
     C     WR31J         WHENEQ    *BLANKS
     C                   EVAL      WR31J=WR31
     C     WR31K         WHENEQ    *BLANKS
     C                   EVAL      WR31K=WR31
     C     WR31L         WHENEQ    *BLANKS
     C                   EVAL      WR31L=WR31
     C     WR31M         WHENEQ    *BLANKS
     C                   EVAL      WR31M=WR31
     C     WR31N         WHENEQ    *BLANKS
     C                   EVAL      WR31N=WR31
     C     WR31O         WHENEQ    *BLANKS
     C                   EVAL      WR31O=WR31
     C                   ENDSL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Ordna R44                                           SR44 /
      *////////////////////////////////////////////////////////////
     C     SR44          BEGSR
     C                   SELECT
     C     WR44A         WHENEQ    *BLANKS
     C                   EVAL      WR44A=WR44
     C     WR44B         WHENEQ    *BLANKS
     C                   EVAL      WR44B=WR44
     C     WR44C         WHENEQ    *BLANKS
     C                   EVAL      WR44C=WR44
     C     WR44D         WHENEQ    *BLANKS
     C                   EVAL      WR44D=WR44
     C     WR44E         WHENEQ    *BLANKS
     C                   EVAL      WR44E=WR44
     C     WR44F         WHENEQ    *BLANKS
     C                   EVAL      WR44F=WR44
     C     WR44G         WHENEQ    *BLANKS
     C                   EVAL      WR44G=WR44
     C     WR44H         WHENEQ    *BLANKS
     C                   EVAL      WR44H=WR44
     C     WR44I         WHENEQ    *BLANKS
     C                   EVAL      WR44I=WR44
     C                   ENDSL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Ordna R47                                           SR47 /
      *////////////////////////////////////////////////////////////
     C     SR47          BEGSR
     C                   SELECT
     C     WR47A1        WHENEQ    *BLANKS
     C                   EVAL      WR47A1=WR47A
     C                   EVAL      WR47B1=WR47B
     C                   EVAL      WR47C1=WR47C
     C                   EVAL      WR47D1=WR47D
     C     WR47A2        WHENEQ    *BLANKS
     C                   EVAL      WR47A2=WR47A
     C                   EVAL      WR47B2=WR47B
     C                   EVAL      WR47C2=WR47C
     C                   EVAL      WR47D2=WR47D
     C     WR47A3        WHENEQ    *BLANKS
     C                   EVAL      WR47A3=WR47A
     C                   EVAL      WR47B3=WR47B
     C                   EVAL      WR47C3=WR47C
     C                   EVAL      WR47D3=WR47D
     C     WR47A4        WHENEQ    *BLANKS
     C                   EVAL      WR47A4=WR47A
     C                   EVAL      WR47B4=WR47B
     C                   EVAL      WR47C4=WR47C
     C                   EVAL      WR47D4=WR47D
     C     WR47A5        WHENEQ    *BLANKS
     C                   EVAL      WR47A5=WR47A
     C                   EVAL      WR47B5=WR47B
     C                   EVAL      WR47C5=WR47C
     C                   EVAL      WR47D5=WR47D
     C     WR47A6        WHENEQ    *BLANKS
     C                   EVAL      WR47A6=WR47A
     C                   EVAL      WR47B6=WR47B
     C                   EVAL      WR47C6=WR47C
     C                   EVAL      WR47D6=WR47D
     C     WR47A7        WHENEQ    *BLANKS
     C                   EVAL      WR47A7=WR47A
     C                   EVAL      WR47B7=WR47B
     C                   EVAL      WR47C7=WR47C
     C                   EVAL      WR47D7=WR47D
     C     WR47A8        WHENEQ    *BLANKS
     C                   EVAL      WR47A8=WR47A
     C                   EVAL      WR47B8=WR47B
     C                   EVAL      WR47C8=WR47C
     C                   EVAL      WR47D8=WR47D
     C     WR47A9        WHENEQ    *BLANKS
     C                   EVAL      WR47A9=WR47A
     C                   EVAL      WR47B9=WR47B
     C                   EVAL      WR47C9=WR47C
     C                   EVAL      WR47D9=WR47D
     C                   ENDSL
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Total av alla R47                                SR47TOT /
      *////////////////////////////////////////////////////////////
     C     SR47TOT       BEGSR
     C                   EVAL      *IN53=*OFF
     C     KEYA          SETLL     SVI006F
     C     KEYA          READE     SVI006F                                53
     C     *IN53         DOWEQ     *OFF

     C                   ADD       SVI006F_B     XPTR47T          11 0
     C                   SELECT

     C     WPTR47A1      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A1=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D1

     C     WPTR47A2      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A2=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D2

     C     WPTR47A3      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A3=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D3

     C     WPTR47A4      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A4=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D4

     C     WPTR47A5      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A5=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D5

     C     WPTR47A6      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A6=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D6

     C     WPTR47A7      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A7=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D7

     C     WPTR47A8      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A8=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D8

     C     WPTR47A9      WHENEQ    *BLANKS
     C                   EVAL      WPTR47A9=SVI006F_K
     C                   EVAL      ØN184=SVI006F_B
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47D9

     C                   ENDSL

     C     KEYA          READE     SVI006F                                53
     C                   ENDDO
     C                   EVAL      ØN184=XPTR47T
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WPTR47T
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  LES SVIVA                                        SRSVIVA /
      *////////////////////////////////////////////////////////////
     C     SRSVIVA       BEGSR
     C                   EVAL      XR47T=*ZEROS
     C                   EVAL      *IN52=*OFF
     C     KEYB          SETLL     SVIVA
     C     KEYB          READE     SVIVA                                  52
     C     *IN52         DOWEQ     *OFF

     C                   EVAL      WR47A=SVIVA_ABK
     C                   EVAL      ØN184=SVIVA_ABG
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR47B
     C                   EVAL      ØN184=SVIVA_ABS
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR47C
     C                   EVAL      ØN184=SVIVA_ABB
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR47D
     C     WR32          IFEQ      7
     C  N77              SETOFF                                       77
     C                   ENDIF
     C                   ADD       SVIVA_ABB     XR47T            15 0
     C                   EVAL      ØN184=XR47T
     C                   EXSR      SRNE
     C                   MOVEL     ØAN           WR47T
     C                   IF        WR47A='1MT'
     C                   EVAL      WR47C=*BLANKS
     C                   EVAL      WR47D=*BLANKS
     C                   ENDIF
     C                   EXSR      SR47
      * summera totaler till workfile

     C     KEYB          READE     SVIVA                                  52
     C                   ENDDO
     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *  Venstrestill numeriske verdier                      SRNE /
      *////////////////////////////////////////////////////////////
     C     SRNE          BEGSR
      * Flytte in rett verdi i Alfa 12-felt
     C                   MOVE      *ZEROS        ØA13
     C     ØA184D        IFEQ      '0000'                                       <-------------I
     C                   MOVE      ØA184H        ØA13                                         I
     C                   ELSE                                                   <-------------I
     C                   MOVEL     ØA184X        ØA13                                         I
     C                   MOVE      ',    '       ØA13                                         I
     C                   MOVE      ØA184D        ØA13                                         I
     C     Ø13(13)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(13)
     C     Ø13(12)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(12)
     C     Ø13(11)       IFEQ      '0'
     C                   MOVE      ' '           Ø13(11)
     C                   END
     C                   END
     C                   END
     C                   END                                                    <-------------I
      * lete fra venstre og finn foerste siffer over 0
     C     1             DO        12            ØX                2 0          <-------------I
     C     Ø13(ØX)       IFNE      '0'                                           <-----------II
     C     Ø13(ØX)       IFEQ      ','                                           <-----------II
     C                   SUB       1             ØX
     C                   ENDIF                                                   <-----------II
     C                   GOTO      SRNE1                                                     II
     C                   ENDIF                                                   <-----------II
     C                   ENDDO                                                  <-------------I
     C     SRNE1         TAG
      * Venstrestill til et nytt felt
     C                   MOVE      *BLANKS       ØAN              12
     C                   MOVEA     Ø13(ØX)       ØAN

     C                   ENDSR
      *////////////////////////////////////////////////////////////
      *    Arkiver                                          ARKSR /
      /////////////////////////////////////////////////////////////
     C     ARKSR         BEGSR
      * SKAL DOKUMENT ARKIVERES ?
     C                   MOVE      'S1'          ARTYPE
     C     FIFIRM        CHAIN     FIRMARC                            34
     C  N34ARTYPE        CHAIN     ARKTXT                             34
     C     *IN(34)       IFEQ      '0'
     C     ARKJN         ANDEQ     'J'

     C                   z-add     SVIH_AVKN     ARKUND
     C                   MOVE      FIFIRM        ARFIRM
     C                   MOVE      UVIH_SYAV     ARAVD
     C                   MOVE      UVIH_SYOP     AROPD
     C                   MOVE      WDT           ARDATE
     C                   MOVE      WTM           ARTIME
     C                   MOVE      ZUSER         ARUSER
     C                   MOVE      UVIH_SYOP     ARUNDE
     C                   MOVEL     'S1:'         ARUNDE
     C                   WRITE     ARKIVR
     C                   ENDIF
     C                   CALL      'ARC002CLB'
     C                   PARM      'S1'          WATYPE            2
     C                   PARM                    ARUSER
     C                   ENDSR
