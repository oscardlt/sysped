      *
      ***********************************************************
      *** PROGRAM FOR CHANGING ORDER OR INVOICE               ***
      *** INDICATORER 01 - 26 KUN       CMD  / ROLL           ***
      *** FRE    INDICATORER 01 02 04 06-09 11-26             ***
      *** FREE   INDICATORER 27-29 31-94                      ***
      ***********************************************************
      *
     FFERDL01   UF   E           K DISK
     FHEADF     UF   E           K DISK
     FKODTA     IF   E           K DISK
     FKODTSF    IF   E           K DISK
     FSYFF10FM  CF   E             WORKSTN
     D                UDS
     D  UFIRM                  1      2
     D  UAVD                  15     18
     D  USG                   19     21
     D  UOPD                  22     28
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C  N30              DO
     C                   MOVE      *ZEROS        WSOPD
     C                   END
     C                   EXFMT     BILDE
     C                   SETOFF                                       309596
     C                   SETOFF                                       979899
     C*
     C   03              GOTO      SLUTT
     C                   EXSR      TESTB1
     C   30              GOTO      START
     C   10              GOTO      START
     C*
     C     HEUR          IFEQ      'A'
     C                   EXSR      ENDREA
     C                   END
     C     HEUR          IFEQ      'B'
     C                   EXSR      ENDREB
     C                   END
     C     HEUR          IFEQ      'C'
     C                   EXSR      ENDREC
     C                   END
     C     HEUR          IFEQ      'E'
     C                   EXSR      ENDREE
     C                   END
     C     HEUR          IFEQ      'D'
     C                   EXSR      ENDRED
     C                   END
     C     HEUR          IFEQ      'F'
     C                   EXSR      ENDREF
     C                   END
     C     HEUR          IFEQ      'G'
     C                   EXSR      ENDREG
     C                   END
     C     HEUR          IFEQ      'H'
     C                   EXSR      ENDREH
     C                   END
     C*
     C     HEADFK        CHAIN     HEADF                              33
     C                   MOVE      XST           HEST
     C  N33              UPDATE    HEADFR
     C*
     C*
     C                   GOTO      START
     C*
     C     SLUTT         TAG
     C                   MOVE      WSAVD         UAVD
     C                   MOVE      WSSG          USG
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C*
     C**** TEST PERSONCODE
     C     KODSFK        CHAIN     KODTSF                             99
     C   99              SETON                                        30
     C   99              MOVE      'SPS0001'     MSGNR
     C   99              GOTO      SLT1
     C*
     C*** TEST DEPARTMENT
     C     KODTAK        CHAIN     KODTA                              98
     C   98              MOVE      'SPA0001'     MSGNR
     C   98              SETON                                        30
     C   98              GOTO      SLT1
     C*
     C*** TEST ORDERNUMBER
     C     HEADFK        CHAIN     HEADF                              97
     C   97              SETON                                        30
     C   97              MOVE      'SPO0001'     MSGNR
     C   97              GOTO      SLT1
     C*
     C* STATUSCODE MUST BE 'F' 'O' 'H' ' '
     C*
     C     HEST          IFNE      ' '
     C     HEST          ANDNE     'F'
     C     HEST          ANDNE     'O'
     C     HEST          ANDNE     'H'
     C                   UPDATE    HEADFR
     C                   SETON                                        3095
     C                   GOTO      SLT1
     C                   END
     C*
     C* SAME PERSON MADE ORDER
     C*
     C     WSSG          COMP      HESG                               9696
     C   96              UPDATE    HEADFR
     C   96              SETON                                        3099
     C   96              MOVE      'SPS0002'     MSGNR
     C   96              GOTO      SLT1
     C*
     C* DELETE READYMARKET
     C*
     C   10              DO
     C     HEADFK        CHAIN     FERDL01                            33
     C  N33              DELETE    FERDR
     C                   UPDATE    HEADFR
     C                   GOTO      SLT1
     C                   END
     C*
     C                   MOVE      HEST          XST               1
     C                   MOVE      ' '           HEST
     C                   UPDATE    HEADFR
     C   05              MOVE      'O'           UENDRE            1
     C  N05              MOVE      'F'           UENDRE
     C   05              MOVE      'CHO'         UTYPE             3
     C  N05              MOVE      'CHF'         UTYPE
     C*
     C     SLT1          ENDSR
     C*
     C***********************************************
     C     ENDREA        BEGSR
     C***********************************************
     C                   CALL      'SYFA10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY            1
     C                   PARM                    UAVDNY            4 0
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREB        BEGSR
     C***********************************************
     C                   CALL      'SYEX10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   PARM                    UDUMMY            1
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREC        BEGSR
     C***********************************************
     C                   CALL      'SYFI10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREE        BEGSR
     C***********************************************
     C                   CALL      'SYIN10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDRED        BEGSR
     C***********************************************
     C                   CALL      'SYEF10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREF        BEGSR
     C***********************************************
     C                   CALL      'SYSJ10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREG        BEGSR
     C***********************************************
     C                   CALL      'SYSE10'
     C                   PARM                    WSAVD
     C                   PARM                    WSOPD
     C                   PARM                    WSSG
     C                   PARM                    UTYPE
     C                   PARM                    UKODE
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     ENDREH        BEGSR
     C***********************************************
     C                   MOVE      'A'           SY10P1            1
     C                   MOVE      '6'           SY10P2            1
     C                   MOVE      '0'           SY10P3            1
     C                   CALL      'SYTR10'
     C                   PARM                    WSAVD
     C                   PARM                    WSAVDC            4 0
     C                   PARM                    WSOPD
     C                   PARM                    SY10P1
     C                   PARM                    SY10P2
     C                   PARM                    SY10P3
     C*
     C                   ENDSR
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     HEADFK        KLIST
     C                   KFLD                    WSAVD
     C                   KFLD                    WSOPD
     C     KODTAK        KLIST
     C                   KFLD                    XAUNI
     C                   KFLD                    WSAVD
     C     KODSFK        KLIST
     C                   KFLD                    XSFUNI
     C                   KFLD                    WSSG
     C*
     C     *ENTRY        PLIST
     C*** UKODE = 'O' KALLE FRA SYFF10CLO
     C*** UKODE = 'S' CALL FROM SYFF10CLS
     C*** UKODE = 'K' CALL FROM SYFF10CLK
     C*** UKODE = 'A' CALL FROM ?????????
     C                   PARM                    UKODE             1
     C*
     C                   MOVE      UAVD          WSAVD
     C                   MOVE      USG           WSSG
     C                   MOVE      *ZEROS        UOPD
     C                   MOVE      'A'           XAUNI             1
     C                   MOVE      'SF'          XSFUNI            2
     C                   Z-ADD     0             PPUNIK            9 0
     C                   MOVEL     *BLANKS       PPREFF           17
     C*
     C                   ENDSR
     C*
