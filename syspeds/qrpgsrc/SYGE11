********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
11132 * 01 YBC PTF11 3 DESIMALER
********************************************************************
      *
      ***********************************************************
      *** PROGRAM SKAL VEDLIKEHOLDE SAKSBEHANDLER(SIGNATUR)   ***
      *** INDIKATORER 01 - 26 KUN CMD-TASTER / ROLL TASTER    ***
      *** LEDIGE INDIKATORER 01 02 04 07 09-11 13-24          ***
      *** LEDIGE INDIKATORER 27-29 31 32 34-39 41-88 95-97    ***
      ***********************************************************
      *
     FSYGE11FM  CF   E             WORKSTN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  KOSFNV                 1     16
     D  KOSFN7                 1      7
     C*
     C                   EXSR      INIT
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
      *
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C                   Z-ADD     13            LINNBR
     C                   Z-ADD     09            POSNBR
     C                   EXFMT     VARELI
     C*** AVSLUTT
     C   03              GOTO      SLUTT
     C   12              GOTO      SLUTT
     C   25
     COR 26              GOTO      START3
     C                   SETOFF                                       309089
     C     WSNUM         IFNE      *ZEROS
     C                   EXSR      SKRIV
     C                   END
     C                   GOTO      START3
     C*
     C*
     C                   SETOFF                                       9899
     C*
     C                   GOTO      START3
     C     SLUTT         TAG
     C     *IN03         IFEQ      *ON
     C                   Z-ADD     SUM           UVALUE
     C                   END
     C                   SETON                                        LR
     C                   RETURN
     C*
     C***********************************************
     C     SKRIV         BEGSR
     C***********************************************
     C*** OPPDATERE PÅ REGISTER OG SUBFIL
      *
      * MULTIPLIKASJON
      *
     C     WSARI         IFEQ      '*'
     C     WSARI         OREQ      'X'
     C     WSNUM         MULT      WSNUM2        WSNUM
     C                   END
      *
      * DIVISJON
      *
     C     WSARI         IFEQ      '/'
     C     WSARI         OREQ      ':'
     C     WSNUM         DIV       WSNUM2        WSNUM
     C                   END
      *
      * PROSENT
      *
     C     WSARI         IFEQ      '%'
     C     WSARI         OREQ      'P'
     C     WSNUM         MULT      WSNUM2        WSWRK            15 4
     C     WSWRK         DIV(H)    100           WSNUM
     C                   END
      *
      *
      * ADDISJON
      *
     C     WSARI         IFEQ      '+'
     C     WSNUM         ADD       WSNUM2        WSNUM
     C                   END
      *
      * SUBTRAKSJON
      *
     C     WSARI         IFEQ      '-'
     C     WSNUM         SUB       WSNUM2        WSNUM
     C                   END
      *
      *
      * HVIS 3. FAKTOR ER GITT, JOBB VIDERE PÅ DELSUM FRA 2 FØRSTE
     C     WSNUM3        IFNE      *ZEROS
      * MULTIPLIKASJON
      *
     C     WSARI2        IFEQ      '*'
     C     WSARI2        OREQ      'X'
     C     WSNUM         MULT      WSNUM3        WSNUM
     C                   END
      *
      * DIVISJON
      *
     C     WSARI2        IFEQ      '/'
     C     WSARI2        OREQ      ':'
     C     WSNUM         DIV       WSNUM3        WSNUM
     C                   END
      *
      * PROSENT
      *
     C     WSARI2        IFEQ      '%'
     C     WSARI2        OREQ      'P'
     C     WSNUM         MULT      WSNUM3        WSWRK            15 4
     C     WSWRK         DIV(H)    100           WSNUM
     C                   END
      *
      *
      * ADDISJON
      *
     C     WSARI2        IFEQ      '+'
     C     WSNUM         ADD       WSNUM3        WSNUM
     C                   END
      *
      * SUBTRAKSJON
      *
     C     WSARI2        IFEQ      '-'
     C     WSNUM         SUB       WSNUM3        WSNUM
     C                   END
      *
     C                   END                                                    WSNUM3 NE 0
      *
     C                   MOVE      *BLANKS       WSARI
     C                   MOVE      *ZEROS        WSNUM2
     C                   MOVE      *BLANKS       WSARI2
     C                   MOVE      *ZEROS        WSNUM3
      *
S01  C*                  ADD       WSNUM         SUM              13 2
N01  C                   ADD       WSNUM         SUM
     C                   MOVE      WSNUM         SFNUM
     C                   ADD       1             YRECNO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   WRITE     SUBFIL
     C                   WRITE     SUBCTL
     C                   MOVE      *ZEROS        WSNUM
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     *ENTRY        PLIST
S01  C*                  PARM                    UVALUE           13 2
N01  C                   PARM                    UVALUE           13 3
     C                   WRITE     WINDOWSZ
     C                   Z-ADD     UVALUE        WSNUM
     C                   ENDSR
     C*
