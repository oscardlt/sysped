********************************************************************
      * RETTINGER I DETTE PROGRAM:
PTFnr:*Sek Sig Vers  Beskrivelse...........................
""""""*"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
10XXX * 01 YBC PTF10 SLUTT DATO PÅ TOLLTARIFF
10XXX * 02 YBC PTF10 SÆRAVGIFT I ØRE MÅ AVRUNDES TO GANGER. FØRST
      *              AVRUNDES TIL HEL ØRE, SÅ TIL KRONER
10XXX * 03 YBC PTF10 HENT MOMS SATS
10286 * 04 YBC PTF10 FELT FPR "MERKE & NR" ER ØKT FRA 17 TIL 28
xxxxxx*xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
11020 * 05 YBC PTF11 TARIFFREG. HAR FLERE NYE LAND OG REGIONER
11XXX * 06 YBC PTF11 FLERE FELTER IKKE KREVES
********************************************************************
      ***********************************************************
      *** PROGRAM FOR Å REGISTRERE BILFORTOLLING              ***
      ***********************************************************
*AVG* * LINJER HVOR AVG. LIGGER HARDKODET ER MERKET SOM VIST HER...
     H DECEDIT('0,') DATEDIT(*DMY.)
     FSADH      UF   E           K DISK
     FSADW      UF A E           K DISK
     FSADBIL    UF A E           K DISK
     FMULTKOD2  IF   E           K DISK
     FKODTVAL2  IF   E           K DISK
     FKODTSB    IF   E           K DISK
     FKODTS8L2  IF   E           K DISK
     F                                     RENAME(KOS8R:KOS8RL2)
     FKUFAST    IF   E           K DISK
     FTARI      IF   E           K DISK
     FFIRM      IF   E           K DISK
     FSYPTFF    IF   E           K DISK
     FSADSD     IF   E           K DISK
     FSAD061FB  CF   E             WORKSTN USROPN
     F                                     SFILE(SUBFIL:ZRECNO)
     F                                     INFDS(FBAREA)
     D A1              S              1    DIM(5) CTDATA PERRCD(5)
     D BR              S             20    DIM(200)
     D LI              S              5  0 DIM(200)
     D UN              S              1    DIM(17)
     D*
     D FBAREA          DS
     D  WSCLOC               370    371B 0
     D  WSSUBN               378    379B 0
     D                 DS
     D  SITRT                  1      7  0
     D  SISLAA                 1      1  0
     D  SIDFVF                 2      2  0
     D*** SI28 I SADH ER TATT I BRUK (FØRST 15 POS.)
     D                 DS
     D  SI28                   1     28
     D  SIBELC                 1     11  2
     D  SIRAB                 12     15  2
     D  SIRABX                12     15
     D  SI27                   1     27
     D                 DS
     D  SWPACB                 1     15
     D  SWPA11                 1     11
     D                 DS
     D  W2UNNR                 1     17
     D  W2UN17                17     17
     D                 DS
     D  W2PC2A                 1      5  2
     D  PROFAK                 1      5  4
     D                 DS
     D  KS8FTX                 1     52
     D  KS8MIL                52     52
     D  KS8ØRE                51     51
     C*
     C                   OPEN      SAD061FB
     C                   EXSR      INIT
     C  N99              DO
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '01'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
     C                   Z-ADD     *ZEROS        YRECNO
     C                   EXSR      MOVB2
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     4             POSNBR
     C                   MOVE      SIDFVF        W2VF
     C                   MOVE      '  '          XSNR
     C                   WRITE     NYWRK
     C                   GOTO      START6
     C                   END
     C*
     C     START         TAG
     C                   MOVE      '1'           *IN93
     C                   WRITE     SUBCTL
     C                   MOVEA     '00'          *IN(93)
     C                   Z-ADD     *ZEROS        ZRECNO
      *_____________
      * Fyll Subfile
      *"""""""""""""
     C     SADW1K        SETLL     SADW
     C     START1        TAG
     C     UAVD          READE(N)  SADW                                   94
     C  N94UTDN          COMP      SWTDN                              9494
     C  N94              MOVE      SWLI          W3LI
     C   94              MOVE      *BLANKS       WSNR
      *
     C     START2        TAG
      *
     C  N94              DO
     C                   DO        12
     C                   ADD       1             ZRECNO
     C                   EXSR      FLYVAR
     C                   WRITE     SUBFIL
     C     UAVD          READE(N)  SADW                                   94
     C  N94UTDN          COMP      SWTDN                              9494
     C  N94              MOVE      SWLI          W3LI
     C  N94              END
     C                   END
     C*
     C                   Z-ADD     ZRECNO        YRECNO            5 0
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C     START3        TAG
     C                   MOVEA     '11'          *IN(91)
     C     ZRECNO        IFEQ      0
     C                   EXFMT     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   EXFMT     BUNN
     C                   MOVE      *ON           *IN45
     C                   END
     C*
     C***
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C     XRECNO        IFEQ      0
     C                   Z-ADD     ZRECNO        XRECNO            4 0
     C                   END
     C***
     C*
     C                   SETOFF                                       989930
     C*
     C*** F12 ---> AVBRYTTE REGISTRERING AV DETALJE LINJER
     C   12              Z-ADD     1             UFLAGG
     C   12              GOTO      SLUTT
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START3
     C                   END
     C   10              DO
      * FRA STENGT (*IN50=OFF) TIL ÅPEN (*IN50 = ON) ...
     C     *IN50         IFEQ      '0'
     C                   MOVEA     '11111111'    *IN(50)
     C                   ELSE
      * FRA ÅPEN TIL STENGT
     C                   MOVEA     '00000000'    *IN(50)
     C                   END
     C                   GOTO      START3
     C                   END
     C*
     C     START4        TAG
     C*
     C*** F3  I SPØRREMODUS = UT
     C     *IN03         IFEQ      '1'
     C     *IN27         ANDEQ     '1'
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C   03              DO
     C                   EXSR      TSTSUM
     C     *IN30         IFEQ      '0'
     C                   EXSR      PRINT
     C                   ELSE
     C                   MOVE      '1'           *IN12
     C                   END
     C*** F12 ---> AVBRYTE F3 (ETTER FEILMELDING V/DIFF)
     C   12              Z-ADD     6             LINNBR
     C   12              Z-ADD     2             POSNBR
     C   12              GOTO      START3
     C                   GOTO      SLUTT
     C                   END
     C*
     C*** F5  ---> VISE 1. SIDE PÅ SUBFIL.
     C   05              MOVE      *ZEROS        W3LI
     C   05              GOTO      START
     C*** F6  ---> LAGE NYE DETALJE LINJER
     C   06              MOVE      '  '          XSNR
     C   06              GOTO      START5
     C*
     C*** ROLL UP ---> BLA TIL NESTE SIDE
     C   25              DO
     C                   Z-ADD     YRECNO        ZRECNO
     C                   SETOFF                                       25
     C  N94SADW1K        SETLL     SADW
     C  N94UAVD          READE(N)  SADW                                   94
     C  N94UTDN          COMP      SWTDN                              9494
     C                   GOTO      START2
     C                   END
     C*
     C*** SJEKKE OM BRUKER HAR VALGT OPSJONER. HVIS SÅ, UTFØRE DISSE.
     C     ZRECNO        IFNE      0
     C                   EXSR      HENT
     C                   END
     C*** 98 PÅ ---> BRUKER HAR IKKE VALGT OPSJON. VISE SAMME POSTER
     C***            I SUBFIL DVS. SAMME RECORDNR.
     C   98XRECNO        IFNE      0
     C                   Z-ADD     XRECNO        ZRECNO
     C                   END
     C*** 41 AV ---> BRUKER HAR SLETTET NOEN DETALJE LINJER.
     C***            VISE 1. SIDE PÅ SUBFIL
     C  N41              GOTO      START
     C                   GOTO      START3
     C*
     C*** LAGE NYE DETALJE LINJER
     C     START5        TAG
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     4             POSNBR
     C                   EXSR      MOVB2
     C*
     C     START6        TAG
     C                   MOVE      ' '           WSNR
      * *IN50=OFF STENGT MANUELL AVG/INPUT - NOEN ÅPNE VIA "X"
     C     *IN50         IFEQ      '0'
     C     W2VEKM        COMP      'X'                                    51
     C     W2EFFM        COMP      'X'                                    52
     C     W2KUBM        COMP      'X'                                    53
     C     W2CIFM        COMP      'X'                                    54
     C     W2PROM        COMP      'X'                                    55
     C     W2VRAM        COMP      'X'                                    56
     C     W2ENGM        COMP      'X'                                    57
     C                   END
     C                   MOVE      W2UNNM        GMUNNM            1
     C                   MOVE      W2UNNR        GMUNNR           17
     C                   EXFMT     VARELI
     C                   MOVE      *OFF          *IN45
     C     *IN12         IFEQ      *ON
     C                   MOVE      GMUNNM        W2UNNM
     C                   MOVE      GMUNNR        W2UNNR
     C                   MOVE      *OFF          *IN34
     C                   ENDIF                                                  <*IN12
     C                   MOVEA     '00'          *IN(66)
     C                   MOVEA     '0000000'     *IN(68)
     C                   MOVEA     '0000000'     *IN(75)
     C                   MOVEA     '00000000'    *IN(82)
     C                   SETOFF                                       30
     C*
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      START6
     C                   END
     C*
     C*** F3  ---> BE OM UTSKRIFT ELLER SENDE MED TVINN
     C   03              GOTO      START4
     C*
     C*
     C*** F4  ---> SØKE DATA FOR ET ELLER ANNET FELT.
     C   04              DO
     C                   EXSR      SØKDTA
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C                   GOTO      START6
     C                   END
      *
     C*** F10 ---> ENDRE MODUS ÅPNE/LUKKE FOR MANUELL INNTASTING
     C   10              DO
      * FRA STENGT (*IN50=OFF) TIL ÅPEN (*IN50 = ON) ...
     C     *IN50         IFEQ      '0'
     C                   MOVEA     '11111111'    *IN(50)
     C                   ELSE
      * FRA ÅPEN TIL STENGT (MEN FØR PRESENT. AV SKJ.BILDE TESTES
      * (MEN FØR PRESENT. AV SKJ.BILDE TESTES MOT X I DE INDIVIDUELLE)
     C                   MOVEA     '00000000'    *IN(50)
     C                   END
     C     ZRECNO        IFEQ      0
     C                   WRITE     NYWRK
     C                   ELSE
     C                   WRITE     SUBCTL
     C                   END
     C                   GOTO      START6
     C                   END
     C*
     C*** F12 --> AVBRYTE REGISTRERING AV NYE DETALJE LINJER.
     C*** TESTE INNTASTEDE DATA. HVIS FEIL, SETTE IND. PÅ OG VISE
     C*** FEILMELDING.
     C  N12              DO
     C                   EXSR      TESTB1
     C   30              GOTO      START6
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C*** HVIS IKKE FEIL, OPPDATERE FIL, SUBFIL OG VISE DEN PÅ SKJERMEN
     C                   EXSR      OPDSAD
      *
     C     W2DIFF        IFGT      *ZEROS
     C                   WRITE     SUBCTL
     C                   GOTO      START5
     C                   ELSE
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C                   END
     C                   END
      *
     C                   SETOFF                                       34
     C                   Z-ADD     6             LINNBR
     C                   Z-ADD     2             POSNBR
     C                   GOTO      START3
     C*
     C*
     C     SLUTT         TAG
     C* AVSLUTNING AV SPØRRING-RETUR TIL SAD005A (ANDRE UFLAGG)
     C     *IN27         IFEQ      '1'
     C     *IN12         IFEQ      '1'
     C                   Z-ADD     9             UFLAGG                          TIL FORIGE
     C                   ELSE
     C                   Z-ADD     1             UFLAGG                          TIL SUBFIL
     C                   END
     C                   END
     C                   CLOSE     SAD061FB
     C*
     C                   RETURN
     C*
     C***********************************************
     C     FLYVAR        BEGSR
     C***********************************************
     C*** PGA. AT DET IKKE ER NOK PLASS TIL Å VISE ALLE VIKTIGE OPPL.
     C*** PÅ EN LINJE PÅ SKJERMEN, VISER BARE 5 SIFRE PÅ BETTO VEKT
     C*** 3 SIFRE PÅ MENGDE, 5 SIFRE PÅ AVGIFT BELØP OG REGISTRERINGS
     C*** REKKEFØLGE ELLER UTSKRIFT REKKEFEØLGE.
     C     SWVKTN        IFLT      99999
     C                   MOVE      SWVKTN        WXVKTN
     C                   ELSE
     C                   Z-ADD     99999         WXVKTN
     C                   END
     C*
     C     SWWSUM        ADD       SWWMVA        LINTOT            9 0
     C*
      * 28 ON = PROTECT FELTET I SKJERMLISTA
     C                   MOVE      SWUNNM        W2UNNM
     C                   MOVE      SWUNNR        W2UNNR
     C     W2UNNR        COMP      *BLANKS                            2828
     C     *IN28         IFEQ      '1'
     C     W2UNNM        ANDEQ     ' '                                          ALLE 17 TEGN
     C     W2UN17        COMP      *BLANK                             2828
     C                   END
     C                   ENDSR
     C*
     C***********************************************
     C     TESTB1        BEGSR
     C***********************************************
     C                   MOVEA     '00'          *IN(66)
     C                   MOVEA     '0000000'     *IN(68)
     C                   MOVEA     '0000000'     *IN(75)
     C                   MOVEA     '00000000'    *IN(82)
     C                   SETOFF                                       30
      *
     C* F13=OPPDATER STANDARD FOR DETTE BILMERKE/MODELL
     C     W2PACB        IFNE      *BLANKS
     C     *IN13         IFEQ      '1'
     C                   EXSR      OPDSTD
     C                   ELSE
      * HENT STD-VERDIER FOR MERKE/MOD V/NY LINJE ELLER AKTIVT BEDT OM
     C     XSNR          IFEQ      '  '
     C     *IN14         OREQ      '1'
     C                   EXSR      GETSTD
     C                   END
     C                   END
     C                   END
      *
      * DEFAULT R.44-REF = TXT
     C     W2REF1        IFEQ      *BLANKS
     C     W2R441        ANDNE     *BLANKS
     C                   MOVE      'TXT'         W2REF2
     C                   END
     C     W2REF2        IFEQ      *BLANKS
     C     W2R442        ANDNE     *BLANKS
     C                   MOVE      'TXT'         W2REF2
     C                   END
     C     W2REF3        IFEQ      *BLANKS
     C     W2R443        ANDNE     *BLANKS
     C                   MOVE      'TXT'         W2REF3
     C                   END
     C     W2REF4        IFEQ      *BLANKS
     C     W2R444        ANDNE     *BLANKS
     C                   MOVE      'TXT'         W2REF4
     C                   END
     C     W2REF5        IFEQ      *BLANKS
     C     W2R445        ANDNE     *BLANKS
     C                   MOVE      'TXT'         W2REF5
     C                   END
     C*
     C*** CHAIN OPPRINNELSESLAND / TARIFFNR (FOR Å KUNNE SETTE PREF)
     C     KODS2K        CHAIN     KOS2R                              88
     C                   MOVE      W2VNT         TATANR
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   87
     C     *IN87         DOWEQ     '0'
     C     TADATO        IFLE      USIDT
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      USIDT
N01  C     TADTS         ANDGE     USIDT
     C                   LEAVE
     C                   END
     C     TARIK         READPE    TARI                                   87
     C  N87              ENDDO
     C* AMBASADEKJØRETØY MVAFRI
     C     W2PC1D        IFEQ      'AM'
     C                   MOVE      'F'           W2MFR
     C                   END
     C* DERSOM LANDKODEN TILLATER PREFERANSE OG DET IKKE ER BEVISST
     C* SATT "N" FOR INGEN PREF. ER PREF "P" DEFAULT (KOLONNE ETTER LK)
     C* (MEN PREF SKAL IKKE SETTES DERSOM VARENR ER FRITT "I SEG SELV")
     C* (PREF PÅ VARE SOM ER FRI I KOL. 1  GAV FEIL I TVINN - ENNÅ????)
     C     W2TN          IFEQ      ' '
     C     W2PRE         ANDEQ     ' '
     C     SIDP          IFEQ      71
      * TRANSIT/FRILAGER....
     C     KS2PRE        IFEQ      ' '
     C                   MOVE      'N'           W2PRE
     C                   ELSE
     C                   MOVE      'J'           W2PRE
     C                   END
     C                   ELSE
      * ... ANNET (IKKE PROS 71.)
     C* VED REISEGODS BEHOLD ' '(->N) I PREF ELLERS SETT PREF ETTER LK
     C     W2VNT         IFEQ      *ZEROS
     C     SIDP          ANDEQ     44
     C     SITST         ANDEQ     9
     C                   MOVE      'N'           W2PRE
     C                   ELSE
     C                   MOVE      KS2PRE        W2PRE
     C                   END
     C     W2PRE         IFEQ      'B'
     C     W2LK          ANDNE     'CH'
     C     W2LK          ANDNE     'LI'
     C     W2LK          ANDNE     'RO'
     C     W2LK          ANDNE     'BG'
     C     TAEØSB        ANDLE     TAEFB
     C                   MOVE      'A'           W2PRE
     C                   END
     C     W2PRE         IFEQ      'C'
     C     W2LK          ANDNE     'CH'
     C     W2LK          ANDNE     'LI'
     C     TAEØSB        ANDLE     TAEFTB
     C                   MOVE      'A'           W2PRE
     C                   END
     C                   END
     C                   END
      * PREFERANSE - KRAV OM SER
     C     W2PRE         IFNE      ' '
     C     W2PRE         ANDNE     'N'
     C     W2PRE         ANDNE     'J'
     C     W2REF1        ANDNE     'SER'
     C     W2REF2        ANDNE     'SER'
     C     W2REF3        ANDNE     'SER'
     C     W2REF4        ANDNE     'SER'
     C     W2REF5        ANDNE     'SER'
     C                   SETON                                        7730
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     15            POSNBR
     C                   MOVE      'JOV0632'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C* BELØP I NOK - INKL. JUST.
     C     W2BELT        MULT(H)   XTVFAK        W2BELS                          INCL JUST
     C     XTVFA2        IFNE      0
     C     W2BELT        MULT(H)   XTVFA2        W2BEL2
     C                   END
     C* BELØP I NOK - EXCL. JUST.
     C     W2BELT        MULT      SIVKU         XWORK            16 5
     C     KODVAK        SETGT     KODTVAL2
     C     SIVAL3        READPE    KODTVAL2                               33
     C  N33              MOVE      KVAOMR        XOMRF             3 0
     C   33              Z-ADD     1             XOMRF
     C     XWORK         DIV(H)    XOMRF         XFAKNO           11 0           EXCL JUST
     C*  FINN JUSTERING..
     C     W2BELS        SUB       XFAKNO        W2WJUS
     C     W2WJUS        IFLT      *ZEROS
     C                   MULT      -1            W2WJUS
     C                   MOVE      '-'           W2WFTG
     C                   ELSE
     C                   MOVE      ' '           W2WFTG
     C                   END
     C*
     C*** AVGIFT KAN OVERSTYRES BÅDE SATS OG BELØP
     C     STTST1        TAG
     C     W2WTY2        IFNE      *BLANKS                                      1<-B
     C     W2WTY2        ANDNE     '99'                                         1<-B
     C     W2WTY2        IFEQ      'TL'
     C     W2WTY2        OREQ      'TA'
     C     W2WTY2        OREQ      'MV'
     C                   MOVE      '1  '         W2WSK2
     C                   END
     C                   MOVE      W2WTY2        XS8TYP
     C                   MOVE      W2WSK2        XS8SKV
     C     KODS8K        CHAIN     KOS8R                              79
     C   79W2WTY2        CHAIN     KODTS8L2                           79
     C  N79W2WSK2        COMP      *BLANKS                                79
     C   79              SETON                                        30
     C   79              Z-ADD     21            LINNBR
     C   79              Z-ADD     9             POSNBR
     C*** NÅR GRUNNLAG IKKE OPPGIS HENTER SYSTEMET GRUNNLAG AVHENGIG AV
     C*** AVGIFT TYPE
     C*** AVGIFT MED '%' I SATSTYPE - STAT. VERDI PÅ LINJE SETTES INN
     C*** AVGIFT MED 'P' I SATSTYPE - NETTO VEKT  PÅ LINJE SETTES INN
     C*** AVGIFT MED 'H' I SATSTYPE - NETTO VEKT  PÅ LINJE SETTES INN
     C*** AVGIFT MED 'K' I SATSTYPE - NETTO VEKT  PÅ LINJE SETTES INN
     C*** AVGIFT MED ' ' I SATSTYPE - ANTALL STK. PÅ LINJE SETTES INN
     C  N79W2WGL2        IFEQ      0                                             2<-B
     C     KS8STY        ANDNE     'M'                                           2<-B
     C     KS8STY        IFEQ      '%'                                            3<-B
     C     SIBELR        IFEQ      0
     C                   Z-ADD     W2BELS        W2WGL2
     C                   ELSE
     C                   Z-ADD     W2BEL2        W2WGL2
     C                   END
     C                   ELSE                                                     3
     C     KS8STY        IFEQ      'P'                                             4<-B
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C                   Z-ADD     W2VKTN        W2WGL2
     C                   ELSE                                                      4
     C     KS8STY        IFEQ      'D'
     C                   EVAL(H)   W2WGL2 = W2NTM / 12 + 0.5
     C                   ELSE
     C     KS8STY        IFEQ      'T'
     C                   EVAL(H)   W2WGL2 = W2VKTN / 1000 + 0.5
     C                   ELSE
     C                   Z-ADD     W2NTM         W2WGL2
     C                   END
     C                   END
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   MOVE      KS8ØRE        XS8ØRE            1
     C  N79W2WBL2        IFGE      999999999                                     2<-B
     C                   Z-ADD     0             W2WBL2
     C                   MOVE      ' '           XEH2Æ             1
     C                   ELSE                                                    2
     C*** HVIS SATS=0, HENTES SATS FRA KODE-REGISTER
     C     W2WST2        COMP      0                                      33
     C   33              Z-ADD     KS8SAT        W2WST2
     C                   MOVE      KS8STY        W2WPR2
     C     W2WBL2        IFEQ      0                                              3<-B
     C                   SELECT
     C     XEH2Æ         WHENEQ    ' '
     C     XEH2Æ         OREQ      'K'
     C     XEH2Æ         OREQ      'G'
     C     XEH2Æ         OREQ      'M'
     C     XEH2Æ         OREQ      'D'
     C     XEH2Æ         OREQ      'T'
     C                   EVAL      W2WBL2 = W2WGL2 * W2WST2
     C     XEH2Æ         WHENEQ    '%'
     C     XEH2Æ         OREQ      'H'
     C     XEH2Æ         OREQ      '*'
     C                   EVAL      W2WBL2 = W2WGL2 * W2WST2 / 100
     C     XEH2Æ         WHENEQ    'P'
     C                   EVAL      W2WBL2 = W2WGL2 * W2WST2 / 1000
     C                   ENDSL
     C     XS8ØRE        IFEQ      '*'
S02  C*                  DIV       100           W2WBL2
N02  C                   DIV(H)    100           W2WBL2
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2WBL2        COMP      0                                  7878
     C   78              SETON                                        30
     C   78              Z-ADD     21            LINNBR
     C   78              Z-ADD     36            POSNBR
     C                   END                                                    1<-E
     C* AVG NR 3
     C     W2WTY3        IFNE      *BLANKS                                      1<-B
     C     W2WTY3        IFEQ      'TL'
     C     W2WTY3        OREQ      'TA'
     C     W2WTY3        OREQ      'MV'
     C                   MOVE      '1  '         W2WSK3
     C                   END
     C                   MOVE      W2WTY3        XS8TYP
     C                   MOVE      W2WSK3        XS8SKV
     C     KODS8K        CHAIN     KOS8R                              79
     C   79W2WTY3        CHAIN     KODTS8L2                           79
     C  N79W2WSK3        COMP      *BLANKS                                79
     C   79              SETON                                        30
     C   79              Z-ADD     21            LINNBR
     C   79              Z-ADD     46            POSNBR
     C  N79W2WGL3        IFEQ      0                                             2<-B
     C     KS8STY        ANDNE     'M'                                           2<-B
     C     KS8STY        IFEQ      '%'                                            3<-B
     C     SIBELR        IFEQ      0
     C                   Z-ADD     W2BELS        W2WGL3
     C                   ELSE
     C                   Z-ADD     W2BEL2        W2WGL3
     C                   END
     C                   ELSE                                                     3
     C     KS8STY        IFEQ      'P'                                             4<-B
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C                   Z-ADD     W2VKTN        W2WGL3
     C                   ELSE                                                      4
     C     KS8STY        IFEQ      'D'
     C                   EVAL(H)   W2WGL3 = W2NTM / 12 + 0.5
     C                   ELSE
     C     KS8STY        IFEQ      'T'
     C                   EVAL(H)   W2WGL3 = W2VKTN / 1000 + 0.5
     C                   ELSE
     C                   Z-ADD     W2NTM         W2WGL3
     C                   END
     C                   END
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   MOVE      KS8ØRE        XS8ØRE            1
     C  N79W2WBL3        IFGE      999999999                                     2<-B
     C                   Z-ADD     0             W2WBL3
     C                   MOVE      ' '           XEH2Æ             1
     C                   ELSE                                                    2
     C*** HVIS SATS=0, HENTES SATS FRA KODE-REGISTER
     C     W2WST3        COMP      0                                      33
     C   33              Z-ADD     KS8SAT        W2WST3
     C                   MOVE      KS8STY        W2WPR3
     C     W2WBL3        IFEQ      0                                              3<-B
     C                   SELECT
     C     XEH2Æ         WHENEQ    ' '
     C     XEH2Æ         OREQ      'K'
     C     XEH2Æ         OREQ      'G'
     C     XEH2Æ         OREQ      'M'
     C     XEH2Æ         OREQ      'D'
     C     XEH2Æ         OREQ      'T'
     C                   EVAL      W2WBL3 = W2WGL3 * W2WST3
     C     XEH2Æ         WHENEQ    '%'
     C     XEH2Æ         OREQ      'H'
     C     XEH2Æ         OREQ      '*'
     C                   EVAL      W2WBL3 = W2WGL3 * W2WST3 / 100
     C     XEH2Æ         WHENEQ    'P'
     C                   EVAL      W2WBL3 = W2WGL3 * W2WST3 / 1000
     C                   ENDSL
     C     XS8ØRE        IFEQ      '*'
S02  C*                  DIV       100           W2WBL3
N02  C                   DIV(H)    100           W2WBL3
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2WBL3        COMP      0                                  7878
     C   78              SETON                                        30
     C   78              Z-ADD     21            LINNBR
     C   78              Z-ADD     73            POSNBR
     C                   END                                                    1<-E
     C* AVG NR 4
     C     W2WTY4        IFNE      *BLANKS                                      1<-B
     C     W2WTY4        IFEQ      'TL'
     C     W2WTY4        OREQ      'TA'
     C     W2WTY4        OREQ      'MV'
     C                   MOVE      '1  '         W2WSK4
     C                   END
     C                   MOVE      W2WTY4        XS8TYP
     C                   MOVE      W2WSK4        XS8SKV
     C     KODS8K        CHAIN     KOS8R                              79
     C   79W2WTY4        CHAIN     KODTS8L2                           79
     C  N79W2WSK4        COMP      *BLANKS                                79
     C   79              SETON                                        30
     C   79              Z-ADD     22            LINNBR
     C   79              Z-ADD     9             POSNBR
     C  N79W2WGL4        IFEQ      0                                             2<-B
     C     KS8STY        ANDNE     'M'                                           2<-B
     C     KS8STY        IFEQ      '%'                                            3<-B
     C     SIBELR        IFEQ      0
     C                   Z-ADD     W2BELS        W2WGL4
     C                   ELSE
     C                   Z-ADD     W2BEL2        W2WGL4
     C                   END
     C                   ELSE                                                     3
     C     KS8STY        IFEQ      'P'                                             4<-B
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C                   Z-ADD     W2VKTN        W2WGL4
     C                   ELSE                                                      4
     C     KS8STY        IFEQ      'D'
     C                   EVAL(H)   W2WGL4 = W2NTM / 12 + 0.5
     C                   ELSE
     C     KS8STY        IFEQ      'T'
     C                   EVAL(H)   W2WGL4 = W2VKTN / 1000 + 0.5
     C                   ELSE
     C                   Z-ADD     W2NTM         W2WGL4
     C                   END
     C                   END
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   MOVE      KS8ØRE        XS8ØRE            1
     C  N79W2WBL4        IFGE      999999999                                     2<-B
     C                   Z-ADD     0             W2WBL4
     C                   MOVE      ' '           XEH2Æ             1
     C                   ELSE                                                    2
     C*** HVIS SATS=0, HENTES SATS FRA KODE-REGISTER
     C     W2WST4        COMP      0                                      33
     C   33              Z-ADD     KS8SAT        W2WST4
     C                   MOVE      KS8STY        W2WPR4
     C     W2WBL4        IFEQ      0                                              3<-B
     C                   SELECT
     C     XEH2Æ         WHENEQ    ' '
     C     XEH2Æ         OREQ      'K'
     C     XEH2Æ         OREQ      'G'
     C     XEH2Æ         OREQ      'M'
     C     XEH2Æ         OREQ      'D'
     C     XEH2Æ         OREQ      'T'
     C                   EVAL      W2WBL4 = W2WGL4 * W2WST4
     C     XEH2Æ         WHENEQ    '%'
     C     XEH2Æ         OREQ      'H'
     C     XEH2Æ         OREQ      '*'
     C                   EVAL      W2WBL4 = W2WGL4 * W2WST4 / 100
     C     XEH2Æ         WHENEQ    'P'
     C                   EVAL      W2WBL4 = W2WGL4 * W2WST4 / 1000
     C                   ENDSL
     C     XS8ØRE        IFEQ      '*'
S02  C*                  DIV       100           W2WBL3
N02  C                   DIV(H)    100           W2WBL3
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2WBL4        COMP      0                                  7878
     C   78              SETON                                        30
     C   78              Z-ADD     22            LINNBR
     C   78              Z-ADD     36            POSNBR
     C                   END                                                    1<-E
     C* AVG NR 5
     C     W2WTY5        IFNE      *BLANKS                                      1<-B
     C     W2WTY5        IFEQ      'TL'
     C     W2WTY5        OREQ      'TA'
     C     W2WTY5        OREQ      'MV'
     C                   MOVE      '1  '         W2WSK5
     C                   END
     C                   MOVE      W2WTY5        XS8TYP
     C                   MOVE      W2WSK5        XS8SKV
     C     KODS8K        CHAIN     KOS8R                              79
     C   79W2WTY5        CHAIN     KODTS8L2                           79
     C  N79W2WSK4        COMP      *BLANKS                                79
     C   79              SETON                                        30
     C   79              Z-ADD     22            LINNBR
     C   79              Z-ADD     46            POSNBR
     C  N79W2WGL5        IFEQ      0                                             2<-B
     C     KS8STY        ANDNE     'M'                                           2<-B
     C     KS8STY        IFEQ      '%'                                            3<-B
     C     SIBELR        IFEQ      0
     C                   Z-ADD     W2BELS        W2WGL5
     C                   ELSE
     C                   Z-ADD     W2BEL2        W2WGL5
     C                   END
     C                   ELSE                                                     3
     C     KS8STY        IFEQ      'P'                                             4<-B
     C     KS8STY        OREQ      'H'
     C     KS8STY        OREQ      'K'
     C                   Z-ADD     W2VKTN        W2WGL5
     C                   ELSE                                                      4
     C     KS8STY        IFEQ      'D'
     C                   EVAL(H)   W2WGL4 = W2NTM / 12 + 0.5
     C                   ELSE
     C     KS8STY        IFEQ      'T'
     C                   EVAL(H)   W2WGL4 = W2VKTN / 1000 + 0.5
     C                   ELSE
     C                   Z-ADD     W2NTM         W2WGL5
     C                   END
     C                   END
     C                   END                                                       4<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   MOVE      KS8ØRE        XS8ØRE            1
     C  N79W2WBL5        IFGE      999999999                                     2<-B
     C                   Z-ADD     0             W2WBL5
     C                   MOVE      ' '           XEH2Æ             1
     C                   ELSE                                                    2
     C*** HVIS SATS=0, HENTES SATS FRA KODE-REGISTER
     C     W2WST5        COMP      0                                      33
     C   33              Z-ADD     KS8SAT        W2WST5
     C                   MOVE      KS8STY        W2WPR5
     C     W2WBL5        IFEQ      0                                              3<-B
     C                   SELECT
     C     XEH2Æ         WHENEQ    ' '
     C     XEH2Æ         OREQ      'K'
     C     XEH2Æ         OREQ      'G'
     C     XEH2Æ         OREQ      'M'
     C     XEH2Æ         OREQ      'D'
     C     XEH2Æ         OREQ      'T'
     C                   EVAL      W2WBL5 = W2WGL5 * W2WST5
     C     XEH2Æ         WHENEQ    '%'
     C     XEH2Æ         OREQ      'H'
     C     XEH2Æ         OREQ      '*'
     C                   EVAL      W2WBL5 = W2WGL5 * W2WST5 / 100
     C     XEH2Æ         WHENEQ    'P'
     C                   EVAL      W2WBL5 = W2WGL5 * W2WST5 / 1000
     C                   ENDSL
     C     XS8ØRE        IFEQ      '*'
S02  C*                  DIV       100           W2WBL3
N02  C                   DIV(H)    100           W2WBL3
     C                   END                                                      3<-E
     C                   END                                                      3<-E
     C                   END                                                     2<-E
     C                   ELSE                                                   1
     C     W2WBL5        COMP      0                                  7878
     C   78              SETON                                        30
     C   78              Z-ADD     22            LINNBR
     C   78              Z-ADD     73            POSNBR
     C                   END                                                    1<-E
     C*
     C*
     C*
     C   30              DO
     C   79              MOVE      'SPK0040'     MSGNR
     C   78              MOVE      'SPB0006'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C*
     C*** TEST VARENR.
     C                   MOVE      W2VNT         TATANR
     C     TARIKM        SETLL     TARI
     C     TARIK         READPE    TARI                                   87
     C     *IN87         DOWEQ     '0'
     C     TADATO        IFLE      USIDT
N01  C     TADTS         ANDEQ     0
N01  C     TADATO        ORLE      USIDT
N01  C     TADTS         ANDGE     USIDT
     C                   LEAVE
     C                   END
     C     TARIK         READPE    TARI                                   87
     C  N87              ENDDO
      *
     C  N87W2WTY2        IFEQ      '99'
     C                   MOVE      *BLANKS       W2WTY2
     C                   MOVE      *BLANKS       W2WSK2
     C                   END
     C*
     C   87              DO
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     11            POSNBR
     C                   MOVE      'SPT0033'     MSGNR
     C                   GOTO      SLTB1
     C                   END
     C*
     C*** TASTET PREF GIS HØYERE PRIORITET ENN M-FRI (OG ORDINÆR-FRI)
     C***   DERSOM "ØVRIGE KAPITAL HENVENDELSE" VISER TIL M BEHANDLES
     C***   VARE SOM MASKIN-FRI
     C                   MOVEL     TAKAPA        TAKAP2            1
     C     TAKAP         IFNE      'M'
     C     TAKAP2        ANDEQ     'M'
     C                   MOVE      'M'           TAKAP
     C                   END
     C*
     C     TAKAP         IFEQ      'M'
     C     W2PRE         IFEQ      ' '
     C     W2PRE         OREQ      'N'
     C                   MOVE      'M'           W2TN
     C                   END
     C                   END
     C*
     C*
     C                   Z-ADD     14            LINNBR
     C*** TEST VF-KODE
     C     W2VF          COMP      '6'                                89
     C   89              DO
     C                   SETON                                        30
     C                   Z-ADD     4             POSNBR
     C                   MOVE      'SPV0015'     MSGNR
     C                   END
     C*
     C*** TEST OPPRINNELSESLAND  (CHAIN ER FLYTTET I TOPP)
     C   88
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     7             POSNBR
     C                   MOVE      'SPL0001'     MSGNR
     C                   END
     C*
     C*** TEST TOLLNEDSETTELSE
     C     W2TN          IFNE      ' '
     C     KODS5K        CHAIN     KOS5R                              86
     C   86
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     20            POSNBR
     C                   MOVE      'SPT0034'     MSGNR
     C                   END
     C                   END
     C* BRUK PREF. FRA OPPR.LAND (I KEY KODS6K) TIL Å HENTE KOLONNUMMER
     C*(DA VIL DEN "NYE" KODEN "P" FOR GEN. PREFERANSE GI RETT KOLONNE)
     C     W2PRE         IFNE      ' '
     C     W2PRE         ANDNE     'N'
     C     W2PRE         ANDNE     'J'
     C     KODS6K        CHAIN     KOS6R                              85
      *
      * VED 'G'  SETTES FRI VED BLANK KODE
      *
     C     W2PRE         IFEQ      'G'
     C     W2PVA         ANDEQ     ' '
     C                   MOVE      'F'           W2PVA
     C                   END
     C   85
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     23            POSNBR
     C                   MOVE      'SPP0023'     MSGNR
     C                   END
     C                   END
     C*
     C*** TEST VEKT
     C     W2VKTB        IFLE      0
     C     W2VKTN        IFLE      0
     C                   SETON                                        84
     C  N30              DO
     C                   SETON                                        30
     C                   Z-ADD     38            POSNBR
     C                   MOVE      'SPV0016'     MSGNR
     C                   END
     C                   ELSE
     C     W2VKTN        MULT(H)   1,0           W2VKTB
     C                   END
     C                   ELSE
     C     W2VKTN        IFEQ      0
     C     W2VKTB        MULT(H)   1,0           W2VKTN
     C                   END
     C                   END
      *
     C     W2VKTB        IFLT      W2VKTN
     C                   SETON                                        84
     C  N30              DO
     C                   SETON                                        30
     C                   Z-ADD     38            POSNBR
     C                   MOVE      'JOV1095'     MSGNR
     C                   END
     C                   END
      *
     C     *IN84         IFNE      '1'
     C     W2TX1A        IFEQ      *ZEROS
     C     W2VEKA        OREQ      '0'
     C                   Z-ADD     W2VKTN        W2TX1A
     C                   END
      *
     C     W2PC1A        IFEQ      *ZEROS
     C     W2CIFA        OREQ      '0'
     C     W2BELT        MULT      XTVFAK        W2PC1A
     C                   END
      *
      *
      *
     C* KALKULER AVGIFTER (HVIS IKKE MANUELT SATT)
     C     W2VEKM        IFNE      'X'
     C                   EXSR      VKTAVG                                        --->W2TX1B
     C                   END
     C     W2EFFM        IFNE      'X'
     C                   EXSR      EFFAVG                                        --->W2TX12
     C                   END
     C     W2KUBM        IFNE      'X'
     C                   EXSR      KUBAVG                                        --->W2TX13
     C                   END
     C     W2PROM        IFNE      'X'
     C                   EXSR      PROSSR                                        -PROS SATS
     C                   END
     C     W2CIFM        IFNE      'X'
     C                   EXSR      CIFAVG                                        --->W2PC1B
     C                   END
     C     W2PROM        IFNE      'X'
     C                   EXSR      PROSSR                                        -PROS SATS
     C                   END
     C     W2VRAM        IFNE      'X'
     C                   EXSR      VRAK                                          --->W2VRAK
     C                   END
      *
     C* SUM AVG. GRL..
     C     W2TX1B        ADD(H)    W2TX2B        WRKMO             8 2
     C                   ADD       W2TX3B        WRKMO
     C                   ADD       W2PC1B        WRKMO
     C                   Z-ADD     WRKMO         W2PC2B                          TOT-GRUNNL.
      *
     C* AVGIFT ETTER % (DE FLESTE ER 100%) AV BEREGNEDE TOTALER
     C                   MULT(H)   PROFAK        WRKMO
      *
     C*LEGG TIL VRAKPANT -> SUM AVG. (HVIS IKKE MANUELT SATT)
     C     W2ENGM        IFNE      'X'
     C     WRKMO         ADD(H)    W2VRAK        W2PC2C                          TOT.MO-AVG.
     C     W2WSK1        IFEQ      *BLANKS
     C                   MOVE      '100'         W2WSK1                          AVG.SEKVENS
     C                   END
     C                   END
      *
     C*
     C*** TEST OM MAN MÅ OPPGI STYKK
     C     TASTK         COMP      'J'                                    33
     C  N33W2PVA         COMP      'A'                                    33
     C   33W2NTM         COMP      0                                      83
     C   83
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     58            POSNBR
     C                   MOVE      'SPN0016'     MSGNR
     C                   END
     C*
     C  N30
     CANN46W2AS          IFEQ      0
     C                   EXSR      TATEST
     C                   END
     C*
     C*** TEST PVA
     C                   SETOFF                                       33
     C     W2PVA         LOOKUP    A1                                     33
     C  N33              SETON                                        82
     C   82
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     67            POSNBR
     C                   MOVE      'SPP0024'     MSGNR
     C                   END
     C   33W2PVA         IFEQ      'P'
     C                   MOVE      '%'           XEH2              1
     C                   ELSE
     C                   MOVE      ' '           XEH2
     C                   END
     C*
     C*** TEST SATS
     C     W2PVA         IFNE      'F'
     C     W2AS          COMP      0                                    8181
     C   81
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     70            POSNBR
     C                   MOVE      'SPS0041'     MSGNR
     C                   END
     C                   END
     C*
     C*** TEST MOMSFRI-KODE
     C                   SELECT                                                 1<-B
     C     W2MFR         WHENEQ    'F'
     C     W2MFR         WHENEQ    *BLANKS
     C     SADSDK        SETLL     SADSD
     C     SADSDK        READE     SADSD                                  33
     C     *IN33         DOWEQ     '0'
     C     SDDTF         IFLE      USIDT
     C     SDDTT         ANDGE     USIDT
     C                   LEAVE
     C                   END
     C     SADSDK        READE     SADSD                                  33
     C  N33              ENDDO
      * SJEKK OM DET FINNES FLERE MOMSSATS
     C     *IN33         IFEQ      '0'                                           2<-B
N03  C                   MOVEL     SDKDSÆ        XSDKDSÆ           3
     C     SADSDK        READE     SADSD                                  33
     C     *IN33         DOWEQ     '0'
     C     SDDTF         IFLE      USIDT
     C     SDDTT         ANDGE     USIDT
     C                   LEAVE
     C                   END
     C     SADSDK        READE     SADSD                                  33
     C  N33              ENDDO
      *
     C     *IN33         IFEQ      '0'                                            3<-B
     C                   MOVE      '1'           *IN80
     C                   ELSE                                                     3
S03  C*                  MOVEL     SDKDSÆ        W2MFR
N03  C                   MOVEL     XSDKDSÆ       W2MFR
     C                   END                                                      3<-E
     C                   ELSE                                                    2
     C                   MOVEL     'F'           W2MFR
     C                   END                                                     2<-E
     C                   OTHER
     C                   MOVEL     W2MFR         XDKDSÆ
     C     SADS2K        SETLL     SADSD
     C     SADS2K        READE     SADSD                                  80
     C     *IN80         DOWEQ     '0'
     C     SDDTF         IFLE      USIDT
     C     SDDTT         ANDGE     USIDT
     C                   LEAVE
     C                   END
     C     SADS2K        READE     SADSD                                  80
     C  N80              ENDDO
     C                   ENDSL                                                  1<-E
     C   80
     CANN30              DO
     C                   SETON                                        30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      'YBC0874'     MSGNR
     C                   END
     C* MERKE
     C     W2PACB        COMP      *BLANKS                                76
     C     *IN30         IFEQ      '0'
     C     *IN76         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     4             POSNBR
     C                   MOVE      'JOV0639'     MSGNR
     C                   END
     C* MODELL
     C     W2PACB        IFNE      '.'
     C     W2TX1C        COMP      *BLANKS                                75
     C     *IN30         IFEQ      '0'
     C     *IN75         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     26            POSNBR
     C                   MOVE      'JOV0640'     MSGNR
     C                   END
     C                   END
     C* TYPEGODKJ.NR
     C     W2PACB        IFNE      '.'
N06  C     W2PACB        ANDEQ     '.'
     C     W2TX3C        COMP      *BLANKS                                74
     C     *IN30         IFEQ      '0'
     C     *IN74         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     61            POSNBR
     C                   MOVE      'JOV0641'     MSGNR
     C                   END
     C                   END
     C* AVGIFTSGRP
     C     W2PACB        IFNE      '.'
N06  C     W2PACB        ANDEQ     '.'
     C                   MOVEL     W2PC1C        XKFKOD
     C     AVGGRK        CHAIN     KUFAST                             73
     C     *IN30         IFEQ      '0'
     C     *IN73         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     15            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      'JOV0633'     MSGNR
     C                   END
     C                   END
     C* KLAUSUL-KODE
     C     W2PC1D        IFNE      *BLANKS
     C                   MOVEL     W2PC1D        YKFKOD
     C     KLAUSK        CHAIN     KUFAST                             72
     C     *IN30         IFEQ      '0'
     C     *IN72         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     78            POSNBR
     C                   MOVE      'JOV0638'     MSGNR
     C                   END
     C                   END
      *
     C* UNDERSTELLSNR (17 TEGN HVIS IKKE X FORAN)
     C     W2UNNR        COMP      *BLANKS                                69
     C     *IN69         IFEQ      '0'
     C     W2UNNM        ANDNE     'X'
     C                   MOVE      W2UNNR        TSTUN             1
     C     TSTUN         COMP      *BLANKS                                69
     C                   END
     C     *IN30         IFEQ      '0'
     C     *IN69         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     6             POSNBR
      * sett cursor i første nonblank
     C     W2UNNR        IFNE      *BLANKS
     C                   MOVEA     W2UNNR        UN
     C     1             DO        17            NN                2 0
     C     UN(NN)        CABEQ     ' '           UTUN
     C                   END
     C     UTUN          TAG
     C                   SUB       1             NN
     C                   ADD       NN            POSNBR
     C                   END
     C                   MOVE      'JOV1147'     MSGNR
     C                   END
     C* EFFEKT
     C     W2PACB        IFNE      '.'
N06  C     W2PACB        ANDEQ     '.'
     C     W2TX2A        COMP      *ZEROS                                 71
     C     *IN30         IFEQ      '0'
     C     *IN71         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     17            POSNBR
     C                   MOVE      'JOV0634'     MSGNR
     C                   END
     C                   END
     C* KUBIKK
     C     W2PACB        IFNE      '.'
N06  C     W2PACB        ANDEQ     '.'
     C     W2TX3A        COMP      *ZEROS                                 70
     C     *IN30         IFEQ      '0'
     C     *IN70         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     29            POSNBR
     C                   MOVE      'JOV0635'     MSGNR
     C                   END
     C                   END
      *
      * R.44-REF-KODE
     C     W2REF1        IFNE      *BLANKS
     C     W2REF1        CHAIN     KODTSB                             77
     C     *IN30         IFEQ      '0'
     C     *IN77         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   MOVE      'JOV0642'     MSGNR
     C                   END
     C                   END
     C* R.44-REF-KODE
     C     W2REF2        IFNE      *BLANKS
     C     W2REF2        CHAIN     KODTSB                             77
     C     *IN30         IFEQ      '0'
     C     *IN77         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     19            LINNBR
     C                   Z-ADD     55            POSNBR
     C                   MOVE      'JOV0642'     MSGNR
     C                   END
     C                   END
     C* R.44-REF-KODE 3
     C     W2REF3        IFNE      *BLANKS
     C     W2REF3        CHAIN     KODTSB                             77
     C     *IN30         IFEQ      '0'
     C     *IN77         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     33            POSNBR
     C                   MOVE      'JOV0642'     MSGNR
     C                   END
     C                   END
     C* R.44-REF-KODE 4
     C     W2REF4        IFNE      *BLANKS
     C     W2REF4        CHAIN     KODTSB                             77
     C     *IN30         IFEQ      '0'
     C     *IN77         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     55            POSNBR
     C                   MOVE      'JOV0642'     MSGNR
     C                   END
     C                   END
     C* R.44-REF-KODE 5
     C     W2REF5        IFNE      *BLANKS
     C     W2REF5        CHAIN     KODTSB                             77
     C     *IN30         IFEQ      '0'
     C     *IN77         ANDEQ     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     20            LINNBR
     C                   Z-ADD     77            POSNBR
     C                   MOVE      'JOV0642'     MSGNR
     C                   END
     C                   END
      *
     C  N30W2PRE         IFEQ      ' '
     C                   MOVE      'N'           W2PRE
     C                   END
      *
      *  AVVIKENDE VEKT-GRUNNLAG MÅ KVITTERES
     C     W2TX1A        IFNE      W2VKTN
     C     W2VEKA        ANDEQ     ' '
     C     *IN30         ANDEQ     '0'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN66
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     3             POSNBR
     C                   MOVE      'JOV1006'     MSGNR
     C                   END
     C                   END
      *  AVVIKENDE CIF-GRUNNLAG MÅ KVITTERES
     C     W2BELT        MULT      XTVFAK        XXCIFV            6 0
     C     W2PC1A        IFNE      XXCIFV
     C     W2CIFA        ANDEQ     ' '
     C     *IN30         ANDEQ     '0'
     C                   MOVE      '1'           *IN30
     C                   MOVE      '1'           *IN67
     C                   Z-ADD     17            LINNBR
     C                   Z-ADD     38            POSNBR
     C                   MOVE      'JOV1007'     MSGNR
     C                   END
     C*
     C     SLTB1         TAG
     C     *IN30         IFNE      '1'
     C                   EXSR      FINAVG
     C     W2NTM         IFGT      1
     C     *IN23         ANDNE     '1'
     C                   MOVE      '1'           *IN30
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     58            POSNBR
     C                   MOVE      'JOV0644'     MSGNR
     C                   END
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     FINAVG        BEGSR
     C***********************************************
     C*
     C*** FINN TOLLBELØP
     C                   MOVE      *ZEROS        W2WTOL
     C                   SELECT
     C     W2PVA         WHENEQ    'P'
     C     SIBELR        IFEQ      0
     C     W2BELS        MULT      W2AS          XWORK
     C                   ELSE
     C     W2BEL2        MULT      W2AS          XWORK
     C                   END
     C     XWORK         DIV(H)    100           W2WTOL
     C*
     C     W2PVA         WHENEQ    'V'
     C     W2VKTN        MULT(H)   W2AS          W2WTOL
     C*
     C     W2PVA         WHENEQ    'W'
     C     W2VKTN        MULT(H)   W2AS          W2WTOL
     C                   DIV(H)    100           W2WTOL
     C*
     C     W2PVA         WHENEQ    'A'
     C     W2NTM         MULT      W2AS          W2WTOL
     C                   ENDSL
     C*
      *  SÆRAVGIFTER  (W2PC2C=SUM MOTORV.AVGIFT)
     C                   Z-ADD     W2WBL2        ANDRE            11 0
     C                   ADD       W2WBL3        ANDRE
     C                   ADD       W2WBL4        ANDRE
     C                   ADD       W2WBL5        ANDRE
      *
      * MOMSGRUNNL=TOLLGRL+TOLL+SÆRAVGIFTER / MOMS= ..... X MVASATS
     C     SIBELR        IFEQ      0
     C     W2BELS        ADD       W2WTOL        W2WMVG
     C                   ELSE
     C     W2BEL2        ADD       W2WTOL        W2WMVG
     C                   END
     C                   ADD       ANDRE         W2WMVG
      *
     C     W2MFR         IFNE      'F'
     C     W2WMVG        MULT(H)   FITAX         W2WMVA
     C                   ELSE
     C                   MOVE      *ZEROS        W2WMVA
     C                   END
      *
      * W2WSUM = TOLL + SÆRAVGIFTER (EXKL MVA)..
     C     W2WTOL        ADD       ANDRE         W2WSUM
     C*
      * TOTAL PÅ LINJA = W2WSUM + MVA
     C     W2WSUM        ADD       W2WMVA        LINTOT
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     GETSTD        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       XXPACB
     C                   MOVEL     W2PACB        XXPACB
     C     BILKEY        CHAIN(N)  SADBIL                             33
     C     *IN33         IFEQ      '1'
     C                   GOTO      UTSTD
     C                   END
     C*  FLYTT VERDIER FRA STANDARDER FOR BILMODELLEN
     C*  ...... MEN KUN TIL FELTER SOM ENNÅ IKKE ER UTFYLT
     C     W2TX3C        IFEQ      *BLANKS
     C                   MOVE      SBTX3C        W2TX3C                           TYPEG.K.NR
     C                   END
     C     W2PC1C        IFEQ      *BLANKS
     C                   MOVE      SBPC1C        W2PC1C                           AVG.GRP
     C                   END
     C     W2PC1D        IFEQ      *BLANKS
     C                   MOVE      SBPC1D        W2PC1D                           KLAUSUL
     C                   END
     C     W2TX1A        IFEQ      *ZEROS
     C                   MOVE      SBTX1A        W2TX1A                           VEKT
     C     SBVEKM        IFEQ      'X'
     C                   MOVE      SBVEKM        W2VEKM
     C                   MOVE      SBTX1B        W2TX1B
     C                   END
     C                   END
     C     W2TX2A        IFEQ      *ZEROS
     C                   MOVE      SBTX2A        W2TX2A                           EFFEKT
     C     SBEFFM        IFEQ      'X'
     C                   MOVE      SBEFFM        W2EFFM
     C                   MOVE      SBTX2B        W2TX2B
     C                   END
     C                   END
     C     W2TX3A        IFEQ      *ZEROS
     C                   MOVE      SBTX3A        W2TX3A                           KUBIKK
     C     SBKUBM        IFEQ      'X'
     C                   MOVE      SBKUBM        W2KUBM
     C                   MOVE      SBTX3B        W2TX3B
     C                   END
     C                   END
     C     W2PC1A        IFEQ      *ZEROS
     C                   MOVE      SBPC1A        W2PC1A                           CIF-VERDI
     C     SBCIFM        IFEQ      'X'
     C                   MOVE      SBCIFM        W2CIFM
     C                   MOVE      SBPC1B        W2PC1B
     C                   END
     C                   END
     C     SBPROM        IFEQ      'X'
     C                   MOVE      SBPROM        W2PROM
     C                   MOVE      SBPC2A        W2PC2A                            % AV TOT
     C                   END
     C     SBVRAM        IFEQ      'X'
     C                   MOVE      SBVRAM        W2VRAM
     C                   MOVE      SBVRAK        W2VRAK
     C                   END
     C     SBENGM        IFEQ      'X'
     C                   MOVE      SBENGM        W2ENGM
     C                   MOVE      SBPC2C        W2PC2C
     C                   END
     C*MERKEKODE
     C     W2MEKO        IFEQ      *BLANKS
     C                   MOVE      SBMEKO        W2MEKO
     C                   END
     C*MODELLTYPE
     C     W2MOTY        IFEQ      *BLANKS
     C                   MOVE      SBMOTY        W2MOTY
     C                   END
     C*KJ.GRP-KODE
     C     W2KTKO        IFEQ      *BLANKS
     C                   MOVE      SBKTKO        W2KTKO
     C                   END
     C*KJ.GRP-TEKST
     C     W2KTGR        IFEQ      *BLANKS
     C                   MOVE      SBKTGR        W2KTGR
     C                   END
     C*FARGE
     C     W2KTFA        IFEQ      *BLANKS
     C                   MOVE      SBKTFA        W2KTFA
     C                   END
      * UNDERST. NR (INNLEDENDE TEGN) MÅ ALLTID KVITTERE FOR EVT KORTNR
     C     W2UNNR        IFEQ      *BLANKS
     C                   MOVE      SBUNNR        W2UNNR
     C                   MOVE      ' '           W2UNNM
     C                   END
      * R.44..
     C     W2R441        IFEQ      *BLANKS
     C                   MOVE      SBR441        W2R441
     C                   MOVE      SBREF1        W2REF1
     C                   END
     C     W2R442        IFEQ      *BLANKS
     C                   MOVE      SBR442        W2R442
     C                   MOVE      SBREF2        W2REF2
     C                   END
     C     W2R443        IFEQ      *BLANKS
     C                   MOVE      SBR443        W2R443
     C                   MOVE      SBREF3        W2REF3
     C                   END
     C     W2R444        IFEQ      *BLANKS
     C                   MOVE      SBR444        W2R444
     C                   MOVE      SBREF4        W2REF4
     C                   END
     C     W2R445        IFEQ      *BLANKS
     C                   MOVE      SBR445        W2R445
     C                   MOVE      SBREF5        W2REF5
     C                   END
     C                   MOVE      SBWSK1        W2WSK1
     C     W2WTY2        IFEQ      *BLANKS
     C                   MOVE      SBWTY2        W2WTY2
     C                   MOVE      SBWSK2        W2WSK2
     C                   MOVE      SBWST2        W2WST2
     C                   MOVE      SBWGL2        W2WGL2
     C                   MOVE      SBWBL2        W2WBL2
     C                   END
     C     W2WTY3        IFEQ      *BLANKS
     C                   MOVE      SBWTY3        W2WTY3
     C                   MOVE      SBWSK3        W2WSK3
     C                   MOVE      SBWST3        W2WST3
     C                   MOVE      SBWGL3        W2WGL3
     C                   MOVE      SBWBL3        W2WBL3
     C                   END
     C     W2WTY4        IFEQ      *BLANKS
     C                   MOVE      SBWTY4        W2WTY4
     C                   MOVE      SBWSK4        W2WSK4
     C                   MOVE      SBWST4        W2WST4
     C                   MOVE      SBWGL4        W2WGL4
     C                   MOVE      SBWBL4        W2WBL4
     C                   END
     C     W2WTY5        IFEQ      *BLANKS
     C                   MOVE      SBWTY5        W2WTY5
     C                   MOVE      SBWSK5        W2WSK5
     C                   MOVE      SBWST5        W2WST5
     C                   MOVE      SBWGL5        W2WGL5
     C                   MOVE      SBWBL5        W2WBL5
     C                   END
     C     W2VF          IFEQ      *BLANKS
     C                   MOVE      SBVF          W2VF
     C                   END
     C     W2LK          IFEQ      *BLANKS
     C                   MOVE      SBLK          W2LK
     C                   END
     C     W2VNT         IFEQ      *ZEROS
     C                   MOVE      SBVNT         W2VNT
     C                   END
     C     W2PRE         IFEQ      *BLANKS
     C                   MOVE      SBPRE         W2PRE
     C                   END
     C     W2TN          IFEQ      *BLANKS
     C                   MOVE      SBTN          W2TN
     C                   END
     C     W2BELT        IFEQ      *ZEROS
     C                   MOVE      SBBELT        W2BELT
     C                   END
     C     W2VKTB        IFEQ      *ZEROS
     C                   MOVE      SBVKTB        W2VKTB
     C                   END
     C     W2VKTN        IFEQ      *ZEROS
     C                   MOVE      SBVKTN        W2VKTN
     C                   END
     C     W2NTM         IFEQ      *ZEROS
     C                   MOVE      SBNTM         W2NTM
     C                   END
     C     W2PVA         IFEQ      *BLANKS
     C                   MOVE      SBPVA         W2PVA
     C                   END
     C     W2AS          IFEQ      *ZEROS
     C                   MOVE      SBAS          W2AS
     C                   END
     C     W2MFR         IFEQ      *BLANKS
     C                   MOVE      SBMFR         W2MFR
     C                   END
     C*
     C*
     C     UTSTD         ENDSR
     C***********************************************
     C     OPDSTD        BEGSR
     C***********************************************
     C                   MOVE      *BLANKS       XXPACB
     C                   MOVEL     W2PACB        XXPACB
     C     BILKEY        CHAIN     SADBIL                             33
     C                   MOVEL     W2PACB        SBPACB                          KEY:MERKE
     C                   MOVE      W2TX1C        SBTX1C                              MOD.
     C                   MOVE      W2TX2C        SBTX2C                              MOD.
     C                   MOVE      W2TX1A        SBTX1A
     C                   MOVE      W2TX2A        SBTX2A
     C                   MOVE      W2TX3A        SBTX3A
     C                   MOVE      W2TX3C        SBTX3C
     C                   MOVE      W2PC1A        SBPC1A
     C                   MOVE      W2PC1C        SBPC1C
     C                   MOVE      W2PC1D        SBPC1D
      * DE UTREGNEDE AVGIFTENE LAGRES KUN DERSOM X ER SATT..
     C                   MOVE      *ZEROS        SBTX1B
     C                   MOVE      *ZEROS        SBTX2B
     C                   MOVE      *ZEROS        SBTX3B
     C                   MOVE      *ZEROS        SBPC1B
     C                   MOVE      *ZEROS        SBPC2A
     C                   MOVE      *ZEROS        SBVRAK
     C                   MOVE      *ZEROS        SBPC2C
      * ER X SATT FOR VEKT.......
     C                   MOVE      W2VEKM        SBVEKM
     C     SBVEKM        IFEQ      'X'
     C                   MOVE      W2TX1B        SBTX1B
     C                   END
     C                   MOVE      W2EFFM        SBEFFM
     C     SBEFFM        IFEQ      'X'
     C                   MOVE      W2TX2B        SBTX2B
     C                   END
     C                   MOVE      W2KUBM        SBKUBM
     C     SBKUBM        IFEQ      'X'
     C                   MOVE      W2TX3B        SBTX3B
     C                   END
     C                   MOVE      W2CIFM        SBCIFM
     C     SBCIFM        IFEQ      'X'
     C                   MOVE      W2PC1B        SBPC1B
     C                   END
     C                   MOVE      W2PROM        SBPROM
     C     SBPROM        IFEQ      'X'
     C                   MOVE      W2PC2A        SBPC2A
     C                   END
     C                   MOVE      W2VRAM        SBVRAM
     C     SBVRAM        IFEQ      'X'
     C                   MOVE      W2VRAK        SBVRAK
     C                   END
     C                   MOVE      W2ENGM        SBENGM
     C     SBENGM        IFEQ      'X'
     C                   MOVE      W2PC2C        SBPC2C
     C                   MOVE      W2WSK1        SBWSK1
     C                   END
     C                   MOVE      W2R441        SBR441
     C                   MOVE      W2REF1        SBREF1
     C                   MOVE      W2R442        SBR442
     C                   MOVE      W2REF2        SBREF2
     C                   MOVE      W2R443        SBR443
     C                   MOVE      W2REF3        SBREF3
     C                   MOVE      W2R444        SBR444
     C                   MOVE      W2REF4        SBREF4
     C                   MOVE      W2R445        SBR445
     C                   MOVE      W2REF5        SBREF5
     C*                    MOVE W2WTY1    SBWTY1
     C                   MOVE      W2WTY2        SBWTY2
     C                   MOVE      W2WTY3        SBWTY3
     C                   MOVE      W2WTY4        SBWTY4
     C                   MOVE      W2WTY5        SBWTY5
     C                   MOVE      W2WSK1        SBWSK1
     C                   MOVE      W2WSK2        SBWSK2
     C                   MOVE      W2WSK3        SBWSK3
     C                   MOVE      W2WSK4        SBWSK4
     C                   MOVE      W2WSK5        SBWSK5
     C*                    MOVE W2WST1    SBWST1
     C                   MOVE      W2WST2        SBWST2
     C                   MOVE      W2WST3        SBWST3
     C                   MOVE      W2WST4        SBWST4
     C                   MOVE      W2WST5        SBWST5
     C*                    MOVE W2WGL1    SBWGL1
     C                   MOVE      W2WGL2        SBWGL2
     C                   MOVE      W2WGL3        SBWGL3
     C                   MOVE      W2WGL4        SBWGL4
     C                   MOVE      W2WGL5        SBWGL5
     C*                    MOVE W2WPR1    SBWPR1
     C                   MOVE      W2WPR2        SBWPR2
     C                   MOVE      W2WPR3        SBWPR3
     C                   MOVE      W2WPR4        SBWPR4
     C                   MOVE      W2WPR5        SBWPR5
     C*                    MOVE W2WBL1    SBWBL1
     C                   MOVE      W2WBL2        SBWBL2
     C                   MOVE      W2WBL3        SBWBL3
     C                   MOVE      W2WBL4        SBWBL4
     C                   MOVE      W2WBL5        SBWBL5
     C                   MOVE      W2LK          SBLK
     C                   MOVE      W2VNT         SBVNT
     C                   MOVE      W2TN          SBTN
     C                   MOVE      W2PRE         SBPRE
     C                   MOVE      W2AS          SBAS
     C                   MOVE      W2PVA         SBPVA
     C                   MOVE      W2MFR         SBMFR
     C                   MOVE      W2VF          SBVF
     C                   MOVE      W2VKTB        SBVKTB
     C                   MOVE      W2VKTN        SBVKTN
     C                   MOVE      W2NTM         SBNTM
     C                   MOVE      W2BELT        SBBELT
     C*MERKEKODE
     C                   MOVE      W2MEKO        SBMEKO
     C*MODELLTYPE
     C                   MOVE      W2MOTY        SBMOTY
     C*KJ.GRP-KODE
     C                   MOVE      W2KTKO        SBKTKO
     C*KJ.GRP-TEKST
     C                   MOVE      W2KTGR        SBKTGR
     C*FARGE
     C                   MOVE      W2KTFA        SBKTFA
      * UNDERST. NR (INNLEDENDE TEGN) MÅ ALLTID KVITTERE FOR EVT KORTNR
     C                   MOVE      W2UNNR        SBUNNR
     C                   MOVE      W2UNNM        SBUNNM
     C   33              WRITE     SADBILR
     C  N33              UPDATE    SADBILR
     C                   ENDSR
     C*
     C***********************************************
     C     VKTAVG        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        W2TX1B
     C                   MOVE      *ZEROS        AVGTI2
     C* IKKE VEKTAVG. FOR GRUPPENE.....
     C     W2PC1C        IFEQ      'E'
     C     W2PC1C        OREQ      'F'
     C     W2PC1C        OREQ      'I'
     C     W2PC1C        OREQ      ' '
     C* IKKE AVGIFT FOR KLAUSULKODENE ...
     C     W2PC1D        OREQ      'AB'
     C     W2PC1D        OREQ      'AM'
     C     W2PC1D        OREQ      'BL'
     C     W2PC1D        OREQ      'EL'
     C     W2PC1D        OREQ      'LI'
     C                   GOTO      UTVKT
     C                   END
      *
     C* KLASSE G - SNØSCOOTERE
     C     W2PC1C        IFEQ      'G'
     C* FØRSTE 100  KILO...
     C                   Z-ADD     W2TX1A        REST              8 2
     C     REST          IFLT      100
     C                   Z-ADD     REST          AVGGRL            8 2
     C                   ELSE
     C                   Z-ADD     100           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      13,24         AVGTIL            8 2
     C                   ADD       AVGTIL        AVGTI2            8 2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTVKT
      *
     C* NESTE 100   KILO...
     C     REST          IFLT      100
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     100           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      26,47         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTVKT
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      52,92         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   GOTO      UTVKT
     C                   END
      *
     C* KLASSE A (OG DE SOM ER % AV A)
     C* FØRSTE 1150 KILO...
     C                   Z-ADD     W2TX1A        REST              8 2
     C     REST          IFLT      1150
     C                   Z-ADD     REST          AVGGRL            8 2
     C                   ELSE
     C                   Z-ADD     1150          AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      35,36         AVGTIL            8 2
     C                   ADD       AVGTIL        AVGTI2            8 2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTVKT
      *
     C* NESTE 250   KILO...
     C     REST          IFLT      250
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     250           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      70,72         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTVKT
     C* NESTE 100   KILO...
     C     REST          IFLT      100
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     100           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      141,43        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTVKT
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      164,49        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C     UTVKT         TAG
     C                   Z-ADD(H)  AVGTI2        W2TX1B
      *
     C                   ENDSR
     C***********************************************
     C     EFFAVG        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        W2TX2B
     C                   MOVE      *ZEROS        AVGTI2
      *
     C* IKKE EFFEKTAVG. FOR GRUPPENE.....
     C     W2PC1C        IFEQ      'E'
     C     W2PC1C        OREQ      'I'
     C     W2PC1C        OREQ      ' '
     C* IKKE AVGIFT FOR KLAUSULKODENE ...
     C     W2PC1D        OREQ      'AB'
     C     W2PC1D        OREQ      'AM'
     C     W2PC1D        OREQ      'BL'
     C     W2PC1D        OREQ      'EL'
     C     W2PC1D        OREQ      'LI'
     C                   GOTO      UTEFF
     C                   END
      *
     C* EGNE EFFEKT-GRENSEREFOR GRUPPE F= MOTORSYKLER
     C     W2PC1C        IFEQ      'F'
     C* FØRSTE 11 KW    ER FRI...
     C     W2TX2A        SUB       11            REST
     C     REST          CABLE     0             UTEFF
      *
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      417,84        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
      *
     C                   GOTO      UTEFF
     C                   END
      *
     C* EGNE EFFEKT-GRENSER FOR GRUPPE G= SNØ SCOOTERE
     C     W2PC1C        IFEQ      'G'
     C                   Z-ADD     W2TX2A        REST
      * FØRSTE 20 KW
     C     REST          IFLT      20
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     20            AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      35,29         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTEFF
      *
      * NESTE  20 KW
     C     REST          IFLT      20
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     20            AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      70,55         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTEFF
      *
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      141,12        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
      *
     C                   GOTO      UTEFF
     C                   END
      *
      * BILER (A/B/C/)
     C* FØRSTE 65 KW  ...
     C                   Z-ADD     W2TX2A        REST
     C     REST          IFLT      65
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     65            AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      136,57        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTEFF
      *
     C* NESTE 25   KW...
     C     REST          IFLT      25
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     25            AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      498,11        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTEFF
     C* NESTE 40   KW...
     C     REST          IFLT      40
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     40            AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      996,52        AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTEFF
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      1686,36       AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C     UTEFF         TAG
     C                   Z-ADD(H)  AVGTI2        W2TX2B
      *
     C                   ENDSR
     C***********************************************
     C     KUBAVG        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        W2TX3B
     C                   MOVE      *ZEROS        AVGTI2
      *
     C     W2PC1C        IFEQ      'E'
     C     W2PC1C        OREQ      'I'
     C     W2PC1C        OREQ      ' '
     C* IKKE AVGIFT FOR KLAUSULKODENE ...
     C     W2PC1D        OREQ      'AB'
     C     W2PC1D        OREQ      'AM'
     C     W2PC1D        OREQ      'BL'
     C     W2PC1D        OREQ      'EL'
     C     W2PC1D        OREQ      'LI'
     C                   GOTO      UTKUB
     C                   END
      *
     C* EGNE KUBIKK-GRENSEREFOR GRUPPE F= MOTORSYKLER
     C     W2PC1C        IFEQ      'F'
     C* FØRSTE 125  CM3 ER FRI...
     C     W2TX3A        SUB       125           REST
     C     REST          CABLE     0             UTKUB
      *
     C* NESTE 775 CM3...
     C     REST          IFLT      775
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     775           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      32,25         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      70,72         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
      *
     C                   GOTO      UTKUB
     C                   END
      *
      *
     C* EGNE KUBIKK-GRENSER FOR GRUPPE G= SNØSCOOTERE
     C     W2PC1C        IFEQ      'G'
     C* FØRSTE 200  CM3
     C                   Z-ADD     W2TX3A        REST
     C     REST          IFLT      200
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     200           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      2,77          AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
      *
     C* NESTE 200 CM3...
     C     REST          IFLT      200
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     200           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      5,51          AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      11,02         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
      *
     C                   GOTO      UTKUB
     C                   END
      *
      * BILER (A/B/C/D/H)
     C* FØRSTE 1200 CM3..
     C                   Z-ADD     W2TX3A        REST
     C     REST          IFLT      1200
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     1200          AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      10,44         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
      *
     C* NESTE 600 CM3...
     C     REST          IFLT      600
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     600           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      27,33         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
     C* NESTE 400  CM3..
     C     REST          IFLT      400
     C                   Z-ADD     REST          AVGGRL
     C                   ELSE
     C                   Z-ADD     400           AVGGRL
     C                   END
*AVG*C     AVGGRL        MULT      64,29         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C                   SUB       AVGGRL        REST
     C     REST          CABLE     0             UTKUB
     C* DEROVER...
     C                   Z-ADD     REST          AVGGRL
*AVG*C     AVGGRL        MULT      80,31         AVGTIL
     C                   ADD       AVGTIL        AVGTI2
     C     UTKUB         TAG
     C                   Z-ADD(H)  AVGTI2        W2TX3B
      *
     C                   ENDSR
      *
     C***********************************************
     C     PROSSR        BEGSR
     C***********************************************
      * SETTER PROSENTSATS FELT SOM SKAP BRUKES I R.31 V/UTSKR.
      * = PROSENTANDEL AV DE 4 BEREGNEDE AVGIFTER SOM SKAL SVARES...
      *
     C* STD= 100 % AV BERGENET SKAL OGSÅ BETALES...
     C                   Z-ADD     100           W2PC2A
     C*
     C                   SELECT
     C     W2PC1C        WHENEQ    'B'                                          VAREBILER..
     C                   Z-ADD     20            W2PC2A
     C     W2PC1C        WHENEQ    'C'                                          CAMPINGBILER
     C                   Z-ADD     13            W2PC2A
     C     W2PC1C        WHENEQ    'D'                                          KOMBIBILER
     C                   Z-ADD     55            W2PC2A
     C     W2PC1C        WHENEQ    'H'                                          DROSJER
     C                   Z-ADD     40            W2PC2A
     C     W2PC1C        WHENEQ    'J'                                          MINIBUSSER
     C                   Z-ADD     35            W2PC2A
      *
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     CIFAVG        BEGSR
     C***********************************************
      * BERGNER CIF-VERDI-AVGIFT:
      *
      * SATSENE ER HARDKODET OG KAN IKKE STYRES AV BRUKER, MEN DERSOM
      * DE SKULLE ENDRE SEG/AVVIKE UNDER SPES OMSTENDIGHETER, KAN
      * BRUKEREN REGNE MANUELT OG OVERSTYRE SELVE CIF-AVGIFTEN!!!!
      * (DET ER KUN GR.LAG/BEREGNET SOM SKRIVES/SENDES, IKKE SATSEN)
      *
      *   DENNE PÅKOMMER KUN I GRUPPE A=PERSONBILER (100 %)
      *                        GRUPPE H=DROSJE(100 %), MEN DA SVARES
      *                                 40 % AV GRP A PÅ TOTALNIVÅ!!
      **********               GRUPPE C=CAMPINGBILMM(28 %)
      *2002                    GRUPPE C=CAMPINGBILMM(13 %)
      *                        GRUPPE D=KOMBIBIL .MM(55 %)
      *                        GRUPPE E=TREKKVOGN.MM(36 %)
      *                        GRUPPE G=BELTEMOTORS.(30 %)
      *        (STYKK-AVGIFT)  GRUPPE F=MOTORSYKLER (100 % AV 8.869,00)
      *        (STYKK-AVGIFT)  GRUPPE I=VETERAN     (100 % AV 2.920,00)
      *                        GRUPPE J=MINIBUSS..  (35 %)
      *
     C                   MOVE      *ZEROS        W2PC1B
      *
     C* IKKE AVGIFT FOR KLAUSULKODENE ...
     C     W2PC1D        IFEQ      'AB'
     C     W2PC1D        OREQ      'AM'
     C     W2PC1D        OREQ      'BL'
     C     W2PC1D        OREQ      'EL'
     C     W2PC1D        OREQ      'LI'
     C                   GOTO      UTCIF
     C                   END
      *
      * REN CIF-AVGIFT SKAL BEREGNES I GRUPPE A,D,F,G (FØR 98)
      * REN CIF-AVGIFT SKAL BEREGNES I GRUPPE A,E, ,H
      * AVG.GRP A/H: NY=FRIBELØP  (BRUKT(ENDER PÅ 09)=IKKE FRIBELØP)
     C     W2PC1C        IFEQ      'A'
     C     W2PC1C        OREQ      'H'
     C                   MOVE      W2VNT         XXVNT2            2
     C     XXVNT2        IFNE      '09'                                            BRUKT
     C                   ELSE
     C* BRUKT..
     C                   END
     C                   GOTO      UTCIF
     C                   END
      * GRP. E, FLYTETT TIL PROSSR
      * (SAMMEN MED ANDRE DER DET ER SNAKK OM XX PROS AV GRP A TOTALT.)
     C     W2PC1C        IFEQ      'E'
     C     W2PC1A        MULT      0,36          W2PC1B
     C                   GOTO      UTCIF
     C                   END
      *
     C     W2PC1C        IFEQ      'G'
     C                   GOTO      UTCIF
     C                   END
      *
      *
      * STYKKAVGIFT - PÅ GRUPPE F=MOTORSYKLER,I=VETERAN
      * (STYKKAVGIFTEN PASSER EGENTLIG IKKE INN I NOEN AV DE
      *  4 ELEMENTENE (VKT/EFF/KUB/CIF), PLASSERES DERFOR I DEN
      *  "MEST NATURLIGE" SOM ER CIF)
     C     W2PC1C        IFEQ      'F'
     C     W2TX3A        ANDGT     50
*AVG*C                   Z-ADD     9389,00       W2PC1B
     C                   GOTO      UTCIF
     C                   END
      *
     C     W2PC1C        IFEQ      'I'
*AVG*C                   Z-ADD     3091,00       W2PC1B
     C                   GOTO      UTCIF
     C                   END
      *
     C     UTCIF         ENDSR
      *
     C*
     C***********************************************
     C     VRAK          BEGSR
     C***********************************************
     C* STD VRAKPANTBELØP
*AVG*C                   Z-ADD     1300          W2VRAK
      * VISSE GRUPPER ER DET IKKE VRAKPANT PÅ
     C     W2PC1C        IFEQ      'E'
     C     W2PC1C        OREQ      'F'
     C     W2PC1C        OREQ      ' '
     C* IKKE AVGIFT FOR KLAUSULKODENE ...
     C     W2PC1D        OREQ      'AM'
     C     W2PC1D        OREQ      'BL'                                            ????
     C                   MOVE      *ZEROS        W2VRAK
     C                   END
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     HENT          BEGSR
     C***********************************************
     C*** SJEKKE OM BRUKER HAR VALGT NOEN OPSJONER. HVIS IKKE, SETTER
     C*** IND. 98 PÅ OG GIR FEILMELDING TIL BRUKER.
     C*** OPSJON 2 ---> ENDRE DETALJE LINJE.
     C*** OPSJON 4 ---> SLETTE DETALJE LINJE.
     C*** OPSJON 5 ---> VISE DETALJE LINJE
     C*** OPSJON 9 ---> LAGE TILLEGGS DETALJE LINJE
     C*** LINNBR, POSNBR ---> RETUR POSISJON AV CURSOR
     C                   SETON                                        41
     C                   SETOFF                                       919299
     C     *IN98         DOWEQ     '0'
     C                   READC     SUBFIL                                 98
     C   98              DO
     C   99              SETOFF                                       98
     C   98              MOVE      'DIV0012'     MSGNR
     C   98              SETON                                            30
     C                   Z-ADD     1             LINNBR
     C                   GOTO      SLHENT
     C                   END
     C     ZRECNO        DIV       13            LINNBR
     C                   MVR                     XLIN              2 0
     C     XLIN          IFEQ      0
     C                   Z-ADD     13            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
      * ENDRET MEN DET ER IKKE I OPT-FELTET(DA ER DET I CHASS...)
     C     WSNR          IFEQ      ' '
     C     *IN27         ANDEQ     '0'
     C                   EXSR      CHGCHA
     C                   END
     C     WSNR          IFEQ      '2'
     C     *IN27         ANDEQ     '0'
     C                   MOVE      '22'          XSNR              2
     C                   MOVE      ' '           WSNR
     C                   EXSR      CHGSAD
     C   12              GOTO      SLHENT
     C                   END
     C     WSNR          IFEQ      '4'
     C     *IN27         ANDEQ     '0'
     C                   MOVE      ' '           WSNR
     C                   EXSR      DLTSAD
     C                   END
     C     WSNR          IFEQ      '5'
     C     *IN27         ANDEQ     '1'
     C                   MOVE      ' '           WSNR
     C                   EXSR      VISSAD
     C   12              GOTO      SLHENT
     C                   END
     C                   END
     C*
     C     SLHENT        TAG
     C                   ADD       5             LINNBR
     C                   Z-ADD     2             POSNBR
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     VISSAD        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   MOVE      SWLI          W2LI
     C     SADWK         CHAIN(N)  SADW                               33
     C*
     C                   EXSR      MOVSWW
     C*
     C                   EXFMT     VARELI
     C     XLIN          IFEQ      0
     C                   Z-ADD     13            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     DLTSAD        BEGSR
     C***********************************************
     C                   MOVE      SWLI          W2LI
     C     SADWK         CHAIN     SADW                               33
     C     *IN33         IFEQ      '0'
     C                   DELETE    SADWR
     C*                    EXSR MOVB1
     C                   SUB       SWBELT        W2VSUM
     C     SIBEL3        SUB       W2VSUM        W2DIFF
     C     W2DIFF        COMP      0                                    3535
     C                   SETOFF                                       4198
     C                   SETON                                        99
     C                   END
      *
     C                   UPDATE    SUBFIL
      * VIS FRA TOPPEN IGJEN
     C                   SETOFF                                       41
     C                   MOVE      *ZEROS        W3LI
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     CHGSAD        BEGSR
     C***********************************************
     C                   MOVE      SWLI          W2LI
     C     SADWK         CHAIN(N)  SADW                               33
     C*
     C                   EXSR      MOVSWW
     C*
     C                   MOVE      W2UNNM        GMUNNM
     C                   MOVE      W2UNNR        GMUNNR
     C*
     C     STCHG         TAG
      * *IN50=OFF STENGT MANUELL AVG/INPUT - NOEN ÅPNE VIA "X"
     C     *IN50         IFEQ      '0'
     C     W2VEKM        COMP      'X'                                    51
     C     W2EFFM        COMP      'X'                                    52
     C     W2KUBM        COMP      'X'                                    53
     C     W2CIFM        COMP      'X'                                    54
     C     W2PROM        COMP      'X'                                    55
     C     W2VRAM        COMP      'X'                                    56
     C     W2ENGM        COMP      'X'                                    57
     C                   END
     C                   EXFMT     VARELI
     C                   MOVEA     '00'          *IN(66)
     C                   MOVEA     '0000000'     *IN(68)
     C                   MOVEA     '0000000'     *IN(75)
     C                   MOVEA     '00000000'    *IN(82)
     C                   SETOFF                                       30
     C*
     C   04              DO
     C                   EXSR      SØKDTA
     C                   GOTO      STCHG
     C                   END
     C*  07 = SØKE OPPDRAG
     C   07              DO
     C                   MOVE      'S'           UTYPE             1
     C                   CALL      'SYFM21'
     C                   PARM                    UTYPE
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    USG               3
     C                   GOTO      STCHG
     C                   END
      *
     C*** F10 ---> ENDRE MODUS ÅPNE/LUKKE FOR MANUELL INNTASTING
     C   10              DO
      * FRA STENGT (*IN50=OFF) TIL ÅPEN (*IN50 = ON) ...
     C     *IN50         IFEQ      '0'
     C                   MOVEA     '11111111'    *IN(50)
     C                   ELSE
      * FRA ÅPEN TIL STENGT (MEN FØR PRESENT. AV SKJ.BILDE TESTES
      * (MEN FØR PRESENT. AV SKJ.BILDE TESTES MOT X I DE INDIVIDUELLE)
     C                   MOVEA     '00000000'    *IN(50)
     C                   END
     C                   MOVE      '1'           *IN92
     C                   WRITE     SUBCTL
     C                   GOTO      STCHG
     C                   END
     C*
     C*
     C*** F12 ---> AVBRYTTE ENDRING
     C   12              MOVE      GMUNNM        W2UNNM
     C   12              MOVE      GMUNNR        W2UNNR
     C   12              UPDATE    SUBFIL
     C*** TESTE INNTASTEDE DATA. HVIS IKKE NOE FEIL, OPPDATERE PÅ FIL
     C  N12              EXSR      TESTB1
     C  N12
     CAN 30              GOTO      STCHG
     C  N12              EXSR      OPDSAD
     C     XLIN          IFEQ      0
     C                   Z-ADD     13            LINNBR
     C                   ELSE
     C                   Z-ADD     XLIN          LINNBR
     C                   END
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     OPDSAD        BEGSR
     C***********************************************
     C*** LESE LINJE FRA FIL OG OPPDATERE SUMMEN AV TOLLVERDIER.
     C*** 33 PÅ ---> NY LINJE.        33 AV ---> ENDRE EN LINJE
     C     SADWK         CHAIN     SADW                               33
     C  N33              SUB       SWBELT        W2VSUM
     C                   ADD       W2BELT        W2VSUM
     C     SIBEL3        SUB       W2VSUM        W2DIFF
     C     W2DIFF        COMP      0                                    3535
     C*
     C*
      * MER ENN EN - LAG I SÅ FALL EKSTRA LINJER.(MEN MAX 999)
     C                   MOVE      W2NTM         ANTSTK            3 0
      *
     C                   EXSR      MOVWSW
     C  N33              UPDATE    SADWR
     C     FLERE         TAG
     C   33              WRITE     SADWR
     C*
     C*** OPPDATERE PÅ SUBFIL
     C                   EXSR      FLYVAR
     C   40              UPDATE    SUBFIL
     C  N40              ADD       1             YRECNO
     C  N40              Z-ADD     YRECNO        ZRECNO
     C  N40              WRITE     SUBFIL
     C*
     C     ANTSTK        DOWGT     1
     C                   SUB       1             ANTSTK
     C                   ADD       1             XLI
     C                   MOVE      XLI           W2LI
     C                   MOVE      W2LI          SWLI
     C                   MOVE      *BLANKS       SWUNNR                         (UNDERST.NR)
     C                   MOVE      *BLANKS       W2UNNR                         (UNDERST.NR)
     C                   MOVE      ' '           SWUNNM
     C                   MOVE      ' '           W2UNNM
     C                   MOVE      *BLANKS       XXPACB
      * INNLEDENDE NR FRA MAL???.
     C                   MOVEL     W2PACB        XXPACB
     C     BILKEY        CHAIN(N)  SADBIL                             33
     C     *IN33         IFEQ      '0'
     C                   MOVE      SBUNNR        SWUNNR
     C                   MOVE      SBUNNR        W2UNNR
     C                   END
     C                   ADD       W2BELT        W2VSUM
     C     SIBEL3        SUB       W2VSUM        W2DIFF
     C     W2DIFF        COMP      0                                    3535
     C                   SETON                                        33
     C                   SETOFF                                       40
     C                   GOTO      FLERE
     C                   END
     C*
     C                   MOVE      *BLANKS       UFT
     C*
     C                   ENDSR
      *
     C***********************************************
     C     CHGCHA        BEGSR
     C***********************************************
      * OPPDATER CHASSIS/CASE-NR NÅR GITT RETT PÅ  LINJA
     C                   SETON                                        99
     C                   MOVE      SWLI          W2LI
     C     SADWK         CHAIN     SADW                               33
     C  N33              MOVE      W2UNNR        SWUNNR
     C  N33              UPDATE    SADWR
     C*** OPPDATERE SUBFIL (ALLTID FRA BLANK -> UTFYLT -> PROTECT)
     C                   MOVE      *ON           *IN28
     C                   UPDATE    SUBFIL
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     MOVSWW        BEGSR
     C***********************************************
     C                   SETON                                        99
     C                   Z-ADD     14            LINNBR
     C                   Z-ADD     25            POSNBR
     C                   SETON                                        40
     C*
     C                   MOVE      SWLI          W2LI
     C                   MOVE      SWVF          W2VF
     C                   MOVE      SWLK          W2LK
     C                   MOVE      SWVNT         W2VNT
     C                   MOVE      SWTN          W2TN
     C                   MOVE      SWPRE         W2PRE
     C                   MOVE      SWBELT        W2BELT
     C                   MOVE      SWVKTB        W2VKTB
     C                   MOVE      SWVKTN        W2VKTN
     C                   MOVE      SWNTM         W2NTM
     C                   MOVE      SWPVA         W2PVA
     C                   MOVE      SWAS          W2AS
     C                   MOVE      SWMFR         W2MFR
     C                   MOVE      SWWTY2        W2WTY2
     C                   MOVE      SWWTY3        W2WTY3
     C                   MOVE      SWWTY4        W2WTY4
     C                   MOVE      SWWTY5        W2WTY5
     C                   MOVE      SWWSK1        W2WSK1
     C                   MOVE      SWWSK2        W2WSK2
     C                   MOVE      SWWSK3        W2WSK3
     C                   MOVE      SWWSK4        W2WSK4
     C                   MOVE      SWWSK5        W2WSK5
     C                   MOVE      SWWST2        W2WST2
     C                   MOVE      SWWST3        W2WST3
     C                   MOVE      SWWST4        W2WST4
     C                   MOVE      SWWST5        W2WST5
     C                   MOVE      SWWGL2        W2WGL2
     C                   MOVE      SWWGL3        W2WGL3
     C                   MOVE      SWWGL4        W2WGL4
     C                   MOVE      SWWGL5        W2WGL5
     C                   MOVE      SWWBL2        W2WBL2
     C                   MOVE      SWWBL3        W2WBL3
     C                   MOVE      SWWBL4        W2WBL4
     C                   MOVE      SWWBL5        W2WBL5
     C                   MOVEL     SWPACB        W2PACB
     C                   MOVEL     SWMEKO        W2MEKO
     C                   MOVEL     SWMOTY        W2MOTY
     C                   MOVEL     SWKTKO        W2KTKO
     C                   MOVEL     SWKTGR        W2KTGR
     C                   MOVEL     SWKTFA        W2KTFA
     C                   MOVE      SWUNNR        W2UNNR
     C                   MOVE      SWUNNM        W2UNNM
     C                   MOVE      SWTX1A        W2TX1A
     C                   MOVE      SWTX1B        W2TX1B
     C                   MOVE      SWTX1C        W2TX1C
     C                   MOVE      SWTX2A        W2TX2A
     C                   MOVE      SWTX2B        W2TX2B
     C                   MOVE      SWTX2C        W2TX2C
     C                   MOVE      SWTX3A        W2TX3A
     C                   MOVE      SWTX3B        W2TX3B
     C                   MOVE      SWTX3C        W2TX3C
     C                   MOVE      SWPC1A        W2PC1A
     C                   MOVE      SWPC1B        W2PC1B
     C                   MOVE      SWPC1C        W2PC1C
     C                   MOVE      SWPC1D        W2PC1D
     C                   MOVE      SWPC2A        W2PC2A
     C                   MOVE      SWPC2B        W2PC2B
     C                   MOVE      SWVRAK        W2VRAK
     C                   MOVE      SWPC2C        W2PC2C
     C                   MOVE      SWVEKM        W2VEKM
     C                   MOVE      SWEFFM        W2EFFM
     C                   MOVE      SWKUBM        W2KUBM
     C                   MOVE      SWCIFM        W2CIFM
     C                   MOVE      SWPROM        W2PROM
     C                   MOVE      SWVRAM        W2VRAM
     C                   MOVE      SWENGM        W2ENGM
     C                   MOVE      SWR441        W2R441
     C                   MOVE      SWREF1        W2REF1
     C                   MOVE      SWR442        W2R442
     C                   MOVE      SWREF2        W2REF2
     C                   MOVE      SWR443        W2R443
     C                   MOVE      SWREF3        W2REF3
     C                   MOVE      SWR444        W2R444
     C                   MOVE      SWREF4        W2REF4
     C                   MOVE      SWR445        W2R445
     C                   MOVE      SWREF5        W2REF5
     C* HIDDEN FIELDS.
     C                   MOVE      SWBELS        W2BELS
     C                   MOVE      SWWJUS        W2WJUS
     C                   MOVE      SWWFTG        W2WFTG
     C                   MOVE      SWWTOL        W2WTOL
     C                   MOVE      SWWMVG        W2WMVG
     C                   MOVE      SWWMVA        W2WMVA
     C                   MOVE      SWWSUM        W2WSUM
     C                   ENDSR
     C*
     C***********************************************
     C     MOVWSW        BEGSR
     C***********************************************
     C                   MOVE      UAVD          SWAVD
     C                   MOVE      UTDN          SWTDN
     C                   MOVE      W2LI          SWLI
     C                   MOVE      W2VF          SWVF
     C                   MOVE      W2LK          SWLK
     C                   MOVE      W2VNT         SWVNT
     C                   MOVE      W2TN          SWTN
     C                   MOVE      W2PRE         SWPRE
     C                   MOVE      W2BELT        SWBELT
     C                   MOVE      W2VKTB        SWVKTB
     C                   MOVE      W2VKTN        SWVKTN
     C*                    MOVE W2NTM     SWNTM
     C                   Z-ADD     1             SWNTM
     C                   MOVE      W2PVA         SWPVA
     C                   MOVE      W2AS          SWAS
     C                   MOVE      W2MFR         SWMFR
     C     W2PC2C        IFNE      *ZEROS
     C                   MOVE      'MO'          SWWTY1
     C     W2WSK1        IFEQ      *BLANKS
     C                   MOVE      '100'         SWWSK1
     C                   ELSE
     C                   MOVE      W2WSK1        SWWSK1
     C                   END
     C                   Z-ADD     100           SWWST1
     C                   MOVE      '%'           SWWPR1
     C                   ELSE
     C                   MOVE      '  '          SWWTY1
     C                   MOVE      '   '         SWWSK1
     C                   MOVE      *ZEROS        SWWST1
     C                   MOVE      ' '           SWWPR1
     C                   END
     C                   Z-ADD     W2PC2C        SWWGL1
     C                   Z-ADD     W2PC2C        SWWBL1
      *
     C                   MOVE      W2WTY2        SWWTY2
     C                   MOVE      W2WTY3        SWWTY3
     C                   MOVE      W2WTY4        SWWTY4
     C                   MOVE      W2WTY5        SWWTY5
     C                   MOVE      W2WSK2        SWWSK2
     C                   MOVE      W2WSK3        SWWSK3
     C                   MOVE      W2WSK4        SWWSK4
     C                   MOVE      W2WSK5        SWWSK5
     C                   MOVE      W2WST2        SWWST2
     C                   MOVE      W2WST3        SWWST3
     C                   MOVE      W2WST4        SWWST4
     C                   MOVE      W2WST5        SWWST5
     C                   MOVE      W2WPR2        SWWPR2
     C                   MOVE      W2WPR3        SWWPR3
     C                   MOVE      W2WPR4        SWWPR4
     C                   MOVE      W2WPR5        SWWPR5
     C                   MOVE      W2WGL2        SWWGL2
     C                   MOVE      W2WGL3        SWWGL3
     C                   MOVE      W2WGL4        SWWGL4
     C                   MOVE      W2WGL5        SWWGL5
     C                   MOVE      W2WBL2        SWWBL2
     C                   MOVE      W2WBL3        SWWBL3
     C                   MOVE      W2WBL4        SWWBL4
     C                   MOVE      W2WBL5        SWWBL5
     C                   Z-ADD     1             SWPACA                           *ANTALL
     C                   MOVEL     W2PACB        SWPACB
     C                   MOVEL     W2MEKO        SWMEKO
     C                   MOVEL     W2MOTY        SWMOTY
     C                   MOVEL     W2KTKO        SWKTKO
     C                   MOVEL     W2KTGR        SWKTGR
     C                   MOVEL     W2KTFA        SWKTFA
     C                   MOVE      W2UNNR        SWUNNR
     C                   MOVE      W2UNNM        SWUNNM
     C                   MOVE      W2TX1A        SWTX1A
     C                   MOVE      W2TX1B        SWTX1B
     C                   MOVE      W2TX1C        SWTX1C
     C                   MOVE      W2TX2A        SWTX2A
     C                   MOVE      W2TX2B        SWTX2B
     C                   MOVE      W2TX2C        SWTX2C
     C                   MOVE      W2TX3A        SWTX3A
     C                   MOVE      W2TX3B        SWTX3B
     C                   MOVE      W2TX3C        SWTX3C
     C                   MOVE      W2PC1A        SWPC1A
     C                   MOVE      W2PC1B        SWPC1B
     C                   MOVE      W2PC1C        SWPC1C
     C                   MOVE      W2PC1D        SWPC1D
     C                   MOVE      W2PC2A        SWPC2A
     C                   MOVE      W2PC2B        SWPC2B
     C                   MOVE      W2VRAK        SWVRAK
     C                   MOVE      W2PC2C        SWPC2C
     C                   MOVE      W2VEKM        SWVEKM
     C                   MOVE      W2EFFM        SWEFFM
     C                   MOVE      W2KUBM        SWKUBM
     C                   MOVE      W2CIFM        SWCIFM
     C                   MOVE      W2PROM        SWPROM
     C                   MOVE      W2VRAM        SWVRAM
     C                   MOVE      W2ENGM        SWENGM
     C                   MOVE      W2R441        SWR441
     C                   MOVE      W2REF1        SWREF1
     C                   MOVE      W2R442        SWR442
     C                   MOVE      W2REF2        SWREF2
     C                   MOVE      W2R443        SWR443
     C                   MOVE      W2REF3        SWREF3
     C                   MOVE      W2R444        SWR444
     C                   MOVE      W2REF4        SWREF4
     C                   MOVE      W2R445        SWR445
     C                   MOVE      W2REF5        SWREF5
     C* HIDDEN FIELDS.
     C                   MOVE      W2BELS        SWBELS
     C                   MOVE      W2WJUS        SWWJUS
     C                   MOVE      W2WFTG        SWWFTG
     C     SIBELR        IFEQ      0
     C                   MOVE      W2BELS        SWWTLG
     C                   ELSE
     C                   MOVE      W2BEL2        SWWTLG
     C                   END
     C                   MOVE      W2WTOL        SWWTOL
     C                   MOVE      W2WMVG        SWWMVG
     C                   MOVE      W2WMVA        SWWMVA
     C                   MOVE      W2WSUM        SWWSUM
      *  AVVIKS-KRYSS ER SIDESTILT MED F-TAST, LAGRES IKKE/MÅ GJENTAS..
     C                   MOVE      ' '           W2VEKA
     C                   MOVE      ' '           W2CIFA
     C*
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     MOVB2         BEGSR
     C***********************************************
     C                   SETOFF                                       40
     C*
      * DEFAULTVERDIER VED NY....
     C                   Z-ADD     1             W2NTM
     C                   MOVE      *ZEROS        W2LI
     C                   MOVE      SIDFVF        W2VF
     C                   MOVE      'N'           W2PRE
      * NULL/BLANK RESTEN
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *BLANKS       W2TN
     C                   MOVE      *BLANKS       W2PVA
     C                   MOVE      *ZEROS        W2AS
     C                   MOVE      *BLANKS       W2MFR
     C                   MOVE      *ZEROS        W2BELT
     C                   MOVE      *ZEROS        W2VKTB
     C                   MOVE      *ZEROS        W2VKTN
     C                   MOVE      *BLANKS       W2WTY2
     C                   MOVE      *BLANKS       W2WTY3
     C                   MOVE      *BLANKS       W2WTY4
     C                   MOVE      *BLANKS       W2WTY5
     C                   MOVE      *BLANKS       W2WSK1
     C                   MOVE      *BLANKS       W2WSK2
     C                   MOVE      *BLANKS       W2WSK3
     C                   MOVE      *BLANKS       W2WSK4
     C                   MOVE      *BLANKS       W2WSK5
     C                   MOVE      *ZEROS        W2WST2
     C                   MOVE      *ZEROS        W2WST3
     C                   MOVE      *ZEROS        W2WST4
     C                   MOVE      *ZEROS        W2WST5
     C                   MOVE      *BLANKS       W2WPR1
     C                   MOVE      *BLANKS       W2WPR2
     C                   MOVE      *BLANKS       W2WPR3
     C                   MOVE      *BLANKS       W2WPR4
     C                   MOVE      *BLANKS       W2WPR5
     C                   MOVE      *ZEROS        W2WGL2
     C                   MOVE      *ZEROS        W2WGL3
     C                   MOVE      *ZEROS        W2WGL4
     C                   MOVE      *ZEROS        W2WGL5
     C                   MOVE      *ZEROS        W2WBL2
     C                   MOVE      *ZEROS        W2WBL3
     C                   MOVE      *ZEROS        W2WBL4
     C                   MOVE      *ZEROS        W2WBL5
     C                   MOVE      *BLANKS       W2VEKM
     C                   MOVE      *BLANKS       W2EFFM
     C                   MOVE      *BLANKS       W2KUBM
     C                   MOVE      *BLANKS       W2CIFM
     C                   MOVE      *BLANKS       W2PROM
     C                   MOVE      *BLANKS       W2VRAM
     C                   MOVE      *BLANKS       W2ENGM
     C                   MOVE      *BLANKS       W2PACB
     C                   MOVE      *BLANKS       W2MEKO
     C                   MOVE      *BLANKS       W2MOTY
     C                   MOVE      *BLANKS       W2MEKO
     C                   MOVE      *BLANKS       W2MOTY
     C                   MOVE      *BLANKS       W2KTKO
     C                   MOVE      *BLANKS       W2KTGR
     C                   MOVE      *BLANKS       W2KTFA
     C                   MOVE      *BLANKS       W2UNNR
     C                   MOVE      *BLANKS       W2UNNM
     C                   MOVE      *ZEROS        W2TX1A
     C                   MOVE      *ZEROS        W2TX1B
     C                   MOVE      *BLANKS       W2TX1C
     C                   MOVE      *ZEROS        W2TX2A
     C                   MOVE      *ZEROS        W2TX2B
     C                   MOVE      *BLANKS       W2TX2C
     C                   MOVE      *ZEROS        W2TX3A
     C                   MOVE      *ZEROS        W2TX3B
     C                   MOVE      *BLANKS       W2TX3C
     C                   MOVE      *ZEROS        W2PC1A
     C                   MOVE      *ZEROS        W2PC1B
     C                   MOVE      *BLANKS       W2PC1C
     C                   MOVE      *BLANKS       W2PC1D
     C                   MOVE      *ZEROS        W2PC2A
     C                   MOVE      *ZEROS        WRKMO
     C                   MOVE      *ZEROS        W2VRAK
     C                   MOVE      *ZEROS        W2PC2B
     C                   MOVE      *ZEROS        W2PC2C
     C                   MOVE      *BLANKS       W2R441
     C                   MOVE      *BLANKS       W2REF1
     C                   MOVE      *BLANKS       W2R442
     C                   MOVE      *BLANKS       W2REF2
     C                   MOVE      *BLANKS       W2R443
     C                   MOVE      *BLANKS       W2REF3
     C                   MOVE      *BLANKS       W2R444
     C                   MOVE      *BLANKS       W2REF4
     C                   MOVE      *BLANKS       W2R445
     C                   MOVE      *BLANKS       W2REF5
     C                   MOVE      ' '           W2VEKA
     C                   MOVE      ' '           W2CIFA
      *
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     TATEST        BEGSR
     C***********************************************
     C     W2PVA         IFEQ      'F'
     C                   MOVE      *ZEROS        W2AS
     C                   ELSE
     C                   MOVE      TAORDK        W2PVA
     C                   MOVE      TAORDB        W2AS
     C     W2PRE         IFEQ      'A'
     C                   MOVE      TAEØSB        W2AS
     C                   ELSE
     C     W2PRE         IFEQ      'B'
     C     W2PRE         OREQ      'F'
     C                   MOVE      TAEFB         W2AS
     C                   ELSE
     C     W2PRE         IFEQ      'C'
     C     W2PRE         OREQ      'E'
     C                   MOVE      TAEFTB        W2AS
     C                   ELSE
     C                   EXSR      TATES2
     C                   END
     C                   END
     C                   END
     C                   END
     C*
     C     W2AS          IFEQ      0
     C                   MOVE      'F'           W2PVA
     C                   END
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     TATES2        BEGSR
     C***********************************************
      * HELE SUBRUTINE ER OMSKREVET
     C                   SELECT
S05  C*    W2LK          WHENEQ    'HR'
N05  C     W2LK          WHENEQ    'SZ'
     C                   MOVE      TATSJB        W2AS
     C     W2LK          WHENEQ    'TR'
     C                   MOVE      TATYRB        W2AS
     C     W2LK          WHENEQ    'IL'
     C                   MOVE      TAISRB        W2AS
     C     W2LK          WHENEQ    'SG'
     C                   MOVE      TAELLB        W2AS
     C     W2LK          WHENEQ    'CL'                                         CHILE
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TABULB        W2AS
     C     W2LK          WHENEQ    'MK'
     C                   MOVE      TAPOLB        W2AS
     C     W2LK          WHENEQ    'KR'                                         SØR KOREA
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TAROMB        W2AS
     C     W2LK          WHENEQ    'JO'
     C                   MOVE      TAUNGB        W2AS
     C     W2LK          WHENEQ    'TN'
     C                   MOVE      TASLOB        W2AS
     C     W2LK          WHENEQ    'GL'
     C                   MOVE      TAGRLB        W2AS
     C     W2LK          WHENEQ    'FO'
     C                   MOVE      TAFÆRB        W2AS
     C     W2LK          WHENEQ    'IN'
     C     W2LK          OREQ      'LK'
     C     W2LK          OREQ      'TH'
     C                   MOVE      TAISTB        W2AS
     C     W2LK          WHENEQ    'MA'
     C                   MOVE      TAMARB        W2AS
     C     W2LK          WHENEQ    'MX'
     C                   MOVE      TAMEXB        W2AS
     C     W2LK          WHENEQ    'PS'
     C                   MOVE      TAVGAB        W2AS
     C     W2LK          WHENEQ    'LN'                                         LIBANON
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TAN01B        W2AS
     C     W2LK          WHENEQ    'EG'                                         EGYPT
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TAN03B        W2AS
     C     W2LK          WHENEQ    'CA'                                         CANADA
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TAN04B        W2AS
N05  C     W2LK          WHENEQ    'RS'                                         SERBIA
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN05B        W2AS
N05  C     W2LK          WHENEQ    'AL'                                         ALBANIA
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN06B        W2AS
N05  C     W2LK          WHENEQ    'UA'                                         UKRAINA
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN07B        W2AS
N05  C     W2LK          WHENEQ    'PE'                                         PERU
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN08B        W2AS
N05  C     W2LK          WHENEQ    'ME'                                         MONTENEGRO
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN09B        W2AS
N05  C     W2LK          WHENEQ    'HK'                                         HONG KONG
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN10B        W2AS
N05  C     W2LK          WHENEQ    'BW'                                         BOTSWANA
N05  C     PTFDT         ANDLE     SIDT
N05  C     W2LK          OREQ      'NA'                                         NAMIBIA
N05  C     PTFDT         ANDLE     SIDT
N05  C     W2LK          OREQ      'SZ'                                         SWAZILAND
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN11B        W2AS
     C     KS2MO         WHENEQ    'M'
     C                   MOVE      TAMULB        W2AS
     C     KS2MO         WHENEQ    'O'
     C                   MOVE      TAOULB        W2AS
     C     KS2MO         WHENEQ    'S'                                          SACU
     C     PTFDT         ANDLE     SIDT
     C                   MOVE      TAOULB        W2AS
N05  C     KS2MO         WHENEQ    'L'                                          LAVERE M.INNT.LAND
N05  C     PTFDT         ANDLE     SIDT
N05  C                   MOVE      TAN12B        W2AS
     C                   ENDSL
      *
     C                   ENDSR
      *
     C***********************************************
     C     FINSUM        BEGSR
     C***********************************************
     C                   MOVE      *ZEROS        XLI               5 0
     C                   MOVE      *ZEROS        W2LI
     C                   MOVE      *ZEROS        W2VSUM
     C     SADWK         SETLL     SADW
     C                   SETOFF                                       3399
     C*
     C     STFS          TAG
     C     UAVD          READE(N)  SADW                                   33
     C  N33UTDN          COMP      SWTDN                              3333
     C  N33              SETON                                        99
     C  N33              DO
     C                   MOVE      SWLI          XLI
     C                   ADD       SWBELT        W2VSUM
     C                   GOTO      STFS
     C                   END
     C*
     C     SIBEL3        SUB       W2VSUM        W2DIFF
     C     W2DIFF        COMP      0                                    3535
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     PRINT         BEGSR
     C***********************************************
     C   03              Z-ADD     3             UFLAGG            1 0
     C                   CALL      'SAD061T'
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    UTVIN
     C                   PARM                    W2DIFF
     C                   PARM                    UIN28
     C                   PARM                    UIN29
     C                   PARM                    UFLAGG
     C                   PARM                    UWS
     C*
     C     UFLAGG        COMP      1                                      12
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     SØKDTA        BEGSR
     C***********************************************
     C     WSCLOC        DIV       256           LINNBR
     C                   MVR                     POSNBR
     C                   Z-ADD     WSSUBN        XRECNO            4 0
     C*
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     7
     C     POSNBR        ANDLE     8
     C                   MOVE      'N'           USPED             1
     C                   CALL      'SYFI10L'
     C                   PARM                    W2LK
     C                   PARM                    USPED
     C                   Z-ADD     11            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDGE     11
     C     POSNBR        ANDLE     18
     C                   CALL      'SAD062A'
     C                   PARM                    W2VNT
     C                   PARM                    USIDT
     C                   Z-ADD     20            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDEQ     20
     C                   CALL      'SAD061L'
     C                   PARM                    W2TN
     C                   Z-ADD     23            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      14
     C     POSNBR        ANDEQ     23
     C                   CALL      'SAD061N'
     C                   PARM                    W2PRE
     C                   Z-ADD     25            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDLE     44
     C                   MOVE      *BLANKS       XXPACB
     C                   MOVEL     W2PACB        XXPACB
     C                   CALL      'SAD061Q'
     C                   PARM                    XXPACB
     C                   PARM                    W2TX1C
     C                   PARM                    W2TX2C
     C                   MOVEL     XXPACB        W2PACB
     C                   Z-ADD     45            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      15
     C     POSNBR        ANDGE     78
     C                   MOVEL     'BILAVGGR'    KDTYPE           10
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KDKODE            5
     C                   CALL      'SYKUKD'
     C                   PARM                    KDTYPE
     C                   PARM                    KDUPD
     C                   PARM                    KDKODE
     C     KDUPD         IFNE      'X'
     C                   MOVEL     KDKODE        W2PC1C
     C                   Z-ADD     16            LINNBR
     C                   Z-ADD     6             POSNBR
     C                   END
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     78
     C                   MOVEL     'BILKLAUS'    KDTYPE           10
     C                   MOVE      'N'           KDUPD             1
     C                   MOVE      *BLANKS       KDKODE            5
     C                   CALL      'SYKUKD'
     C                   PARM                    KDTYPE
     C                   PARM                    KDUPD
     C                   PARM                    KDKODE
     C     KDUPD         IFNE      'X'
     C                   MOVEL     KDKODE        W2PC1D
     C                   END
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      17
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     79
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   MOVE      'MO'          W2WTY1            2
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY1
     C                   PARM                    W2WSK1
     C                   PARM                    UMOD
     C                   Z-ADD     18            LINNBR
     C                   Z-ADD     3             POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     9
     C     POSNBR        ANDLE     10
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY2
     C                   PARM                    W2WSK2
     C                   PARM                    UMOD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     14
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY2
     C                   PARM                    W2WSK2
     C                   PARM                    UMOD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     47
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY3
     C                   PARM                    W2WSK3
     C                   PARM                    UMOD
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      21
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     51
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY3
     C                   PARM                    W2WSK3
     C                   PARM                    UMOD
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     9
     C     POSNBR        ANDLE     10
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY4
     C                   PARM                    W2WSK4
     C                   PARM                    UMOD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     12
     C     POSNBR        ANDLE     14
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY4
     C                   PARM                    W2WSK4
     C                   PARM                    UMOD
     C                   Z-ADD     16            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     46
     C     POSNBR        ANDLE     47
     C                   MOVE      'A'           UMOD              1            AVGIFTSKODE
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY5
     C                   PARM                    W2WSK4
     C                   PARM                    UMOD
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      22
     C     POSNBR        ANDGE     49
     C     POSNBR        ANDLE     51
     C                   MOVE      'S'           UMOD              1            AVG.SEKVENS
     C                   CALL      'SAD061O'
     C                   PARM                    W2WTY5
     C                   PARM                    W2WSK5
     C                   PARM                    UMOD
     C                   Z-ADD     53            POSNBR
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2REF1
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
     C*
     C     LINNBR        IFEQ      19
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     58
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2REF2
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
      *
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     33
     C     POSNBR        ANDLE     35
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2REF3
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     55
     C     POSNBR        ANDLE     57
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2REF4
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
     C     LINNBR        IFEQ      20
     C     POSNBR        ANDGE     77
     C     POSNBR        ANDLE     79
     C                   MOVE      'J'           UIMP              1
     C                   CALL      'SAD061K'
     C                   PARM                    W2REF5
     C                   PARM                    UIMP
     C                   GOTO      SLSØK
     C                   END
     C*
     C                   MOVE      'DIV1037'     MSGNR
     C                   SETON                                        30
     C*
     C     SLSØK         ENDSR
     C*
     C***********************************************
     C     SØKVAR        BEGSR
     C***********************************************
     C                   CALL      'SAD061C'
     C                   PARM                    UFIRM
     C                   PARM                    UAVD
     C                   PARM                    UTDN
     C                   PARM                    UUR
     C                   PARM                    UFAKNO
     C                   PARM                    UFT
     C                   PARM                    UWS
     C                   PARM                    UTVIN
     C                   PARM                    UIN28
     C                   PARM                    UIN29
     C                   PARM                    UIN36
     C                   PARM                    UFLAGG
     C                   PARM                    W2VSUM
     C                   PARM                    W2DIFF
     C                   PARM                    XLI
     C                   PARM                    USIDT
     C*
     C     UFLAGG        COMP      1                                      12
     C     UFLAGG        COMP      3                                      03
     C     UFLAGG        COMP      2                                      17
     C     W2DIFF        COMP      0                                    3535
     C*
     C                   ENDSR
     C*
     C*
     C***********************************************
     C     TSTSUM        BEGSR
     C***********************************************
     C*
     C     SADHK         CHAIN     SADH                               33
     C     *IN33         IFEQ      '0'
     C                   MOVE      *ZEROS        SIBEL5                          *TOLL
     C                   MOVE      *ZEROS        SIBEL6                          *MOMS
     C                   MOVE      *ZEROS        SIBEL7                          *TOTAL
     C* RENUM LINJENUMMER (TETT IGJEN HULL I FALL SLETTET...)
     C                   MOVE      *ZEROS        XXLINR            5 0
     C*
     C     SADHK         SETLL     SADW
     C     SADHK         READE     SADW                                   33
     C     *IN33         DOWEQ     '0'
     C                   ADD       1             XXLINR
     C                   MOVE      XXLINR        SWLI
     C                   UPDATE    SADWR
     C                   ADD       SWWTOL        SIBEL5
     C                   ADD       SWWMVA        SIBEL6
     C     SWWSUM        ADD       SWWMVA        LINTOT
     C                   ADD       LINTOT        SIBEL7
     C     *IN30         IFEQ      '0'
     C                   MOVE      SWUNNR        TSTUNN            1
     C     SWUNNM        IFEQ      'X'
     C                   MOVE      SWUNNM        TSTUNN
     C                   END
     C     SWUNNR        IFEQ      *BLANKS
     C     TSTUNN        OREQ      ' '
     C                   MOVE      '1'           *IN30
     C                   MOVE      'JOV1148'     MSGNR
     C                   END
     C                   END
     C     SADHK         READE     SADW                                   33
     C                   END
     C*
     C                   UPDATE    SADHR
     C                   END
     C*
     C                   ENDSR
     C*
     C***********************************************
     C     INIT          BEGSR
     C***********************************************
     C     SADHK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C     SADWK         KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W2LI
     C     SADW1K        KLIST
     C                   KFLD                    UAVD
     C                   KFLD                    UTDN
     C                   KFLD                    W3LI              5 0
     C                   MOVE      *ZEROS        W3LI
     C     KODS2K        KLIST
     C                   KFLD                    XS2UNI
     C                   KFLD                    W2LK
     C     KODS5K        KLIST
     C                   KFLD                    XS5UNI
     C                   KFLD                    W2TN
     C     KODS6K        KLIST
     C                   KFLD                    XS6UNI
     C                   KFLD                    KS2PRE
     C     KODS8K        KLIST
     C                   KFLD                    XS8TYP            2
     C                   KFLD                    XS8SKV            3
     C     KODVAK        KLIST
     C                   KFLD                    SIVAL3
     C                   KFLD                    USIDT
     C     TARIK         KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    X2TAR
     C     TARIKM        KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    X2TAR
     C                   KFLD                    XADATO
     C                   MOVE      99999999      XADATO            8 0
     C*
     C     AVGGRK        KLIST
     C                   KFLD                    XKFTYP           10
     C                   KFLD                    XKFKOD            5
     C                   MOVEL     'BILAVGGR'    XKFTYP
     C*
     C     KLAUSK        KLIST
     C                   KFLD                    YKFTYP           10
     C                   KFLD                    YKFKOD            5
     C                   MOVEL     'BILKLAUS'    YKFTYP
     C     BILKEY        KLIST
     C                   KFLD                    XXPACB           15
     C                   KFLD                    W2TX1C
     C                   KFLD                    W2TX2C
     C     SADSDK        KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    XDKDAÆ            2
     C                   MOVE      'MV'          XDKDAÆ
     C     SADS2K        KLIST
     C                   KFLD                    TATANR
     C                   KFLD                    XDKDAÆ            2
     C                   KFLD                    XDKDSÆ            3
     C*
     C     *ENTRY        PLIST
     C                   PARM                    UFIRM             2
     C                   PARM                    UAVD              4 0
     C                   PARM                    UTDN              7 0
     C                   PARM                    UUR               1
     C                   PARM                    UFAKNO            9 0
S04  C*                  PARM                    UFT              17
N04  C                   PARM                    UFT              28
     C                   PARM                    UWS              10
     C                   PARM                    UTVIN             1
     C*** UIN28 = '1' -> EN ER INNE PÅ ET TIDL. INNSTIKK.
     C                   PARM                    UIN28             1
     C*** UIN29 = '1' -> SENDES PÅ TVINN
     C     *IN29         PARM                    UIN29             1
     C*** UIN36 = '1' -> I SAD400
     C                   PARM                    UIN36             1
     C                   PARM                    USIDT             8 0
     C                   PARM                    UFLAGG            1 0
     C*
     C*** UFLAGG 9 INN = SPØRRING
     C     UFLAGG        COMP      9                                      27
     C*** UUR = 'F' -> SJØSPEDISJON
     C     UUR           COMP      'F'                                    60
     C  N60UUR           COMP      'G'                                    60
     C*
     C                   MOVE      *BLANKS       W2LK
     C                   MOVE      '0'           *IN(34)
     C                   MOVE      *BLANKS       X03               3
     C                   MOVE      *BLANKS       XTN               1
     C                   MOVE      *BLANKS       XPRE              1
     C                   MOVE      *ZEROS        XAS               5 2
     C                   MOVE      *BLANKS       XPVA              1
     C                   MOVE      *BLANKS       XMFR              1
     C                   MOVE      *BLANKS       XVF               1
     C                   MOVE      *ZEROS        SWLI
     C                   MOVE      'S2 '         XS2UNI            3
     C                   MOVE      'S5  '        XS5UNI            4
     C                   MOVE      'S6  '        XS6UNI            4
     C                   MOVE      *BLANKS       X2TAR             3
     C*
     C                   MOVE      *ZEROS        SIRAB
     C                   MOVE      *ZEROS        SIBELC
     C                   MOVE      *ZEROS        W2VNT
     C                   MOVE      *ZEROS        W2AS
     C                   MOVE      *ZEROS        SWVNT
     C                   MOVE      *ZEROS        SWAS
     C                   MOVE      *ZEROS        W2PC2A
     C*
     C*
     C                   MOVE      'DIV1954'     XMSGNR            7            MELDING-ID
     C                   Z-ADD     3             XLEVEL            1 0          NIVÅ
     C                   Z-ADD     0             XRETUR            1 0          RETURKODE
     C                   Z-ADD     78            XMSGL             4 0          LENGDE PÅ MELDING
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT1            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1955'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     78            XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT2            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C                   MOVE      'DIV1956'     XMSGNR
     C                   Z-ADD     3             XLEVEL
     C                   Z-ADD     0             XRETUR
     C                   Z-ADD     78            XMSGL
     C                   CALL      'SUBR23R3'
     C                   PARM                    XMSGNR
     C                   PARM                    XTXT3            78
     C                   PARM                    XLEVEL
     C                   PARM                    XRETUR
     C                   PARM                    XMSGL
     C*
     C* LAG TESTFELT FOR DUP-KEY
     C                   BITON     '345'         KDUKOD            1
     C                   BITOFF    '01267'       KDUKOD
     C     SADHK         CHAIN(N)  SADH                               33
      * PROSEDYRE=47,70,72,73,74,76,77 ---> IKKE RUBR. 47
     C     SIDP          COMP      47                                     46
     C  N46SIDP          COMP      70                                     46
     C  N46SIDP          COMP      71                                     46
     C  N46SIDP          COMP      72                                     46
     C  N46SIDP          COMP      73                                     46
     C  N46SIDP          COMP      74                                     46
     C  N46SIDP          COMP      76                                     46
     C  N46SIDP          COMP      77                                     46
     C   46              MOVE      'F'           W2PVA
     C   46              MOVE      *ZEROS        W2AS
     C   46              MOVE      'F'           W2MFR
     C*** FINN FAKTOR FOR VARELINJE
     C                   Z-ADD(H)  1             XTVFAK           17 9
     C     SIBEL3        IFNE      0
     C     SIBEL4        DIV(H)    SIBEL3        XTVFAK           17 9
     C                   END
     C     SIBELR        IFNE      0
     C     SIBEL3        ANDNE     0
     C     SIBELS        DIV(H)    SIBEL3        XTVFA2           17 9
     C                   ELSE
     C                   MOVE      *ZEROS        XTVFA2
     C                   END
     C     SIBELR        IFEQ      0
     C                   Z-ADD     SIBEL4        WSBEL4
     C                   ELSE
     C                   Z-ADD     SIBELS        WSBEL4
     C                   END
     C* VED SPØRRING VIS TOTALER
     C     *IN27         IFEQ      '1'
     C     SIBEL7        SUB       SIBEL6        W2AVGA
     C     W2AVGA        SUB       SIBEL5        W2AVGA
     C                   END
     C*
     C*** FINN MOMSSATS
     C                   MOVE      *BLANKS       FIFIRM
     C     FIFIRM        SETLL     FIRM
     C                   READ      FIRM                                   33
     C     SIDT          IFLT      FITAXD
     C                   Z-ADD     FITAX2        FITAX
     C                   END
     C     'TVI00005'    CHAIN     SYPTFF                             33
     C*
     C                   EXSR      FINSUM
     C*
     C                   ENDSR
     C*
** TOLLBEREGNINGSREGEL
AFPVW
