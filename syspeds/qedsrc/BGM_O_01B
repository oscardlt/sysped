      *////////////////////////////////////////////////////////////
      *  BEGINNING OF MESSAGE                                BGM  /
      *////////////////////////////////////////////////////////////
     C     BGM           BEGSR
      *_____________
      * SEGMENT NAME
      *"""""""""""""
     C                   ADD       1             W0074
     C                   MOVE      *BLANKS       A
     C                   MOVEA     'BGM'         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *___________________________
      * C002 DOCUMENT MESSAGE NAME
      *"""""""""""""""""""""""""""
     C     U1001         IFEQ      *BLANKS
     C     U1131         ANDEQ     *BLANKS
     C     U3055         ANDEQ     *BLANKS
     C*    U1000         ANDEQ     *BLANKS
     C     U1004         ANDEQ     *BLANKS
     C     U1225         ANDEQ     *BLANKS
     C     U4343         ANDEQ     *BLANKS
     C                   GOTO      BGMEND
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      * 1001 Document/message name, coded
     C     U1001         IFNE      *BLANKS
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U1001         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 1131 Code list qualifier
     C     U1131         IFEQ      *BLANKS
     C     U3055         ANDEQ     *BLANKS
     C*    U1000         ANDEQ     *BLANKS
     C                   GOTO      BGM001
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     U1131         IFNE      *BLANKS
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U1131         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 3055 Code list responsible agency code
     C     U3055         IFEQ      *BLANKS
     C*    U1000         ANDEQ     *BLANKS
     C                   GOTO      BGM001
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     ':'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     U3055         IFNE      *BLANKS
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U3055         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 1000 Document name
     C*    U1000         IFEQ      *BLANKS
     C*                  GOTO      BGM001
     C*                  ENDIF
      *
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     ':'           A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     1             AXH
     C*                  MOVE      'N'           WCHART
     C*                  EXSR      SRÅ
      *
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     U1000         A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     35            AXH
     C*                  EXSR      SRÅ
      *_____________________________
      * 1004 DOCUMENT/MESSAGE NUMBER
      *"""""""""""""""""""""""""""""
     C     BGM001        TAG
      *
     C     U1004         IFEQ      *BLANKS
     C     U1225         ANDEQ     *BLANKS
     C     U4343         ANDEQ     *BLANKS
     C                   GOTO      BGMEND
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     U1004         IFNE      *BLANKS
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U1004         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     35            AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      * 1056 Version identifier
     C*    U1056         IFEQ      *BLANKS
     C*    U1060         ANDEQ     *BLANKS
     C*                  GOTO      BGM002
     C*                  ENDIF
      *
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     ':'           A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     1             AXH
     C*                  MOVE      'N'           WCHART
     C*                  EXSR      SRÅ
      *
     C*    U1056         IFNE      *BLANKS
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     U1056         A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     9             AXH
     C*                  EXSR      SRÅ
     C*                  ENDIF
      * 1060 Version identifier
     C*    U1060         IFEQ      *BLANKS
     C*                  GOTO      BGM002
     C*                  ENDIF
      *
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     ':'           A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     1             AXH
     C*                  MOVE      'N'           WCHART
     C*                  EXSR      SRÅ
      *
     C*                  MOVE      *BLANKS       A
     C*                  MOVEA     U1060         A
     C*                  Z-ADD     1             AXV
     C*                  Z-ADD     6             AXH
     C*                  EXSR      SRÅ
      *_____________________________
      * 1225
      *"""""""""""""""""""""""""""""
     C*    BGM002        TAG
      *_____________________________
      * 1225 MESSAGE FUNCTION, CODED
      *"""""""""""""""""""""""""""""
     C     U1225         IFEQ      *BLANKS
     C     U4343         ANDEQ     *BLANKS
     C                   GOTO      BGMEND
     C                   ENDIF
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C     U1225         IFNE      *BLANKS
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U1225         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
     C                   ENDIF
      *__________________________
      * 4343 RESPONSE TYPE, CODED
      *""""""""""""""""""""""""""
     C     U4343         CABEQ     *BLANKS       BGMEND
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     '+'           A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     U4343         A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     3             AXH
     C                   EXSR      SRÅ
      *_______________
      * END OF SEGMENT
      *"""""""""""""""
     C     BGMEND        TAG
      *
     C                   MOVE      *BLANKS       A
     C                   MOVEA     WAPSTR        A
     C                   Z-ADD     1             AXV
     C                   Z-ADD     1             AXH
     C                   MOVE      'N'           WCHART
     C                   EXSR      SRÅ
      *
     C                   ENDSR
